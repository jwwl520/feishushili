!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("sheet/@adit/block"),require("sheet/@adit/easysync"),require("sheet/@adit/editor"),require("sheet/@adit/sync-buffer"),require("sheet/@bdeefe/byted-x-io"),require("sheet/@bdeefe/secLink"),require("sheet/@bdeefe/vcfollow-sdk"),require("sheet/@byted/broadcast-channel"),require("sheet/@byted/byted-ee-palette"),require("sheet/@platform-fe/biz-mention"),require("sheet/@platform-fe/biz-suite-custom-icon"),require("sheet/@platform-fe/browser"),require("sheet/@platform-fe/byted-ee-theme"),require("sheet/@platform-fe/comment"),require("sheet/@platform-fe/lib-request"),require("sheet/@platform-fe/localforage"),require("sheet/@platform-fe/shared-ccm-common"),require("sheet/@platform-fe/suite-url-parser"),require("sheet/@platform-fe/widget-pc"),require("sheet/@universe-design/react"),require("sheet/axios"),require("sheet/bear-sheet-external/abtest"),require("sheet/bear-sheet-external/actions"),require("sheet/bear-sheet-external/async-injector/block"),require("sheet/bear-sheet-external/async-injector/comment"),require("sheet/bear-sheet-external/async-injector/date-reminder"),require("sheet/bear-sheet-external/async-injector/limit-edit-mode"),function(){try{return require("sheet/bear-sheet-external/async-injector/mention")}catch(e){}}(),require("sheet/bear-sheet-external/async-injector/subscription"),require("sheet/bear-sheet-external/common"),require("sheet/bear-sheet-external/components"),require("sheet/bear-sheet-external/constants"),require("sheet/bear-sheet-external/delay/actions"),require("sheet/bear-sheet-external/delay/async-module"),require("sheet/bear-sheet-external/delay/comment"),require("sheet/bear-sheet-external/delay/constants"),require("sheet/bear-sheet-external/delay/date-reminder"),require("sheet/bear-sheet-external/delay/embed"),require("sheet/bear-sheet-external/delay/helpers"),require("sheet/bear-sheet-external/delay/limit-edit-mode"),require("sheet/bear-sheet-external/delay/permission"),require("sheet/bear-sheet-external/delay/selectors"),require("sheet/bear-sheet-external/delay/subscription"),require("sheet/bear-sheet-external/helpers"),require("sheet/bear-sheet-external/io"),require("sheet/bear-sheet-external/loader-helper"),require("sheet/bear-sheet-external/log"),require("sheet/bear-sheet-external/selectors"),require("sheet/buffer"),require("sheet/chevrotain"),require("sheet/dompurify"),require("sheet/intl-messageformat"),require("sheet/lodash-decorators"),require("sheet/lodash-es"),require("sheet/moment"),require("sheet/protobufjs/dist/light/protobuf.min.js"),require("sheet/qs"),require("sheet/react"),require("sheet/react-dom"),require("sheet/react-loadable"),require("sheet/react-redux"),require("sheet/react-router-dom"),require("sheet/redux"),require("sheet/redux-actions"),require("sheet/resize-observer-polyfill"),require("sheet/styled-components"),require("sheet/url"),require("sheet/wolfy87-eventemitter"));else if("function"==typeof define&&define.amd)define([,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,],t);else{var n="object"==typeof exports?t(require("sheet/@adit/block"),require("sheet/@adit/easysync"),require("sheet/@adit/editor"),require("sheet/@adit/sync-buffer"),require("sheet/@bdeefe/byted-x-io"),require("sheet/@bdeefe/secLink"),require("sheet/@bdeefe/vcfollow-sdk"),require("sheet/@byted/broadcast-channel"),require("sheet/@byted/byted-ee-palette"),require("sheet/@platform-fe/biz-mention"),require("sheet/@platform-fe/biz-suite-custom-icon"),require("sheet/@platform-fe/browser"),require("sheet/@platform-fe/byted-ee-theme"),require("sheet/@platform-fe/comment"),require("sheet/@platform-fe/lib-request"),require("sheet/@platform-fe/localforage"),require("sheet/@platform-fe/shared-ccm-common"),require("sheet/@platform-fe/suite-url-parser"),require("sheet/@platform-fe/widget-pc"),require("sheet/@universe-design/react"),require("sheet/axios"),require("sheet/bear-sheet-external/abtest"),require("sheet/bear-sheet-external/actions"),require("sheet/bear-sheet-external/async-injector/block"),require("sheet/bear-sheet-external/async-injector/comment"),require("sheet/bear-sheet-external/async-injector/date-reminder"),require("sheet/bear-sheet-external/async-injector/limit-edit-mode"),function(){try{return require("sheet/bear-sheet-external/async-injector/mention")}catch(e){}}(),require("sheet/bear-sheet-external/async-injector/subscription"),require("sheet/bear-sheet-external/common"),require("sheet/bear-sheet-external/components"),require("sheet/bear-sheet-external/constants"),require("sheet/bear-sheet-external/delay/actions"),require("sheet/bear-sheet-external/delay/async-module"),require("sheet/bear-sheet-external/delay/comment"),require("sheet/bear-sheet-external/delay/constants"),require("sheet/bear-sheet-external/delay/date-reminder"),require("sheet/bear-sheet-external/delay/embed"),require("sheet/bear-sheet-external/delay/helpers"),require("sheet/bear-sheet-external/delay/limit-edit-mode"),require("sheet/bear-sheet-external/delay/permission"),require("sheet/bear-sheet-external/delay/selectors"),require("sheet/bear-sheet-external/delay/subscription"),require("sheet/bear-sheet-external/helpers"),require("sheet/bear-sheet-external/io"),require("sheet/bear-sheet-external/loader-helper"),require("sheet/bear-sheet-external/log"),require("sheet/bear-sheet-external/selectors"),require("sheet/buffer"),require("sheet/chevrotain"),require("sheet/dompurify"),require("sheet/intl-messageformat"),require("sheet/lodash-decorators"),require("sheet/lodash-es"),require("sheet/moment"),require("sheet/protobufjs/dist/light/protobuf.min.js"),require("sheet/qs"),require("sheet/react"),require("sheet/react-dom"),require("sheet/react-loadable"),require("sheet/react-redux"),require("sheet/react-router-dom"),require("sheet/redux"),require("sheet/redux-actions"),require("sheet/resize-observer-polyfill"),require("sheet/styled-components"),require("sheet/url"),require("sheet/wolfy87-eventemitter")):t(e["sheet/"]["@adit/block"],e["sheet/"]["@adit/easysync"],e["sheet/"]["@adit/editor"],e["sheet/"]["@adit/sync-buffer"],e["sheet/"]["@bdeefe/byted-x-io"],e["sheet/"]["@bdeefe/secLink"],e["sheet/"]["@bdeefe/vcfollow-sdk"],e["sheet/"]["@byted/broadcast-channel"],e["sheet/"]["@byted/byted-ee-palette"],e["sheet/"]["@platform-fe/biz-mention"],e["sheet/"]["@platform-fe/biz-suite-custom-icon"],e["sheet/"]["@platform-fe/browser"],e["sheet/"]["@platform-fe/byted-ee-theme"],e["sheet/"]["@platform-fe/comment"],e["sheet/"]["@platform-fe/lib-request"],e["sheet/"]["@platform-fe/localforage"],e["sheet/"]["@platform-fe/shared-ccm-common"],e["sheet/"]["@platform-fe/suite-url-parser"],e["sheet/"]["@platform-fe/widget-pc"],e["sheet/"]["@universe-design/react"],e["sheet/"].axios,e["sheet/"]["bear-sheet-external/abtest"],e["sheet/"]["bear-sheet-external/actions"],e["sheet/"]["bear-sheet-external/async-injector/block"],e["sheet/"]["bear-sheet-external/async-injector/comment"],e["sheet/"]["bear-sheet-external/async-injector/date-reminder"],e["sheet/"]["bear-sheet-external/async-injector/limit-edit-mode"],e["sheet/"]["bear-sheet-external/async-injector/mention"],e["sheet/"]["bear-sheet-external/async-injector/subscription"],e["sheet/"]["bear-sheet-external/common"],e["sheet/"]["bear-sheet-external/components"],e["sheet/"]["bear-sheet-external/constants"],e["sheet/"]["bear-sheet-external/delay/actions"],e["sheet/"]["bear-sheet-external/delay/async-module"],e["sheet/"]["bear-sheet-external/delay/comment"],e["sheet/"]["bear-sheet-external/delay/constants"],e["sheet/"]["bear-sheet-external/delay/date-reminder"],e["sheet/"]["bear-sheet-external/delay/embed"],e["sheet/"]["bear-sheet-external/delay/helpers"],e["sheet/"]["bear-sheet-external/delay/limit-edit-mode"],e["sheet/"]["bear-sheet-external/delay/permission"],e["sheet/"]["bear-sheet-external/delay/selectors"],e["sheet/"]["bear-sheet-external/delay/subscription"],e["sheet/"]["bear-sheet-external/helpers"],e["sheet/"]["bear-sheet-external/io"],e["sheet/"]["bear-sheet-external/loader-helper"],e["sheet/"]["bear-sheet-external/log"],e["sheet/"]["bear-sheet-external/selectors"],e["sheet/"].buffer,e["sheet/"].chevrotain,e["sheet/"].dompurify,e["sheet/"]["intl-messageformat"],e["sheet/"]["lodash-decorators"],e["sheet/"]["lodash-es"],e["sheet/"].moment,e["sheet/"]["protobufjs/dist/light/protobuf.min.js"],e["sheet/"].qs,e["sheet/"].react,e["sheet/"]["react-dom"],e["sheet/"]["react-loadable"],e["sheet/"]["react-redux"],e["sheet/"]["react-router-dom"],e["sheet/"].redux,e["sheet/"]["redux-actions"],e["sheet/"]["resize-observer-polyfill"],e["sheet/"]["styled-components"],e["sheet/"].url,e["sheet/"]["wolfy87-eventemitter"]);for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(self,(function(e,t,n,r,i,o,a,s,u,l,c,h,d,f,p,v,g,_,y,m,E,b,T,C,S,w,R,A,O,M,k,I,x,N,P,L,D,F,B,V,H,U,Z,W,j,G,z,Y,X,K,q,$,J,Q,ee,te,ne,re,ie,oe,ae,se,ue,le,ce,he,de,fe){return function(){var pe,ve,ge,_e,ye,me,Ee,be={vsh_33417:function(e,t,n){"use strict";n.r(t),n.d(t,{TransformType:function(){return r}});var r,i=n("vsh_85234"),o=n.n(i),a=n("vsh_39046"),s=n("vsh_83500"),u=function(e,t){for(var n,r="data",i=((n={})[r]=e,n),o=0;o<t.length;){if(i=i[r],r=t[o],void 0===i)throw new Error("bad path");o+=1}return{elem:i,key:r}},l=function(e,t,n,r){var i=Array.prototype.slice.call(t),o=[];if(n.length>1&&"function"!=typeof i[i.length-1]&&i.push((function(){})),i.length<(r||n.length))i.unshift(o);else{var a=function(e){if(e instanceof Array)return e;if("number"==typeof e)return[e];if("string"==typeof e)return e.split(".");throw new Error("Invalid type of path: "+typeof e)}(i[0]);a&&(i[0]=o.concat(a))}return n.apply(e,i)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
function c(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function d(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e}function f(e,t,n,r){var i=e.transformX=function(e,o){var a,s,u,l,h,d;n(e),n(o);var f,p,v,g=[];try{for(var _=c(o),y=_.next();!y.done;y=_.next()){for(var m=y.value,E=[],b=0;b<e.length;){var T=[];if(f=e[b],v=T,t(E,f,p=m,"left"),t(v,p,f,"right"),b++,1!==T.length){if(0===T.length){for(var C=b;C<e.length;C++)r(E,e[C]);m=null;break}var S=i(e.slice(b),T);try{for(var w=(u=void 0,c(S[0])),R=w.next();!R.done;R=w.next()){var A=R.value;r(E,A)}}catch(e){u={error:e}}finally{try{R&&!R.done&&(l=w.return)&&l.call(w)}finally{if(u)throw u.error}}try{for(var O=(h=void 0,c(S[1])),M=O.next();!M.done;M=O.next()){var k=M.value;r(g,k)}}catch(e){h={error:e}}finally{try{M&&!M.done&&(d=O.return)&&d.call(O)}finally{if(h)throw h.error}}m=null;break}m=T[0]}null!=m&&r(g,m),e=E}}catch(e){a={error:e}}finally{try{y&&!y.done&&(s=_.return)&&s.call(_)}finally{if(a)throw a.error}}return[e,g]};e.transform=function(e,n,r){if("left"!==r&&"right"!==r)throw new Error("type must be 'left' or 'right'");return 0===n.length?e:1===e.length&&1===n.length?t([],e[0],n[0],r):"left"===r?i(e,n)[0]:i(n,e)[1]}}!function(e){e.LEFT="left",e.RIGHT="right"}(r||(r={}));var p={name:"text0",uri:"http://sharejs.org/types/textv0",create:function(e){if(null!=e&&"string"!=typeof e)throw new Error("Initial data must be a string");return e||""}},v=function(e,t,n){return e.slice(0,t)+n+e.slice(t)},g=function(e){if("number"!=typeof e.p)throw new Error("component missing position field");if("string"==typeof e.i==("string"==typeof e.d))throw new Error("component needs an i or d field");if(e.p<0)throw new Error("position cannot be negative")},_=function(e){for(var t=0;t<e.length;t++)g(e[t])};p.apply=function(e,t){var n;_(t);for(var r=0;r<t.length;r++){var i=t[r];if(null!=i.i)e=v(e,i.p,i.i);else{if(n=e.slice(i.p,i.p+i.d.length),i.d!==n)throw new Error("Delete component '"+i.d+"' does not match deleted text '"+n+"'");e=e.slice(0,i.p)+e.slice(i.p+i.d.length)}}return e};var y=p._append=function(e,t){if(""!==t.i&&""!==t.d)if(0===e.length)e.push(t);else{var n=e[e.length-1];null!=n.i&&null!=t.i&&n.p<=t.p&&t.p<=n.p+n.i.length?e[e.length-1]={i:v(n.i,t.p-n.p,t.i),p:n.p}:null!=n.d&&null!=t.d&&t.p<=n.p&&n.p<=t.p+t.d.length?e[e.length-1]={d:v(t.d,n.p-t.p,n.d),p:t.p}:e.push(t)}};p.compose=function(e,t){_(e),_(t);for(var n=e.slice(),r=0;r<t.length;r++)y(n,t[r]);return n},p.normalize=function(e){var t=[];null==e.i&&null==e.p||(e=[e]);for(var n=0;n<e.length;n++){var r=e[n];null==r.p&&(r.p=0),y(t,r)}return t};var m=function(e,t,n){return null!=t.i?t.p<e||t.p===e&&n?e+t.i.length:e:e<=t.p?e:e<=t.p+t.d.length?t.p:e-t.d.length};p.transformCursor=function(e,t,n){for(var r="right"===n,i=0;i<t.length;i++)e=m(e,t[i],r);return e};var E=p._tc=function(e,t,n,r){if(g(t),g(n),null!=t.i)y(e,{i:t.i,p:m(t.p,n,"right"===r)});else if(null!=n.i){var i=t.d;t.p<n.p&&(y(e,{d:i.slice(0,n.p-t.p),p:t.p}),i=i.slice(n.p-t.p)),""!==i&&y(e,{d:i,p:t.p+n.i.length})}else if(t.p>=n.p+n.d.length)y(e,{d:t.d,p:t.p-n.d.length});else if(t.p+t.d.length<=n.p)y(e,t);else{var o={d:"",p:t.p};t.p<n.p&&(o.d=t.d.slice(0,n.p-t.p)),t.p+t.d.length>n.p+n.d.length&&(o.d+=t.d.slice(n.p+n.d.length-t.p));var a=Math.max(t.p,n.p),s=Math.min(t.p+t.d.length,n.p+n.d.length);if(t.d.slice(a-t.p,s-t.p)!==n.d.slice(a-n.p,s-n.p))throw new Error("Delete ops delete different text in the same region of the document");""!==o.d&&(o.p=m(o.p,n),y(e,o))}return e};p.invert=function(e){e=e.slice().reverse();for(var t=0;t<e.length;t++)e[t]=null!=(n=e[t]).i?{d:n.i,p:n.p}:{i:n.d,p:n.p};var n;return e},f(p,E,_,y);var b=function(e){return"[object Array]"===Object.prototype.toString.call(e)},T=function(e){return JSON.parse(JSON.stringify(e))},C={name:"json0",uri:"http://sharejs.org/types/JSONv0"},S={};function w(e){e.subType=e.subType||{},e.subType.t="text0";var t={p:e.p.pop()};e.action&&null!=e.action.si&&(t.i=e.action.si),e.action&&null!=e.action.sd&&(t.d=e.action.sd),e.subType.o=[t]}function R(e){e.p.push(e.subType.o[0].p),null!=e.subType.o[0].i&&(e.action.si=e.subType.o[0].i),null!=e.subType.o[0].d&&(e.action.sd=e.subType.o[0].d),delete e.subType.t,delete e.subType.o,delete e.subType}C.registerSubtype=function(e){S[e.name]=e},C.create=function(e){return void 0===e?null:T(e)},C.invertComponent=function(e,t){var n={p:e.p,action:{}};if(e.subType&&e.subType.t&&S[e.subType.t]){n.subType=n.subType||{},n.subType.t=e.subType.t;var r=t&&t[e.p];n.subType.o=S[e.subType.t].invert(e.subType.o,r)}return e.action&&void 0!==e.action.si&&(n.action.sd=e.action.si),e.action&&void 0!==e.action.sd&&(n.action.si=e.action.sd),e.action&&void 0!==e.action.oi&&(n.action.od=e.action.oi),e.action&&void 0!==e.action.od&&(n.action.oi=e.action.od),e.action&&void 0!==e.action.li&&(n.action.ld=e.action.li),e.action&&void 0!==e.action.ld&&(n.action.li=e.action.ld),e.action&&void 0!==e.action.na&&(n.action.na=-e.action.na),e.action&&void 0!==e.action.lm&&(n.action.lm=e.p[e.p.length-1],n.p=e.p.slice(0,e.p.length-1).concat([e.action.lm])),n},C.invert=function(e,t){for(var n=e.slice().reverse(),r=[],i=0;i<n.length;i++)r.push(C.invertComponent(n[i],t));return r},C.checkValidOp=function(e){if(!b(e))throw new Error("op is not array");for(var t=0;t<e.length;t++)if(!b(e[t].p))throw new Error("Missing path")},C.checkList=function(e){if(!b(e))throw new Error("Referenced element not a list")},C.checkObj=function(e){if(!(t=e)||t.constructor!==Object)throw new Error("Referenced element not an object (it was "+JSON.stringify(e)+")");var t},C.apply=function(e,t){C.checkValidOp(t),t=T(t);for(var n={data:e},r=0;r<t.length;r++){var i=t[r];!i.action||null==i.action.si&&null==i.action.sd||w(i);for(var o=null,s=n,u="data",l=0;l<i.p.length;l++){var c=i.p[l];if(o=s,s=s[u],u=c,null==o)throw new Error("Path invalid")}if(i.subType&&i.subType.t&&void 0!==i.subType.o&&S[i.subType.t])s[u]=S[i.subType.t].apply(s[u],i.subType.o);else if(i.action&&void 0!==i.action.na){if("number"!=typeof s[u])throw new Error("Referenced element not a number");s[u]+=i.action.na}else if(i.action&&void 0!==i.action.li&&void 0!==i.action.ld){if(C.checkList(s),!(0,a.isEqual)(s[u],i.action.ld))throw new Error("element does not match c.ld");s[u]=i.action.li}else if(i.action&&void 0!==i.action.li)C.checkList(s),s.splice(u,0,i.action.li);else if(i.action&&void 0!==i.action.ld){if(C.checkList(s),!(0,a.isEqual)(s[u],i.action.ld))throw new Error("element does not match c.ld");s.splice(u,1)}else if(i.action&&void 0!==i.action.lm){if(C.checkList(s),i.action.lm!=u){var h=s[u];s.splice(u,1),s.splice(i.action.lm,0,h)}}else if(i.action&&void 0!==i.action.oi)C.checkObj(s),s[u]=i.action.oi;else{if(!i.action||void 0===i.action.od)throw new Error("invalid / missing instruction in op");C.checkObj(s),delete s[u]}}return n.data},C.shatter=function(e){for(var t=[],n=0;n<e.length;n++)t.push([e[n]]);return t},C.incrementalApply=function(e,t,n){for(var r=0;r<t.length;r++){var i=[t[r]];n(i,e=C.apply(e,i))}return e};var A=C.pathMatches=function(e,t,n){if(e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r]&&(!n||r!==e.length-1))return!1;return!0};C.append=function(e,t){if(t=T(t),0!==e.length){var n=e[e.length-1];if(!t.action||!n.action||null==t.action.si&&null==t.action.sd||null==n.action.si&&null==n.action.sd||(w(t),w(n)),A(t.p,n.p))if(t.subType&&t.subType.t&&n.subType&&n.subType.t&&t.subType.t===n.subType.t&&S[t.subType.t]){if(n.subType.o=S[t.subType.t].compose(n.subType.o,t.subType.o),t.action&&(null!=t.action.si||null!=t.action.sd)){for(var r=t.p,i=0;i<n.subType.o.length-1;i++)t.subType.o=[n.subType.o.pop()],t.p=r.slice(),R(t),e.push(t);R(n)}}else n.action&&null!=n.action.na&&null!=t.action.na?e[e.length-1]={p:n.p,action:{na:n.action.na+t.action.na}}:n.action&&t.action&&void 0!==n.action.li&&void 0===t.action.li&&t.action.ld===n.action.li?void 0!==n.action.ld?delete n.action.li:e.pop():n.action&&t.action&&void 0!==n.action.od&&void 0===n.action.oi&&void 0!==t.action.oi&&void 0===t.action.od?n.action.oi=t.action.oi:n.action&&t.action&&void 0!==n.action.oi&&void 0!==t.action.od?t.action&&void 0!==t.action.oi?n.action.oi=t.action.oi:n.action&&void 0!==n.action.od?delete n.action.oi:e.pop():t.action&&void 0!==t.action.lm&&t.p[t.p.length-1]===t.action.lm||e.push(t);else!t.action||!n.action||null==t.action.si&&null==t.action.sd||null==n.action.si&&null==n.action.sd||(R(t),R(n)),e.push(t)}else e.push(t)},C.compose=function(e,t){C.checkValidOp(e),C.checkValidOp(t);for(var n=T(e),r=0;r<t.length;r++)C.append(n,t[r]);return n},C.normalize=function(e){var t=[];e=b(e)?e:[e];for(var n=0;n<e.length;n++){var r=e[n];null==r.p&&(r.p=[]),C.append(t,r)}return t},C.commonLengthForOps=function(e,t){var n=e.p.length,r=t.p.length;if((e.action&&null!=e.action.na||e.subType&&e.subType.t)&&n++,(t.action&&null!=t.action.na||t.subType&&t.subType.t)&&r++,0===n)return-1;if(0===r)return null;n--,r--;for(var i=0;i<n;i++){var o=e.p[i];if(i>=r||o!==t.p[i])return null}return n},C.canOpAffectPath=function(e,t){return null!=C.commonLengthForOps({p:t},e)},C.transformComponent=function(e,t,n,r){t=T(t);var i=C.commonLengthForOps(n,t),o=C.commonLengthForOps(t,n),a=t.p.length,s=n.p.length;if((t.action&&null!=t.action.na||t.subType&&t.subType.t)&&a++,(n.action&&null!=n.action.na||n.subType&&n.subType.t)&&s++,null!=o&&s>a&&t.p[o]==n.p[o])if(t.action&&void 0!==t.action.ld)(l=T(n)).p=l.p.slice(a),t.action.ld=C.apply(T(t.action.ld),[l]);else if(t.action&&void 0!==t.action.od){(l=T(n)).p=l.p.slice(a),t.action.od=C.apply(T(t.action.od),[l])}if(null!=i){var u=a==s,l=n;if(!t.action||!n.action||null==t.action.si&&null==t.action.sd||null==n.action.si&&null==n.action.sd||(w(t),w(l=T(n))),l.subType&&l.subType.t&&S[l.subType.t]){if(t.subType&&t.subType.t&&t.subType.t===l.subType.t){var c=S[t.subType.t].transform(t.subType.o,l.subType.o,r);if(!t.action||null==t.action.si&&null==t.action.sd)(!b(c)||c.length>0)&&(t.subType=t.subType||{},t.subType.o=c,C.append(e,t));else for(var h=t.p,d=0;d<c.length;d++)t.subType=t.subType||{},t.subType.o=[c[d]],t.p=h.slice(),R(t),C.append(e,t);return e}}else if(n.action&&void 0!==n.action.na);else if(n.action&&void 0!==n.action.li&&void 0!==n.action.ld){if(n.p[i]===t.p[i]){if(!u)return e;if(t.action&&void 0!==t.action.ld){if(!t.action||void 0===t.action.li||"left"!==r)return e;t.action.ld=T(n.action.li)}}}else if(n.action&&void 0!==n.action.li)t.action&&void 0!==t.action.li&&void 0===t.action.ld&&u&&t.p[i]===n.p[i]?"right"===r&&t.p[i]++:n.p[i]<=t.p[i]&&t.p[i]++,t.action&&void 0!==t.action.lm&&u&&n.p[i]<=t.action.lm&&t.action.lm++;else if(n.action&&void 0!==n.action.ld){if(t.action&&void 0!==t.action.lm&&u){if(n.p[i]===t.p[i])return e;h=n.p[i];var f=t.p[i];(h<(p=t.action.lm)||h===p&&f<p)&&t.action.lm--}if(n.p[i]<t.p[i])t.p[i]--;else if(n.p[i]===t.p[i]){if(s<a)return e;if(t.action&&void 0!==t.action.ld){if(void 0===t.action.li)return e;delete t.action.ld}}}else if(n.action&&void 0!==n.action.lm)if(t.action&&void 0!==t.action.lm&&a===s){f=t.p[i];var p=t.action.lm,v=n.p[i],g=n.action.lm;if(v!==g)if(f===v){if("left"!==r)return e;t.p[i]=g,f===p&&(t.action.lm=g)}else f>v&&t.p[i]--,f>g?t.p[i]++:f===g&&v>g&&(t.p[i]++,f===p&&t.action.lm++),(p>v||p===v&&p>f)&&t.action.lm--,p>g?t.action.lm++:p===g&&(g>v&&p>f||g<v&&p<f?"right"===r&&t.action.lm++:p>f?t.action.lm++:p===v&&t.action.lm--)}else if(t.action&&void 0!==t.action.li&&void 0===t.action.ld&&u){f=n.p[i],p=n.action.lm;(h=t.p[i])>f&&t.p[i]--,h>p&&t.p[i]++}else{f=n.p[i],p=n.action.lm;(h=t.p[i])===f?t.p[i]=p:(h>f&&t.p[i]--,(h>p||h===p&&f>p)&&t.p[i]++)}else if(n.action&&void 0!==n.action.oi&&void 0!==n.action.od){if(t.p[i]===n.p[i]){if(!t.action||void 0===t.action.oi||!u)return e;if("right"===r)return e;t.action.od=n.action.oi}}else if(n.action&&void 0!==n.action.oi){if(t.action&&void 0!==t.action.oi&&t.p[i]===n.p[i]){if("left"!==r)return e;C.append(e,{p:t.p,action:{od:n.action.oi}})}}else if(n.action&&void 0!==n.action.od&&t.p[i]==n.p[i]){if(!u)return e;if(!t.action||void 0===t.action.oi)return e;delete t.action.od}}return C.append(e,t),e},f(C,C.transformComponent,C.checkValidOp,C.append),C.registerSubtype(p);var O=new(function(){function e(){this.name="easysync",this.compose=s.composeOps}return e.prototype.transform=function(e,t,n){var i,o=e[s.ZONE_CHANGESETS],a=t[s.ZONE_CHANGESETS],u=(0,s.toString)(o),l=(new s.AttributePool).fromJsonable(e.apool),c=(new s.AttributePool).fromJsonable(t.apool),h=(0,s.moveOpsToNewPool)(u,l,c),d={},f=(0,s.toObject)(h);for(var p in a)a.hasOwnProperty(p)&&(d[p]=(0,s.follow)(a[p],f[p]||"",n!==r.LEFT,c));for(var p in o)a[p]||(d[p]=(0,s.follow)("",f[p]||"",n!==r.LEFT,c));return(i={})[s.ZONE_CHANGESETS]=d,i.apool=c.toJsonable(),i},e.prototype.invert=function(e,t){var n,r={},i=t.initialAttributedTexts,o=t.apool,a=i.attribs,u=i.text,l=(new s.AttributePool).fromJsonableNoCloning(o),c=(new s.AttributePool).fromJsonable(e.apool),h=e[s.ZONE_CHANGESETS],f=function(e){if(h.hasOwnProperty(e)){var t=a[e]||"|1+1",n=(u[e]||"\n").split("\n"),i=function(e){var t=(0,s.opIterator)(e),n=[];for(;t.hasNext();){var r=t.next();if("+"!==r.opcode)throw new Error("transformAttribsToAlines opcode must be +");var i=r.attribs+"|1+1";if(r.lines>1){var o=new Array(r.lines).fill(i);n.push.apply(n,d(o))}else n.push(i)}return n}(t),o=(0,s.moveOpsToNewPool)(h[e],c,l),f=(0,s.unpack)(o),p={get:function(e){return n[e]+"\n"}};r[e]=(0,s.doInverse)(f[e],p,i,l)}};for(var p in h)f(p);var v=new s.AttributePool,g=(0,s._pack)(r),_=(0,s.moveOpsToNewPool)(g,l,v);return(n={})[s.ZONE_CHANGESETS]=(0,s.toObject)(_),n.apool=v.toJsonable(),n},e.prototype.apply=function(e,t){var n=(new s.AttributePool).fromJsonableNoCloning(t.apool),r=(new s.AttributePool).fromJsonableNoCloning(e.apool),i=(0,s.moveOpsToNewPool)((0,s.toString)(t.zone_changesets),n,r),o=(0,s.applyToZatext)(i,e.initialAttributedTexts,r),a=new s.AttributePool;for(var u in o.attribs)o.attribs.hasOwnProperty(u)&&(o.attribs[u]=(0,s.moveOpsToNewPool)(o.attribs[u],r,a));return e.apool=a.toJsonable(),e.initialAttributedTexts=o,e},e}()),M=C.apply,k=C.compose,I=C.transform,x=C.invert;(0,C.registerSubtype)(O);var N=function(){function e(e,t,n){if(this.parent=null,this.children=null,this.id="",this.key="",this.snapshot="",!t)throw new Error("Node value cannot be empty");this.set([],t),this.id=o()(),this.parent=e,this.snapshot=(0,a.cloneDeep)(t),this.children=n}return e.registerSubtype=function(e){C.registerSubtype(e)},e.transform=function(e,t,n){return void 0===n&&(n=r.LEFT),I(e,t,n)},e.compose=function(e,t){return k(e,t)},e.invert=function(e,t){return x(e,t)},e.prototype.apply=function(e){var t=M(this.snapshot,e);this.set([],t)},e.prototype.get=function(e){var t=this;return e?l(this,arguments,(function(e){var n=u(t.snapshot,e);return n.elem[n.key]})):this.snapshot},e.prototype.move=function(e,t){var n=this;return l(this,arguments,(function(e,t){var r=u(n.snapshot,e),i=r.elem,o=r.key,a=[];if(i.constructor!==Array)throw new Error("bad path");var s=e;s[s.length-1]=parseInt(s[s.length-1],10),a.push({p:s,action:{lm:t}});var l=i.splice(o,1)[0];return i.splice(t,0,l),a}))},e.prototype.set=function(e,t){var n=this;return l(this,arguments,(function(e,t){var r=u(n.snapshot,e),i=r.elem,o=r.key,a=[];if(i.constructor===Array){var s=e;s[s.length-1]=parseInt(s[s.length-1],10),a.push({p:s,action:{li:t}}),void 0!==i[o]&&a.unshift({p:e,action:{ld:i[o]}}),i[o]=t}else{if("object"!=typeof i)throw new Error("bad path");a.push({p:e,action:{oi:t}}),void 0!==i[o]&&a.unshift({p:e,action:{od:i[o]}}),i[o]=t}return 0===e.length&&(n.snapshot=t),a}))},e.prototype.getSnapshot=function(){return this.snapshot},e.prototype.remove=function(e,t){var n=this;return l(this,arguments,(function(e,t){if(null==t||"function"==typeof t){var r=[];if(void 0===(a=(o=u(n.snapshot,e)).elem)[s=o.key])throw new Error("no element at that path");if(a.constructor===Array){var i=e;i[i.length-1]=parseInt(i[i.length-1],10),r.push({p:i,action:{ld:a[s]}}),a.splice(s,1)}else{if("object"!=typeof a)throw new Error("bad path");r.push({p:e,action:{od:a[s]}}),delete a[s]}return r}var o,a,s,l=parseInt(e.pop(),10);if("string"==typeof(a=(o=u(n.snapshot,e)).elem)[s=o.key]){var c=l,h=t,d={p:e.concat(l),action:{sd:o.elem[o.key].slice(c,c+h)}};return a[s]=a[s].substring(0,l)+a[s].substring(c+h),[d]}if(a[s].constructor===Array){for(var f=[],p=l;p<l+t;p++)f.push({p:e.concat(l),action:{ld:a[s][p]}}),a[s].splice(p,1);return f}throw new Error("element at path does not support range")}))},e.prototype.replaceString=function(e,t,n,r){var i=this;return l(this,arguments,(function(e,t,n,r){var o=u(i.snapshot,e),a=o.key,s=o.elem,l=s[a],c=[];if("string"==typeof l){if(t<0||t>l.length||n<0||t+n>l.length)throw new Error("bad path: start or end overflow");var h=l.substring(t,t+n);return h&&c.push({p:e.concat(t),action:{sd:h}}),r&&"string"==typeof r?c.push({p:e.concat(t),action:{si:r}}):r="",s[a]=l.substring(0,t)+r+l.substring(t+n),c}throw new Error("bad path: element the path ref is not string")}))},e}();t.default=N},vsh_58881:function(e,t,n){"use strict";n.d(t,{O:function(){return r},Z:function(){return D}});var r,i=n("vsh_85234"),o=n.n(i);!function(e){e.LEFT="left",e.RIGHT="right"}(r||(r={}));var a=n("vsh_39046");
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
function s(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function l(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(u(arguments[t]));return e}var c=function(e,t,n,r){var i=e.transformX=function(e,o){var a,u,l,c,h,d;n(e),n(o);var f,p,v,g=[];try{for(var _=s(o),y=_.next();!y.done;y=_.next()){for(var m=y.value,E=[],b=0;b<e.length;){var T=[];if(f=e[b],v=T,t(E,f,p=m,"left"),t(v,p,f,"right"),b++,1!==T.length){if(0===T.length){for(var C=b;C<e.length;C++)r(E,e[C]);m=null;break}var S=i(e.slice(b),T);try{for(var w=(l=void 0,s(S[0])),R=w.next();!R.done;R=w.next()){var A=R.value;r(E,A)}}catch(e){l={error:e}}finally{try{R&&!R.done&&(c=w.return)&&c.call(w)}finally{if(l)throw l.error}}try{for(var O=(h=void 0,s(S[1])),M=O.next();!M.done;M=O.next()){var k=M.value;r(g,k)}}catch(e){h={error:e}}finally{try{M&&!M.done&&(d=O.return)&&d.call(O)}finally{if(h)throw h.error}}m=null;break}m=T[0]}null!=m&&r(g,m),e=E}}catch(e){a={error:e}}finally{try{y&&!y.done&&(u=_.return)&&u.call(_)}finally{if(a)throw a.error}}return[e,g]};e.transform=function(e,n,r){if("left"!==r&&"right"!==r)throw new Error("type must be 'left' or 'right'");return 0===n.length?e:1===e.length&&1===n.length?t([],e[0],n[0],r):"left"===r?i(e,n)[0]:i(n,e)[1]}},h={name:"text0",uri:"http://sharejs.org/types/textv0",create:function(e){if(null!=e&&"string"!=typeof e)throw new Error("Initial data must be a string");return e||""}},d=function(e,t,n){return e.slice(0,t)+n+e.slice(t)},f=function(e){if("number"!=typeof e.p)throw new Error("component missing position field");if("string"==typeof e.i==("string"==typeof e.d))throw new Error("component needs an i or d field");if(e.p<0)throw new Error("position cannot be negative")},p=function(e){for(var t=0;t<e.length;t++)f(e[t])};h.apply=function(e,t){var n;p(t);for(var r=0;r<t.length;r++){var i=t[r];if(null!=i.i)e=d(e,i.p,i.i);else{if(n=e.slice(i.p,i.p+i.d.length),i.d!==n)throw new Error("Delete component '"+i.d+"' does not match deleted text '"+n+"'");e=e.slice(0,i.p)+e.slice(i.p+i.d.length)}}return e};var v=h._append=function(e,t){if(""!==t.i&&""!==t.d)if(0===e.length)e.push(t);else{var n=e[e.length-1];null!=n.i&&null!=t.i&&n.p<=t.p&&t.p<=n.p+n.i.length?e[e.length-1]={i:d(n.i,t.p-n.p,t.i),p:n.p}:null!=n.d&&null!=t.d&&t.p<=n.p&&n.p<=t.p+t.d.length?e[e.length-1]={d:d(t.d,n.p-t.p,n.d),p:t.p}:e.push(t)}};h.compose=function(e,t){p(e),p(t);for(var n=e.slice(),r=0;r<t.length;r++)v(n,t[r]);return n},h.normalize=function(e){var t=[];null==e.i&&null==e.p||(e=[e]);for(var n=0;n<e.length;n++){var r=e[n];null==r.p&&(r.p=0),v(t,r)}return t};var g=function(e,t,n){return null!=t.i?t.p<e||t.p===e&&n?e+t.i.length:e:e<=t.p?e:e<=t.p+t.d.length?t.p:e-t.d.length};h.transformCursor=function(e,t,n){for(var r="right"===n,i=0;i<t.length;i++)e=g(e,t[i],r);return e};var _=h._tc=function(e,t,n,r){if(f(t),f(n),null!=t.i)v(e,{i:t.i,p:g(t.p,n,"right"===r)});else if(null!=n.i){var i=t.d;t.p<n.p&&(v(e,{d:i.slice(0,n.p-t.p),p:t.p}),i=i.slice(n.p-t.p)),""!==i&&v(e,{d:i,p:t.p+n.i.length})}else if(t.p>=n.p+n.d.length)v(e,{d:t.d,p:t.p-n.d.length});else if(t.p+t.d.length<=n.p)v(e,t);else{var o={d:"",p:t.p};t.p<n.p&&(o.d=t.d.slice(0,n.p-t.p)),t.p+t.d.length>n.p+n.d.length&&(o.d+=t.d.slice(n.p+n.d.length-t.p));var a=Math.max(t.p,n.p),s=Math.min(t.p+t.d.length,n.p+n.d.length);if(t.d.slice(a-t.p,s-t.p)!==n.d.slice(a-n.p,s-n.p))throw new Error("Delete ops delete different text in the same region of the document");""!==o.d&&(o.p=g(o.p,n),v(e,o))}return e};h.invert=function(e){e=e.slice().reverse();for(var t=0;t<e.length;t++)e[t]=null!=(n=e[t]).i?{d:n.i,p:n.p}:{i:n.d,p:n.p};var n;return e},c(h,_,p,v);var y=h,m=function(e){return"[object Array]"===Object.prototype.toString.call(e)},E=function(e){return JSON.parse(JSON.stringify(e))},b={name:"json0",uri:"http://sharejs.org/types/JSONv0"},T={};function C(e){e.subType=e.subType||{},e.subType.t="text0";var t={p:e.p.pop()};e.action&&null!=e.action.si&&(t.i=e.action.si),e.action&&null!=e.action.sd&&(t.d=e.action.sd),e.subType.o=[t]}function S(e){e.p.push(e.subType.o[0].p),null!=e.subType.o[0].i&&(e.action.si=e.subType.o[0].i),null!=e.subType.o[0].d&&(e.action.sd=e.subType.o[0].d),delete e.subType.t,delete e.subType.o,delete e.subType}b.registerSubtype=function(e){T[e.name]=e},b.create=function(e){return void 0===e?null:E(e)},b.invertComponent=function(e,t){var n={p:e.p,action:{}};if(e.subType&&e.subType.t&&T[e.subType.t]){n.subType=n.subType||{},n.subType.t=e.subType.t;var r=t&&t[e.p];n.subType.o=T[e.subType.t].invert(e.subType.o,r)}return e.action&&void 0!==e.action.si&&(n.action.sd=e.action.si),e.action&&void 0!==e.action.sd&&(n.action.si=e.action.sd),e.action&&void 0!==e.action.oi&&(n.action.od=e.action.oi),e.action&&void 0!==e.action.od&&(n.action.oi=e.action.od),e.action&&void 0!==e.action.li&&(n.action.ld=e.action.li),e.action&&void 0!==e.action.ld&&(n.action.li=e.action.ld),e.action&&void 0!==e.action.na&&(n.action.na=-e.action.na),e.action&&void 0!==e.action.lm&&(n.action.lm=e.p[e.p.length-1],n.p=e.p.slice(0,e.p.length-1).concat([e.action.lm])),n},b.invert=function(e,t){for(var n=e.slice().reverse(),r=[],i=0;i<n.length;i++)r.push(b.invertComponent(n[i],t));return r},b.checkValidOp=function(e){if(!m(e))throw new Error("op is not array");for(var t=0;t<e.length;t++)if(!m(e[t].p))throw new Error("Missing path")},b.checkList=function(e){if(!m(e))throw new Error("Referenced element not a list")},b.checkObj=function(e){if(!(t=e)||t.constructor!==Object)throw new Error("Referenced element not an object (it was "+JSON.stringify(e)+")");var t},b.apply=function(e,t){b.checkValidOp(t),t=E(t);for(var n={data:e},r=0;r<t.length;r++){var i=t[r];!i.action||null==i.action.si&&null==i.action.sd||C(i);for(var o=null,s=n,u="data",l=0;l<i.p.length;l++){var c=i.p[l];if(o=s,s=s[u],u=c,null==o)throw new Error("Path invalid")}if(i.subType&&i.subType.t&&void 0!==i.subType.o&&T[i.subType.t])s[u]=T[i.subType.t].apply(s[u],i.subType.o);else if(i.action&&void 0!==i.action.na){if("number"!=typeof s[u])throw new Error("Referenced element not a number");s[u]+=i.action.na}else if(i.action&&void 0!==i.action.li&&void 0!==i.action.ld){if(b.checkList(s),!(0,a.isEqual)(s[u],i.action.ld))throw new Error("element does not match c.ld");s[u]=i.action.li}else if(i.action&&void 0!==i.action.li)b.checkList(s),s.splice(u,0,i.action.li);else if(i.action&&void 0!==i.action.ld){if(b.checkList(s),!(0,a.isEqual)(s[u],i.action.ld))throw new Error("element does not match c.ld");s.splice(u,1)}else if(i.action&&void 0!==i.action.lm){if(b.checkList(s),i.action.lm!=u){var h=s[u];s.splice(u,1),s.splice(i.action.lm,0,h)}}else if(i.action&&void 0!==i.action.oi)b.checkObj(s),s[u]=i.action.oi;else{if(!i.action||void 0===i.action.od)throw new Error("invalid / missing instruction in op");b.checkObj(s),delete s[u]}}return n.data},b.shatter=function(e){for(var t=[],n=0;n<e.length;n++)t.push([e[n]]);return t},b.incrementalApply=function(e,t,n){for(var r=0;r<t.length;r++){var i=[t[r]];n(i,e=b.apply(e,i))}return e};var w=b.pathMatches=function(e,t,n){if(e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r]&&(!n||r!==e.length-1))return!1;return!0};b.append=function(e,t){if(t=E(t),0!==e.length){var n=e[e.length-1];if(!t.action||!n.action||null==t.action.si&&null==t.action.sd||null==n.action.si&&null==n.action.sd||(C(t),C(n)),w(t.p,n.p))if(t.subType&&t.subType.t&&n.subType&&n.subType.t&&t.subType.t===n.subType.t&&T[t.subType.t]){if(n.subType.o=T[t.subType.t].compose(n.subType.o,t.subType.o),t.action&&(null!=t.action.si||null!=t.action.sd)){for(var r=t.p,i=0;i<n.subType.o.length-1;i++)t.subType.o=[n.subType.o.pop()],t.p=r.slice(),S(t),e.push(t);S(n)}}else n.action&&null!=n.action.na&&null!=t.action.na?e[e.length-1]={p:n.p,action:{na:n.action.na+t.action.na}}:n.action&&t.action&&void 0!==n.action.li&&void 0===t.action.li&&t.action.ld===n.action.li?void 0!==n.action.ld?delete n.action.li:e.pop():n.action&&t.action&&void 0!==n.action.od&&void 0===n.action.oi&&void 0!==t.action.oi&&void 0===t.action.od?n.action.oi=t.action.oi:n.action&&t.action&&void 0!==n.action.oi&&void 0!==t.action.od?t.action&&void 0!==t.action.oi?n.action.oi=t.action.oi:n.action&&void 0!==n.action.od?delete n.action.oi:e.pop():t.action&&void 0!==t.action.lm&&t.p[t.p.length-1]===t.action.lm||e.push(t);else!t.action||!n.action||null==t.action.si&&null==t.action.sd||null==n.action.si&&null==n.action.sd||(S(t),S(n)),e.push(t)}else e.push(t)},b.compose=function(e,t){b.checkValidOp(e),b.checkValidOp(t);for(var n=E(e),r=0;r<t.length;r++)b.append(n,t[r]);return n},b.normalize=function(e){var t=[];e=m(e)?e:[e];for(var n=0;n<e.length;n++){var r=e[n];null==r.p&&(r.p=[]),b.append(t,r)}return t},b.commonLengthForOps=function(e,t){var n=e.p.length,r=t.p.length;if((e.action&&null!=e.action.na||e.subType&&e.subType.t)&&n++,(t.action&&null!=t.action.na||t.subType&&t.subType.t)&&r++,0===n)return-1;if(0===r)return null;n--,r--;for(var i=0;i<n;i++){var o=e.p[i];if(i>=r||o!==t.p[i])return null}return n},b.canOpAffectPath=function(e,t){return null!=b.commonLengthForOps({p:t},e)},b.transformComponent=function(e,t,n,r){t=E(t);var i=b.commonLengthForOps(n,t),o=b.commonLengthForOps(t,n),a=t.p.length,s=n.p.length;if((t.action&&null!=t.action.na||t.subType&&t.subType.t)&&a++,(n.action&&null!=n.action.na||n.subType&&n.subType.t)&&s++,null!=o&&s>a&&t.p[o]==n.p[o])if(t.action&&void 0!==t.action.ld)(l=E(n)).p=l.p.slice(a),t.action.ld=b.apply(E(t.action.ld),[l]);else if(t.action&&void 0!==t.action.od){(l=E(n)).p=l.p.slice(a),t.action.od=b.apply(E(t.action.od),[l])}if(null!=i){var u=a==s,l=n;if(!t.action||!n.action||null==t.action.si&&null==t.action.sd||null==n.action.si&&null==n.action.sd||(C(t),C(l=E(n))),l.subType&&l.subType.t&&T[l.subType.t]){if(t.subType&&t.subType.t&&t.subType.t===l.subType.t){var c=T[t.subType.t].transform(t.subType.o,l.subType.o,r);if(!t.action||null==t.action.si&&null==t.action.sd)(!m(c)||c.length>0)&&(t.subType=t.subType||{},t.subType.o=c,b.append(e,t));else for(var h=t.p,d=0;d<c.length;d++)t.subType=t.subType||{},t.subType.o=[c[d]],t.p=h.slice(),S(t),b.append(e,t);return e}}else if(n.action&&void 0!==n.action.na);else if(n.action&&void 0!==n.action.li&&void 0!==n.action.ld){if(n.p[i]===t.p[i]){if(!u)return e;if(t.action&&void 0!==t.action.ld){if(!t.action||void 0===t.action.li||"left"!==r)return e;t.action.ld=E(n.action.li)}}}else if(n.action&&void 0!==n.action.li)t.action&&void 0!==t.action.li&&void 0===t.action.ld&&u&&t.p[i]===n.p[i]?"right"===r&&t.p[i]++:n.p[i]<=t.p[i]&&t.p[i]++,t.action&&void 0!==t.action.lm&&u&&n.p[i]<=t.action.lm&&t.action.lm++;else if(n.action&&void 0!==n.action.ld){if(t.action&&void 0!==t.action.lm&&u){if(n.p[i]===t.p[i])return e;h=n.p[i];var f=t.p[i];(h<(p=t.action.lm)||h===p&&f<p)&&t.action.lm--}if(n.p[i]<t.p[i])t.p[i]--;else if(n.p[i]===t.p[i]){if(s<a)return e;if(t.action&&void 0!==t.action.ld){if(void 0===t.action.li)return e;delete t.action.ld}}}else if(n.action&&void 0!==n.action.lm)if(t.action&&void 0!==t.action.lm&&a===s){f=t.p[i];var p=t.action.lm,v=n.p[i],g=n.action.lm;if(v!==g)if(f===v){if("left"!==r)return e;t.p[i]=g,f===p&&(t.action.lm=g)}else f>v&&t.p[i]--,f>g?t.p[i]++:f===g&&v>g&&(t.p[i]++,f===p&&t.action.lm++),(p>v||p===v&&p>f)&&t.action.lm--,p>g?t.action.lm++:p===g&&(g>v&&p>f||g<v&&p<f?"right"===r&&t.action.lm++:p>f?t.action.lm++:p===v&&t.action.lm--)}else if(t.action&&void 0!==t.action.li&&void 0===t.action.ld&&u){f=n.p[i],p=n.action.lm;(h=t.p[i])>f&&t.p[i]--,h>p&&t.p[i]++}else{f=n.p[i],p=n.action.lm;(h=t.p[i])===f?t.p[i]=p:(h>f&&t.p[i]--,(h>p||h===p&&f>p)&&t.p[i]++)}else if(n.action&&void 0!==n.action.oi&&void 0!==n.action.od){if(t.p[i]===n.p[i]){if(!t.action||void 0===t.action.oi||!u)return e;if("right"===r)return e;t.action.od=n.action.oi}}else if(n.action&&void 0!==n.action.oi){if(t.action&&void 0!==t.action.oi&&t.p[i]===n.p[i]){if("left"!==r)return e;b.append(e,{p:t.p,action:{od:n.action.oi}})}}else if(n.action&&void 0!==n.action.od&&t.p[i]==n.p[i]){if(!u)return e;if(!t.action||void 0===t.action.oi)return e;delete t.action.od}}return b.append(e,t),e},c(b,b.transformComponent,b.checkValidOp,b.append),b.registerSubtype(y);var R=b,A=n("vsh_83500");var O=new(function(){function e(){this.name="easysync",this.compose=A.composeOps}return e.prototype.transform=function(e,t,n){var i,o=e[A.ZONE_CHANGESETS],a=t[A.ZONE_CHANGESETS],s=(0,A.toString)(o),u=(new A.AttributePool).fromJsonable(e.apool),l=(new A.AttributePool).fromJsonable(t.apool),c=(0,A.moveOpsToNewPool)(s,u,l),h={},d=(0,A.toObject)(c);for(var f in a)a.hasOwnProperty(f)&&(h[f]=(0,A.follow)(a[f],d[f]||"",n!==r.LEFT,l));for(var f in o)a[f]||(h[f]=(0,A.follow)("",d[f]||"",n!==r.LEFT,l));return(i={})[A.ZONE_CHANGESETS]=h,i.apool=l.toJsonable(),i},e.prototype.invert=function(e,t){var n,r={},i=t.initialAttributedTexts,o=t.apool,a=i.attribs,s=i.text,u=(new A.AttributePool).fromJsonableNoCloning(o),c=(new A.AttributePool).fromJsonable(e.apool),h=e[A.ZONE_CHANGESETS],d=function(e){if(h.hasOwnProperty(e)){var t=a[e]||"|1+1",n=(s[e]||"\n").split("\n"),i=function(e){var t=(0,A.opIterator)(e),n=[];for(;t.hasNext();){var r=t.next();if("+"!==r.opcode)throw new Error("transformAttribsToAlines opcode must be +");var i=r.attribs+"|1+1";if(r.lines>1){var o=new Array(r.lines).fill(i);n.push.apply(n,l(o))}else n.push(i)}return n}(t),o=(0,A.moveOpsToNewPool)(h[e],c,u),d=(0,A.unpack)(o),f={get:function(e){return n[e]+"\n"}};r[e]=(0,A.doInverse)(d[e],f,i,u)}};for(var f in h)d(f);var p=new A.AttributePool,v=(0,A._pack)(r),g=(0,A.moveOpsToNewPool)(v,u,p);return(n={})[A.ZONE_CHANGESETS]=(0,A.toObject)(g),n.apool=p.toJsonable(),n},e.prototype.apply=function(e,t){var n=(new A.AttributePool).fromJsonableNoCloning(t.apool),r=(new A.AttributePool).fromJsonableNoCloning(e.apool),i=(0,A.moveOpsToNewPool)((0,A.toString)(t.zone_changesets),n,r),o=(0,A.applyToZatext)(i,e.initialAttributedTexts,r),a=new A.AttributePool;for(var s in o.attribs)o.attribs.hasOwnProperty(s)&&(o.attribs[s]=(0,A.moveOpsToNewPool)(o.attribs[s],r,a));return e.apool=a.toJsonable(),e.initialAttributedTexts=o,e},e}()),M=function(e,t){for(var n,r="data",i=((n={})[r]=e,n),o=0;o<t.length;){if(i=i[r],r=t[o],void 0===i)throw new Error("bad path");o+=1}return{elem:i,key:r}},k=function(e,t,n,r){var i=Array.prototype.slice.call(t),o=[];if(n.length>1&&"function"!=typeof i[i.length-1]&&i.push((function(){})),i.length<(r||n.length))i.unshift(o);else{var a=function(e){if(e instanceof Array)return e;if("number"==typeof e)return[e];if("string"==typeof e)return e.split(".");throw new Error("Invalid type of path: "+typeof e)}(i[0]);a&&(i[0]=o.concat(a))}return n.apply(e,i)},I=R.apply,x=R.compose,N=R.transform,P=R.invert;(0,R.registerSubtype)(O);var L=function(){function e(e,t,n){if(this.parent=null,this.children=null,this.id="",this.key="",this.snapshot="",!t)throw new Error("Node value cannot be empty");this.set([],t),this.id=o()(),this.parent=e,this.snapshot=(0,a.cloneDeep)(t),this.children=n}return e.registerSubtype=function(e){R.registerSubtype(e)},e.transform=function(e,t,n){return void 0===n&&(n=r.LEFT),N(e,t,n)},e.compose=function(e,t){return x(e,t)},e.invert=function(e,t){return P(e,t)},e.prototype.apply=function(e){var t=I(this.snapshot,e);this.set([],t)},e.prototype.get=function(e){var t=this;return e?k(this,arguments,(function(e){var n=M(t.snapshot,e);return n.elem[n.key]})):this.snapshot},e.prototype.move=function(e,t){var n=this;return k(this,arguments,(function(e,t){var r=M(n.snapshot,e),i=r.elem,o=r.key,a=[];if(i.constructor!==Array)throw new Error("bad path");var s=e;s[s.length-1]=parseInt(s[s.length-1],10),a.push({p:s,action:{lm:t}});var u=i.splice(o,1)[0];return i.splice(t,0,u),a}))},e.prototype.set=function(e,t){var n=this;return k(this,arguments,(function(e,t){var r=M(n.snapshot,e),i=r.elem,o=r.key,a=[];if(i.constructor===Array){var s=e;s[s.length-1]=parseInt(s[s.length-1],10),a.push({p:s,action:{li:t}}),void 0!==i[o]&&a.unshift({p:e,action:{ld:i[o]}}),i[o]=t}else{if("object"!=typeof i)throw new Error("bad path");a.push({p:e,action:{oi:t}}),void 0!==i[o]&&a.unshift({p:e,action:{od:i[o]}}),i[o]=t}return 0===e.length&&(n.snapshot=t),a}))},e.prototype.getSnapshot=function(){return this.snapshot},e.prototype.remove=function(e,t){var n=this;return k(this,arguments,(function(e,t){if(null==t||"function"==typeof t){var r=[];if(void 0===(a=(o=M(n.snapshot,e)).elem)[s=o.key])throw new Error("no element at that path");if(a.constructor===Array){var i=e;i[i.length-1]=parseInt(i[i.length-1],10),r.push({p:i,action:{ld:a[s]}}),a.splice(s,1)}else{if("object"!=typeof a)throw new Error("bad path");r.push({p:e,action:{od:a[s]}}),delete a[s]}return r}var o,a,s,u=parseInt(e.pop(),10);if("string"==typeof(a=(o=M(n.snapshot,e)).elem)[s=o.key]){var l=u,c=t,h={p:e.concat(u),action:{sd:o.elem[o.key].slice(l,l+c)}};return a[s]=a[s].substring(0,u)+a[s].substring(l+c),[h]}if(a[s].constructor===Array){for(var d=[],f=u;f<u+t;f++)d.push({p:e.concat(u),action:{ld:a[s][f]}}),a[s].splice(f,1);return d}throw new Error("element at path does not support range")}))},e.prototype.replaceString=function(e,t,n,r){var i=this;return k(this,arguments,(function(e,t,n,r){var o=M(i.snapshot,e),a=o.key,s=o.elem,u=s[a],l=[];if("string"==typeof u){if(t<0||t>u.length||n<0||t+n>u.length)throw new Error("bad path: start or end overflow");var c=u.substring(t,t+n);return c&&l.push({p:e.concat(t),action:{sd:c}}),r&&"string"==typeof r?l.push({p:e.concat(t),action:{si:r}}):r="",s[a]=u.substring(0,t)+r+u.substring(t+n),l}throw new Error("bad path: element the path ref is not string")}))},e}(),D=L},vsh_67017:function(e,t,n){e.exports=n("vsh_3410")},vsh_61496:function(e,t){"use strict";t.VY="#bacefd",t.YC="#3370ff",t.M8="#d9f5d6",t.X7="#eef6c6",t.Cb="#ffffff",t.hH="#dee0e3",t.xA="#1f2329",t.f5="#fed4a4",t.Vi="#ece2fe",t.S5="#fde2e2",t.R="#a9efe6",t.yO="#f8def8",t.p4="#b1e8fc",t.cS="#f8e6ab"},vsh_1278:function(e,t,n){var r,i=n("vsh_14224");
/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */!function(e){!function(t){var r="object"==typeof n.g?n.g:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),o=a(e);function a(e,t){return function(n,r){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:r}),t&&t(n,r)}}void 0===r.Reflect?r.Reflect=e:o=a(r.Reflect,o),function(e){var t=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,r=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",a="function"==typeof Object.create,s={__proto__:[]}instanceof Array,u=!a&&!s,l={create:a?function(){return ie(Object.create(null))}:s?function(){return ie({__proto__:null})}:function(){return ie({})},has:u?function(e,n){return t.call(e,n)}:function(e,t){return t in e},get:u?function(e,n){return t.call(e,n)?e[n]:void 0}:function(e,t){return e[t]}},c=Object.getPrototypeOf(Function),h="object"==typeof i&&{NODE_ENV:"production",CDN_URL:navigator.cdn_host+"/eesz/bear/sheet/module",FASTER_TEST:void 0}&&"true"==={NODE_ENV:"production",CDN_URL:navigator.cdn_host+"/eesz/bear/sheet/module",FASTER_TEST:void 0}.REFLECT_METADATA_USE_MAP_POLYFILL,d=h||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?te():Map,f=h||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?ne():Set,p=new(h||"function"!=typeof WeakMap?re():WeakMap);function v(e,t,n,r){if(D(n)){if(!G(e))throw new TypeError;if(!Y(t))throw new TypeError;return w(e,t)}if(!G(e))throw new TypeError;if(!V(t))throw new TypeError;if(!V(r)&&!D(r)&&!F(r))throw new TypeError;return F(r)&&(r=void 0),R(e,t,n=j(n),r)}function g(e,t){function n(n,r){if(!V(n))throw new TypeError;if(!D(r)&&!X(r))throw new TypeError;x(e,t,n,r)}return n}function _(e,t,n,r){if(!V(n))throw new TypeError;return D(r)||(r=j(r)),x(e,t,n,r)}function y(e,t,n){if(!V(t))throw new TypeError;return D(n)||(n=j(n)),O(e,t,n)}function m(e,t,n){if(!V(t))throw new TypeError;return D(n)||(n=j(n)),M(e,t,n)}function E(e,t,n){if(!V(t))throw new TypeError;return D(n)||(n=j(n)),k(e,t,n)}function b(e,t,n){if(!V(t))throw new TypeError;return D(n)||(n=j(n)),I(e,t,n)}function T(e,t){if(!V(e))throw new TypeError;return D(t)||(t=j(t)),N(e,t)}function C(e,t){if(!V(e))throw new TypeError;return D(t)||(t=j(t)),P(e,t)}function S(e,t,n){if(!V(t))throw new TypeError;D(n)||(n=j(n));var r=A(t,n,!1);if(D(r))return!1;if(!r.delete(e))return!1;if(r.size>0)return!0;var i=p.get(t);return i.delete(n),i.size>0||p.delete(t),!0}function w(e,t){for(var n=e.length-1;n>=0;--n){var r=(0,e[n])(t);D(r)||F(r)||(t=r)}return t}function R(e,t,n,r){for(var i=e.length-1;i>=0;--i){var o=(0,e[i])(t,n,r);if(!D(o)&&!F(o)){if(!V(o))throw new TypeError;r=o}}return r}function A(e,t,n){var r=p.get(e);if(D(r)){if(!n)return;r=new d,p.set(e,r)}var i=r.get(t);if(D(i)){if(!n)return;i=new d,r.set(t,i)}return i}function O(e,t,n){if(M(e,t,n))return!0;var r=ee(t);return!F(r)&&O(e,r,n)}function M(e,t,n){var r=A(t,n,!1);return!D(r)&&Z(r.has(e))}function k(e,t,n){if(M(e,t,n))return I(e,t,n);var r=ee(t);return F(r)?void 0:k(e,r,n)}function I(e,t,n){var r=A(t,n,!1);if(!D(r))return r.get(e)}function x(e,t,n,r){A(n,r,!0).set(e,t)}function N(e,t){var n=P(e,t),r=ee(e);if(null===r)return n;var i=N(r,t);if(i.length<=0)return n;if(n.length<=0)return i;for(var o=new f,a=[],s=0,u=n;s<u.length;s++){var l=u[s];o.has(l)||(o.add(l),a.push(l))}for(var c=0,h=i;c<h.length;c++){l=h[c];o.has(l)||(o.add(l),a.push(l))}return a}function P(e,t){var n=[],r=A(e,t,!1);if(D(r))return n;for(var i=q(r.keys()),o=0;;){var a=J(i);if(!a)return n.length=o,n;var s=$(a);try{n[o]=s}catch(e){try{Q(i)}finally{throw e}}o++}}function L(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function D(e){return void 0===e}function F(e){return null===e}function B(e){return"symbol"==typeof e}function V(e){return"object"==typeof e?null!==e:"function"==typeof e}function H(e,t){switch(L(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",i=K(e,r);if(void 0!==i){var o=i.call(e,n);if(V(o))throw new TypeError;return o}return U(e,"default"===n?"number":n)}function U(e,t){if("string"===t){var n=e.toString;if(z(n))if(!V(i=n.call(e)))return i;if(z(r=e.valueOf))if(!V(i=r.call(e)))return i}else{var r;if(z(r=e.valueOf))if(!V(i=r.call(e)))return i;var i,o=e.toString;if(z(o))if(!V(i=o.call(e)))return i}throw new TypeError}function Z(e){return!!e}function W(e){return""+e}function j(e){var t=H(e,3);return B(t)?t:W(t)}function G(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function z(e){return"function"==typeof e}function Y(e){return"function"==typeof e}function X(e){switch(L(e)){case 3:case 4:return!0;default:return!1}}function K(e,t){var n=e[t];if(null!=n){if(!z(n))throw new TypeError;return n}}function q(e){var t=K(e,o);if(!z(t))throw new TypeError;var n=t.call(e);if(!V(n))throw new TypeError;return n}function $(e){return e.value}function J(e){var t=e.next();return!t.done&&t}function Q(e){var t=e.return;t&&t.call(e)}function ee(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===c)return t;if(t!==c)return t;var n=e.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return t;var i=r.constructor;return"function"!=typeof i||i===e?t:i}function te(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[o]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var r=this._keys.length,i=n+1;i<r;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,r)},t.prototype.values=function(){return new n(this._keys,this._values,i)},t.prototype.entries=function(){return new n(this._keys,this._values,a)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[o]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function r(e,t){return e}function i(e,t){return t}function a(e,t){return[e,t]}}function ne(){return function(){function e(){this._map=new d}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[o]=function(){return this.keys()},e}()}function re(){var e=16,n=l.create(),r=i();return function(){function e(){this._key=i()}return e.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&l.has(t,this._key)},e.prototype.get=function(e){var t=o(e,!1);return void 0!==t?l.get(t,this._key):void 0},e.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=i()},e}();function i(){var e;do{e="@@WeakMap@@"+u()}while(l.has(n,e));return n[e]=!0,e}function o(e,n){if(!t.call(e,r)){if(!n)return;Object.defineProperty(e,r,{value:l.create()})}return e[r]}function a(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function s(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):a(new Uint8Array(e),e):a(new Array(e),e)}function u(){var t=s(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var n="",r=0;r<e;++r){var i=t[r];4!==r&&6!==r&&8!==r||(n+="-"),i<16&&(n+="0"),n+=i.toString(16).toLowerCase()}return n}}function ie(e){return e.__=void 0,delete e.__,e}e("decorate",v),e("metadata",g),e("defineMetadata",_),e("hasMetadata",y),e("hasOwnMetadata",m),e("getMetadata",E),e("getOwnMetadata",b),e("getMetadataKeys",T),e("getOwnMetadataKeys",C),e("deleteMetadata",S)}(o)}()}(r||(r={}))},vsh_3083:function(e,t,n){!function(e,t){"use strict";var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},n(e,t)};function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function i(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function o(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}var a=function(e){function n(t){var n=e.call(this,null)||this;return n.widget=t,n._isWidgetDirty=!1,n._onWidgetDirty=null,n._dispatcher=null,n._getOffset=null,n._getTransform=null,n.updateByCfg({skipSelfEvent:!0}),n.setRootId(t.rootId()),n.addChild(t),n}return r(n,e),n.prototype.dispatcher=function(){return this._dispatcher},n.prototype._setProps=function(e,n){e===t.WidgetProps.ChildDirty&&(this._isWidgetDirty=!0,this._onWidgetDirty&&this._onWidgetDirty())},n.prototype.beforeRemoveChild=function(e){this._dispatcher&&this._dispatcher.updateAutoCapture(e)},n.prototype.initEnv=function(e){"ssr"==="production".toLowerCase()||(this._dispatcher=new t.Dispatcher(e.browser.canvas),this._dispatcher.setRoot(this.widget),this._dispatcher.bindEvents(),this._dispatcher.setOffsetDirty())},n.prototype.miniProps=function(){var e=this;return{RNodeType:"Faster_0.x_widget",createRNode:function(){return e}}},n.prototype.defineGetTransform=function(e){this._getTransform=e},n.prototype.defineGetOffset=function(e){this._getOffset=e},n.prototype.build=function(){this.widget.flush()},n.prototype.layout=function(e){return this._dispatcher&&this._dispatcher.refreshCursor(),"function"==typeof this.widget.layout?this.widget.layout(e):(this.width=e.maxWidth<Number.MAX_SAFE_INTEGER?e.maxWidth:this.widget.width,this.height=e.maxHeight<Number.MAX_SAFE_INTEGER?e.maxHeight:this.widget.height,{width:this.width,height:this.height})},n.prototype.paint=function(e,t){this.widget.paint(e,this.widget.paintedRect())},n.prototype.mapFromParent=function(e){if(this._getOffset){var n=this._getOffset(),r=n.x,i=n.y;e.move(-r,-i)}if(this._getTransform){var o=this._getTransform();new t.TMatrix(o.a,o.b,o.c,o.d,o.e,o.f).inversePoint(e)}return e},n.prototype.mapToParent=function(e){if(this._getTransform){var n=this._getTransform();new t.TMatrix(n.a,n.b,n.c,n.d,n.e,n.f).mapPoint(e)}if(this._getOffset){var r=this._getOffset(),i=r.x,o=r.y;e.move(i,o)}return e},n.prototype.destroy=function(){return this._dispatcher&&this._dispatcher.unbindEvents(),this.widget&&this.widget.destroy(),e.prototype.destroy.call(this)},n.prototype.isDirty=function(){return this._isWidgetDirty},n.prototype.subscribeDirty=function(e){this._onWidgetDirty=e},n.prototype.dispatchEvent=function(e){if(this._dispatcher){t.Dispatcher.cursorRootId=this.widget.UID;var n=this._getOffset?this._getOffset():new t.FPoint(0,0),r=this._getTransform?this._getTransform():void 0;return this._dispatcher.processDomEvent(e,n,r)}return!1},n.widgetAdapterMap=new Map,n}(t.FWidget),s=null,u=function(){s||(s=setInterval((function(){a.widgetAdapterMap.forEach((function(e,t){e.widget&&e.widget.destroied()&&a.widgetAdapterMap.delete(t)}))}),3e3))};function l(e){if(!a.widgetAdapterMap.has(e)){var t=new a(e);return a.widgetAdapterMap.set(e,t),t}return a.widgetAdapterMap.get(e)}t.FApp.onAppExit((function(){a.widgetAdapterMap.forEach((function(e){t.Dispatcher.unbindEvents(e._dispatcher)})),a.widgetAdapterMap.clear(),s&&(clearInterval(s),s=null)})),t.FApp.onAppRun((function(){return u()}));var c=function(e){function n(n){var r=e.call(this,null)||this;return r.rNode=n,r._width=0,r._height=0,r.draggable=!0,r.droppable=!0,r.rNode.subscribeDirty((function(){r._changes.set("_phantom",{current:!0,before:void 0}),r._dirtyParent()})),r.rNode.defineGetOffset((function(){return r.mapToGlobal(new t.FPoint(0,0))})),r.rNode.defineGetTransform((function(){return r.mapTransformToGlobal(new t.TMatrix)})),r}return r(n,e),Object.defineProperty(n.prototype,"width",{get:function(){return this._width||0},set:function(e){this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height||0},set:function(e){this._height=e},enumerable:!1,configurable:!0}),n.prototype.setRootId=function(n){e.prototype.setRootId.call(this,n),"function"==typeof this.rNode.setRootId&&this.rNode.setRootId(n);var r=t.Faster.findFaster(this);if(r){var i=r.canvas().element();this.rNode.initEnv({browser:{canvas:i}})}},n.prototype.updateByCfg=function(t){return"function"==typeof this.rNode.updateState&&this.rNode.updateState(t),e.prototype.updateByCfg.call(this,t)},n.prototype.destroy=function(){"function"==typeof this.rNode.destroy&&this.rNode.destroy(),e.prototype.destroy.call(this)},n.prototype.paint=function(e,t){var n=this.pCfg||this._cfg,r=n.x,i=n.y;t.x-=r,t.y-=i,e.translate(r,i),this.rNode.paint(e,t),e.translate(-r,-i)},n.prototype.flush=function(){e.prototype.flush.call(this),this.rNode.build();var n=this.parent();n&&this.layout(new t.Constraint({minWidth:0,minHeight:0,maxWidth:n.width,maxHeight:n.height}))},n.prototype.layout=function(e){var t=this.rNode.layout({maxHeight:e.maxHeight,minHeight:e.minHeight,maxWidth:e.maxWidth,minWidth:e.minWidth}),n=t.width,r=t.height;return this.width=n,this.height=r,this.size},n.prototype.event=function(t){var n=e.prototype.event.call(this,t);if(t.nativeEvent){var r=this.rNode.dispatchEvent(t.nativeEvent),i=t.nativeEvent instanceof Event?t.nativeEvent:t.nativeEvent.srcEvent;return i&&i.defaultPrevented&&t.srcEventPreventDefault(),r}return n},n.prototype.hitTest=function(e,t,n){if(this.rNode.widget){if(null!==this.rNode.widget.findWidget(e,t))return!0;if(void 0!==n&&"mousemove"===n.type){var r=this.rNode._dispatcher;if(r){var i=n,o=i.buttons,a=i.ctrlKey,s=i.shiftKey,u=i.altKey,l=i.metaKey;r._enterLeaveDispatch(!0,null,n,{globalX:0,globalY:0,buttons:o,ctrlKey:a,shiftKey:s,altKey:u,metaKey:l})}}return!1}return!0},n}(t.FWidget);function h(e){return new c(e)}var d={F2R:l,R2F:h},f=function(e){function n(n){var r=e.call(this)||this;return r.widget=n,r._isWidgetDirty=!1,r._onWidgetDirty=null,r._dispatcher=null,r._getOffset=null,r._getTransform=null,r.skipSelfEvent=!0,r._changedWidgets=new t.ChangedList,r._changedWidgets.setInsertCallback((function(){r._isWidgetDirty=!0,r._onWidgetDirty&&r._onWidgetDirty()})),r.setRootId(n.rootId()),r.addChild(n),r.changedListId=r._changedWidgets.id,n.changedListId=r._changedWidgets.id,r._changedWidgets.insert({uid:n.UID}),r}return r(n,e),n.prototype.dispatcher=function(){return this._dispatcher},n.prototype.initEnv=function(e){"ssr"==="production".toLowerCase()||(this._dispatcher=new t.Dispatcher(e.browser.canvas),this._dispatcher.setRoot(this.widget),this._dispatcher.bindEvents(),this._dispatcher.setOffsetDirty())},n.prototype.miniProps=function(){var e=this;return{RNodeType:"Faster_1.x_widget",createRNode:function(){return e}}},n.prototype.defineGetTransform=function(e){this._getTransform=e},n.prototype.defineGetOffset=function(e){this._getOffset=e},n.prototype.build=function(){var e=this.miniProps();Object.keys(e).map((function(t){"RNodeType"!==t&&"createRNode"!==t&&e[t]})),this.widget.build(),this._isWidgetDirty=!1,this._changedWidgets.clear()},n.prototype.performLayout=function(e){return this._dispatcher&&this._dispatcher.refreshCursor(),this.size=this.widget.layout(new t.Constraint(e)),{width:this.size.width,height:this.size.height}},n.prototype.updateState=function(e){this.widget.updateState(e)},n.prototype.destroy=function(){return this._dispatcher&&this._dispatcher.unbindEvents(),this._changedWidgets.destroy(),this.widget&&this.widget.destroy(),e.prototype.destroy.call(this)},n.prototype.mapTransformToParent=function(e){if(this._getTransform){var t=this._getTransform();e.transform(t.a,t.b,t.c,t.d,t.e,t.f)}return e},n.prototype.mapFromParent=function(e){if(this._getOffset){var n=this._getOffset(),r=n.x,i=n.y;e.move(-r,-i)}if(this._getTransform){var o=this._getTransform();new t.TMatrix(o.a,o.b,o.c,o.d,o.e,o.f).inversePoint(e)}return e},n.prototype.mapToParent=function(e){if(this._getTransform){var n=this._getTransform();new t.TMatrix(n.a,n.b,n.c,n.d,n.e,n.f).mapPoint(e)}if(this._getOffset){var r=this._getOffset(),i=r.x,o=r.y;e.move(i,o)}return e},n.prototype.paint=function(e,n){n?this.widget.renderTree(e,new t.FRect(n.x,n.y,n.width,n.height)):this.widget.renderTree(e)},n.prototype.isDirty=function(){return this._isWidgetDirty},n.prototype.subscribeDirty=function(e){this._onWidgetDirty=e,!0===this._isWidgetDirty&&this._onWidgetDirty()},n.prototype.dispatchEvent=function(e){if(this._dispatcher){t.Dispatcher.cursorRootId=this.widget.UID;var n=this._getOffset?this._getOffset():new t.FPoint(0,0),r=this._getTransform?this._getTransform():void 0;return this._dispatcher.processDomEvent(e,n,r)}return!1},i([t.State,o("design:type",Boolean)],n.prototype,"skipSelfEvent",void 0),n}(t.FBase);function p(e){return new f(e)}var v=function(e){function n(t){var n=e.call(this)||this;return n.draggable=!0,n.droppable=!0,n.rNode=null,n._rNodeType="",n._defineRNode(t.rNode),n}return r(n,e),n.prototype.onStateChange=function(e){if(this.state&&this.rNode!==e.data.rNode){e.data.rNode&&this._defineRNode(e.data.rNode);var t=this.rNode;this.rNode=e.data.rNode,t&&(t.widget=null,t.destroy&&t.destroy())}},n.prototype._defineRNode=function(e){var n=this,r=e.miniProps();this._rNodeType=r.RNodeType,e.subscribeDirty((function(){if(e.widget){var r=t.ChangedList.get(n.changedListId);r&&r.insert({uid:n.UID})}})),e.defineGetOffset((function(){return n.mapToGlobal(new t.FPoint(0,0))})),e.defineGetTransform((function(){return n.mapTransformToGlobal(new t.TMatrix)}));var i=t.Faster.findFaster(this);if(i){var o=i.canvas().element();e.initEnv({browser:{canvas:o}})}},n.prototype.setRootId=function(n){e.prototype.setRootId.call(this,n),this.rNode&&"function"==typeof this.rNode.setRootId&&this.rNode.setRootId(n);var r=t.Faster.findFaster(this);if(r){var i=r.canvas().element();this.rNode&&this.rNode.initEnv({browser:{canvas:i}})}},n.prototype.updateState=function(t){if(this.rNode&&"function"==typeof this.rNode.updateByCfg){var n={};for(var r in t)"ctor"!==r&&(n[r]=t[r]);this.rNode.updateByCfg(n)}e.prototype.updateState.call(this,t)},n.prototype.destroy=function(){this.rNode&&"function"==typeof this.rNode.destroy&&this.rNode.destroy(),e.prototype.destroy.call(this)},n.prototype.build=function(){if(e.prototype.build.call(this),this.rNode){var t=this.rNode.miniProps();t.RNodeType!==this._rNodeType?(this.rNode=t.createRNode(),this._rNodeType=t.RNodeType):this.rNode.isDirty()&&this.rNode.build()}},n.prototype.paintSelf=function(e,t){this.rNode&&(e.translate(this.pos.x,this.pos.y),this.rNode.paint(e,t?t.clone():this.boundaryRect()),e.translate(-this.pos.x,-this.pos.y))},n.prototype.performLayout=function(e){return this.rNode&&(this.size=this.rNode.layout({maxHeight:e.maxHeight,minHeight:e.minHeight,maxWidth:e.maxWidth,minWidth:e.minWidth})),this.size},n.prototype.event=function(t){var n=e.prototype.event.call(this,t);if(t.nativeEvent&&this.rNode){var r=this.rNode.dispatchEvent(t.nativeEvent),i=t.nativeEvent instanceof Event?t.nativeEvent:t.nativeEvent.srcEvent;return i&&i.defaultPrevented&&t.srcEventPreventDefault(),r}return n},n.prototype.hitTest=function(e,t,n){if(this.rNode&&this.rNode.widget){if(null!==this.rNode.widget.findWidget(e,t))return!0;if(void 0!==n&&"mousemove"===n.type){var r=this.rNode._dispatcher;if(r){var i=n,o=i.buttons,a=i.ctrlKey,s=i.shiftKey,u=i.altKey,l=i.metaKey;r._enterLeaveDispatch(!0,null,n,{globalX:0,globalY:0,buttons:o,ctrlKey:a,shiftKey:s,altKey:u,metaKey:l})}}return!1}return!0},i([t.State,o("design:type",Boolean)],n.prototype,"draggable",void 0),i([t.State,o("design:type",Boolean)],n.prototype,"droppable",void 0),i([t.State,o("design:type",Object)],n.prototype,"rNode",void 0),n}(t.FBaseWidget),g=new Map,_=null,y=function(){_||(_=setInterval((function(){g.forEach((function(e,t){t.widget&&t.widget.destroied()&&g.delete(t)}))}),3e3))};function m(e){return g.has(e)||g.set(e,v),new t.FState(g.get(e),{rNode:e})}t.FApp.onAppExit((function(){g.clear(),_&&(clearInterval(_),_=null)})),t.FApp.onAppRun((function(){return y()}));var E={F2R:p,R2F:m};function b(e){return E.R2F(d.F2R(e))}function T(e){return d.R2F(E.F2R(e))}var C=function(e){function t(t){var n=e.call(this)||this;return n.widget=t,n}return r(t,e),t.prototype.setRootId=function(t){e.prototype.setRootId.call(this,t),this.widget.setRootId(t)},t.prototype.describe=function(){return b(this.widget)},t.prototype.destroy=function(){this.widget.destroy(),e.prototype.destroy.call(this)},Object.defineProperty(t.prototype,"cursor",{get:function(){return this.widget.cursor},enumerable:!1,configurable:!0}),t}(t.FBaseWidget);function S(e){return new C(e)}function w(e){var t=e.app();if(!t)return null;var n=t.rNode;if(!n)return null;var r=n.dispatcher();return r?{app:t,rootDispatcher:r,fasterDispatcher:e.dispatcher()}:null}function R(e,t){var n=w(e);if(n){var r=n.app,i=n.fasterDispatcher,o=n.rootDispatcher;i.capture(r),o.capture(t)}}function A(e,t){var n=w(e);if(n){var r=n.app,i=n.fasterDispatcher,o=n.rootDispatcher;i.setCursorWidget(r),o.setCursorWidget(t)}}function O(e){var t=w(e);if(t){var n=t.fasterDispatcher,r=t.rootDispatcher;n.releaseCapture(),r.releaseCapture()}}e.F2RAdapter0=a,e.F2RAdapter1=f,e.R2FAdapter0=c,e.R2FAdapter1=v,e.RWrapper0=d,e.RWrapper1=E,e.base2Widget=T,e.fasterCaputre=R,e.releaseFasterCaputre=O,e.setFasterCursorWidget=A,e.widget2Base=S,e.widget2State=b,Object.defineProperty(e,"__esModule",{value:!0})}(t,n("vsh_33916"))},vsh_33916:function(e,t,n){!function(e,t){"use strict";var r=void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function i(e,t,n){void 0===r.__FASTER_VERSION__[e]&&(r.__FASTER_VERSION__[e]=[]);for(var i,o=r.__FASTER_VERSION__[e],a=0,s=o.length;a<s&&void 0!==(i=o[a])[t];a++);return a===s&&(i={},o.push(i)),i[t]=n,a}function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}void 0===r.__FASTER_META__&&(r.__FASTER_META__={}),void 0===r.__FASTER_VERSION__&&(r.__FASTER_VERSION__={}),void 0===r.__USE_FASTER_VERSION__&&(r.__USE_FASTER_VERSION__=function(e,t){var n=r.__FASTER_VERSION__[e];if(n){var i=n[t=void 0===t?0:t];i&&(r.__FASTER_META__=Object.assign({},i))}});var a=o(t);function s(){return{a:1,b:0,c:0,d:1,e:0,f:0}}function u(e){return{a:e.a,b:e.b,c:e.c,d:e.d,e:e.e,f:e.f}}function l(e){return e&&e.length?e[e.length-1]:null}function c(e,t){if(e.length)return e[e.length-1];var n=t();return e.push(n),n}function h(e){var t=e.prototype;if(!t.getTransform){var n=t.save,r=t.restore,i=t.transform,o=t.setTransform,a=t.resetTransform,h=t.scale,d=t.rotate,f=t.translate;t.getTransform=function(){return l(this._t2stack)||s()},t.save=function(){var e=this._t2stack||(this._t2stack=[]);e.push(u(l(e)||s())),n.call(this)},t.restore=function(){this._t2stack&&this._t2stack.pop(),r.call(this)},t.transform=function(e,t,n,r,o,a){var u=c(this._t2stack||(this._t2stack=[]),s),l=u.a*e+u.c*t,h=u.b*e+u.d*t,d=u.a*n+u.c*r,f=u.b*n+u.d*r,p=u.e+u.a*o+u.c*a,v=u.f+u.b*o+u.d*a;u.a=l,u.b=h,u.c=d,u.d=f,u.e=p,u.f=v,i.call(this,e,t,n,r,o,a)},t.setTransform=function(e,t,n,r,i,a){var u,l=this._t2stack||(this._t2stack=[]);u="number"==typeof e?{a:e,b:t,c:n,d:r,e:i,f:a}:e?{a:e.a||1,b:e.b||0,c:e.c||0,d:e.d||1,e:e.e||0,f:e.f||0}:s(),l.length?l[l.length-1]=u:l.push(u),o.call(this,u)},t.resetTransform=function(){var e=this._t2stack;e&&e.length&&(e[e.length-1]=s()),a&&a.call(this)},t.scale=function(e,t){var n=c(this._t2stack||(this._t2stack=[]),s);e=e||1,t=t||e,n.a*=e,n.b*=e,n.c*=t,n.d*=t,h.call(this,e,t)},t.rotate=function(e){var t=c(this._t2stack||(this._t2stack=[]),s),n=Math.cos(-e),r=Math.sin(-e),i=t.a*n-t.c*r,o=t.b*n-t.d*r,a=t.c*n+t.a*r,u=t.d*n+t.b*r;t.a=i,t.b=o,t.c=a,t.d=u,d.call(this,e)},t.translate=function(e,t){var n=c(this._t2stack||(this._t2stack=[]),s);n.e+=e*n.a+t*n.c,n.f+=e*n.b+t*n.d,f.call(this,e,t)}}}function d(e){e.prototype.roundRect||(e.prototype.roundRect=f)}function f(e,t,n,r,i){var o,a=p(i);switch(a.length){case 1:var s=a[0];if(!s.x)return this.rect(e,t,n,r);o=[s,s,s,s];break;case 4:o=a;break;case 0:return this.rect(e,t,n,r);case 2:o=[a[0],a[1],a[0],a[1]];break;case 3:o=[a[0],a[1],a[2],a[1]]}g(n,r,o),this.moveTo(e+o[0].x,t),this.ellipse(e+n-o[1].x,t+o[1].y,o[1].x,o[1].y,0,-Math.PI/2,0),this.ellipse(e+n-o[2].x,t+r-o[2].y,o[2].x,o[2].y,0,0,Math.PI/2),this.ellipse(e+o[3].x,t+r-o[3].y,o[3].x,o[3].y,0,Math.PI/2,Math.PI),this.ellipse(e+o[0].x,t+o[0].y,o[0].x,o[0].y,0,Math.PI,1.5*Math.PI),this.closePath(),this.moveTo(e,t)}function p(e){if("number"==typeof e)return[v(e)];if(Array.isArray(e)){for(var t=Array.from({length:e.length}),n=0;n<e.length;++n)t[n]=v(e[n]);return t}return e?[v(e)]:[]}function v(e){return"number"==typeof e?e>0?{x:e,y:e}:{x:0,y:0}:(null==e.x||e.x>0)&&(null==e.y||e.y>0)?{x:e.x||0,y:e.y||0}:{x:0,y:0}}function g(e,t,n){var r=Math.min(Math.abs(e)/(n[0].x+n[1].x),Math.abs(t)/(n[1].y+n[2].y),Math.abs(e)/(n[2].x+n[3].x),Math.abs(t)/(n[0].y+n[3].y));if(r<=1)for(var i=0;i<4;++i)n[i].x*=r,n[i].y*=r}"undefined"!=typeof CanvasRenderingContext2D&&(h(CanvasRenderingContext2D),d(CanvasRenderingContext2D)),"undefined"!=typeof OffscreenCanvasRenderingContext2D&&(h(OffscreenCanvasRenderingContext2D),d(OffscreenCanvasRenderingContext2D)),"undefined"!=typeof Path2D&&d(Path2D);var _=function(e,t){return _=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},_(e,t)};function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}_(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var m=function(){return m=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},m.apply(this,arguments)};function E(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function b(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function T(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function C(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function S(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function w(e,t){for(;null!==e;){if(t(e))return!0;e=e.parent()}return!1}function R(e,t){e.children().length>0&&e.children().forEach((function(e){var n=e;t(n),R(n,t)}))}function A(e,t,n,r){void 0===r&&(r=0);var i=document.createElement("script");i.type="text/javascript",i.readyState?i.onreadystatechange=function(){"loaded"!==i.readyState&&"complete"!==i.readyState||(i.onreadystatechange=null,t&&t())}:(i.onload=function(){t&&t()},i.onerror=function(){0===r?(document.body.removeChild(i),A(e,t,n,1)):n&&n()}),i.src=e,document.body.appendChild(i)}var O,M,k=function(){function e(e){this._arr=e,this._idx=Number.NEGATIVE_INFINITY}return e.prototype.reset=function(e){this._arr=e,this._idx=Number.NEGATIVE_INFINITY},e.prototype.next=function(){return this._idx===Number.NEGATIVE_INFINITY&&(this._idx=-1),this._idx>=this._arr.length-1?(this._idx=Number.NEGATIVE_INFINITY,null):(this._idx++,this)},e.prototype.prev=function(){return this._idx===Number.NEGATIVE_INFINITY&&(this._idx=this._arr.length),this._idx<=0?(this._idx=Number.NEGATIVE_INFINITY,null):(this._idx--,this)},e.prototype.value=function(){return this._arr[this._idx]},e.prototype.isLast=function(){return this._idx===this._arr.length-1},e.prototype.isValid=function(){return this._idx!==Number.NEGATIVE_INFINITY},e.prototype.seek=function(e){return e>=0&&e<this._arr.length?this._idx=e:this._idx=Number.NEGATIVE_INFINITY,this},e.prototype.idx=function(){return this._idx},e}(),I=function(){function e(e,t){void 0===t&&(t=[]),this._compare=e,this._arr=t}return e.prototype.insert=function(e,t){void 0!==t?this._backInsert(t,e):this._backInsert(e,e)},e.prototype.find=function(e,t){for(var n=0,r=this._arr.length-1;n<=r;){var i=Math.floor((r+n)/2),o=this._compare(e,this._arr[i]);if(o>0)n=i+1;else{if(!(o<0))return i;r=i-1}}return t&&this._arr.length>0?(i=Math.min(n,r),Math.max(i,0)):-1},e.prototype.remove=function(e,t){return this._arr.splice(e,t)},e.prototype.at=function(e){return this._arr[e]},e.prototype.last=function(){return this._arr[this._arr.length-1]||null},e.prototype.first=function(){return this._arr[0]||null},e.prototype.len=function(){return this._arr.length},e.prototype.lbound=function(e,t){var n=this.find(e,t);if(-1===n)return n;var r=this._compare(e,this._arr[n]);if(0===r)for(;n-1>=0&&0===this._compare(e,this._arr[n-1]);)--n;else t&&r<0&&n>0&&--n;return n},e.prototype.ubound=function(e,t){var n=this.find(e,t);if(-1===n)return n;var r=this._compare(e,this._arr[n]);if(0===r)for(;n+1<this._arr.length&&0===this._compare(e,this._arr[n+1]);)++n;else t&&r>0&&n<this._arr.length-1&&++n;return n},e.prototype.clear=function(){this._arr.length=0},e.prototype.iter=function(){return new k(this._arr)},e.prototype.getArray=function(){return this._arr},e.prototype.toArray=function(){return this._arr.slice()},e.prototype._backInsert=function(e,t){var n=this.ubound(e,!0);-1!==n?(this._compare(e,this._arr[n])>=0&&++n,this._arr.splice(n,0,t)):this._arr.push(t)},e}();function x(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(typeof e!=typeof t)return!1;if("object"!=typeof e)return!1;if(Array.isArray(e)!==Array.isArray(t))return!1;var n,r;if(Array.isArray(e)){if(e.length!==t.length)return!1;for(n=0;n<e.length;n++)if(!x(e[n],t[n]))return!1}else{var i=[];for(r in e)i.push(r);i.sort();var o=[];for(r in t)o.push(r);if(o.sort(),!x(i,o))return!1;for(n=0;n<i.length;n++)if(!x(e[i[n]],t[i[n]]))return!1}return!0}e.borderDash=void 0,(M=e.borderDash||(e.borderDash={}))[M.Dash=0]="Dash",M[M.dash=0]="dash",e.BorderDash=void 0,(O=e.BorderDash||(e.BorderDash={}))[O.Dash=0]="Dash",O[O.dash=0]="dash";var N=[5,5];function P(e,t,n,r,i,o){return e instanceof Array?2===e.length?(void 0===n&&(n=e[0]),void 0===r&&(r=e[1]),void 0===i&&(i=e[0]),void 0===o&&(o=e[1])):4===e.length?(void 0===n&&(n=e[0]),void 0===r&&(r=e[1]),void 0===i&&(i=e[2]),void 0===o&&(o=e[3])):console.error("quater type must be a 2 or 4 element array."):(void 0===n&&(n=e),void 0===r&&(r=e),void 0===i&&(i=e),void 0===o&&(o=e)),void 0===n&&(n=t),void 0===r&&(r=t),void 0===i&&(i=t),void 0===o&&(o=t),[n,r,i,o]}var L="UID",D="transparent",F=0,B="fully-transparent black",V=0,H=0,U="#E3E5EA",Z="#efefef",W=8;function j(e,t,n,r,i,o,a,s){e.save(),s&&(e.shadowBlur=s.blur||F,e.shadowColor=s.color||B,e.shadowOffsetX=s.offsetX||V,e.shadowOffsetY=s.offsetY||H),e.fillStyle=o||D,e.beginPath(),a?e.roundRect(t,n,r,i,a):e.rect(t,n,r,i),e.fill(),e.restore()}function G(e,t,n){var r=Math.min(t,n)/2,i=C(P(e,0),4),o=i[0],a=i[1],s=i[2],u=i[3];return[o=Math.min(o,r),a=Math.min(a,r),s=Math.min(s,r),u=Math.min(u,r)]}var z,Y,X,K,q,$=function(){function e(e){this.p=e,this.recycleMap={}}return e.prototype.recycle=function(){var e=this;this.p.children().forEach((function(t){t.key?e.recycleMap[t.key]=t:e.recycleMap[t.UID]=t})),this.p.dangerousRemoveAllChild()},e.prototype.useWidget=function(e,t,n){var r=void 0===t?e.x:t,i=void 0===n?e.y:n;if(!e.key){var o=this.recycleMap[e.UID];return o?(delete this.recycleMap[e.UID],this.initWidget(o,r,i)):this.initWidget(e,r,i)}var a=this.recycleMap[e.key];return a?(delete this.recycleMap[e.key],a===e||e.destroy(),this.initWidget(a,r,i)):this.initWidget(e,r,i)},e.prototype.initWidget=function(e,t,n){return e.setParent(this.p),e.updateByCfg({x:t,y:n}),e},e.prototype.clear=function(){for(var e in this.recycleMap)this.recycleMap[e].destroy(),delete this.recycleMap[e]},e}(),J=function(){function e(e){void 0===e&&(e="faster-single-canvas"),this._map=new Map,this._canvas=null,this._activeFaster=null,this._canvas=document.createElement("canvas"),this._canvas.classList.add(e)}return Object.defineProperty(e.prototype,"canvas",{get:function(){return this._canvas},enumerable:!1,configurable:!0}),e.prototype.wakeup=function(e){e!==this._activeFaster&&this._map.has(e)&&(this.suspend(),this._map.get(e).appendChild(this._canvas),e.wakeup(),this._activeFaster=e)},e.prototype.suspend=function(){this._activeFaster&&(this._activeFaster.suspend(),this._activeFaster=null)},e.prototype.destroyFaster=function(e){this._map.has(e)&&(this._activeFaster===e&&this.suspend(),this._map.delete(e),e.destroy())},e.prototype.createFaster=function(e,t,n){this.suspend(),t.appendChild(this._canvas);var r=new e(this._canvas,n);return this._activeFaster=r,this._map.set(r,t),r},e.prototype.destroy=function(){this._map.clear(),this._activeFaster=null,this._canvas=null},e}();e.Cursor=void 0,(q=e.Cursor||(e.Cursor={})).Auto="Auto",q.Default="Default",q.None="None",q.ContextMenu="ContextMenu",q.Help="Help",q.Pointer="Pointer",q.Progress="Progress",q.Wait="Wait",q.Cell="Cell",q.Crosshair="Crosshair",q.Text="Text",q.VerticalText="VerticalText",q.Alias="Alias",q.Copy="Copy",q.Move="Move",q.NoDrop="NoDrop",q.NotAllowed="NotAllowed",q.Grab="Grab",q.Grabbing="Grabbing",q.AllScroll="AllScroll",q.ColResize="ColResize",q.RowResize="RowResize",q.NResize="NResize",q.EResize="EResize",q.SResize="SResize",q.WResize="WResize",q.NEResize="NEResize",q.NWResize="NWResize",q.SEResize="SEResize",q.SWResize="SWResize",q.EWResize="EWResize",q.NSResize="NSResize",q.NESWResize="NESWResize",q.NWSEResize="NWSEResize",q.ZoomIn="ZoomIn",q.ZoomOut="ZoomOut",e.VisibilityState=void 0,(K=e.VisibilityState||(e.VisibilityState={})).Hidden="hidden",K.Visible="visible",K.PreRender="prerender",e.EFasterNodeConstructors=void 0,(X=e.EFasterNodeConstructors||(e.EFasterNodeConstructors={})).FBASEWIDGET="FBaseWidget",X.FOBJ="FObj",e.EFasterVersion=void 0,(Y=e.EFasterVersion||(e.EFasterVersion={})).FASTER_100="1.0.0",Y.FASTER_090="0.9.0",e.ColorThemeType=void 0,(z=e.ColorThemeType||(e.ColorThemeType={}))[z.Background=0]="Background",z[z.Border=1]="Border",z[z.Color=2]="Color";var Q=function(){function e(e,t,n,r,i,o){void 0===e&&(e=1),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=1),void 0===i&&(i=0),void 0===o&&(o=0),this.a=e,this.b=t,this.c=n,this.d=r,this.e=i,this.f=o}return Object.defineProperty(e.prototype,"scaleX",{get:function(){return this.a},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleY",{get:function(){return this.d},enumerable:!1,configurable:!0}),e.prototype.transform=function(e,t,n,r,i,o){var a=this.a*e+this.c*t,s=this.b*e+this.d*t,u=this.a*n+this.c*r,l=this.b*n+this.d*r,c=this.e+this.a*i+this.c*o,h=this.f+this.b*i+this.d*o;return this.a=a,this.b=s,this.c=u,this.d=l,this.e=c,this.f=h,this},e.prototype.translate=function(e,t){return this.e+=e*this.a+t*this.c,this.f+=e*this.b+t*this.d,this},e.prototype.rotate=function(e){var t=Math.cos(e),n=Math.sin(e);return this.transform(t,n,-n,t,0,0),this},e.prototype.scale=function(e,t){return this.transform(e,0,0,t,0,0),this},e.prototype.skew=function(e,t){return this.transform(1,Math.tan(e),Math.tan(t),1,0,0),this},e.prototype.rotateAround=function(e,t,n){return this.translate(t,n).rotate(e).translate(-t,-n)},e.prototype.scaleWithCenter=function(e,t,n,r){return this.translate(n,r).scale(e,t).translate(-n,-r)},e.prototype.mapPoint=function(e){var t=e.x,n=e.y;return e.x=this.mapPointX(t,n),e.y=this.mapPointY(t,n),e},e.prototype.mapPointX=function(e,t){return this.a*e+this.c*t+this.e},e.prototype.mapPointY=function(e,t){return this.b*e+this.d*t+this.f},e.prototype.inversePoint=function(e){var t=e.x,n=e.y;return e.x=this.inversePointX(t,n),e.y=this.inversePointY(t,n),e},e.prototype.inversePointX=function(e,t){return(this.d*e-this.c*t+this.c*this.f-this.e*this.d)/(this.a*this.d-this.c*this.b)},e.prototype.inversePointY=function(e,t){return(this.a*t-this.b*e+this.b*this.e-this.a*this.f)/(this.a*this.d-this.b*this.c)},e.prototype.roundPoint=function(e){return this.mapPoint(e).rounds(),this.inversePoint(e),e},e.prototype.mapRect=function(e){var t=this.mapPointX(e.x,e.y),n=this.mapPointX(e.x,e.maxY),r=this.mapPointX(e.maxX,e.y),i=this.mapPointX(e.maxX,e.maxY),o=this.mapPointY(e.x,e.y),a=this.mapPointY(e.x,e.maxY),s=this.mapPointY(e.maxX,e.y),u=this.mapPointY(e.maxX,e.maxY),l=Math.min(t,n,r,i),c=Math.max(t,n,r,i),h=Math.min(o,a,s,u),d=Math.max(o,a,s,u);return e.x=l,e.y=h,e.width=c-l,e.height=d-h,e},e.prototype.roundRect=function(e){return this.mapRect(e).rounds(),this.inverseRect(e),e},e.prototype.inverseRect=function(e){var t=this.inversePointX(e.x,e.y),n=this.inversePointX(e.x,e.maxY),r=this.inversePointX(e.maxX,e.y),i=this.inversePointX(e.maxX,e.maxY),o=this.inversePointY(e.x,e.y),a=this.inversePointY(e.x,e.maxY),s=this.inversePointY(e.maxX,e.y),u=this.inversePointY(e.maxX,e.maxY),l=Math.min(t,n,r,i),c=Math.max(t,n,r,i),h=Math.min(o,a,s,u),d=Math.max(o,a,s,u);return e.x=l,e.y=h,e.width=c-l,e.height=d-h,e},e.prototype.clone=function(){var t=new e;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.e=this.e,t.f=this.f,t},e.prototype.reset=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this},e}();function ee(e){var t=e.getTransform();return new Q(t.a,t.b,t.c,t.d,t.e,t.f)}function te(e,t){var n=ee(e);0!==n.b||0!==n.c?e.rect(t.x,t.y,t.width,t.height):(t=t.clone(),n.mapRect(t).roundsBoundary(),e.setTransform(1,0,0,1,0,0),e.rect(t.x,t.y,t.width,t.height),e.setTransform(n.a,n.b,n.c,n.d,n.e,n.f))}function ne(e,t,n){var r=ee(e);0!==r.b||0!==r.c?null!=n?(e.fillStyle=n,e.fillRect(t.x,t.y,t.width,t.height)):e.clearRect(t.x,t.y,t.width,t.height):(t=t.clone(),r.mapRect(t).roundsBoundary(),e.setTransform(1,0,0,1,0,0),null!=n?(e.fillStyle=n,e.fillRect(t.x,t.y,t.width,t.height)):e.clearRect(t.x,t.y,t.width,t.height),e.setTransform(r.a,r.b,r.c,r.d,r.e,r.f))}var re=function(){function e(e,t){this.x=e,this.y=t}return e.prototype.move=function(e,t){return this.x+=e,this.y+=t,this},e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.equal=function(e){return this.x===e.x&&this.y===e.y},e.prototype.sub=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.scale=function(e,t){return this.x*=e,this.y*=t,this},e.prototype.rounds=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},e}(),ie=function(){function e(e,t){this.width=e,this.height=t}return e}(),oe=function(){function e(e,t,n,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),this.x=e,this.y=t,this.width=n,this.height=r}return Object.defineProperty(e.prototype,"center",{get:function(){return new re(this.x+this.width/2,this.y+this.height/2)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return new ie(this.width,this.height)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxX",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxY",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),e.prototype.containPoint=function(e){return this.x<=e.x&&e.x<this.maxX&&this.y<=e.y&&e.y<this.maxY},e.prototype.containRect=function(e){return this.x<=e.x&&e.x+e.width<=this.x+this.width&&this.y<=e.y&&e.y+e.height<=this.y+this.height},e.prototype.equal=function(e){var t=e.x,n=e.y,r=e.width,i=e.height;return this.x===t&&this.y===n&&this.width===r&&this.height===i},e.prototype.leftTop=function(){return new re(this.x,this.y)},e.prototype.rightTop=function(){return new re(this.maxX,this.y)},e.prototype.leftBottom=function(){return new re(this.x,this.maxY)},e.prototype.rightBottom=function(){return new re(this.maxX,this.maxY)},e.prototype.intersect=function(e){var t=e.x,n=e.y,r=e.width,i=e.height;return this.x<t+r&&t<this.x+this.width&&this.y<n+i&&n<this.y+this.height},e.prototype.intersectRect=function(e){var t=Math.max(this.x,e.x),n=Math.max(this.y,e.y),r=Math.min(this.x+this.width,e.x+e.width),i=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.y=n,this.width=r-t,this.height=i-n,this},e.prototype.union=function(e){if(e.isEmpty())return this;if(this.isEmpty())return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this;var t=Math.min(this.x,e.x),n=Math.min(this.y,e.y),r=Math.max(this.x+this.width,e.x+e.width),i=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.y=n,this.width=r-t,this.height=i-n,this},e.prototype.sub=function(t){var n=[],r=this.clone().intersectRect(t);return r.isEmpty()?n.push(this.clone()):(r.y>this.y&&n.push(new e(this.x,this.y,this.width,r.y-this.y)),r.x>this.x&&n.push(new e(this.x,r.y,r.x-this.x,r.height)),r.x+r.width<this.x+this.width&&n.push(new e(r.x+r.width,r.y,this.x+this.width-(r.x+r.width),r.height)),r.y+r.height<this.y+this.height&&n.push(new e(this.x,r.y+r.height,this.width,this.y+this.height-(r.y+r.height)))),n},e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.isEmpty=function(){return this.width<=0||this.height<=0},e.prototype.reset=function(){this.x=this.y=this.width=this.height=0},e.prototype.move=function(e,t){return this.x+=e,this.y+=t,this},e.prototype.roundsBoundary=function(){var e=Math.round(this.width+this.x),t=Math.round(this.height+this.y);return this.x=Math.round(this.x),this.y=Math.round(this.y),this.width=e-this.x,this.height=t-this.y,this},e.prototype.rounds=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.width=Math.round(this.width),this.height=Math.round(this.height),this},e.prototype.boundary=function(){var e=Math.ceil(this.width+this.x),t=Math.ceil(this.height+this.y);return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.width=e-this.x,this.height=t-this.y,this},e.prototype.roundClip=function(){var e=Math.floor(this.width+this.x),t=Math.floor(this.height+this.y);return this.x=Math.round(this.x),this.y=Math.round(this.y),this.width=e-this.x,this.height=t-this.y,this},e.prototype.scale=function(e,t){return this.x*=e,this.width*=e,this.y*=t,this.height*=t,this},e}();function ae(e,t,n){var r=e-t;return Math.abs(r)>n?Math.sign(r):0}var se=new I((function(e,t){return ae(e,t,.01)}),[.5,.75,.85,1,1.15,1.25,1.5,1.75,2,2.5,3]);function ue(){var e=window.top;try{e.innerWidth}catch(t){e=window}return Math.min(se.at(se.find(e.outerWidth/e.innerWidth,!0)),se.at(se.find((e.outerHeight-52)/e.innerHeight,!0)))||1}var le,ce=/apple/i.test(navigator.vendor)&&/safari/i.test(navigator.userAgent)&&!/Mobi|Android/i.test(navigator.userAgent),he=function(){function e(){}return e.borrowCanvas=function(e,t,n,r){var i;return t?i=new ve(t,!1!==n,!0,r):(t=this._pool.length>0?this._pool.pop():document.createElement("canvas"),i=new ve(t,!1!==n,!1,r)),ce||(t.style.imageRendering="pixelated"),this._malloced.push({canvas:i,root:e}),e&&this._rootMap.set(i,e),this.updateDPI(),i},e.backCanvas=function(t){t.external||(t.reset(),t.element().removeAttribute("style"),t.destroy(),this._pool.length<e.poolSize&&this._pool.push(t.element())),this._malloced=this._malloced.filter((function(e){return e.canvas!==t})),this._rootMap.delete(t)},e.mallocedCanvas=function(e){return this._malloced.filter((function(t){return t.root===e})).map((function(e){return e.canvas}))},e.getRoot=function(e){return this._rootMap.get(e)},e.clear=function(){this._pool=[],this._rootMap.clear()},e.pinchZoom=function(){return window.visualViewport?window.visualViewport.scale:1},e.updateDPI=function(){var t=window.devicePixelRatio*this.pinchZoom();ce&&(t*=ue()),e.ratioX===t&&e.ratioY===t||(e.ratioX=t,e.ratioY=t,this._malloced.forEach((function(e){var n=e.canvas;n.isDpiSync()&&(n.resize(n.width(),n.height(),!0),de(n,t))})))},e.poolSize=256,e.ratioX=1,e.ratioY=1,e._pool=[],e._malloced=[],e._rootMap=new Map,e}();function de(e,t){var n=e.element(),r=n.style.position;if(!r||"relative"===r){n.style.position="relative",n.style.left="0px",n.style.top="0px";var i=n.getBoundingClientRect().left,o=n.getBoundingClientRect().top,a=Math.abs((Math.ceil(i*t)-i*t)/t),s=Math.abs((Math.ceil(o*t)-o*t)/t),u=Math.ceil(100*a)/100,l=Math.ceil(100*s)/100;n.style.left="".concat(u,"px"),n.style.top="".concat(l,"px")}}e.FCanvasNotify=void 0,(le=e.FCanvasNotify||(e.FCanvasNotify={}))[le.Resized=0]="Resized",le[le.Suspend=1]="Suspend",le[le.Wakeup=2]="Wakeup";var fe,pe={textRendering:"auto",fontFeatureSettings:"normal",letterSpacing:"normal",fontVariantNumeric:"normal",fontVariantLigatures:"normal"},ve=function(){function t(e,t,n,r){var i=this;void 0===r&&(r=1),this._canvas=e,this._syncDPI=t,this.external=n,this._selfDPR=r,this._width=0,this._height=0,this.isActive=!0,Object.keys(pe).forEach((function(e){return i._canvas.style[e]=pe[e]}))}return t.prototype.element=function(){return this._canvas},t.prototype.destroy=function(){var e=this._canvas.parentNode;null!==e&&e.removeChild(this._canvas)},t.prototype.ctx=function(e){var t=he.getRoot(this),n=t&&t.options||{};return this._canvas.getContext("2d",Object.assign(n,e))},t.prototype.matrix=function(){return ee(this.ctx())},t.prototype.width=function(){return this._width},t.prototype.height=function(){return this._height},t.prototype.ratioX=function(){return this._syncDPI?he.ratioX:this._selfDPR},t.prototype.ratioY=function(){return this._syncDPI?he.ratioY:this._selfDPR},t.prototype.isSuspend=function(){return!this.isActive},t.prototype.suspend=function(){this.isActive=!1,this._canvas.width=0,this._canvas.height=0,this._fireNotify(e.FCanvasNotify.Suspend)},t.prototype.wakeup=function(){this.isActive=!0,this._updateCanvasSizeIfChanged(),this._fireNotify(e.FCanvasNotify.Wakeup)},t.prototype.isDpiSync=function(){return this._syncDPI},t.prototype.resize=function(e,t,n){if(void 0===n&&(n=!1),n||this._width!==e||this._height!==t){var r=this.isSuspend();this._width=e,this._height=t,r||this._updateCanvasSize()}},t.prototype.clear=function(){var e=this.ctx(),t=he.getRoot(this),n=t?t.defaultBackground:void 0,r=e.getTransform();e.setTransform(1,0,0,1,0,0),ne(e,new oe(0,0,this._width,this._height),n),e.setTransform(r.a,r.b,r.c,r.d,r.e,r.f)},t.prototype.registerNotify=function(e){this._handlers||(this._handlers=[]),this._handlers.push(e)},t.prototype.unRegisterNotify=function(e){this._handlers&&(this._handlers=this._handlers.filter((function(t){return t!==e})))},t.prototype.reset=function(){this._canvas.style.display="none",this.ctx().setTransform(1,0,0,1,0,0),this.resize(0,0),this._handlers&&(this._handlers=[])},t.prototype.fakeHide=function(){this._canvas.style.display="block",this._canvas.style.position="fixed",this._canvas.style.top="0",this._canvas.style.left="0",this._canvas.style.transform="translate(-100%, -100%)",document.body.appendChild(this._canvas)},t.prototype._fireNotify=function(e){this._handlers&&this._handlers.forEach((function(t){return t(e)}))},t.prototype._updateCanvasSizeIfChanged=function(){var t=this.ratioX(),n=this.ratioY(),r=Math.round(this._width*t),i=Math.round(this._height*n);r!==this._canvas.width&&(this._canvas.width=r),i!==this._canvas.height&&(this._canvas.height=i),this.ctx().setTransform(t,0,0,n,0,0),this._fireNotify(e.FCanvasNotify.Resized)},t.prototype._updateCanvasSize=function(){var t=this.ratioX(),n=this.ratioY(),r=Math.round(this._width*t),i=Math.round(this._height*n);this._canvas.width=r,this._canvas.height=i,this._canvas.style.width="".concat(r/t,"px"),this._canvas.style.height="".concat(i/n,"px"),this.ctx().setTransform(t,0,0,n,0,0),this._fireNotify(e.FCanvasNotify.Resized)},t}();function ge(e,t,n,r,i,o,a){r<=0||o.width<=0&&a.width<=0||(o.width>r&&(o=Object.assign({},o,{width:r})),a.width>r&&(a=Object.assign({},a,{width:r})),0===o.width&&(o=Object.assign({},o,{width:a.width})),0===a.width&&(a=Object.assign({},a,{width:o.width})),e.push({cx:t,cy:n,radius:r,start:i,end:i+1/4*Math.PI,style:o}),e.push({cx:t,cy:n,radius:r,start:i+1/4*Math.PI,end:i+.5*Math.PI,style:a}))}function _e(e,t,n){return G(e,t,n)}function ye(e,t,n){var r=t.border,i=t.borderTop,o=t.borderRight,a=t.borderBottom,s=t.borderLeft;if(r||i||o||a||s){var u=t.x,l=t.y,c=t.width,h=t.height,d=C(_e(t.radius,c,h),4),f=d[0],p=d[1],v=d[2],g=d[3],_=C(P(r,{color:"",width:0},i,o,a,s),4),y=_[0],m=_[1],E=_[2],b=_[3],T=[];T.push({start:[u+f,l],end:[u+c-p,l],offset:[0,1],style:y}),ge(T,u+c-p,l+p,p,1.5*Math.PI,y,m),T.push({start:[u+c,l+p],end:[u+c,l+h-v],offset:[-1,0],style:m}),ge(T,u+c-v,l+h-v,v,0,m,E),T.push({start:[u+c-v,l+h],end:[u+g,l+h],offset:[0,-1],style:E}),ge(T,u+g,l+h-g,g,.5*Math.PI,E,b),T.push({start:[u,l+h-g],end:[u,l+f],offset:[1,0],style:b}),ge(T,u+f,l+f,f,Math.PI,b,y);var S=[];if(T.forEach((function(e,t){if(0===t)S.push([e]);else{var n=S[S.length-1];x(n[n.length-1].style,e.style)?n.push(e):S.push([e])}})),S.length>1){var w=S[0][0],R=S[S.length-1][0];if(x(w.style,R.style))for(var A=S[0],O=S.pop(),M=O.length-1;M>=0;M--)A.unshift(O[M])}me(e,S,n)}}function me(t,n,r){t.save();var i=ee(t),o=1;i.a===i.d&&0===i.b&&0===i.c?(o=i.a,t.setTransform(1,0,0,1,0,0)):i=new Q;var a=t.strokeType;n.forEach((function(n){var a=n[0].style;if(!(a.width<=0)){t.beginPath();var s=a.width,u=Math.round(s*o);t.lineWidth=u,t.strokeStyle=r?r(a.color,e.ColorThemeType.Border):a.color,t.strokeType=r?e.ColorThemeType.Border:null,a.style===e.borderDash.dash?t.setLineDash(Array.isArray(a.dashLine)?a.dashLine:N):t.setLineDash([]),n.forEach((function(e){var n=u/2;if("offset"in e){var r=i.mapPoint(new re(e.start[0],e.start[1])).rounds(),a=i.mapPoint(new re(e.end[0],e.end[1])).rounds(),s=n*e.offset[0],l=n*e.offset[1];t.moveTo(r.x+s,r.y+l),t.lineTo(a.x+s,a.y+l)}else{var c=e.cx,h=e.cy,d=e.radius,f=e.start,p=e.end,v=i.mapPoint(new re(c,h)).rounds();d*=o,t.arc(v.x,v.y,d-n,f,p)}})),t.stroke()}})),t.strokeType=a,t.restore()}function Ee(e,t){e.beginPath(),te(e,t),e.clip()}e.FEventType=void 0,(fe=e.FEventType||(e.FEventType={}))[fe.MouseMove=0]="MouseMove",fe[fe.MouseDown=1]="MouseDown",fe[fe.MouseUp=2]="MouseUp",fe[fe.Click=3]="Click",fe[fe.Dblclick=4]="Dblclick",fe[fe.MouseEnter=5]="MouseEnter",fe[fe.MouseLeave=6]="MouseLeave",fe[fe.MouseWheel=7]="MouseWheel",fe[fe.ContextMenu=8]="ContextMenu",fe[fe.DragStart=9]="DragStart",fe[fe.Drag=10]="Drag",fe[fe.DragEnter=11]="DragEnter",fe[fe.DragOver=12]="DragOver",fe[fe.DragLeave=13]="DragLeave",fe[fe.Drop=14]="Drop",fe[fe.DragEnd=15]="DragEnd",fe[fe.Tap=16]="Tap",fe[fe.DoubleTap=17]="DoubleTap",fe[fe.PanStart=18]="PanStart",fe[fe.PanMove=19]="PanMove",fe[fe.PanEnd=20]="PanEnd",fe[fe.PanCancel=21]="PanCancel",fe[fe.Press=22]="Press",fe[fe.PressUp=23]="PressUp",fe[fe.Swipe=24]="Swipe",fe[fe.RotateStart=25]="RotateStart",fe[fe.RotateMove=26]="RotateMove",fe[fe.RotateEnd=27]="RotateEnd",fe[fe.RotateCancel=28]="RotateCancel",fe[fe.PinchStart=29]="PinchStart",fe[fe.PinchMove=30]="PinchMove",fe[fe.PinchEnd=31]="PinchEnd",fe[fe.PinchCancel=32]="PinchCancel",fe[fe.BeforeChange=33]="BeforeChange",fe[fe.AfterChange=34]="AfterChange",fe[fe.BeforeFlush=35]="BeforeFlush",fe[fe.AfterFlush=36]="AfterFlush",fe[fe.BeforePaint=37]="BeforePaint",fe[fe.AfterPaint=38]="AfterPaint",fe[fe.Destroy=39]="Destroy",fe[fe.AddChild=40]="AddChild",fe[fe.RemoveChild=41]="RemoveChild",fe[fe.EventTypeEnd=42]="EventTypeEnd",fe[fe.BeforeTick=43]="BeforeTick",fe[fe.AfterTick=44]="AfterTick",fe[fe.EmptyTick=45]="EmptyTick",fe[fe.BeforeLayerRender=46]="BeforeLayerRender",fe[fe.AfterLayerRender=47]="AfterLayerRender",fe[fe.PointerCancel=55]="PointerCancel";var be=[e.FEventType.BeforeChange,e.FEventType.AfterChange,e.FEventType.BeforeFlush,e.FEventType.AfterFlush,e.FEventType.BeforePaint,e.FEventType.AfterPaint,e.FEventType.Destroy,e.FEventType.AddChild,e.FEventType.RemoveChild,e.FEventType.EventTypeEnd,e.FEventType.BeforeTick,e.FEventType.AfterTick,e.FEventType.EmptyTick,e.FEventType.BeforeLayerRender,e.FEventType.AfterLayerRender],Te=e.FEventType.EventTypeEnd+1,Ce=function(){function e(e,t){this.type=e,this.target=t,this._preventDefalut=!1,this._srcEventPrevent=!1}return e.prototype.preventDefault=function(){this._preventDefalut=!0},e.prototype.canclePreventDefault=function(){this._preventDefalut=!1},e.prototype.srcEventPreventDefault=function(){this._srcEventPrevent=!0},e.prototype.cancleSrcEventDefaultPrevented=function(){this._srcEventPrevent=!1},Object.defineProperty(e.prototype,"defaultPrevented",{get:function(){return this._preventDefalut},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"srcEventDefaultPrevented",{get:function(){return this._srcEventPrevent},enumerable:!1,configurable:!0}),e}(),Se=function(e){function t(t,n,r){var i=e.call(this,t,n)||this;return i.type=t,i.target=n,i.nativeEvent=r,i}return y(t,e),t}(Ce);function we(e,t){var n=[];return w(e,(function(e){var t=e.eventFilters();return t.length>0&&n.push(t),!1})),n.reverse().some((function(e){return e.some((function(e){return e(t)}))}))}var Re,Ae=function(){function e(){}return e.sendEvent=function(t,n,r){void 0===r&&(r=!1),r?e.EventStatck.push({w:t,e:n}):we(t,n)||t.event(n)},e.doTick=function(){e.EventStatck.length>0&&(e.EventStatck.forEach((function(e){var t=e.w,n=e.e;t.destroied||we(t,n)||t.event(n)})),e.EventStatck=[])},e.removeEventByWidget=function(t){e.EventStatck=e.EventStatck.filter((function(e){return e.w!==t}))},e.EventStatck=[],e}(),Oe=function(){function t(){this._parent=null,this._children=[],this._rootId=null,this._zindex=0,this.UID=t._widgetUid(),t.glbHashes[this.UID]=this}return t.getObjById=function(e){return t.glbHashes[e]},t.destroyDetached=function(){Object.entries(t.glbHashes).forEach((function(e){var n=C(e,2),r=n[0];null===n[1]._rootId&&t.glbHashes[r]&&t.glbHashes[r].destroy()}))},t._widgetUid=function(){return t._uid+=1,t._uid},t.prototype.rootId=function(){return this._rootId},t.prototype.setRootId=function(e){this._rootId!==e&&(this._rootId=e,this._children.forEach((function(t){return t.setRootId(e)})))},t.prototype.destroied=function(){return!0===this._destroied},t.prototype.hasChild=function(){return Boolean(this._children.length)},t.prototype.children=function(){return this._children},t.prototype.childrenArr=function(){return this._children},t.prototype.addChild=function(e){e.ancestorOf(this)?console.error("can not append widget to its' children"):e.setParent(this)},t.prototype.removeAllChild=function(){this._children.forEach((function(e){e._parent=null})),this._children.length=0},t.prototype.removeChild=function(e){var t=this._children.indexOf(e);this._children.splice(t,1),e._parent=null},t.prototype.setParent=function(e){var t=this.parent();e!==t&&(null!==t&&t.removeChild(this),this._parent=e,this.setRootId(e?e.rootId():null),null!==e&&this.insertToParent(e))},t.prototype.insertToParent=function(e){e._children.push(this)},t.prototype.ancestorOf=function(e){var t=this;return null!==e.findAncestor((function(e){return e===t}))},t.prototype.parent=function(){return this._parent?this._parent:null},t.prototype.findAncestor=function(e){for(var t=this;null!==t;){if(e(t))return t;t=t.parent()}return null},t.prototype.event=function(e){return!(!this._handlers||!(e.type in this._handlers))&&this._handlers[e.type].some((function(t){return t(e)}))},t.prototype.addListener=function(e,t){return this._handlers||(this._handlers={}),e in this._handlers||(this._handlers[e]=[]),this._handlers[e].push(t),this},t.prototype.addOnceListener=function(e,t){var n=this,r=function(i){var o=t(i);return n.removeListener(e,r),o};this.addListener(e,r)},t.prototype.removeListener=function(e,t){this._handlers&&e in this._handlers&&(this._handlers[e]=this._handlers[e].filter((function(e){return e!==t})))},t.prototype.beforeChange=function(e){},t.prototype.afterChange=function(e){},t.prototype.beforeFlush=function(e){},t.prototype.afterFlush=function(e){},t.prototype.beforeTick=function(e){},t.prototype.afterTick=function(e){},t.prototype.onChildChange=function(e,t){},t.prototype.beforeLayerRender=function(e){},t.prototype.afterLayerRender=function(e){},t.prototype.destroy=function(){delete t.glbHashes[this.UID],this._destroied=!0,ke.unBindAll(this),this._children.forEach((function(e){e.destroy()})),this._children.length=0,this._parent&&!this._parent._destroied?this._parent.removeChild(this):this._parent=null,this.event(new Ce(e.FEventType.Destroy,this))},t.glbHashes={},t._uid=0,t}(),Me=function(){function e(){this._refs={}}return e.prototype.anyDepends=function(e,t){return e in this._refs&&t in this._refs[e]},e.prototype.addRef=function(e,t,n){e in this._refs||(this._refs[e]={});var r=this._refs[e];t in r||(r[t]=[]),r[t].push(n)},e.prototype.removeRef=function(e,t,n){if(this.anyDepends(e,t)){var r=this._refs[e][t];(r=r.filter((function(e){return e.id!==n.id||e.prop!==n.prop||e.pip!==n.pip}))).length>0?this._refs[e][t]=r:(delete this._refs[e][t],0===Object.keys(this._refs[e]).length&&this.removeAllRefs(e))}},e.prototype.allPropRefs=function(e,t){return this.anyDepends(e,t)?this._refs[e][t]:[]},e.prototype.allRefs=function(e){return this._refs[e]||{}},e.prototype.removeAllRefs=function(e){delete this._refs[e]},e.prototype.clearAllRefs=function(){this._refs={}},e}(),ke=function(){function e(){}return e.firePropChange=function(e,t,n){this._depends.allPropRefs(e.UID,t).forEach((function(e){var t=Oe.getObjById(e.id.toString()),r={};e.pip?r[e.prop]=e.pip(n):r[e.prop]=n,t&&t.updateByCfg(r)}))},e.propBind=function(t,n,r,i,o){var a=r.UID,s=t.UID;e._depends.addRef(a,i,{id:s,prop:n,pip:o}),e._dependsOn.addRef(s,n,{id:a,prop:i,pip:o});var u=r._cfg[i];if(void 0!==u){var l={};l[n]=o?o(u):u,t.updateByCfg(l)}return{sid:a,sprop:i,tid:s,tprop:n,pip:o}},e.dupBind=function(e,t,n,r){this.propBind(e,t,n,r),this.propBind(n,r,e,t)},e.bindSize=function(e,t,n){void 0===n&&(n=0),this.propBind(e,"width",t,"width",(function(e){return e-2*n})),this.propBind(e,"height",t,"height",(function(e){return e-2*n})),0!==n&&e.updateByCfg({x:n,y:n})},e.unBindAll=function(e){var t=this,n=e.UID,r=this._dependsOn.allRefs(n);Object.keys(r).forEach((function(e){r[e].forEach((function(r){t._depends.removeRef(r.id,r.prop,{id:n,prop:e,pip:r.pip})}))})),this._dependsOn.removeAllRefs(n)},e.propsUnBind=function(t){var n=t.sid,r=t.sprop,i=t.tid,o=t.tprop,a=t.pip;e._depends.removeRef(n,r,{id:i,prop:o,pip:a}),e._dependsOn.removeRef(i,o,{id:n,prop:r,pip:a})},e.clearAll=function(){e._dependsOn.clearAllRefs(),e._depends.clearAllRefs()},e._depends=new Me,e._dependsOn=new Me,e}();e.WidgetType=void 0,(Re=e.WidgetType||(e.WidgetType={})).faster="core/faster",Re.widget="core/widget";var Ie,xe=function(e){function t(t,n,r){var i=e.call(this,t,n)||this;return i.changes=r,i}return y(t,e),t}(Ce),Ne=function(){function e(){}return e.tickWake=function(t){void 0===t&&(t=!1),e._isIdle=t,0===e.animationId&&(e.animationId=requestAnimationFrame(e.doTick)),e._runCbList.forEach((function(e){return e()}))},e.doTick=function(t){e.animationId=0,void 0!==t&&(e.timeStamp=t);for(var n=e.running,r=0;r<n.length;r++)try{n[r].tick()}catch(e){throw n[r].exit(),e}try{Ae.doTick()}catch(e){console.error(e)}e.cbMap.forEach((function(e){return e()})),e.cbMap.size>0&&e.tickWake(),!1===e._isIdle&&(e._idleTimeStamp=Date.now()),!0===e._isIdle&&Date.now()-e._idleTimeStamp>e._idleTimeout?e._handleIdleCallback():e._idleCbList.length>0&&e.tickWake(!0)},e.setIdleTimeout=function(t){e._idleTimeout=t},e.registerIdleCallback=function(t,n){void 0===n&&(n=!1),(!0!==n||-1===e._idleCbList.indexOf(t))&&e._idleCbList.push(t)},e.unregisterIdleCallback=function(t){for(var n=e._idleCbList.length-1;n>=0;n--)t===e._idleCbList[n]&&e._idleCbList.splice(n,1)},e._handleIdleCallback=function(){if(!0===e._isIdle&&e._idleCbList.length>0){var t=e._idleCbList.shift();t&&t(),e._idleCbList.length>0&&setTimeout(e._handleIdleCallback,0)}},e.onAppExit=function(e){this._exitCbList.push(e)},e.onAppRun=function(e){this._runCbList.push(e)},e.start=function(t){0===e.running.length&&e.tickWake(),e.running.push(t)},e.exit=function(t){e.running=e.running.filter((function(e){return t!==e})),0===e.running.length&&e.destroy()},e.destroy=function(){cancelAnimationFrame(e.animationId),e.animationId=0,e._idleCbList.length=0,e._exitCbList.forEach((function(e){return e()}))},e.clearAll=function(){Oe.destroyDetached(),ke.clearAll(),e.clearFasterMeta(),e.clearFasterVersion()},e.addIdleListener=function(t){var n=e.cbId++;return e.cbMap.set(n,t),n},e.clearFasterMeta=function(){window.__FASTER_META__&&(window.__FASTER_META__={})},e.clearFasterVersion=function(){window.__FASTER_VERSION__&&(window.__FASTER_VERSION__={})},e.removeIdleListener=function(t){e.cbMap.has(t)&&e.cbMap.delete(t)},e.running=[],e.animationId=0,e.cbMap=new Map,e.cbId=1e3,e.timeStamp=0,e._isIdle=!0,e._idleCbList=[],e._idleTimeStamp=Date.now(),e._exitCbList=[],e._runCbList=[],e._idleTimeout=200,e}();e.FDirection=void 0,(Ie=e.FDirection||(e.FDirection={}))[Ie.Left=0]="Left",Ie[Ie.Right=1]="Right",Ie[Ie.Up=2]="Up",Ie[Ie.Down=3]="Down";var Pe=function(e){function t(t,n,r,i,o){var a=e.call(this,t,n,r)||this;return a.deltaTime=o,a.center=n.mapFromGlobal(i),a}return y(t,e),t.prototype.globalCenter=function(){return this.target.mapToGlobal(this.center.clone())},t}(Se),Le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return y(t,e),t}(Pe),De=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return y(t,e),t}(Pe),Fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return y(t,e),t}(Pe),Be=function(e){function t(t,n,r,i,o,a,s){var u=e.call(this,t,n,r,i,o)||this;return u.deltaX=a,u.deltaY=s,u}return y(t,e),t}(Pe),Ve=function(e){function t(t,n,r,i,o,a,s,u,l){var c=e.call(this,t,n,r,i,o)||this;return c.velocityX=a,c.velocityY=s,c.velocity=u,c.direction=l,c}return y(t,e),t}(Pe),He=function(e){function t(t,n,r,i,o,a){var s=e.call(this,t,n,r,i,o)||this;return s.globalPointers=a,s.pointers=a.map((function(e){return n.mapFromGlobal(e)})),s}return y(t,e),t}(Pe),Ue=function(e){function t(t,n,r,i,o,a,s){var u=e.call(this,t,n,r,i,o,a)||this;return u.scale=s,u}return y(t,e),t}(He),Ze=function(e){function t(t,n,r,i,o,a,s){var u=e.call(this,t,n,r,i,o,a)||this;return u.rotate=s,u}return y(t,e),t}(He),We=["scroll","mousewheel","resize"],je=["mousemove","wheel","mouseenter","mouseleave","mouseover","mouseout"],Ge=function(){function t(e){var t=this;this._eventDom=e,this._root=null,this._autoCapture=null,this._userCapture=null,this._hammer=null,this._preventDefaultTouchMove=!1,this._syntheticClick=null,this._offset={x:0,y:0},this._offsetDirty=!1,this._isWindowBlur=!1,this._isTouching=!1,this.setOffsetDirty=function(){t._offsetDirty=!0},this._preventTouchMoveEvent=function(e){t._preventDefaultTouchMove&&e.preventDefault()},this.processDomEvent=function(e,n,r){var i=t._eventDom;if(e.target===i||t.isCapture()){if("mouseleave"!==e.type)return t.dispath(e,n,r);if(null!==t._cursorWidget){var o=e,a=o.ctrlKey,s=o.shiftKey,u=o.altKey,l=o.metaKey;t._enterLeaveDispatch(!0,null,e,{globalX:0,globalY:0,buttons:ze(e),ctrlKey:a,shiftKey:s,altKey:u,metaKey:l})}}else if("mousemove"===e.type){var c=e;a=c.ctrlKey,s=c.shiftKey,u=c.altKey,l=c.metaKey,t._enterLeaveDispatch(!0,null,e,{globalX:0,globalY:0,buttons:ze(e),ctrlKey:a,shiftKey:s,altKey:u,metaKey:l})}else{if("mouseenter"===e.type)return t.dispath(e,n,r);if("wheel"===e.type){var h=e.clientX,d=e.clientY,f=S([],C(document.elementsFromPoint(h,d)),!1);if(f.length&&f[0]===i)return t._windowFocused(),t.dispath(e,n,r);t._cursorWidget=null}}return!1},this._windowBlured=function(){t._isWindowBlur=!0},this._windowFocused=function(){t._isWindowBlur=!1},this._cursorWidget=null}return t.createDragCanvas=function(){if(!this._dragCanvas){this._dragCanvas=he.borrowCanvas(null,void 0,!1),this._dragCanvas.resize(300,150);var e=this._dragCanvas.element();this._dragCanvas.fakeHide(),e.style.opacity="0.8",document.body.appendChild(e)}},t.destroyDragCanvas=function(){this._dragCanvas&&(he.backCanvas(this._dragCanvas),this._dragCanvas=null)},t.getDragCanvas=function(){return this._dragCanvas||this.createDragCanvas(),this._dragCanvas},t.dpiChangedDebounce=function(){window.clearTimeout(t.debounceDPITimer),t.debounceDPITimer=window.setTimeout(t.dpiChanged,100)},t._bindWindowEvent=function(){var e=this;window.addEventListener("blur",this._windowBlured),window.addEventListener("focus",this._windowFocused),t._bindDpiChanged(),"undefined"!=typeof MutationObserver?(t._observer=new MutationObserver(this._setOffsetDirty)).observe(document.body,{attributes:!0,childList:!0,subtree:!0}):We.unshift("DOMSubtreeModified"),We.forEach((function(t){window.addEventListener(t,e._setOffsetDirty,!0)}))},t._unbindWindowEvent=function(){var e=this;We.forEach((function(t){window.removeEventListener(t,e._setOffsetDirty,!0)})),window.removeEventListener("blur",this._windowBlured),window.removeEventListener("focus",this._windowFocused),t._unbindDpiChanged(),t._observer&&(t._observer.disconnect(),t._observer=null)},t.forceBindEvents=function(){this._bindWindowEvent()},t.forceUnbindEvents=function(){this._unbindWindowEvent()},t.bindEvents=function(e){0===this.eventDispatchers.length&&this._bindWindowEvent(),this.eventDispatchers.push(e)},t.unbindEvents=function(e){var t=this.eventDispatchers.indexOf(e);t>-1&&this.eventDispatchers.splice(t,1),0===this.eventDispatchers.length&&this._unbindWindowEvent()},t.filterEvent=function(e,t){return we(e,t)},Object.defineProperty(t.prototype,"_dragCanvas",{get:function(){return t.getDragCanvas()},enumerable:!1,configurable:!0}),t.prototype.setRoot=function(e){this._root=e},t.prototype.isCapture=function(){return null!==this._captureWidget()},t.prototype.capture=function(e){this._userCapture=e},t.prototype.updateAutoCapture=function(e){this._autoCapture&&e.ancestorOf(this._autoCapture)&&(this._autoCapture=e.parent())},t.prototype.updateDraggable=function(e){this._eventDom.draggable=e},t.prototype.updateOffset=function(){var e=this._eventDom.getBoundingClientRect();this._offset.x=e.left+this.scrollX,this._offset.y=e.top+this.scrollY,this._offsetDirty=!1},t.prototype.domPoint2Event=function(e){this._offsetDirty&&this.updateOffset();var t=this._offset,n=t.x,r=t.y;return n-=this.scrollX,r-=this.scrollY,new re(e.x-n,e.y-r)},t.prototype.configureRecognizer=function(e,t){if(!this._hammer)return!1;var n=this._hammer.get(e);return!!n&&(n.set(t),!0)},t.prototype.lowestCommonAncestor=function(e,t){var n=this._root;return w(t,(function(t){return!(!t||!t.ancestorOf(e)||(n=t,0))})),n},t.prototype.releaseCapture=function(){this._userCapture=null},t.prototype.releaseAutoCapture=function(){this._autoCapture=null},t.prototype.cancelSrcEventDefaultTouchMovePrevented=function(e){this._preventDefaultTouchMove=!1,e.canclePreventDefault(),e.cancleSrcEventDefaultPrevented()},t.prototype.dispath=function(n,r,i){var o=null,a=null;if("panstart"===n.type&&"touch"===n.pointerType&&(this._isTouching=!0),"pointerType"in n&&"mouse"===n.pointerType||"panstart"!==n.type&&"pinchstart"!==n.type&&"rotatestart"!==n.type||this.releaseAutoCapture(),n instanceof Event){var s=function(e){return-1!==e.findIndex((function(e){return e===n.type}))};if("dragover"===n.type&&n.preventDefault(),s(t.mouseEvents)&&!this._isTouching){var u=n;if(null===(o=this._convertMouseEvent(u,r,i))&&"mousemove"===u.type){var l=u.ctrlKey,c=u.shiftKey,h=u.altKey,d=u.metaKey;this._enterLeaveDispatch(!0,null,u,{globalX:0,globalY:0,buttons:ze(u),ctrlKey:l,shiftKey:c,altKey:h,metaKey:d})}}else s(t.dragEvents)&&(o=this._convertDragEvent(n,r,i));a=n}else o=this._convertHammerEvent(n,r,i),a=n.srcEvent;if(null===o||null==a)return!1;switch(o.type){case e.FEventType.Drop:case e.FEventType.ContextMenu:a.preventDefault()}var f=this.dispatchFEvent(o);return o.srcEventDefaultPrevented&&a.preventDefault(),f&&a.stopPropagation(),o.type!==e.FEventType.PanMove&&o.type!==e.FEventType.PanStart||(this._preventDefaultTouchMove=o.srcEventDefaultPrevented),o.type!==e.FEventType.PinchStart&&o.type!==e.FEventType.PinchMove&&o.type!==e.FEventType.RotateStart&&o.type!==e.FEventType.RotateMove||(this._preventDefaultTouchMove=!0),"panend"!==n.type&&"pancancel"!==n.type&&"panup"!==n.type||(this._preventDefaultTouchMove=!1,this._isTouching=!1),f},t.prototype.dispatchFEvent=function(n){var r=n.target,i=!1;switch(n.type){case e.FEventType.MouseDown:case e.FEventType.PanStart:case e.FEventType.PinchStart:case e.FEventType.RotateStart:var o=this.dragTarget(r),a=null!==o&&o.draggable;this.updateDraggable(a),this._autoCapture=r;break;case e.FEventType.MouseMove:case e.FEventType.MouseWheel:case e.FEventType.DragOver:i=!0;break;case e.FEventType.MouseUp:case e.FEventType.PanEnd:case e.FEventType.PinchEnd:case e.FEventType.RotateEnd:case e.FEventType.PanCancel:case e.FEventType.PinchCancel:case e.FEventType.RotateCancel:case e.FEventType.DragEnd:case e.FEventType.PointerCancel:this.releaseAutoCapture();break;case e.FEventType.DragStart:this._autoCapture=r,this._clearDragImage();var s=n.dataTransfer;s&&s.setDragImage(this._dragCanvas.element(),0,0)}if(t.filterEvent(r,n))return!0;if(n.type===e.FEventType.MouseWheel&&this._isWindowBlur&&(i=!1),i){var u=n.type!==e.FEventType.DragOver,l=n,c=l.globalPoint();this._enterLeaveDispatch(u,r,n.nativeEvent,{globalX:c.x,globalY:c.y,buttons:l.buttons,ctrlKey:l.ctrlKey,shiftKey:l.shiftKey,altKey:l.altKey,metaKey:l.metaKey})}return w(r,(function(e){return e.event(n)}))},t.prototype.cursorWidget=function(){return this._cursorWidget},t.prototype.setCursorWidget=function(e){this._cursorWidget=e},Object.defineProperty(t.prototype,"isTouching",{get:function(){return this._isTouching},enumerable:!1,configurable:!0}),t.prototype.touchEventStart=function(){if("undefined"!=typeof TouchEvent){var e=new a.default(this._eventDom,{domEvents:!0,touchAction:"auto",cssProps:Object.assign({},a.default.defaults.cssProps,{userDrag:""})}),t=new a.default.Tap({event:"tap"}),n=new a.default.Tap({event:"doubletap",taps:2,interval:200});e.add([n,t]),e.get("pan").set({direction:a.default.DIRECTION_ALL}),e.get("swipe").set({direction:a.default.DIRECTION_ALL}),e.get("pinch").set({enable:!0}),e.get("rotate").set({enable:!0}),this._hammer=e}},t.prototype.start=function(){var e=this;t.documentEvents.concat(t.dragEvents).forEach((function(t){return document.addEventListener(t,e.processDomEvent)})),t.canvasEvents.forEach((function(t){return e._eventDom.addEventListener(t,e.processDomEvent)})),null===this._hammer&&this.touchEventStart(),null!==this._hammer&&(this._hammer.on(t.hammerEvents,(function(t){return e.dispath(t)})),this._eventDom.addEventListener("touchmove",this._preventTouchMoveEvent)),this.bindEvents(),this.setOffsetDirty()},t.prototype.stop=function(){var e=this;t.documentEvents.concat(t.dragEvents).forEach((function(t){return document.removeEventListener(t,e.processDomEvent)})),t.canvasEvents.forEach((function(t){return e._eventDom.removeEventListener(t,e.processDomEvent)})),null!==this._hammer&&(this._hammer.off(t.hammerEvents),this._eventDom.removeEventListener("touchmove",this._preventTouchMoveEvent)),this.unbindEvents()},t.prototype.destroy=function(){this.stop(),this._hammer&&this._hammer.destroy()},t.prototype._convertHammerEvent=function(t,n,r){var i=this;if("mouse"===t.pointerType)return null;var o=null,s=new re(t.center.x,t.center.y);s=this.domPoint2Event(s);var u=this._captureWidget();if(t.pointers.length<=1){var l=function(e){var o;if(u)o=u;else{var a=Ye(s,n,r);o=i._root&&i._root.findWidget(a,e,t)}return null==o?null:new Be(e,o,t,s,t.deltaTime,t.deltaX,t.deltaY)},c=function(e){var o;if(u)o=u;else{var a=Ye(s,n,r);o=i._root&&i._root.findWidget(a,e,t)}return null==o?null:new Le(e,o,t,s,t.deltaTime)},h=function(l){var c,h;if(u)c=u;else{var d=Ye(s,n,r);c=i._root&&i._root.findWidget(d,l,t)}return null==c?o:(h=t.direction&a.default.DIRECTION_LEFT?e.FDirection.Left:t.direction&a.default.DIRECTION_RIGHT?e.FDirection.Right:t.direction&a.default.DIRECTION_UP?e.FDirection.Up:e.FDirection.Down,new Ve(l,c,t,s,t.deltaTime,t.velocityX,t.velocityY,t.velocity,h))};switch(t.type){case"panstart":o=l(e.FEventType.PanStart);break;case"panmove":o=l(e.FEventType.PanMove);break;case"panend":o=l(e.FEventType.PanEnd);break;case"pancancel":o=l(e.FEventType.PanCancel);break;case"press":o=c(e.FEventType.Press);break;case"tap":o=c(e.FEventType.Tap);break;case"doubletap":o=c(e.FEventType.DoubleTap);break;case"pressup":o=c(e.FEventType.PressUp);break;case"swipe":o=h(e.FEventType.Swipe)}}else{var d=t.pointers.map((function(e){return i.domPoint2Event(new re(e.clientX,e.clientY))})),f=function(e){var n=u||i._root&&i._root.findWidgetByMultiPoint(d,e);return null==n?null:new Ze(e,n,t,s,t.deltaTime,d,t.rotation)},p=function(e){var n=u||i._root&&i._root.findWidgetByMultiPoint(d,e);return null==n?null:new Ue(e,n,t,s,t.deltaTime,d,t.scale)};switch(t.type){case"rotatestart":o=f(e.FEventType.RotateStart);break;case"rotatemove":o=f(e.FEventType.RotateMove);break;case"rotateend":this._hammer&&this._hammer.stop(!1),o=f(e.FEventType.RotateEnd);break;case"rotatecancel":o=f(e.FEventType.RotateCancel);break;case"pinchstart":o=p(e.FEventType.PinchStart);break;case"pinchmove":o=p(e.FEventType.PinchMove);break;case"pinchend":this._hammer&&this._hammer.stop(!1),o=p(e.FEventType.PinchEnd);break;case"pinchcancel":o=p(e.FEventType.PinchCancel)}}return o},t.prototype._convertMouseEvent=function(t,n,r){var i=this,o=new re(t.clientX,t.clientY);o=this.domPoint2Event(o);var a=null,s=function(e){var a;if(i._captureWidget())a=i._captureWidget();else{var s=Ye(o,n,r);a=i._root&&i._root.findWidget(s,e,t)}return a},u=function(e){var n=s(e);return null==n?null:new Et(e,n,t,o.x,o.y,ze(t),t.ctrlKey,t.shiftKey,t.altKey,t.metaKey)},l=function(){var a=i._captureWidget();if(a){var s=Ye(o,n,r),u=i._root&&i._root.findWidget(s,e.FEventType.MouseUp,t);if(u){var l=i.lowestCommonAncestor(a,u);l&&(i._syntheticClick=new Et(e.FEventType.Click,l,t,o.x,o.y,ze(t),t.ctrlKey,t.shiftKey,t.altKey,t.metaKey))}else i._syntheticClick=null}else i._syntheticClick=null};switch(t.type){case"mousedown":a=u(e.FEventType.MouseDown);break;case"mouseup":a=u(e.FEventType.MouseUp),l();break;case"mousemove":a=u(e.FEventType.MouseMove);break;case"click":null!==this._syntheticClick?(this._syntheticClick.nativeEvent=t,a=this._syntheticClick):a=u(e.FEventType.Click);break;case"dblclick":a=u(e.FEventType.Dblclick);break;case"wheel":var c=t,h=c.deltaX,d=c.deltaY,f=s(e.FEventType.MouseWheel);a=f&&new bt(h,d,f,t,o.x,o.y,ze(t),t.ctrlKey,t.shiftKey,t.altKey,t.metaKey);break;case"contextmenu":a=u(e.FEventType.ContextMenu);break;case"pointercancel":a=u(e.FEventType.PointerCancel)}return a},t.prototype._convertDragEvent=function(t,n,r){var i=this,o=null,a=null,s=function(e,a){var s=new re(t.clientX,t.clientY);s=i.domPoint2Event(s);var u=i._captureWidget(),l=Ye(s,n,r),c=i._root&&i._root.findWidget(l,e,t);if(null==(o=a?i.dragTarget(u&&u.draggable?u:c):i.dropTarget(c)))return null;var h=t;return new St(e,o,t,s.x,s.y,ze(h),h.ctrlKey,h.shiftKey,h.altKey,h.metaKey,h.dataTransfer,i._dragCanvas)};switch(t.type){case"dragstart":(a=s(e.FEventType.DragStart,!0))instanceof St&&a.dataTransfer&&a.dataTransfer.setData(L,a.target.UID.toString());break;case"drag":a=s(e.FEventType.Drag,!0);break;case"dragend":a=s(e.FEventType.DragEnd,!0);break;case"dragenter":case"dragover":a=s(e.FEventType.DragOver,!1);break;case"drop":a=s(e.FEventType.Drop,!1);break;case"dragleave":var u=t,l=u.ctrlKey,c=u.shiftKey,h=u.altKey,d=u.metaKey;this._enterLeaveDispatch(!1,null,t,{globalX:0,globalY:0,buttons:ze(t),ctrlKey:l,shiftKey:c,altKey:h,metaKey:d})}return a},t.prototype._clearDragImage=function(){var e=this._dragCanvas.ctx({alpha:!0});e.setTransform(1,0,0,1,0,0),ne(e,new oe(0,0,this._dragCanvas.width(),this._dragCanvas.height()))},t.prototype._enterLeaveDispatch=function(t,n,r,i){if(n!==this._cursorWidget){var o=[],a=null;w(this._cursorWidget,(function(e){return null!==n&&e.ancestorOf(n)?(a=e,!0):(o.push(e),!1)}));var s=[];w(n,(function(e){return e===a||(s.unshift(e),!1)})),this.setCursorWidget(n),this.refreshCursor(),o.forEach((function(n){if(!n.destroied()){var o=t?e.FEventType.MouseLeave:e.FEventType.DragLeave,a=new Ct(o,n,r,i.globalX,i.globalY,i.buttons,i.ctrlKey,i.shiftKey,i.altKey,i.metaKey);Ae.sendEvent(n,a)}})),s.forEach((function(n){var o=t?e.FEventType.MouseEnter:e.FEventType.DragEnter,a=new Tt(o,n,r,i.globalX,i.globalY,i.buttons,i.ctrlKey,i.shiftKey,i.altKey,i.metaKey);Ae.sendEvent(n,a)}))}},t.prototype.refreshCursor=function(){if(this._root&&t.cursorRootId===this._root.UID){var e="";w(this._cursorWidget,(function(t){return""!==(e=t.cursor||"")})),e=e||this._root.cursor||"default",this._eventDom.style.cursor=e}},t.prototype.dragTarget=function(e){var t=null;return w(e,(function(e){var n=e.draggable;return n&&(t=e),n})),t},t.prototype.dropTarget=function(e){var t=null;return w(e,(function(e){var n=e.droppable;return n&&(t=e),n})),t},t.prototype._isDestroied=function(e){return e.destroied()},t.prototype._captureWidget=function(){if(null!==this._userCapture){if(!this._isDestroied(this._userCapture))return this._userCapture;this._userCapture=null}if(null!==this._autoCapture){if(!this._isDestroied(this._autoCapture))return this._autoCapture;this.releaseAutoCapture()}return null},Object.defineProperty(t.prototype,"scrollX",{get:function(){var e=document.documentElement||document.body.parentNode;return(e&&"number"==typeof e.scrollLeft?e:document.body).scrollLeft},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scrollY",{get:function(){var e=document.documentElement||document.body.parentNode;return(e&&"number"==typeof e.scrollTop?e:document.body).scrollTop},enumerable:!1,configurable:!0}),t.prototype.bindEvents=function(){t.bindEvents(this)},t.prototype.unbindEvents=function(){t.unbindEvents(this)},t.cursorRootId=Number.NEGATIVE_INFINITY,t.dragEvents=["dragstart","drag","drop","dragover","dragend","dragenter","dragleave"],t.mouseEvents=["mousedown","mousemove","mouseup","click","dblclick","wheel","contextmenu","pointercancel"],t.documentEvents=["mousedown","mousemove","mouseup","click","dblclick","contextmenu","wheel"],t.canvasEvents=["mouseleave","mouseenter","wheel"],t.hammerEvents="tap doubletap panstart panmove panend pancancel press pressup swipe   pinchstart pinchmove pinchend pinchcancel   rotatestart rotatemove rotateend rotatecancel",t.isSupportDpiListener=!0,t._dragCanvas=null,t._minMatchMedia=null,t._maxMatchMedia=null,t._observer=null,t.eventDispatchers=[],t._setOffsetDirty=function(){t.eventDispatchers.forEach((function(e){return e.setOffsetDirty()}))},t._windowBlured=function(){t.eventDispatchers.forEach((function(e){return e._windowBlured()}))},t._windowFocused=function(){t.eventDispatchers.forEach((function(e){return e._windowFocused()}))},t._bindDpiChanged=function(){window.visualViewport&&window.visualViewport.addEventListener("resize",t.dpiChangedDebounce),t._minMatchMedia=window.matchMedia("screen and (min-resolution: ".concat(window.devicePixelRatio,"dppx)")),t._maxMatchMedia=window.matchMedia("screen and (max-resolution: ".concat(window.devicePixelRatio,"dppx)")),t._minMatchMedia&&t._minMatchMedia.addEventListener&&t._minMatchMedia.addEventListener("change",t.dpiChanged),t._maxMatchMedia&&t._maxMatchMedia.addEventListener&&t._maxMatchMedia.addEventListener("change",t.dpiChanged),t.isSupportDpiListener=!!(t._minMatchMedia&&t._minMatchMedia.addEventListener&&t._maxMatchMedia&&t._maxMatchMedia.addEventListener)},t._unbindDpiChanged=function(){window.visualViewport&&window.visualViewport.removeEventListener("resize",t.dpiChangedDebounce),t._minMatchMedia&&t._minMatchMedia.removeEventListener&&t._minMatchMedia.removeEventListener("change",t.dpiChanged),t._maxMatchMedia&&t._maxMatchMedia.removeEventListener&&t._maxMatchMedia.removeEventListener("change",t.dpiChanged)},t.dpiChanged=function(){he.updateDPI(),Ne.tickWake(),t._unbindDpiChanged(),t._bindDpiChanged()},t}();function ze(e){if(e.buttons||~je.indexOf(e.type))return e.buttons;if("contextmenu"===e.type)return 2;switch(e.button){case 0:return 1;case 2:return 2;case 1:return 4;case 3:return 8;case 4:return 16}return 1}function Ye(e,t,n){if(!t)return e;var r=e.x-t.x,i=e.y-t.y;if(n){var o=new Q(n.a,n.b,n.c,n.d,n.e,n.f);r=o.inversePointX(r,i),i=o.inversePointY(r,i)}return new re(r,i)}Ne.onAppExit((function(){return Ge.destroyDragCanvas()}));var Xe,Ke,qe,$e,Je,Qe=function(e){function t(t,n){return e.call(this,t,n)||this}return y(t,e),t}(Ce);e.MainAxisSize=void 0,(Je=e.MainAxisSize||(e.MainAxisSize={})).Max="Max",Je.Min="Min",e.AxisAlignment=void 0,($e=e.AxisAlignment||(e.AxisAlignment={}))[$e.Start=0]="Start",$e[$e.Center=1]="Center",$e[$e.End=2]="End",$e[$e.SpaceBetween=3]="SpaceBetween",$e[$e.SpaceAround=4]="SpaceAround",e.CrossAxisAlignment=void 0,(qe=e.CrossAxisAlignment||(e.CrossAxisAlignment={}))[qe.Start=0]="Start",qe[qe.Center=1]="Center",qe[qe.End=2]="End",e.FlexDirection=void 0,(Ke=e.FlexDirection||(e.FlexDirection={}))[Ke.Horizontal=0]="Horizontal",Ke[Ke.Vertical=1]="Vertical",e.VerticalDirection=void 0,(Xe=e.VerticalDirection||(e.VerticalDirection={}))[Xe.Up=0]="Up",Xe[Xe.Down=1]="Down";var et,tt=Number.MAX_SAFE_INTEGER;e.ScrollDirection=void 0,(et=e.ScrollDirection||(e.ScrollDirection={}))[et.auto=0]="auto",et[et.none=1]="none",et[et.x=2]="x",et[et.y=3]="y";var nt,rt=function(){function e(e){this.minWidth=0,this.maxWidth=0,this.minHeight=tt,this.maxHeight=tt,e?(this.minWidth=void 0!==e.minWidth?e.minWidth:0,this.minHeight=void 0!==e.minHeight?e.minHeight:0,this.maxWidth=void 0!==e.maxWidth?e.maxWidth:tt,this.maxHeight=void 0!==e.maxHeight?e.maxHeight:tt):(this.minWidth=0,this.minHeight=0,this.maxWidth=tt,this.maxHeight=tt)}return e.prototype.copy=function(t){return new e(t?{minWidth:void 0!==t.minWidth?t.minWidth:this.minWidth,maxWidth:void 0!==t.maxWidth?t.maxWidth:this.maxWidth,minHeight:void 0!==t.minHeight?t.minHeight:this.minHeight,maxHeight:void 0!==t.maxHeight?t.maxHeight:this.maxHeight}:{minWidth:this.minWidth,maxWidth:this.maxWidth,minHeight:this.minHeight,maxHeight:this.maxHeight})},e.prototype.ifNoConstraint=function(){return 0===this.minHeight&&0===this.minWidth&&this.maxHeight>=tt&&this.maxWidth>=tt},e.prototype.hasMaxWidth=function(){return this.maxWidth<tt},e.prototype.hasMaxHeight=function(){return this.maxHeight<tt},e.prototype.hasMinHeight=function(){return 0!==this.minHeight},e.prototype.hasMinWidth=function(){return 0!==this.minWidth},e.prototype.isWidthFixed=function(){return this.minWidth===this.maxWidth},e.prototype.isHeightFixed=function(){return this.minHeight===this.maxHeight},e.prototype.isNormal=function(){return this.minWidth>=0&&this.minWidth<=this.maxWidth&&this.minHeight>=0&&this.minHeight<=this.maxHeight&&this.maxWidth<tt&&this.maxHeight<tt},e}(),it=function(){function e(e,t){this.changedHandler=null,this._type=e,this.data=t}return Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),e.prototype.with=function(e){return Object.assign(this.data,e),this},e.prototype.onChange=function(e){return this.changedHandler=e,this},e.prototype.createWidget=function(){var e=new(0,this._type)(this.data);return e.state=this,e},e}(),ot=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return y(t,e),t.prototype.fill=function(e){return this.data.singleChild=e,this},t}(it),at=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return y(t,e),t.prototype.fill=function(e){return this.data.multipleChild=e,this},t}(it),st=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return y(t,e),t.prototype.fillEach=function(e){return this.data.eachChild=e,this},t}(at),ut=function(){function e(){this._list=new Map,this._insertCallback=[],this.id=e._id++,e._hashMap.set(this.id,this)}return e.get=function(e){return this._hashMap.get(e)},e.prototype.destroy=function(){e._hashMap.delete(this.id),this._list.clear(),this._insertCallback=[]},e.prototype.setInsertCallback=function(e){this._insertCallback.indexOf(e)<0&&this._insertCallback.push(e)},e.prototype.removeInsertCallback=function(e){var t=this._insertCallback.indexOf(e);t>-1&&this._insertCallback.splice(t,1)},e.prototype.clear=function(){this._list.clear()},e.prototype.insert=function(e){this._list.has(e.uid)||(this._list.set(e.uid,e),Ne.tickWake(),this._insertCallback.forEach((function(t){return t(e)})))},e.prototype.remove=function(e){this._list.delete(e.uid)},e.prototype.entries=function(){return this._list.entries()},e.prototype.isEmpty=function(){return 0===this._list.size},e.prototype.has=function(e){return this._list.has(e.uid)},e.prototype.size=function(){return this._list.size},e.prototype.forEach=function(e){this._list.forEach(e)},e._hashMap=new Map,e._id=0,e}(),lt=function(){function t(n,r){var i=this;this._dirtyWidgets=new ut,this._isActive=!1,this._autoSuspend=!0,this._app=null,this._size=new ie(0,0),this._destroied=!1,this._needPaint=!1,this._needResize=!1,this.options={alpha:!0},this.onContextRestored=function(){i.suspend(),i.wakeup()},this._notifyHandler=function(e){i._needPaint=!0},this._onVisibilityChange=function(){if(i._autoSuspend)return document.visibilityState===e.VisibilityState.Hidden?he.mallocedCanvas(i).filter((function(e){return e!==i._canvas})).forEach((function(e){return e.suspend()})):he.mallocedCanvas(i).forEach((function(e){return e.wakeup()})),!1},this.UID=t._uid++,n instanceof HTMLCanvasElement?this._canvas=he.borrowCanvas(this,n):n instanceof ve?this._canvas=n:(this._canvas=he.borrowCanvas(this),n.appendChild(this._canvas.element())),r&&r instanceof HTMLElement?this._eventDom=r:null!=r&&(this.options=r),"ssr"==="production".toLowerCase()||(this._dispatcher=new Ge(this.eventDom())),t.addInstance(this.UID,this),this._canvas.registerNotify(this._notifyHandler),document.addEventListener("visibilitychange",this._onVisibilityChange),this._canvas.element().addEventListener("contextrestored",this.onContextRestored)}return t.addInstance=function(e,t){this.instanceCollector.set(e,t)},t.removeInstance=function(e){this.instanceCollector.delete(e),0===this.instanceCollector.size&&he.clear()},t.instanceIter=function(e){this.instanceCollector.forEach((function(t){return e(t)}))},t.createWidget=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t&&e.updateByCfg(t),n.forEach((function(t){return e.addChild(t)})),e},t.getRootList=function(){var e=[];return this.instanceCollector.forEach((function(t){return e.push(t)})),e},t.sendEvent=function(e,t,n){return Ae.sendEvent(e,t,n)},t.findFaster=function(e){var t=e.rootId();return null===t?null:this.instanceCollector.get(t)||null},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isActive",{get:function(){return this._isActive},enumerable:!1,configurable:!0}),t.prototype.app=function(){return this._app},t.prototype.markNeedPaint=function(){this._needPaint=!0},Object.defineProperty(t.prototype,"defaultBackground",{get:function(){if(!this.options.alpha&&this.options.defaultBackground)return ft(this,this.options.defaultBackground,e.ColorThemeType.Background)},enumerable:!1,configurable:!0}),t.prototype.setAutoSuspend=function(e){this._autoSuspend=e},t.prototype.setOffsetDirty=function(){this._dispatcher&&this._dispatcher.setOffsetDirty()},t.prototype.dispatcher=function(){return this._dispatcher},t.prototype.updateCanvas=function(e){this._canvas=e},t.prototype.canvas=function(){return this._canvas},t.prototype.eventDom=function(){return this._eventDom?this._eventDom:this._canvas.element()},t.prototype.updateDraggable=function(e){this.eventDom().draggable=e},t.prototype.suspend=function(){this._isActive&&(this._isActive=!1,he.mallocedCanvas(this).forEach((function(e){return e.suspend()})),Ne.exit(this),this._dispatcher&&this._dispatcher.stop())},t.prototype.wakeup=function(){this._isActive||(this._isActive=!0,he.mallocedCanvas(this).forEach((function(e){return e.wakeup()})),Ne.start(this),this._canvas.resize(this._size.width,this._size.height,!0),this._dispatcher&&this._dispatcher.start(),Ne.tickWake())},t.prototype.exec=function(){this.wakeup()},t.prototype.exit=function(){this._isActive&&this.suspend(),this._dispatcher&&this._dispatcher.destroy(),this.destroy()},t.prototype.resize=function(e,t){this._size.width===e&&this._size.height===t||(this._size.width=e,this._size.height=t,this._needResize=!0)},t.prototype.runApp=function(e){e instanceof it||(e=e.with({})),this._app=e.createWidget(),this._app.changedListId=this._dirtyWidgets.id,this.markAppDirty(),Ge.cursorRootId=this._app.UID,this._app.setRootId(this.UID),this._dispatcher&&this._dispatcher.setRoot(this._app),this.wakeup()},t.prototype.markAppDirty=function(){this._app&&this._dirtyWidgets.insert({uid:this._app.UID})},t.prototype.destroy=function(){if(!this._destroied){this._destroied=!0,this._app&&(this._app.setRootId(null),this._app.destroy());var e=this._canvas.element();e&&e.removeEventListener("contextrestored",this.onContextRestored),this._dirtyWidgets.destroy(),this._dispatcher&&this._dispatcher.destroy(),Oe.destroyDetached(),he.backCanvas(this._canvas),t.removeInstance(this.UID),this._canvas.unRegisterNotify(this._notifyHandler),document.removeEventListener("visibilitychange",this._onVisibilityChange)}},t.prototype.addListener=function(e,t){this._app&&this._app.addListener(e,t)},t.prototype.addOnceListener=function(e,t){this._app&&this._app.addOnceListener(e,t)},t.prototype.removeListener=function(e,t){this._app&&this._app.removeListener(e,t)},t.prototype.buildInTick=function(e){if(e&&(this._reviseWidgetTree(),this._dirtyWidgets.clear()),this._dispatcher&&this._dispatcher.refreshCursor(),e){var t=this._size,n=t.width,r=t.height,i=new rt({minWidth:0,minHeight:0,maxWidth:n,maxHeight:r});this._app&&this._app.layout(i)}},t.prototype.tick=function(){Ge.isSupportDpiListener||he.updateDPI();var t=!1;this._needResize&&(this._canvas.resize(this.size.width,this.size.height),this._needResize=!1,t=!0),null!==this._app&&(this._dirtyWidgets.isEmpty()?this._app.event(new Qe(e.FEventType.EmptyTick,this._app)):(t=!0,this._app.event(new Qe(e.FEventType.BeforeTick,this._app))),this.buildInTick(t),t?(this.repaint(),this._app.event(new Qe(e.FEventType.AfterTick,this._app)),Ne.tickWake()):this._needPaint&&this.repaint())},t.prototype._reviseWidgetTree=function(){for(var e=this._dirtyWidgets.entries(),t=e.next();!t.done;){var n=t.value[1].uid.toString(),r=Oe.getObjById(n);r&&r.build(),t=e.next()}},t.prototype.repaint=function(){if(this._app){var e=this._canvas.ctx(),t=this._size,n=t.width,r=t.height;ne(e,new oe(0,0,n,r),this.defaultBackground),this._app.renderTree(e),this._needPaint=!1}},t._uid=0,t.instanceCollector=new Map,t}(),ct=new WeakMap;function ht(e,t){ct.set(e,t)}function dt(e){ct.delete(e)}function ft(e,t,n){var r;if(!(r=e instanceof lt?e:lt.findFaster(e)))return t;var i=ct.get(r);return i?i(t,n):t}e.WidgetProps=void 0,(nt=e.WidgetProps||(e.WidgetProps={}))[nt.Droppable=0]="Droppable",nt[nt.Draggable=1]="Draggable",nt[nt.ChildDirty=2]="ChildDirty",nt[nt.EndWidgetProps=3]="EndWidgetProps";var pt,vt=function(t){function n(e,n){var r=t.call(this)||this;return r._key=n,r._props=0,r._filters=[],r._cfg={},r._changes=new Map,r._zindex=0,null!==e&&e.addChild(r),r._cfg=r._defalutCfg(),r.pCfg=null,r._sortedChildren=new I(r._compareZindex,r.children()),r}return y(n,t),n.prototype._cleanProp=function(e){return this._cfg[e]},Object.defineProperty(n.prototype,"key",{get:function(){return this._key},enumerable:!1,configurable:!0}),n.prototype.setLayout=function(e){void 0!==this.layoutManager&&this.layoutManager.detach(),this.layoutManager=e,e&&e.attach(this)},Object.defineProperty(n.prototype,"x",{get:function(){return this._cfg.x||0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"attrClip",{get:function(){return this._cfg.clip},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._cfg.y||0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"background",{get:function(){return this._cfg.background},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"foreground",{get:function(){return this._cfg.foreground},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this._cfg.width||0},set:function(e){this.updateByCfg({width:e})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._cfg.height||0},set:function(e){this.updateByCfg({height:e})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rect",{get:function(){return new oe(this._cfg.x,this._cfg.y,this._cfg.width,this._cfg.height)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isSelfDirty",{get:function(){return this._changes.size>0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isChildDirty",{get:function(){return this._getProps(e.WidgetProps.ChildDirty)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"draggable",{get:function(){return this._getProps(e.WidgetProps.Draggable)},set:function(t){this._setProps(e.WidgetProps.Draggable,t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"droppable",{get:function(){return this._getProps(e.WidgetProps.Droppable)},set:function(t){this._setProps(e.WidgetProps.Droppable,t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"zindex",{get:function(){return this._zindex||0},set:function(e){this._zindex=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hidden",{get:function(){return this._cfg.hidden||!1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ignore",{get:function(){return this._cfg.ignore||!1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"padding",{get:function(){return this._cfg.padding},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"border",{get:function(){return this._cfg.border},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"borderTop",{get:function(){return this._cfg.borderTop},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"borderRight",{get:function(){return this._cfg.borderRight},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"borderBottom",{get:function(){return this._cfg.borderBottom},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"borderLeft",{get:function(){return this._cfg.borderLeft},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"radius",{get:function(){return this._cfg.radius},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"shadow",{get:function(){return this._cfg.shadow},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"cursor",{get:function(){return this._cfg.cursor},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"opacity",{get:function(){var e=this._cfg.opacity;return void 0!==e?e:1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"transform",{get:function(){return this._cfg.transform||new Q},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"frame",{get:function(){return this.rect},set:function(e){this.updateByCfg({x:e.x,y:e.y,width:e.width,height:e.height})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"size",{get:function(){return new ie(this.width,this.height)},set:function(e){var t=new oe(this.x,this.y,e.width,e.height);this.frame=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"origin",{get:function(){return new re(this.x,this.y)},set:function(e){this.updateByCfg({x:e.x,y:e.y})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"horizontalSpace",{get:function(){return this.width},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"verticalSpace",{get:function(){return this.height},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"skipSelfEvent",{get:function(){return this._cfg.skipSelfEvent},enumerable:!1,configurable:!0}),n.prototype.respondEvent=function(e){var t=this.ignore;return"boolean"==typeof t?!t:"object"==typeof t?-1===t.indexOf(e):t!==e},n.prototype._selfRect=function(){var e=this._cfg.clip,t=new oe(0,0,this.width,this.height);return e?t.intersectRect(new oe(e[0],e[1],e[2],e[3])):t},n.prototype.findWidget=function(e,t,n){e=this.mapFromParent(e.clone());for(var r=null,i=this._selfRect().containPoint(e)?this:null,o=new Set;i;)if(i!==r){r=i;for(var a=i.children(),s=a.length-1;s>=0;s--){var u=a[s];if(!o.has(u.UID)&&!u.hidden&&(void 0===u.respondEvent||void 0===t||u.respondEvent(t))){var l=u.mapFromParent(e.clone());if(u.hitTest(l,t,n)){e=u.mapFromParent(e),(i=u).skipSelfEvent&&o.add(i.UID);break}}}}else{if(!i.skipSelfEvent)break;e=i.mapToParent(e),i=i.parent()}return i},n.prototype.findWidgetByMultiPoint=function(e,t){var n=this,r=e.map((function(e){return n.findWidget(e,t)})),i=[];return r.forEach((function(e){0===i.length?w(e,(function(e){return i.push(e),!1})):w(e,(function(e){var t=i.findIndex((function(t){return t===e}));return-1!==t&&(i=i.slice(t),!0)}))})),0===i.length?null:i.shift()},n.prototype.hitTest=function(e,t,n){return this._selfRect().containPoint(e)},n.prototype.addEventFilter=function(e){this._filters.push(e)},n.prototype.removeEventFilter=function(e){this._filters=this._filters.filter((function(t){return t!==e}))},n.prototype.eventFilters=function(){return this._filters},n.prototype.intersectRectWidthClipIfNeed=function(e){var t=this._cfg.clip;return t?new oe(this.x+t[0],this.y+t[1],t[2],t[3]).intersectRect(e):e},n.prototype.clipIfNeed=function(e,t){var n=this.paintedRect(),r=this.intersectRectWidthClipIfNeed(t);if(!r.containRect(n))return _t(e,r)},n.prototype.paint=function(e,t){var n=this.pCfg||this._cfg;if(!n.hidden){if(e.save(),void 0!==n.transform){var r=this._transformInfo(!0),i=r.a,o=r.b,a=r.c,s=r.d,u=r.e,l=r.f;e.transform(i,o,a,s,u,l)}this.clipIfNeed(e,t),"number"==typeof n.opacity&&(e.globalAlpha*=n.opacity),this.renderWidget(e,t);var c=n.x,h=n.y;t.x-=c,t.y-=h,e.translate(c,h),this.renderChildren(e,t),e.translate(-c,-h),this._paintBorder(e),e.restore()}},n.prototype.renderChildren=function(e,t){var n=this;if(this.hasChild()){var r=!1;this.children().forEach((function(i){var o=t.clone();if(n._isChildNeedPaint(i,o)){var a=o.clone(),s=i.pCfg||i._cfg;s.transform&&s.transform.mapRect(a),r||t.containRect(a)||(_t(e,t),r=!0),i.paint(e,o)}}))}},n.prototype._dirtyParent=function(){var t=this.parent();null!==t&&!t.isChildDirty&&this.isSelfDirty&&t._dirtyList(e.WidgetProps.ChildDirty)},n.prototype._pickChanges=function(e){var t={};for(var n in e){var r=e[n],i=this._cfg[n];yt(r),x(r,i)||(t[n]={before:i,current:r})}return t},n.prototype.detectLifetimeOnce=function(e){void 0===e&&(e=!1),this._changes.has("_phantom")||(this.updateByCfg({_phantom:!0}),e||this.children().forEach((function(t){return t.detectLifetimeOnce(e)})))},n.prototype.mapTransformToParent=function(e){var t=this._transformInfo(!1);return e.transform(t.a,t.b,t.c,t.d,t.e,t.f),e},n.prototype.mapTransformToGlobal=function(e){var t=[];return w(this,(function(e){return t.push(e),!1})),t.forEach((function(t){return t.mapTransformToParent(e)})),e},n.prototype.mapFromParent=function(e){var t=this._transformInfo(!1);return t.inversePoint(e.move(-this.x*t.a,-this.y*t.d))},n.prototype.mapToParent=function(e){var t=this._transformInfo(!1);return t.mapPoint(e).move(this.x*t.a,this.y*t.d)},n.prototype.mapFromGlobal=function(e){var t=[];return w(this,(function(e){return t.push(e),!1})),t.reverse().forEach((function(t){return t.mapFromParent(e)})),e},n.prototype._updateConfigAndChanges=function(t,n){void 0===n&&(n=!1);var r=this._pickChanges(t);if(Object.keys(r).length){this.event(new xe(e.FEventType.BeforeChange,this,r));var i=Object.keys(r);this._updateByKeyChanges(r,i,n),this.event(new xe(e.FEventType.AfterChange,this,r))}return r},n.prototype._updateByKeyChanges=function(e,t,n){var r=this;t.length>0&&t.forEach((function(t){var i=e[t];"draggable"!==t&&"dropable"!==t&&"_phantom"!==t&&"needLayout"!==t&&(r._cfg[t]=i.current),r._setChange(t,i,n)}))},n.prototype.mapToGlobal=function(e){var t=[];return w(this,(function(e){return t.push(e),!1})),t.forEach((function(t){return t.mapToParent(e)})),e},n.prototype._setChange=function(e,t,n){if(t.current!==t.before){if(this._changes.has(e)){var r=this._changes.get(e).before;r===t.current?this._changes.delete(e):this._changes.set(e,{before:r,current:t.current})}else n||this._changes.set(e,t);ke.firePropChange(this,e,t.current)}},n.prototype._detectZIndexChange=function(e){var t=this.parent();"zindex"in e&&(null!==t?(t.removeChild(this),this._zindex=e.zindex.current,t.addChild(this)):this._zindex=e.zindex.current)},n.prototype.trySetConfigDirectly=function(e){var t=this._updateConfigAndChanges(e,!0);return this._dirtyParent(),this._detectZIndexChange(t),t},n.prototype.updateByCfg=function(e){var t=this._updateConfigAndChanges(e);this._dirtyParent(),this._detectZIndexChange(t);var n=this.parent();return n&&n.onChildChange(this,t),t},n.prototype.parent=function(){return t.prototype.parent.call(this)},n.prototype.setParent=function(n){t.prototype.setParent.call(this,n),null!==n&&(n._dirtyList(e.WidgetProps.ChildDirty),n.event(new Ce(e.FEventType.AddChild,this)))},n.prototype.insertToParent=function(e){e._sortedChildren.insert(this)},n.prototype.removeChild=function(n){n.parent()===this?(this._dirtyList(e.WidgetProps.ChildDirty),this.beforeRemoveChild(n),t.prototype.removeChild.call(this,n),n.detectLifetimeOnce(),this.event(new Ce(e.FEventType.RemoveChild,n))):console.error("remove a child is not this widget child")},n.prototype.removeSelf=function(){this.parent()&&this.parent().removeChild(this)},n.prototype.children=function(){return t.prototype.children.call(this)},n.prototype.event=function(e){var n=t.prototype.event.call(this,e);return e.defaultPrevented?e.canclePreventDefault():n=n||this._partationEvent(e),n},n.prototype.mouseDown=function(e){return!1},n.prototype.mouseMove=function(e){return!1},n.prototype.mouseUp=function(e){return!1},n.prototype.click=function(e){return!1},n.prototype.dblClick=function(e){return!1},n.prototype.mouseEnter=function(e){return!1},n.prototype.mouseLeave=function(e){return!1},n.prototype.mouseWheel=function(e){return!1},n.prototype.contextMenu=function(e){return!1},n.prototype.dragStart=function(e){var t=e.defautDragImageCtx();return t.save(),t.translate(-this.x,-this.y),this.paint(t,this.paintedRect()),t.restore(),!0},n.prototype.dragEnd=function(e){return!1},n.prototype.dragOver=function(e){return!1},n.prototype.dragEnter=function(e){return!1},n.prototype.dragLeave=function(e){return!1},n.prototype.dragEvent=function(e){return!1},n.prototype.dropEvent=function(e){return!1},n.prototype.tap=function(e){return!1},n.prototype.doubleTap=function(e){return!1},n.prototype.panStart=function(e){return!1},n.prototype.panMove=function(e){return!1},n.prototype.panEnd=function(e){return!1},n.prototype.panCancel=function(e){return!1},n.prototype.press=function(e){return!1},n.prototype.pressUp=function(e){return!1},n.prototype.swipe=function(e){return!1},n.prototype.rotateStart=function(e){return!1},n.prototype.rotateMove=function(e){return!1},n.prototype.rotateEnd=function(e){return!1},n.prototype.rotateCancel=function(e){return!1},n.prototype.pinchStart=function(e){return!1},n.prototype.pinchMove=function(e){return!1},n.prototype.pinchEnd=function(e){return!1},n.prototype.pinchCancel=function(e){return!1},n.prototype.flushCfg=function(e){this.flush()},n.prototype.flush=function(){var t=this._changes,n=t.size>0,r={},i=!1;n&&(t.forEach((function(e,t){r[t]=e})),this.event(new xe(e.FEventType.BeforeFlush,this,r)),i=this._flushProps(r));var o=this.parent();if(o&&o.markDirtyRect&&(i||this.isChildDirty)){var a=this.oldDirtyRect(),s=this._oldTransformInfo(),u=this._transformInfo(!1);u.inverseRect(s.mapRect(a));var l=this.paintedRect();r.hidden&&r.hidden.current?l.reset():r.hidden&&r.hidden.before&&a.reset(),o.markDirtyRect(u.mapRect(a)),o.markDirtyRect(u.mapRect(l))}this.isChildDirty&&(this._setProps(e.WidgetProps.ChildDirty,!1),this.children().forEach((function(e){var t=e;if(t.isSelfDirty||t.isChildDirty)return t.flush()}))),n&&this.event(new xe(e.FEventType.AfterFlush,this,r))},n.prototype.paintedRect=function(){var e=this.pCfg||this._cfg,t=e.x,n=e.y,r=e.width,i=e.height,o=e.shadow,a=new oe(t,n,r,i);return void 0!==o&&this._rectAppendShadow(a,o),a},n.prototype.oldDirtyRect=function(){var e,t=this.pCfg||this._cfg,n=t.x,r=t.y,i=t.width,o=t.height;this._changes.has("x")&&(n=this._changes.get("x").before),this._changes.has("y")&&(r=this._changes.get("y").before),this._changes.has("width")&&(i=this._changes.get("width").before),this._changes.has("height")&&(o=this._changes.get("height").before),this._changes.has("shadow")&&(e=this._changes.get("shadow").before),void 0===e&&(e=this._cfg.shadow);var a=new oe(n,r,i,o);return void 0!==e&&this._rectAppendShadow(a,e),a},n.prototype.contentRect=function(e){var t=e?this._cfg:this,n=t.x,r=t.y,i=t.width,o=t.height,a=t.padding,s=t.border;return s=P(s,{width:0,color:""}),n+=(a=P(a,0))[3]+s[3].width,r+=a[0]+s[0].width,i=i-a[1]-a[3]-s[1].width-s[3].width,o=o-a[0]-a[2]-s[0].width-s[2].width,new oe(n,r,i,o)},n.prototype.removeAllChild=function(){var e=this;this.children().forEach((function(t){e.beforeRemoveChild(t)})),t.prototype.removeAllChild.call(this)},n.prototype.beforeRemoveChild=function(e){this._parent&&this._parent.beforeRemoveChild(e)},n.prototype.destroy=function(){this._parent&&this._parent.beforeRemoveChild(this),t.prototype.destroy.call(this)},n.prototype.fvgNode=function(){var t=this._cfg,n={x:t.x,y:t.y,width:t.width,height:t.height,draggable:this.draggable,droppable:this.droppable},r={type:e.WidgetType.widget,cfg:n};return void 0!==t.zindex&&(n.zindex=t.zindex),void 0!==t.hidden&&(n.hidden=t.hidden),void 0!==t.ignore&&(n.ignore=t.ignore),void 0!==t.background&&(n.background=t.background),void 0!==t.foreground&&(n.foreground=t.foreground),void 0!==t.shadow&&(n.shadow=t.shadow),void 0!==t.radius&&(n.radius=t.radius),void 0!==t.padding&&(n.padding=t.padding),void 0!==t.borderTop&&(n.borderTop=t.borderTop),void 0!==t.borderRight&&(n.borderRight=t.borderRight),void 0!==t.borderBottom&&(n.borderBottom=t.borderBottom),void 0!==t.borderLeft&&(n.borderLeft=t.borderLeft),void 0!==t.border&&(n.border=t.border),r},n.prototype._isChildNeedPaint=function(e,t){var n=e.pCfg||e._cfg;if(n.hidden)return!1;var r=n.transform,i=e.paintedRect();return void 0!==r&&r.mapRect(i),t.intersectRect(i),void 0!==r&&r.inverseRect(t),!t.isEmpty()},n.prototype.renderWidget=function(t,n){var r=this.pCfg||this._cfg,i=r.background;if(i){var o,a=r.x,s=r.y,u=r.width,l=r.height,c=r.radius;o=r.shadow&&r.shadow.color?Object.assign({},r.shadow,{color:ft(this,r.shadow.color,e.ColorThemeType.Border)}):r.shadow;var h=t.fillType;t.fillType=e.ColorThemeType.Background,j(t,a,s,u,l,ft(this,i,e.ColorThemeType.Background),c,o),t.fillType=h}},n.prototype._dirtyList=function(e){w(this,(function(t){return!!t._getProps(e)||(t._setProps(e,!0),!1)})),Ne.tickWake()},n.prototype._flushProps=function(e){var t=this,n=!1;return Object.keys(e).forEach((function(r){var i=e[r];"draggable"===r||"dropable"===r||"_phantom"===r||"needLayout"===r||t._cfg[r]===i.current?("draggable"===r?t.draggable=i.current:"dropable"===r?t.droppable=i.current:"_phantom"===r||"needLayout"===r?(t._changes.delete(r),n=!0):"cursor"!==r&&"ignore"!==r&&(n=!0),t._changes.has(r)&&t._changes.get(r).current===i.current&&t._changes.delete(r)):t._changes.set(r,{before:i.current,current:t._cfg[r]})})),this.hidden&&!e.hidden&&(n=!1),n},n.prototype._defalutCfg=function(){return{x:0,y:0,width:0,height:0}},n.prototype._paintBorder=function(t){var n=this.pCfg||this._cfg,r=n.border,i=n.borderTop,o=n.borderRight,a=n.borderBottom,s=n.borderLeft;if(r||i||o||a||s){for(var u=n.x,l=n.y,c=n.width,h=n.height,d=P(r,{color:"",width:0},i,o,a,s),f=d[0].style!==e.borderDash.dash,p=1;p<d.length;++p){var v=d[p];if(v.width!==d[0].width||v.color!==d[0].color||v.style===e.borderDash.dash){f=!1;break}}if(f){var g=t.strokeType,_=d[0].width;if(t.save(),t.lineWidth=_,t.strokeStyle=ft(this,d[0].color,e.ColorThemeType.Border),t.strokeType=e.ColorThemeType.Border,t.beginPath(),n.radius){var y=_/2,m="number"==typeof n.radius?mt(n.radius,y):P(n.radius,0).map((function(e){return mt(e,y)}));t.roundRect(u+y,l+y,c-_,h-_,m)}else t.rect(u,l,c,h);return t.stroke(),t.restore(),void(t.strokeType=g)}var E=C(d,4),b=E[0],T=E[1],S=E[2],w=E[3],R=C(this._quaterSplitRadius(n.radius,c,h),4),A=R[0],O=R[1],M=R[2],k=R[3],I=[];I.push({start:[u+A,l],end:[u+c-O,l],offset:[0,1],style:b}),gt(I,u+c-O,l+O,O,1.5*Math.PI,b,T),I.push({start:[u+c,l+O],end:[u+c,l+h-M],offset:[-1,0],style:T}),gt(I,u+c-M,l+h-M,M,0,T,S),I.push({start:[u+c-M,l+h],end:[u+k,l+h],offset:[0,-1],style:S}),gt(I,u+k,l+h-k,k,.5*Math.PI,S,w),I.push({start:[u,l+h-k],end:[u,l+A],offset:[1,0],style:w}),gt(I,u+A,l+A,A,Math.PI,w,b);var N=[];if(I.forEach((function(e,t){if(0===t)N.push([e]);else{var n=N[N.length-1];x(n[n.length-1].style,e.style)?n.push(e):N.push([e])}})),N.length>1){var L=N[0][0],D=N[N.length-1][0];if(x(L.style,D.style)){var F=N[0],B=N.pop();for(p=B.length-1;p>=0;p--)F.unshift(B[p])}}this._paintBorders(t,N)}},n.prototype._paintBorders=function(t,n){var r=this;t.save();var i=ee(t),o=1;i.a===i.d&&0===i.b&&0===i.c?(o=i.a,t.setTransform(1,0,0,1,0,0)):i=new Q;var a=t.strokeType;n.forEach((function(n){var a=n[0].style;if(!(a.width<=0)){t.beginPath();var s=a.width,u=Math.round(s*o);t.lineWidth=u,t.strokeStyle=ft(r,a.color,e.ColorThemeType.Border),t.strokeType=e.ColorThemeType.Border,a.style===e.borderDash.dash?t.setLineDash(Array.isArray(a.dashLine)?a.dashLine:N):t.setLineDash([]),n.forEach((function(e){var n=u/2;if("offset"in e){var r=i.mapPoint(new re(e.start[0],e.start[1])).rounds(),a=i.mapPoint(new re(e.end[0],e.end[1])).rounds(),s=n*e.offset[0],l=n*e.offset[1];t.moveTo(r.x+s,r.y+l),t.lineTo(a.x+s,a.y+l)}else{var c=e.cx,h=e.cy,d=e.radius,f=e.start,p=e.end,v=i.mapPoint(new re(c,h)).rounds();d*=o,t.arc(v.x,v.y,d-n,f,p)}})),t.stroke()}})),t.strokeType=a,t.restore()},n.prototype._rectAppendShadow=function(e,t){var n=t.offsetX||0,r=t.offsetY||0,i=t.blur||0,o=Math.floor(e.x-i+n),a=Math.floor(e.y-i+r),s=Math.floor(e.x+e.width+i+n),u=Math.floor(e.y+e.height+i+r),l=new oe(o,a,s-o,u-a);return e.union(l)},n.prototype._quaterSplitRadius=function(e,t,n){return G(e,t,n)},n.prototype._partationEvent=function(t){switch(t.type){case e.FEventType.BeforeChange:return this.beforeChange(t),!1;case e.FEventType.AfterChange:return this.afterChange(t),!1;case e.FEventType.BeforeFlush:return this.beforeFlush(t),!1;case e.FEventType.AfterFlush:return this.afterFlush(t),!1;case e.FEventType.BeforeTick:return this.beforeTick(t),!1;case e.FEventType.AfterTick:return this.afterTick(t),!1;case e.FEventType.BeforeLayerRender:return this.beforeLayerRender(t),!1;case e.FEventType.AfterLayerRender:return this.afterLayerRender(t),!1;case e.FEventType.PanStart:return this.panStart(t);case e.FEventType.PanMove:return this.panMove(t);case e.FEventType.PanEnd:return this.panEnd(t);case e.FEventType.PanCancel:return this.panCancel(t);case e.FEventType.MouseMove:return this.mouseMove(t);case e.FEventType.MouseEnter:return this.mouseEnter(t);case e.FEventType.MouseLeave:return this.mouseLeave(t);case e.FEventType.MouseWheel:return this.mouseWheel(t);case e.FEventType.MouseDown:return this.mouseDown(t);case e.FEventType.MouseUp:return this.mouseUp(t);case e.FEventType.Click:return this.click(t);case e.FEventType.Dblclick:return this.dblClick(t);case e.FEventType.ContextMenu:return this.contextMenu(t);case e.FEventType.Tap:return this.tap(t);case e.FEventType.DoubleTap:return this.doubleTap(t);case e.FEventType.Press:return this.press(t);case e.FEventType.PressUp:return this.pressUp(t);case e.FEventType.Swipe:return this.swipe(t);case e.FEventType.RotateStart:return this.rotateStart(t);case e.FEventType.RotateMove:return this.rotateMove(t);case e.FEventType.RotateEnd:return this.rotateEnd(t);case e.FEventType.RotateCancel:return this.rotateCancel(t);case e.FEventType.PinchStart:return this.pinchStart(t);case e.FEventType.PinchMove:return this.pinchMove(t);case e.FEventType.PinchEnd:return this.pinchEnd(t);case e.FEventType.PinchCancel:return this.pinchCancel(t);case e.FEventType.DragStart:return!!this.draggable&&this.dragStart(t);case e.FEventType.Drag:return!!this.draggable&&this.dragEvent(t);case e.FEventType.Drop:return!!this.droppable&&this.dropEvent(t);case e.FEventType.DragOver:return!!this.droppable&&this.dragOver(t);case e.FEventType.DragEnd:return!!this.draggable&&this.dragEnd(t);case e.FEventType.DragEnter:return!!this.droppable&&this.dragEnter(t);case e.FEventType.DragLeave:return!!this.droppable&&this.dragLeave(t);default:return!1}},n.prototype._transformInfo=function(e){if(e){var t=this._cfg.transform;return void 0===t?new Q:t}return this.transform},n.prototype._oldTransformInfo=function(){return this._changes.has("transform")&&this._changes.get("transform").before||new Q},n.prototype.getPCfgByCfg=function(){var e={x:this.x,y:this.y,width:this.width,height:this.height,radius:this.radius,background:this.background,foreground:this.foreground,opacity:this.opacity},t={};return Object.assign(t,this._cfg,e),t},n.prototype._compareZindex=function(e,t){var n=e._zindex-t._zindex;return 0===n?e.UID-t.UID:n},n.prototype._setProps=function(e,t){t?this._props|=1<<e:this._props&=~(1<<e)},n.prototype._getProps=function(e){return!!(this._props&1<<e)},n}(Oe);function gt(e,t,n,r,i,o,a){r<=0||o.width<=0&&a.width<=0||(o.width>r&&(o=Object.assign({},o,{width:r})),a.width>r&&(a=Object.assign({},a,{width:r})),0===o.width&&(o=Object.assign({},o,{width:a.width})),0===a.width&&(a=Object.assign({},a,{width:o.width})),e.push({cx:t,cy:n,radius:r,start:i,end:i+1/4*Math.PI,style:o}),e.push({cx:t,cy:n,radius:r,start:i+1/4*Math.PI,end:i+.5*Math.PI,style:a}))}function _t(e,t){e.beginPath(),te(e,t),e.clip()}function yt(e){if(e!=e)throw new Error("Cfg value cant be NaN")}function mt(e,t){return e?Math.max(.01,e-t):0}e.FMouseButtons=void 0,(pt=e.FMouseButtons||(e.FMouseButtons={}))[pt.None=0]="None",pt[pt.MainButton=1]="MainButton",pt[pt.Secondary=2]="Secondary",pt[pt.Auxiliary=4]="Auxiliary",pt[pt.Forth=8]="Forth",pt[pt.Fifth=16]="Fifth";var Et=function(e){function t(t,n,r,i,o,a,s,u,l,c){var h=e.call(this,t,n,r)||this;h.buttons=a,h.ctrlKey=s,h.shiftKey=u,h.altKey=l,h.metaKey=c;var d=n.mapFromGlobal(new re(i,o));return h.x=d.x,h.y=d.y,h}return y(t,e),t.prototype.globalPoint=function(){return this.target.mapToGlobal(new re(this.x,this.y))},t}(Se),bt=function(t){function n(n,r,i,o,a,s,u,l,c,h,d){var f=t.call(this,e.FEventType.MouseWheel,i,o,a,s,u,l,c,h,d)||this;return f.deltaX=n,f.deltaY=r,f.globalX=a,f.globalY=s,f.buttons=u,f.ctrlKey=l,f.shiftKey=c,f.altKey=h,f.metaKey=d,f}return y(n,t),n}(Et),Tt=function(e){function t(t,n,r,i,o,a,s,u,l,c){var h=e.call(this,t,n,r,i,o,a,s,u,l,c)||this;return h.buttons=a,h.ctrlKey=s,h.shiftKey=u,h.altKey=l,h.metaKey=c,h}return y(t,e),t}(Et),Ct=function(e){function t(t,n,r,i,o,a,s,u,l,c){var h=e.call(this,t,n,r,i,o,a,s,u,l,c)||this;return h.globalX=i,h.globalY=o,h.buttons=a,h.ctrlKey=s,h.shiftKey=u,h.altKey=l,h.metaKey=c,h}return y(t,e),t}(Et),St=function(e){function t(t,n,r,i,o,a,s,u,l,c,h,d){var f=e.call(this,t,n,r,i,o,a,s,u,l,c)||this;return f.buttons=a,f.ctrlKey=s,f.shiftKey=u,f.altKey=l,f.metaKey=c,f.dataTransfer=h,f._dragImgCanvas=d,f}return y(t,e),t.prototype.srcWidget=function(){var e="";if(null!==this.dataTransfer&&(e=this.dataTransfer.getData(L)),""!==e){var t=vt.getObjById(e);return t instanceof vt?t:null}return null},t.prototype.defautDragImageCtx=function(){return this._dragImgCanvas.ctx()},t}(Et),wt=function(e){function t(t,n,r){var i=e.call(this,t,n)||this;return i.name=r,i}return y(t,e),t}(Ce);Object.keys(e.FEventType).map((function(t){e.FEventType[t]}));var Rt=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e._filters=[],e._layoutInfo={x:0,y:0,width:0,height:0},e._internalState=null,e.initData={},e.changedListId=Number.NEGATIVE_INFINITY,e.isStatic=!1,e}return y(n,t),n.canUpdate=function(e,t){return e.type===t.type&&e.data.key===t.data.key},n.singleChildBuild=function(e,t,r){return r&&!t?e.inflateWidget(r):!r&&t?t.destroy():r&&t&&t.state?n.canUpdate(t.state,r)?(t.onStateChange(r),t.state=r,t.build()):(t.destroy(),e.inflateWidget(r)):void 0},Object.defineProperty(n.prototype,"state",{get:function(){return this._internalState},set:function(e){var t=this;null===this._internalState&&null!==e?Object.keys(this.initData).forEach((function(n){void 0===e.data[n]&&(e.data[n]=t.initData[n])})):null!==this._internalState&&null!==e&&Object.keys(this._internalState.data).forEach((function(n){void 0===e.data[n]&&(e.data[n]=t._internalState.data[n])})),this._internalState=e},enumerable:!1,configurable:!0}),n.prototype.setParent=function(e){if(t.prototype.setParent.call(this,e),e.changedListId!==Number.NEGATIVE_INFINITY){var n=e.changedListId;R(e,(function(e){return e.changedListId=n}))}},n.prototype.inflateWidget=function(e){var t=e.createWidget();return this.addChild(t),t.build(),t},n.prototype.onStateChange=function(e){},n.with=function(e){return new it(this,e)},n.prototype.isDirty=function(){return!0},n.prototype.diffState=function(e){var t=this;return null===this.state||this.state.type!==e.type||Object.keys(this.state.data).some((function(n){return t.state.data[n]!==e.data[n]}))},Object.defineProperty(n.prototype,"size",{get:function(){return{width:this._layoutInfo.width,height:this._layoutInfo.height}},set:function(e){this._layoutInfo.width=e.width,this._layoutInfo.height=e.height},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pos",{get:function(){return new re(this._layoutInfo.x,this._layoutInfo.y)},set:function(e){this._layoutInfo.x=e.x,this._layoutInfo.y=e.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"transform",{get:function(){return new Q},enumerable:!1,configurable:!0}),n.prototype.selfRect=function(){return new oe(0,0,this.size.width,this.size.height)},n.prototype.boundaryRect=function(){return new oe(this.pos.x,this.pos.y,this.size.width,this.size.height)},n.prototype.parent=function(){return t.prototype.parent.call(this)},n.prototype.mapFromParent=function(e){var t=this.transform;return t.inversePoint(e.move(-this.pos.x*t.a,-this.pos.y*t.d))},n.prototype.mapToParent=function(e){var t=this.transform;return this.transform.mapPoint(e).move(this.pos.x*t.a,this.pos.y*t.d)},n.prototype.mapFromGlobal=function(e){var t=[];return w(this,(function(e){return t.push(e),!1})),t.reverse().forEach((function(t){return t.mapFromParent(e)})),e},n.prototype.mapToGlobal=function(e){var t=[];return w(this,(function(e){return t.push(e),!1})),t.forEach((function(t){return t.mapToParent(e)})),e},n.prototype.mapTransformToParent=function(e){var t=this.transform;return e.transform(t.a,t.b,t.c,t.d,t.e,t.f),e},n.prototype.mapTransformToGlobal=function(e){var t=[];return w(this,(function(e){return t.push(e),!1})),t.forEach((function(t){return t.mapTransformToParent(e)})),e},n.prototype.layout=function(e){return this.performLayout(e),this.afterLayout(),this.size},n.prototype.performLayout=function(e){var t={width:0,height:0};return 1===this.children().length&&(t=this.children()[0].layout(e)),this.size={width:Math.max(Math.min(t.width,e.maxWidth),e.minWidth),height:Math.max(Math.min(t.height,e.maxHeight),e.minHeight)},this.size},n.prototype.afterLayout=function(){},n.prototype.updateState=function(e){var t=this;Object.keys(e).forEach((function(n){t[n]=e[n],At(t,n,e[n])}))},n.prototype.forceUpdate=function(){At(this)},n.prototype.removeFromChangedList=function(){var e=ut.get(this.changedListId);e&&e.remove({uid:this.UID})},n.prototype.build=function(){this.removeFromChangedList()},n.prototype.paintSelf=function(e,t){},n.prototype.renderTree=function(e,t){if(e.save(),this.paintSelf(e,t),this.clip&&Ee(e,this.boundaryRect()),this.children().length>0){var n=this.pos,r=n.x,i=n.y;t&&t.move(-r,-i),e.translate(r,i),this.renderChildren(e,t),e.translate(-r,-i)}e.restore()},n.prototype.renderChildren=function(e,t){var n=this.children();if(t){var r=!1;n.forEach((function(n){var i=n.boundaryRect();r||t.containRect(i)||(Ee(e,t),r=!0);var o=i.intersectRect(t);o.isEmpty()||n.renderTree(e,o)}))}else n.forEach((function(t){return t.renderTree(e)}))},n.prototype.event=function(e){var n=t.prototype.event.call(this,e);return e.defaultPrevented?e.canclePreventDefault():n=n||this._partationEvent(e),n},n.prototype.respondEvent=function(e){if(null===this.state)return!1;var t=this.ignore;return"boolean"==typeof t?!t:"object"==typeof t?-1===t.indexOf(e):t!==e},n.prototype.findWidget=function(e,t,n){e=this.mapFromParent(e.clone());for(var r=null,i=this.selfRect().containPoint(e)?this:null,o=new Set;i;)if(i!==r){r=i;for(var a=i.children(),s=a.length-1;s>=0;s--){var u=a[s];if(!o.has(u.UID)&&(void 0===u.respondEvent||void 0===t||u.respondEvent(t))){var l=u.mapFromParent(e.clone());if(u.hitTest(l,t,n)){e=u.mapFromParent(e),(i=u).skipSelfEvent&&o.add(i.UID);break}}}}else{if(!i.skipSelfEvent)break;i&&(e=i.mapToParent(e)),i=i.parent()}return i},n.prototype.findWidgetByMultiPoint=function(e,t){var n=this,r=e.map((function(e){return n.findWidget(e,t)})),i=[];return r.forEach((function(e){0===i.length?w(e,(function(e){return i.push(e),!1})):w(e,(function(e){var t=i.findIndex((function(t){return t===e}));return-1!==t&&(i=i.slice(t),!0)}))})),0===i.length?null:i.shift()},n.prototype.hitTest=function(e,t,n){return this.selfRect().containPoint(e)},n.prototype.addEventFilter=function(e){this._filters.push(e)},n.prototype.removeEventFilter=function(e){this._filters=this._filters.filter((function(t){return t!==e}))},n.prototype.eventFilters=function(){return this._filters},n.prototype.mouseDown=function(e){return!1},n.prototype.mouseMove=function(e){return!1},n.prototype.mouseUp=function(e){return!1},n.prototype.click=function(e){return!1},n.prototype.dblClick=function(e){return!1},n.prototype.mouseEnter=function(e){return!1},n.prototype.mouseLeave=function(e){return!1},n.prototype.mouseWheel=function(e){return!1},n.prototype.contextMenu=function(e){return!1},n.prototype.dragStart=function(e){var t=e.defautDragImageCtx();return t.save(),t.translate(-this.pos.x,-this.pos.y),this.paintSelf(t),t.restore(),!0},n.prototype.dragEnd=function(e){return!1},n.prototype.dragOver=function(e){return!1},n.prototype.dragEnter=function(e){return!1},n.prototype.dragLeave=function(e){return!1},n.prototype.dragEvent=function(e){return!1},n.prototype.dropEvent=function(e){return!1},n.prototype.tap=function(e){return!1},n.prototype.doubleTap=function(e){return!1},n.prototype.panStart=function(e){return!1},n.prototype.panMove=function(e){return!1},n.prototype.panEnd=function(e){return!1},n.prototype.panCancel=function(e){return!1},n.prototype.press=function(e){return!1},n.prototype.pressUp=function(e){return!1},n.prototype.swipe=function(e){return!1},n.prototype.rotateStart=function(e){return!1},n.prototype.rotateMove=function(e){return!1},n.prototype.rotateEnd=function(e){return!1},n.prototype.rotateCancel=function(e){return!1},n.prototype.pinchStart=function(e){return!1},n.prototype.pinchMove=function(e){return!1},n.prototype.pinchEnd=function(e){return!1},n.prototype.pinchCancel=function(e){return!1},n.prototype.fvgNode=function(){var e={type:"core/widget",cfg:{}},t=this.pos,n=t.x,r=t.y,i=this.size,o={x:n,y:r,width:i.width,height:i.height};if(e.cfg=o,!this.state)return e;var a=this.state.data;return void 0!==a.zindex&&(o.zindex=a.zindex),void 0!==a.ignore&&(o.ignore=a.ignore),void 0!==a.padding&&(o.padding=a.padding),void 0!==a.background&&(o.background=a.background),void 0!==a.color&&(o.background=a.color),void 0!==a.border&&(o.border=a.border),e},n.prototype._partationEvent=function(t){switch(t.type){case e.FEventType.PanStart:return this.state&&this.state.data.onPanStart?this.state.data.onPanStart(t):this.panStart(t);case e.FEventType.PanMove:return this.state&&this.state.data.onPanMove?this.state.data.onPanMove(t):this.panMove(t);case e.FEventType.PanEnd:return this.state&&this.state.data.onPanEnd?this.state.data.onPanEnd(t):this.panEnd(t);case e.FEventType.PanCancel:return this.state&&this.state.data.onPanCancel?this.state.data.onPanCancel(t):this.panCancel(t);case e.FEventType.MouseMove:return this.state&&this.state.data.onMouseMove?this.state.data.onMouseMove(t):this.mouseMove(t);case e.FEventType.MouseEnter:return this.state&&this.state.data.onMouseEnter?this.state.data.onMouseEnter(t):this.mouseEnter(t);case e.FEventType.MouseLeave:return this.state&&this.state.data.onMouseLeave?this.state.data.onMouseLeave(t):this.mouseLeave(t);case e.FEventType.MouseWheel:return this.state&&this.state.data.onMouseWheel?this.state.data.onMouseWheel(t):this.mouseWheel(t);case e.FEventType.MouseDown:return this.state&&this.state.data.onMouseDown?this.state.data.onMouseDown(t):this.mouseDown(t);case e.FEventType.MouseUp:return this.state&&this.state.data.onMouseUp?this.state.data.onMouseUp(t):this.mouseUp(t);case e.FEventType.Click:return this.state&&this.state.data.onClick?this.state.data.onClick(t):this.click(t);case e.FEventType.Dblclick:return this.state&&this.state.data.onDblclick?this.state.data.onDblclick(t):this.dblClick(t);case e.FEventType.ContextMenu:return this.state&&this.state.data.onContextMenu?this.state.data.onContextMenu(t):this.contextMenu(t);case e.FEventType.Tap:return this.state&&this.state.data.onTap?this.state.data.onTap(t):this.tap(t);case e.FEventType.DoubleTap:return this.state&&this.state.data.onDoubleTap?this.state.data.onDoubleTap(t):this.doubleTap(t);case e.FEventType.Press:return this.state&&this.state.data.onPress?this.state.data.onPress(t):this.press(t);case e.FEventType.PressUp:return this.state&&this.state.data.onPressUp?this.state.data.onPressUp(t):this.pressUp(t);case e.FEventType.Swipe:return this.state&&this.state.data.onSwipe?this.state.data.onSwipe(t):this.swipe(t);case e.FEventType.RotateStart:return this.state&&this.state.data.onRotateStart?this.state.data.onRotateStart(t):this.rotateStart(t);case e.FEventType.RotateMove:return this.state&&this.state.data.onRotateMove?this.state.data.onRotateMove(t):this.rotateMove(t);case e.FEventType.RotateEnd:return this.state&&this.state.data.onRotateEnd?this.state.data.onRotateEnd(t):this.rotateEnd(t);case e.FEventType.RotateCancel:return this.state&&this.state.data.onRotateCancel?this.state.data.onRotateCancel(t):this.rotateCancel(t);case e.FEventType.PinchStart:return this.state&&this.state.data.onPinchStart?this.state.data.onPinchStart(t):this.pinchStart(t);case e.FEventType.PinchMove:return this.state&&this.state.data.onPinchMove?this.state.data.onPinchMove(t):this.pinchMove(t);case e.FEventType.PinchEnd:return this.state&&this.state.data.onPinchEnd?this.state.data.onPinchEnd(t):this.pinchEnd(t);case e.FEventType.PinchCancel:return this.state&&this.state.data.onPinchCancel?this.state.data.onPinchCancel(t):this.pinchCancel(t);case e.FEventType.DragStart:return this.state&&this.state.data.onDragStart?this.state.data.onDragStart(t):this.dragStart(t);case e.FEventType.Drag:return this.state&&this.state.data.onDrag?this.state.data.onDrag(t):this.dragEvent(t);case e.FEventType.Drop:return this.state&&this.state.data.onDrop?this.state.data.onDrop(t):this.dropEvent(t);case e.FEventType.DragOver:return this.state&&this.state.data.onDragOver?this.state.data.onDragOver(t):this.dragOver(t);case e.FEventType.DragEnd:return this.state&&this.state.data.onDragEnd?this.state.data.onDragEnd(t):this.dragEnd(t);case e.FEventType.DragEnter:return this.state&&this.state.data.onDragEnter?this.state.data.onDragEnter(t):this.dragEnter(t);case e.FEventType.DragLeave:return this.state&&this.state.data.onDragEnd?this.state.data.onDragEnd(t):this.dragLeave(t);default:return!1}},n}(Oe);function At(e,t,n){var r;e.state&&e.state.changedHandler&&t&&n&&e.state.changedHandler(((r={})[t]=n,r));var i=ut.get(e.changedListId);i&&i.insert({uid:e.UID})}var Ot=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isStaticWidget=!1,t}return y(t,e),t.prototype.describe=function(){return null},t.prototype.build=function(){var e=this.describe(),t=this.children()[0];Rt.singleChildBuild(this,t,e),this.removeFromChangedList()},t}(Rt),Mt=function(){function t(){}return t.prototype.constructWidget=function(t){var n;if(t.type===e.WidgetType.faster){var r=document.createElement("canvas");(n=new lt(r)).resize(t.cfg.width,t.cfg.height)}else(n=new vt(null)).updateByCfg(t.cfg);return n},t}(),kt=function(){function e(){console.error("can't init it")}return e.setRecordMode=function(t){var n=t?"true":"false";localStorage.setItem(e._storeName,n),window.location.reload()},e._storeName="faster-shadow-recording",e._handleShowUp=function(t){if(null===e._recorder)throw Error("you need enableShadow");var n=76;t.ctrlKey&&t.altKey&&t.metaKey&&t.keyCode===n&&e.setRecordMode(!0)},e.enableShadow=function(t){null!==e._recorder&&document.removeEventListener("keydown",e._handleShowUp),e._recorder=t,"true"===localStorage.getItem(e._storeName)?A(__FASTER_META__.config.recorderUrl,(function(){new(0,__FASTER_META__.shelter.Record)(e._recorder);var t=document.querySelector(".faster-recorder__exit");t&&t.addEventListener("click",(function(){e.setRecordMode(!1)}))})):document.addEventListener("keydown",e._handleShowUp)},e.disableShadow=function(){e._recorder=null,document.removeEventListener("keydown",e._handleShowUp)},e}(),It=function(){function e(){}return e.tickWake=function(){0===e._cdId&&(e._cdId=Ne.addIdleListener((function(){xt.animMap.forEach((function(e){return e.tick()}))})),Ne.tickWake())},e.tickSuppend=function(){0!==e._cdId&&xt.animMap.size<=0&&(Ne.removeIdleListener(e._cdId),e._cdId=0)},e._cdId=0,e}(),xt=function(){function e(){}return e.add=function(t){if(e.animMap.has(t.wid)){var n=e.animMap.get(t.wid);n&&n.abort()}e.animMap.set(t.wid,t),It.tickWake()},e.remove=function(t){e.animMap.delete(t.wid),It.tickSuppend()},e.isAnimDuring=function(t){return e.animMap.has(t.UID)},e.animMap=new Map,e}();function Nt(e,t){return void 0===e&&(e={}),void 0===t&&(t=""),e instanceof Rt&&Pt(e,t),Pt}function Pt(e,t){var n=Object.getOwnPropertyDescriptor(e,t);n&&!1===n.configurable||Object.defineProperty(e,t,m(m({},n),{set:function(e){if(this instanceof Rt){if(this.state)return void(this.state.data[t]!==e&&(this.state.data[t]=e,At(this,t,e)));this.initData[t]=e}},get:function(){return this.state?this.state.data[t]:this.initData[t]}}))}function Lt(e){return void 0===e&&(e={}),"function"==typeof e?Dt(e):Dt}function Dt(e){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isStatic=!0,t}return y(t,e),t}(e)}var Ft=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.skipSelfEvent=!0,t}return y(t,e),t.fill=function(e){return new it(this,{singleChild:e})},t.with=function(e){return new ot(this,e)},t.prototype.performLayout=function(e){if(this.children().length>1)throw new Error("single layout only one child");return this.size},t.prototype.build=function(){if(null!==this.state&&this.state.data.singleChild){var e=this.state.data.singleChild(),t=this.children()[0];Rt.singleChildBuild(this,t,e),this.removeFromChangedList()}},E([Nt,b("design:type",Boolean)],t.prototype,"skipSelfEvent",void 0),t}(Rt),Bt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.skipSelfEvent=!0,t.beforeKeyMap=new Map,t.afterKeyMap=new Map,t.isUsingKey=!1,t.needZIndex=!1,t._hasKey=!0,t}return y(t,e),t.fill=function(e){return new it(this,{multipleChild:e})},t.with=function(e){return new at(this,e)},Object.defineProperty(t.prototype,"hasKey",{get:function(){return this._hasKey},enumerable:!1,configurable:!0}),t.prototype.performLayout=function(e){var t={width:0,height:0};if(this.size={width:Math.max(Math.min(t.width,e.maxWidth),e.minWidth),height:Math.max(Math.min(t.height,e.maxHeight),e.minHeight)},this._children&&this._children.length)for(var n=0;n<this._children.length;n++)t=this._children[0].layout(e),this.size={width:Math.max(Math.min(t.width,e.maxWidth),e.minWidth),height:Math.max(Math.min(t.height,e.maxHeight),e.minHeight)};return this.size},t.prototype.build=function(){if(null!==this.state&&void 0!==this.state.data.multipleChild){var e=this.state.data.multipleChild().filter((function(e){return null!==e}));this.buildByStates(e),this.removeFromChangedList()}},t.prototype.getChildByKey=function(e){return this.afterKeyMap.get(e)},t.prototype.buildByStates=function(e){this.sortByZIndex(e),this._hasKey=this._canUseKey(e),this._hasKey?this._buildWithKey(e):this._buildWithoutKey(e)},t.prototype._canUseKey=function(e){var t=new Set,n=e.length;if(!n)return!1;for(var r=0;r<n;r++){var i=e[r].data.key;if(void 0===i)return!1;if(t.has(i))throw new Error("[Faster Error] key in multiple layout must unique.");t.add(i)}return!0},t.prototype.sortByZIndex=function(e){return this.needZIndex&&e.sort((function(e,t){return(e.data.zindex||0)-(t.data.zindex||0)})),e},t.prototype._insertChildByState=function(e,t){var n=t.createWidget();if(n._parent=this,n.setRootId(this.rootId()),n.build(),this._children?this._children.splice(e,0,n):this._children=[n],this.changedListId!==Number.NEGATIVE_INFINITY){var r=this.changedListId;R(this,(function(e){return e.changedListId=r}))}return n},t.prototype._buildWithKey=function(e){this.isUsingKey?this.beforeKeyMap=new Map(this.afterKeyMap):(this.removeAllChild(),this.beforeKeyMap.clear()),this.afterKeyMap.clear();for(var t=e.length,n=0;n<t;){var r=e[n],i=r.data.key,o=this.beforeKeyMap.get(i);if(o){if(o.isDirty()||o.diffState(r)){var a=o.state;null===a||a.type===r.type?(o.onStateChange(r),o.state=r,o.build()):(o.destroy(),o=this.inflateWidget(r))}this.beforeKeyMap.delete(i)}else o=this.replaceChild(n,r);o&&this.afterKeyMap.set(i,o),n++}this.beforeKeyMap.forEach((function(e){return e.destroy()})),this.isUsingKey=!0},t.prototype.replaceChild=function(e,t){return this._insertChildByState(e,t)},t.prototype._buildWithoutKey=function(e){var t=this,n=this.children();if(0!==n.length){for(var r=n.length,i=e.length,o=0,a=[],s=[];o<r&&o<i;){var u=n[o],l=u.state,c=e[o];l&&l.type!==c.type?s.push(o):(u.onStateChange(c),u.state=c,u.build()),o++}for(;o<r;)a.push(n[o]),o++;for(s.length>0&&((s=s.reverse()).forEach((function(e){return n[e].destroy()})),s.forEach((function(n){return t.replaceChild(n,e[n])}))),a.length>0&&a.reverse().forEach((function(e){return e.destroy()}));o<i;)this.inflateWidget(e[o]),o++;this.isUsingKey=!1}else e.forEach((function(e){return t.inflateWidget(e)}))},E([Nt,b("design:type",Boolean)],t.prototype,"skipSelfEvent",void 0),t}(Rt),Vt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.flex=1,t}return y(t,e),t.prototype.performLayout=function(e){if(this.size={width:Ht(e.maxWidth)&&e.maxWidth===e.minWidth?e.maxWidth:0,height:Ht(e.maxHeight)&&e.maxHeight===e.minHeight?e.maxHeight:0},1===this.children().length){var t=this.children()[0];t.layout(e),this.size={width:e.hasMaxWidth()&&e.maxWidth===e.minWidth?this.size.width:t.size.width,height:e.hasMaxHeight()&&e.minHeight===e.maxHeight?this.size.height:t.size.height}}return this.size},E([Nt,b("design:type",Number)],t.prototype,"flex",void 0),t}(Ft);function Ht(e){return e!==tt}function Ut(e){return e>tt}function Zt(e){return e<tt}function Wt(e){return e instanceof Vt}function jt(e,t){return{width:Ht(t.width)?t.width:e.width,height:Ht(t.height)?t.height:e.height}}function Gt(){return{width:{sum:0,max:0},height:{sum:0,max:0}}}function zt(e,t){return{width:Math.max(Math.min(t.width,e.maxWidth),e.minWidth),height:Math.max(Math.min(t.height,e.maxHeight),e.minHeight)}}var Yt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.top=tt,t.left=tt,t.right=tt,t.bottom=tt,t.draggable=!1,t.zindex=0,t}return y(t,e),t.prototype.performLayout=function(t){if(e.prototype.performLayout.call(this,t),this.children().length){var n=this.children()[0];if(t.hasMaxHeight()&&Ht(this.top)&&Ht(this.bottom)||t.hasMaxWidth()&&Ht(this.left)&&Ht(this.right)){var r=new rt;Ht(this.top)&&(r.minHeight=r.maxHeight=t.maxHeight-this.top-this.bottom),Ht(this.left)&&(r.minWidth=r.maxWidth=t.maxWidth-this.left-this.right),n.layout(r)}else n.layout(new rt);this.size=n.size}return this.size},E([Nt,b("design:type",Number)],t.prototype,"top",void 0),E([Nt,b("design:type",Number)],t.prototype,"left",void 0),E([Nt,b("design:type",Number)],t.prototype,"right",void 0),E([Nt,b("design:type",Number)],t.prototype,"bottom",void 0),E([Nt,b("design:type",Boolean)],t.prototype,"draggable",void 0),E([Nt,b("design:type",Number)],t.prototype,"zindex",void 0),t}(Ft);function Xt(e){return e!==tt}var Kt=function(e){function t(){var t=e.call(this)||this;return t.clip=!0,t.needZIndex=!0,t}return y(t,e),t.prototype.performLayout=function(e){var t,n;this.size={width:Ht(e.maxWidth)?e.maxWidth:0,height:Ht(e.maxHeight)?e.maxHeight:0};var r=Ht(e.maxWidth)?e.maxWidth:0,i=Ht(e.maxHeight)?e.maxHeight:0;if(this.children().length>0){var o=!1;try{for(var a=T(this.children()),s=a.next();!s.done;s=a.next()){var u=s.value;if(u.layout(new rt({minHeight:0,minWidth:0,maxHeight:e.maxHeight,maxWidth:e.maxWidth})),r=Math.max(r,u.size.width),i=Math.max(i,u.size.height),u instanceof Yt){o=!0;var l=u;if(Xt(l.left)&&!Xt(l.right))l.pos=new re(l.left,l.pos.y);else if(Xt(l.right)&&!Xt(l.left))Ht(this.size.width)&&this.size.width>0?l.pos=new re(this.size.width-l.right-l.size.width,l.pos.y):l.pos=new re(0,l.pos.y);else if(Xt(l.left)||Xt(l.right)){if(Xt(l.left)&&Xt(l.right)){if(Ht(this.size.width)&&this.size.width>0){var c=this.size.width-l.right-l.left;l.size={width:c>0?c:l.size.width,height:l.size.height}}l.pos=new re(l.left,l.pos.y)}}else l.pos=new re(0,l.pos.y);r=Math.max(r,l.size.width+(Ht(l.right)?l.right:0)+(Ht(l.left)?l.left:0)),Xt(l.top)&&!Xt(l.bottom)?l.pos=new re(l.pos.x,l.top):Xt(l.bottom)&&!Xt(l.top)?Ht(this.size.height)&&this.size.height>0?l.pos=new re(l.pos.x,this.size.height-l.bottom-l.size.height):(l.pos=new re(l.pos.x,0),i=l.size.height+l.bottom):Xt(l.top)||Xt(l.bottom)?Xt(l.top)&&Xt(l.bottom)&&(Ht(this.size.height)&&this.size.height>0?(l.size={width:l.size.width,height:this.size.height-l.bottom-l.top},l.pos=new re(l.pos.x,l.top)):i=l.size.height+l.bottom+l.top):l.pos=new re(l.pos.x,0),i=Math.max(i,l.size.height+(Ht(l.top)?l.top:0)+(Ht(l.bottom)?l.bottom:0))}else!e.hasMaxWidth()&&r>this.size.width&&(this.size={width:r,height:this.size.height}),!e.hasMaxHeight()&&i>this.size.height&&(this.size={width:this.size.width,height:i});o||(this.size={width:r,height:i})}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}return this.size={width:r,height:i},this.size=zt(e,this.size),this.size},E([Nt,b("design:type",Boolean)],t.prototype,"clip",void 0),t}(Bt),qt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.width=tt,t.height=tt,t.expanded=!1,t}return y(t,e),t.prototype.performLayout=function(t){var n=this,r=n.width,i=n.height,o=n.expanded,a=t.copy();if(Zt(i)?a.minHeight=a.maxHeight=i:Ut(i)&&(a.minHeight=0,a.maxHeight=tt),Zt(r)?a.minWidth=a.maxWidth=r:Ut(r)&&(a.minWidth=0,a.maxWidth=tt),e.prototype.performLayout.call(this,a),o&&(Zt(t.maxWidth)&&!Ht(r)&&(a.minWidth=a.maxWidth=t.maxWidth),Zt(t.maxHeight)&&!Ht(i)&&(a.minHeight=a.maxHeight=t.maxHeight)),0!==this.children().length){var s=this.children()[0],u=a.copy();s.layout(u),this.size={width:s.size.width,height:s.size.height}}else this.size={width:a.hasMaxWidth()?a.maxWidth:0,height:a.hasMaxHeight()?a.maxHeight:0};return this.size=zt(a,this.size),this.size},E([Nt,b("design:type",Number)],t.prototype,"width",void 0),E([Nt,b("design:type",Number)],t.prototype,"height",void 0),E([Nt,b("design:type",Boolean)],t.prototype,"expanded",void 0),t}(Ft),$t=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.mainAxisAlignment=e.AxisAlignment.Start,n.crossAxisAlignment=e.CrossAxisAlignment.Start,n.mainAxisSize=e.MainAxisSize.Max,n.direction=e.FlexDirection.Horizontal,n}return y(n,t),n.prototype.performLayout=function(e){var t=Gt();return t=this.calcSizedAlreadyKnown(t,e),t=this.calcExpanded(t,e),this.calcChildPos(t,e),this.calcCurrentSize(t,e),this.size},E([Nt(),b("design:type",Number)],n.prototype,"mainAxisAlignment",void 0),E([Nt(),b("design:type",Number)],n.prototype,"crossAxisAlignment",void 0),E([Nt(),b("design:type",String)],n.prototype,"mainAxisSize",void 0),n}(Bt),Jt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.calcSizedAlreadyKnown=function(e,t){var n,r,i=this.children();t=t.copy({minWidth:0,minHeight:0,maxWidth:tt});try{for(var o=T(i),a=o.next();!a.done;a=o.next()){var s=a.value;Wt(s)||(s.layout(t),e.width.sum+=s.size.width,e.height.max=Math.max(s.size.height,e.height.max))}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return e},n.prototype.calcExpanded=function(t,n){var r,i,o,a,s=this.children(),u=0;n.hasMaxWidth()&&this.mainAxisSize===e.MainAxisSize.Max&&(u=n.maxWidth-t.width.sum);var l={count:0,growSize:0};try{for(var c=T(s),h=c.next();!h.done;h=c.next())Wt(p=h.value)&&(l.count+=p.flex)}catch(e){r={error:e}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}if(0===l.count)return t;l.growSize=u/l.count;try{for(var d=T(s),f=d.next();!f.done;f=d.next()){var p;if(Wt(p=f.value)){var v=p,g={width:v.flex*l.growSize,height:n.maxHeight};if(Ht(g.width)){var _=new rt({minWidth:g.width,maxWidth:g.width,minHeight:0,maxHeight:g.height});v.layout(_)}else v.layout(n.copy({maxWidth:tt,maxHeight:n.maxHeight}));t.width.sum+=v.size.width,t.height.max=Math.max(v.size.height,t.height.max)}}}catch(e){o={error:e}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(o)throw o.error}}return t},n.prototype.calcCurrentSize=function(t,n){var r={width:this.mainAxisSize===e.MainAxisSize.Max&&Ht(n.maxWidth)?n.maxWidth:t.width.sum,height:n.hasMinHeight()?n.minHeight:t.height.max};return r=zt(n,r=jt(this.size,r)),this.size=r,this.size},n.prototype.calcChildPos=function(t,n){var r,i,o=0,a=0,s=0,u=this.children().length,l=this,c=l.mainAxisAlignment,h=l.crossAxisAlignment;switch(n.hasMaxWidth()&&this.mainAxisSize===e.MainAxisSize.Max&&(s=n.maxWidth-t.width.sum),c){case e.AxisAlignment.Start:o=0;break;case e.AxisAlignment.Center:o=s/2;break;case e.AxisAlignment.End:o=s;break;case e.AxisAlignment.SpaceBetween:o=0,a=s/(u-1);break;case e.AxisAlignment.SpaceAround:o=(a=s/u)/2}var d=0;if(u)for(var f=0;f<this.children().length;f++){var p=this.children()[f];p&&(p.pos=new re(o+d,p.pos.y),d+=p.size.width,d+=a)}var v=n.copy({maxHeight:n.hasMaxHeight()?n.maxHeight:t.height.max});if(this.children().length)try{for(var g=T(this.children()),_=g.next();!_.done;_=g.next()){var y=_.value;switch(h){case e.CrossAxisAlignment.Start:y.pos=new re(y.pos.x,0);break;case e.CrossAxisAlignment.Center:y.pos=new re(y.pos.x,(v.maxHeight-y.size.height)/2);break;case e.CrossAxisAlignment.End:y.pos=new re(y.pos.x,v.maxHeight-y.size.height)}}}catch(e){r={error:e}}finally{try{_&&!_.done&&(i=g.return)&&i.call(g)}finally{if(r)throw r.error}}},n}($t),Qt=function(t){function n(){var n=t.call(this)||this;return n.direction=e.FlexDirection.Vertical,n}return y(n,t),n.prototype.calcCurrentSize=function(t,n){var r={width:n.hasMinWidth()?n.minWidth:t.width.max,height:this.mainAxisSize===e.MainAxisSize.Max&&Ht(n.maxHeight)?n.maxHeight:t.height.sum};return r=zt(n,r=jt(this.size,r)),this.size=r,this.size},n.prototype.calcSizedAlreadyKnown=function(e,t){var n,r,i=this.children();try{for(var o=T(i),a=o.next();!a.done;a=o.next()){var s=a.value;if(!Wt(s)){var u=t.copy({minWidth:0,minHeight:0,maxHeight:tt});s.layout(u),e.height.sum+=s.size.height,e.width.max=Math.max(s.size.width,e.width.max)}}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return e},n.prototype.calcMainAxisRemainingSpace=function(t,n){return n.hasMaxHeight()&&this.mainAxisSize===e.MainAxisSize.Max?n.maxHeight-t.height.sum:0},n.prototype.calcChildPos=function(t,n){var r,i,o=0,a=0,s=this.calcMainAxisRemainingSpace(t,n),u=this,l=u.mainAxisAlignment,c=u.crossAxisAlignment,h=this.children().length;switch(l){case e.AxisAlignment.Start:o=0;break;case e.AxisAlignment.Center:o=s/2;break;case e.AxisAlignment.End:o=s;break;case e.AxisAlignment.SpaceBetween:o=0,a=s/(h-1);break;case e.AxisAlignment.SpaceAround:o=(a=s/h)/2}var d=0;if(this.children().length)for(var f=0;f<this.children().length;f++){var p=this.children()[f];p&&(p.pos=new re(p.pos.x,o+d),d+=p.size.height,d+=a)}var v=n.copy({maxWidth:n.hasMaxWidth()?n.maxWidth:t.width.max});if(this.children().length)try{for(var g=T(this.children()),_=g.next();!_.done;_=g.next()){var y=_.value;switch(c){case e.CrossAxisAlignment.Start:break;case e.CrossAxisAlignment.Center:y.pos=new re((v.maxWidth-y.size.width)/2,y.pos.y);break;case e.CrossAxisAlignment.End:y.pos=new re(v.maxWidth-y.size.width,y.pos.y)}}}catch(e){r={error:e}}finally{try{_&&!_.done&&(i=g.return)&&i.call(g)}finally{if(r)throw r.error}}},n.prototype.calcExpanded=function(e,t){var n,r,i,o,a=this.children(),s={mainAxis:t.maxWidth,crossAxis:t.maxHeight};s.mainAxis=this.calcMainAxisRemainingSpace(e,t);var u={count:0,growSize:0};try{for(var l=T(a),c=l.next();!c.done;c=l.next())Wt(f=c.value)&&(u.count+=f.flex)}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}if(0===u.count)return e;u.growSize=s.mainAxis/u.count;try{for(var h=T(a),d=h.next();!d.done;d=h.next()){var f;if(Wt(f=d.value)){var p=f,v={width:this.size.width,height:p.flex*u.growSize};Ht(v.height)&&p.layout(new rt({minWidth:0,maxWidth:Math.max(v.width,e.width.max),minHeight:v.height,maxHeight:v.height})),e.height.sum+=f.size.height,e.height.max=Math.max(f.size.height,e.height.max)}}}catch(e){i={error:e}}finally{try{d&&!d.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}return e},n}($t),en=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.border={color:"black",width:1},t}return y(t,e),t.prototype.paintSelf=function(e){var t=this;ye(e,{x:this.pos.x,y:this.pos.y,width:this.size.width,height:this.size.height,border:this.border},(function(e,n){return ft(t,e,n)}))},t.prototype.performLayout=function(t){e.prototype.performLayout.call(this,t);var n=C(P(this.border,{color:"black",width:1}),4),r=n[0],i=n[1],o=n[2],a=n[3],s=r.width,u=i.width,l=o.width,c=a.width;if(this._children&&1===this._children.length){var h=this._children[0],d=new rt({maxWidth:Ht(t.maxWidth)?t.maxWidth-u-c:t.maxWidth,maxHeight:Ht(t.maxHeight)?t.maxHeight-s-l:t.maxHeight,minHeight:Ht(t.minHeight)?t.minHeight-s-l:t.minHeight,minWidth:Ht(t.minWidth)?t.minWidth-u-c:t.minWidth});h.layout(d),h.pos=new re(c,s),this.size=jt(this.size,{width:h.size.width+u+c,height:h.size.height+s+l})}return this.size=zt(t,this.size),this.size},E([Nt,b("design:type",Object)],t.prototype,"border",void 0),t}(Ft),tn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.padding=0,t}return y(t,e),t.prototype.performLayout=function(t){e.prototype.performLayout.call(this,t);var n=C(P(this.padding,0),4),r=n[0],i=n[1],o=n[2],a=n[3];if(this._children&&this._children.length){var s=this._children[0],u=new rt({maxWidth:Ht(t.maxWidth)?t.maxWidth-i-a:t.maxWidth,maxHeight:Ht(t.maxHeight)?t.maxHeight-r-o:t.maxHeight,minHeight:Ht(t.minHeight)?t.minHeight-r-o:t.minHeight,minWidth:Ht(t.minWidth)?t.minWidth-i-a:t.minWidth});s.layout(u),this.size=jt(this.size,{width:s.size.width+i+a,height:s.size.height+r+o}),s.pos=new re(a,r)}else this.size={width:i+a,height:r+o};return this.size=zt(t,this.size),this.size},E([Nt,b("design:type",Object)],t.prototype,"padding",void 0),t}(Ft),nn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return y(t,e),t.prototype.performLayout=function(t){if(e.prototype.performLayout.call(this,t),this.size={width:Ht(t.maxWidth)?t.maxWidth:0,height:Ht(t.maxHeight)?t.maxHeight:0},0!==this.children().length){var n=this.children()[0],r=new rt;n.layout(r),n.pos=new re((this.size.width-n.size.width)/2,(this.size.height-n.size.height)/2),this.size={width:t.hasMaxWidth()?t.maxWidth:n.size.width,height:t.hasMaxHeight()?t.maxHeight:n.size.height}}return this.size=zt(t,this.size),this.size},t}(Ft),rn=Math.tan(30*Math.PI/180),on=1/rn,an=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.scrollX=0,n.scrollY=0,n.scrollDirection=e.ScrollDirection.auto,n.bufferZone=100,n._minScrollX=0,n._minScrollY=0,n._maxScrollX=0,n._maxScrollY=0,n._startPanAnchor=new re(0,0),n._panDirection="x",n.animateId=0,n}return y(n,t),n.prototype.panStart=function(e){this._stopInertia();var t=this._validX(e.deltaX),n=this._validY(e.deltaY);return Math.abs(t)>=Math.abs(n)?this._panDirection="x":this._panDirection="y",this._startPanAnchor=new re(0,0),this.panMove(e)},n.prototype.panMove=function(e){var t=this._startPanAnchor,n=this._validX(t.x-e.deltaX),r=this._validY(t.y-e.deltaY),i=this,o=i.scrollX,a=i.scrollY;return("x"===this._panDirection?o<=this._minScrollX&&n<0||o>=this._maxScrollX&&n>0:a<=this._minScrollY&&r<0||a>=this._maxScrollY&&r>0)||(this._wheelStep(n,r),e.srcEventPreventDefault()),this._startPanAnchor=new re(e.deltaX,e.deltaY),!1},n.prototype.panEnd=function(e){return this._startPanAnchor=new re(0,0),!1},n.prototype.swipe=function(e){var t=this._validX(e.velocityX),n=this._validY(e.velocityY);if(0===t&&0===n)return!1;var r=Math.abs(n)/Math.abs(t);return r>on?t=0:r<rn&&(n=0),this.inertia(Date.now(),t,n),!1},n.prototype.inertia=function(e,t,n){var r=this,i=.95;this._stopInertia(),this.animateId=Ne.addIdleListener((function(){var o=Date.now(),a=o-e,s=!0,u=Math.pow(i,a/16),l=u*t,c=u*n,h=0,d=0;Math.abs(l)>.05&&(s=!1,h=(t+l)/2*a),Math.abs(c)>.05&&(s=!1,d=(n+c)/2*a),r._wheelStep(-h,-d),s?r._abortInertia():(e=o,t=l,n=c)}))},n.prototype.mouseWheel=function(e){return e.shiftKey&&e.deltaY&&(e.deltaX=e.deltaY,e.deltaY=0),this._wheelStep(e.deltaX,e.deltaY),!1},n.prototype.validateScroll=function(e,t){return[Math.max(this._minScrollX,Math.min(this._maxScrollX-this.size.width,e)),Math.max(this._minScrollY,Math.min(this._maxScrollY-this.size.height,t))]},n.prototype._wheelStep=function(e,t){var n;e=this._validX(e),t=this._validY(t);var r=this.mapToGlobal(new re(0,0)),i=this.mapToGlobal(new re(1,1));e/=Math.abs(i.x-r.x),t/=Math.abs(i.y-r.y);var o=this._wheelValidStep(e),a=this._wheelValidStep(t),s=this.scrollX+o,u=this.scrollY+a;n=C(this.validateScroll(s,u),2),this.scrollX=n[0],this.scrollY=n[1],this._isReachEdge(s,u)&&this._stopInertia()},n.prototype._stopInertia=function(){return 0!==this.animateId&&(this._abortInertia(),!0)},n.prototype._abortInertia=function(){Ne.removeIdleListener(this.animateId),this.animateId=0},n.prototype._wheelValidStep=function(e){var t=.7*this.bufferZone;return e>t?t:e<-t?-t:e},n.prototype._validX=function(t){var n=this.scrollDirection;return n!==e.ScrollDirection.none&&n!==e.ScrollDirection.y||(t=0),t},n.prototype._validY=function(t){var n=this.scrollDirection;return n!==e.ScrollDirection.none&&n!==e.ScrollDirection.x||(t=0),t},n.prototype._isReachEdge=function(e,t){var n=e!==this.scrollX,r=t!==this.scrollY;return n&&r},n}(Rt),sn=function(e){function t(){return e.call(this,document.createElement("canvas"),!1,!0)||this}return y(t,e),t.prototype.resize=function(t,n){(t>this._width||n>this._height)&&e.prototype.resize.call(this,Math.max(t,this._width),Math.max(n,this._height))},t}(ve),un=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.createSwapScreen=function(){return this._swapCount++,this._swapScreen||(this._swapScreen=new sn,this._swapScreen.ctx().setTransform(1,0,0,1,0,0),document.addEventListener("visibilitychange",this._onVisibilityChange)),this._swapScreen},n.destroySwapScreen=function(){this._swapCount--,0===this._swapCount&&this._swapScreen&&(this._swapScreen.destroy(),this._swapScreen=null,document.removeEventListener("visibilitychange",this._onVisibilityChange))},n._onVisibilityChange=function(){document.visibilityState===e.VisibilityState.Hidden?n._swapScreen&&n._swapScreen.suspend():n._swapScreen&&n._swapScreen.wakeup()},n.prototype.renderBuffer=function(e,t){var n=this;this._buffScreenReady(e),this._fixBuffer();var r=this._bufferScreen,i=r.ctx(),o=this._bufferWnd,a=this.pos,s=a.x,u=a.y,l=this,c=l.scrollX,h=l.scrollY;if(!this._bufferedArea.equal(o)){var d=o.sub(this._bufferedArea);i.save(),i.translate(c-o.x,h-o.y),this.clip=!1,d.forEach((function(e){e.move(-c,-h),n.renderChildren(i,e)})),this.clip=!0,i.restore(),this._bufferedArea=o.clone()}t||(t=this.boundaryRect());var f=t.clone().move(-s,-u);f.move(c,h).intersectRect(o);var p=this._buffMatrix();if(p){var v=f.move(-o.x,-o.y);if(p.mapRect(v).rounds(),!v.isEmpty()){var g=t.clone();ee(e).mapRect(g).rounds(),g.width=v.width,g.height=v.height,e.save(),e.setTransform(1,0,0,1,0,0),e.drawImage(r.element(),v.x,v.y,v.width,v.height,g.x,g.y,g.width,g.height),e.restore()}}},n.prototype._buffScreenReady=function(t){var r=this;if(null===this._bufferScreen){var i=lt.findFaster(this);this._bufferScreen=he.borrowCanvas(i,void 0,!1),this._bufferScreen.fakeHide(),this._bufferScreen.registerNotify((function(t){t!==e.FCanvasNotify.Suspend&&t!==e.FCanvasNotify.Wakeup||r._bufferedArea.reset()}))}this._useSwap&&null===this._swapScreen&&(this._swapScreen=n.createSwapScreen(),this._swapScreen.fakeHide()),this._bufferScreen.isSuspend()&&this._bufferScreen.wakeup(),this._useSwap&&this._swapScreen.isSuspend()&&this._swapScreen.wakeup();var o=t.getTransform();this._resizebuffScreen(o);var a=this._bufferScreen.ctx(),s=a.getTransform();s.a===o.a&&s.b===o.b&&s.c===o.c&&s.d===o.d||(this._bufferedArea.reset(),a.setTransform(o.a,o.b,o.c,o.d,s.e,s.f)),this._pickReusefulArea()},n.prototype._resizebuffScreen=function(e){var t=this._bufferScreen,n=this._bufferWnd,r=Math.round(n.width*e.a),i=Math.round(n.height*e.d);(r>t.width()||i>t.height())&&(t.resize(r,i),this._bufferedArea.reset(),this._useSwap&&this._swapScreen.resize(r,i))},n.prototype.clearRect=function(e,t,n,r,i){var o=e.fillStyle;e.beginPath(),e.rect(t,n,r,i),e.fillStyle=this.bufferBackground||"#fff",e.fill(),e.closePath(),e.fillStyle=o},n.prototype.doublicationOffScreenToBuffWnd=function(e){var t=this,n=this._bufferedArea,r=this._bufferWnd;if(n.x!==r.x||n.y!==r.y){var i=this._bufferScreen,o=i.ctx(),a=new re(e.x-n.x,e.y-n.y),s=new oe(e.x-r.x,e.y-r.y,e.width,e.height),u=o.getTransform(),l=new Q(u.a,u.b,u.c,u.d,u.e,u.f);if(l.mapPoint(a),l.mapRect(s),this._useSwap){var c=this._swapScreen.ctx();this._swapScreen.clear(),c.drawImage(i.element(),a.x,a.y,s.width,s.height,s.x,s.y,s.width,s.height),i.clear(),o.save(),o.setTransform(1,0,0,1,0,0),o.drawImage(this._swapScreen.element(),s.x,s.y,s.width,s.height,s.x,s.y,s.width,s.height),o.restore()}else o.save(),o.setTransform(1,0,0,1,0,0),o.drawImage(i.element(),a.x,a.y,s.width,s.height,s.x,s.y,s.width,s.height),new oe(0,0,i.width(),i.height()).sub(s).forEach((function(e){t.clearRect(o,e.x,n.y,e.width,e.height)})),o.restore()}},n.prototype._pickReusefulArea=function(){var e=this._bufferedArea.clone().intersectRect(this._bufferWnd);if(e.isEmpty())if(this._bufferedArea.reset(),this._useSwap)this._bufferScreen.clear();else{var t=this._bufferScreen,n=t.ctx();n.save(),n.setTransform(1,0,0,1,0,0),this.clearRect(n,0,0,t.width(),t.height()),n.restore()}else this.doublicationOffScreenToBuffWnd(e),this._bufferedArea=e},n.prototype._buffMatrix=function(){if(this._bufferScreen){var e=this._bufferScreen.ctx().getTransform();return new Q(e.a,0,0,e.d,0,0)}return null},n.prototype._fixBuffer=function(){var e=this._dirtyBuffer;if(!e.isEmpty()){var t=this._bufferWnd,n=this._bufferScreen.ctx();n.save(),n.translate(-t.x,-t.y),this._useSwap?n.clearRect(e.x,e.y,e.width,e.height):this.clearRect(n,e.x,e.y,e.width,e.height),n.translate(this.scrollX,this.scrollY),e.move(-this.scrollX,-this.scrollY),this.renderChildren(n,e),n.restore(),e.reset()}},n.prototype._letBuffWndContain=function(e){var t=new oe(Math.round(e.x),Math.round(e.y),Math.round(e.width),Math.round(e.height)),n=this._bufferWnd;if(!n.containRect(t)){var r=this._bufferZone;t.maxX>n.maxX?(n.x=t.x,n.width=t.maxX+r-t.x):t.x<n.x&&(n.x=Math.max(t.x-r,0),n.width=t.maxX+r-t.x),t.maxY>n.maxY?(n.y=t.y,n.height=t.maxY+r-t.y):t.y<n.y&&(n.y=Math.max(t.y-r,0),n.height=t.maxY+r-t.y);var i=this._buffMatrix();i&&i.roundRect(this._bufferWnd),this._bufferWnd.width=Math.round(this._bufferWnd.width),this._bufferWnd.height=Math.round(this._bufferWnd.height),this._bufferWnd.x=Math.round(this._bufferWnd.x),this._bufferWnd.y=Math.round(this._bufferWnd.y)}},n._swapScreen=null,n._swapCount=0,n}(Rt);function ln(e,t){Object.getOwnPropertyNames(t.prototype).forEach((function(n){if("constructor"!==n&&!e.prototype.hasOwnProperty(n)){var r=Object.getOwnPropertyDescriptor(t.prototype,n);r&&Object.defineProperty(e.prototype,n,r)}}))}function cn(e){return function(t){ln(t,e)}}var hn,dn=function(t){function n(){var n=t.call(this)||this;return n.scrollX=0,n.scrollY=0,n.scrollDirection=e.ScrollDirection.auto,n.skipSelfEvent=!1,n.useBuffer=!1,n.bufferBackground="#fff",n.contentPadding=0,n.onPanStart=function(e){return n.panStart(e)},n.onPanMove=function(e){return n.panMove(e)},n.onPanEnd=function(e){return n.panEnd(e)},n.onSwipe=function(e){return n.swipe(e)},n.onMouseWheel=function(e){return n.mouseWheel(e)},n.clip=!0,n._contentWidth=0,n._contentHeight=0,n._bufferedArea=new oe,n._dirtyBuffer=new oe,n._bufferScreen=null,n._swapScreen=null,n._bufferZone=100,n._bufferWnd=new oe,n._useSwap=!0,n.dirtyHandler=function(e){var t=e.uid;if(n.UID!==t){var r=Rt.getObjById(t.toString()),i=r.mapToGlobal(new re(0,0));n.mapFromGlobal(i),i.move(n.scrollX,n.scrollY);var o=new oe(i.x,i.y,r.width||r.size.width,r.height||r.size.height).intersectRect(n._bufferedArea);n._dirtyBuffer.union(o)}},n._minScrollX=0,n._minScrollY=0,n._maxScrollX=0,n._maxScrollY=0,n}return y(n,t),Object.defineProperty(n.prototype,"contentSize",{get:function(){return{width:this._contentWidth,height:this._contentHeight}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"contentRect",{get:function(){return new oe(-this.scrollX,-this.scrollY,this._contentWidth,this._contentHeight)},enumerable:!1,configurable:!0}),n.prototype.build=function(){var e;this.setupScrollableArea(),e=C(this.validateScroll(this.scrollX,this.scrollY),2),this.scrollX=e[0],this.scrollY=e[1],t.prototype.build.call(this)},n.prototype.setParent=function(e){t.prototype.setParent.call(this,e);var n=ut.get(this.changedListId);n&&n.setInsertCallback(this.dirtyHandler)},n.prototype.performLayout=function(t){var n,r,i=Ht(t.maxWidth)?t.maxWidth:0,o=Ht(t.maxHeight)?t.maxHeight:0,a=C(P(this.contentPadding,0),4),s=a[0],u=a[1],l=a[2],c=a[3];if(this.children().length>0){var h=new oe(this.scrollX,this.scrollY,i,o);this.useBuffer&&(this._letBuffWndContain(h),h=this._bufferWnd);var d=0,f=0;try{for(var p=T(this.children()),v=p.next();!v.done;v=p.next()){var g=v.value;g.pos=new re(c-this.scrollX,s-this.scrollY);var _=g;_.updateViewRect&&_.updateViewRect(h);var y=g.layout(new rt({minHeight:0,minWidth:0,maxHeight:this.scrollDirection===e.ScrollDirection.x?o:tt,maxWidth:this.scrollDirection===e.ScrollDirection.y?i:tt}));y.width>d&&(d=y.width),y.height>f&&(f=y.height)}}catch(e){n={error:e}}finally{try{v&&!v.done&&(r=p.return)&&r.call(p)}finally{if(n)throw n.error}}this._contentWidth=c+d+u,this._contentHeight=s+f+l,this.setScrollableAreaByContentSize()}return this.size={width:i,height:o},this.size},n.prototype.renderTree=function(e,n){this.useBuffer?this.renderBuffer(e,n):t.prototype.renderTree.call(this,e,n)},n.prototype.setupScrollableArea=function(){this.minScrollX&&(this._minScrollX=this.minScrollX),this.minScrollY&&(this._minScrollY=this.minScrollY),this.maxScrollX&&(this._maxScrollX=this.maxScrollX),this.maxScrollY&&(this._maxScrollY=this.maxScrollY)},n.prototype.setScrollableAreaByContentSize=function(){var e=this.contentSize,t=e.width,n=e.height;this.maxScrollX||(this._maxScrollX=t),this.maxScrollY||(this._maxScrollY=n)},E([Nt,b("design:type",Number)],n.prototype,"scrollX",void 0),E([Nt,b("design:type",Number)],n.prototype,"scrollY",void 0),E([Nt,b("design:type",Number)],n.prototype,"minScrollX",void 0),E([Nt,b("design:type",Number)],n.prototype,"minScrollY",void 0),E([Nt,b("design:type",Number)],n.prototype,"maxScrollX",void 0),E([Nt,b("design:type",Number)],n.prototype,"maxScrollY",void 0),E([Nt,b("design:type",Number)],n.prototype,"scrollDirection",void 0),E([Nt,b("design:type",Boolean)],n.prototype,"skipSelfEvent",void 0),E([Nt,b("design:type",Boolean)],n.prototype,"useBuffer",void 0),E([Nt,b("design:type",String)],n.prototype,"bufferBackground",void 0),E([Nt,b("design:type",Object)],n.prototype,"contentPadding",void 0),E([Nt,b("design:type",Function)],n.prototype,"onPanStart",void 0),E([Nt,b("design:type",Function)],n.prototype,"onPanMove",void 0),E([Nt,b("design:type",Function)],n.prototype,"onPanEnd",void 0),E([Nt,b("design:type",Function)],n.prototype,"onSwipe",void 0),E([Nt,b("design:type",Function)],n.prototype,"onMouseWheel",void 0),n=E([cn(an),cn(un),b("design:paramtypes",[])],n)}(Bt),fn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.childrenCount=0,t._viewRect=new oe,t._needBuildInLayout=!1,t}return y(t,e),t.fillEach=function(e){return new st(this,{eachChild:e})},t.with=function(e){return new st(this,e)},t.prototype.updateViewRect=function(e){this._viewRect=e},Object.defineProperty(t.prototype,"viewRect",{get:function(){return this._viewRect},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"needBuildInLayout",{get:function(){return this._needBuildInLayout},enumerable:!1,configurable:!0}),t.prototype.build=function(){this.hasFillEach()?(this.removeFromChangedList(),this._needBuildInLayout=!0):(e.prototype.build.call(this),this._needBuildInLayout=!1)},t.prototype.layout=function(t){if(this._needBuildInLayout){this.beforeBuildInLayout(t);var n=this.viewRectToChildInfos(this._viewRect);return this.buildByChildInfos(n),this.layoutByChildInfos(n,t),this.size=this.calcTotalSize(t),this.size}return e.prototype.layout.call(this,t)},t.prototype.beforeBuildInLayout=function(e){},t.prototype.hasFillEach=function(){return!(!this.state||"function"!=typeof this.state.data.eachChild)},t.prototype.buildByChildInfos=function(e){var t=this;if(null!==this.state&&void 0!==this.state.data.eachChild){var n=this.state.data.eachChild,r=[];e.forEach((function(e){var i=n(e);i&&(i.data.key=t.childInfoToKey(e),r.push(i))})),this.buildByStates(r)}},t.prototype.layoutByChildInfos=function(e,t){var n=this;e.forEach((function(e){var r=n.childInfoToKey(e),i=n.getChildByKey(r);if(i){var o=n.layoutChild(e,t),a=o.x,s=o.y,u=o.width,l=o.height;i.pos=new re(a,s),i.layout(new rt({minWidth:0,minHeight:0,maxWidth:u,maxHeight:l}))}}))},t}(Bt);e.GridArrangeDirection=void 0,(hn=e.GridArrangeDirection||(e.GridArrangeDirection={}))[hn.Horizontal=0]="Horizontal",hn[hn.Vertical=1]="Vertical";var pn=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.aspectRatio=1,n.axisDirection=e.GridArrangeDirection.Horizontal,n.axisCount=4,n}return y(n,t),n.prototype.performLayout=function(e){return this.validConstraint(e)||console.warn("[Faster Warning] Grid layout must have certain width / height."),this.size=this.layoutBaseGrid(e),this.size},n.prototype.layoutBaseGrid=function(t){switch(this.axisDirection){case e.GridArrangeDirection.Horizontal:return this.layoutHorizontal(t);case e.GridArrangeDirection.Vertical:return this.layoutVertical(t);default:return{width:t.maxWidth,height:t.maxHeight}}},n.prototype.validConstraint=function(t){switch(this.axisDirection){case e.GridArrangeDirection.Horizontal:return!!Ht(t.maxWidth);case e.GridArrangeDirection.Vertical:return!!Ht(t.maxHeight);default:return!1}},n.prototype.layoutHorizontal=function(e){var t=e.maxWidth,n=e.maxHeight,r=Math.floor(t/this.axisCount),i=Math.floor(r*this.aspectRatio),o=0,a=0,s=this.children();if(this.children().length>0)for(var u=0,l=s.length;u<l;u++){var c=s[u];o=Math.floor(u/this.axisCount),a=u%this.axisCount,c.layout(new rt({minWidth:0,minHeight:0,maxWidth:r,maxHeight:i})),c.pos=new re(a*r,o*i)}return{width:Math.min(s.length,this.axisCount)*r,height:Math.min((o+1)*i,n)}},n.prototype.layoutVertical=function(e){var t=e.maxHeight,n=e.maxWidth,r=Math.floor(t/this.axisCount),i=Math.floor(r*this.aspectRatio),o=0,a=0,s=this.children();if(this.children().length>0)for(var u=0,l=s.length;u<l;u++){var c=s[u];a=Math.floor(u/this.axisCount),o=u%this.axisCount,c.layout(new rt({minWidth:0,minHeight:0,maxWidth:i,maxHeight:r})),c.pos=new re(a*i,o*r)}return{width:Math.min((a+1)*i,n),height:Math.min(s.length,this.axisCount)*r}},E([Nt,b("design:type",Number)],n.prototype,"aspectRatio",void 0),E([Nt,b("design:type",Number)],n.prototype,"axisDirection",void 0),E([Nt,b("design:type",Number)],n.prototype,"axisCount",void 0),n}(Bt),vn=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.aspectRatio=1,n.axisDirection=e.GridArrangeDirection.Horizontal,n.axisCount=4,n.childrenCount=0,n.cellHeight=0,n.cellWidth=0,n}return y(n,t),n.prototype.performLayout=function(e){return this.validConstraint(e)||console.warn("[Faster Warning] Grid layout must have certain width / height."),this.needBuildInLayout?t.prototype.layout.call(this,e):(this.size=this.layoutBaseGrid(e),this.size)},n.prototype.viewRectToChildInfos=function(e){for(var t=new Set,n=e.x,r=e.y,i=e.width,o=e.height,a=this.measureRow(r),s=this.measureCol(n),u=this.measureRow(r+o,!0),l=this.measureCol(n+i,!0),c=a;c<u;c++)for(var h=s;h<l;h++){var d={row:c,col:h};if(t.add(d),this.getIndex(c,h)===this.childrenCount-1)return t}return t},n.prototype.childInfoToKey=function(e){return"R".concat(e.row,"C").concat(e.col)},n.prototype.layoutChild=function(e){var t=e.row,n=e.col;return new oe(this.measureX(n),this.measureY(t),this.cellWidth,this.cellHeight)},n.prototype.getIndex=function(t,n){return this.axisDirection===e.GridArrangeDirection.Horizontal?t*this.axisCount+n:n*this.axisCount+t},n.prototype.calcTotalSize=function(){return this.axisDirection===e.GridArrangeDirection.Horizontal?{width:Math.min(this.childrenCount,this.axisCount)*this.cellWidth,height:Math.ceil(this.childrenCount/this.axisCount)*this.cellHeight}:{width:Math.ceil(this.childrenCount/this.axisCount)*this.cellWidth,height:Math.min(this.childrenCount,this.axisCount)*this.cellHeight}},n.prototype.beforeBuildInLayout=function(t){this.axisDirection===e.GridArrangeDirection.Horizontal&&(this.cellWidth=Math.floor(t.maxWidth/this.axisCount),this.cellHeight=Math.floor(this.cellWidth*this.aspectRatio)),this.axisDirection===e.GridArrangeDirection.Vertical&&(this.cellHeight=Math.floor(t.maxHeight/this.axisCount),this.cellWidth=Math.floor(this.cellHeight*this.aspectRatio))},n.prototype.measureRow=function(t,n){void 0===n&&(n=!1);var r=t/this.cellHeight;return n?(r=Math.ceil(r),this.axisDirection===e.GridArrangeDirection.Vertical?Math.min(r,this.axisCount):r):Math.floor(r)},n.prototype.measureCol=function(t,n){void 0===n&&(n=!1);var r=t/this.cellWidth;return n?(r=Math.ceil(r),this.axisDirection===e.GridArrangeDirection.Horizontal?Math.min(r,this.axisCount):r):Math.floor(r)},n.prototype.measureX=function(e){return e*this.cellWidth},n.prototype.measureY=function(e){return e*this.cellHeight},E([Nt,b("design:type",Number)],n.prototype,"aspectRatio",void 0),E([Nt,b("design:type",Number)],n.prototype,"axisDirection",void 0),E([Nt,b("design:type",Number)],n.prototype,"axisCount",void 0),E([Nt,b("design:type",Number)],n.prototype,"childrenCount",void 0),n=E([cn(pn)],n)}(fn),gn="/";function _n(e,t){return"".concat(e.name).concat(gn).concat(t.UID).concat(gn).concat(t.rootId())}var yn=function(){function e(){}return e.of=function(e,t){var n=this,r=null;if(w(t,(function(t){var i=_n(e,t);return!!n._changeNotifiers.has(i)&&(r=n._changeNotifiers.get(i),!0)})),r)return r;throw Error("can't find ".concat(e.name," ChangeNotifier"))},e.create=function(t,n){var r=new t;e._changeNotifiers.set(_n(t,n),r)},e.clear=function(){this._changeNotifiers.clear()},e.clearByRootId=function(e){var t,n;if(e){var r=this._changeNotifiers;try{for(var i=T(r.keys()),o=i.next();!o.done;o=i.next()){var a=o.value;a.split(gn)[2]===(null!==e.rootId()?e.rootId().toString():"null")&&r.delete(a)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}},e._changeNotifiers=new Map,e}(),mn=function(){function e(){this._listeners=[]}return e.prototype.notifyListeners=function(){this._listeners.forEach((function(e){return e()}))},e.prototype.watch=function(e){var t=this;return this.addListener(e),function(){return t.removeListener(e)}},e.prototype.read=function(){return this},e.prototype.addListener=function(e){this._listeners.push(e)},e.prototype.removeListener=function(e){var t=this._listeners.indexOf(e);t>-1&&this._listeners.splice(t,1)},e}();e.ArrIterator=k,e.BACKGROUND=D,e.BaseGrid=pn,e.Bind=ke,e.BorderBox=en,e.CanvasReuseSwitcher=J,e.Center=nn,e.ChangeNotifier=mn,e.ChangedList=ut,e.Column=Qt,e.Constraint=rt,e.CustomEventStart=Te,e.Dispatcher=Ge,e.Expanded=Vt,e.FAnimPool=xt,e.FApp=Ne,e.FBase=Rt,e.FBaseWidget=Ot,e.FCanvas=ve,e.FCanvasPool=he,e.FChangeEvent=xe,e.FDefaultConstructor=Mt,e.FDoubleTapEvent=Fe,e.FDragEvent=St,e.FEnterEvent=Tt,e.FEvent=Ce,e.FLayerRenderEvent=wt,e.FLeaveEvent=Ct,e.FMouseEvent=Et,e.FMultiTouchEvent=He,e.FMultipleLayout=Bt,e.FMultipleLayoutState=at,e.FObj=Oe,e.FPanEvent=Be,e.FPincEvent=Ue,e.FPoint=re,e.FPressEvent=Le,e.FRect=oe,e.FRotateEvent=Ze,e.FSingleLayout=Ft,e.FSingleLayoutState=ot,e.FSingleTouchEvent=Pe,e.FSize=ie,e.FState=it,e.FSwipeEvent=Ve,e.FTapEvent=De,e.FTickEvent=Qe,e.FUIEvent=Se,e.FWheelEvent=bt,e.FWidget=vt,e.Faster=lt,e.Grid=vn,e.LifetimeEvents=be,e.ListenersControl=Ae,e.MAX_NUMBER=tt,e.Padding=tn,e.Positioned=Yt,e.Provider=yn,e.QuaterSplit=P,e.ReuseChildManager=$,e.Row=Jt,e.SCROLLBAR_BACKGROUND=Z,e.SCROLLBAR_COLOR=U,e.SCROLLBAR_THICK=W,e.SHADOW_BLUR=F,e.SHADOW_COLOR=B,e.SHADOW_OFFSET_X=V,e.SHADOW_OFFSET_Y=H,e.Scroll=dn,e.ShadowCtl=kt,e.SizedBox=qt,e.SortedArray=I,e.Stack=Kt,e.State=Nt,e.Static=Lt,e.TMatrix=Q,e.VirtualScroll=fn,e.VirtualScrollState=st,e.WIDGET_UID=L,e._paintBorders=me,e._quaterSplitRadius=_e,e.addArcToList=ge,e.clipRect=Ee,e.convertThemeColor=ft,e.dashLine=N,e.equals=x,e.filterEvent=we,e.iterWidgetTree=R,e.loadScript=A,e.markStateDirty=At,e.paintBorder=ye,e.paintRoundedRectangle=j,e.parentLoop=w,e.quaterSplitRadius=G,e.registerColorTheme=ht,e.removeColorTheme=dt,e.transformMatrix=ee,Object.defineProperty(e,"__esModule",{value:!0}),r.__USE_FASTER_VERSION__("1.6.68",i("1.6.68","core",e)),r.__USE_FASTER_VERSION__("1.6.68",i("1.6.68","config",{version:"1.6.68"}))}(t,n("vsh_11553"))},vsh_63738:function(e,t,n){!function(e,t,n){"use strict";var r=function(){function e(){}return e}(),i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var a=function(){return a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},a.apply(this,arguments)};function s(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function l(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var c,h=t.createToken({name:"SignificantNumberPlaceHolder",pattern:/#+/,label:"NumberPlaceHolder"}),d=t.createToken({name:"InsignificantNumberPlaceHolder",pattern:/[0?]+/,label:"NumberPlaceHolder"}),f=t.createToken({name:"Percent",pattern:"%"}),p=t.createToken({name:"Scientific",pattern:/E[+-]/}),v=t.createToken({name:"Comma",pattern:/,+/}),g=t.createToken({name:"Point",pattern:/\.+/}),_=t.createToken({name:"Solidus",pattern:/\//}),y=t.createToken({name:"StringTextInDigital",pattern:/[a-zA-Z\u0080-\uFFFF$\-+():^&'~{}<>= ]+/});function m(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":toString.call(e)}function E(e){var t=typeof e;return null!=e&&("object"===t||"function"===t)}function b(e){return"object"==typeof e&&null!==e}function T(e){return"number"==typeof e||b(e)&&"[object Number]"===m(e)}function C(e){return!0===e||!1===e||b(e)&&"[object Boolean]"===m(e)}function S(e){var t=typeof e;return"string"===t||null!=e&&"object"===t&&!Array.isArray(e)&&"[object String]"===m(e)}function w(e){if(!E(e))return!1;var t=m(e);return"[object Function]"===t||"[object AsyncFunction]"===t||"[object GeneratorFunction]"===t||"[object Proxy]"===t}function R(e){return T(e)&&Number.isFinite(e)}function A(e,t){return{integer:O(e,t),decimal:M(e)}}function O(e,t){for(var n=1,r=t?t.mathFunc.floor(Math.abs(e)):Math.floor(Math.abs(e));r>=10;)r/=10,n++;return n}function M(e){var t=0,n=e.toString(),r=n.search(g.PATTERN),i=n.toUpperCase().search(p.PATTERN);if(-1!==i){var o=n.substring(0,i),a=n.substring(i+1);-1!==r&&(t=o.substring(r+1).length);var s=parseFloat(a);t=Math.max(0,t-s)}else-1!==r&&(t=n.substring(r+1).length);return t}function k(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=Math.round),0===e)return 0;var r=function(e){var t=n(Math.abs(e));return e<0?-1*t:t};if(0===t)return r(e);var i="".concat(e,"e").split("e");return e=r(+"".concat(i[0],"e").concat(+i[1]+t)),i="".concat(e,"e").split("e"),+"".concat(i[0],"e").concat(+i[1]-t)}(c=e.InnerType||(e.InnerType={})).DateTime="DateTime",c.DateTimeParse="DateTimeParse",c.Fraction="Fraction",c.General="General",c.Number="Number",c.Text="Text";var I=/^(0x|0o)/i;function x(e,t){return void 0===t&&(t=!1),!(!t&&S(e)&&I.test(e.trim()))&&Number.isFinite(Number(e))&&!Number.isNaN(parseFloat(e))}function N(e,t){if(!x(e))return!1;var n=e.toString();if(/[eE]/.test(n))return!1;var r=n.replace(/^0\.?0*|\./,"");return t?r.length>15:r.length<=15}function P(e){return N(e,!0)}function L(e){return N(e,!1)}function D(e){return/e/i.test(e.toString())}function F(e,t,n){return void 0===t&&(t=15),n?n.mathFunc.toPrecision(e,t):parseFloat(e.toPrecision(t))}function B(e){var t=e.toExponential().split(/e/i);return{base:parseFloat(t[0])||0,exponent:parseFloat(t[1])||0}}function V(e){var t=B(e),n=t.base,r=t.exponent,i=n.toString().split("."),o=i[0]||"",a=i[1]||"",s="-";if(r>0){var u=a.padEnd(r,"0");o+=u.substring(0,r),a=u.substring(r)}else if(r<0){var l=void 0;a=(l=e<0?s+o.replace(s,"").padStart(1-r,"0"):o.padStart(1-r,"0")).slice(r,l.length)+a,o=l.slice(0,r)}return{integer:o,decimal:a}}function H(e,t,n){if(0===e)return e.toString();var r=e<0?"-":"";if((e=Math.abs(e))<1)e=k(e,t-2);else{var i=V(e),o=i.integer,a=i.decimal,s=n?n.mathFunc.toPrecision:function(e,t){return parseFloat(e.toPrecision(t))};e=""!==a&&o.length<=t-1?s(e,t-1):s(e,t)}var u=e.toString();if(/e/i.test(u)){var l=V(e);return o=l.integer,a=l.decimal,"".concat(r).concat(o,".").concat(a)}return"".concat(r).concat(u)}function U(e,t){var n=Z(e),r=n.integer,i=n.decimal,o=0,a=0;if(0===i)return{integer:r,numerator:0,denominator:1};for(var s=Math.max(1,Math.min(5,t)),u=Math.pow(10,s),l=0,c=1,h=1,d=1;c+d<u;){var f=l+h,p=c+d;i>f/p?(l=f,c=p):(h=f,d=p)}return h/d-i<i-l/c?(o=h,a=d):(o=l,a=c),{integer:r,numerator:o,denominator:a}}function Z(e){var t=Math.trunc(e);return{integer:t,decimal:W(t,e)?0:e>=0?e-Math.trunc(e):Math.trunc(e)-e}}function W(e,t){var n=Math.abs(e-t);return n<=Number.EPSILON||n<=Number.EPSILON*Math.min(Math.abs(e),Math.abs(t))||e===t}var j=t.createToken({name:"Underline",pattern:/_./}),G=t.createToken({name:"Asterisk",pattern:/\*./}),z=t.createToken({name:"SingleQuote",pattern:/[\\!]./}),Y=t.createToken({name:"DoubleQuote",pattern:/"[^"]*"/}),X=t.createToken({name:"NumberText",pattern:/[1-9]+/}),K=t.createToken({name:"Integer",pattern:/[1-9]\d*/}),q=t.createToken({name:"StringText",pattern:/[a-zA-Z\u0080-\uFFFF$\-+/():^&'~{}<>= ]+/}),$=t.createToken({name:"ConditionalMeta",pattern:/\[(<|>|>=|<=|<>|=)[+-]?\d*(\.\d+)?([Ee][+-]?\d+)?\]/}),J=t.createToken({name:"DBNumberMeta",pattern:/\[DBNum\d+\]/}),Q=t.createToken({name:"LocalIDMeta",pattern:/\[\$[^-]*(-.+)?\]/}),ee=t.createToken({name:"Meta",pattern:/\[[^\]]+\]/}),te=(t.createToken({name:"TextWithoutComment",pattern:/[^\[\]"\\!]+/}),[$,J,Q,ee]);function ne(e){var t=e.image;switch(e.tokenType){case G:return t.slice(1);case j:var n=" ",r=t.length-1;return n.repeat(r);case z:return t.slice(1);case Y:return t.slice(1,-1);default:return t}}var re,ie,oe,ae,se=function(){function e(e){this.tokens=e,this.tokenIndex=0,this.reset()}return Object.defineProperty(e.prototype,"currentToken",{get:function(){return this.tokens[this.tokenIndex]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentIndex",{get:function(){return this.tokenIndex},enumerable:!1,configurable:!0}),e.prototype.getTokenByOffset=function(e){return this.tokens[this.tokenIndex+e]},e.prototype.consume=function(){this.done()||this.next()},e}(),ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.reset=function(){this.tokenIndex=this.tokens.length-1},t.prototype.next=function(){this.tokenIndex--},t.prototype.done=function(){return this.tokenIndex<0},t}(se),le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.reset=function(){this.tokenIndex=0},t.prototype.next=function(){this.tokenIndex++},t.prototype.done=function(){return this.tokenIndex>=this.tokens.length},t}(se),ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.reset=function(){this.tokenIndex=0},t.prototype.next=function(){this.tokenIndex++,this.done()&&this.reset()},t.prototype.done=function(){return this.tokenIndex>=this.tokens.length},t}(se),he=[3],de=",",fe=function(){function e(e){this.digitCount=0,this.consumer=new ce(he)}return e.prototype.apply=function(e){var t=this.consumer.currentToken;return this.digitCount++,this.digitCount>t?(this.digitCount-=t,this.consumer.consume(),de+e):e},e}();function pe(e,t){var n=t.value,r=t.rules;if(T(n))return null;var i=!1;return n.includes(",")&&ve(n)&&(i=!0,n=n.replace(/,/g,"")),x(n)?{value:parseFloat(n),rules:a(a({},r),{hasGroupSeparator:i})}:null}function ve(e){return/^[+|-]?[1-9]\d{0,2}(,\d{3})*(\.\d*)?([E|e][+|-]\d+)?$/.test(e)}(function(e){e.General="General",e.Digital="Digital",e.Fraction="Fraction",e.DateTime="DateTime",e.Text="Text"})(ie||(ie={})),function(e){e.IntegerPart="IntegerPart",e.DecimalPart="DecimalPart",e.ExponentPart="ExponentPart"}(oe||(oe={})),function(e){e.Plus="Plus",e.Minus="Minus",e.None="None"}(ae||(ae={}));var ge,_e,ye=((re={})[ae.Plus]="+",re[ae.None]="",re[ae.Minus]="-",re);(function(e){e.IntegerPart="IntegerPart",e.NumeratorPart="NumeratorPart",e.DenominatorPart="DenominatorPart"})(ge||(ge={})),function(e){e.DateToken="DateToken",e.TimeToken="TimeToken",e.Day12HoursToken="Day12HoursToken"}(_e||(_e={}));var me=t.createToken({name:"YearSingleDigit",pattern:/y|Y/i,label:_e.DateToken}),Ee=t.createToken({name:"YearTwoDigit",pattern:/yy/i,label:_e.DateToken}),be=t.createToken({name:"YearFourDigit",pattern:/y{3,}/i,label:_e.DateToken}),Te=t.createToken({name:"YearLocaleSingleDigit",pattern:/g|G/i,label:_e.DateToken}),Ce=t.createToken({name:"YearLocaleAbbreviated",pattern:/gg/i,label:_e.DateToken}),Se=t.createToken({name:"YearLocaleUnabbreviated",pattern:/g{3,}/i,label:_e.DateToken}),we=t.createToken({name:"MonthOrMinutesSingleDigit",pattern:/M|m/i,label:_e.DateToken}),Re=t.createToken({name:"MonthOrMinutesTwoDigit",pattern:/mm/i,label:_e.DateToken}),Ae=t.createToken({name:"MonthAbbreviated",pattern:/mmm/i,label:_e.DateToken}),Oe=t.createToken({name:"MonthUnabbreviated",pattern:/(m{6,}|mmmm)/i,label:_e.DateToken}),Me=/^mmmmm(?!m)/,ke=t.createToken({name:"MonthJD",pattern:function(e,t){var n=e.substring(t),r=Me.exec(n);return r&&(r.input=e,r.index+=t),r},label:_e.DateToken}),Ie=t.createToken({name:"DaySingleDigit",pattern:/d|D/i,label:_e.DateToken}),xe=t.createToken({name:"DayTwoDigit",pattern:/dd/i,label:_e.DateToken}),Ne=t.createToken({name:"DayWeekDayAbbreviated",pattern:/(ddd)|(aaa)/i,label:_e.DateToken}),Pe=t.createToken({name:"DayWeekDayUnabbreviated",pattern:/(d{4,})|(a{4,})/i,label:_e.DateToken}),Le=t.createToken({name:"HoursSingleDigit",pattern:/h|H/i,label:_e.TimeToken}),De=t.createToken({name:"HoursTwoDigit",pattern:/h{2,}/i,label:_e.TimeToken}),Fe=t.createToken({name:"SecondsSingleDigit",pattern:/s|S/i,label:_e.TimeToken}),Be=t.createToken({name:"SecondsTwoDigit",pattern:/s{2,}/i,label:_e.TimeToken}),Ve=t.createToken({name:"MillisecondsSingleDigit",pattern:/\.0/,label:_e.TimeToken}),He=t.createToken({name:"MillisecondsTwoDigit",pattern:/\.00/,label:_e.TimeToken}),Ue=t.createToken({name:"MillisecondsThreeDigit",pattern:/\.000/,label:_e.TimeToken}),Ze=t.createToken({name:"AMPMTwoDigit",pattern:/((am\/pm)|(上午\/下午)|(午前\/午後))/i,label:_e.Day12HoursToken}),We=t.createToken({name:"AMPMSingleDigit",pattern:/a\/p/i,label:_e.Day12HoursToken}),je=t.createToken({name:"HoursDuration",pattern:/\[h+\]/i,label:_e.TimeToken}),Ge=t.createToken({name:"MinutesDuration",pattern:/\[m+\]/i,label:_e.TimeToken}),ze=t.createToken({name:"SecondsDuration",pattern:/\[s+\]/i,label:_e.TimeToken}),Ye=t.createToken({name:"WhiteSpace",pattern:/\s+/}),Xe=t.createToken({name:"StringTextInDatetime",pattern:/(?:(?!aaa)[abcefgi-ln-rt-xzBCEFGI-LN-RT-XZ\u0080-\uFFFF,$\-+/():^&'~{}<>=\.])+/});function Ke(e,t){return t.some((function(t){return t===e.tokenType}))}function qe(e){return Ke(e,[X,K])||$e(e)}function $e(e){return"NumberPlaceHolder"===e.tokenType.LABEL}function Je(e,t){return Array.isArray(t)?e.some((function(e){return Ke(e,t)})):e.some(t)}function Qe(e,t){var n=w(t)?t:function(e){return e.tokenType===t};return e.reduce((function(e,t){return n(t)?e+t.image:e}),"")}function et(e){var t=function(e){return Je(e,$e)};return(t(e[oe.IntegerPart])||t(e[oe.DecimalPart]))&&t(e[oe.ExponentPart])&&null!=e.exponent||null==e.exponent}function tt(e){return e.tokenType.LABEL===_e.DateToken}function nt(e){return e.tokenType.LABEL===_e.TimeToken}function rt(e){return e.tokenType.LABEL===_e.Day12HoursToken}function it(e){return Ke(e,[je,Le,De])}function ot(e){return Ke(e,[Fe,Be,Ve,He,Ue])}var at="-";function st(e,t,n){var r=t.toString(),i=r.startsWith(at);i&&(r=r.slice(1)),n.displayZeroSymbol||"0"!==r||(r="");var o=n.formatTokens,a=o.find($e),s=o.findIndex((function(e){return Ke(e,[d])})),u=new ue(r),l=new ue(o),c="",h=function(e){e&&(c=e+c)};if(n.groupSeparator){var f=new fe(e),p=h;h=function(e){c=f.apply(c),p(e)}}for(var v=function(){var e=l.currentToken,t=l.currentIndex;if($e(e)){if(!u.done()||s>=0&&t>=s){for(var n=new ue(e.image),r=function(){return!u.done()&&(!n.done()||n.done()&&a===e)},i=function(){return!n.done()&&u.done()};r();)h(u.currentToken),u.consume(),n.consume();for(;i();){switch(n.currentToken){case"0":h("0");break;case"?":h(" ");break;default:h("")}n.consume()}}}else{var o=ne(e);c=o+c}l.consume()};!l.done();)v();return i&&(c=at+c),c}function ut(e,t,n){var r=t.integerStr,i=st(e,r,{formatTokens:n[oe.IntegerPart],groupSeparator:n.groupSeparator}),o=Qe(n[oe.IntegerPart],$e);return"0"===(r=r.replace(/^-/,""))&&(r=""),!o&&Je(n[oe.DecimalPart],[g])&&(i+=r),{formattedInteger:i}}function lt(e,t,n){var r=t.precision,i=t.decimalStr,o="",a="";r>0&&(o=i);var s=Array.from(n[oe.DecimalPart]);""===i&&n.hideDecimalPoint&&!Je(s,(function(e){return!Ke(e,[g])&&!$e(e)}))&&s.shift();for(var u=new le(s),l=0;!u.done();){var c=u.currentToken;if($e(c)){var h=c.image;if(l<=o.length&&(a+=o.substring(l,Math.min(l+h.length,o.length))),l+h.length>o.length&&l<=r){var d=Math.max(o.length-l,0);a+=h.substring(d).replace(/\?/g," ").replace(/#/g,"")}l+=h.length}else a+=ne(u.currentToken);u.consume()}return{formattedDecimal:a}}function ct(e,t,n){var r=t.exponentValue,i=t.exponentSign,o="";return n.exponent&&(o=n.exponent.symbol,o+=ye[i],o+=st(e,Math.abs(r),{formatTokens:n[oe.ExponentPart]})),{formattedExponent:o}}function ht(e,t,n){var r=t.value,i=Qe(n[oe.DecimalPart],$e),o=Math.max(i.lastIndexOf("0"),i.lastIndexOf("?")),a=i.lastIndexOf("#"),s=M(r),u=0;i.length>0&&(u=s,o>=0&&(u=o+1),o<a&&(u=a<s?a+1:o<s?s:o+1));var l=k(r,u);isFinite(l)&&(r=l);var c=V(r),h=c.decimal,d=c.integer;return u>0?h.length>u&&(h=h.slice(0,u)):h="",{integerStr:d,decimalStr:h,precision:u}}function dt(e,t){return{formattedText:t.formattedInteger+t.formattedDecimal+t.formattedExponent}}function ft(e,t,n){var r=t.value,i=n.scale;return{value:r/Math.pow(1e3,i)}}function pt(e,t,n){var r=t.value,i=n.percent;if(i>0){var o=M(r)-2;return{value:k(r*Math.pow(100,i),o)}}return null}function vt(e,t){var n=t.value,r=t.rules;if(T(n)&&Number.isFinite(n)&&r.hasPercentSymbol){var i=M(n)+2;return{value:parseFloat((n/100).toFixed(i))}}return null}function gt(e,t,n){var r=t.value;if(!n.exponent)return null;var i=B(r),o=i.base,a=i.exponent;return{value:o,exponentValue:a,exponentSign:a>=0?n.exponent.sign===ae.Minus?ae.None:ae.Plus:ae.Minus}}function _t(e,t){var n,r,i=t.value,o=t.rules;if(T(i))return null;var u=e.i18n.getSupportedCurrencies(),l=!1;try{for(var c=s(u),h=c.next();!h.done;h=c.next()){var d=h.value,f=i;if(yt(e,d,i))return l=!0,(f=i.slice(d.length)).includes(d)?null:{value:f,rules:a(a({},o),{hasCurrencySymbol:l,currencySymbol:d})}}}catch(e){n={error:e}}finally{try{h&&!h.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return null}function yt(e,t,n){if(n.startsWith(t))return!0;var r=e.i18n.getCurrenciesAlias();return null!=r[t]&&n.startsWith(r[t])}function mt(e,t){var n=t.value,r=t.rules;if(T(n))return null;var i=e.i18n.getNumberFormat().percentSymbol,o=n,s=!1;return n.startsWith(i)?(o=n.slice(i.length),s=!0):n.endsWith(i)&&(o=n.slice(0,-i.length),s=!0),s&&!o.includes(i)?{value:o,rules:a(a({},r),{hasPercentSymbol:s})}:null}function Et(e,t,n){var r=t.value;return T(r)&&n.hideNegativeSign?{value:Math.abs(r)}:null}var bt,Tt={currencySymbol:"¤",currencyDecimalDigits:2,currencyDecimalSeparator:".",currencyGroupSizes:[3],currencyGroupSeparator:",",positiveSign:"+",negativeSign:"-",numberDecimalDigits:2,numberDecimalSeparator:".",numberGroupSizes:[3],numberGroupSeparator:",",percentSymbol:"%",percentDecimalDigits:2,percentDecimalSeparator:".",percentGroupSizes:[3],percentGroupSeparator:",",dbNumber:{}},Ct={monthGenitiveNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],abbreviatedMonthGenitiveNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],amDesignator:"AM",pmDesignator:"PM",dateSeparator:"/",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],shortDatePattern:"m/d/yyyy",longDatePattern:"dddd, dd MMMM yyyy",shortTimePattern:"HH:mm",longTimePattern:"HH:mm:ss",fullDateTimePattern:"dddd, dd MMMM yyyy HH:mm:ss"};!function(e){e.zh="zh",e.en="en",e.ja="ja"}(bt||(bt={}));var St,wt={id:1033,language:bt.en,NumberFormat:a(a({},Tt),{currencySymbol:"$"}),DateTimeFormat:a(a({},Ct),{shortDatePattern:"m/d/yyyy",longDatePattern:"d-mmm-yy",yearMonthPattern:"mmm-yy",monthDatePattern:"d-mmm",shortTimePattern:"h:mm AM/PM",longTimePattern:"h:mm:ss AM/PM",fullDateTimePattern:"dddd, MMMM dd, yyyy h:mm:ss AM/PM",localMonthRegExp:new RegExp("^(".concat(l(l([],u(Ct.monthNames),!1),u(Ct.abbreviatedMonthNames),!1).join("|"),")"))}),generalFormatters:{General:"General"},DefaultDateTimeFormatters:["MM/dd","MMM/dd","MMMM/dd","dd/MMM","dd/MMMM","MM-dd","MMM-dd","MMMM-dd","dd-MMM","dd-MMMM","MM/yy","MMM/yy","MMMM/yy","MM/yyyy","MMM/yyyy","MM-yy","MMM-yy","MM-yyyy","MMM-yyyy","yyyy/MM","yyyy/M","yyyy/MMM","yyyy-MM","yyyy-M","yyyy-MMM","yyyy/MM/dd","MM/dd/yy","MM/dd/yyyy","dd/MMM/yy","dd/MMMM/yy","dd/MMM/yyyy","dd/MMMM/yyyy","yyyy-MM-dd","MM-dd-yy","MM-dd-yyyy","dd-MMM-yy","dd-MMMM-yy","dd-MMM-yyyy","dd-MMMM-yyyy","HH:mm","HH:mm AM/PM","HH:mm:ss","HH:mm:ss AM/PM","HH:mm:ss","HH:mm:ss AM/PM","HH:mm:ss.000","HH:mm:ss.000 AM/PM","MM/dd HH:mm","MMM/dd HH:mm","MMMM/dd HH:mm","dd/MMM HH:mm","dd/MMMM HH:mm","MM/y HH:mm","MMM/y HH:mm","MM/yyyy HH:mm","MMM/yyyy HH:mm","MM/dd/y HH:mm","MM/dd/yyyy HH:mm","MM-dd HH:mm","MMM-dd HH:mm","MMMM-dd HH:mm","dd-MMM HH:mm","dd-MMMM HH:mm","MM-y HH:mm","MMM-y HH:mm","MM-yyyy HH:mm","MMM-yyyy HH:mm","MM-dd-y HH:mm","MM-dd-yyyy HH:mm","MM/dd HH:mm AM/PM","MMM/dd HH:mm AM/PM","MMMM/dd HH:mm AM/PM","dd/MMM HH:mm AM/PM","dd/MMMM HH:mm AM/PM","MM/y HH:mm AM/PM","MMM/y HH:mm AM/PM","MM/yyyy HH:mm AM/PM","MMM/yyyy HH:mm AM/PM","MM/dd/y HH:mm AM/PM","MM/dd/yyyy HH:mm AM/PM","MM-dd HH:mm AM/PM","MMM-dd HH:mm AM/PM","MMMM-dd HH:mm AM/PM","dd-MMM HH:mm AM/PM","dd-MMMM HH:mm AM/PM","MM-y HH:mm AM/PM","MMM-y HH:mm AM/PM","MM-yyyy HH:mm AM/PM","MMM-yyyy HH:mm AM/PM","MM-dd-y HH:mm AM/PM","MM-dd-yyyy HH:mm AM/PM","MM/dd HH:mm:ss","MMM/dd HH:mm:ss","MMMM/dd HH:mm:ss","dd/MMM HH:mm:ss","dd/MMMM HH:mm:ss","MM/y HH:mm:ss","MMM/y HH:mm:ss","MM/yyyy HH:mm:ss","MMM/yyyy HH:mm:ss","MM/dd/y HH:mm:ss","MM/dd/yyyy HH:mm:ss","dd/MMM/y HH:mm:ss","dd/MMMM/y HH:mm:ss","dd/MMM/yyyy HH:mm:ss","dd/MMMM/yyyy HH:mm:ss","yyyy/MM/dd HH:mm:ss","MM-dd HH:mm:ss","MMM-dd HH:mm:ss","MMMM-dd HH:mm:ss","dd-MMM HH:mm:ss","dd-MMMM HH:mm:ss","MM-y HH:mm:ss","MMM-y HH:mm:ss","MM-yyyy HH:mm:ss","MMM-yyyy HH:mm:ss","MM-dd-y HH:mm:ss","MM-dd-yyyy HH:mm:ss","dd-MMM-y HH:mm:ss","dd-MMMM-y HH:mm:ss","dd-MMM-yyyy HH:mm:ss","dd-MMMM-yyyy HH:mm:ss","yyyy-MM-dd HH:mm:ss","MM/dd HH:mm:ss AM/PM","MMM/dd HH:mm:ss AM/PM","MMMM/dd HH:mm:ss AM/PM","dd/MMM HH:mm:ss AM/PM","dd/MMMM HH:mm:ss AM/PM","MM/y HH:mm:ss AM/PM","MMM/y HH:mm:ss AM/PM","MM/yyyy HH:mm:ss AM/PM","MMM/yyyy HH:mm:ss AM/PM","MM/dd/y HH:mm:ss AM/PM","MM/dd/yyyy HH:mm:ss AM/PM","dd/MMM/y HH:mm:ss AM/PM","dd/MMMM/y HH:mm:ss AM/PM","dd/MMM/yyyy HH:mm:ss AM/PM","dd/MMMM/yyyy HH:mm:ss AM/PM","yyyy/MM/dd HH:mm:ss AM/PM","MM/dd/yyyy HH:mm:ss AM/PM","MM-dd HH:mm:ss AM/PM","MMM-dd HH:mm:ss AM/PM","MMMM-dd HH:mm:ss AM/PM","dd-MMM HH:mm:ss AM/PM","dd-MMMM HH:mm:ss AM/PM","MM-y HH:mm:ss AM/PM","MMM-y HH:mm:ss AM/PM","MM-yyyy HH:mm:ss AM/PM","MMM-yyyy HH:mm:ss AM/PM","MM-dd-y HH:mm:ss AM/PM","MM-dd-yyyy HH:mm:ss AM/PM","dd-MMM-y HH:mm:ss AM/PM","dd-MMMM-y HH:mm:ss AM/PM","dd-MMM-yyyy HH:mm:ss AM/PM","dd-MMMM-yyyy HH:mm:ss AM/PM","yyyy-MM-dd HH:mm:ss AM/PM","MM/dd HH:mm:ss.000","MMM/dd HH:mm:ss.000","MMMM/dd HH:mm:ss.000","dd/MMM HH:mm:ss.000","dd/MMMM HH:mm:ss.000","MM/y HH:mm:ss.000","MMM/y HH:mm:ss.000","MM/yyyy HH:mm:ss.000","MMM/yyyy HH:mm:ss.000","dd/MMM/y HH:mm","dd/MMMM/y HH:mm","dd/mmm/yyyy HH:mm","dd/MMMM/yyyy HH:mm","yyyy/MM/dd HH:mm","MM/dd/y HH:mm:ss.000","MM/dd/yyyy HH:mm:ss.000","dd/MMM/y HH:mm:ss.000","dd/MMMM/y HH:mm:ss.000","dd/MMM/yyyy HH:mm:ss.000","dd/MMMM/yyyy HH:mm:ss.000","yyyy/MM/dd HH:mm:ss.000","MM-dd HH:mm:ss.000","MMM-dd HH:mm:ss.000","MMMM-dd HH:mm:ss.000","dd-MMM HH:mm:ss.000","dd-MMMM HH:mm:ss.000","MM-y HH:mm:ss.000","MMM-y HH:mm:ss.000","MMMM-y HH:mm:ss.000","MM-yyyy HH:mm:ss.000","MMM-yyyy HH:mm:ss.000","dd-MMM-y HH:mm","dd-MMMM-y HH:mm","dd-MMM-yyyy HH:mm","dd-MMMM-yyyy HH:mm","yyyy-MM-dd HH:mm","MM-dd-y HH:mm:ss.000","MM-dd-yyyy HH:mm:ss","dd-MMM-y HH:mm:ss.000","dd-MMMM-y HH:mm:ss.000","dd-MMM-yyyy HH:mm:ss.000","dd-MMMM-yyyy HH:mm:ss.000","yyyy-MM-dd HH:mm:ss.000","MM/dd HH:mm:ss.000 AM/PM","MMM/dd HH:mm:ss.000 AM/PM","MMMM/dd HH:mm:ss.000 AM/PM","dd/MMM HH:mm:ss.000 AM/PM","dd/MMMM HH:mm:ss.000 AM/PM","MM/y HH:mm:ss.000 AM/PM","MMM/y HH:mm:ss.000 AM/PM","MM/yyyy HH:mm:ss.000 AM/PM","MMM/yyyy HH:mm:ss.000 AM/PM","dd/MMM/y HH:mm AM/PM","dd/MMMM/y HH:mm AM/PM","dd/MMMM/yyyy HH:mm AM/PM","yyyy/MM/dd HH:mm AM/PM","MM/dd/y HH:mm:ss.000 AM/PM","MM/dd/yyyy HH:mm:ss.000 AM/PM","dd/MMM/y HH:mm:ss.000 AM/PM","dd/MMMM/y HH:mm:ss.000 AM/PM","dd/MMM/yyyy HH:mm:ss.000 AM/PM","dd/MMMM/yyyy HH:mm:ss.000 AM/PM","yyyy/MM/dd HH:mm:ss.000 AM/PM","MM-dd HH:mm:ss.000 AM/PM","MMM-dd HH:mm:ss.000 AM/PM","MMMM-dd HH:mm:ss.000 AM/PM","dd-MMM HH:mm:ss.000 AM/PM","dd-MMMM HH:mm:ss.000 AM/PM","MM-y HH:mm:ss.000 AM/PM","MMM-y HH:mm:ss.000 AM/PM","MMMM-y HH:mm:ss.000 AM/PM","MM-yyyy HH:mm:ss.000 AM/PM","dd-MMM-y HH:mm AM/PM","dd-MMMM-y HH:mm AM/PM","dd-MMM-yyyy HH:mm AM/PM","dd-MMMM-yyyy HH:mm AM/PM","yyyy-MM-dd HH:mm AM/PM","MM-dd-y HH:mm:ss.000 AM/PM","MM-dd-yyyy HH:mm:ss.000 AM/PM","dd-MMM-y HH:mm:ss.000 AM/PM","dd-MMMM-y HH:mm:ss.000 AM/PM","dd-MMM-yyyy HH:mm:ss.000 AM/PM","dd-MMMM-yyyy HH:mm:ss.000 AM/PM","yyyy-MM-dd HH:mm:ss.000 AM/PM"]},Rt=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],At=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],Ot={id:2052,language:bt.zh,NumberFormat:a(a({},Tt),{currencySymbol:"¥",dbNumber:{1:{letters:["兆","千","百","十","亿","千","百","十","万","千","百","十",""],numbers:["○","一","二","三","四","五","六","七","八","九"]},2:{letters:["兆","仟","佰","拾","亿","仟","佰","拾","万","仟","佰","拾",""],numbers:["零","壹","贰","叁","肆","伍","陆","柒","捌","玖"]},3:{letters:null,numbers:["０","１","２","３","４","５","６","７","８","９"]}}}),DateTimeFormat:{dayNames:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],shortestDayNames:["日","一","二","三","四","五","六"],abbreviatedDayNames:["周日","周一","周二","周三","周四","周五","周六"],abbreviatedMonthNames:At,abbreviatedMonthGenitiveNames:At,monthNames:Rt,monthGenitiveNames:Rt,amDesignator:"上午",pmDesignator:"下午",fullDateTimePattern:"yyyy年m月d日 h:mm:ss",shortDatePattern:"yyyy/m/d",longDatePattern:"yyyy年m月d日",yearMonthPattern:"yyyy年m月",monthDatePattern:"m月d日",shortTimePattern:"h:mm",longTimePattern:"h:mm:ss",localMonthRegExp:new RegExp("^(".concat(Rt.concat(At).join("|"),")"))},generalFormatters:{General:"G/通用格式"},DefaultDateTimeFormatters:["MMMd日","yyyy年MMMd日","yyyy年MMM","yyyy/MM","yyyy/M","yyyy/MMM","yyyy-MM","yyyy-M","yyyy-MMM","hh时mm分ss秒","hh:mm 上午/下午","hh:mm:ss 上午/下午","hh:mm:ss 上午/下午","hh:mm:ss.000 上午/下午","MM/dd hh:mm 上午/下午","MMMM/dd hh:mm 上午/下午","dd/MM hh:mm 上午/下午","dd/MMMM hh:mm 上午/下午","MM-dd hh:mm 上午/下午","MMMM-dd hh:mm 上午/下午","dd-MM hh:mm 上午/下午","dd-MMMM hh:mm 上午/下午","MM/dd hh:mm:ss 上午/下午","MMMM/dd hh:mm:ss 上午/下午","dd/MM hh:mm:ss 上午/下午","dd/MMMM hh:mm:ss 上午/下午","y/MM/dd hh:mm:ss 上午/下午","dd/MMMM/y hh:mm:ss 上午/下午","dd/MMMM/yyyy hh:mm:ss 上午/下午","yyyy/MM/dd hh:mm:ss 上午/下午","MM-dd hh:mm:ss 上午/下午","MMMM-dd hh:mm:ss 上午/下午","dd-MM hh:mm:ss 上午/下午","dd-MMMM hh:mm:ss 上午/下午","y-MM-dd hh:mm:ss 上午/下午","dd-MMMM-y hh:mm:ss 上午/下午","dd-MMMM-yyyy hh:mm:ss 上午/下午","yyyy-MM-dd hh:mm:ss 上午/下午","MM/dd hh:mm:ss.000 上午/下午","MMMM/dd hh:mm:ss.000 上午/下午","dd/MM hh:mm:ss.000 上午/下午","dd/MMMM hh:mm:ss.000 上午/下午","MMMM/y hh:mm:ss.000 上午/下午","MMMM/yyyy hh:mm:ss.000 上午/下午","y/MM/dd hh:mm 上午/下午","dd/MMMM/y hh:mm 上午/下午","dd/MMMM/yyyy hh:mm 上午/下午","yyyy/MM/dd hh:mm 上午/下午","y/MM/dd hh:mm:ss.000 上午/下午","dd/MMMM/y hh:mm:ss.000 上午/下午","dd/MMMM/yyyy hh:mm:ss.000 上午/下午","yyyy/MM/dd hh:mm:ss.000 上午/下午","MM-dd hh:mm:ss.000 上午/下午","MMMM-dd hh:mm:ss.000 上午/下午","dd-MM hh:mm:ss.000 上午/下午","dd-MMMM hh:mm:ss.000 上午/下午","MMMM-y hh:mm:ss.000 上午/下午","y-MM-dd hh:mm 上午/下午","dd-MMMM-y hh:mm 上午/下午","dd-MMMM-yyyy hh:mm 上午/下午","yyyy-MM-dd hh:mm 上午/下午","dd-MMMM-y hh:mm:ss.000 上午/下午","dd-MMMM-yyyy hh:mm:ss.000 上午/下午","yyyy-MM-dd hh:mm:ss.000 上午/下午","MM/dd","MMMM/dd","dd/MM","dd/MMMM","MM-dd","MMMM-dd","dd-MM","dd-MMMM","MMMM/y","MMMM-y","y/MM/dd","yyyy/MM/dd","MM/dd/yyyy","dd/MMMM/y","dd/MM/yyyy","dd/MMMM/yyyy","y-MM-dd","yyyy-MM-dd","dd-MMMM-y","dd-MMMM-yyyy","HH:mm","HH:mm:ss","HH:mm:ss","HH:mm:ss.000","MM/dd HH:mm","MMMM/dd HH:mm","dd/MM HH:mm","dd/MMMM HH:mm","MMMM/y HH:mm","MMMM/yyyy HH:mm","MM/dd/yyyy HH:mm","MM-dd HH:mm","MMMM-dd HH:mm","dd-MM HH:mm","dd-MMMM HH:mm","MMMM-y HH:mm","MMMM-yyyy HH:mm","y/MM hh:mm AM/PM","MMMM-y hh:mm AM/PM","MM/dd HH:mm:ss","MMMM/dd HH:mm:ss","dd/MM HH:mm:ss","dd/MMMM HH:mm:ss","y/MM HH:mm:ss","y/MM/dd HH:mm:ss","dd/MMMM/y HH:mm:ss","dd/MMMM/yyyy HH:mm:ss","yyyy/MM/dd HH:mm:ss","MM-dd HH:mm:ss","MMMM-dd HH:mm:ss","dd-MM HH:mm:ss","dd-MMMM HH:mm:ss","y-MM-dd HH:mm:ss","dd-MMMM-y HH:mm:ss","dd-MMMM-yyyy HH:mm:ss","yyyy-MM-dd HH:mm:ss","MM/dd HH:mm:ss.000","MMMM/dd HH:mm:ss.000","dd/MM HH:mm:ss.000","dd/MMMM HH:mm:ss.000","MMMM/y HH:mm:ss.000","MMMM/yyyy HH:mm:ss.000","y/MM/dd HH:mm","dd/MMMM/y HH:mm","dd/MM/yyyy HH:mm","dd/MMMM/yyyy HH:mm","yyyy/MM/dd HH:mm","y/MM/dd HH:mm:ss.000","dd/MMMM/y HH:mm:ss.000","dd/MMMM/yyyy HH:mm:ss.000","yyyy/MM/dd HH:mm:ss.000","MM-dd HH:mm:ss.000","MMMM-dd HH:mm:ss.000","dd-MM HH:mm:ss.000","dd-MMMM HH:mm:ss.000","y-MM-dd HH:mm","dd-MMMM-y HH:mm","dd-MMMM-yyyy HH:mm","yyyy-MM-dd HH:mm","y-MM-dd HH:mm:ss.000","dd-MMMM-y HH:mm:ss.000","dd-MMMM-yyyy HH:mm:ss.000","yyyy-MM-dd HH:mm:ss.000"]},Mt=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],kt={id:1041,language:bt.ja,NumberFormat:a(a({},Tt),{currencySymbol:"¥",dbNumber:{1:{letters:["兆","千","百","十","亿","千","百","十","万","千","百","十",""],numbers:["〇","一","二","三","四","五","六","七","八","九"]},2:{letters:["兆","阡","百","拾","億","阡","百","拾","萬","阡","百","拾",""],numbers:["〇","壱","弐","参","四","伍","六","七","八","九"]},3:{letters:null,numbers:["０","１","２","３","４","５","６","７","８","９"]}}}),DateTimeFormat:{dayNames:["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],shortestDayNames:["日","月","火","水","木","金","土"],abbreviatedDayNames:["日","月","火","水","木","金","土"],abbreviatedMonthNames:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviatedMonthGenitiveNames:["1","2","3","4","5","6","7","8","9","10","11","12"],monthNames:Mt,monthGenitiveNames:Mt,amDesignator:"午前",pmDesignator:"午後",fullDateTimePattern:"yyyy年m月d日 h:mm:ss",shortDatePattern:"yyyy/mm/dd",longDatePattern:"yyyy年m月d日",yearMonthPattern:"yyyy年m月",monthDatePattern:"m月d日",shortTimePattern:"h:mm",longTimePattern:"h:mm:ss",localMonthRegExp:new RegExp("^(".concat(Mt.join("|"),")"))},generalFormatters:{General:"G/標準"},DefaultDateTimeFormatters:["MMMMd日","yyyy年M月d日","yyyy/MM","yyyy/M","yyyy/MMM","yyyy-MM","yyyy-M","yyyy-MMM","hh:mm 午前/午後","hh:mm:ss 午前/午後","hh:mm:ss 午前/午後","hh:mm:ss.000 午前/午後","MM/dd hh:mm 午前/午後","MMMM/dd hh:mm 午前/午後","dd/MM hh:mm 午前/午後","dd/MMMM hh:mm 午前/午後","MM-dd hh:mm 午前/午後","MMMM-dd hh:mm 午前/午後","dd-MM hh:mm 午前/午後","dd-MMMM hh:mm 午前/午後","MM/dd hh:mm:ss 午前/午後","MMMM/dd hh:mm:ss 午前/午後","dd/MM hh:mm:ss 午前/午後","dd/MMMM hh:mm:ss 午前/午後","y/MM/dd hh:mm:ss 午前/午後","dd/MMMM/y hh:mm:ss 午前/午後","dd/MMMM/yyyy hh:mm:ss 午前/午後","yyyy/MM/dd hh:mm:ss 午前/午後","MM-dd hh:mm:ss 午前/午後","MMMM-dd hh:mm:ss 午前/午後","dd-MM hh:mm:ss 午前/午後","dd-MMMM hh:mm:ss 午前/午後","y-MM-dd hh:mm:ss 午前/午後","dd-MMMM-y hh:mm:ss 午前/午後","dd-MMMM-yyyy hh:mm:ss 午前/午後","yyyy-MM-dd hh:mm:ss 午前/午後","MM/dd hh:mm:ss.000 午前/午後","MMMM/dd hh:mm:ss.000 午前/午後","dd/MM hh:mm:ss.000 午前/午後","dd/MMMM hh:mm:ss.000 午前/午後","MMMM/y hh:mm:ss.000 午前/午後","MMMM/yyyy hh:mm:ss.000 午前/午後","y/MM/dd hh:mm 午前/午後","dd/MMMM/y hh:mm 午前/午後","dd/MMMM/yyyy hh:mm 午前/午後","yyyy/MM/dd hh:mm 午前/午後","y/MM/dd hh:mm:ss.000 午前/午後","dd/MMMM/y hh:mm:ss.000 午前/午後","dd/MMMM/yyyy hh:mm:ss.000 午前/午後","yyyy/MM/dd hh:mm:ss.000 午前/午後","MM-dd hh:mm:ss.000 午前/午後","MMMM-dd hh:mm:ss.000 午前/午後","dd-MM hh:mm:ss.000 午前/午後","dd-MMMM hh:mm:ss.000 午前/午後","MMMM-y hh:mm:ss.000 午前/午後","y-MM-dd hh:mm 午前/午後","dd-MMMM-y hh:mm 午前/午後","dd-MMMM-yyyy hh:mm 午前/午後","yyyy-MM-dd hh:mm 午前/午後","dd-MMMM-y hh:mm:ss.000 午前/午後","dd-MMMM-yyyy hh:mm:ss.000 午前/午後","yyyy-MM-dd hh:mm:ss.000 午前/午後","MM/dd","MMMM/dd","dd/MM","dd/MMMM","MM-dd","MMMM-dd","dd-MM","dd-MMMM","MMMM/y","MMMM-y","y/MM/dd","yyyy/MM/dd","dd/MMMM/y","dd/MMMM/yyyy","y-MM-dd","yyyy-MM-dd","dd-MMMM-y","dd-MMMM-yyyy","HH:mm","HH:mm:ss","HH:mm:ss","HH:mm:ss.000","MM/dd HH:mm","MMMM/dd HH:mm","dd/MM HH:mm","dd/MMMM HH:mm","MMMM/y HH:mm","MMMM/yyyy HH:mm","MM-dd HH:mm","MMMM-dd HH:mm","dd-MM HH:mm","dd-MMMM HH:mm","MMMM-y HH:mm","MMMM-yyyy HH:mm","y/MM hh:mm AM/PM","MMMM-y hh:mm AM/PM","MM/dd HH:mm:ss","MMMM/dd HH:mm:ss","dd/MM HH:mm:ss","dd/MMMM HH:mm:ss","y/MM HH:mm:ss","y/MM/dd HH:mm:ss","dd/MMMM/y HH:mm:ss","dd/MMMM/yyyy HH:mm:ss","yyyy/MM/dd HH:mm:ss","MM-dd HH:mm:ss","MMMM-dd HH:mm:ss","dd-MM HH:mm:ss","dd-MMMM HH:mm:ss","y-MM-dd HH:mm:ss","dd-MMMM-y HH:mm:ss","dd-MMMM-yyyy HH:mm:ss","yyyy-MM-dd HH:mm:ss","MM/dd HH:mm:ss.000","MMMM/dd HH:mm:ss.000","dd/MM HH:mm:ss.000","dd/MMMM HH:mm:ss.000","MMMM/y HH:mm:ss.000","MMMM/yyyy HH:mm:ss.000","y/MM/dd HH:mm","dd/MMMM/y HH:mm","dd/MMMM/yyyy HH:mm","yyyy/MM/dd HH:mm","y/MM/dd HH:mm:ss.000","dd/MMMM/y HH:mm:ss.000","dd/MMMM/yyyy HH:mm:ss.000","yyyy/MM/dd HH:mm:ss.000","MM-dd HH:mm:ss.000","MMMM-dd HH:mm:ss.000","dd-MM HH:mm:ss.000","dd-MMMM HH:mm:ss.000","y-MM-dd HH:mm","dd-MMMM-y HH:mm","dd-MMMM-yyyy HH:mm","yyyy-MM-dd HH:mm","y-MM-dd HH:mm:ss.000","dd-MMMM-y HH:mm:ss.000","dd-MMMM-yyyy HH:mm:ss.000","yyyy-MM-dd HH:mm:ss.000"]},It=((St={})[bt.en]=wt,St[bt.zh]=Ot,St[bt.ja]=kt,St),xt=function(){function e(e,t,n){this.service=t,this.language=bt.en,this.currencyOptions={currencies:["$","€","¥","£","₣"],currenciesAlias:{"¥":"￥"}},this.setLanguage(e),n&&(this.currencyOptions=Object.assign(this.currencyOptions,n))}return e.prototype.setLanguage=function(e){this.language=e in It?e:bt.en,this.reset()},e.prototype.getLanguage=function(){return this.language},e.prototype.reset=function(){this.service.dispose()},e.prototype.getCultureInfo=function(e){return void 0===e&&(e=this.language),It[e]},e.prototype.getNumberFormat=function(e){return void 0===e&&(e=this.language),this.getCultureInfo(e).NumberFormat},e.prototype.getDateTimeFormat=function(e){return void 0===e&&(e=this.language),this.getCultureInfo(e).DateTimeFormat},e.prototype.getSupportedCurrencies=function(){return this.currencyOptions.currencies},e.prototype.getCurrenciesAlias=function(){return this.currencyOptions.currenciesAlias},e}(),Nt={positionTracking:"onlyOffset",skipValidations:!0},Pt=function(){function e(e){this.lexer=e,this.tokens=[],this.currentIndex=0}return Object.defineProperty(e.prototype,"currentToken",{get:function(){return this.LA(1)},enumerable:!1,configurable:!0}),e.prototype.consume=function(){this.currentIndex<this.tokens.length&&this.currentIndex++},e.prototype.LA=function(e){if(0===e)return null;e<0&&(e+=1);var t=this.currentIndex+e-1;return t<0||t>=this.tokens.length?null:this.tokens[t]},e.prototype.reset=function(){this.tokens=[],this.currentIndex=0},e.prototype.compile=function(e){this.reset();var t=this.lexer.tokenize(e);return t.errors.length||(this.tokens=t.tokens),t},e.prototype.getTokens=function(){return this.tokens},e}(),Lt=t.createToken({name:"At",pattern:/@/});function Dt(e){var n=[Q,ee,Lt,G,j,z,Y,q],r=new t.Lexer(n,Nt);return new Pt(r)}function Ft(e){var n=l(l([],u(te),!1),[h,d,v,g,f,_,p,j,G,z,Y,X,y],!1),r=new t.Lexer(n,Nt);return new Pt(r)}var Bt=t.createToken({name:"General",pattern:/General/i}),Vt=t.createToken({name:"StringTextInGeneral",pattern:/[a-zA-Z\u0080-\uFFFF$\-+/():^&'~{}<>= ]/});function Ht(e){var n=l(l([],u(te),!1),[Bt,G,j,z,Y,X,Vt],!1),r=new t.Lexer(n,Nt);return new Pt(r)}var Ut=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t}(Pt);function Zt(e){var n=l(l([],u(te),!1),[h,d,v,g,f,_,p,j,G,z,Y,K,y],!1),r=new t.Lexer(n,{positionTracking:"onlyOffset"});return new Ut(r)}function Wt(e){var n=l(l([be,Ee,me,Se,Ce,Te,ke,Oe,Ae,Re,we,Pe,Ne,xe,Ie,De,Le,Be,Fe,Ue,He,Ve,ze,Ge,je,Ze,We],u(te),!1),[j,G,z,Y,Ye,Xe],!1),r=new t.Lexer(n,Nt);return new Pt(r)}var jt=t.createToken({name:"DigitToken",pattern:/[0-9]+/}),Gt=t.createToken({name:"StringToken",pattern:/[a-z\u4e00-\u9fa5\/:-]+/i}),zt=t.createToken({name:"DateSeparator",pattern:/(-|\/)/}),Yt=t.createToken({name:"TimeSeparator",pattern:/:/});function Xt(e){return t.createToken({name:"LocalMonthToken",pattern:function(t,n){var r=t.substring(n),i=e.i18n.getDateTimeFormat().localMonthRegExp.exec(r);return i&&(i.index+=n,i.input=t),i}})}var Kt=t.createToken({name:"SpaceSeparator",pattern:/\s+/,group:t.Lexer.SKIPPED}),qt=t.createToken({name:"Milliseconds",pattern:/\.[0-9]+/});function $t(e){var n=[qt,zt,Yt,Xt(e),jt,Gt,Kt];return new Pt(new t.Lexer(n,Nt))}var Jt,Qt,en=new Map([[e.InnerType.Text,Dt],[e.InnerType.Number,Ft],[e.InnerType.General,Ht],[e.InnerType.Fraction,Zt],[e.InnerType.DateTime,Wt],[e.InnerType.DateTimeParse,$t]]);function tn(e){var t=e.compareOperand;switch(e.compareOperator){case Jt.Equal:return function(e){return e===t};case Jt.NotEqual:return function(e){return e!==t};case Jt.Less:return function(e){return e<t};case Jt.LessAndEqual:return function(e){return e<=t};case Jt.Greater:return function(e){return e>t};case Jt.GreaterAndEqual:return function(e){return e>=t}}}(function(e){e.Equal="=",e.NotEqual="<>",e.Less="<",e.Greater=">",e.LessAndEqual="<=",e.GreaterAndEqual=">="})(Jt||(Jt={})),function(e){e.FORMAT_FAILED="FORMAT_FAILED",e.ILLEGAL_FORMATTER="ILLEGAL_FORMATTER"}(Qt||(Qt={}));var nn=function(e){function t(n){var r=e.call(this,n)||this;return r.type=n,Object.setPrototypeOf(r,t.prototype),r}return o(t,e),t}(Error);function rn(e){return new nn(e)}var on=rn(Qt.ILLEGAL_FORMATTER),an=rn(Qt.FORMAT_FAILED),sn=function(){function e(e){this.lexer=e,this.state={},this.rules={},this.errors=[],this.reset()}return e.prototype.visit=function(){var e=this.lexer;for(this.reset();null!=e.currentToken;)this.visitToken(e.currentToken),e.consume();return{rules:this.rules,errors:this.errors}},e.prototype.visitToken=function(e){var t=e.tokenType,n=this["visit".concat(t.name)];try{w(n)?n.call(this,e):this.visitDefaultToken(e)}catch(e){e instanceof Error&&this.errors.push({message:e.message||"unknown error when visiting token in formatter"})}},e.prototype.visitMeta=function(){},e.prototype.visitConditionalMeta=function(e){var t=[Jt.Equal,Jt.NotEqual,Jt.Greater,Jt.GreaterAndEqual,Jt.Less,Jt.LessAndEqual],n=e.image.slice(1,-1);if(this.rules.condition)throw on;for(var r=0;r<t.length;r++)if(n.startsWith(t[r])){var i=parseFloat(n.slice(t[r].length));if(Number.isFinite(i))return void(this.rules.condition={compareOperand:i,compareOperator:t[r]})}},e.prototype.visitLocalIDMeta=function(){},e.prototype.visitDBNumberMeta=function(){},e.prototype.reset=function(){this.errors=[],this.resetState(),this.resetRules()},e}(),un=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.visitMonthOrMinutesTwoDigit=t.visitMonthOrMinutesToken,t.visitMonthOrMinutesSingleDigit=t.visitMonthOrMinutesToken,t.visitMillisecondsTwoDigit=t.visitMillisecondsToken,t.visitMillisecondsThreeDigit=t.visitMillisecondsToken,t.visitMillisecondsSingleDigit=t.visitMillisecondsToken,t}return o(t,e),t.prototype.visitMonthOrMinutesToken=function(e){this.rules.tokens.push(e),this.state.dateOrTimeTokensPos.push(this.rules.tokens.length-1),this.state.MonthOrMinuteTokensPos.push(this.state.dateOrTimeTokensPos.length-1)},t.prototype.visitMillisecondsToken=function(e){this.rules.tokens.push(e),this.rules.hasTime=!0,this.state.dateOrTimeTokensPos.push(this.rules.tokens.length-1),this.rules.hasMillisecondsToken=!0},t.prototype.resetRules=function(){this.rules={is12HoursFormat:!1,minutes:[],tokens:[],hasDate:!1,hasTime:!1,hasMillisecondsToken:!1}},t.prototype.resetState=function(){this.state={MonthOrMinuteTokensPos:[],dateOrTimeTokensPos:[]}},t.prototype.visit=function(){return e.prototype.visit.call(this),this.findMinuteToken(),{rules:this.rules,errors:this.errors}},t.prototype.visitDefaultToken=function(e){this.rules.tokens.push(e),tt(e)?(this.rules.hasDate=!0,this.state.dateOrTimeTokensPos.push(this.rules.tokens.length-1)):nt(e)&&(this.rules.hasTime=!0,this.state.dateOrTimeTokensPos.push(this.rules.tokens.length-1)),rt(e)&&(this.rules.is12HoursFormat=!0)},t.prototype.findMinuteToken=function(){var e=this;this.state.MonthOrMinuteTokensPos.forEach((function(t){var n=e.rules.tokens[e.state.dateOrTimeTokensPos[t-1]],r=e.rules.tokens[e.state.dateOrTimeTokensPos[t+1]];n&&it(n)||r&&ot(r)?(e.rules.minutes.push(e.state.dateOrTimeTokensPos[t]),e.rules.hasTime=!0):e.rules.hasDate=!0}))},t}(sn),ln=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.resetRules=function(){var e;this.rules=((e={})[ge.IntegerPart]=[],e[ge.NumeratorPart]=[],e[ge.DenominatorPart]=[],e)},t.prototype.resetState=function(){this.state={currentPart:ge.IntegerPart}},t.prototype.visitComma=function(){},t.prototype.visitPercent=function(){},t.prototype.visitMeta=function(){},t.prototype.visitDefaultToken=function(e){this.addTokenToCurrentPart(e)},t.prototype.addTokenToCurrentPart=function(e){var t=this;t.rules[t.state.currentPart].push(e)},t.prototype.visit=function(){if(this.reset(),this.validateTokens(),this.errors.length)return{rules:this.rules,errors:this.errors};var e=this,t=e.lexer,n=e.state,r=e.rules,i=t.getTokens(),o=i.findIndex((function(e){return Ke(e,[_])})),a=o-1,s=!0;for(n.currentPart=ge.NumeratorPart;a>=0;)if($e(i[a])){if(!s)break;for(s=!1;i[a]&&$e(i[a]);)this.visitToken(i[a]),a--}else this.visitToken(i[a]),a--;r[ge.NumeratorPart]=r[ge.NumeratorPart].reverse(),n.currentPart=ge.IntegerPart;for(var u=0;u<=a;u++)this.visitToken(i[u]);n.currentPart=ge.DenominatorPart;for(var l=o+1;l<i.length;l++)this.visitToken(i[l]);return this.validateRules(),{rules:this.rules,errors:this.errors}},t.prototype.validateTokens=function(){var e,t,n=this.lexer.getTokens(),r=[cn,hn];try{for(var i=s(r),o=i.next();!o.done;o=i.next())if((0,o.value)(n))return void this.errors.push({message:"Failed to parse format"})}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},t.prototype.validateRules=function(){var e=this.rules;if(Je(e[ge.NumeratorPart],$e)&&Je(e[ge.DenominatorPart],qe)){var t=e[ge.DenominatorPart][0];t.tokenType!==X||x(t.image)||this.errors.push({message:"Failed to parse format"})}else this.errors.push({message:"Failed to parse format"})},t}(sn);function cn(e){var t,n,r=0;try{for(var i=s(e),o=i.next();!o.done;o=i.next())if(o.value.tokenType===_&&++r>1)return!0}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return 1!==r}function hn(e){return Je(e,[p,g])}var dn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.resetState=function(){this.state={}},t.prototype.resetRules=function(){this.rules={format:[]}},t.prototype.visitDefaultToken=function(e){this.rules.format.push(e)},t}(sn),fn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.resetRules=function(){var e;this.rules=((e={scale:0,percent:0,groupSeparator:!1})[oe.IntegerPart]=[],e[oe.DecimalPart]=[],e[oe.ExponentPart]=[],e)},t.prototype.resetState=function(){this.state={currentPart:oe.IntegerPart}},t.prototype.visitNumberPlaceHolder=function(e){var t=this.state;t.currentPart===oe.ExponentPart&&t.decimalPoint===oe.ExponentPart||this.addTokenToCurrentPart(e)},t.prototype.visitInsignificantNumberPlaceHolder=function(e){return this.visitNumberPlaceHolder(e)},t.prototype.visitSignificantNumberPlaceHolder=function(e){return this.visitNumberPlaceHolder(e)},t.prototype.visitPoint=function(e){var t=this.state;t.decimalPoint=t.currentPart,t.currentPart===oe.IntegerPart&&(t.currentPart=oe.DecimalPart),this.addTokenToCurrentPart(e)},t.prototype.visitComma=function(){var e=this,t=e.rules,n=e.state,r=e.lexer,i=r.LA(2),o=r.LA(-1),a=r.currentToken;i&&o&&qe(i)&&qe(o)&&n.currentPart===oe.IntegerPart&&(t.groupSeparator=!0),a&&o&&qe(o)&&(!i||i&&!qe(i))&&(t.scale+=a.image.length)},t.prototype.visitPercent=function(e){var t=this.rules;0===t.percent&&(t.percent+=1,this.addTokenToCurrentPart(e))},t.prototype.visitScientific=function(e){var t=this,n=t.state,r=t.rules;if(n.currentPart!==oe.ExponentPart&&(n.currentPart=oe.ExponentPart,null==r.exponent)){var i=e.image;r.exponent={symbol:i[0],sign:"-"===i[1]?ae.Minus:ae.Plus}}},t.prototype.visitDefaultToken=function(e){this.addTokenToCurrentPart(e)},t.prototype.addTokenToCurrentPart=function(e){var t=this;t.rules[t.state.currentPart].push(e)},t.prototype.visit=function(){return e.prototype.visit.call(this),this.afterCompile(),this.validateRules(),{rules:this.rules,errors:this.errors}},t.prototype.validateRules=function(){et(this.rules)||this.errors.push({message:"Failed to parse exponent"})},t.prototype.afterCompile=function(){var e=this.rules;null!=e.exponent&&(e.scale=0,e.percent=0),e[oe.IntegerPart]=e[oe.IntegerPart].filter((function(e){return e.tokenType!==v}))},t}(sn),pn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.resetState=function(){this.state={}},t.prototype.resetRules=function(){this.rules={format:[]}},t.prototype.visitDefaultToken=function(e){this.rules.format.push(e)},t}(sn),vn=new Map([[e.InnerType.Text,pn],[e.InnerType.Number,fn],[e.InnerType.General,dn],[e.InnerType.DateTime,un],[e.InnerType.Fraction,ln]]),gn=function(){function e(e,t,n){void 0===e&&(e=bt.en),this.mathFunc={floor:Math.floor,ceil:Math.ceil,round:Math.round,toPrecision:function(e,t){return void 0===t&&(t=15),parseFloat(e.toPrecision(t))}},this.dateTimeCodeTokenMap=null,this.lexers=new Map,this.visitors=new Map,this.formatCodeToFormatterCache=new Map,this.formattedTextCache=new Map,this.preferredFormatterCache=new Map,this.i18n=t?t(e,this):new xt(e,this),n&&Object.assign(this.mathFunc,n)}return e.prototype.getVisitor=function(e){if(!this.visitors.has(e)){var t=this.getLexer(e),n=vn.get(e);if(!t)throw Error("Can not find ".concat(e," lexer."));if(!n)throw Error("Can not find ".concat(e," visitor."));this.visitors.set(e,new n(t))}return this.visitors.get(e)},e.prototype.getLexer=function(e){if(!this.lexers.has(e)){var t=en.get(e);if(!t)throw Error("Lexer type not found.");this.lexers.set(e,t(this))}return this.lexers.get(e)},e.prototype.getFormatter=function(e){null==e&&(e=ie.General);var t=this.formatCodeToFormatterCache.get(e);return t||(t=new qr(e,this),this.formatCodeToFormatterCache.set(e,t)),t},e.prototype.getFormattedText=function(e,t){var n=this.formattedTextCache.get(e);null==n&&(n=new Map,this.formattedTextCache.set(e,n));var r=n.get(t);return null==r&&(r=e.formatWithoutCache(t,this),n.set(t,r)),r},e.prototype.getFormatterResultCache=function(e,t){var n=this.preferredFormatterCache.get(e);return null==n?null:n.get(t)||null},e.prototype.setFormatterResultCache=function(e,t,n){var r=this.preferredFormatterCache.get(e);null==r&&(r=new Map,this.preferredFormatterCache.set(e,r)),r.set(t,n)},e.prototype.dispose=function(){this.formatCodeToFormatterCache.clear(),this.formattedTextCache.clear(),this.preferredFormatterCache.clear()},e}(),_n=function(e){function t(t,n){void 0===n&&(n=new gn);var r=e.call(this)||this;return r.service=n,r.formatRules={},r.conditions=[],r.formatCode=t,r}return o(t,e),t.prototype.getCustomCondition=function(){return this.formatRules.condition},t.prototype.addCondition=function(e){this.conditions.push(e)},t.prototype.removeCondition=function(e){var t=this.conditions.indexOf(e);t>=0&&this.conditions.splice(t,1)},t.prototype.removeConditions=function(){this.conditions=[]},t.prototype.isMeetConditions=function(e){return this.conditions.every((function(t){return t(e)}))},t.prototype.getService=function(){return this.service},t.prototype.getFormatCode=function(){return this.formatCode},t.prototype.setFormatRules=function(e){Object.assign(this.formatRules,e)},t.prototype.getFormatRules=function(){return this.formatRules},t.prototype.format=function(e){var t={value:e};return yn(this.service,this.applyRuleFns,t,this.formatRules),t.formattedText||""},t}(r);function yn(e,t,n,r){t.forEach((function(t){var i=t(e,n,r);i&&Object.assign(n,i)}))}var mn={General:"General",Text:"@",Currency:function(e,t){var n=t?".00":"";return"".concat(e,"#,##0").concat(n,";[Red](").concat(e,"#,##0").concat(n,")")},Percent:function(e,t){return"0".concat(t?".00":"").concat(e)},GroupSeparator:function(e){return"#,##0".concat(e?".00":"")},DateTime:function(e,t,n){return void 0===n&&(n="/"),(t?"yyyy".concat(n,"M").concat(n,"d"):"")+(e?"H:mm:ss":"")},ScientificNotation:"0.00E+00"};function En(e,t){var n=t.value,r=t.rules;if(T(n))return null;var i=!1,o=n;return n.startsWith("(")&&n.endsWith(")")&&(i=!0,o=n.substring(1,n.length-1).trim()),i?/[()]/.test(o)||o.startsWith("-")?null:{value:o,rules:a(a({},r),{hasParentheses:i})}:null}function bn(e,t){var n=t.value,r=t.rules;return T(n)&&Number.isFinite(n)&&r.hasParentheses?{value:-1*Math.abs(n)}:null}var Tn,Cn,Sn=function(t){function n(n,r){void 0===r&&(r=new gn);var i=t.call(this,n,r)||this;if(i.service=r,i.type=ie.Digital,r.getLexer(e.InnerType.Number).compile(n).errors.length)throw on;var o=r.getVisitor(e.InnerType.Number).visit(),a=o.rules;if(o.errors.length)throw on;return i.formatRules=a,i}return o(n,t),Object.defineProperty(n.prototype,"applyRuleFns",{get:function(){return n.applyRuleFns},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"unapplyRuleFns",{get:function(){return n.unapplyRuleFns},enumerable:!1,configurable:!0}),n.prototype.isMeetConditions=function(e){return!!R(e)&&t.prototype.isMeetConditions.call(this,e)},n.prototype.format=function(e){var n=this.formatRules;return n[oe.IntegerPart].length||n[oe.DecimalPart].length?t.prototype.format.call(this,e):""},n.prototype.parse=function(e){return n.parse(this.service,e)},n.parse=function(e,t){if(!t||P(t))return null;var r={value:t.trim(),rules:{}};return yn(e,n.unapplyRuleFns,r,{}),T(r.value)&&Number.isFinite(r.value)?{value:r.value,rules:r.rules}:null},n.getPreferredFormatterAfterParse=function(e,t,n){var r=n.value,i=n.rules,o=e.i18n.getNumberFormat(),a=o.percentSymbol,s=o.numberDecimalSeparator,u=t.includes(s);return i.hasCurrencySymbol&&null!=i.currencySymbol?{value:r,formatter:$r(e,mn.Currency(i.currencySymbol,u))}:/e/i.test(t)?{value:r,formatter:$r(e,mn.ScientificNotation)}:i.hasPercentSymbol?{value:r,formatter:$r(e,mn.Percent(a,u))}:i.hasGroupSeparator?{value:r,formatter:$r(e,mn.GroupSeparator(u))}:{value:r,formatter:$r(e)}},n.getPreferredFormatter=function(e,t){var r=n.parse(e,t);return null==r?null:n.getPreferredFormatterAfterParse(e,t,r)},n.prototype.getEditingText=function(e){if(T(e)){if(!Number.isFinite(e))return e.toString();if(this.formatRules.percent>0){var t=pt(this.service,{value:e},this.formatRules).value;return Number.isFinite(t)?"".concat(t,"%"):e.toString()}return e.toString().toUpperCase()}return null},n.prototype.getPreferredFormatter=function(e){var t=n.parse(this.service,e);if(!t)return null;var r=t.value,i=t.rules;if(i.hasPercentSymbol&&!this.formatRules.percent){var o=this.service.i18n.getNumberFormat(),a=o.percentSymbol,s=o.numberDecimalSeparator,u=e.includes(s);return{value:r,formatter:$r(this.service,mn.Percent(a,u))}}return!i.hasPercentSymbol&&this.formatRules.percent&&T(r)?n.getPreferredFormatterAfterParse(this.service,e,t):{value:r,formatter:null}},n.applyRuleFns=[Et,ft,pt,gt,ht,ut,lt,ct,dt],n.unapplyRuleFns=[En,_t,mt,pe,vt,bn],n}(_n);function wn(e,t){return Tn||(Tn=new Sn("0.#####E+00")).setFormatRules({hideDecimalPoint:!0}),Tn.format(t)}function Rn(e,t){return Math.abs(e)>=1e15||Math.abs(e)<1e15&&Math.abs(e)>=1e11&&(t?t.mathFunc.floor(e)!==e:Math.floor(e)!==e)||0!==e&&Math.abs(e)<1e-9}function An(e,t){var n=t.value;return T(n)?Number.isFinite(n)?Rn(n,e)?{formattedText:wn(e,n)}:Math.abs(n)>=1e11?{formattedText:V(n).integer.toString()}:{formattedText:H(n,11,e)}:{formattedText:n.toString()}:null}function On(e,t){var n=t.value;return S(n)?{formattedText:n}:null}function Mn(e,t){var n=t.value;return C(n)?{formattedText:n.toString().toUpperCase()}:null}function kn(e,t,n){var r,i,o=t.formattedText,a=void 0===o?"":o,u=t.value,l=n.format;if(!T(u))return null;var c="";try{for(var h=s(l),d=h.next();!d.done;d=h.next()){var f=d.value;f.tokenType===Bt?c+=a:c+=ne(f)}}catch(e){r={error:e}}finally{try{d&&!d.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}return{formattedText:c}}function In(e,t){var r=n.SheetDate.fromNumber(e);return!t.hasMillisecondsToken&&r.milliseconds>=500&&r.setDateTime({seconds:r.seconds+1}),r}function xn(e,t,n){var r=In(t.value,n),i=r.year,o=r.month,a=r.date,s=r.day,u=r.hours,l=r.minutes,c=r.seconds,h=r.milliseconds,d=r.toNumber(),f=24*e.mathFunc.floor(d)+u,p=60*f+l,v=60*p+c,g=e.i18n.getDateTimeFormat();return{formattedText:n.tokens.map((function(t,r){switch(t.tokenType){case be:return i.toString();case me:case Ee:return(i%100).toString().padStart(Nn(t.image,"y"),"0");case we:return-1===n.minutes.indexOf(r)?o.toString():l.toString();case Re:return(-1===n.minutes.indexOf(r)?o.toString():l.toString()).padStart(2,"0");case Ae:return g.abbreviatedMonthNames[o-1];case Oe:return g.monthNames[o-1];case ke:return g.monthNames[o-1][0];case Ie:return a.toString();case xe:return a.toString().padStart(2,"0");case Ne:return g.abbreviatedDayNames[s];case Pe:return g.dayNames[s];case Le:case De:return(n.is12HoursFormat?u%12||12:u).toString().padStart(Nn(t.image,"h"),"0");case Fe:return c.toString();case Be:return c.toString().padStart(2,"0");case Ve:return(h/1e3).toFixed(1).substring(1).padStart(1,"0");case He:return(h/1e3).toFixed(2).substring(1).padStart(2,"0");case Ue:return".".concat(h.toString().padStart(3,"0"));case je:return e.mathFunc.floor(f).toString().padStart(Nn(t.image,"h",2),"0");case Ge:return e.mathFunc.floor(p).toString().padStart(Nn(t.image,"m",2),"0");case ze:return e.mathFunc.floor(v).toString().padStart(Nn(t.image,"s",2),"0");case We:var d=t.image.split("/")[0],_=t.image.split("/")[1];return u>=12?_:d;case Ze:return d=t.image.split("/")[0],_=t.image.split("/")[1],d=d.toUpperCase()===g.amDesignator?d:g.amDesignator,_=_.toUpperCase()===g.pmDesignator?_:g.pmDesignator,u>=12?_:d;default:return ne(t)}})).join("")}}function Nn(e,t,n){return void 0===n&&(n=0),(e.length-n)/t.length}function Pn(e){var t=e.textTokenConsumer.currentToken;return e.formatterTokenConsumer.currentToken.image===t.image}function Ln(e){var t=e.textTokenConsumer.currentToken;return e.formatterTokenConsumer.currentToken.image===t.image}function Dn(e){var t=e.state,n=e.textTokenConsumer.currentToken,r=e.formatterTokenConsumer.currentToken,i=n.image,o=1e3*parseFloat(i);switch(r.tokenType){case Ve:if(2===i.length)return t.milliseconds=o,!0;break;case He:if(3===i.length||4===i.length)return t.milliseconds=o,!0;break;case Ue:if(i.length>=2)return t.milliseconds=o,!0}return!1}function Fn(e,t,n,r){-1!==t.minutes.indexOf(r.currentIndex)?e.minutes=n:e.month=n}function Bn(e){var t=e.state,n=e.rules,r=e.textTokenConsumer,i=e.formatterTokenConsumer,o=r.currentToken,a=i.currentToken,s=o.image,u=parseFloat(o.image);switch(a.tokenType){case me:case Ee:if(s.length<=2)return t.year=u+(u>=30?1900:2e3),!0;break;case be:if(4===s.length)return t.year=u,!0;break;case we:if(1===s.length||2===s.length&&"0"!==s[0])return Fn(t,n,u,i),!0;break;case Re:if(s.length<=2)return Fn(t,n,u,i),!0;break;case xe:if(s.length<=2)return t.date=u,!0;break;case Ie:if(1===s.length||2===s.length&&"0"!==s[0])return t.date=u,!0;break;case De:if(s.length<=2)return t.hours=u,!0;break;case Le:if(1===s.length||2===s.length&&"0"!==s[0])return t.hours=u,!0;break;case Fe:if(1===s.length||2===s.length&&"0"!==s[0])return t.seconds=u,!0;break;case Be:if(s.length<=2)return t.seconds=u,!0}return!1}function Vn(e){var t=e.state,n=e.service,r=e.textTokenConsumer.currentToken,i=e.formatterTokenConsumer.currentToken,o=n.i18n.getDateTimeFormat(),a=o.amDesignator,s=o.pmDesignator,u=n.i18n.getDateTimeFormat(bt.en).amDesignator,l=n.i18n.getDateTimeFormat(bt.en).pmDesignator,c=r.image;switch(i.tokenType){case We:if(1===c.length&&RegExp("".concat(u[0],"|").concat(l[0]),"i").test(c))return t.isAmOrPm=c.toUpperCase()===a?1:2,!0;break;case Ze:if(2===c.length&&(RegExp("(".concat(a,")|(").concat(s,")"),"i").test(c)||RegExp("(".concat(u,")|(").concat(l,")"),"i").test(c)))return c===a||c.toUpperCase()===u?t.isAmOrPm=1:t.isAmOrPm=2,!0;break;case Xe:return i.image===r.image}return!1}function Hn(e,t,n,r,i,o){var a=Date.UTC(e,t,n,r,i,o),s=new Date(a);return s.getUTCFullYear()===e&&s.getUTCMonth()===t&&s.getUTCDate()===n&&s.getUTCHours()===r&&s.getUTCMinutes()===i&&s.getUTCSeconds()===o}function Un(e){var t=e.state,n=e.service,r=e.textTokenConsumer.currentToken,i=e.formatterTokenConsumer.currentToken;t.isLocal=!0;var o=r.image,a=n.i18n.getDateTimeFormat(),s=a.monthNames,u=a.abbreviatedMonthNames;switch(i.tokenType){case Ae:if(-1!==(l=u.indexOf(o)))return t.month=l+1,!0;break;case Oe:if(-1!==(l=s.indexOf(o)))return t.month=l+1,!0;break;case ke:var l;if(-1!==(l=s.map((function(e){return e[0]})).indexOf(o)))return t.month=l+1,!0}return t.isLocal=!1,!1}!function(e){e[e.AM=1]="AM",e[e.PM=2]="PM"}(Cn||(Cn={}));var Zn=new Map([[zt,Pn],[Yt,Ln],[qt,Dn],[jt,Bn],[Gt,Vn]]);function Wn(e){var t=n.SheetDate.fromLocalDate(new Date(Date.now())),r=jn(e),i=!!e.isAmOrPm,o=e.year,a=e.month,s=e.date,u=e.hours||0,l=e.minutes||0,c=e.seconds||0,h=e.milliseconds||0;if(i){if(!(u<=12&&u>=0))return null;u=12===u?0:u,u=2===e.isAmOrPm?u+12:u}return r?(o="number"==typeof e.year?e.year:t.year,a="number"==typeof e.month?e.month:1,s="number"==typeof e.date?e.date:1):(o=1899,a=12,s=30),Hn(o,a-1,s,u%24,l,c)?n.SheetDate.from({year:o,month:a,date:s,hours:u,minutes:l,seconds:c,milliseconds:h}):null}function jn(e){return"number"==typeof e.date||"number"==typeof e.year||"number"==typeof e.month}function Gn(e){return"number"==typeof e.hours||"number"==typeof e.minutes||"number"==typeof e.seconds||"number"==typeof e.milliseconds||"number"==typeof e.isAmOrPm}function zn(e,t,n){var r=jn(t),i=Gn(t),o=e.i18n.getDateTimeFormat();if("number"==typeof t.milliseconds)return"mm:ss.0";if(n&&r===n.hasDate()&&i===n.hasTime())return n.getFormatCode();if(r&&!i)return"number"!=typeof t.year?o.monthDatePattern:"number"!=typeof t.date?o.yearMonthPattern:t.isLocal?o.longDatePattern:o.shortDatePattern;if(!r&&i){var a="h:mm:ss";return"number"!=typeof t.seconds&&(a="h:mm"),t.isAmOrPm&&(a="".concat(a," AM/PM")),a}return r&&i?"".concat(o.shortDatePattern," h:mm"):null}function Yn(e,t,n,r,i){for(var o={},a=new le(t),s=new le(n);!a.done()&&!s.done();){var u=a.currentToken;if(s.currentToken.tokenType!==Ye){var l=Zn.get(u.tokenType);if("LocalMonthToken"===u.tokenType.name&&(l=Un),"function"!=typeof l||!l({state:o,rules:r,service:e,textTokenConsumer:a,formatterTokenConsumer:s}))return null;a.consume(),s.consume()}else s.consume()}if(a.done()&&s.done()){var c=Wn(o),h=zn(e,o,i);return c&&c.toNumber()>=0?{value:c,code:h}:null}return null}var Xn=function(t){function r(n,i){void 0===i&&(i=new gn);var o=t.call(this,n)||this;o.service=i,o.type=ie.DateTime,o.applyRuleFns=[xn],r.initLexerCache(i);var a=i.dateTimeCodeTokenMap,s=a&&a.get(n);if(!s){var u=i.getVisitor(e.InnerType.DateTime);s=r.compileToken(i,u,n)}if(s.errors.length)throw on;return o.formatRules=s.rules,o}return o(r,t),r.initLexerCache=function(t){var n=this,r=t.i18n.getCultureInfo().DefaultDateTimeFormatters,i=t.getVisitor(e.InnerType.DateTime);t.dateTimeCodeTokenMap||(t.dateTimeCodeTokenMap=new Map(r.map((function(e){return[e,n.compileToken(t,i,e)]}))))},r.compileToken=function(t,n,r){var i=t.getLexer(e.InnerType.DateTime).compile(r);return{tokens:i.tokens,errors:i.errors,rules:n.visit().rules}},r.prototype.isMeetConditions=function(e){if(e instanceof n.SheetDate)e=e.toNumber();else if(!T(e))return!1;return!(e<n.SheetDate.MIN_DATE_VALUE||e>n.SheetDate.MAX_DATE_VALUE)&&t.prototype.isMeetConditions.call(this,e)},r.prototype.getEditingText=function(e){if(!T(e))return null;var t="",n=Z(e),r=n.decimal,i=n.integer,o=this.service.i18n.getDateTimeFormat(),a=o.shortDatePattern,s=o.longTimePattern;return(i||this.formatRules.hasDate)&&(t+=a),(r||this.formatRules.hasTime)&&(t+=t?" ":"",t+=s),t?$r(this.service,t).format(e):null},r.prototype.hasTime=function(){return this.formatRules.hasTime},r.prototype.hasDate=function(){return this.formatRules.hasDate},r.prototype.getPreferredFormatter=function(e){return r.parse(this.service,e,this)},r.getPreferredFormatter=function(e,t){return r.parse(e,t)},r.prototype.parse=function(e,t){if(void 0===t&&(t=!1),t)return r.parse(this.service,e,this,!0);if(x(e)){var i=Number(e);if(this.isMeetConditions(i))return{value:n.SheetDate.fromNumber(i),formatter:null}}return r.parse(this.service,e)},r.matchTextFormatterToken=function(e,t,n,r){var i=e.dateTimeCodeTokenMap,o=i&&i.get(n);if(o){var a=o.rules,s=Yn(e,t,o.tokens||[],a,r);if(s)return{value:s.value,formatter:$r(e,s.code||n)}}return null},r.parse=function(t,n,i,o){var a,u;void 0===o&&(o=!1);var l=t.getLexer(e.InnerType.DateTimeParse).lexer.tokenize(n),c=t.i18n.getCultureInfo().DefaultDateTimeFormatters;if(l.errors.length)return null;if(o){if(!i)throw Error("Exact parse formatter cannot be undefined.");var h=i.getFormatCode();if(!c.includes(h))throw Error("This formatter cannot be supported to match text");return r.matchTextFormatterToken(t,l.tokens,h)}r.initLexerCache(t);try{for(var d=s(c),f=d.next();!f.done;f=d.next()){h=f.value;var p=r.matchTextFormatterToken(t,l.tokens,h,i);if(p)return p}}catch(e){a={error:e}}finally{try{f&&!f.done&&(u=d.return)&&u.call(d)}finally{if(a)throw a.error}}return null},r}(_n);function Kn(e,t,n){var r,i=e.getFormatterResultCache(n||null,t);if(null!=i)return i;if(T(t)&&(t=t.toString()),n){var o=n.getPreferredFormatter(t);r=o?{value:o.value,formatter:o.formatter||n}:qn(e,t)}else r=qn(e,t);return e.setFormatterResultCache(n||null,t,r),r}function qn(e,t){var n=$n(e,t.trim());return null==n?{value:t,formatter:$r(e)}:n}function $n(e,t){var n,r;if(""===t)return null;var i=[Jn,Qn];try{for(var o=s(i),a=o.next();!a.done;a=o.next()){var u=(0,a.value)(e,t);if(null!=u)return u}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return null}function Jn(e,t){var n=t.search(/[/:-]/);return 0===n||n>=t.length-1?null:Xn.getPreferredFormatter(e,t)}function Qn(e,t){return t.search(/[0-9]/)>=0?Sn.getPreferredFormatter(e,t):null}var er=function(t){function n(n,r){void 0===n&&(n="General"),void 0===r&&(r=new gn);var i=t.call(this,n,r)||this;i.service=r,i.type=ie.General;var o=n.match(/general/gi);if(o&&o.length>1)throw on;if(r.getLexer(e.InnerType.General).compile(n).errors.length)throw on;var a=r.getVisitor(e.InnerType.General).visit().rules;return i.formatRules=a,i}return o(n,t),Object.defineProperty(n.prototype,"applyRuleFns",{get:function(){return n.applyRuleFns},enumerable:!1,configurable:!0}),n.parse=function(e,t){return qn(e,t)},n.getEditingText=function(e){return null==e?"":C(e)||R(e)?e.toString().toUpperCase():e.toString()},n.prototype.getEditingText=function(e){return n.getEditingText(e)},n.prototype.getPreferredFormatter=function(e){return qn(this.service,e)},n.prototype.parse=function(e){return n.parse(this.service,e)},n.applyRuleFns=[Et,An,On,Mn,kn],n}(_n);function tr(e,t){var n=t.value;return{formattedText:null==n?"":C(n)?n?"TRUE":"FALSE":n.toString()}}function nr(e,t,n){var r,i,o=t.formattedText,a=void 0===o?"":o,u=n.format,l="";try{for(var c=s(u),h=c.next();!h.done;h=c.next()){var d=h.value;d.tokenType===Lt?l+=a:l+=ne(d)}}catch(e){r={error:e}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}return{formattedText:l}}var rr,ir,or,ar=function(t){function n(n,r){var i=t.call(this,n)||this;if(i.service=r,i.type=ie.Text,r.getLexer(e.InnerType.Text).compile(n).errors.length)throw on;var o=r.getVisitor(e.InnerType.Text).visit().rules;return i.formatRules=o,i}return o(n,t),Object.defineProperty(n.prototype,"applyRuleFns",{get:function(){return n.applyRuleFns},enumerable:!1,configurable:!0}),n.parse=function(e,t){return t||""},n.prototype.isMeetConditions=function(e){return!R(e)&&t.prototype.isMeetConditions.call(this,e)},n.prototype.getEditingText=function(e){return e.toString()},n.prototype.getPreferredFormatter=function(e){return{formatter:null,value:e.toString()}},n.prototype.parse=function(e){return{value:n.parse(this.service,e)}},n.applyRuleFns=[tr,nr],n}(_n);(or=e.FormatterPattern||(e.FormatterPattern={}))[or.TEXT=0]="TEXT",or[or.NUMBER=1]="NUMBER",or[or.ZERO=2]="ZERO",or[or.POSITIVE=3]="POSITIVE",or[or.NEGATIVE=4]="NEGATIVE",or[or.POSITIVE_ZERO=5]="POSITIVE_ZERO",or[or.OPPOSITE=6]="OPPOSITE";var sr=((rr={})[e.FormatterPattern.ZERO]={compareOperand:0,compareOperator:Jt.Equal},rr[e.FormatterPattern.POSITIVE]={compareOperand:0,compareOperator:Jt.Greater},rr[e.FormatterPattern.NEGATIVE]={compareOperand:0,compareOperator:Jt.Less},rr[e.FormatterPattern.POSITIVE_ZERO]={compareOperand:0,compareOperator:Jt.GreaterAndEqual},rr);function ur(t,n){for(var r=[],i=0;i<t.length;i++){var o=null,a=t[i],s=a.getCustomCondition();if(null!=s){if(a instanceof ar)throw on;o=s}else switch(n[i]){case e.FormatterPattern.ZERO:case e.FormatterPattern.POSITIVE:case e.FormatterPattern.NEGATIVE:case e.FormatterPattern.POSITIVE_ZERO:o=sr[n[i]]||null;break;case e.FormatterPattern.OPPOSITE:var u=r[i-1];if(null==u)throw on;o=cr(u);break;case e.FormatterPattern.NUMBER:a.addCondition((function(e){return R(e)}));break;case e.FormatterPattern.TEXT:a.addCondition((function(e){return!R(e)}))}r.push(o)}var l=function(e){var n=r[e];if(null==n)return"continue";var i=t[e],o=tn(n);hr(i,n),i.addCondition((function(e){return T(e)&&o(e)}))};for(i=0;i<t.length;i++)l(i)}var lr=((ir={})[Jt.Equal]=Jt.NotEqual,ir[Jt.NotEqual]=Jt.Equal,ir[Jt.Less]=Jt.GreaterAndEqual,ir[Jt.Greater]=Jt.LessAndEqual,ir[Jt.GreaterAndEqual]=Jt.Less,ir[Jt.LessAndEqual]=Jt.Greater,ir);function cr(e){var t=e.compareOperator;return{compareOperand:e.compareOperand,compareOperator:lr[t]}}function hr(e,t){var n=t.compareOperator,r=t.compareOperand;(Jt.Less===n&&r<=0||(Jt.Equal===n||Jt.LessAndEqual===n)&&r<0)&&e.setFormatRules({hideNegativeSign:!0})}function dr(e,t){var n,r,i=e.getFormatters();try{for(var o=s(i),a=o.next();!a.done;a=o.next()){var u=a.value;if(u.isMeetConditions(t))return u}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return null}function fr(e){return!!vr(e)&&e.getFormatters()[0].hasDate()}function pr(e){return!!vr(e)&&e.getFormatters()[0].hasTime()}function vr(e,t){return mr(ie.DateTime,e,t)}function gr(e,t){return mr(ie.General,e,t)}function _r(e,t){return mr(ie.Digital,e,t)}function yr(e,t){return mr(ie.Text,e,t)}function mr(e,t,n){if(void 0===n)return t.getFormatters().every((function(t){return t.type===e}));var r=dr(t,n);return!(!r||r.type!==e)}function Er(e){if(!(e instanceof qr))return!1;var t=e.getFormatters();return 1===t.length&&t[0].getFormatCode()===ie.General}var br=t.createToken({name:"UnderlineSkipped",pattern:/_./,group:t.Lexer.SKIPPED}),Tr=t.createToken({name:"AsteriskSkipped",pattern:/\*./,group:t.Lexer.SKIPPED}),Cr=t.createToken({name:"SingleQuoteSkipped",pattern:/[\\!]./,group:t.Lexer.SKIPPED}),Sr=t.createToken({name:"DoubleQuoteSkipped",pattern:/"[^"]*"/,group:t.Lexer.SKIPPED}),wr=t.createToken({name:"MetaSkipped",pattern:/\[[^\]]+\]/,group:t.Lexer.SKIPPED});function Rr(e,t,n){var r=t.value,i="",o=[],a=0,s=1,u=Z(r),l=u.integer,c=u.decimal,h=n[ge.DenominatorPart],d=h[0];if(d.tokenType===K)s=parseInt(d.image,10),a=e.mathFunc.round(c*s);else{for(var f=h.findIndex($e);f<h.length&&$e(h[f]);f++)i+=h[f].image,o.push(h[f]);var p=U(r,i.length);a=p.numerator,s=p.denominator}if(Je(n[ge.IntegerPart],$e)||(a+=l*s,l=0),!Number.isFinite(a))throw an;return{integerValue:l,numeratorValue:a,denominatorValue:s}}function Ar(e,t,n){var r=t.integerValue,i=0===t.numeratorValue&&Je(n[ge.IntegerPart],$e);return{formattedInteger:st(e,r,{formatTokens:n[ge.IntegerPart],displayZeroSymbol:i})}}function Or(e,t,n){var r=t.numeratorValue;return 0===r&&Je(n[ge.IntegerPart],$e)?{formattedNumerator:""}:{formattedNumerator:st(e,r,{formatTokens:n[ge.NumeratorPart],displayZeroSymbol:!0})}}function Mr(e,t,n){var r=t.denominatorValue,i=!0;0===t.numeratorValue&&Je(n[ge.IntegerPart],$e)&&(i=!1);for(var o=n[ge.DenominatorPart],a="",s=new le(o);!s.done();){if($e(s.currentToken)){for(var u=[];!s.done()&&$e(s.currentToken);)u.push(s.currentToken),s.consume();i&&(a+=st(e,r,{formatTokens:u}));break}i&&(a+=ne(s.currentToken)),s.consume()}for(;!s.done();){switch(s.currentToken.image){case"0":a+="0";break;case"?":a+=" ";break;case"#":break;default:a+=ne(s.currentToken)}s.consume()}return{formattedDenominator:a,displayDenominator:i}}function kr(e,t){var n=t.formattedInteger,r=t.formattedNumerator,i=t.formattedDenominator,o=t.displayDenominator?"".concat(r,"/").concat(i):i;return{formattedText:"".concat(n).concat(o)}}var Ir=function(t){function n(n,r){void 0===r&&(r=new gn);var i=t.call(this,n,r)||this;if(i.service=r,i.type=ie.Fraction,r.getLexer(e.InnerType.Fraction).compile(n).errors.length)throw on;var o=r.getVisitor(e.InnerType.Fraction).visit(),a=o.rules;if(o.errors.length||!a)throw on;return i.formatRules=a,i}return o(n,t),Object.defineProperty(n.prototype,"applyRuleFns",{get:function(){return n.applyRuleFns},enumerable:!1,configurable:!0}),n.prototype.isMeetConditions=function(e){return!!T(e)&&t.prototype.isMeetConditions.call(this,e)},n.prototype.format=function(e){var n;try{n=t.prototype.format.call(this,e)}catch(t){n=e.toString()}return n},n.parse=function(e,t){return Sn.parse(e,t)},n.prototype.parse=function(e){return n.parse(this.service,e)},n.prototype.getEditingText=function(e){return T(e)?(Number.isFinite(e),e.toString()):null},n.prototype.getPreferredFormatter=function(e){var t=Sn.parse(this.service,e);return t?{value:t.value,formatter:null}:null},n.applyRuleFns=[Rr,Ar,Or,Mr,kr],n}(_n);function xr(e,t){var n,r;void 0===t&&(t=new gn);var i,o=Zr().tokenize(e),a=o.tokens;if(o.errors.length)throw on;try{for(var u=s(Wr),l=u.next();!l.done;l=u.next()){var c=l.value,h=c.formatterClass;if(Je(a,c.keyword)){if(i)throw on;i=h}}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}if(null!=i&&i!==Sn&&i!==Xn&&Je(a,[Fr]))throw on;return i===Sn&&Je(a,[Br])&&(i=Ir),i||(i=Je(a,[Fr])?Sn:er),new i(e,t)}var Nr=t.createToken({name:"GeneralFormatterKeyword",pattern:/General/i}),Pr=t.createToken({name:"DigitalFormatterKeyword",pattern:/[#?]+|%|E\+|E-/i}),Lr=t.createToken({name:"DateTimeFormatterKeyword",pattern:/(y|g|m|d|h|s)+|a{3,}/i}),Dr=t.createToken({name:"TextFormatterKeyword",pattern:/@+/i}),Fr=t.createToken({name:"ZeroKeyword",pattern:/0+/}),Br=t.createToken({name:"SolidusKeyword",pattern:/\//}),Vr=t.createToken({name:"Text",pattern:/.|\s/,group:t.Lexer.SKIPPED}),Hr=[je,Ge,ze,wr,Tr,br,Sr,Cr,Nr,Pr,Lr,Dr,Fr,Br,Vr],Ur=null;function Zr(){return Ur||(Ur=new t.Lexer(Hr,Nt)),Ur}var Wr=[{formatterClass:er,keyword:[Nr]},{formatterClass:Sn,keyword:[Pr]},{formatterClass:Xn,keyword:[Lr,je,Ge,ze]},{formatterClass:ar,keyword:[Dr]}],jr=t.createToken({name:"Semicolon",pattern:";"}),Gr=t.createToken({name:"TextWithoutCommentAndSemicolon",pattern:/[^\[\]"\\!;]+/,group:t.Lexer.SKIPPED}),zr=new t.Lexer([wr,Tr,br,Sr,Cr,jr,Gr],{positionTracking:"onlyOffset"});function Yr(e){var t=zr.tokenize(e),n=t.tokens;if(t.errors.length)throw on;for(var r=0,i=[],o=0;o<n.length;o++)n[o].tokenType===jr&&(i.push(e.slice(r,n[o].startOffset)),r=n[o].startOffset+1);return r<=e.length&&i.push(e.slice(r,e.length)),i}var Xr,Kr,qr=function(t){function n(e,n){void 0===e&&(e=ie.General),void 0===n&&(n=new gn);var r=t.call(this)||this;r.service=n,r.formatters=[],r.syntaxError=!1;try{r.initFormatters(n,e)}catch(e){r.syntaxError=!0,r.initFormatters(n,ie.General)}return r}return o(n,t),n.prototype.initFormatters=function(e,t){var n=Yr(t);if(n.length<1||n.length>4)throw on;this.formatters=[];for(var r=0;r<n.length;r++){var i=void 0;try{i=xr(n[r],e)}catch(e){this.syntaxError=!0,i=new er}this.formatters.push(i)}this.initConditions()},n.prototype.initConditions=function(){switch(this.formatters.length){case 2:var t=this.formatters[1];ur(this.formatters,t instanceof ar?[e.FormatterPattern.NUMBER,e.FormatterPattern.TEXT]:[e.FormatterPattern.POSITIVE_ZERO,e.FormatterPattern.OPPOSITE]);break;case 3:var n=this.formatters[2];ur(this.formatters,n instanceof ar?[e.FormatterPattern.POSITIVE_ZERO,e.FormatterPattern.OPPOSITE,e.FormatterPattern.TEXT]:[e.FormatterPattern.POSITIVE,e.FormatterPattern.NEGATIVE,e.FormatterPattern.NUMBER]);break;case 4:ur(this.formatters,[e.FormatterPattern.POSITIVE,e.FormatterPattern.NEGATIVE,e.FormatterPattern.NUMBER,e.FormatterPattern.TEXT])}},n.fromJSON=function(e,t){return $r(e,t.formatCached)},n.prototype.getFormatters=function(){return this.formatters},n.prototype.getFormatCode=function(){return this.formatters.map((function(e){return e.getFormatCode()})).join(";")},n.prototype.getPreferredFormatter=function(e){var t,n;try{for(var r=s(this.formatters),i=r.next();!i.done;i=r.next()){var o=i.value,a=o.getPreferredFormatter(e);if(a){var u=a.value,l=a.formatter;if(o.isMeetConditions(u))return l?{value:u,formatter:l}:{value:u,formatter:this}}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return null},n.prototype.getDisplayText=function(e){return this.format(e)},n.prototype.getEditingText=function(e){var t,n;try{for(var r=s(this.formatters),i=r.next();!i.done;i=r.next()){var o=i.value;if(o.isMeetConditions(e)){var a=o.getEditingText(e);if(a)return a;break}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return er.getEditingText(e)},n.prototype.formatWithoutCache=function(e,t){var n,r;try{for(var i=s(this.formatters),o=i.next();!o.done;o=i.next()){var a=o.value;if(a.isMeetConditions(e))return!T(e)||a instanceof Xn||(e=t?t.mathFunc.toPrecision(e,15):parseFloat(e.toPrecision(15))),a.format(e)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return(new er).format(e)},n.prototype.format=function(e){return this.service.getFormattedText(this,e)},n.prototype.toJSON=function(){var e=this.getFormatCode();if(!gr(this)||!/^General$/i.test(e))return{formatCached:e}},n.prototype.equals=function(e){return this.getFormatCode()===e.getFormatCode()},n.prototype.parse=function(e){var t,n;try{for(var r=s(this.formatters),i=r.next();!i.done;i=r.next()){var o=i.value,a=o.parse(e);if(null!=a&&o.isMeetConditions(a.value))return a}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return null},n.prototype.hasSyntaxError=function(){return this.syntaxError},n}(r);function $r(e,t){return e.getFormatter(t)}function Jr(e,t,n,r){var i,o;if(!R(n))return null;var a=[];t||(t=$r(e));var u=t.getFormatters();try{for(var l=s(u),c=l.next();!c.done;c=l.next()){var h=c.value;ai(h)?a.push(ii(h,r)||h.getFormatCode()):si(h)?a.push(ri(h,n,r)||h.getFormatCode()):a.push(h.getFormatCode())}}catch(e){i={error:e}}finally{try{c&&!c.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}return $r(e,a.join(";"))}function Qr(e,t){var n=An(e,{value:t});if(null==n)return null;var r=n.formattedText,i=r.search(/e/i);return i>=0&&(r=r.slice(0,i)),M(r)}function ei(t,n){return n===e.ChangeDecimalPlaceMode.Increase?Math.min(15,t+1):Math.max(0,t-1)}function ti(e,t){var n=e.getFormatCode(),r=Bt.PATTERN;return n.replace(r,t)}function ni(e,t){return Rn(e)?"".concat(t,"E+00"):t}function ri(e,t,n){var r=Qr(e.getService(),t);if(null==r)return null;var i=ei(r,n);return ti(e,ni(t,i<=0?"0":"0."+"0".repeat(i)))}function ii(t,n){var r=ui(t),i=r.tokens,o=r.decimalSize,a=r.startIndex,s=r.endIndex,u=r.pointIndex;switch(n){case e.ChangeDecimalPlaceMode.Decrease:if(0===o)return null;for(var l=s-1;l>a;l--)if("NumberPlaceHolder"===(h=i[l]).tokenType.LABEL){oi(i,l,1,Xr.endToStart);break}return 1===o&&oi(i,u,1,Xr.startToEnd),i.map((function(e){return e.image})).join("");case e.ChangeDecimalPlaceMode.Increase:if(15===o)return null;if(u<0){for(l=s-1;l>=0;l--)if("NumberPlaceHolder"===i[l].tokenType.LABEL){i.splice(l+1,0,{tokenType:g,image:"."},{tokenType:d,image:"0"});break}}else{var c=!1;for(l=s-1;l>a;l--){var h;if("NumberPlaceHolder"===(h=i[l]).tokenType.LABEL){c=!0,h.image=h.image+"0";break}}c||i.splice(u+1,0,{tokenType:d,image:"0"})}return i.map((function(e){return e.image})).join("")}return null}function oi(e,t,n,r){var i=e[t];n===i.image.length?e.splice(t,1):Xr.startToEnd===r?i.image=i.image.slice(n):i.image=i.image.slice(0,-n)}function ai(e){return e.type===ie.Digital}function si(e){return e.type===ie.General}function ui(t){var n=t.getService().getLexer(e.InnerType.Number),r=t.getFormatCode(),i=n.compile(r).tokens.map((function(e){return{image:e.image,tokenType:e.tokenType}})),o=i.findIndex((function(e){return e.tokenType===g})),a=i.findIndex((function(e){return e.tokenType===p})),s=0,u=0;u=a<0?i.length:a;for(var l=0,c=(s=o<0?u:o)+1;c<u;c++)"NumberPlaceHolder"===i[c].tokenType.LABEL&&(l+=i[c].image.length);return{decimalSize:l,startIndex:s,endIndex:u,tokens:i,pointIndex:o}}(Kr=e.ChangeDecimalPlaceMode||(e.ChangeDecimalPlaceMode={})).Decrease="decrease",Kr.Increase="increase",function(e){e[e.startToEnd=0]="startToEnd",e[e.endToStart=1]="endToStart"}(Xr||(Xr={})),e.AbstractFormatter=r,e.BaseFormatter=_n,e.BaseLexer=Pt,e.BuiltinFormatter=mn,e.CompareConditionOfFormatterPattern=sr,e.CultureInfoMap=It,e.DateTimeFormatter=Xn,e.DefaultLexerOptions=Nt,e.DigitalFormatter=Sn,e.Formatter=qr,e.FormatterService=gn,e.FractionFormatter=Ir,e.GeneralFormatter=er,e.GroupSeparatorRule=fe,e.I18NService=xt,e.applyBooleanRule=Mn,e.applyNumberRule=An,e.applyPercentRule=pt,e.applyRules=yn,e.applyScaleRule=ft,e.applyScientificRule=gt,e.applyStringRule=On,e.changeDigitalFormatterDecimalPlace=ii,e.changeFormatterDecimalPlace=Jr,e.changeGeneralFormatterDecimalPlace=ri,e.convertToString=tr,e.createFormatter=$r,e.defineFormatterPattern=ur,e.escapeTextAndAt=nr,e.escapeTextAndGeneral=kn,e.expandNumber=ht,e.formatDecimalPart=lt,e.formatExponentPart=ct,e.formatIntegerPart=ut,e.formatNumber=st,e.getDecimalDigitsLength=M,e.getDigitalFormatterDecimalState=ui,e.getDigitsLength=A,e.getEffectiveFormatter=dr,e.getIntegerAndDecimal=Z,e.getIntegerDigitsLength=O,e.getOppositeCondition=cr,e.getPreferredFormatter=Kn,e.hasDate=fr,e.hasTime=pr,e.hideNegativeSign=Et,e.inferPreferredFormatter=qn,e.inferPreferredFormatterAfterPretreatment=$n,e.isBigNumber=P,e.isBoolean=C,e.isDateTimeFormatter=vr,e.isDefaultFormatter=Er,e.isDigitalFormatter=_r,e.isFormatter=mr,e.isFunction=w,e.isGeneralFormatter=gr,e.isNumber=T,e.isNumeric=x,e.isScientificNotation=D,e.isSimpleNumber=L,e.isSimpleOrBigNumber=N,e.isString=S,e.isTextFormatter=yr,e.isValidNumber=R,e.joinNumber=dt,e.lexerCreators=en,e.parseDateTime=Jn,e.parseNumber=Qn,e.round10=k,e.setReplaceNegativeSignRule=hr,e.shouldUseScientificNotation=Rn,e.toExponential=B,e.toFixedSize=H,e.toFraction=U,e.toNonExponential=V,e.toPrecision=F,e.trimCurrencySymbol=_t,e.trimPercentSymbol=mt,e.unapplyGroupSeparatorRule=pe,e.unapplyPercentRule=vt,Object.defineProperty(e,"__esModule",{value:!0})}(t,n("vsh_23414"),n("vsh_84784"))},vsh_19044:function(e,t,n){!function(e,t,n){"use strict";function r(){return t.Faster.getRootList().map((function(e){return e.app()||null})).filter((function(e){return!!e}))}var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function a(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function s(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}var u=function(e){function n(t){var n=e.call(this,null)||this;return n.widget=t,n._isWidgetDirty=!1,n._onWidgetDirty=null,n._dispatcher=null,n._getOffset=null,n._getTransform=null,n.updateByCfg({skipSelfEvent:!0}),n.setRootId(t.rootId()),n.addChild(t),n}return o(n,e),n.prototype.dispatcher=function(){return this._dispatcher},n.prototype._setProps=function(e,n){e===t.WidgetProps.ChildDirty&&(this._isWidgetDirty=!0,this._onWidgetDirty&&this._onWidgetDirty())},n.prototype.beforeRemoveChild=function(e){this._dispatcher&&this._dispatcher.updateAutoCapture(e)},n.prototype.initEnv=function(e){"ssr"==="production".toLowerCase()||(this._dispatcher=new t.Dispatcher(e.browser.canvas),this._dispatcher.setRoot(this.widget),this._dispatcher.bindEvents(),this._dispatcher.setOffsetDirty())},n.prototype.miniProps=function(){var e=this;return{RNodeType:"Faster_0.x_widget",createRNode:function(){return e}}},n.prototype.defineGetTransform=function(e){this._getTransform=e},n.prototype.defineGetOffset=function(e){this._getOffset=e},n.prototype.build=function(){this.widget.flush()},n.prototype.layout=function(e){return this._dispatcher&&this._dispatcher.refreshCursor(),"function"==typeof this.widget.layout?this.widget.layout(e):(this.width=e.maxWidth<Number.MAX_SAFE_INTEGER?e.maxWidth:this.widget.width,this.height=e.maxHeight<Number.MAX_SAFE_INTEGER?e.maxHeight:this.widget.height,{width:this.width,height:this.height})},n.prototype.paint=function(e,t){this.widget.paint(e,this.widget.paintedRect())},n.prototype.mapFromParent=function(e){if(this._getOffset){var n=this._getOffset(),r=n.x,i=n.y;e.move(-r,-i)}if(this._getTransform){var o=this._getTransform();new t.TMatrix(o.a,o.b,o.c,o.d,o.e,o.f).inversePoint(e)}return e},n.prototype.mapToParent=function(e){if(this._getTransform){var n=this._getTransform();new t.TMatrix(n.a,n.b,n.c,n.d,n.e,n.f).mapPoint(e)}if(this._getOffset){var r=this._getOffset(),i=r.x,o=r.y;e.move(i,o)}return e},n.prototype.destroy=function(){return this._dispatcher&&this._dispatcher.unbindEvents(),this.widget&&this.widget.destroy(),e.prototype.destroy.call(this)},n.prototype.isDirty=function(){return this._isWidgetDirty},n.prototype.subscribeDirty=function(e){this._onWidgetDirty=e},n.prototype.dispatchEvent=function(e){if(this._dispatcher){t.Dispatcher.cursorRootId=this.widget.UID;var n=this._getOffset?this._getOffset():new t.FPoint(0,0),r=this._getTransform?this._getTransform():void 0;return this._dispatcher.processDomEvent(e,n,r)}return!1},n.widgetAdapterMap=new Map,n}(t.FWidget),l=null,c=function(){l||(l=setInterval((function(){u.widgetAdapterMap.forEach((function(e,t){e.widget&&e.widget.destroied()&&u.widgetAdapterMap.delete(t)}))}),3e3))};function h(e){if(!u.widgetAdapterMap.has(e)){var t=new u(e);return u.widgetAdapterMap.set(e,t),t}return u.widgetAdapterMap.get(e)}t.FApp.onAppExit((function(){u.widgetAdapterMap.forEach((function(e){t.Dispatcher.unbindEvents(e._dispatcher)})),u.widgetAdapterMap.clear(),l&&(clearInterval(l),l=null)})),t.FApp.onAppRun((function(){return c()}));var d=function(e){function n(n){var r=e.call(this,null)||this;return r.rNode=n,r._width=0,r._height=0,r.draggable=!0,r.droppable=!0,r.rNode.subscribeDirty((function(){r._changes.set("_phantom",{current:!0,before:void 0}),r._dirtyParent()})),r.rNode.defineGetOffset((function(){return r.mapToGlobal(new t.FPoint(0,0))})),r.rNode.defineGetTransform((function(){return r.mapTransformToGlobal(new t.TMatrix)})),r}return o(n,e),Object.defineProperty(n.prototype,"width",{get:function(){return this._width||0},set:function(e){this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height||0},set:function(e){this._height=e},enumerable:!1,configurable:!0}),n.prototype.setRootId=function(n){e.prototype.setRootId.call(this,n),"function"==typeof this.rNode.setRootId&&this.rNode.setRootId(n);var r=t.Faster.findFaster(this);if(r){var i=r.canvas().element();this.rNode.initEnv({browser:{canvas:i}})}},n.prototype.updateByCfg=function(t){return"function"==typeof this.rNode.updateState&&this.rNode.updateState(t),e.prototype.updateByCfg.call(this,t)},n.prototype.destroy=function(){"function"==typeof this.rNode.destroy&&this.rNode.destroy(),e.prototype.destroy.call(this)},n.prototype.paint=function(e,t){var n=this.pCfg||this._cfg,r=n.x,i=n.y;t.x-=r,t.y-=i,e.translate(r,i),this.rNode.paint(e,t),e.translate(-r,-i)},n.prototype.flush=function(){e.prototype.flush.call(this),this.rNode.build();var n=this.parent();n&&this.layout(new t.Constraint({minWidth:0,minHeight:0,maxWidth:n.width,maxHeight:n.height}))},n.prototype.layout=function(e){var t=this.rNode.layout({maxHeight:e.maxHeight,minHeight:e.minHeight,maxWidth:e.maxWidth,minWidth:e.minWidth}),n=t.width,r=t.height;return this.width=n,this.height=r,this.size},n.prototype.event=function(t){var n=e.prototype.event.call(this,t);if(t.nativeEvent){var r=this.rNode.dispatchEvent(t.nativeEvent),i=t.nativeEvent instanceof Event?t.nativeEvent:t.nativeEvent.srcEvent;return i&&i.defaultPrevented&&t.srcEventPreventDefault(),r}return n},n.prototype.hitTest=function(e,t,n){if(this.rNode.widget){if(null!==this.rNode.widget.findWidget(e,t))return!0;if(void 0!==n&&"mousemove"===n.type){var r=this.rNode._dispatcher;if(r){var i=n,o=i.buttons,a=i.ctrlKey,s=i.shiftKey,u=i.altKey,l=i.metaKey;r._enterLeaveDispatch(!0,null,n,{globalX:0,globalY:0,buttons:o,ctrlKey:a,shiftKey:s,altKey:u,metaKey:l})}}return!1}return!0},n}(t.FWidget);function f(e){return new d(e)}var p={F2R:h,R2F:f},v=function(e){function n(n){var r=e.call(this)||this;return r.widget=n,r._isWidgetDirty=!1,r._onWidgetDirty=null,r._dispatcher=null,r._getOffset=null,r._getTransform=null,r.skipSelfEvent=!0,r._changedWidgets=new t.ChangedList,r._changedWidgets.setInsertCallback((function(){r._isWidgetDirty=!0,r._onWidgetDirty&&r._onWidgetDirty()})),r.setRootId(n.rootId()),r.addChild(n),r.changedListId=r._changedWidgets.id,n.changedListId=r._changedWidgets.id,r._changedWidgets.insert({uid:n.UID}),r}return o(n,e),n.prototype.dispatcher=function(){return this._dispatcher},n.prototype.initEnv=function(e){"ssr"==="production".toLowerCase()||(this._dispatcher=new t.Dispatcher(e.browser.canvas),this._dispatcher.setRoot(this.widget),this._dispatcher.bindEvents(),this._dispatcher.setOffsetDirty())},n.prototype.miniProps=function(){var e=this;return{RNodeType:"Faster_1.x_widget",createRNode:function(){return e}}},n.prototype.defineGetTransform=function(e){this._getTransform=e},n.prototype.defineGetOffset=function(e){this._getOffset=e},n.prototype.build=function(){var e=this.miniProps();Object.keys(e).map((function(t){"RNodeType"!==t&&"createRNode"!==t&&e[t]})),this.widget.build(),this._isWidgetDirty=!1,this._changedWidgets.clear()},n.prototype.performLayout=function(e){return this._dispatcher&&this._dispatcher.refreshCursor(),this.size=this.widget.layout(new t.Constraint(e)),{width:this.size.width,height:this.size.height}},n.prototype.updateState=function(e){this.widget.updateState(e)},n.prototype.destroy=function(){return this._dispatcher&&this._dispatcher.unbindEvents(),this._changedWidgets.destroy(),this.widget&&this.widget.destroy(),e.prototype.destroy.call(this)},n.prototype.mapTransformToParent=function(e){if(this._getTransform){var t=this._getTransform();e.transform(t.a,t.b,t.c,t.d,t.e,t.f)}return e},n.prototype.mapFromParent=function(e){if(this._getOffset){var n=this._getOffset(),r=n.x,i=n.y;e.move(-r,-i)}if(this._getTransform){var o=this._getTransform();new t.TMatrix(o.a,o.b,o.c,o.d,o.e,o.f).inversePoint(e)}return e},n.prototype.mapToParent=function(e){if(this._getTransform){var n=this._getTransform();new t.TMatrix(n.a,n.b,n.c,n.d,n.e,n.f).mapPoint(e)}if(this._getOffset){var r=this._getOffset(),i=r.x,o=r.y;e.move(i,o)}return e},n.prototype.paint=function(e,n){n?this.widget.renderTree(e,new t.FRect(n.x,n.y,n.width,n.height)):this.widget.renderTree(e)},n.prototype.isDirty=function(){return this._isWidgetDirty},n.prototype.subscribeDirty=function(e){this._onWidgetDirty=e,!0===this._isWidgetDirty&&this._onWidgetDirty()},n.prototype.dispatchEvent=function(e){if(this._dispatcher){t.Dispatcher.cursorRootId=this.widget.UID;var n=this._getOffset?this._getOffset():new t.FPoint(0,0),r=this._getTransform?this._getTransform():void 0;return this._dispatcher.processDomEvent(e,n,r)}return!1},a([t.State,s("design:type",Boolean)],n.prototype,"skipSelfEvent",void 0),n}(t.FBase);function g(e){return new v(e)}var _=function(e){function n(t){var n=e.call(this)||this;return n.draggable=!0,n.droppable=!0,n.rNode=null,n._rNodeType="",n._defineRNode(t.rNode),n}return o(n,e),n.prototype.onStateChange=function(e){if(this.state&&this.rNode!==e.data.rNode){e.data.rNode&&this._defineRNode(e.data.rNode);var t=this.rNode;this.rNode=e.data.rNode,t&&(t.widget=null,t.destroy&&t.destroy())}},n.prototype._defineRNode=function(e){var n=this,r=e.miniProps();this._rNodeType=r.RNodeType,e.subscribeDirty((function(){if(e.widget){var r=t.ChangedList.get(n.changedListId);r&&r.insert({uid:n.UID})}})),e.defineGetOffset((function(){return n.mapToGlobal(new t.FPoint(0,0))})),e.defineGetTransform((function(){return n.mapTransformToGlobal(new t.TMatrix)}));var i=t.Faster.findFaster(this);if(i){var o=i.canvas().element();e.initEnv({browser:{canvas:o}})}},n.prototype.setRootId=function(n){e.prototype.setRootId.call(this,n),this.rNode&&"function"==typeof this.rNode.setRootId&&this.rNode.setRootId(n);var r=t.Faster.findFaster(this);if(r){var i=r.canvas().element();this.rNode&&this.rNode.initEnv({browser:{canvas:i}})}},n.prototype.updateState=function(t){if(this.rNode&&"function"==typeof this.rNode.updateByCfg){var n={};for(var r in t)"ctor"!==r&&(n[r]=t[r]);this.rNode.updateByCfg(n)}e.prototype.updateState.call(this,t)},n.prototype.destroy=function(){this.rNode&&"function"==typeof this.rNode.destroy&&this.rNode.destroy(),e.prototype.destroy.call(this)},n.prototype.build=function(){if(e.prototype.build.call(this),this.rNode){var t=this.rNode.miniProps();t.RNodeType!==this._rNodeType?(this.rNode=t.createRNode(),this._rNodeType=t.RNodeType):this.rNode.isDirty()&&this.rNode.build()}},n.prototype.paintSelf=function(e,t){this.rNode&&(e.translate(this.pos.x,this.pos.y),this.rNode.paint(e,t?t.clone():this.boundaryRect()),e.translate(-this.pos.x,-this.pos.y))},n.prototype.performLayout=function(e){return this.rNode&&(this.size=this.rNode.layout({maxHeight:e.maxHeight,minHeight:e.minHeight,maxWidth:e.maxWidth,minWidth:e.minWidth})),this.size},n.prototype.event=function(t){var n=e.prototype.event.call(this,t);if(t.nativeEvent&&this.rNode){var r=this.rNode.dispatchEvent(t.nativeEvent),i=t.nativeEvent instanceof Event?t.nativeEvent:t.nativeEvent.srcEvent;return i&&i.defaultPrevented&&t.srcEventPreventDefault(),r}return n},n.prototype.hitTest=function(e,t,n){if(this.rNode&&this.rNode.widget){if(null!==this.rNode.widget.findWidget(e,t))return!0;if(void 0!==n&&"mousemove"===n.type){var r=this.rNode._dispatcher;if(r){var i=n,o=i.buttons,a=i.ctrlKey,s=i.shiftKey,u=i.altKey,l=i.metaKey;r._enterLeaveDispatch(!0,null,n,{globalX:0,globalY:0,buttons:o,ctrlKey:a,shiftKey:s,altKey:u,metaKey:l})}}return!1}return!0},a([t.State,s("design:type",Boolean)],n.prototype,"draggable",void 0),a([t.State,s("design:type",Boolean)],n.prototype,"droppable",void 0),a([t.State,s("design:type",Object)],n.prototype,"rNode",void 0),n}(t.FBaseWidget),y=new Map,m=null,E=function(){m||(m=setInterval((function(){y.forEach((function(e,t){t.widget&&t.widget.destroied()&&y.delete(t)}))}),3e3))};function b(e){return y.has(e)||y.set(e,_),new t.FState(y.get(e),{rNode:e})}t.FApp.onAppExit((function(){y.clear(),m&&(clearInterval(m),m=null)})),t.FApp.onAppRun((function(){return E()}));var T={F2R:g,R2F:b};function C(e){return T.R2F(p.F2R(e))}function S(e){return p.R2F(T.F2R(e))}!function(e){function t(t){var n=e.call(this)||this;return n.widget=t,n}o(t,e),t.prototype.setRootId=function(t){e.prototype.setRootId.call(this,t),this.widget.setRootId(t)},t.prototype.describe=function(){return C(this.widget)},t.prototype.destroy=function(){this.widget.destroy(),e.prototype.destroy.call(this)},Object.defineProperty(t.prototype,"cursor",{get:function(){return this.widget.cursor},enumerable:!1,configurable:!0})}(t.FBaseWidget);var w=function(){function e(){this._converter=[]}return e.installDefaultConverter=function(t){e.converter.unshift(t)},e.prototype.installConverter=function(e){this._converter.unshift(e)},e.prototype.constructWidgetTree=function(n){var r=this._converter.concat(e.converter),i=this._constructWidgetSubTree(n,r);if(i instanceof t.Faster)return i;var o=document.createElement("canvas"),a=new t.Faster(o);return a.resize(i.width,i.height),a.runApp(C(i)),a},e.prototype._constructWidgetSubTree=function(e,n){var r=this,i=this._FVGNode2Widget(e,n),o=e.children;return o&&o.forEach((function(e){var o=r._constructWidgetSubTree(e,n);i instanceof t.Faster?i.runApp(C(o)):i.addChild(o)})),i},e.prototype._FVGNode2Widget=function(e,t){var n;return t.some((function(t){return null!==(n=t.constructWidget(e))})),n},e.converter=[new n.FVGWdkConstructor,new t.FDefaultConstructor],e}();function R(e,n){var r=function(e,t){if(e.flushCfg(!0),t.flushCfg(!0),typeof e==typeof t&&JSON.stringify(e.fvgNode())===JSON.stringify(t.fvgNode())){if(e.children().length!==t.children().length)return[e,t];for(var n=e.children(),i=t.children(),o=Math.min(n.length,i.length),a=0;a<o;a++){var s=r(n[a],i[a]);if(null!==s)return s}return null}return[e,t]},i=function(e){return e instanceof t.Faster?S(e.app()):e instanceof t.FBaseWidget?S(e):e};return r(i(e),i(n))}function A(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?n(e.value):i(e.value).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function O(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(e){return function(t){return u([e,t])}}function u(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}function M(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}var k=function(e,t){return e.type>t.type?1:e.type<t.type?-1:0},I=function(e){if(e instanceof t.FWidget){if(0===e.width||0===e.height||!0===e.hidden)return!0}else if(e instanceof t.FBase&&(0===e.size.width||0===e.size.height))return!0;return!1};function x(e){return e.rNode?[e.rNode.widget]:e.children()}function N(e){var n,r;if(!e)return null;var i=e,o=i.fvgNode(),a=new t.SortedArray(k);void 0===o.children&&(o.children=[]);var s=x(i),u=function(e){var t=N(e);t&&a.insert(t)};try{for(var l=M(s),c=l.next();!c.done;c=l.next()){var h=c.value;if(h instanceof t.FWidget)if(i instanceof t.FWidget){var d=i.paintedRect().move(-i.x,-i.y);h.paintedRect().intersect(d)&&!I(h)&&u(h)}else I(h)||u(h);else h instanceof t.FBase&&u(h)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}if(a.len()>0){var f=a.toArray();o.children?o.children=o.children.concat(f):o.children=a.toArray()}return o}function P(e,n,r){return A(this,void 0,void 0,(function(){var i,o,a=this;return O(this,(function(s){return i=function(e,t){return A(a,void 0,void 0,(function(){var n,o,a,s;return O(this,(function(u){switch(u.label){case 0:return(n=e.type===t.type)?[4,L(e.cfg,t.cfg,e.type,r)]:[3,2];case 1:n=u.sent(),u.label=2;case 2:if(!n)return[3,7];if(o=e.children&&e.children.length||0,a=t.children&&t.children.length||0,o!==a)return[2,[e,t]];s=0,u.label=3;case 3:return s<o?[4,i(e.children[s],t.children[s])]:[3,6];case 4:if(!1!==u.sent())return[2,[e.children[s],t.children[s]]];u.label=5;case 5:return s++,[3,3];case 6:return[2,!1];case 7:return[2,[e,t]]}}))}))},[2,i((o=function(e){return e.type===t.WidgetType.faster&&(e.type=t.WidgetType.widget),e})(e),o(n))]}))}))}function L(e,t,n,r){return A(this,void 0,void 0,(function(){return O(this,(function(i){switch(i.label){case 0:return JSON.stringify(e)===JSON.stringify(t)?[2,!0]:r?[4,r(e,t,n)]:[3,2];case 1:return[2,i.sent()];case 2:return[2,!1]}}))}))}window.__FASTER_META__=window.__FASTER_META__||{},window.__FASTER_META__.fvg||(window.__FASTER_META__.fvg={diffFaster:R,FVGViewer:w,diffFVG:P,export2FvgTree:N,getFxs:r}),e.FVGViewer=w,e.diffFVG=P,e.diffFaster=R,e.export2FvgTree=N,e.getFxs=r,Object.defineProperty(e,"__esModule",{value:!0})}(t,n("vsh_33916"),n("vsh_91497"))},vsh_8497:function(e,t,n){!function(e,t){"use strict";var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},n(e,t)};function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i,o=function(){function e(){this.logLine=[],this.logSet=new Set}return e.prototype.getLog=function(){return this.logLine},e.prototype.add=function(e){this.logLine.push(e),this.logSet.add(e)},e.prototype.clear=function(){this.logLine=[],this.logSet.clear()},e.prototype.has=function(e){return this.logSet.has(e)},e}();e.FPSLogType=void 0,(i=e.FPSLogType||(e.FPSLogType={})).TICK="tick",i.END="end";var a=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return r(n,t),Object.defineProperty(n.prototype,"outterLog",{get:function(){return Array.from(this.logSet).filter((function(t){return t!==e.FPSLogType.TICK&&t!==e.FPSLogType.END}))},enumerable:!1,configurable:!0}),n.prototype.hasOnly=function(e){var t=this.outterLog;return 1===t.length&&t[0]===e},n.prototype.hasSingleAction=function(){var e=this.outterLog;return 1===e.length&&e[0]},n}(o),s=function(){function n(n,r){var i=this;this.cb=r,this._startTime=null,this._frameCount=0,this._report=function(){var t=performance.now()-i._startTime,n={fps:Math.round(i._frameCount/t*1e3),frameCount:i._frameCount,elapsedTime:t,logs:i._log};return i._log.add(e.FPSLogType.END),i.cb(n),i._init(),!1},this._calc=function(n){return!!i._faster&&(i._log.add(e.FPSLogType.TICK),i._frameCount++,1===i._frameCount&&(i._startTime=performance.now(),i._faster.addOnceListener(t.FEventType.EmptyTick,i._report)),!1)},this._faster=n,this._log=new a,this._init(),this._faster.addListener(t.FEventType.BeforeTick,this._calc)}return n.prototype.addLog=function(e){return this._log.add(e)},n.prototype._init=function(){this._startTime=null,this._frameCount=0,this._log.clear()},n.prototype.destroy=function(){this.cb=function(){},this._faster.removeListener(t.FEventType.BeforeTick,this._calc),this._faster.removeListener(t.FEventType.EmptyTick,this._report)},n}();e.FPS=s,e.FPSLog=a,e.Log=o,Object.defineProperty(e,"__esModule",{value:!0})}(t,n("vsh_33916"))},vsh_60029:function(e,t,n){!function(e,t){"use strict";function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function i(e,t){return e(t={exports:{}},t.exports),t.exports}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self&&self;var o,a=i((function(e,t){var n;n=function(e){var t={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},n=/([astvzqmhlc])([^astvzqmhlc]*)/gi,r=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi,i=function(e){var i=[],o=String(e).trim();return"M"!==o[0]&&"m"!==o[0]||o.replace(n,(function(e,n,o){var a=n.toLowerCase(),s=function(e){var t=e.match(r);return t?t.map(Number):[]}(o),u=n;if("m"===a&&s.length>2&&(i.push([u].concat(s.splice(0,2))),a="l",u="m"===u?"l":"L"),s.length<t[a])return"";for(i.push([u].concat(s.splice(0,t[a])));s.length>=t[a]&&s.length&&t[a];)i.push([u].concat(s.splice(0,t[a])));return""})),i};function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){var n=e.x*Math.cos(t)-e.y*Math.sin(t),r=e.y*Math.cos(t)+e.x*Math.sin(t);e.x=n,e.y=r}function l(e,t){e.x*=t,e.y*=t}var c=function(e){if(void 0!==e&&e.CanvasRenderingContext2D&&!e.Path2D){var t=function(){function e(t){var n;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.segments=[],t&&t instanceof e?(n=this.segments).push.apply(n,a(t.segments)):t&&(this.segments=i(t))}var t;return(t=[{key:"addPath",value:function(t){var n;t&&t instanceof e&&(n=this.segments).push.apply(n,a(t.segments))}},{key:"moveTo",value:function(e,t){this.segments.push(["M",e,t])}},{key:"lineTo",value:function(e,t){this.segments.push(["L",e,t])}},{key:"arc",value:function(e,t,n,r,i,o){this.segments.push(["AC",e,t,n,r,i,!!o])}},{key:"arcTo",value:function(e,t,n,r,i){this.segments.push(["AT",e,t,n,r,i])}},{key:"ellipse",value:function(e,t,n,r,i,o,a,s){this.segments.push(["E",e,t,n,r,i,o,a,!!s])}},{key:"closePath",value:function(){this.segments.push(["Z"])}},{key:"bezierCurveTo",value:function(e,t,n,r,i,o){this.segments.push(["C",e,t,n,r,i,o])}},{key:"quadraticCurveTo",value:function(e,t,n,r){this.segments.push(["Q",e,t,n,r])}},{key:"rect",value:function(e,t,n,r){this.segments.push(["R",e,t,n,r])}}])&&o(e.prototype,t),e}(),n=e.CanvasRenderingContext2D.prototype.fill,r=e.CanvasRenderingContext2D.prototype.stroke;e.CanvasRenderingContext2D.prototype.fill=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i="nonzero";0===t.length||1===t.length&&"string"==typeof t[0]?n.apply(this,t):(2===arguments.length&&(i=t[1]),c(this,t[0].segments),n.call(this,i))},e.CanvasRenderingContext2D.prototype.stroke=function(e){e?(c(this,e.segments),r.call(this)):r.call(this)};var s=e.CanvasRenderingContext2D.prototype.isPointInPath;e.CanvasRenderingContext2D.prototype.isPointInPath=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if("Path2D"===t[0].constructor.name){var r=t[1],i=t[2],o=t[3]||"nonzero";return c(this,t[0].segments),s.apply(this,[r,i,o])}return s.apply(this,t)},e.Path2D=t}function c(e,t){var n,r,i,o,a,s,c,h,d,f,p,v,g,_,y,m,E,b,T,C,S,w,R,A,O,M,k,I,x,N={x:0,y:0},P={x:0,y:0};e.beginPath();for(var L=0;L<t.length;++L){var D=t[L];switch("S"!==(C=D[0])&&"s"!==C&&"C"!==C&&"c"!==C&&(w=null,R=null),"T"!==C&&"t"!==C&&"Q"!==C&&"q"!==C&&(A=null,O=null),C){case"m":case"M":"m"===C?(p+=D[1],g+=D[2]):(p=D[1],g=D[2]),"M"!==C&&N||(N={x:p,y:g}),e.moveTo(p,g);break;case"l":p+=D[1],g+=D[2],e.lineTo(p,g);break;case"L":p=D[1],g=D[2],e.lineTo(p,g);break;case"H":p=D[1],e.lineTo(p,g);break;case"h":p+=D[1],e.lineTo(p,g);break;case"V":g=D[1],e.lineTo(p,g);break;case"v":g+=D[1],e.lineTo(p,g);break;case"a":case"A":"a"===C?(p+=D[6],g+=D[7]):(p=D[6],g=D[7]),m=D[1],E=D[2],c=D[3]*Math.PI/180,i=!!D[4],o=!!D[5],a={x:p,y:g},u(s={x:(P.x-a.x)/2,y:(P.y-a.y)/2},-c),(h=s.x*s.x/(m*m)+s.y*s.y/(E*E))>1&&(m*=h=Math.sqrt(h),E*=h),d=m*m*E*E,f=m*m*s.y*s.y+E*E*s.x*s.x,l(S={x:m*s.y/E,y:-E*s.x/m},o!==i?Math.sqrt((d-f)/f)||0:-Math.sqrt((d-f)/f)||0),r=Math.atan2((s.y-S.y)/E,(s.x-S.x)/m),n=Math.atan2(-(s.y+S.y)/E,-(s.x+S.x)/m),u(S,c),k=S,I=(a.x+P.x)/2,x=(a.y+P.y)/2,k.x+=I,k.y+=x,e.save(),e.translate(S.x,S.y),e.rotate(c),e.scale(m,E),e.arc(0,0,1,r,n,!o),e.restore();break;case"C":w=D[3],R=D[4],p=D[5],g=D[6],e.bezierCurveTo(D[1],D[2],w,R,p,g);break;case"c":e.bezierCurveTo(D[1]+p,D[2]+g,D[3]+p,D[4]+g,D[5]+p,D[6]+g),w=D[3]+p,R=D[4]+g,p+=D[5],g+=D[6];break;case"S":null!==w&&null!==w||(w=p,R=g),e.bezierCurveTo(2*p-w,2*g-R,D[1],D[2],D[3],D[4]),w=D[1],R=D[2],p=D[3],g=D[4];break;case"s":null!==w&&null!==w||(w=p,R=g),e.bezierCurveTo(2*p-w,2*g-R,D[1]+p,D[2]+g,D[3]+p,D[4]+g),w=D[1]+p,R=D[2]+g,p+=D[3],g+=D[4];break;case"Q":A=D[1],O=D[2],p=D[3],g=D[4],e.quadraticCurveTo(A,O,p,g);break;case"q":A=D[1]+p,O=D[2]+g,p+=D[3],g+=D[4],e.quadraticCurveTo(A,O,p,g);break;case"T":null!==A&&null!==A||(A=p,O=g),A=2*p-A,O=2*g-O,p=D[1],g=D[2],e.quadraticCurveTo(A,O,p,g);break;case"t":null!==A&&null!==A||(A=p,O=g),A=2*p-A,O=2*g-O,p+=D[1],g+=D[2],e.quadraticCurveTo(A,O,p,g);break;case"z":case"Z":p=N.x,g=N.y,N=void 0,e.closePath();break;case"AC":p=D[1],g=D[2],y=D[3],r=D[4],n=D[5],M=D[6],e.arc(p,g,y,r,n,M);break;case"AT":v=D[1],_=D[2],p=D[3],g=D[4],y=D[5],e.arcTo(v,_,p,g,y);break;case"E":p=D[1],g=D[2],m=D[3],E=D[4],c=D[5],r=D[6],n=D[7],M=D[8],e.save(),e.translate(p,g),e.rotate(c),e.scale(m,E),e.arc(0,0,1,r,n,M),e.restore();break;case"R":p=D[1],g=D[2],b=D[3],T=D[4],N={x:p,y:g},e.rect(p,g,b,T)}P.x=p,P.y=g}}};"undefined"!=typeof window&&c(window);var h={path2dPolyfill:c,parsePath:i};e.default=h,Object.defineProperty(e,"__esModule",{value:!0})},n(t)}));function s(e,t,n,r,i){var o=e.getTransform();0===o.b&&0===o.c?t===r?l(e,t,n,i):n===i&&u(e,t,r,n):c(e,t,n,r,i)}function u(n,r,i,o,a){void 0===a&&(a=e.Operation.plus);var s=n.lineWidth;if(s){var u=t.transformMatrix(n);r=Math.round(u.mapPointX(r,0)),i=Math.round(u.mapPointX(i,0)),n.setTransform(1,0,0,1,0,0);var l=Math.round(s*u.d);o=Math.round(u.mapPointY(0,o)),o+=a*l/2,n.lineWidth=l,c(n,r,o,i,o),n.setTransform(u.a,u.b,u.c,u.d,u.e,u.f),n.lineWidth=s}}function l(n,r,i,o,a){void 0===a&&(a=e.Operation.plus);var s=n.lineWidth;if(s){var u=t.transformMatrix(n);i=Math.round(u.mapPointY(0,i)),o=Math.round(u.mapPointY(0,o)),n.setTransform(1,0,0,1,0,0);var l=Math.round(s*u.a);r=Math.round(u.mapPointX(r,0)),r+=a*l/2,n.lineWidth=l,c(n,r,i,r,o),n.setTransform(u.a,u.b,u.c,u.d,u.e,u.f),n.lineWidth=s}}function c(e,t,n,r,i){e.beginPath(),e.moveTo(t,n),e.lineTo(r,i),e.stroke()}function h(e,t){var n=new Path2D;return n.moveTo(e.x,e.y),n.lineTo(t.x,t.y),n}function d(e){var t=new Path2D;return t.rect(e.x,e.y,e.width,e.height),t}function f(e,t,n){if(e.x===t.x&&e.x===n.x)throw new Error("a triangle should not pass three point with same x");if(e.y===t.y&&e.y===n.y)throw new Error("a triangle should not pass three point with same y");return new Path2D("M".concat(e.x," ").concat(e.y," L ").concat(t.x," ").concat(t.y," L ").concat(n.x," ").concat(n.y," Z"))}function p(e,t){return v(e,t,0,2*Math.PI)}function v(e,t,n,r){var i=new Path2D;return i.arc(e.x,e.y,t,n,r),i}r(a),e.Operation=void 0,(o=e.Operation||(e.Operation={}))[o.plus=1]="plus",o[o.subtract=-1]="subtract";var g=function(){function e(e,t,n,r,i,o){void 0===e&&(e=1),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=1),void 0===i&&(i=0),void 0===o&&(o=0),this.a=e,this.b=t,this.c=n,this.d=r,this.e=i,this.f=o}return Object.defineProperty(e.prototype,"scaleX",{get:function(){return this.a},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleY",{get:function(){return this.d},enumerable:!1,configurable:!0}),e.prototype.transform=function(e,t,n,r,i,o){var a=this.a*e+this.c*t,s=this.b*e+this.d*t,u=this.a*n+this.c*r,l=this.b*n+this.d*r,c=this.e+this.a*i+this.c*o,h=this.f+this.b*i+this.d*o;return this.a=a,this.b=s,this.c=u,this.d=l,this.e=c,this.f=h,this},e.prototype.translate=function(e,t){return this.e+=e*this.a+t*this.c,this.f+=e*this.b+t*this.d,this},e.prototype.rotate=function(e){var t=Math.cos(e),n=Math.sin(e);return this.transform(t,n,-n,t,0,0),this},e.prototype.scale=function(e,t){return this.transform(e,0,0,t,0,0),this},e.prototype.skew=function(e,t){return this.transform(1,Math.tan(e),Math.tan(t),1,0,0),this},e.prototype.rotateAround=function(e,t,n){return this.translate(t,n).rotate(e).translate(-t,-n)},e.prototype.scaleWithCenter=function(e,t,n,r){return this.translate(n,r).scale(e,t).translate(-n,-r)},e.prototype.mapPoint=function(e){var t=e.x,n=e.y;return e.x=this.mapPointX(t,n),e.y=this.mapPointY(t,n),e},e.prototype.mapPointX=function(e,t){return this.a*e+this.c*t+this.e},e.prototype.mapPointY=function(e,t){return this.b*e+this.d*t+this.f},e.prototype.inversePoint=function(e){var t=e.x,n=e.y;return e.x=this.inversePointX(t,n),e.y=this.inversePointY(t,n),e},e.prototype.inversePointX=function(e,t){return(this.d*e-this.c*t+this.c*this.f-this.e*this.d)/(this.a*this.d-this.c*this.b)},e.prototype.inversePointY=function(e,t){return(this.a*t-this.b*e+this.b*this.e-this.a*this.f)/(this.a*this.d-this.b*this.c)},e.prototype.roundPoint=function(e){return this.mapPoint(e).rounds(),this.inversePoint(e),e},e.prototype.mapRect=function(e){var t=this.mapPointX(e.x,e.y),n=this.mapPointX(e.x,e.maxY),r=this.mapPointX(e.maxX,e.y),i=this.mapPointX(e.maxX,e.maxY),o=this.mapPointY(e.x,e.y),a=this.mapPointY(e.x,e.maxY),s=this.mapPointY(e.maxX,e.y),u=this.mapPointY(e.maxX,e.maxY),l=Math.min(t,n,r,i),c=Math.max(t,n,r,i),h=Math.min(o,a,s,u),d=Math.max(o,a,s,u);return e.x=l,e.y=h,e.width=c-l,e.height=d-h,e},e.prototype.roundRect=function(e){return this.mapRect(e).rounds(),this.inverseRect(e),e},e.prototype.inverseRect=function(e){var t=this.inversePointX(e.x,e.y),n=this.inversePointX(e.x,e.maxY),r=this.inversePointX(e.maxX,e.y),i=this.inversePointX(e.maxX,e.maxY),o=this.inversePointY(e.x,e.y),a=this.inversePointY(e.x,e.maxY),s=this.inversePointY(e.maxX,e.y),u=this.inversePointY(e.maxX,e.maxY),l=Math.min(t,n,r,i),c=Math.max(t,n,r,i),h=Math.min(o,a,s,u),d=Math.max(o,a,s,u);return e.x=l,e.y=h,e.width=c-l,e.height=d-h,e},e.prototype.clone=function(){var t=new e;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.e=this.e,t.f=this.f,t},e.prototype.reset=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this},e}();function _(e){var t=e.getTransform();return new g(t.a,t.b,t.c,t.d,t.e,t.f)}function y(e,t){var n=_(e);0!==n.b||0!==n.c?e.rect(t.x,t.y,t.width,t.height):(t=t.clone(),n.mapRect(t).roundsBoundary(),e.setTransform(1,0,0,1,0,0),e.rect(t.x,t.y,t.width,t.height),e.setTransform(n.a,n.b,n.c,n.d,n.e,n.f))}function m(e,t,n){var r=_(e);0!==r.b||0!==r.c?null!=n?(e.fillStyle=n,e.fillRect(t.x,t.y,t.width,t.height)):e.clearRect(t.x,t.y,t.width,t.height):(t=t.clone(),r.mapRect(t).roundsBoundary(),e.setTransform(1,0,0,1,0,0),null!=n?(e.fillStyle=n,e.fillRect(t.x,t.y,t.width,t.height)):e.clearRect(t.x,t.y,t.width,t.height),e.setTransform(r.a,r.b,r.c,r.d,r.e,r.f))}function E(e,t,n,r){n<=0||(e.save(),e.lineWidth=n,r&&(e.strokeStyle=r),s(e,t.x,t.y,t.maxX,t.y),s(e,t.maxX-n,t.y,t.maxX-n,t.maxY),s(e,t.maxX,t.maxY-n,t.x,t.maxY-n),s(e,t.x,t.maxY,t.x,t.y),e.restore())}var b=function(){function n(){this.t=new t.TMatrix,this.lineWidth=1}return n.prototype.start=function(e,n,r,i){void 0===n&&(n=1),void 0===i&&(i="horizon"),this.t=t.transformMatrix(e),e.setTransform(1,0,0,1,0,0),this.lineWidth=Math.round(n*("horizon"===i?this.t.d:this.t.a)),this.lineWidth<1&&(this.lineWidth=1),e.lineWidth=this.lineWidth,r&&(e.fillStyle=r),e.beginPath()},n.prototype.end=function(e){e.setTransform(this.t.a,this.t.b,this.t.c,this.t.d,this.t.e,this.t.f)},n.prototype.continueDrawline=function(t,n,r,i,o,a,s){void 0===a&&(a=e.Operation.plus),s&&t.fillStyle!==s&&(t.fillStyle=s);var u=a===e.Operation.plus?0:-this.lineWidth;n===i?(r=Math.round(this.t.mapPointY(0,r)),o=Math.round(this.t.mapPointY(0,o)),t.fillRect(Math.round(this.t.mapPointX(n,0))+u,r,this.lineWidth,o-r)):r===o&&(n=Math.round(this.t.mapPointX(n,0)),i=Math.round(this.t.mapPointX(i,0)),t.fillRect(n,Math.round(this.t.mapPointY(0,r))+u,i-n,this.lineWidth))},n}(),T=function(){function e(){this.t=new t.TMatrix}return e.prototype.start=function(e,n){this.t=t.transformMatrix(e),e.setTransform(1,0,0,1,0,0),n&&(e.fillStyle=n),e.beginPath()},e.prototype.end=function(e){e.setTransform(this.t.a,this.t.b,this.t.c,this.t.d,this.t.e,this.t.f)},e.prototype.continueFillRect=function(e,n,r,i){r&&e.fillStyle!==r&&(e.fillStyle=r),this.t.mapRect(n).roundsBoundary();var o=i&&i.radius;if(o)return t.paintRoundedRectangle(e,n.x,n.y,n.width,n.height,e.fillStyle,o);e.fillRect(n.x,n.y,n.width,n.height)},e}();e.ContinuouslyDrawBorder=b,e.ContinuouslyFillRect=T,e.circles=p,e.circlesArc=v,e.drawLine=c,e.lineTo=h,e.preciseClearRect=m,e.preciseDrawLine=s,e.preciseHorizontal=u,e.preciseRect=y,e.preciseStrokeRect=E,e.preciseVertical=l,e.retangles=d,e.triangle=f,Object.defineProperty(e,"__esModule",{value:!0})}(t,n("vsh_33916"))},vsh_84784:function(e,t){!function(e){"use strict";var t=function(){function e(e){this.value=e,this.UTCDate=null,this.setValue(e)}return e.fromNumber=function(t){return new e(t)},e.fromString=function(t){var n=new Date(t);return Number.isFinite(n.getTime())?e.fromLocalDate(n):null},e.from=function(t){var n=t.year,r=void 0===n?0:n,i=t.month,o=void 0===i?0:i,a=t.date,s=void 0===a?0:a,u=t.hours,l=void 0===u?0:u,c=t.minutes,h=void 0===c?0:c,d=t.seconds,f=void 0===d?0:d,p=t.milliseconds,v=void 0===p?0:p,g=Date.UTC(r,o-1,s,l,h,f,v);return e.fromUTCDate(g)},e.fromUTCDate=function(t){var n=e.getTimeFromDate(t);return new e((n-e.BASE_MILLISECONDS)/e.DAY_MILLISECONDS)},e.fromLocalDate=function(t){var n=e.getTimeFromDate(t),r=e.getTimezoneOffsetFromDate(t);return e.fromUTCDate(n-60*r*1e3)},e.getTimeFromDate=function(e){return"number"==typeof e?e:e.getTime()},e.getTimezoneOffsetFromDate=function(e){return"number"==typeof e?new Date(e).getTimezoneOffset():e.getTimezoneOffset()},e.prototype.toNumber=function(){return this.value},e.prototype.clone=function(){return e.fromNumber(this.value)},e.prototype.getUTCDate=function(){return this.UTCDate||(this.UTCDate=new Date(Math.round(e.BASE_MILLISECONDS+this.value*e.DAY_MILLISECONDS))),this.UTCDate},Object.defineProperty(e.prototype,"day",{get:function(){return this.getUTCDate().getUTCDay()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"year",{get:function(){return this.time.year},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"month",{get:function(){return this.time.month},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"date",{get:function(){return this.time.date},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hours",{get:function(){return this.time.hours},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minutes",{get:function(){return this.time.minutes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"seconds",{get:function(){return this.time.seconds},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"milliseconds",{get:function(){return this.time.milliseconds},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"time",{get:function(){var e=this.getUTCDate();return{year:e.getUTCFullYear(),month:e.getUTCMonth()+1,date:e.getUTCDate(),hours:e.getUTCHours(),minutes:e.getUTCMinutes(),seconds:e.getUTCSeconds(),milliseconds:e.getUTCMilliseconds()}},enumerable:!1,configurable:!0}),e.prototype.setValue=function(e){this.value=e,this.UTCDate=null},e.prototype.setDateTime=function(t){var n=Object.assign(this.time,t);this.setValue(e.from(n).value)},e.MIN_DATE_VALUE=0,e.MAX_DATE_VALUE=2958465,e.DAY_MILLISECONDS=864e5,e.BASE_MILLISECONDS=Date.UTC(1899,11,30),e}();function n(e){return e%4==0&&e%100!=0||e%400==0}function r(e,t){return new Date(Date.UTC(e,t,0)).getUTCDate()}function i(e,t){return Math.ceil(t.toNumber()-e.toNumber())}e.SheetDate=t,e.daysBetween=i,e.getDaysOfMonth=r,e.isLeapYear=n,Object.defineProperty(e,"__esModule",{value:!0})}(t)},vsh_99343:function(e,t){!function(e){"use strict";function t(e){return Array.isArray(e)?e:[e]}function n(e,t){if(Array.isArray(t))for(var n=0;n<t.length;n++)e.push(t[n]);else e.push(t)}
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(e){function t(n,r,i){var o=this,a={op1:JSON.stringify(n),op2:JSON.stringify(r),isCover:i};return(o=e.call(this,"Follow Conflict: "+JSON.stringify(a))||this).info=a,Object.setPrototypeOf(o,t.prototype),o}return i(t,e),t}(Error);function a(e,r,i,s){for(var u=[],l=0;l<e.length;l++){for(var c=e[l],h=[],d=0;d<r.length;d++){var f=r[d],p=i(c,f,!1);if(!1===p)throw new o(c,f,!1);var v=i(f,c,!0);if(!1===v)throw new o(f,c,!0);var g=null!=v?t(v):[];if("function"==typeof s&&(g=g.filter(s)),null!=p&&n(h,t(p)),1!==g.length){if(0===g.length){for(var _=d+1;_<r.length;_++)h.push(r[_]);c=null;break}var y=a(g,r.slice(d+1),i);n(u,y[0]),n(h,y[1]),c=null;break}c=g[0]}null!=c&&u.push(c),r=h}return[u,r]}function s(e,n,r,i,s){if(0===e.length||0===n.length)return n;if(1===e.length&&1===n.length){var u=i(e[0],n[0],r);if(!1===u)throw new o(e[0],n[0],r);return null!=u?t(u):[]}return r?a(n,e,i)[0]:a(e,n,i,s)[1]}function u(e,t,n){return e<t?t+1:n||e!==t?t:t+1}function l(e,t,n){return e<=t?t+1:t}function c(e,t,n,r){return e<=t&&(t+=1),e<=n&&(n+=1),t===n?null:{source:t,target:n}}function h(e,t,n){return e<t?t-1:t}function d(e,t,n){return e<t?t-1:e===t?null:t}function f(e,t,n,r){var i=t,o=n;return t==e?null:(t>e&&(i-=1),(t>n?n-1:n)>e-1&&(o-=1),i===o?null:{source:i,target:o})}function p(e,t,n,r){return e<n&&n<=t?n-1:t<n&&n<=e?n+1:n}function v(e,t,n,r){return e===n?t:e<n&&n<=t?n-1:t<=n&&n<e?n+1:n}function g(e,t,n,r,i){if(e===n)return i||t===r?null:{source:t,target:r};var o=n,a=r;e<n&&n<=t&&(o=n-1),t<=n&&n<e&&(o=n+1);var s=e>t?t-1:t,u=n>r?r-1:r;return e>t?s<u&&u<e?a+=1:i||s!==u||(a+=1):(e<=u&&u<s||i&&s===u)&&(a-=1),o===a?null:{source:o,target:a}}e.FollowException=o,e.addFollowAdd=u,e.addFollowDelete=l,e.addFollowMove=c,e.deleteFollowAdd=h,e.deleteFollowDelete=d,e.deleteFollowMove=f,e.follow=s,e.moveFollowAdd=p,e.moveFollowDelete=v,e.moveFollowMove=g,Object.defineProperty(e,"__esModule",{value:!0})}(t)},vsh_8073:function(e,t){!function(e){"use strict";var t,n,r=function(){function e(){this._idleCallbackList=[],this._id=0,this._idleStartTime=0,this._isRunning=!1,this.threshold=200}return e.prototype.nextTick=function(e){this.setTimer(e)},e.prototype.registerIdleCallback=function(e){this._idleCallbackList.push(e),this._isRunning||this.nextTick(this._handle.bind(this))},e.prototype.unRegisterIdleCallback=function(e){var t=this._idleCallbackList.indexOf(e);t>-1&&this._idleCallbackList.splice(t,1),0===this._idleCallbackList.length&&this._stop()},e.prototype._handle=function(){this._id=0,this._isRunning=!1,this._checkIdle()?this._handleIdleCallback():this._poll()},e.prototype._checkIdle=function(){return this.isIdle?(0===this._idleStartTime&&(this._idleStartTime=this.getCurrentTime()),!(this.getCurrentTime()-this._idleStartTime<this.threshold)):(this._idleStartTime=0,!1)},e.prototype._handleIdleCallback=function(){0!==this._idleCallbackList.length&&(this._isRunning=!0,this._idleCallbackList.shift()(),0!==this._idleCallbackList.length?this.nextTick(this._handle.bind(this)):this._isRunning=!1)},e.prototype._poll=function(){0!==this._id||this._isRunning||(this._id=this.setTimer(this._handle.bind(this)))},e.prototype._stop=function(){0!==this._id&&(this.cancelTimer(this._id),this._id=0)},e}();(n=e.TaskState||(e.TaskState={}))[n.RUNNING=0]="RUNNING",n[n.FINISHED=1]="FINISHED",(t=e.Direction||(e.Direction={})).HEAD="unshift",t.FOOT="push";var i=function(){function t(t,n,r){var i=this;void 0===n&&(n=16),void 0===r&&(r=e.Direction.FOOT),this._idle=t,this.runTime=n,this.direction=r,this._tasks=[],this._isRunning=!1,this._idleCallback=function(){var t=i._idle.getCurrentTime();try{do{var n=i._tasks.shift();if(!n)break;n.run.call(n.context)!==e.TaskState.FINISHED&&i._tasks[i.direction](n)}while(i._idle.getCurrentTime()-t<i.runTime)}finally{i._isRunning=!1,i._run()}}}return t.prototype.add=function(e){this._tasks.push(e),this._run()},t.prototype.remove=function(e){for(var t=this._tasks.length-1;t>=0;t--)e===this._tasks[t]&&this._tasks.splice(t,1);this._run()},t.prototype.removeAll=function(){this._tasks.length=0,this._isRunning=!1,this._idle.unRegisterIdleCallback(this._idleCallback)},t.prototype._run=function(){if(!this._isRunning){if(0===this._tasks.length)return this._isRunning=!1,void this._idle.unRegisterIdleCallback(this._idleCallback);this._isRunning=!0,this._idle.registerIdleCallback(this._idleCallback)}},t}(),o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},o(e,t)};
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */function a(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s=function(){function e(){}return e.fromArray=function(e){return new u(e)},e.prototype.enumerate=function(){return new d(this)},e.prototype.map=function(e){return new l(this,e)},e.prototype.filter=function(e){return new c(this,e)},e.prototype.chain=function(e){return new f(this,e)},e.prototype.flatten=function(){return new g(this)},e.prototype.merge=function(e){return new p(this,e)},e.prototype.do=function(e){return new h(this,e)},e.prototype.first=function(){return this.next()},e.prototype.first_if=function(e){var t=null;do{t=this.next()}while(null!==t&&!e(t));return t},e.prototype.exitWhen=function(e){return new v(this,e)},e.prototype.nonBlocking=function(e,t){return void 0===t&&(t=1),new _(this,e,t)},e.prototype.flatten_promise=function(){return new y(this)},e.prototype.reduce=function(e,t){return this.loop(e,t)},e.prototype.forEach=function(e){this.loop(e)},e.prototype.loop=function(e,t){for(var n=this.next();null!==n;n=this.next())t=e(n,t);return t},e}(),u=function(e){function t(t){var n=e.call(this)||this;return n._arr=t,n._idx=-1,n}return a(t,e),t.prototype.next=function(){return++this._idx,this._idx<this._arr.length?this._arr[this._idx]:null},t}(s),l=function(e){function t(t,n){var r=e.call(this)||this;return r._iter=t,r._mapFunc=n,r}return a(t,e),t.prototype.next=function(){var e=this._iter.next();return null===e?null:this._mapFunc(e)},t}(s),c=function(e){function t(t,n){var r=e.call(this)||this;return r._iter=t,r._filterFunc=n,r}return a(t,e),t.prototype.next=function(){var e=null;do{e=this._iter.next()}while(null!==e&&!this._filterFunc(e));return e},t}(s),h=function(e){function t(t,n){var r=e.call(this)||this;return r._iter=t,r._doFunc=n,r}return a(t,e),t.prototype.next=function(){var e=this._iter.next();return null!==e&&this._doFunc(e),e},t}(s),d=function(e){function t(t){var n=e.call(this)||this;return n._iter=t,n._count=0,n}return a(t,e),t.prototype.next=function(){var e=this._iter.next();return null===e?null:[e,this._count++]},t}(s),f=function(e){function t(t,n){var r=e.call(this)||this;return r._iter1=t,r._iter2=n,r._firstIter=!0,r}return a(t,e),t.prototype.next=function(){if(this._firstIter){var e=this._iter1.next();return null===e?(this._firstIter=!1,this._iter2.next()):e}return this._iter2.next()},t}(s),p=function(e){function t(t,n){var r=e.call(this)||this;return r._iter1=t,r._iter2=n,r}return a(t,e),t.prototype.next=function(){var e=this._iter1.next(),t=this._iter2.next();return null!==e||null!==t?[e,t]:null},t}(s),v=function(e){function t(t,n){var r=e.call(this)||this;return r._iter=t,r._predicate=n,r}return a(t,e),t.prototype.next=function(){var e=this._iter.next();return null!==e&&this._predicate(e)?null:e},t}(s),g=function(e){function t(t){var n=e.call(this)||this;return n._iter=t,n._innerIter=t.next(),n}return a(t,e),t.prototype.next=function(){if(null===this._innerIter)return null;var e=this._innerIter.next();return null===e?(this._innerIter=this._iter.next(),this.next()):e},t}(s),_=function(){function t(e,t,n){void 0===n&&(n=1),this._iter=e,this._scheduler=t,this._iteratorNum=n,this._task=null}return t.prototype.next=function(){return this._iter.next()},t.prototype.abort=function(e){void 0===e&&(e="abort"),this._task&&(this._scheduler.remove(this._task),this._task.reject(e),this._task=null)},t.prototype.task=function(){return this._task},t.prototype.reduce=function(e,t){return this.loop(e,t)},t.prototype.forEach=function(e){return this.loop(e)},t.prototype.first_if=function(t){var n=this;return new Promise((function(r,i){var o={run:function(){try{for(var o=0;o<n._iteratorNum;++o){var a=n.next();if(null===a||t(a))return n._task=null,r(a),e.TaskState.FINISHED}return e.TaskState.RUNNING}catch(t){return i(t),e.TaskState.FINISHED}},reject:i};n._task=o,n._scheduler.add(o)}))},t.prototype.loop=function(t,n){var r=this;return new Promise((function(i,o){var a={run:function(){try{for(var a=0;a<r._iteratorNum;++a){var s=r.next();if(null===s)return r._task=null,i(n),e.TaskState.FINISHED;n=t(s,n)}return e.TaskState.RUNNING}catch(t){return o(t),e.TaskState.FINISHED}},reject:o};r._task=a,r._scheduler.add(a)}))},t}(),y=function(){function e(e){this._iter=e}return e.prototype.next=function(){return this._iter.next()},e.prototype.reduce=function(e,t){return this.loop(e,t)},e.prototype.forEach=function(e){return this.loop(e)},e.prototype.loop=function(e,t){var n,r=this;for(n=this.next();null!==n;n=this.next()){if(n instanceof Promise)return n.then((function(n){return t=e(n,t),r.loop(e,t)}));t=e(n,t)}return t},e}();e.ArrayIter=u,e.ChainIterator=f,e.DoIterator=h,e.Enumerate=d,e.ExitWhenIterator=v,e.FIdleScheduler=i,e.FIterator=s,e.FilterIterator=c,e.FlattenIterator=g,e.FlattenPromise=y,e.Idle=r,e.MapIterator=l,e.MergeIterator=p,e.NonBlockIterator=_,Object.defineProperty(e,"__esModule",{value:!0})}(t)},vsh_86670:function(e,t,n){!function(e,t){"use strict";var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},n(e,t)};function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i,o=function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)};function a(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function s(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function u(e){var n,r,i=0,o=0,s=function(e){var t=null;if(e.exitWhen((function(e){var n=e.isError();return n&&(t=e),n})).filter((function(e){return e.isNumber()})).forEach((function(e){i+=e.getValue(),o++})),t)return{value:t}};try{for(var u=a(e()),l=u.next();!l.done;l=u.next()){var c=s(l.value);if("object"==typeof c)return c.value}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}return 0===o?t.tractorErrorVarCreators[t.ErrorCode.DIVIDE_BY_ZERO_FROM_FUNCTION_EVAL]({funcName:""}):new t.NumberVar(i/o)}function l(e){var n,r,i=0,o=function(e){var t=null;if(e.exitWhen((function(e){return!!e.isError()&&(t=e,!0)})).forEach((function(e){e.isNumber()&&(i+=e.getValue())})),t)return{value:t}};try{for(var s=a(e()),u=s.next();!u.done;u=s.next()){var l=o(u.value);if("object"==typeof l)return l.value}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return new t.NumberVar(i)}function c(t,n){if(void 0===n&&(n=10),!m(t))return Number.NaN;if(t.length===n&&"1"===t[0]){if(t==="1".padEnd(n,"0"))return-(Number(e.BIN_PREFIX+"1".repeat(n-1))+1);var r=y(t,n).slice(e.BIN_PREFIX.length+1);return""===r?Number.NaN:-Number(e.BIN_PREFIX+r)}return parseInt(t,2)}function h(t,n){return void 0===n&&(n=10),m(t)?(t.length===n&&"1"===t[0]&&(t=t.padStart(3*n,"1")),e.OCT_PREFIX+parseInt(t,2).toString(8)):""}function d(t,n,r){return void 0===n&&(n=10),void 0===r&&(r=10),m(t)?(t.length===n&&"1"===t[0]&&(t=t.padStart(4*r,"1")),e.HEX_PREFIX+parseInt(t,2).toString(16).toUpperCase()):""}function f(t,n){if(void 0===n&&(n=10),!T(t.toString(10)))return"";if(t<0){var r=S(Math.abs(t),n-1);if(!Number.isFinite(r))return"";var i=r+1;return"".concat(e.BIN_PREFIX,"1").concat(C(i.toString(2),n-1))}return e.BIN_PREFIX+t.toString(2)}function p(t,n){if(void 0===n&&(n=10),!E(t))return"";var r=parseInt(t,8).toString(2);return e.BIN_PREFIX+r.slice(-n)}function v(t,n){if(void 0===n&&(n=10),!b(t))return"";var r=parseInt(t,16).toString(2);return e.BIN_PREFIX+r.slice(-n)}function g(t,n){if(void 0===n&&(n=10),!m(t))return"";var r=(t=C(t,n)).slice(0,1);if("0"===r)return e.BIN_PREFIX+t;t=t.slice(1);var i=S(Number("".concat(e.BIN_PREFIX+t)),n-1);if(!Number.isFinite(i))return"";var o=i.toString(2);return e.BIN_PREFIX+r+C(o,n-1)}function _(t,n){if(void 0===n&&(n=10),!m(t))return"";var r=(t=C(t)).slice(0,1);if("0"===r)return e.BIN_PREFIX+t;t=t.slice(1);var i=(Number("".concat(e.BIN_PREFIX+t))^Number(e.BIN_PREFIX+"1".repeat(n-1))).toString(2);return e.BIN_PREFIX+r+C(i,n-1)}function y(t,n){if(void 0===n&&(n=10),!m(t))return"";if("0"===(t=C(t,n)).slice(0,1))return e.BIN_PREFIX+t;var r=Number(g(t,n))+1;return Number.isFinite(r)?e.BIN_PREFIX+C(r.toString(2),n):""}function m(e){return/^(0|1)+$/.test(e)}function E(e){return/^([0-7])+$/.test(e)}function b(e){return/^([0-9A-F])+$/i.test(e)}function T(e){return/^(-|\+)?([0-9])+$/.test(e)}function C(e,t){return void 0===t&&(t=10),e.length>=t?e:e.padStart(t,"0")}function S(t,n){if(void 0===n&&(n=10),n<=0)return Number.NaN;if(n>31){for(var r=t.toString(2).padStart(n,"0"),i="",o=0;o<n;o++)i+="1"===r[o]?"0":"1";return Number(e.BIN_PREFIX+i)}return t^Number(e.BIN_PREFIX+"1".repeat(n))}function w(e,t,n){var r=0;return 0<e&&.02425>e?r=(((((-.007784894002430293*(e=Math.sqrt(-2*Math.log(e)))-.3223964580411365)*e-2.400758277161838)*e-2.549732539343734)*e+4.374664141464968)*e+2.938163982698783)/((((.007784695709041462*e+.3224671290700398)*e+2.445134137142996)*e+3.754408661907416)*e+1):.02425<=e&&.97575>=e?r=(((((-39.69683028665376*(r=(e-=.5)*e)+220.9460984245205)*r-275.9285104469687)*r+138.357751867269)*r-30.66479806614716)*r+2.506628277459239)*e/(((((-54.47609879822406*r+161.5858368580409)*r-155.6989798598866)*r+66.80131188771972)*r-13.28068155288572)*r+1):.97575<e&&1>e&&(r=-(((((-.007784894002430293*(e=Math.sqrt(-2*Math.log(1-e)))-.3223964580411365)*e-2.400758277161838)*e-2.549732539343734)*e+4.374664141464968)*e+2.938163982698783)/((((.007784695709041462*e+.3224671290700398)*e+2.445134137142996)*e+3.754408661907416)*e+1)),r*n+t}function R(e){var t,n,r;return n=0===e?0:(r=.5*Math.abs(e))>=3?1:r<1?((((((((.000124818987*(t=r*r)-.001075204047)*t+.005198775019)*t-.019198292004)*t+.059054035642)*t-.151968751364)*t+.319152932694)*t-.5319230073)*t+.797884560593)*r*2:(((((((((((((-45255659e-12*(r-=2)+.00015252929)*r-19538132e-12)*r-.000676904986)*r+.001390604284)*r-.00079462082)*r-.002034254874)*r+.006549791214)*r-.010557625006)*r+.011630447319)*r-.009279453341)*r+.005353579108)*r-.002141268741)*r+.000535310849)*r+.999936657524,e>0?.5*(n+1):.5*(1-n)}function A(e,t,n){var r=-Math.pow(e-t,2)/2/Math.pow(n,2);return 1/n/Math.sqrt(2*Math.PI)*Math.exp(r)}function O(e){var t,n,r,i,o,a,s=1,u=[1,.5772156649015329,-.6558780715202538,-.0420026350340952,.1665386113822915,-.0421977345555443,-.009621971527877,.007218943246663,-.0011651675918591,-.0002152416741149,.0001280502823882,-201348547807e-16,-12504934821e-16,1133027232e-15,-2.056338417e-7,6.116095e-9,5.0020075e-9,-1.1812746e-9,1.043427e-10,77823e-16,-36968e-16,51e-14,-206e-16,-54e-16,14e-16];if(e>171)return 1e308;if(e===Math.trunc(e))if(e>0)for(i=1,t=2;t<e;t++)i*=t;else i=1e308;else{if(Math.abs(e)>1){for(a=Math.abs(e),r=Math.trunc(a),s=1,n=1;n<=r;n++)s*=a-n;a-=r}else a=e;for(o=u[24],n=23;n>=0;n--)o=o*a+u[n];i=1/(o*a),Math.abs(e)>1&&(i*=s,e<0&&(i=-Math.PI/(e*i*Math.sin(Math.PI*e))))}return i}function M(e){var t=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],n=1.000000000190015,r=e,i=e+5.5;i-=(e+.5)*Math.log(i);for(var o=0;o<=5;o++)n+=t[o]/++r;return-i+Math.log(2.5066282746310007*n/e)}function k(e){var t,n,r,i=[23531376880.41076,42919803642.6491,35711959237.35567,17921034426.03721,6039542586.352028,1439720407.3117216,248874557.86205417,31426415.585400194,2876370.6289353725,186056.26539522348,8071.672002365816,210.82427775157936,2.5066282746310002],o=[0,39916800,120543840,150917976,105258076,45995730,13339535,2637558,357423,32670,1925,66,1];if(e<=1)for(t=i[12],n=o[12],r=11;r>=0;--r)t*=e,t+=i[r],n*=e,n+=o[r];else{var a=1/e;for(t=i[0],n=o[0],r=1;r<=12;++r)t*=a,t+=i[r],n*=a,n+=o[r]}return t/n}function I(e,t,n){var r,i,o,a,s,u,l,c,h,d,f,p,v,g,_=1e37,y=-88,m=1/3;if((e/=n)>1e8)return 1;if(t>1e3)return g=R(((r=3*Math.sqrt(t)*(Math.pow(e/t,m)+1/(9*t)-1))-0)/1);if(e<=1||e<t){g=M(t+1),l=t*Math.log(e)-e-g,c=1,v=1,d=t;do{v+=c=c*e/(d+=1)}while(c>2220446049250313e-31);l+=Math.log(v),v=0,l>=y&&(v=Math.exp(l))}else{for(g=M(t),l=t*Math.log(e)-e-g,c=0,r=1,i=e,v=(o=e+1)/(a=e*(f=(d=1-t)+e+1));;){if(s=(f+=2)*o-(p=(d+=1)*(c+=1))*r,u=f*a-p*i,Math.abs(u)>0){if(h=s/u,Math.abs(v-h)<=Math.min(2220446049250313e-31,2220446049250313e-31*h))break;v=h}r=o,i=a,o=s,a=u,Math.abs(s)>=_&&(r/=_,i/=_,o/=_,a/=_)}l+=Math.log(v),v=1,l>=y&&(v=1-Math.exp(l))}return v}function x(e,t,n){var r,i,o,a,s,u,l,c,h,d,f=4.67,p=6.66,v=6.73,g=13.32,_=60,y=70,m=84,E=105,b=120,T=127,C=140,S=1175,R=210,A=252,O=2264,k=294,x=346,N=420,P=462,L=606,D=672,F=707,B=735,V=889,H=932,U=966,Z=1141,W=1182,j=1278,G=1740,z=2520,Y=5040,X=5e-7,K=.01,q=5e-7,$=20;if(e<2e-6)return 0;if(e>.999998)return 1/0;var J=2*t,Q=t-1,ee=M(t);if(J<-1.24*Math.log(e)){if((o=Math.pow(e*t*Math.exp(ee+.6931471805599453*t),1/t))<X)return NaN}else if(J>.32)h=w(e,0,1),a=.222222/J,(o=J*Math.pow(h*Math.sqrt(a)+1-a,3))>2.2*J+6&&(o=-2*(Math.log(1-e)-Q*Math.log(.5*o)+ee));else{o=.4,r=Math.log(1-e)+ee+.6931471805599453*Q;do{u=o,c=(f+2*o)/(a=1+o*(f+o))-.5-(v+o*(g+3*o))/(s=o*(v+o*(p+o))),o-=(1-Math.exp(r+.5*o)*s/a)/c}while(Math.abs(u/o-1)>K)}for(d=1;d<=$;d++)if(u=o,o+=(c=(s=e-I(a=.5*o,t,1))*Math.exp(.6931471805599453*t+ee+a-Q*Math.log(o)))*(1+.5*c*(l=(R+(r=.5*c-(i=c/o)*Q)*(C+r*(E+r*(m+r*(y+_*r)))))/N)-i*Q*(l-i*((N+r*(B+r*(U+r*(Z+j*r))))/z-i*((R+r*(P+r*(F+H*r)))/z-i*((A+r*(D+W*r)+Q*(k+r*(V+G*r)))/Y-i*((m+O*r+Q*(S+L*r))/z-i*((b+Q*(x+T*Q))/Y))))))),Math.abs(u/o-1)>q)return.5*n*o;return.5*n*o}function N(e,t,n){if(e<=0)return 0;if(e>=1)return 1;if(1===n)return Math.pow(e,t);if(1===t)return-Math.expm1(n*Math.log1p(-e));var r,i=.5-e+.5,o=Math.log1p(-e),a=e,s=Math.log(e),u=t,l=n,c=e>t/(t+n);return c&&(u=n,l=t,a=i,i=e,s=o,o=Math.log(e)),r=F(a,u,l),r/=u,r*=u>1&&l>1&&u/(u+l)<.97&&l/(u+l)<.97?P(a,u,l)*a*i:Math.exp(u*s+l*o-V(!1,u,l)),c&&(r=.5-r+.5),r>1&&(r=1),r<0&&(r=0),r}function P(e,t,n){if(1===t)return 1===n?1:2===n?-2*e+2:e<=.01?n+n*Math.exp((n-1)*Math.log(1-e))-1:n*Math.pow(.5-e+.5,n-1);if(1===n)return 2===t?t*e:t*Math.pow(e,t-1);if(e<=0&&!(t<1&&0===e)||e>=1&&!(n<1&&1===e))return 0;var r=Math.log(L(2)),i=Math.log(L(1)),o=Math.log(1-e),a=(t-1)*Math.log(e),s=(n-1)*o,u=V(!1,t,n);return a<r&&a>i&&s<r&&s>i&&u<r&&u>i&&a+s<r&&a+s>i?Math.pow(e,t-1)*Math.pow(.5-e+.5,n-1)/V(!0,t,n):Math.exp(a+s-u)}function L(e){return[22250738585072014e-324,17976931348623157e292,Math.pow(2,-53),Math.pow(2,-52),D(2,10)][e-1]||0}function D(e,t){return isNaN(e)?e:isNaN(t)?t:1!==t&&1===e||0!==t&&t!==Number.POSITIVE_INFINITY?Math.log(e)/Math.log(t):NaN}function F(e,t,n){var r,i,o,a,s,u,l,c,h,d,f=222045e-21;r=1,i=1,0==(a=1-(t+n)/(t+1)*e)?(o=0,s=1,d=1):d=(o=1)*(s=1/a),h=1;var p=1,v=5e4,g=!1;do{o=(r=(o+(l=p*(n-p)*e/(((u=t+2*p)-1)*u))*r)*s)+(c=-(t+p)*(t+n+p)*e/(u*(u+1)))*o*s,0!=(a=(i=(a+l*i)*s)+c*a*s)&&(h=o*(s=1/a),g=Math.abs(d-h)<Math.abs(d)*f),d=h,p+=1}while(p<v&&!g);return d}function B(e,t,n,r,i){var o,a,s,u,l,c,h,d,f,p,v,g,_,y,m,E,b,T=2.30753,C=.27061,S=.99229,w=.04481,R=3e-308,A=1e-300,O=R,M=1-222e-18,k=5,I=6,x=2,P=e,L=V(!1,t,n);e<=.5?(u=e,d=t,p=n,o=0):(u=1-e,d=n,p=t,o=1),E=(v=Math.sqrt(-Math.log(u*u)))-(T+C*v)/(1+(S+w*v)*v),d>1&&p>1?(v=(E*E-3)/6,h=2/((g=1/(d+d-1))+(_=1/(p+p-1))),m=E*Math.sqrt(h+v)/h-(_-g)*(v+k/I-x/(3*h)),P=d/(d+p*Math.exp(m+m))):(_=1/(9*p),P=(_=(v=p+p)*Math.pow(1-_+E*Math.sqrt(_),3))<=0?1-Math.exp((Math.log((1-u)*p)+L)/p):(_=(4*d+v-x)/_)<=1?Math.exp((Math.log(u*d)+L)/d):1-x/(_+1)),v=1-d,_=1-p,b=0,l=1,P<O?P=O:P>M&&(P=M);var D=Math.max(A,Math.pow(10,-13-2.5/(d*d)-.5/(u*u)));for(y=0,f=0,a=0;a<1e3;a++){for((E=((E=N(P,d,p))-u)*Math.exp(L+v*Math.log(P)+_*Math.log(1-P)))*b<=0&&(f=Math.max(Math.abs(l),R)),c=1,s=0;s<1e3;s++){if(l=c*E,Math.abs(l)<f&&(y=P-l)>=0&&y<=1){if(f<=D)return 0!==o&&(P=1-P),(i-r)*P+r;if(Math.abs(E)<=D)return 0!==o&&(P=1-P),(i-r)*P+r;if(0!==y&&1!==y)break}c/=3}if(y===P)return 0!==o&&(P=1-P),(i-r)*P+r;P=y,b=E}return 0!==o&&(P=1-P),(i-r)*P+r}function V(e,t,n){var r=n,i=t;if(t>n&&(r=[i,i=r][0]),e&&r+i<171.624376956302)return O(r)/O(r+i)*O(i);var o=5.52468004077673,a=k(r);a/=k(r+i),a*=k(i);var s=r+i+o,u=e?a*Math.sqrt(s/(r+o)/(i+o)):Math.log(a)+.5*(Math.log(s)-Math.log(r+o)-Math.log(i+o)),l=i/(r+o),c=r/(i+o),h=-r*Math.log(1+l)-i*Math.log(1+c)-o;return e?Math.exp(h)*u:h+u}function H(e,t,n,r,i){return P((e-r)/(i-r),t,n)/(i-r)}function U(e,t,n,r,i){return N((e-r)/(i-r),t,n)}function Z(e,t,n,r,i){return N((e-r)/(i-r),t,n)}e.ABSFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="ABS",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n){if(n.isError())return n;var r=n.toNumberVar().getValue();return new t.NumberVar(Math.abs(r))},n}(t.FuncOpBase),e.ACOSFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="ACOS",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)}],n}return r(n,e),n.prototype.func=function(e,n){var r=n.getValue();return r<-1||r>1?t.tractorErrorVarCreators[t.ErrorCode.NUM_SHOULD_BE_BETWEEN_INCLUSIVE_PARAMETER]({funcName:this.name,index:1,value:r,lowerBound:-1,upperBound:1}):new t.NumberVar(Math.acos(r))},n}(t.FuncOpBase),e.ACOSHFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="ACOSH",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)}],n}return r(n,e),n.prototype.func=function(e,n){var r=n.getValue();return r<1?t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO]({funcName:this.name,index:1,value:r,lowerBound:1}):new t.NumberVar(Math.acosh(r))},n}(t.FuncOpBase),e.ANDFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="AND",n.operands=1,n.optionOperands=255,n.resultType=t.VAR_TYPE.BOOL,n.repeatedLastParam=1,n.paramsDesc=[{type:t.VAR_TYPE.BOOL|t.VAR_TYPE.COLLECTION},{type:t.VAR_TYPE.BOOL|t.VAR_TYPE.COLLECTION}],n}return r(n,e),n.prototype.func=function(e){for(var n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];var s=!0,u=!0,l=function(t){var n;if(t.iter(e).exitWhen((function(e){var t=e.isError();return t&&(n=e),t})).filter((function(e){return e.isPrimitive()&&!e.isString()&&!e.isNull()})).map((function(t){return t.toBooleanVar(e.service)})).forEach((function(t){u=!1,t.getValue(e)||(s=!1)})),n)return{value:n}};try{for(var c=a(i),h=c.next();!h.done;h=c.next()){var d=l(h.value);if("object"==typeof d)return d.value}}catch(e){n={error:e}}finally{try{h&&!h.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return u?t.tractorErrorVarCreators[t.ErrorCode.NO_VALID_DATA]({funcName:this.name}):new t.BooleanVar(s)},n}(t.FuncOpBase),e.AVERAGEFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="AVERAGE",n.operands=1,n.optionOperands=255,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=1,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION}],n.calcCustomData=t.getFirstValidCustomData,n}return r(n,e),n.prototype.func=function(e){for(var t,n,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var o=function(){var t,n,i=[];try{for(var o=a(r),s=o.next();!s.done;s=o.next()){var u=s.value;i.push(u.iter(e))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return i},s=u(o);return s.isError()&&(null===(t=s.info)||void 0===t?void 0:t.args)&&Object.prototype.hasOwnProperty.call(null===(n=s.info)||void 0===n?void 0:n.args,"funcName")&&(s.info.args.funcName=this.name),s},n}(t.FuncOpBase),e.SUMFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="SUM",n.operands=1,n.optionOperands=255,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=1,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION}],n.calcCustomData=t.getFirstValidCustomData,n}return r(n,e),n.prototype.func=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return l((function(){for(var n=[],r=0;r<t.length;r++)n.push(t[r].iter(e));return n}))},n}(t.FuncOpBase),e.AVEDEVFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="AVEDEV",n.operands=1,n.optionOperands=255,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=1,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION}],n}return r(n,e),n.prototype.func=function(e){for(var n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];var s=0,u=0,l=0,c=0,h=[],d=function(t){var n;if(t.iter(e).exitWhen((function(e){var t=e.isError();return t&&(n=e),t})).filter((function(e){return e.isNumber()})).forEach((function(t){var n=t.getValue(e);s+=n,h.push(n),u++})),n)return{value:n}};try{for(var f=a(i),p=f.next();!p.done;p=f.next()){var v=d(p.value);if("object"==typeof v)return v.value}}catch(e){n={error:e}}finally{try{p&&!p.done&&(r=f.return)&&r.call(f)}finally{if(n)throw n.error}}return 0===u?t.tractorErrorVarCreators[t.ErrorCode.NUM_DIVIDE_BY_ZERO_FROM_FUNCTION_EVAL]({funcName:this.name}):(c=s/u,l=h.map((function(e){return Math.abs(e-c)/u})).reduce((function(e,t){return e+t}),0),new t.NumberVar(l))},n}(t.FuncOpBase),e.BIN_PREFIX="0b",e.OCT_PREFIX="0",e.HEX_PREFIX="0x",e.BIN2OCTFunc=function(n){function i(){var e=null!==n&&n.apply(this,arguments)||this;return e.name="BIN2OCT",e.operands=1,e.optionOperands=1,e.resultType=t.VAR_TYPE.STRING,e.repeatedLastParam=0,e.paramsDesc=[{type:t.VAR_TYPE.STRING|t.VAR_TYPE.BOOL,default:t.NA_ERR_VAR},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL|t.VAR_TYPE.NULL,default:t.NULL_VAR}],e}return r(i,n),i.prototype.func=function(n,r,i){if(r.isBool()||i.isBool()){var o=r.isBool()?1:2,a=r.isBool()?r:i,s=r.isBool()?t.FormulaErrorPhrases.DATA_TYPE_STRING:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE;return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:o,value:a.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:s})}var u=r.getValue();if(parseInt(u,10)>=1e10)return t.tractorErrorVarCreators[t.ErrorCode.STRING_TOO_LONG]({funcName:this.name,index:1,textLength:u.length,maxTextLength:10});if(!m(u))return t.tractorErrorVarCreators[t.ErrorCode.INVALID_NON_DECIMAL_REPRESENTATION]({funcName:this.name,value:u,validValue:t.FormulaErrorPhrases.BINARY});var l=h(u,10).slice(e.OCT_PREFIX.length);if(""===l)return t.NUM_ERR_VAR;if(!i.isNull()){var c=i.getValue();if(c>10||c<=0)return t.tractorErrorVarCreators[t.ErrorCode.NUM_SHOULD_BE_BETWEEN_INCLUSIVE_PARAMETER]({funcName:this.name,index:2,value:c,lowerBound:1,upperBound:10});var d=Math.trunc(c),f=l.length;if(10===f&&"7"!==l[0]||f<10){if(!(f<=d))return t.tractorErrorVarCreators[t.ErrorCode.INSUFFICIENT_PLACES]({funcName:this.name,curPlaces:f,requiredPlaces:2});l=l.padStart(d,"0")}}return new t.StringVar(l)},i}(t.FuncOpBase),e.BIN2DECFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="BIN2DEC",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.STRING|t.VAR_TYPE.BOOL}],n}return r(n,e),n.prototype.func=function(e,n){if(n.isBool()){var r=n.getValue().toString().toUpperCase();return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:1,value:r,argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_STRING})}var i=n.getValue(),o=parseInt(i,10);if(!m(i))return t.tractorErrorVarCreators[t.ErrorCode.INVALID_NON_DECIMAL_REPRESENTATION]({funcName:this.name,value:i,validValue:t.FormulaErrorPhrases.BINARY});if(o>=1e10)return t.tractorErrorVarCreators[t.ErrorCode.STRING_TOO_LONG]({funcName:this.name,index:1,textLength:i.length,maxTextLength:10});var a=c(i,10);return Number.isFinite(a)?new t.NumberVar(a):t.NUM_ERR_VAR},n}(t.FuncOpBase),e.BIN2HEXFunc=function(n){function i(){var e=null!==n&&n.apply(this,arguments)||this;return e.name="BIN2HEX",e.operands=1,e.optionOperands=1,e.resultType=t.VAR_TYPE.STRING,e.repeatedLastParam=0,e.paramsDesc=[{type:t.VAR_TYPE.STRING|t.VAR_TYPE.BOOL,default:t.NA_ERR_VAR},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL|t.VAR_TYPE.NULL,default:t.NULL_VAR}],e}return r(i,n),i.prototype.func=function(n,r,i){if(r.isBool()||i.isBool()){var o=r.isBool()?1:2,a=1===o?r:i,s=1===o?t.FormulaErrorPhrases.DATA_TYPE_STRING:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE;return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:o,value:a.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:s})}var u=r.getValue(),l=parseInt(u,10);if(!m(u))return t.tractorErrorVarCreators[t.ErrorCode.INVALID_NON_DECIMAL_REPRESENTATION]({funcName:this.name,value:u,validValue:t.FormulaErrorPhrases.BINARY});if(l>=1e10)return t.tractorErrorVarCreators[t.ErrorCode.STRING_TOO_LONG]({funcName:this.name,index:1,textLength:u.length,maxTextLength:10});var c=d(u,10,10).slice(e.HEX_PREFIX.length);if(""===c)return t.NUM_ERR_VAR;if(!i.isNull()){var h=i.getValue();if(h>10||h<=0)return t.tractorErrorVarCreators[t.ErrorCode.NUM_SHOULD_BE_BETWEEN_INCLUSIVE_PARAMETER]({funcName:this.name,index:2,value:h,lowerBound:1,upperBound:10});var f=Math.trunc(h),p=c.length;if(10===p&&"F"!==c[0]||p<10){if(!(p<=f))return t.tractorErrorVarCreators[t.ErrorCode.INSUFFICIENT_PLACES]({funcName:this.name,curPlaces:f,requiredPlaces:p});c=c.padStart(f,"0")}}return new t.StringVar(c)},i}(t.FuncOpBase),e.BETADISTFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="BETA.DIST",n.operands=4,n.optionOperands=2,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.BOOL,default:new t.BooleanVar(!1)},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(1)}],n}return r(n,e),n.prototype.func=function(e,n,r,i,o,a,s){var u=n.getValue(),l=r.getValue(),c=i.getValue(),h=o.getValue(),d=a.getValue(),f=s.getValue();if(l<=0||c<=0){var p=2==(v=l<=0?2:3)?l:c;return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN]({funcName:this.name,index:v,value:p,lowerBound:0})}if(u<d||u>f){var v,g=5==(v=u<d?5:1)?1:6,_=(p=5===v?d:u,5===v?u:f);return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_SHOULD_BE_LESS_THAN_OR_EQUAL_TO_OTHER_PARAM]({funcName:this.name,index:v,value:p,secondArgIndex:g,upperBound:_})}if(d===f)return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_SHOULD_BE_LESS_THAN_OTHER_PARAM]({funcName:this.name,index:5,value:d,secondArgIndex:6,upperBound:f});var y=0;return y=h?U(u,l,c,d,f):H(u,l,c,d,f),new t.NumberVar(y)},n}(t.FuncOpBase),e.BETADISTCDFFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="BETADIST",n.operands=3,n.optionOperands=2,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(1)}],n}return r(n,e),n.prototype.func=function(e,n,r,i,o,a){var s=n.getValue(),u=r.getValue(),l=i.getValue(),c=o.getValue(),h=a.getValue();if(u<=0||l<=0){var d=2==(f=u<=0?2:3)?u:l;return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN]({funcName:this.name,index:f,value:d,lowerBound:0})}if(s<c||s>h){var f,p=5==(f=s<c?5:1)?1:6,v=(d=5===f?c:s,5===f?s:h);return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_SHOULD_BE_LESS_THAN_OR_EQUAL_TO_OTHER_PARAM]({funcName:this.name,index:f,value:d,secondArgIndex:p,upperBound:v})}if(c===h)return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_SHOULD_BE_LESS_THAN_OTHER_PARAM]({funcName:this.name,index:5,value:c,secondArgIndex:6,upperBound:h});var g=Z(s,u,l,c,h);return new t.NumberVar(g)},n}(t.FuncOpBase),e.BETAINVFunc=function(e){function n(n){void 0===n&&(n="BETA.INV");var r=e.call(this,n)||this;return r.name=n,r.operands=3,r.optionOperands=2,r.resultType=t.VAR_TYPE.NUMBER,r.repeatedLastParam=0,r.paramsDesc=[{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(1)}],r}return r(n,e),n.prototype.func=function(e,n,r,i,o,a){var s=n.getValue(),u=r.getValue(),l=i.getValue(),c=o.getValue(),h=a.getValue();if(s<=0||u<=0||l<=0){var d=3,f=l;return s<=0?(d=1,f=s):u<=0&&(d=2,f=u),t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN]({funcName:this.name,index:d,value:f,lowerBound:0})}if(s>1)return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_SHOULD_BE_LESS_THAN_OR_EQUAL_TO]({funcName:this.name,index:1,value:s,upperBound:1});var p=B(s,u,l,c,h);return new t.NumberVar(p)},n}(t.FuncOpBase),e.PayTimeType=void 0,(i=e.PayTimeType||(e.PayTimeType={}))[i.End=0]="End",i[i.Begin=1]="Begin";var W=30,j=200,G=1e-7;function z(e,t,n,r,i){var o;if(void 0===r&&(r=0),0===e)o=(n+r)/t;else{var a=Math.pow(1+e,t);o=1===i?(r*e/(a-1)+n*e/(1-1/a))/(1+e):r*e/(a-1)+n*e/(1-1/a)}return-o}function Y(t,n,r,i,o,a){if(void 0===o&&(o=0),void 0===a&&(a=e.PayTimeType.End),0===t)return 0;var s=t+1,u=((i+o)*(Math.pow(s,r)-Math.pow(s,n-1))/(Math.pow(s,r)-1)-o)*-t;return a?n<2?0:u/s:u}function X(t,n,r,i,o,a){return void 0===o&&(o=0),void 0===a&&(a=e.PayTimeType.End),z(t,r,i,o,a)-Y(t,n,r,i,o,a)}function K(e,t,n,r,i){var o;if(0===e)o=r+n*t;else{var a=Math.pow(1+e,t);o=1===i?r*a+n*(1+e)*(a-1)/e:r*a+n*(a-1)/e}return-o}function q(e,t){return t.reduce((function(t,n,r){return t+n/Math.pow(1+e,r+1)}),0)}function $(e,t,n){return t.reduce((function(t,r,i){return t+r/Math.pow(1+e,(n[i]-n[0])/365)}),0)}function J(e,t,n,r,i){void 0===r&&(r=W),void 0===i&&(i=G);var o=t-e(t)/ee(e,t,i);return Math.abs(o-t)<i?o:n>r?null:J(e,o,n+1,r,i)}function Q(e,t,n,r,i){function o(e){return e<=n?n+i:e}function a(e){return e>=r?r-i:e}function s(t,n,r){if(0==--r)return null;var i=o(t),a=o(n);return e(i)*e(a)<=0?[i,a]:s(i+l*(i-a),a+l*(a-i),r)}if(t<=n||t>=r)return null;var u=.01,l=1.6,c=60;return s(o(t-u),a(t+u),c)}function ee(e,t,n){return(e(t+n)-e(t-n))/(2*n)}function te(e,t,n,r,i){if(t===n)return null;var o=e(t);if(Math.abs(o)<i)return t;var a=e(n);if(Math.abs(a)<i)return n;var s=r+1;if(s>j)return null;if(re(o,a))return null;var u=t+.5*(n-t),l=e(u);return Math.abs(l)<i?u:re(o,l)?re(o,l)?te(e,u,n,s,i):null:te(e,t,u,s,i)}function ne(e,t,n,r){void 0===n&&(n=W),void 0===r&&(r=G);var i=J(e,t,0,n,r);if(null!==i&&re(t,i))return i;var o=Q(e,t,-1,Number.MAX_VALUE,r);return null!==o?te(e,o[0],o[1],0,r):i}function re(e,t){return e>0&&t>0||e<0&&t<0}function ie(e,t,n){return(e-t)/n}function oe(e){var n,r,i=0,o=!1,s=function(e){var t=null;if(e.exitWhen((function(e){var n=e.isError();return n&&(t=e),n})).filter((function(e){return e.isNumber()})).forEach((function(e){(!1===o||i>e.getValue())&&(i=e.getValue(),o=!0)})),t)return{value:t}};try{for(var u=a(e()),l=u.next();!l.done;l=u.next()){var c=s(l.value);if("object"==typeof c)return c.value}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}return new t.NumberVar(i)}e.CUMPRINCFunc=function(n){function i(){var e=null!==n&&n.apply(this,arguments)||this;return e.name="CUMPRINC",e.operands=6,e.optionOperands=0,e.resultType=t.VAR_TYPE.NUMBER,e.repeatedLastParam=0,e.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL,default:t.VALUE_ERR_VAR},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL,default:t.VALUE_ERR_VAR},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL,default:t.VALUE_ERR_VAR},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL,default:t.VALUE_ERR_VAR},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL,default:t.VALUE_ERR_VAR},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL,default:t.VALUE_ERR_VAR}],e}return r(i,n),i.prototype.func=function(n,r,i,o,a,s,u){var l=Array.prototype.slice.call(arguments,1).findIndex((function(e){return e.isBool()}));if(-1!==l){var c=arguments[l+1].getValue();return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:l+1,value:c.toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE})}var h=r.getValue(),d=i.getValue(),f=o.getValue(),p=a.getValue(),v=s.getValue(),g=u.getValue();if(h<=0)return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN]({funcName:this.name,index:1,value:h,lowerBound:0});if(d<=0)return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN]({funcName:this.name,index:2,value:d,lowerBound:0});if(f<=0)return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN]({funcName:this.name,index:3,value:f,lowerBound:0});if(p<1)return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO]({funcName:this.name,index:4,value:p,lowerBound:1});if(v<1)return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO]({funcName:this.name,index:5,value:v,lowerBound:1});if(p>v)return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO]({funcName:this.name,index:5,value:v,lowerBound:p});if(!Object.prototype.hasOwnProperty.call(e.PayTimeType,g))return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_VALUE_NOT_IN_LIST]({funcName:this.name,index:6,value:g.toString(),validValues:"0, 1"});var _=z(h,d,f,0,g),y=0;1===p&&(y=0===g?_+f*h:_,p++);for(var m=p;m<=v;m++)y+=g>0?_-(K(h,m-2,_,f,1)-_)*h:_-K(h,m-1,_,f,0)*h;return new t.NumberVar(y)},i}(t.FuncOpBase),e.MINFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="MIN",n.operands=1,n.optionOperands=255,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=1,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION}],n.calcCustomData=t.getFirstValidCustomData,n}return r(n,e),n.prototype.func=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return oe((function(){var n,r,i=[];try{for(var o=a(t),s=o.next();!s.done;s=o.next()){var u=s.value;i.push(u.iter(e))}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}))},n}(t.FuncOpBase);var ae={exports:{}};
/**
     * @license Complex.js v2.1.1 12/05/2020
     *
     * Copyright (c) 2020, Robert Eisele (robert@xarg.org)
     * Dual licensed under the MIT or GPL Version 2 licenses.
     **/(function(e,t){!function(t){var n=Math.cosh||function(e){return Math.abs(e)<1e-9?1-e:.5*(Math.exp(e)+Math.exp(-e))},r=Math.sinh||function(e){return Math.abs(e)<1e-9?e:.5*(Math.exp(e)-Math.exp(-e))},i=function(e){var t=Math.PI/4;if(-t>e||e>t)return Math.cos(e)-1;var n=e*e;return n*(n*(n*(n*(n*(n*(n*(n/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-.5)},o=function(e,t){var n=Math.abs(e),r=Math.abs(t);return n<3e3&&r<3e3?Math.sqrt(n*n+r*r):(n<r?(n=r,r=e/t):r=t/e,n*Math.sqrt(1+r*r))},a=function(){throw SyntaxError("Invalid Param")};function s(e,t){var n=Math.abs(e),r=Math.abs(t);return 0===e?Math.log(r):0===t?Math.log(n):n<3e3&&r<3e3?.5*Math.log(e*e+t*t):(e/=2,t/=2,.5*Math.log(e*e+t*t)+Math.LN2)}var u=function(e,t){var n={re:0,im:0};if(null==e)n.re=n.im=0;else if(void 0!==t)n.re=e,n.im=t;else switch(typeof e){case"object":if("im"in e&&"re"in e)n.re=e.re,n.im=e.im;else if("abs"in e&&"arg"in e){if(!Number.isFinite(e.abs)&&Number.isFinite(e.arg))return l.INFINITY;n.re=e.abs*Math.cos(e.arg),n.im=e.abs*Math.sin(e.arg)}else if("r"in e&&"phi"in e){if(!Number.isFinite(e.r)&&Number.isFinite(e.phi))return l.INFINITY;n.re=e.r*Math.cos(e.phi),n.im=e.r*Math.sin(e.phi)}else 2===e.length?(n.re=e[0],n.im=e[1]):a();break;case"string":n.im=n.re=0;var r=e.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),i=1,o=0;null===r&&a();for(var s=0;s<r.length;s++){var u=r[s];" "===u||"\t"===u||"\n"===u||("+"===u?i++:"-"===u?o++:"i"===u||"I"===u?(i+o===0&&a()," "===r[s+1]||isNaN(r[s+1])?n.im+=parseFloat((o%2?"-":"")+"1"):(n.im+=parseFloat((o%2?"-":"")+r[s+1]),s++),i=o=0):((i+o===0||isNaN(u))&&a(),"i"===r[s+1]||"I"===r[s+1]?(n.im+=parseFloat((o%2?"-":"")+u),s++):n.re+=parseFloat((o%2?"-":"")+u),i=o=0))}i+o>0&&a();break;case"number":n.im=0,n.re=e;break;default:a()}return isNaN(n.re)||isNaN(n.im),n};function l(e,t){if(!(this instanceof l))return new l(e,t);var n=u(e,t);this.re=n.re,this.im=n.im}l.prototype={re:0,im:0,sign:function(){var e=this.abs();return new l(this.re/e,this.im/e)},add:function(e,t){var n=new l(e,t);return this.isInfinite()&&n.isInfinite()?l.NAN:this.isInfinite()||n.isInfinite()?l.INFINITY:new l(this.re+n.re,this.im+n.im)},sub:function(e,t){var n=new l(e,t);return this.isInfinite()&&n.isInfinite()?l.NAN:this.isInfinite()||n.isInfinite()?l.INFINITY:new l(this.re-n.re,this.im-n.im)},mul:function(e,t){var n=new l(e,t);return this.isInfinite()&&n.isZero()||this.isZero()&&n.isInfinite()?l.NAN:this.isInfinite()||n.isInfinite()?l.INFINITY:0===n.im&&0===this.im?new l(this.re*n.re,0):new l(this.re*n.re-this.im*n.im,this.re*n.im+this.im*n.re)},div:function(e,t){var n=new l(e,t);if(this.isZero()&&n.isZero()||this.isInfinite()&&n.isInfinite())return l.NAN;if(this.isInfinite()||n.isZero())return l.INFINITY;if(this.isZero()||n.isInfinite())return l.ZERO;e=this.re,t=this.im;var r,i,o=n.re,a=n.im;return 0===a?new l(e/o,t/o):Math.abs(o)<Math.abs(a)?new l((e*(i=o/a)+t)/(r=o*i+a),(t*i-e)/r):new l((e+t*(i=a/o))/(r=a*i+o),(t-e*i)/r)},pow:function(e,t){var n=new l(e,t);if(e=this.re,t=this.im,n.isZero())return l.ONE;if(0===n.im){if(0===t&&e>0)return new l(Math.pow(e,n.re),0);if(0===e)switch((n.re%4+4)%4){case 0:return new l(Math.pow(t,n.re),0);case 1:return new l(0,Math.pow(t,n.re));case 2:return new l(-Math.pow(t,n.re),0);case 3:return new l(0,-Math.pow(t,n.re))}}if(0===e&&0===t&&n.re>0&&n.im>=0)return l.ZERO;var r=Math.atan2(t,e),i=s(e,t);return e=Math.exp(n.re*i-n.im*r),t=n.im*i+n.re*r,new l(e*Math.cos(t),e*Math.sin(t))},sqrt:function(){var e,t,n=this.re,r=this.im,i=this.abs();if(n>=0){if(0===r)return new l(Math.sqrt(n),0);e=.5*Math.sqrt(2*(i+n))}else e=Math.abs(r)/Math.sqrt(2*(i-n));return t=n<=0?.5*Math.sqrt(2*(i-n)):Math.abs(r)/Math.sqrt(2*(i+n)),new l(e,r<0?-t:t)},exp:function(){var e=Math.exp(this.re);return this.im,new l(e*Math.cos(this.im),e*Math.sin(this.im))},expm1:function(){var e=this.re,t=this.im;return new l(Math.expm1(e)*Math.cos(t)+i(t),Math.exp(e)*Math.sin(t))},log:function(){var e=this.re,t=this.im;return new l(s(e,t),Math.atan2(t,e))},abs:function(){return o(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var e=this.re,t=this.im;return new l(Math.sin(e)*n(t),Math.cos(e)*r(t))},cos:function(){var e=this.re,t=this.im;return new l(Math.cos(e)*n(t),-Math.sin(e)*r(t))},tan:function(){var e=2*this.re,t=2*this.im,i=Math.cos(e)+n(t);return new l(Math.sin(e)/i,r(t)/i)},cot:function(){var e=2*this.re,t=2*this.im,i=Math.cos(e)-n(t);return new l(-Math.sin(e)/i,r(t)/i)},sec:function(){var e=this.re,t=this.im,i=.5*n(2*t)+.5*Math.cos(2*e);return new l(Math.cos(e)*n(t)/i,Math.sin(e)*r(t)/i)},csc:function(){var e=this.re,t=this.im,i=.5*n(2*t)-.5*Math.cos(2*e);return new l(Math.sin(e)*n(t)/i,-Math.cos(e)*r(t)/i)},asin:function(){var e=this.re,t=this.im,n=new l(t*t-e*e+1,-2*e*t).sqrt(),r=new l(n.re-t,n.im+e).log();return new l(r.im,-r.re)},acos:function(){var e=this.re,t=this.im,n=new l(t*t-e*e+1,-2*e*t).sqrt(),r=new l(n.re-t,n.im+e).log();return new l(Math.PI/2-r.im,r.re)},atan:function(){var e=this.re,t=this.im;if(0===e){if(1===t)return new l(0,1/0);if(-1===t)return new l(0,-1/0)}var n=e*e+(1-t)*(1-t),r=new l((1-t*t-e*e)/n,-2*e/n).log();return new l(-.5*r.im,.5*r.re)},acot:function(){var e=this.re,t=this.im;if(0===t)return new l(Math.atan2(1,e),0);var n=e*e+t*t;return 0!==n?new l(e/n,-t/n).atan():new l(0!==e?e/0:0,0!==t?-t/0:0).atan()},asec:function(){var e=this.re,t=this.im;if(0===e&&0===t)return new l(0,1/0);var n=e*e+t*t;return 0!==n?new l(e/n,-t/n).acos():new l(0!==e?e/0:0,0!==t?-t/0:0).acos()},acsc:function(){var e=this.re,t=this.im;if(0===e&&0===t)return new l(Math.PI/2,1/0);var n=e*e+t*t;return 0!==n?new l(e/n,-t/n).asin():new l(0!==e?e/0:0,0!==t?-t/0:0).asin()},sinh:function(){var e=this.re,t=this.im;return new l(r(e)*Math.cos(t),n(e)*Math.sin(t))},cosh:function(){var e=this.re,t=this.im;return new l(n(e)*Math.cos(t),r(e)*Math.sin(t))},tanh:function(){var e=2*this.re,t=2*this.im,i=n(e)+Math.cos(t);return new l(r(e)/i,Math.sin(t)/i)},coth:function(){var e=2*this.re,t=2*this.im,i=n(e)-Math.cos(t);return new l(r(e)/i,-Math.sin(t)/i)},csch:function(){var e=this.re,t=this.im,i=Math.cos(2*t)-n(2*e);return new l(-2*r(e)*Math.cos(t)/i,2*n(e)*Math.sin(t)/i)},sech:function(){var e=this.re,t=this.im,i=Math.cos(2*t)+n(2*e);return new l(2*n(e)*Math.cos(t)/i,-2*r(e)*Math.sin(t)/i)},asinh:function(){var e=this.im;this.im=-this.re,this.re=e;var t=this.asin();return this.re=-this.im,this.im=e,e=t.re,t.re=-t.im,t.im=e,t},acosh:function(){var e=this.acos();if(e.im<=0){var t=e.re;e.re=-e.im,e.im=t}else t=e.im,e.im=-e.re,e.re=t;return e},atanh:function(){var e=this.re,t=this.im,n=e>1&&0===t,r=1-e,i=1+e,o=r*r+t*t,a=0!==o?new l((i*r-t*t)/o,(t*r+i*t)/o):new l(-1!==e?e/0:0,0!==t?t/0:0),u=a.re;return a.re=s(a.re,a.im)/2,a.im=Math.atan2(a.im,u)/2,n&&(a.im=-a.im),a},acoth:function(){var e=this.re,t=this.im;if(0===e&&0===t)return new l(0,Math.PI/2);var n=e*e+t*t;return 0!==n?new l(e/n,-t/n).atanh():new l(0!==e?e/0:0,0!==t?-t/0:0).atanh()},acsch:function(){var e=this.re,t=this.im;if(0===t)return new l(0!==e?Math.log(e+Math.sqrt(e*e+1)):1/0,0);var n=e*e+t*t;return 0!==n?new l(e/n,-t/n).asinh():new l(0!==e?e/0:0,0!==t?-t/0:0).asinh()},asech:function(){var e=this.re,t=this.im;if(this.isZero())return l.INFINITY;var n=e*e+t*t;return 0!==n?new l(e/n,-t/n).acosh():new l(0!==e?e/0:0,0!==t?-t/0:0).acosh()},inverse:function(){if(this.isZero())return l.INFINITY;if(this.isInfinite())return l.ZERO;var e=this.re,t=this.im,n=e*e+t*t;return new l(e/n,-t/n)},conjugate:function(){return new l(this.re,-this.im)},neg:function(){return new l(-this.re,-this.im)},ceil:function(e){return e=Math.pow(10,e||0),new l(Math.ceil(this.re*e)/e,Math.ceil(this.im*e)/e)},floor:function(e){return e=Math.pow(10,e||0),new l(Math.floor(this.re*e)/e,Math.floor(this.im*e)/e)},round:function(e){return e=Math.pow(10,e||0),new l(Math.round(this.re*e)/e,Math.round(this.im*e)/e)},equals:function(e,t){var n=new l(e,t);return Math.abs(n.re-this.re)<=l.EPSILON&&Math.abs(n.im-this.im)<=l.EPSILON},clone:function(){return new l(this.re,this.im)},toString:function(){var e=this.re,t=this.im,n="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(e)<l.EPSILON&&(e=0),Math.abs(t)<l.EPSILON&&(t=0),0===t?n+e:(0!==e?(n+=e,n+=" ",t<0?(t=-t,n+="-"):n+="+",n+=" "):t<0&&(t=-t,n+="-"),1!==t&&(n+=t),n+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return 0===this.im?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return 0===this.im&&0===this.re},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},l.ZERO=new l(0,0),l.ONE=new l(1,0),l.I=new l(0,1),l.PI=new l(Math.PI,0),l.E=new l(Math.E,0),l.INFINITY=new l(1/0,1/0),l.NAN=new l(NaN,NaN),l.EPSILON=1e-15,Object.defineProperty(l,"__esModule",{value:!0}),l.default=l,l.Complex=l,e.exports=l}()})(ae),e.COMPLEXFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="COMPLEX",n.operands=2,n.optionOperands=1,n.resultType=t.VAR_TYPE.STRING,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL,default:t.NA_ERR_VAR},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL,default:t.NA_ERR_VAR},{type:t.VAR_TYPE.STRING,default:new t.StringVar("i")}],n}return r(n,e),n.prototype.func=function(e,n,r,i){if(n.isBool()||r.isBool()){var o=n.isBool()?1:2,a=n.isBool()?n:r;return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:o,value:a.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE})}var s,u=n.getValue(),l=r.getValue(),c=i.getValue();if("i"!==c&&"j"!==c){var h="i, j";return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_VALUE_NOT_IN_LIST]({funcName:this.name,index:3,value:c,validValues:h})}try{s=new ae.exports.Complex(u,l)}catch(e){return t.NUM_ERR_VAR}var d=s.toString().replace(/\s/g,"");return"j"===c&&0!==s.im&&(d=d.replace("i",c)),new t.StringVar(d)},n}(t.FuncOpBase),e.DEC2BINFunc=function(n){function i(){var e=null!==n&&n.apply(this,arguments)||this;return e.name="DEC2BIN",e.operands=1,e.optionOperands=1,e.resultType=t.VAR_TYPE.STRING,e.repeatedLastParam=0,e.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL,default:t.NA_ERR_VAR},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL|t.VAR_TYPE.NULL,default:t.NULL_VAR}],e}return r(i,n),i.prototype.func=function(n,r,i){if(r.isBool()||i.isBool()){var o=r.isBool()?1:2,a=r.isBool()?r:i;return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:o,value:a.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE})}var s=Math.trunc(r.getValue());if(s<-512||s>511)return t.tractorErrorVarCreators[t.ErrorCode.NUM_SHOULD_BE_BETWEEN_INCLUSIVE_PARAMETER]({funcName:this.name,index:1,value:s,lowerBound:-512,upperBound:511});var u=f(s,10).slice(e.BIN_PREFIX.length);if(""===u)return t.NUM_ERR_VAR;if(!i.isNull()){var l=i.getValue();if(l>10||l<=0)return t.tractorErrorVarCreators[t.ErrorCode.NUM_SHOULD_BE_BETWEEN_INCLUSIVE_PARAMETER]({funcName:this.name,index:2,value:l,lowerBound:1,upperBound:10});var c=Math.trunc(l),h=u.length;if(10===h&&"1"!==u[0]||h<10){if(!(h<=c))return t.tractorErrorVarCreators[t.ErrorCode.INSUFFICIENT_PLACES]({funcName:this.name,curPlaces:c,requiredPlaces:h});u=u.padStart(c,"0")}}return new t.StringVar(u)},i}(t.FuncOpBase);var se=parseInt("01".padEnd(40,"1"),2),ue=-(parseInt("01".padEnd(40,"1"),2)+1);e.DEC2HEXFunc=function(n){function i(){var e=null!==n&&n.apply(this,arguments)||this;return e.name="DEC2HEX",e.operands=1,e.optionOperands=1,e.resultType=t.VAR_TYPE.STRING,e.repeatedLastParam=0,e.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL,default:t.NA_ERR_VAR},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL|t.VAR_TYPE.NULL,default:t.NULL_VAR}],e}return r(i,n),i.prototype.func=function(n,r,i){if(r.isBool()||i.isBool()){var o=r.isBool()?1:2,a=r.isBool()?r:i;return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:o,value:a.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE})}var s=Math.trunc(r.getValue());if(s<ue||s>se)return t.tractorErrorVarCreators[t.ErrorCode.NUM_SHOULD_BE_BETWEEN_INCLUSIVE_PARAMETER]({funcName:this.name,index:1,value:s,lowerBound:ue,upperBound:se});var u=d(f(s,40).slice(e.BIN_PREFIX.length),40,10).slice(e.HEX_PREFIX.length);if(""===u)return t.NUM_ERR_VAR;if(!i.isNull()){var l=i.getValue();if(l>10||l<=0)return t.tractorErrorVarCreators[t.ErrorCode.NUM_SHOULD_BE_BETWEEN_INCLUSIVE_PARAMETER]({funcName:this.name,index:2,value:l,lowerBound:1,upperBound:10});var c=Math.trunc(l),h=u.length;if(10===h&&"F"!==u[0]||h<10){if(!(h<=c))return t.tractorErrorVarCreators[t.ErrorCode.INSUFFICIENT_PLACES]({funcName:this.name,curPlaces:c,requiredPlaces:h});u=u.padStart(c,"0")}}return new t.StringVar(u)},i}(t.FuncOpBase);var le,ce=parseInt("01".padEnd(30,"1"),2),he=-(parseInt("01".padEnd(30,"1"),2)+1);function de(e,t){return _e(e*(t=Math.pow(10,t)))/t}function fe(e,t){return 0===t?0:(e>0&&(t=Math.abs(t)),ge(e/t)*t)}function pe(e,t){return 0===t?0:(e>0&&(t=Math.abs(t)),ve(e/t)*t)}function ve(e){return-ge(-e)}function ge(e){return Math.floor(t.convertTo15Digits(e))}function _e(e){return Math.sign(e)*ge(Math.abs(e)+.5)}function ye(e,t,n){return 0===e?0:1/(Math.pow(n,t)*O(t))*(Math.pow(e,t-1)*Math.exp(-e/n))}function me(e,t,n){return I(e,t,n)}e.DEC2OCTFunc=function(n){function i(){var e=null!==n&&n.apply(this,arguments)||this;return e.name="DEC2OCT",e.operands=1,e.optionOperands=1,e.resultType=t.VAR_TYPE.STRING,e.repeatedLastParam=0,e.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL,default:t.NA_ERR_VAR},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL|t.VAR_TYPE.NULL,default:t.NULL_VAR}],e}return r(i,n),i.prototype.func=function(n,r,i){if(r.isBool()||i.isBool()){var o=r.isBool()?1:2,a=r.isBool()?r:i;return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:o,value:a.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE})}var s=Math.trunc(r.getValue());if(s<he||s>ce)return t.tractorErrorVarCreators[t.ErrorCode.NUM_SHOULD_BE_BETWEEN_INCLUSIVE_PARAMETER]({funcName:this.name,index:1,value:s,lowerBound:he,upperBound:ce});var u=h(f(s,30).slice(e.BIN_PREFIX.length),10).slice(e.OCT_PREFIX.length);if(""===u)return t.NUM_ERR_VAR;if(!i.isNull()){var l=i.getValue();if(l>10||l<=0)return t.tractorErrorVarCreators[t.ErrorCode.NUM_SHOULD_BE_BETWEEN_INCLUSIVE_PARAMETER]({funcName:this.name,index:2,value:l,lowerBound:1,upperBound:10});var c=Math.trunc(l),d=u.length;if(10===d&&"7"!==u[0]||d<10){if(!(d<=c))return t.tractorErrorVarCreators[t.ErrorCode.INSUFFICIENT_PLACES]({funcName:this.name,curPlaces:c,requiredPlaces:d});u=u.padStart(c,"0")}}return new t.StringVar(u)},i}(t.FuncOpBase),e.EXACTFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="EXACT",n.operands=2,n.optionOperands=0,n.resultType=t.VAR_TYPE.BOOL,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.STRING},{type:t.VAR_TYPE.STRING}],n}return r(n,e),n.prototype.func=function(e,n,r){return new t.BooleanVar(n.getValue()===r.getValue())},n}(t.FuncOpBase),e.MIDFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="MID",n.operands=3,n.optionOperands=0,n.resultType=t.VAR_TYPE.STRING,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.STRING},{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n,r,i){if(r.toNumberVar().isNull()||r.toNumberVar().getValue()<1)return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO]({funcName:this.name,index:2,value:r.toNumberVar().getValue(),lowerBound:1});if(i.toNumberVar().isNull()||i.toNumberVar().getValue()<0)return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_SHOULD_BE_POSITIVE_OR_ZERO]({funcName:this.name,index:3});var o=r.toNumberVar().getValue();if(n.toStringVar().isNull())return new t.StringVar("");var a=n.toStringVar().getValue();if(o>a.length)return new t.StringVar("");var s=i.toNumberVar().getValue();return new t.StringVar(a.substr(o-1,s))},n}(t.FuncOpBase),e.VALUEFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="VALUE",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL}],n}return r(n,e),n.prototype.func=function(e,n){return n.isBool()?t.tractorErrorVarCreators[t.ErrorCode.CANNOT_PARSE_TEXT_TO_NUMBER]({funcName:this.name,arg:n.getValue().toString().toUpperCase()}):new t.NumberVar(n.getValue())},n}(t.FuncOpBase),e.FINDFunc=function(e){function n(){var n,r=null!==e&&e.apply(this,arguments)||this;return r.name="FIND",r.operands=2,r.optionOperands=1,r.resultType=t.VAR_TYPE.NUMBER,r.repeatedLastParam=0,r.paramsDesc=[{type:t.VAR_TYPE.STRING},{type:t.VAR_TYPE.STRING},{type:t.VAR_TYPE.NUMBER,default:(n={},n[t.DefaultParam.IfInputNull]=new t.NumberVar(0),n[t.DefaultParam.IfNotInput]=new t.NumberVar(1),n)}],r}return r(n,e),n.prototype.func=function(e,n,r,i){var o=r.getValue();if(0===o.length)return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_SHOULD_BE_NON_BLANK]({funcName:this.name,index:2});var a=Math.floor(i.getValue());if(a<1)return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO]({funcName:this.name,index:3,value:a,lowerBound:1});if(a>o.length)return t.tractorErrorVarCreators[t.ErrorCode.SHOULD_BE_BETWEEN_INCLUSIVE_PARAMETER]({funcName:this.name,index:3,value:a,lowerBound:1,upperBound:o.length});var s=n.getValue(),u=o.substr(a-1).indexOf(s);return-1===u?t.tractorErrorVarCreators[t.ErrorCode.STRING_SEARCH_FAILED]({funcName:this.name,searchFor:n.getValue(),textToSeatch:r.getValue()}):new t.NumberVar(u+a)},n}(t.FuncOpBase),e.FLOORMATHFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="FLOOR.MATH",n.operands=1,n.optionOperands=2,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(1)},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)}],n}return r(n,e),n.prototype.func=function(e,n,r,i){var o=n.getValue(),a=r.getValue();return o<0&&(a=0===i.getValue()?Math.abs(a):-Math.abs(a)),new t.NumberVar(fe(o,a))},n}(t.FuncOpBase),e.FLOORPRECISEFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="FLOOR.PRECISE",n.operands=1,n.optionOperands=1,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(1)}],n}return r(n,e),n.prototype.func=function(e,n,r){return new t.NumberVar(fe(n.getValue(),Math.abs(r.getValue())))},n}(t.FuncOpBase),e.FLOORFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="FLOOR",n.operands=2,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n,r){return 0===r.getValue()&&0!==n.getValue()?t.tractorErrorVarCreators[t.ErrorCode.DIVIDE_BY_ZERO_FROM_PARAMETER_BEING_ZERO]({funcName:this.name,argIndex:2}):r.getValue()<0&&n.getValue()>0?t.tractorErrorVarCreators[t.ErrorCode.DIFFERENT_SIGNS]({funcName:this.name}):new t.NumberVar(fe(n.getValue(),r.getValue()))},n}(t.FuncOpBase),e.GAMMADISTFunc=function(e){function n(n){void 0===n&&(n="GAMMA.DIST");var r=e.call(this,n)||this;return r.name=n,r.operands=4,r.optionOperands=0,r.resultType=t.VAR_TYPE.NUMBER,r.repeatedLastParam=0,r.paramsDesc=[{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.BOOL,default:new t.BooleanVar(!1)}],r}return r(n,e),n.prototype.func=function(e,n,r,i,o){var a,s=n.getValue(),u=r.getValue(),l=i.getValue(),c=o.getValue();if(s<0)return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_POSITIVE_OR_ZERO]({funcName:this.name,index:1});if(u<=0||l<=0){var h=u<=0?2:3,d=2===h?u:l;return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN]({funcName:this.name,index:h,value:d,lowerBound:0})}return a=c?me(s,u,l):ye(s,u,l),new t.NumberVar(a)},n}(t.FuncOpBase),e.GESTEPFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="GESTEP",n.operands=1,n.optionOperands=1,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL,default:t.NA_ERR_VAR},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL,default:new t.NumberVar(0)}],n}return r(n,e),n.prototype.func=function(e,n,r){if(n.isBool()||r.isBool()){var i=n.isBool()?1:2,o=n.isBool()?n:r;return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:i,value:o.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE})}var a=n.getValue()>=r.getValue()?1:0;return new t.NumberVar(a)},n}(t.FuncOpBase),e.ComplexSuffix=void 0,(le=e.ComplexSuffix||(e.ComplexSuffix={})).i="i",le.j="j";var Ee,be=1e15;function Te(e){return 0!==(e=e.replace(/\s/g,"")).length&&/^([+-]?\d+(\.\d+)?)?([+-]?\d*(\.\d+)?(i|j))?$/.test(e)}function Ce(t){return t in e.ComplexSuffix}function Se(){for(var e,t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=null;try{for(var o=a(n),s=o.next();!s.done;s=o.next()){var u=s.value,l=u[u.length-1];if(Ce(l))if(null===i)i=l;else if(i!==l)return{isSame:!1,suffix:null}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return{isSame:!0,suffix:i}}function we(t,n){void 0===n&&(n=e.ComplexSuffix.i);var r=(t=new ae.exports.Complex(Math.trunc(t.re*be)/be,Math.trunc(t.im*be)/be)).toString().replace(/\s/g,"");return n===e.ComplexSuffix.j&&(r=r.replace(e.ComplexSuffix.i,n)),r}function Re(t){return new ae.exports.Complex(t.replace(e.ComplexSuffix.j,e.ComplexSuffix.i))}function Ae(e){var t=Math.sqrt(e.re*e.re+e.im*e.im);return new ae.exports.Complex(Math.log2?Math.log2(t):Math.log(t)/Math.LN2,Math.atan2(e.im,e.re)/Math.LN2)}function Oe(e){return new ae.exports.Complex(e).log().div(Math.LN10)}function Me(e){var n,r,i=0;try{for(var o=a(e()),s=o.next();!s.done;s=o.next())s.value.filter((function(e){return e.isNumber()})).forEach((function(){return i++}))}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return new t.NumberVar(i)}function ke(e){var n,r,i=0;try{for(var o=a(e()),s=o.next();!s.done;s=o.next())s.value.filter((function(e){return!e.isNull()})).forEach((function(){return i++}))}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return new t.NumberVar(i)}function Ie(e){for(var t=0,n=0,r=e.length-1;r>=0;r--){var i=e[r];if(!/\d/.test(i)){n=-1;break}("0"!==i||n>0)&&(n+=1),t="0"===i?t+1:0}return(n-=t)>15}function xe(e,n){var r=n.toUpperCase();if(t.ERROR_VAR_MAP[r])return t.ERROR_VAR_MAP[r];if(t.BOOLEAN_VAR_MAP[r])return t.BOOLEAN_VAR_MAP[r];var i=new t.StringVar(n),o=i.toNumberVar(e.service);return o.isNumber()&&!Ie(n)?o:i}function Ne(t){return!!(e.ComparableVarType&t.type)}function Pe(e,n,r){r.isNull()&&(r=new t.NumberVar(0));var i=Le(e,r);if(null===i)return new t.NumberVar(0);var a=0;return n.iter(o(o({},e),{skipEmptyRef:!1})).filter(i).forEach((function(){return a++})),new t.NumberVar(a)}function Le(n,r){var i=Ue(r),o=r.getValue();if(i===e.CriteriaType.Single){var a=(r=Ze(n,r)).isString()?Ge(r.getValue()):null;if(r.isNumber())return De(n,r,{type:"=",regex:a});var s=Fe(n,{type:"=",regex:a},r);return function(e){return e=e.isNull()?e.toStringVar():e,s(e)}}if(i===e.CriteriaType.WildCard){var u=Ye(o);return function(e){return!!e.isString()&&u.test(e.getValue())}}if(i===e.CriteriaType.Compare){var l=/^(<>|=|[><]=?)/.exec(o)[0],c=o.substr(l.length);return a=!(r=""===c?t.NULL_VAR:Ze(n,new t.StringVar(c))).isString()||"="!==l&&"<>"!==l?null:Ge(r.getValue()),De(n,r,{type:l,regex:a})}return null}function De(e,t,n){var r=Fe(e,n,t);return!t.isNumber()||"="!==n.type&&"<>"!==n.type?r:function(t){var n=t.isString()?t.toNumberVar(e.service):t;return r(n)}}function Fe(e,t,n){var r,i=t.type;if("="!==i&&"<>"!==i&&n.isNull())return function(){return!1};switch(t.type){case"=":r=function(e){return Be(n,e,t.regex)};break;case"<>":r=function(e){return!Be(n,e,t.regex)};break;case">=":r=function(t){return!He(e,n,t)};break;case"<=":r=function(t){return!Ve(e,n,t)};break;case">":r=function(t){return Ve(e,n,t)};break;case"<":r=function(t){return He(e,n,t)};break;default:throw new Error("Unexpected info type")}var o="<>"===i;return function(e){return n.type!==e.type?o:r(e)}}function Be(e,t,n){var r;return e.isString()&&t.isString()?null!==(r=null==n?void 0:n.test(t.getValue()))&&void 0!==r&&r:e.equals(t)}function Ve(e,t,n){return Ne(n)?n.greaterThan(t):t.isError()&&n.isError()?t.errorType<n.errorType:t.getValue(e)<n.getValue(e)}function He(e,t,n){return Ne(n)?n.lessThan(t):t.isError()&&n.isError()?t.errorType>n.errorType:t.getValue(e)>n.getValue(e)}function Ue(n){if(!n.isString())return e.CriteriaType.Single;var r=n.getValue(),i=r.toUpperCase();return t.ERROR_VAR_MAP[i]||t.BOOLEAN_VAR_MAP[i]?e.CriteriaType.Single:r.match(/^(<>|=|[><]=?)/)?e.CriteriaType.Compare:r.match(/[~?*]+/)?e.CriteriaType.WildCard:e.CriteriaType.Single}function Ze(e,t){return t.isString()?xe(e,t.getValue()):t}function We(e){return e.replace(/[|\\{}()[\]^$+.]/g,"\\$&")}function je(e){return We(e).replace(/~~|~\?|~\*|\?|\*/g,(function(e){switch(e){case"~~":return"~";case"~?":return"\\?";case"~*":return"\\*";case"?":return".";case"*":return"[\\s\\S]*";default:return e}}))}function Ge(e){var t=je(e);return new RegExp("^".concat(t,"$"),"i")}function ze(e){for(var t,n=[],r=0,i=/\*/g;t=i.exec(e);){for(var o=0,a=t.index-1;"~"===e[a];)o++,a--;if(o%2==0){var s=e.substring(r,t.index);""===s&&0!==n.length||n.push(s),r=t.index+1}}var u=e.substring(r);return""===u&&""===n[n.length-1]||n.push(u),n}function Ye(e){var t=ze(e);if(t.length<=1)return Ge(e);var n=t.map((function(e,n){var r=je(e);return 0===n?new RegExp("^".concat(r),"ig"):n===t.length-1?new RegExp("".concat(r,"$"),"ig"):new RegExp(r,"ig")}));return{test:function(e){for(var t=0,r=0,i=n.length;r<i;r++){var o=n[r];if(o.lastIndex=t,!o.test(e))return!1;t=o.lastIndex}return!0}}}function Xe(e){var t=Math.floor(e-25569),n=new Date(86400*t*1e3);return"".concat(n.getMonth()+1,"/").concat(n.getDate(),"/").concat(n.getFullYear())}function Ke(e,t){var n=R(e*Math.sqrt(2)),r=2*parseFloat(n.toString())-1;return n=R(t*Math.sqrt(2)),r=2*parseFloat(n.toString())-1-r}function qe(e,t){return 0!==t?qe(t,e%t):e}function $e(e,t){return e/qe(e,t)*t}function Je(e,n,r,i){var o,s,u=i,l=function(n){var i,o=n.iter(e).map((function(n){if(n.isCollection())return t.VALUE_ERR_VAR;if(n.isBool())return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:"",index:-1,value:n.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE});if(n.isNull())return new t.NumberVar(0);if(n.isError())return n;var r=n.toNumberVar(e.service);return r.isNull()?t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:"",index:-1,value:n.getValue(),argType:t.FormulaErrorPhrases.DATA_TYPE_STRING,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE}):r.getValue()<0?t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_POSITIVE_OR_ZERO]({funcName:"",index:-1}):r})).exitWhen((function(e){var t=e.isError();return t&&(i=e),t})).reduce((function(e,t){return r(Math.floor(e.getValue()),t)}),u);if(i)return{value:i};u=o};try{for(var c=a(n),h=c.next();!h.done;h=c.next()){var d=l(h.value);if("object"==typeof d)return d.value}}catch(e){o={error:e}}finally{try{h&&!h.done&&(s=c.return)&&s.call(c)}finally{if(o)throw o.error}}return new t.NumberVar(u)}function Qe(e){var n,r,i=0,o=!1,s=function(e){var t;if(e.exitWhen((function(e){var n=e.isError();return n&&(t=e),n})).filter((function(e){return e.isNumber()})).forEach((function(e){(!1===o||i<e.getValue())&&(i=e.getValue(),o=!0)})),t)return{value:t}};try{for(var u=a(e()),l=u.next();!l.done;l=u.next()){var c=s(l.value);if("object"==typeof c)return c.value}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}return new t.NumberVar(i)}function et(e,n){var r=e.getValue(),i=n.getValue();if(0===r&&i<=0)return 0===i?t.NUM_ERR_VAR:t.tractorErrorVarCreators[t.ErrorCode.DIV0_POSITIVE_OVERFLOW]({upperBound:t.MAX_NUMBER_VALUE});var o=Math.pow(r,i);return Number.isFinite(o)?new t.NumberVar(o):t.NUM_ERR_VAR}function tt(e,n){var r,i,o=1,s=!1;try{for(var u=a(n()),l=u.next();!l.done;l=u.next()){var c=l.value.map((function(t){return t.isError()||t.isNull()||t.isString()?t:t.toNumberVar(e.service)})).filter((function(e){return!e.isNull()&&!e.isString()})).first_if((function(e){return!!e.isError()||(o*=e.getValue(),s=!0,!1)}));if(c)return c}}catch(e){r={error:e}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}return s?new t.NumberVar(o):new t.NumberVar(0)}function nt(e,n,r){var i,o,s=[],u=function(e){var t;if(e.exitWhen((function(e){return!!e.isError()&&(t=e,!0)})).filter((function(e){return e.isNumber()})).forEach((function(e){s.push(e.getValue())})),t)return{value:t}};try{for(var l=a(n()),c=l.next();!c.done;c=l.next()){var h=u(c.value);if("object"==typeof h)return h.value}}catch(e){i={error:e}}finally{try{c&&!c.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}if(0===s.length)return t.tractorErrorVarCreators[t.ErrorCode.NUM_NO_VALID_DATA]({funcName:r});s.sort((function(e,t){return e>t?1:e===t?0:-1}));var d=(e*s.length+4-e)/4-1;if(Number.isInteger(d))return new t.NumberVar(s[d]);var f=s[Math.floor(d)]*(Math.ceil(d)-d)+s[Math.ceil(d)]*(d-Math.floor(d));return new t.NumberVar(f)}function rt(e,n){var r,i,o=u(n);if(o.isError())return o;var s=o.getValue(),l=0,c=0;try{for(var h=a(n()),d=h.next();!d.done;d=h.next())d.value.exitWhen((function(e){return e.isError()})).filter((function(e){return e.isNumber()})).forEach((function(e){return c+=Math.pow(e.getValue()-s,2),l++,!1}))}catch(e){r={error:e}}finally{try{d&&!d.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}var f=e?l:l-1;return f<1?t.tractorErrorVarCreators[t.ErrorCode.DIVIDE_BY_ZERO_FROM_FUNCTION_EVAL]({funcName:""}):(c/=f,new t.NumberVar(c))}function it(e,t){void 0===t&&(t=1);var n=1;for(e=Math.floor(e);e>1;e-=t)n*=e;return n}function ot(e,t){var n=1;t=Math.min(e-t,t);for(var r=1;r<=t;r++)n*=e-r+1,n/=r;return n}function at(e,n,r,i){n.isCollection()||(n=new t.ArrayVar([n]));var o,a=[];if(n.iter(e).exitWhen((function(e){var t=e.isError();return t&&(o=e),t})).filter((function(e){return e.isNumber()})).forEach((function(t){return a.push(t.getValue(e))})),o)return o;var s=r.getValue();if(s<=0||s>a.length)return t.tractorErrorVarCreators[t.ErrorCode.NUM_OUT_OF_RANGE_PARAMETER]({funcName:i,index:2,value:s.toString()});a.sort((function(e,t){return t-e}));var u=a[s-1];return new t.NumberVar(u)}function st(e,n,r,i){n.isCollection()||(n=new t.ArrayVar([n]));var o,a=[];if(n.iter(e).exitWhen((function(e){var t=e.isError();return t&&(o=e),t})).filter((function(e){return e.isNumber()})).forEach((function(t){return a.push(t.getValue(e))})),o)return o;var s=r.getValue();if(s<=0)return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_POSITIVE_OR_ZERO]({funcName:i,index:1});if(s>a.length)return t.tractorErrorVarCreators[t.ErrorCode.NUM_OUT_OF_RANGE_PARAMETER]({funcName:i,index:2,value:s.toString()});a.sort((function(e,t){return e-t}));var u=a[s-1];return new t.NumberVar(u)}function ut(e,n,r,i){var o=r.getValue();if(o>4||o<0)return t.tractorErrorVarCreators[t.ErrorCode.NUM_OUT_OF_RANGE_PARAMETER]({funcName:i,index:2,value:o.toString()});var a=function(){var t=[];return t.push(n.iter(e)),t};switch(o=Math.floor(o)){case 0:return oe(a);case 1:case 2:case 3:return nt(o,a,i);case 4:return Qe(a);default:return t.NUM_ERR_VAR}}function lt(e,n,r,i){var o=r.getValue();if(o<0||o>1)return t.tractorErrorVarCreators[t.ErrorCode.NUM_OUT_OF_RANGE_PARAMETER]({funcName:i,index:2,value:o.toString()});var a,s=[];if(n.iter(e).exitWhen((function(e){var t=e.isError();return t&&(a=e),t})).filter((function(e){return e.isNumber()})).forEach((function(t){return s.push(t.getValue(e))})),a)return a;var u=s.length;if(0===u)return t.tractorErrorVarCreators[t.ErrorCode.NUM_NO_VALID_DATA]({funcName:i});if(1===u)return new t.NumberVar(s[0]);if(s=s.sort((function(e,t){return e-t})),t.NumberVar.doubleEqual(o,1))return new t.NumberVar(s[u-1]);var l=o*(u-1),c=Math.floor(l),h=l-c,d=s[c],f=d+h*(s[c+1]-d);return new t.NumberVar(f)}e.CriteriaType=void 0,(Ee=e.CriteriaType||(e.CriteriaType={}))[Ee.Single=0]="Single",Ee[Ee.Compare=1]="Compare",Ee[Ee.WildCard=2]="WildCard",e.ComparableVarType=t.VAR_TYPE.NUMBER|t.VAR_TYPE.STRING|t.VAR_TYPE.BOOL,e.SheetDate={MIN_DATE_VALUE:0,MAX_DATE_VALUE:2958465},e.covarVar=function(e,n,r,i){void 0===i&&(i=!1);for(var o=[],a=[],s=0,u=0,l=0,c=0;c<e.size();++c){var h=e.nth(c,r),d=n.nth(c,r);if(h.isError())return h;if(d.isError())return d;if(h.isNumber()&&d.isNumber()){var f=h.getValue(),p=d.getValue();o.push(f),a.push(p),s++,u+=f,l+=p}}if(s<=0)return t.tractorErrorVarCreators[t.ErrorCode.DIV0_NO_VALID_DATA]({funcName:""});if(i&&1===s)return t.tractorErrorVarCreators[t.ErrorCode.DIVIDE_BY_ZERO_FROM_FUNCTION_EVAL]({funcName:""});var v=u/s,g=l/s,_=0;for(c=0;c<o.length;c++)_+=(o[c]-v)*(a[c]-g);var y=i?_/(s-1):_/s;return new t.NumberVar(y)};var ct=40,ht=10,dt=7;e.HEX2DECFunc=function(n){function i(){var e=null!==n&&n.apply(this,arguments)||this;return e.name="HEX2DEC",e.operands=1,e.optionOperands=0,e.resultType=t.VAR_TYPE.NUMBER,e.repeatedLastParam=0,e.paramsDesc=[{type:t.VAR_TYPE.STRING|t.VAR_TYPE.BOOL,default:t.NA_ERR_VAR}],e}return r(i,n),i.prototype.func=function(n,r){if(r.isBool())return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:1,value:r.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_STRING});var i,o=r.getValue();if(o.slice(0,2).toLowerCase()===e.HEX_PREFIX&&(o=o.slice(2)),!b(o))return t.tractorErrorVarCreators[t.ErrorCode.INVALID_NON_DECIMAL_REPRESENTATION]({funcName:this.name,value:o,validValue:t.FormulaErrorPhrases.HEXADECIMAL});var a=o.length;return a>ht?t.tractorErrorVarCreators[t.ErrorCode.STRING_TOO_LONG]({funcName:this.name,index:1,textLength:a,maxTextLength:10}):(i=o.length<ht||o.length===ht&&Number(o[0])<=dt?parseInt(o,16):-1*parseInt(y(parseInt(o,16).toString(2),ct).slice(3),2),new t.NumberVar(i))},i}(t.FuncOpBase),e.IFERRORFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="IFERROR",n.operands=2,n.optionOperands=0,n.resultType=t.VAR_TYPE.PRIMITIVE|t.VAR_TYPE.COLLECTION,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.STRING|t.VAR_TYPE.NULL|t.VAR_TYPE.ERROR|t.VAR_TYPE.BOOL},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.STRING|t.VAR_TYPE.NULL|t.VAR_TYPE.ERROR|t.VAR_TYPE.BOOL|t.VAR_TYPE.OPERATOR}],n}return r(n,e),n.prototype.func=function(e,n,r){return n.isNull()?new t.NumberVar(0):n.isError()?r.isOp()?r.getVar(e):r:n},n}(t.FuncOpBase),e.IMLNFunc=function(n){function i(){var e=null!==n&&n.apply(this,arguments)||this;return e.name="IMLN",e.operands=1,e.optionOperands=0,e.resultType=t.VAR_TYPE.STRING,e.repeatedLastParam=0,e.paramsDesc=[{type:t.VAR_TYPE.STRING|t.VAR_TYPE.BOOL}],e}return r(i,n),i.prototype.func=function(n,r){if(r.isBool())return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:1,value:r.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_STRING});var i,o=r.getValue();if(!Te(o))return t.tractorErrorVarCreators[t.ErrorCode.INVALID_COMPLEX_NUMBER]();try{i=Re(o).log()}catch(e){return t.tractorErrorVarCreators[t.ErrorCode.INVALID_COMPLEX_NUMBER]()}var a=e.ComplexSuffix.i;0!==i.im&&o[o.length-1]===e.ComplexSuffix.j&&(a=e.ComplexSuffix.j);var s=we(i,a);return new t.StringVar(s)},i}(t.FuncOpBase),e.IMARGUMENTFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="IMARGUMENT",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.STRING|t.VAR_TYPE.BOOL}],n}return r(n,e),n.prototype.func=function(e,n){if(n.isBool())return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:1,value:n.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_STRING});var r,i=n.getValue().replace(/\s/g,"");if(!Te(i))return t.tractorErrorVarCreators[t.ErrorCode.INVALID_COMPLEX_NUMBER]();try{r=Re(i)}catch(e){return t.tractorErrorVarCreators[t.ErrorCode.INVALID_COMPLEX_NUMBER]()}var o=r.re,a=r.im,s=Math.atan2(a,o);return new t.NumberVar(s)},n}(t.FuncOpBase),e.IMEXPFunc=function(n){function i(){var e=null!==n&&n.apply(this,arguments)||this;return e.name="IMEXP",e.operands=1,e.optionOperands=0,e.resultType=t.VAR_TYPE.STRING,e.repeatedLastParam=0,e.paramsDesc=[{type:t.VAR_TYPE.STRING|t.VAR_TYPE.BOOL}],e}return r(i,n),i.prototype.func=function(n,r){if(r.isBool())return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:1,value:r.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_STRING});var i,o=r.getValue();if(!Te(o))return t.tractorErrorVarCreators[t.ErrorCode.INVALID_COMPLEX_NUMBER]();try{i=Re(o).exp()}catch(e){return t.tractorErrorVarCreators[t.ErrorCode.INVALID_COMPLEX_NUMBER]()}var a=e.ComplexSuffix.i;0!==i.im&&o[o.length-1]===e.ComplexSuffix.j&&(a=e.ComplexSuffix.j);var s=we(i,a);return new t.StringVar(s)},i}(t.FuncOpBase),e.IMCOSFunc=function(n){function i(){var e=null!==n&&n.apply(this,arguments)||this;return e.name="IMCOS",e.operands=1,e.optionOperands=0,e.resultType=t.VAR_TYPE.STRING,e.repeatedLastParam=0,e.paramsDesc=[{type:t.VAR_TYPE.STRING|t.VAR_TYPE.BOOL}],e}return r(i,n),i.prototype.func=function(n,r){if(r.isBool())return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:1,value:r.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_STRING});var i,o=r.getValue().replace(/\s/g,"");if(!Te(o))return t.tractorErrorVarCreators[t.ErrorCode.INVALID_COMPLEX_NUMBER]();try{i=Re(o)}catch(e){return t.tractorErrorVarCreators[t.ErrorCode.INVALID_COMPLEX_NUMBER]()}var a=i.re,s=i.im,u=Math.cos(a)*Math.cosh(s),l=-Math.sin(a)*Math.sinh(s),c=we(new ae.exports.Complex(u,l),o.endsWith(e.ComplexSuffix.j)?e.ComplexSuffix.j:e.ComplexSuffix.i);return new t.StringVar(c)},i}(t.FuncOpBase),e.IMABSFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="IMABS",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.STRING|t.VAR_TYPE.BOOL}],n}return r(n,e),n.prototype.func=function(e,n){if(n.isBool())return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:1,value:n.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_STRING});var r,i=n.getValue().replace(/\s/g,"");if(!Te(i))return t.tractorErrorVarCreators[t.ErrorCode.INVALID_COMPLEX_NUMBER]();try{r=Re(i)}catch(e){return t.tractorErrorVarCreators[t.ErrorCode.INVALID_COMPLEX_NUMBER]()}var o=r.re,a=r.im,s=Math.sqrt(Math.pow(o,2)+Math.pow(a,2));return new t.NumberVar(s)},n}(t.FuncOpBase),e.IMAGINARYFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="IMAGINARY",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.STRING|t.VAR_TYPE.BOOL}],n}return r(n,e),n.prototype.func=function(e,n){if(n.isBool())return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:1,value:n.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_STRING});var r,i=n.getValue().replace(/\s/g,"");if(!Te(i))return t.tractorErrorVarCreators[t.ErrorCode.INVALID_COMPLEX_NUMBER]();try{r=Re(i)}catch(e){return t.tractorErrorVarCreators[t.ErrorCode.INVALID_COMPLEX_NUMBER]()}var o=r.im;return new t.NumberVar(o)},n}(t.FuncOpBase),e.IMCONJUGATEFunc=function(n){function i(){var e=null!==n&&n.apply(this,arguments)||this;return e.name="IMCONJUGATE",e.operands=1,e.optionOperands=0,e.resultType=t.VAR_TYPE.STRING,e.repeatedLastParam=0,e.paramsDesc=[{type:t.VAR_TYPE.STRING|t.VAR_TYPE.BOOL}],e}return r(i,n),i.prototype.func=function(n,r){if(r.isBool())return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:1,value:r.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_STRING});var i,o=r.getValue().replace(/\s/g,"");if(!Te(o))return t.tractorErrorVarCreators[t.ErrorCode.INVALID_COMPLEX_NUMBER]();var a=o.endsWith(e.ComplexSuffix.j)?e.ComplexSuffix.j:e.ComplexSuffix.i;try{i=(i=Re(o)).conjugate()}catch(e){return t.tractorErrorVarCreators[t.ErrorCode.INVALID_COMPLEX_NUMBER]()}var s=we(i,a);return new t.StringVar(s)},i}(t.FuncOpBase),e.IMDIVFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="IMDIV",n.operands=2,n.optionOperands=0,n.resultType=t.VAR_TYPE.STRING,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.STRING|t.VAR_TYPE.BOOL,default:t.NA_ERR_VAR},{type:t.VAR_TYPE.STRING|t.VAR_TYPE.BOOL,default:t.NA_ERR_VAR}],n}return r(n,e),n.prototype.func=function(e,n,r){if(n.isBool()||r.isBool()){var i=n.isBool()?1:2,o=1===i?n:r,a=1===i?t.FormulaErrorPhrases.DATA_TYPE_STRING:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE;return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:1,value:o.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:a})}var s=n.getValue().replace(/\s/g,""),u=r.getValue().replace(/\s/g,"");if(!Te(s)||!Te(u))return t.tractorErrorVarCreators[t.ErrorCode.INVALID_COMPLEX_NUMBER]();var l,c,h,d=Se(s,u),f=d.isSame,p=d.suffix;if(!f)return t.tractorErrorVarCreators[t.ErrorCode.COMPLEX_NUMBERS_WITH_DIFFERENT_SUFFIXES]();try{l=Re(s),c=Re(u),h=l.div(c)}catch(e){return t.tractorErrorVarCreators[t.ErrorCode.INVALID_COMPLEX_NUMBER]()}if(!Number.isFinite(h.im)||!Number.isFinite(h.re))return t.NA_ERR_VAR;var v=we(h,p);return new t.StringVar(v)},n}(t.FuncOpBase),e.GAMMAINVFunc=function(e){function n(n){void 0===n&&(n="GAMMA.INV");var r=e.call(this,n)||this;return r.name=n,r.operands=3,r.optionOperands=0,r.resultType=t.VAR_TYPE.NUMBER,r.repeatedLastParam=0,r.paramsDesc=[{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER}],r}return r(n,e),n.prototype.func=function(e,n,r,i){var o=n.getValue(),a=r.getValue(),s=i.getValue();if(o<0)return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_POSITIVE_OR_ZERO]({funcName:this.name,index:1});if(o>1)return t.tractorErrorVarCreators[t.ErrorCode.POSITIVE_OVERFLOW]({upperBound:t.MAX_NUMBER_VALUE});if(a<=0||s<=0){var u=a<=s?2:3,l=2===u?a:s;return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN]({funcName:this.name,index:u,value:l,lowerBound:0})}var c=x(o,a,s);return c===1/0?t.tractorErrorVarCreators[t.ErrorCode.POSITIVE_OVERFLOW]({upperBound:t.MAX_NUMBER_VALUE}):new t.NumberVar(c)},n}(t.FuncOpBase),e.GAMMALNFunc=function(e){function n(n){void 0===n&&(n="GAMMALN");var r=e.call(this,n)||this;return r.name=n,r.operands=1,r.optionOperands=0,r.resultType=t.VAR_TYPE.NUMBER,r.repeatedLastParam=0,r.paramsDesc=[{type:t.VAR_TYPE.NUMBER}],r}return r(n,e),n.prototype.func=function(e,n){var r=n.getValue();return new t.NumberVar(M(r))},n}(t.FuncOpBase),e.CHARFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="CHAR",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.STRING,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)}],n}return r(n,e),n.prototype.func=function(e,n){var r=n.getValue();return r<=0?t.tractorErrorVarCreators[t.ErrorCode.OUT_OF_RANGE_PARAMETER]({funcName:this.name,index:1,value:r.toString()}):new t.StringVar(String.fromCharCode(r))},n}(t.FuncOpBase),e.COMBINFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="COMBIN",n.operands=2,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n,r){var i=Math.floor(n.getValue()),o=Math.floor(r.getValue());return i<0||o<0?t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_POSITIVE_OR_ZERO]({funcName:this.name,index:i<0?1:2}):i<o?t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_SHOULD_BE_LESS_THAN_OR_EQUAL_TO_OTHER_PARAM]({funcName:this.name,index:2,value:o,secondArgIndex:1,upperBound:i}):new t.NumberVar(ot(i,o))},n}(t.FuncOpBase),e.CONTAINSFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="CONTAINS",n.operands=1,n.optionOperands=255,n.resultType=t.VAR_TYPE.BOOL,n.repeatedLastParam=1,n.paramsDesc=[{type:t.VAR_TYPE.BASIC|t.VAR_TYPE.COLLECTION},{type:t.VAR_TYPE.BASIC|t.VAR_TYPE.COLLECTION}],n}return r(n,e),n.prototype.func=function(e,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(n.isNull())return t.VALUE_ERR_VAR;if(0===r.length)return new t.BooleanVar(!1);var o=!1;return r.forEach((function(t){n.iter(e).forEach((function(n){t.iter(e).forEach((function(t){o||n.getValue(e)!==t.getValue(e)||(o=!0)}))}))})),new t.BooleanVar(o)},n}(t.FuncOpBase),e.DEGREESFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="DEGREES",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n){return new t.NumberVar(180*n.getValue()/Math.PI)},n}(t.FuncOpBase),e.ERFCFunc=function(e){function n(n){void 0===n&&(n="ERFC");var r=e.call(this,n)||this;return r.name=n,r.operands=1,r.optionOperands=0,r.resultType=t.VAR_TYPE.NUMBER,r.repeatedLastParam=0,r.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL,default:new t.NullVar}],r}return r(n,e),n.prototype.func=function(e,n){if(!n.isNumber())return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:1,value:n.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE});var r=1-Ke(0,n.getValue());return new t.NumberVar(r)},n}(t.FuncOpBase),e.EFFECTFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="EFFECT",n.operands=2,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL,default:t.NA_ERR_VAR},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL,default:t.NA_ERR_VAR}],n}return r(n,e),n.prototype.func=function(e,n,r){if(n.isBool()||r.isBool()){var i=n.isBool(),o=i?1:2,a=i?n.getValue():r.getValue();return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:o,value:a.toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE})}var s=n.getValue(),u=Math.floor(r.getValue());if(s<=0)return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN]({funcName:this.name,index:1,value:s,lowerBound:0});if(u<1)return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO]({funcName:this.name,index:2,value:u,lowerBound:1});var l=Math.pow(1+s/u,u)-1;return new t.NumberVar(l)},n}(t.FuncOpBase),e.ENCODEURLFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="ENCODEURL",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.STRING,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.STRING}],n}return r(n,e),n.prototype.func=function(e,n){try{var r=encodeURIComponent(n.getValue()).replace(/[!~'()*]/g,(function(e){return"%".concat(e.codePointAt(0).toString(16).toUpperCase())}));return new t.StringVar(r)}catch(e){return t.tractorErrorVarCreators[t.ErrorCode.UNABLE_TO_ENCODE_INPUT_TEXT]()}},n}(t.FuncOpBase),e.IFFunc=function(e){function n(){var n,r=null!==e&&e.apply(this,arguments)||this;return r.name="IF",r.operands=2,r.optionOperands=1,r.resultType=t.VAR_TYPE.BASIC,r.repeatedLastParam=0,r.paramsDesc=[{type:t.VAR_TYPE.BOOL},{type:t.VAR_TYPE.ATOM},{type:t.VAR_TYPE.ATOM,default:(n={},n[t.DefaultParam.IfNotInput]=new t.BooleanVar(!1),n[t.DefaultParam.IfInputNull]=t.NULL_VAR,n)}],r}return r(n,e),n.prototype.func=function(e,t,n,r){return t.getValue()?n:r},n}(t.FuncOpBase),e.ERFFunc=function(e){function n(){var n,r=null!==e&&e.apply(this,arguments)||this;return r.name="ERF",r.operands=1,r.optionOperands=1,r.resultType=t.VAR_TYPE.NUMBER,r.repeatedLastParam=0,r.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL,default:t.NA_ERR_VAR},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL|t.VAR_TYPE.NULL,default:(n={},n[t.DefaultParam.IfInputNull]=t.NA_ERR_VAR,n[t.DefaultParam.IfNotInput]=new t.NullVar,n)}],r}return r(n,e),n.prototype.func=function(e,n,r){if(n.isBool()||r.isBool()){var i=n.isBool(),o=i?1:2,a=i?n.getValue():r.getValue();return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:o,value:a.toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE})}var s,u=n.getValue();r.isNull()?(s=u,u=0):s=r.getValue();var l=Ke(u,s);return new t.NumberVar(l)},n}(t.FuncOpBase),e.ERFPRECISEFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="ERF.PRECISE",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL,default:t.VALUE_ERR_VAR}],n}return r(n,e),n.prototype.func=function(e,n){if(!n.isNumber())return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:1,value:n.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE});var r=Ke(0,n.getValue());return new t.NumberVar(r)},n}(t.FuncOpBase),e.FVSCHEDULEFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="FVSCHEDULE",n.operands=2,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL,default:t.NA_ERR_VAR},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION,default:t.NA_ERR_VAR}],n}return r(n,e),n.prototype.func=function(e,n,r){if(!n.isNumber())return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:1,value:n.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE});var i=n.getValue();if(r.isCollection()){var o=r.iter(e).filter((function(e){return!e.isNull()})).first_if((function(e){if(e.isError())return!0;if(!e.isNumber())return!0;var t=e.getValue();return i*=1+t,!1}));if(o){if(o.isError())return o;var a=o.isString()?t.FormulaErrorPhrases.DATA_TYPE_STRING:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN;return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:2,value:o.getValue(),argType:a,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE})}}else{if(!r.isNumber())return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:2,value:r.getValue(),argType:t.FormulaErrorPhrases.DATA_TYPE_STRING,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE});var s=r.getValue();i*=1+s}return new t.NumberVar(i)},n}(t.FuncOpBase),e.CONCATFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="CONCAT",n.operands=1,n.optionOperands=255,n.resultType=t.VAR_TYPE.STRING,n.repeatedLastParam=1,n.paramsDesc=[{type:t.VAR_TYPE.STRING|t.VAR_TYPE.COLLECTION},{type:t.VAR_TYPE.STRING|t.VAR_TYPE.COLLECTION}],n}return r(n,e),n.prototype.func=function(e){for(var n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];var s="",u=function(t){var n;if(t.iter(e).filter((function(e){return e.isPrimitive()})).exitWhen((function(e){var t=e.isError();return t&&(n=e),t})).forEach((function(t){var n=t.toStringVar(e.service).getValue();s+=n})),n)return{value:n}};try{for(var l=a(i),c=l.next();!c.done;c=l.next()){var h=u(c.value);if("object"==typeof h)return h.value}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}return new t.StringVar(s)},n}(t.FuncOpBase);var ft=32767;e.CONCATENATEFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="CONCATENATE",n.operands=1,n.optionOperands=255,n.resultType=t.VAR_TYPE.STRING,n.repeatedLastParam=1,n.paramsDesc=[{type:t.VAR_TYPE.STRING|t.VAR_TYPE.COLLECTION},{type:t.VAR_TYPE.STRING|t.VAR_TYPE.COLLECTION}],n}return r(n,e),n.prototype.func=function(e){for(var n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];var s="",u=function(n){var r=null,i=n.iter(e).filter((function(e){return e.isPrimitive()})).exitWhen((function(e){var t=e.isError();return t&&(r=e),t})).map((function(t){return t.toStringVar(e.service)})).filter((function(e){return!e.isNull()})).first_if((function(t){var n=t.getValue(e);return"string"==typeof n&&s.length+n.length>ft||(s+=n,!1)}));return null!==r?{value:r}:null!==i?{value:t.VALUE_ERR_VAR}:void 0};try{for(var l=a(i),c=l.next();!c.done;c=l.next()){var h=u(c.value);if("object"==typeof h)return h.value}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}return new t.StringVar(s)},n}(t.FuncOpBase),e.DELTAFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="DELTA",n.operands=1,n.optionOperands=1,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.BOOL|t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)},{type:t.VAR_TYPE.BOOL|t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)}],n}return r(n,e),n.prototype.func=function(e,n,r){if(!n.isNumber()||!r.isNumber()){var i=n.isNumber(),o=i?2:1,a=i?r.getValue():n.getValue();return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:o,value:a.toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE})}return new t.NumberVar(n.getValue()===r.getValue()?1:0)},n}(t.FuncOpBase),e.RANDFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="RAND",n.operands=0,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[],n.alwaysCalc=!0,n}return r(n,e),n.prototype.func=function(){return new t.NumberVar(Math.random())},n}(t.FuncOpBase),e.ROUNDFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="ROUND",n.operands=2,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER}],n.calcCustomData=t.getFirstCustomData,n}return r(n,e),n.prototype.func=function(e,n,r){return new t.NumberVar(de(n.getValue(),0|r.getValue()))},n}(t.FuncOpBase),e.ROUNDDOWNFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="ROUNDDOWN",n.operands=2,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n,r){var i=n.getValue(),o=0|r.getValue(),a=i*(o=Math.pow(10,o));return new t.NumberVar(i>=0?ge(a)/o:ve(a)/o)},n}(t.FuncOpBase),e.ROUNDUPFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="ROUNDUP",n.operands=2,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n,r){var i=n.getValue(),o=0|r.getValue(),a=i*(o=Math.pow(10,o));return new t.NumberVar(i>=0?ve(a)/o:ge(a)/o)},n}(t.FuncOpBase),e.MAXFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="MAX",n.operands=1,n.optionOperands=255,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=1,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION}],n.calcCustomData=t.getFirstValidCustomData,n}return r(n,e),n.prototype.func=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Qe((function(){var n,r,i=[];try{for(var o=a(t),s=o.next();!s.done;s=o.next()){var u=s.value;i.push(u.iter(e))}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}))},n}(t.FuncOpBase),e.EXPFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="EXP",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)}],n}return r(n,e),n.prototype.func=function(e,n){var r=Math.exp(n.getValue());return Number.isFinite(r)?new t.NumberVar(r):t.tractorErrorVarCreators[t.ErrorCode.POSITIVE_OVERFLOW]({upperBound:t.MAX_NUMBER_VALUE})},n}(t.FuncOpBase),e.EVENFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="EVEN",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n){var r=n.getValue()<0,i=Math.ceil(Math.abs(n.getValue())),o=i%2==0?i:i+1;return new t.NumberVar(r?-o:o)},n}(t.FuncOpBase),e.IFSFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="IFS",n.operands=2,n.optionOperands=127,n.resultType=t.VAR_TYPE.PRIMITIVE|t.VAR_TYPE.COLLECTION,n.repeatedLastParam=2,n.paramsDesc=[{type:t.VAR_TYPE.BOOL},{type:t.VAR_TYPE.STRING|t.VAR_TYPE.BOOL|t.VAR_TYPE.NUMBER|t.VAR_TYPE.OPERATOR},{type:t.VAR_TYPE.BOOL},{type:t.VAR_TYPE.STRING|t.VAR_TYPE.BOOL|t.VAR_TYPE.NUMBER|t.VAR_TYPE.OPERATOR}],n}return r(n,e),n.prototype.func=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];for(var i=0;i<n.length;i+=2){var o=n[i],a=n[i+1];if(o.isOp()&&(o=o.getVar(e)),o.isError())return o;if(o.toBooleanVar(e.service).getValue())return a.isOp()?a.getVar(e):a}return t.tractorErrorVarCreators[t.ErrorCode.NO_MATCH]()},n}(t.FuncOpBase),e.IMLOG2Func=function(n){function i(){var e=null!==n&&n.apply(this,arguments)||this;return e.name="IMLOG2",e.operands=1,e.optionOperands=0,e.resultType=t.VAR_TYPE.STRING,e.repeatedLastParam=0,e.paramsDesc=[{type:t.VAR_TYPE.STRING|t.VAR_TYPE.BOOL}],e}return r(i,n),i.prototype.func=function(n,r){if(r.isBool())return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:1,value:r.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_STRING});var i,o=r.getValue();if(!Te(o))return t.tractorErrorVarCreators[t.ErrorCode.INVALID_COMPLEX_NUMBER]();try{i=Ae(Re(o))}catch(e){return t.tractorErrorVarCreators[t.ErrorCode.INVALID_COMPLEX_NUMBER]()}var a=i.toString().replace(/\s/g,"");return 0!==i.im&&o[o.length-1]===e.ComplexSuffix.j&&(a=a.replace(e.ComplexSuffix.i,e.ComplexSuffix.j)),new t.StringVar(a)},i}(t.FuncOpBase),e.IMLOG10Func=function(n){function i(){var e=null!==n&&n.apply(this,arguments)||this;return e.name="IMLOG10",e.operands=1,e.optionOperands=0,e.resultType=t.VAR_TYPE.STRING,e.repeatedLastParam=0,e.paramsDesc=[{type:t.VAR_TYPE.STRING|t.VAR_TYPE.BOOL}],e}return r(i,n),i.prototype.func=function(n,r){if(r.isBool())return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:1,value:r.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_STRING});var i,o=r.getValue();if(!Te(o))return t.tractorErrorVarCreators[t.ErrorCode.INVALID_COMPLEX_NUMBER]();try{i=Oe(Re(o))}catch(e){return t.tractorErrorVarCreators[t.ErrorCode.INVALID_COMPLEX_NUMBER]()}var a=i.toString().replace(/\s/g,"");return 0!==i.im&&o[o.length-1]===e.ComplexSuffix.j&&(a=a.replace(e.ComplexSuffix.i,e.ComplexSuffix.j)),new t.StringVar(a)},i}(t.FuncOpBase),e.COUNTFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="COUNT",n.operands=1,n.optionOperands=255,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=1,n.paramsDesc=[{type:t.VAR_TYPE.BASIC|t.VAR_TYPE.COLLECTION},{type:t.VAR_TYPE.BASIC|t.VAR_TYPE.COLLECTION}],n}return r(n,e),n.prototype.func=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Me((function(){var n,r,i=[];try{for(var o=a(t),s=o.next();!s.done;s=o.next()){var u=s.value;u.isPrimitive()&&u.toNumberVar(e.service).isNumber()?i.push(u.toNumberVar(e.service).iter(e)):u.isCollection()&&i.push(u.iter(e))}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}))},n}(t.FuncOpBase),e.COUNTAFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="COUNTA",n.operands=1,n.optionOperands=255,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=1,n.paramsDesc=[{type:t.VAR_TYPE.BASIC|t.VAR_TYPE.COLLECTION},{type:t.VAR_TYPE.BASIC|t.VAR_TYPE.COLLECTION}],n}return r(n,e),n.prototype.func=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return ke((function(){var n,r,i=[];try{for(var o=a(t),s=o.next();!s.done;s=o.next()){var u=s.value;i.push(u.iter(e))}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}))},n}(t.FuncOpBase),e.IMSUBFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="IMSUB",n.operands=2,n.optionOperands=0,n.resultType=t.VAR_TYPE.STRING,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.STRING|t.VAR_TYPE.BOOL,default:t.NA_ERR_VAR},{type:t.VAR_TYPE.STRING|t.VAR_TYPE.BOOL,default:t.NA_ERR_VAR}],n}return r(n,e),n.prototype.func=function(e,n,r){if(n.isBool()||r.isBool()){var i=n.isBool()?1:2,o=1===i?n:r;return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:i,value:o.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_STRING})}var a=n.getValue(),s=r.getValue();if(!Te(a)||!Te(s))return t.tractorErrorVarCreators[t.ErrorCode.INVALID_COMPLEX_NUMBER]();var u,l,c,h=Se(a,s),d=h.isSame,f=h.suffix;if(!d)return t.tractorErrorVarCreators[t.ErrorCode.COMPLEX_NUMBERS_WITH_DIFFERENT_SUFFIXES]();try{u=Re(a),l=Re(s),c=u.sub(l)}catch(e){return t.tractorErrorVarCreators[t.ErrorCode.INVALID_COMPLEX_NUMBER]()}var p=we(c,f);return new t.StringVar(p)},n}(t.FuncOpBase),e.IMSUMFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="IMSUM",n.operands=1,n.optionOperands=255,n.resultType=t.VAR_TYPE.STRING,n.repeatedLastParam=1,n.paramsDesc=[{type:t.VAR_TYPE.STRING|t.VAR_TYPE.COLLECTION|t.VAR_TYPE.BOOL,default:t.NA_ERR_VAR},{type:t.VAR_TYPE.STRING|t.VAR_TYPE.COLLECTION|t.VAR_TYPE.BOOL,default:new t.StringVar("0")}],n}return r(n,e),n.prototype.func=function(e){for(var n,r,i=this,o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var l=null,c=new ae.exports.Complex(0,0),h=function(n,r){var o=null;if(r.iter(e).filter((function(e){return!e.isNull()})).first_if((function(r){if(r.isError())return o=r,!0;if(r.isBool())return o=t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:i.name,index:n+1,value:r.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_STRING}),!0;var a;if(!Te(a=r.isNumber()?r.toStringVar().getValue():r.getValue(e)))return o=t.tractorErrorVarCreators[t.ErrorCode.INVALID_COMPLEX_NUMBER](),!0;var s=Re(a);if(0===s.im)return c=c.add(s),!1;var u=Se(a,we(c,l)),h=u.isSame,d=u.suffix;return h?(c=c.add(s),l=d,!1):(o=t.tractorErrorVarCreators[t.ErrorCode.COMPLEX_NUMBERS_WITH_DIFFERENT_SUFFIXES](),!0)})),null!==o)return{value:o}};try{for(var d=a(o.entries()),f=d.next();!f.done;f=d.next()){var p=s(f.value,2),v=h(p[0],p[1]);if("object"==typeof v)return v.value}}catch(e){n={error:e}}finally{try{f&&!f.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}var g=we(c,l);return new t.StringVar(g)},n}(t.FuncOpBase),e.IMPOWERFunc=function(n){function i(){var e=null!==n&&n.apply(this,arguments)||this;return e.name="IMPOWER",e.operands=2,e.optionOperands=0,e.resultType=t.VAR_TYPE.STRING,e.repeatedLastParam=0,e.paramsDesc=[{type:t.VAR_TYPE.STRING|t.VAR_TYPE.BOOL,default:t.NA_ERR_VAR},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL,default:t.NA_ERR_VAR}],e}return r(i,n),i.prototype.func=function(n,r,i){if(r.isBool()||i.isBool()){var o=r.isBool()?1:2,a=1===o?r:i,s=1===o?t.FormulaErrorPhrases.DATA_TYPE_STRING:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE;return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:o,value:a.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:s})}var u,l=r.getValue(),c=i.getValue();if(!Te(l))return t.tractorErrorVarCreators[t.ErrorCode.INVALID_COMPLEX_NUMBER]();try{u=Re(l).pow(new ae.exports.Complex(c,0))}catch(e){return t.tractorErrorVarCreators[t.ErrorCode.INVALID_COMPLEX_NUMBER]()}var h=e.ComplexSuffix.i;0!==u.im&&l[l.length-1]===e.ComplexSuffix.j&&(h=e.ComplexSuffix.j);var d=we(u,h);return new t.StringVar(d)},i}(t.FuncOpBase),e.REPLACEFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="REPLACE",n.operands=4,n.optionOperands=0,n.resultType=t.VAR_TYPE.STRING,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.STRING,default:new t.StringVar("")},{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)},{type:t.VAR_TYPE.STRING,default:new t.StringVar("")}],n}return r(n,e),n.prototype.func=function(e,n,r,i,o){var a=n.getValue(),s=Math.floor(r.getValue()),u=Math.floor(i.getValue());if(s<=0)return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO]({funcName:this.name,index:2,value:s,lowerBound:1});if(u<0)return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_SHOULD_BE_POSITIVE_OR_ZERO]({funcName:this.name,index:3});var l=a.slice(0,s-1),c=a.slice(s+u-1,a.length),h=l+o.getValue()+c;return new t.StringVar(h)},n}(t.FuncOpBase),e.INTERCEPTFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="INTERCEPT",n.operands=2,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.COLLECTION|t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.COLLECTION|t.VAR_TYPE.NUMBER}],n.convertVariant=function(e,n){var r=n.argument;return!r.isPrimitive()||r.isError()||r.isNumber()?t.transformVariant(e,n):{isError:!0,convertedArgument:t.VALUE_ERR_VAR,srcArg:r}},n}return r(n,e),n.prototype.func=function(e,n,r){if(r.isNumber()&&(r=new t.ArrayVar([r])),n.isNumber()&&(n=new t.ArrayVar([n])),r.size()!==n.size())return t.tractorErrorVarCreators[t.ErrorCode.ARGUMENT_SIZES_NOT_EQUAL]({funcName:this.name,argCount:r.size(),requiredOperandCount:n.size()});for(var i=r.size(),o=[],a=[],s=0,u=0,l=0;l<i;l++){var c=r.nth(l,e),h=n.nth(l,e);if(c.isError()||h.isError())return c.isError()?c:h;c.isNumber()&&h.isNumber()&&(s+=c.getValue(),u+=h.getValue(),o.push(c.getValue()),a.push(h.getValue()))}if((i=o.length)<=1)return t.tractorErrorVarCreators[t.ErrorCode.DIV0_NO_VALID_DATA]({funcName:this.name});var d=s/i,f=u/i,p=0,v=0;for(l=0;l<i;l++)p+=(o[l]-d)*(a[l]-f),v+=Math.pow(o[l]-d,2);var g=f-p/v*d;return new t.NumberVar(g)},n}(t.FuncOpBase),e.LARGEFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="LARGE",n.operands=2,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION},{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,t,n){return at(e,t,n,this.name)},n}(t.FuncOpBase),e.NOTFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="NOT",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.BOOL}],n}return r(n,e),n.prototype.func=function(e,n){return new t.BooleanVar(!n.getValue())},n}(t.FuncOpBase),e.NPVFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="NPV",n.operands=2,n.optionOperands=253,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=1,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION,default:new t.NumberVar(0)},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION,default:new t.NumberVar(0)}],n}return r(n,e),n.prototype.func=function(e,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];for(var o=n.getValue(),a=[],s=r.length,u=function(t){var n,i=r[t];if(i.isNumber())a.push(i.getValue());else if(i.iter(e).exitWhen((function(e){return!!e.isError()&&(n=e,!0)})).filter((function(e){return e.isNumber()})).forEach((function(t){a.push(t.getValue(e))})),n)return{value:n}},l=0;l<s;l++){var c=u(l);if("object"==typeof c)return c.value}var h=q(o,a);return new t.NumberVar(h)},n}(t.FuncOpBase),e.MIRRFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="MIRR",n.operands=3,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.convertVariant=function(e,r){if(0===r.index){var i=r.argument,o=r.parameter;if(!t.isTypeCompatible(i,o)){var a=i.isString()?t.FormulaErrorPhrases.DATA_TYPE_STRING:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN;return{isError:!0,convertedArgument:t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:n.name,index:1,value:i.getValue(),argType:a,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE}),srcArg:i}}return{isError:!1,convertedArgument:r.argument,srcArg:r.argument}}return t.transformVariant(e,r)},n.paramsDesc=[{type:t.VAR_TYPE.COLLECTION,default:t.VALUE_ERR_VAR},{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER}],n.calcCustomData=function(){return{autoFormat:"0%"}},n}return r(n,e),n.prototype.func=function(e,n,r,i){var o=[],a=[],s=null;if(n.iter(e).exitWhen((function(e){return!!e.isError()&&(s=e,!0)})).filter((function(e){return!(e.isString()||e.isBool()||e.isNull())})).forEach((function(t){var n=t.getValue(e);n>0&&a.push(n),n<0&&o.push(n)})),null!==s)return s;if(0===o.length||0===a.length)return t.tractorErrorVarCreators[t.ErrorCode.DIV0_REQUIRES_POSITIVE_AND_NEGATIVE_VALUES]({funcName:this.name});var u=o.length+a.length,l=i.getValue(),c=r.getValue(),h=-q(l,a)*Math.pow(1+l,u-1),d=q(c,o)*(1+c),f=Math.pow(h/d,1/(u-1))-1;return new t.NumberVar(f)},n}(t.FuncOpBase),e.NOMINALFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="NOMINAL",n.operands=2,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL,default:t.NA_ERR_VAR},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL,default:t.NA_ERR_VAR}],n}return r(n,e),n.prototype.func=function(e,n,r){if(n.isBool()||r.isBool()){var i=n.isBool()?1:2,o=1===i?n:r;return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:i,value:o.getValue().toString(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE})}var a=n.getValue(),s=Math.floor(r.getValue());if(a<=0)return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN]({funcName:this.name,index:1,value:a,lowerBound:0});if(s<1)return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO]({funcName:this.name,index:2,value:r.getValue(),lowerBound:1});var u=(Math.pow(a+1,1/s)-1)*s;return new t.NumberVar(u)},n}(t.FuncOpBase),e.NORMDISTFunc=function(e){function n(n){void 0===n&&(n="NORM.DIST");var r=e.call(this,n)||this;return r.name=n,r.operands=4,r.optionOperands=0,r.resultType=t.VAR_TYPE.NUMBER,r.repeatedLastParam=0,r.paramsDesc=[{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.BOOL,default:new t.BooleanVar(!1)}],r}return r(n,e),n.prototype.func=function(e,n,r,i,o){var a,s=n.getValue(),u=r.getValue(),l=i.getValue(),c=o.getValue();return l<=0?t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN]({funcName:this.name,index:1,value:l,lowerBound:0}):(a=c?R((s-u)/l):A(s,u,l),new t.NumberVar(a))},n}(t.FuncOpBase),e.NORMSDISTFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="NORM.S.DIST",n.operands=2,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.BOOL,default:new t.BooleanVar(!1)}],n}return r(n,e),n.prototype.func=function(e,n,r){var i,o=n.getValue();return i=r.getValue()?R(o):A(o,0,1),new t.NumberVar(i)},n}(t.FuncOpBase),e.NORMSDISTCDFFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="NORMSDIST",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n){var r=R(n.getValue());return new t.NumberVar(r)},n}(t.FuncOpBase),e.NPERFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="NPER",n.operands=3,n.optionOperands=2,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)}],n}return r(n,e),n.prototype.func=function(e,n,r,i,o,a){var s=n.getValue(),u=r.getValue(),l=i.getValue(),c=o.getValue(),h=a.getValue();if(0!==h&&(h=1),s<=-1)return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN]({funcName:this.name,index:1,value:s,lowerBound:0});if(0===s&&0!==u)return new t.NumberVar(-(c+l)/u);var d=u*(1+s*h)-c*s,f=u*(1+s*h)+l*s;if(0===f)return t.tractorErrorVarCreators[t.ErrorCode.DIVIDE_BY_ZERO_FROM_FUNCTION_EVAL]({funcName:this.name});var p=d/f;if(p<=0)return t.tractorErrorVarCreators[t.ErrorCode.SCENARIO_NOT_POSSIBLE]({funcName:this.name});if(s<=-1)return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN]({funcName:this.name,index:1,value:s,lowerBound:-1});var v=Math.log(p)/Math.log(1+s);return new t.NumberVar(v)},n}(t.FuncOpBase),e.IRRFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="IRR",n.operands=1,n.optionOperands=1,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION|t.VAR_TYPE.BOOL,default:t.VALUE_ERR_VAR},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(.1)}],n.calcCustomData=function(){return{autoFormat:"0%"}},n}return r(n,e),n.prototype.func=function(e,n,r){if(n.isBool())return t.tractorErrorVarCreators[t.ErrorCode.VALUE_REQUIRES_POSITIVE_AND_NEGATIVE_VALUES]({funcName:this.name});var i=r.getValue();if(i<=-1)return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_SHOULD_BE_GREATER_THAN]({funcName:this.name,index:2,value:i,lowerBound:-1});var o=[],a=!1,s=!1;if(n.iter(e).filter((function(e){return!(e.isString()||e.isBool()||e.isNull())})).first_if((function(t){if(t.isError())return!0;var n=t.getValue(e);return o.push(n),n>0&&(a=!0),n<0&&(s=!0),!1})))return t.VALUE_ERR_VAR;if(!a||!s)return t.tractorErrorVarCreators[t.ErrorCode.VALUE_REQUIRES_POSITIVE_AND_NEGATIVE_VALUES]({funcName:this.name});function u(e){return q(e,o)}var l=ne(u,i);return null===l?t.NUM_ERR_VAR:new t.NumberVar(l)},n}(t.FuncOpBase),e.IPMTFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="IPMT",n.operands=4,n.optionOperands=2,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)},{type:t.VAR_TYPE.NUMBER,default:t.NUM_ERR_VAR},{type:t.VAR_TYPE.NUMBER,default:t.NUM_ERR_VAR},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)}],n}return r(n,e),n.prototype.func=function(e,n,r,i,o,a,s){var u=n.getValue(),l=r.getValue(),c=i.getValue(),h=o.getValue(),d=a.getValue(),f=s.getValue();if(0!==f&&(f=1),l<1)return t.tractorErrorVarCreators[t.ErrorCode.NUM_OUT_OF_RANGE_PARAMETER]({funcName:this.name,index:2,value:l.toString()});if(l>c)return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO]({funcName:this.name,index:3,value:c,lowerBound:l});var p=Y(u,l,c,h,d,f);return new t.NumberVar(p)},n}(t.FuncOpBase),e.ISNUMBERFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="ISNUMBER",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.BOOL,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.BASIC}],n}return r(n,e),n.prototype.func=function(e,n){return new t.BooleanVar(n.isNumber())},n}(t.FuncOpBase),e.IMPRODUCTFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="IMPRODUCT",n.operands=1,n.optionOperands=255,n.resultType=t.VAR_TYPE.STRING,n.repeatedLastParam=1,n.paramsDesc=[{type:t.VAR_TYPE.STRING|t.VAR_TYPE.COLLECTION|t.VAR_TYPE.BOOL,default:t.NA_ERR_VAR},{type:t.VAR_TYPE.STRING|t.VAR_TYPE.COLLECTION|t.VAR_TYPE.BOOL,default:new t.StringVar("1")}],n}return r(n,e),n.prototype.func=function(e){for(var n,r,i=this,o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var l=new ae.exports.Complex(1,0),c=null,h=function(n,r){var o=null;if(r.iter(e).filter((function(e){return!e.isNull()})).first_if((function(r){if(r.isError())return o=r,!0;if(r.isBool())return o=t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:i.name,index:n+1,value:r.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_STRING}),!0;var a;if(!Te(a=r.isNumber()?r.toStringVar().getValue():r.getValue(e)))return o=t.tractorErrorVarCreators[t.ErrorCode.INVALID_COMPLEX_NUMBER](),!0;var s=Re(a);if(0===s.im)return l=l.mul(s),!1;var u=Se(a,we(l,c)),h=u.isSame,d=u.suffix;return h?(l=l.mul(s),c=d,!1):(o=t.tractorErrorVarCreators[t.ErrorCode.COMPLEX_NUMBERS_WITH_DIFFERENT_SUFFIXES](),!0)})),null!==o)return{value:o}};try{for(var d=a(o.entries()),f=d.next();!f.done;f=d.next()){var p=s(f.value,2),v=h(p[0],p[1]);if("object"==typeof v)return v.value}}catch(e){n={error:e}}finally{try{f&&!f.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}var g=we(l,c);return new t.StringVar(g)},n}(t.FuncOpBase),e.ISEVENFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="ISEVEN",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.BOOL,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL}],n}return r(n,e),n.prototype.func=function(e,n){if(n.isBool()){var r=n.getValue().toString().toUpperCase();return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:1,value:r,argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE})}return new t.BooleanVar(n.isNumber()&&Math.floor(Math.abs(n.getValue()))%2==0)},n}(t.FuncOpBase),e.ISODDFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="ISODD",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.BOOL,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL}],n}return r(n,e),n.prototype.func=function(e,n){if(n.isBool()){var r=n.getValue().toString().toUpperCase();return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:1,value:r,argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE})}return new t.BooleanVar(n.isNumber()&&Math.floor(Math.abs(n.getValue()))%2!=0)},n}(t.FuncOpBase),e.ISLOGICALFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="ISLOGICAL",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.BOOL,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.BASIC}],n}return r(n,e),n.prototype.func=function(e,n){return new t.BooleanVar(n.isBool())},n}(t.FuncOpBase),e.ISTEXTFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="ISTEXT",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.BOOL,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.BASIC}],n}return r(n,e),n.prototype.func=function(e,n){return new t.BooleanVar(n.isString())},n}(t.FuncOpBase),e.ISNONTEXTFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="ISNONTEXT",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.BOOL,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.BASIC}],n}return r(n,e),n.prototype.func=function(e,n){return new t.BooleanVar(!n.isString())},n}(t.FuncOpBase),e.PRODUCTFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="PRODUCT",n.operands=1,n.optionOperands=255,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=1,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION|t.VAR_TYPE.NULL|t.VAR_TYPE.STRING},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION|t.VAR_TYPE.NULL|t.VAR_TYPE.STRING}],n}return r(n,e),n.prototype.func=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return tt(e,(function(){var n,r,i=[];try{for(var o=a(t),s=o.next();!s.done;s=o.next()){var u=s.value;i.push(u.iter(e))}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}))},n}(t.FuncOpBase),e.POWERFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="POWER",n.operands=2,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,t,n){return et(t,n)},n}(t.FuncOpBase),e.RATEFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="RATE",n.operands=3,n.optionOperands=3,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.calcCustomData=function(){return{autoFormat:"0%"}},n.paramsDesc=[{type:t.VAR_TYPE.NUMBER,default:t.NUM_ERR_VAR},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(.1)}],n}return r(n,e),n.prototype.func=function(e,n,r,i,o,a,s){var u=n.getValue(),l=r.getValue(),c=i.getValue(),h=o.getValue(),d=a.getValue(),f=s.getValue();if(0!==d&&(d=1),0===l&&0===c)return t.tractorErrorVarCreators[t.ErrorCode.REQUIRES_POSITIVE_AND_NEGATIVE_VALUES]({funcName:this.name});if(u<=0)return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN]({funcName:this.name,index:1,value:u,lowerBound:0});function p(e){return K(e,u,l,c,d)-h}var v=ne(p,f);return null===v?t.tractorErrorVarCreators[t.ErrorCode.REQUIRES_POSITIVE_AND_NEGATIVE_VALUES]({funcName:this.name}):new t.NumberVar(v)},n}(t.FuncOpBase),e.LCMFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="LCM",n.operands=1,n.optionOperands=255,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=1,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL|t.VAR_TYPE.ERROR|t.VAR_TYPE.COLLECTION,default:t.NA_ERR_VAR},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL|t.VAR_TYPE.ERROR|t.VAR_TYPE.COLLECTION,default:new t.NumberVar(1)}],n}return r(n,e),n.prototype.func=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Je(e,t,$e,1)},n}(t.FuncOpBase),e.LENFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="LEN",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.STRING}],n}return r(n,e),n.prototype.func=function(e,n){return new t.NumberVar(n.getValue().length)},n}(t.FuncOpBase);var pt=255,vt=65535;function gt(e){return e.replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1")}function _t(e){return e.replace(/^[\s\uFEFF\u00a0]+|[\s\uFEFF\u00a0]+$/g,"").replace(/[\uFEFF\u00a0\t ]{2,}/g," ").replace(/\n/g," ")}function yt(e,t){var n=mt(e,t),r=n.min,i=n.max;return null==r?0:null==i?1:(r+1)/(r+1+e.length-i)}function mt(e,t){for(var n=null,r=null,i=0;i<e.length;i++){if(e[i]<t&&(n=i),e[i]===t)return{min:n,max:r=i+1>e.length-1?null:i+1};if(e[i]>t)return{min:n,max:r=i}}return{min:n,max:r}}e.LENBFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="LENB",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.STRING,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.STRING}],n}return r(n,e),n.prototype.func=function(e,n){var r,i,o=0,s=n.getValue();try{for(var u=a(s),l=u.next();!l.done;l=u.next()){var c=l.value.codePointAt(0);c&&(o+=c<pt?1:c<vt?2:4)}}catch(e){r={error:e}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}return new t.NumberVar(o)},n}(t.FuncOpBase),e.LOGFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="LOG",n.operands=1,n.optionOperands=1,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(10)}],n}return r(n,e),n.prototype.func=function(e,n,r){var i=r.getValue(),o=n.getValue();if(i<=0||o<=0){var a=o<=0?1:2,s=1===a?o:i;return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN]({funcName:this.name,index:a,value:s,lowerBound:0})}if(1===r.getValue())return t.tractorErrorVarCreators[t.ErrorCode.DIVIDE_BY_ZERO_FROM_FUNCTION_EVAL]({funcName:this.name});if(10===r.getValue())return new t.NumberVar(Math.log(n.getValue())*Math.LOG10E);var u=Math.log(n.getValue())/Math.log(r.getValue());return new t.NumberVar(u)},n}(t.FuncOpBase),e.LOG10Func=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="LOG10",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n){return n.getValue()<=0?t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN]({funcName:this.name,index:1,value:n.getValue(),lowerBound:0}):new t.NumberVar(Math.log10(n.getValue()))},n}(t.FuncOpBase),e.SUBSTITUTEFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="SUBSTITUTE",n.operands=3,n.optionOperands=1,n.resultType=t.VAR_TYPE.STRING,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.STRING},{type:t.VAR_TYPE.STRING},{type:t.VAR_TYPE.STRING},{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n,r,i,o){var a=n.getValue(),s=r.getValue(),u=i.getValue(),l=o&&o.getValue();if(l<=0)return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_SHOULD_BE_POSITIVE_OR_ZERO]({funcName:this.name,index:4});var c=0;if(!s)return new t.StringVar(a);var h=a.replace(new RegExp(gt(s),"g"),(function(e){return c++,void 0===l||l===c?u:e}));return new t.StringVar(h)},n}(t.FuncOpBase),e.VARFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="VAR",n.operands=1,n.optionOperands=255,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=1,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION}],n}return r(n,e),n.prototype.func=function(e){for(var t,n,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var o=function(){var t,n,i=[];try{for(var o=a(r),s=o.next();!s.done;s=o.next()){var u=s.value;i.push(u.iter(e))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return i},s=rt(!1,o);return s.isError()&&(null===(t=s.info)||void 0===t?void 0:t.args)&&Object.prototype.hasOwnProperty.call(null===(n=s.info)||void 0===n?void 0:n.args,"funcName")&&(s.info.args.funcName=this.name),s},n}(t.FuncOpBase),e.VARPFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="VARP",n.operands=1,n.optionOperands=255,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=1,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION}],n}return r(n,e),n.prototype.func=function(e){for(var t,n,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var o=function(){var t,n,i=[];try{for(var o=a(r),s=o.next();!s.done;s=o.next()){var u=s.value;i.push(u.iter(e))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return i},s=rt(!0,o);return s.isError()&&(null===(t=s.info)||void 0===t?void 0:t.args)&&Object.prototype.hasOwnProperty.call(null===(n=s.info)||void 0===n?void 0:n.args,"funcName")&&(s.info.args.funcName=this.name),s},n}(t.FuncOpBase),e.ODDFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="ODD",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n){var r=n.getValue()<0,i=Math.ceil(Math.abs(n.getValue())),o=i%2==1?i:i+1;return new t.NumberVar(r?-o:o)},n}(t.FuncOpBase),e.PIFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="PI",n.operands=0,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[],n}return r(n,e),n.prototype.func=function(e){return new t.NumberVar(Math.PI)},n}(t.FuncOpBase),e.SMALLFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="SMALL",n.operands=2,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION},{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,t,n){return st(e,t,n,this.name)},n}(t.FuncOpBase),e.STDEVFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="STDEV",n.operands=1,n.optionOperands=255,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=1,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION}],n}return r(n,e),n.prototype.func=function(e){for(var n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];var s=function(){var t,n,r=[];try{for(var o=a(i),s=o.next();!s.done;s=o.next()){var u=s.value;r.push(u.iter(e))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r},u=rt(!1,s);if(u.isError()&&(null===(n=u.info)||void 0===n?void 0:n.args)&&Object.prototype.hasOwnProperty.call(null===(r=u.info)||void 0===r?void 0:r.args,"funcName"))return u.info.args.funcName=this.name,u;if(!u.isNumber())return u;var l=Math.sqrt(u.getValue());return new t.NumberVar(l)},n}(t.FuncOpBase),e.STDEVPFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="STDEVP",n.operands=1,n.optionOperands=255,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=1,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION}],n}return r(n,e),n.prototype.func=function(e){for(var n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];var s=function(){var t,n,r=[];try{for(var o=a(i),s=o.next();!s.done;s=o.next()){var u=s.value;r.push(u.iter(e))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r},u=rt(!0,s);if(u.isError()&&(null===(n=u.info)||void 0===n?void 0:n.args)&&Object.prototype.hasOwnProperty.call(null===(r=u.info)||void 0===r?void 0:r.args,"funcName"))return u.info.args.funcName=this.name,u;if(!u.isNumber())return u;var l=Math.sqrt(u.getValue());return new t.NumberVar(l)},n}(t.FuncOpBase),e.SLNFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="SLN",n.operands=3,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)}],n}return r(n,e),n.prototype.func=function(e,n,r,i){var o=n.getValue(),a=r.getValue(),s=i.getValue();if(0===s)return t.tractorErrorVarCreators[t.ErrorCode.DIVIDE_BY_ZERO_FROM_PARAMETER_BEING_ZERO]({funcName:this.name,argIndex:3});var u=ie(o,a,s);return new t.NumberVar(u)},n}(t.FuncOpBase),e.COVARFunc=function(n){function i(){var e=null!==n&&n.apply(this,arguments)||this;return e.name="COVAR",e.operands=2,e.optionOperands=0,e.resultType=t.VAR_TYPE.NUMBER,e.repeatedLastParam=0,e.paramsDesc=[{type:t.VAR_TYPE.COLLECTION},{type:t.VAR_TYPE.COLLECTION}],e}return r(i,n),i.prototype.func=function(n,r,i){var o,a;if(1===r.size()&&r.nth(0,n).isNull()||1===i.size()&&i.nth(0,n).isNull())return t.tractorErrorVarCreators[t.ErrorCode.NO_VALID_DATA]({funcName:this.name});if(r.size()!==i.size())return t.tractorErrorVarCreators[t.ErrorCode.ARGUMENT_SIZES_NOT_EQUAL]({funcName:this.name,argCount:r.size(),requiredOperandCount:i.size()});var s=e.covarVar(r,i,n);return s.isError()&&(null===(o=s.info)||void 0===o?void 0:o.args)&&Object.prototype.hasOwnProperty.call(null===(a=s.info)||void 0===a?void 0:a.args,"funcName")&&(s.info.args.funcName=this.name),s},i}(t.FuncOpBase),e.SQRTFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="SQRT",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n){var r=n.getValue();return r<0?t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_POSITIVE_OR_ZERO]({funcName:this.name,index:1}):new t.NumberVar(Math.sqrt(r))},n}(t.FuncOpBase),e.TRIMFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="TRIM",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.STRING,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.STRING}],n}return r(n,e),n.prototype.func=function(e,n){var r=n.getValue();return new t.StringVar(_t(r))},n}(t.FuncOpBase),e.TRIMMEANFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="TRIMMEAN",n.operands=2,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION},{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n,r){var i,o,s,l=r.getValue(),c=[];if(n.iter(e).exitWhen((function(e){var t=e.isError();return t&&(s=e),t})).filter((function(e){return e.isNumber()})).forEach((function(e){return c.push(e)})),s)return s;if(l<0)return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_POSITIVE_OR_ZERO]({funcName:this.name,index:2});if(l>=1)return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_SHOULD_BE_LESS_THAN]({funcName:this.name,index:2,value:l,upperBound:1});c.sort((function(e,t){return e.getValue()-t.getValue()}));var h=Math.floor(c.length*l/2);c=c.slice(h,c.length-h);var d=function(){var t,n,r=[];try{for(var i=a(c),o=i.next();!o.done;o=i.next()){var s=o.value;r.push(s.iter(e))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r},f=u(d);return f.isError()&&(null===(i=f.info)||void 0===i?void 0:i.args)&&Object.prototype.hasOwnProperty.call(null===(o=f.info)||void 0===o?void 0:o.args,"funcName")&&(f.info.args.funcName=this.name),f},n}(t.FuncOpBase),e.UPPERFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="UPPER",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.STRING,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.STRING}],n}return r(n,e),n.prototype.func=function(e,n){return new t.StringVar(n.getValue().toUpperCase())},n}(t.FuncOpBase),e.MODFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="MOD",n.operands=2,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n,r){var i=n.getValue(),o=r.getValue();if(0===o)return t.tractorErrorVarCreators[t.ErrorCode.DIVIDE_BY_ZERO_FROM_PARAMETER_BEING_ZERO]({funcName:this.name,argIndex:2});var a=i-o*Math.floor(i/o);return new t.NumberVar(a)},n}(t.FuncOpBase),e.QUOTIENTFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="QUOTIENT",n.operands=2,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n,r){var i=n.getValue(),o=r.getValue();if(0===o)return t.tractorErrorVarCreators[t.ErrorCode.DIVIDE_BY_ZERO_FROM_PARAMETER_BEING_ZERO]({funcName:this.name,argIndex:2});var a=i/o;if(Number.isFinite(a)){var s=a>0?Math.floor(i/o):Math.ceil(i/o);return 0===s?new t.NumberVar(0):new t.NumberVar(s)}return t.tractorErrorVarCreators[t.ErrorCode.POSITIVE_OVERFLOW]({upperBound:t.MAX_NUMBER_VALUE})},n}(t.FuncOpBase),e.LEFTFunc=function(e){function n(){var n,r=null!==e&&e.apply(this,arguments)||this;return r.name="LEFT",r.operands=1,r.optionOperands=1,r.resultType=t.VAR_TYPE.STRING,r.repeatedLastParam=0,r.paramsDesc=[{type:t.VAR_TYPE.STRING},{type:t.VAR_TYPE.NUMBER,default:(n={},n[t.DefaultParam.IfInputNull]=new t.NumberVar(0),n[t.DefaultParam.IfNotInput]=new t.NumberVar(1),n)}],r}return r(n,e),n.prototype.func=function(e,n,r){var i=r.getValue();if(i<0)return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_SHOULD_BE_POSITIVE_OR_ZERO]({funcName:this.name,index:2});var o=n.getValue();return new t.StringVar(o.substr(0,i))},n}(t.FuncOpBase),e.TEXTJOINFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="TEXTJOIN",n.operands=3,n.optionOperands=255,n.resultType=t.VAR_TYPE.STRING,n.repeatedLastParam=1,n.paramsDesc=[{type:t.VAR_TYPE.STRING|t.VAR_TYPE.COLLECTION},{type:t.VAR_TYPE.BOOL,default:new t.BooleanVar(!0)},{type:t.VAR_TYPE.STRING|t.VAR_TYPE.COLLECTION},{type:t.VAR_TYPE.STRING|t.VAR_TYPE.COLLECTION}],n}return r(n,e),n.prototype.func=function(e,n,r){for(var i,o,s=[],u=3;u<arguments.length;u++)s[u-3]=arguments[u];var l=[],c=r.getValue(),h=1;if(n.isCollection()&&(h=n.size()),0===h)return t.VALUE_ERR_VAR;var d=0,f=n.iter(e).first_if((function(e){return e.isError()}));if(f)return f;var p=function(t){var r;if(t.iter(e).exitWhen((function(e){var t=e.isError();return t&&(r=e),t})).forEach((function(t){var r=t.toStringVar(e.service).getValue();if(!c||""!==r&&null!==r){var i=void 0;n.isString()?i=n:(i=n.nth(d%h,e).toStringVar(e.service),d++),l.push(r||""),l.push(i.getValue()||"")}})),r)return{value:r}};try{for(var v=a(s),g=v.next();!g.done;g=v.next()){var _=p(g.value);if("object"==typeof _)return _.value}}catch(e){i={error:e}}finally{try{g&&!g.done&&(o=v.return)&&o.call(v)}finally{if(i)throw i.error}}return l.pop(),new t.StringVar(l.join(""))},n}(t.FuncOpBase),e.INTFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="INT",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n){return n.isNumber()?new t.NumberVar(ge(n.getValue())):t.VALUE_ERR_VAR},n}(t.FuncOpBase),e.RIGHTFunc=function(e){function n(){var n,r=null!==e&&e.apply(this,arguments)||this;return r.name="RIGHT",r.operands=1,r.optionOperands=1,r.resultType=t.VAR_TYPE.STRING,r.repeatedLastParam=0,r.paramsDesc=[{type:t.VAR_TYPE.STRING},{type:t.VAR_TYPE.NUMBER,default:(n={},n[t.DefaultParam.IfInputNull]=new t.NumberVar(0),n[t.DefaultParam.IfNotInput]=new t.NumberVar(1),n)}],r}return r(n,e),n.prototype.func=function(e,n,r){var i=r.getValue();if(i<0)return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_SHOULD_BE_POSITIVE_OR_ZERO]({funcName:this.name,index:2});var o=n.getValue(),a=o.length-i<0?0:o.length-i;return new t.StringVar(o.substr(a,i))},n}(t.FuncOpBase),e.CEILINGMATHFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="CEILING.MATH",n.operands=1,n.optionOperands=2,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(1)},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)}],n}return r(n,e),n.prototype.func=function(e,n,r,i){var o=n.getValue(),a=r.getValue();return o<0&&(a=0===i.getValue()?Math.abs(a):-Math.abs(a)),new t.NumberVar(pe(o,a))},n}(t.FuncOpBase),e.CEILINGPRECISEFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="CEILING.PRECISE",n.operands=1,n.optionOperands=1,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(1)}],n}return r(n,e),n.prototype.func=function(e,n,r){return new t.NumberVar(pe(n.getValue(),Math.abs(r.getValue())))},n}(t.FuncOpBase),e.CEILINGFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="CEILING",n.operands=2,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n,r){return r.getValue()<0&&n.getValue()>0?t.tractorErrorVarCreators[t.ErrorCode.DIFFERENT_SIGNS]({funcName:this.name}):new t.NumberVar(pe(n.getValue(),r.getValue()))},n}(t.FuncOpBase),e.LNFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="LN",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n){var r=n.getValue();return r<=0?t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN]({funcName:this.name,index:1,value:r,lowerBound:0}):new t.NumberVar(Math.log(r))},n}(t.FuncOpBase),e.LOWERFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="LOWER",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.STRING,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.STRING}],n}return r(n,e),n.prototype.func=function(e,n){return new t.StringVar(n.getValue().toLowerCase())},n}(t.FuncOpBase),e.ORFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="OR",n.operands=1,n.optionOperands=255,n.resultType=t.VAR_TYPE.BOOL,n.repeatedLastParam=1,n.paramsDesc=[{type:t.VAR_TYPE.BOOL|t.VAR_TYPE.COLLECTION},{type:t.VAR_TYPE.BOOL|t.VAR_TYPE.COLLECTION}],n}return r(n,e),n.prototype.func=function(e){for(var n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];var s=!1,u=!0,l=function(t){var n;if(t.iter(e).exitWhen((function(e){var t=e.isError();return t&&(n=e),t})).filter((function(e){return e.isPrimitive()&&!e.isString()&&!e.isNull()})).map((function(t){return t.toBooleanVar(e.service)})).forEach((function(t){u=!1,t.getValue(e)&&(s=!0)})),n)return{value:n}};try{for(var c=a(i),h=c.next();!h.done;h=c.next()){var d=l(h.value);if("object"==typeof d)return d.value}}catch(e){n={error:e}}finally{try{h&&!h.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return u?t.tractorErrorVarCreators[t.ErrorCode.NO_VALID_DATA]({funcName:this.name}):new t.BooleanVar(s)},n}(t.FuncOpBase),e.MEDIANFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="MEDIAN",n.operands=1,n.optionOperands=255,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=1,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION}],n.calcCustomData=t.getFirstValidCustomData,n}return r(n,e),n.prototype.func=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return nt(2,(function(){var n,r,i=[];try{for(var o=a(t),s=o.next();!s.done;s=o.next()){var u=s.value;i.push(u.iter(e))}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}),this.name)},n}(t.FuncOpBase),e.RADIANSFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="RADIANS",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n){return new t.NumberVar(n.getValue()*Math.PI/180)},n}(t.FuncOpBase),e.RANDBETWEENFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="RANDBETWEEN",n.operands=2,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER,default:t.NA_ERR_VAR},{type:t.VAR_TYPE.NUMBER,default:t.NA_ERR_VAR}],n.alwaysCalc=!0,n}return r(n,e),n.prototype.func=function(e,n,r){var i=n.getValue(),o=r.getValue();if(i>o)return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO]({funcName:this.name,index:2,value:o,lowerBound:i});if((i=Math.ceil(i))>o)return new t.NumberVar(i);o=Math.floor(o);var a=Math.floor(i+(o-i+1)*Math.random());return new t.NumberVar(a)},n}(t.FuncOpBase),e.PERCENTILEFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="PERCENTILE",n.operands=2,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION},{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,t,n){return lt(e,t,n,this.name)},n}(t.FuncOpBase),e.PERCENTRANKFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="PERCENTRANK",n.operands=2,n.optionOperands=1,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.COLLECTION|t.VAR_TYPE.NULL},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.NULL},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(3)}],n}return r(n,e),n.prototype.func=function(e,n,r,i){if(n.isNull()&&r.isNull())return new t.NumberVar(1);if(n.isNull()||r.isNull())return t.tractorErrorVarCreators[t.ErrorCode.NA_NO_VALID_DATA]({funcName:this.name});var o,a=[];if(n.iter(e).exitWhen((function(e){var t=e.isError();return t&&(o=e),t})).filter((function(e){return e.isNumber()})).forEach((function(t){return a.push(t.getValue(e))})),o)return o;var s=r.getValue(),u=a.length;if(1===u&&s===a[0])return new t.NumberVar(1);a=a.sort((function(e,t){return e-t}));var l=i.getValue();if(l<1)return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO]({funcName:this.name,index:3,value:l,lowerBound:1});if(s<a[0]||s>a[u-1])return t.tractorErrorVarCreators[t.ErrorCode.NA_NO_VALID_DATA]({funcName:this.name});if(a.indexOf(s)>=0)return new t.NumberVar(t.NumberVar.toFixed(yt(a,s),l));var c=mt(a,s),h=c.min,d=c.max;if(null==h||null==d)return t.NA_ERR_VAR;var f=yt(a,a[h]),p=yt(a,a[d]);return new t.NumberVar(t.NumberVar.toFixed(f+(s-a[h])/(a[d]-a[h])*(p-f),l))},n}(t.FuncOpBase),e.SEARCHFunc=function(e){function n(){var n,r=null!==e&&e.apply(this,arguments)||this;return r.name="SEARCH",r.operands=2,r.optionOperands=1,r.resultType=t.VAR_TYPE.NUMBER,r.repeatedLastParam=0,r.paramsDesc=[{type:t.VAR_TYPE.STRING},{type:t.VAR_TYPE.STRING},{type:t.VAR_TYPE.NUMBER,default:(n={},n[t.DefaultParam.IfInputNull]=new t.NumberVar(0),n[t.DefaultParam.IfNotInput]=new t.NumberVar(1),n)}],r}return r(n,e),n.prototype.func=function(e,n,r,i){var o=r.getValue();if(0===o.length)return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_SHOULD_BE_NON_BLANK]({funcName:this.name,index:2});var a=Math.floor(i.getValue());if(a<1)return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO]({funcName:this.name,index:3,value:a,lowerBound:1});if(a>o.length)return t.tractorErrorVarCreators[t.ErrorCode.SHOULD_BE_BETWEEN_INCLUSIVE_PARAMETER]({funcName:this.name,index:3,value:a,lowerBound:1,upperBound:o.length});var s=n.getValue();if(0===s.length)return new t.NumberVar(a);o=o.substr(a-1);var u=-1;if(-1===s.indexOf("?")&&-1===s.indexOf("*")&&-1===s.indexOf("~"))u=o.toLocaleLowerCase().indexOf(s.toLocaleLowerCase());else{var l=We(s).replace(/~(.|$)|\?|\*/g,(function(e,t){if(void 0===t)switch(e){case"?":return".";case"*":return"[\\s\\S]*";default:return e}switch(t){case"?":return"\\?";case"*":return"\\*";default:return t}})),c=new RegExp(l,"i").exec(o);c&&(u=c.index)}return u<0?t.tractorErrorVarCreators[t.ErrorCode.STRING_SEARCH_FAILED]({funcName:this.name,searchFor:n.getValue(),textToSeatch:r.getValue()}):new t.NumberVar(u+a)},n}(t.FuncOpBase),e.QUARTILEFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="QUARTILE",n.operands=2,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.COLLECTION},{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,t,n){return ut(e,t,n,this.name)},n}(t.FuncOpBase),e.CONVERTFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="CONVERT",n.operands=3,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER,default:t.NA_ERR_VAR},{type:t.VAR_TYPE.STRING,default:t.NA_ERR_VAR},{type:t.VAR_TYPE.STRING,default:t.NA_ERR_VAR}],n}return r(n,e),n.prototype.func=function(e,n,r,i){for(var o=n.getValue(),a=r.getValue(),s=i.getValue(),u=null,l=null,c=1,h=1,d=0;d<Et.length;d++){var f=Et[d][2];(Et[d][1]===a||f.indexOf(a)>=0)&&(u=Et[d]),(Et[d][1]===s||f.indexOf(s)>=0)&&(l=Et[d])}if(null===u){var p=bt[a.substring(0,2)],v=Tt[a.substring(0,1)];"da"===a.substring(0,2)&&(v=["dekao",10,"da"]),p?(c=p[2],a=a.substring(2)):v&&(c=v[1],a=a.substring(v[2].length)),u=Et.find((function(e){var t=e[2];return e[1]===a||t.indexOf(a)>=0}))}if(null===l){var g=bt[s.substring(0,2)],_=Tt[s.substring(0,1)];"da"===s.substring(0,2)&&(_=["dekao",10,"da"]),g?(h=g[2],s=s.substring(2)):_&&(h=_[1],s=s.substring(_[2].length)),l=Et.find((function(e){var t=e[2];return e[1]===s||t.indexOf(s)>=0}))}if(!u||!l)return t.tractorErrorVarCreators[t.ErrorCode.INVALID_UNIT_CONVERSION]();if(u[3]!==l[3])return t.tractorErrorVarCreators[t.ErrorCode.INVALID_UNIT_CONVERSION]();var y,m=(o*c+u[4])*u[5];return y="temperature"===u[3]?(m*l[6]-l[4])/h:(m/l[5]-l[4])/h,new t.NumberVar(y)},n}(t.FuncOpBase);var Et=[["gram","g",[],"mass",0,.001],["slug","sg",[],"mass",0,14.5939029372064],["pound mass","lbm",[],"mass",0,.45359237],["dalton","Da",["u"],"mass",0,166053886282828e-41],["ounce mass","ozm",[],"mass",0,.028349523125],["grain","grain",[],"mass",0,6479891e-11],["short hundredweight","cwt",["shweight"],"mass",0,45.359237],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",0,50.80234544],["stone","stone",[],"mass",0,6.35029318],["ton","ton",[],"mass",0,907.18474],["imperial ton","brton",["uk_ton","LTON"],"mass",0,1016.0469088],["meter","m",[],"length",0,1],["statute mile","mi",[],"length",0,1609.344],["nautical mile","M",["Nmi"],"length",0,1852],["inch","in",[],"length",0,.0254],["foot","ft",[],"length",0,.3048],["yard","yd",[],"length",0,.9144],["angstrom","ang",[],"length",0,1e-10],["ell","ell",[],"length",0,1.143],["light-year","ly",[],"length",0,946073047258e4],["parsec","pc",["parsec"],"length",0,308567758128e5],["pica (1/72 inch)","Pica",["Picapt"],"length",0,.0254/72],["pica (1/6 inch)","pica",[],"length",0,.0254/6],["U.S. survey mile","survey_mi",[],"length",0,1609.3472187],["year","yr",[],"time",0,31557600],["day","d",["day"],"time",0,86400],["hour","h",["hr"],"time",0,3600],["minute","min",["mn"],"time",0,60],["second","s",["sec"],"time",0,1],["pascal","p",["Pa"],"pressure",0,1],["atmosphere","at",["atm"],"pressure",0,101325],["millimetre of mercury","mmHg",[],"pressure",0,133.322],["PSI","psi",[],"pressure",0,6894.7572931783],["torr","Torr",[],"pressure",0,133.3223684211],["newton","N",[],"force",0,1],["dyne","dyn",["dy"],"force",0,1e-5],["pound force","lbf",[],"force",0,4.4482216152605],["pond","pond",[],"force",0,.00980665],["joule","J",[],"energy",0,1],["erg","e",[],"energy",0,1e-7],["thermodynamic calorie","c",[],"energy",0,4.184],["IT calorie","cal",[],"energy",0,4.1868],["electron volt","eV",["ev"],"energy",0,160217662e-27],["horsepower-hour","HPh",["hh"],"energy",0,2684519.5377],["watt-hour","Wh",["wh"],"energy",0,3600],["foot-pound","flb",[],"energy",0,1.3558179483314],["btu","BTU",["btu"],"energy",0,1055.05585262],["horsepower","HP",["h"],"power",0,745.69987158227],["pferdestärke","PS",[],"power",0,735.49875],["watt","W",["w"],"power",0,1],["tesla","T",[],"magnetism",0,1e4],["gauss","G",["ga"],"magnetism",0,1],["degree celsius","C",["cel"],"temperature",0,1,1],["kelvin","K",["kel"],"temperature",-273.15,1,1],["degree fahrenheit","F",["fah"],"temperature",-32,5/9,1.8],["degrees Rankine","Rank",[],"temperature",-491.67,5/9,1.8],["degrees reaumur","Reau",[],"temperature",0,5/4,.8],["teaspoon","tsp",[],"volume",0,492892159375e-17],["modern teaspoon","tspm",[],"volume",0,5e-6],["tablespoon","tbs",[],"volume",0,1478676478125e-17],["fluid ounce","oz",[],"volume",0,295735295625e-16],["cup","cup",[],"volume",0,.0002365882365],["U.S. pint","pt",["us_pt"],"volume",0,.000473176473],["U.K. pint","uk_pt",[],"volume",0,.00056826125],["quart","qt",[],"volume",0,.000946352946],["imperial quart (U.K)","uk_qt",[],"volume",0,.0011365225],["gallon","gal",[],"volume",0,.003785411784],["imperial gallon (U.K.)","uk_gal",[],"volume",0,.00454609],["litre","L",["l","lt"],"volume",0,.001],["cubic ångström","ang3",["ang^3"],"volume",0,1e-30],["U.S. oil barrel","barrel",[],"volume",0,.158987294928],["U.S. bushel","bushel",[],"volume",0,.03523907016688],["cubic foot","ft3",["ft^3"],"volume",0,.028316846592],["cubic inch","in3",["in^3"],"volume",0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",0,846786664623715e33],["cubic meter","m3",["m^3"],"volume",0,1],["cubic mile","mi3",["mi^3"],"volume",0,4168181825.44058],["cubic yard","yd3",["yd^3"],"volume",0,.764554857984],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",0,43903957e-18],["gross registered ton","GRT",["regton"],"volume",0,2.8316846592],["measurement ton","MTON",[],"volume",0,1.13267386368],["international acre","uk_acre",[],"area",0,4046.8564224],["U.S. survey/statute acre","us_acre",[],"area",0,4046.87261],["square angstrom","ang2",["ang^2"],"area",0,1e-20],["are","ar",[],"area",0,100],["square foot","ft2",["ft^2"],"area",0,.09290304],["hectare","ha",[],"area",0,1e4],["square inch","in2",["in^2"],"area",0,64516e-8],["square light-year","ly2",["ly^2"],"area",0,895054210748189e17],["square meter","m2",["m^2"],"area",0,1],["morgen","Morgen",[],"area",0,2500],["square mile","mi2",["mi^2"],"area",0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",0,1.24452160493827e-7],["square yard","yd2",["yd^2"],"area",0,.83612736],["bit","bit",["b"],"information",0,1],["byte","byte",[],"information",0,8],["admiralty knot","admkn",[],"speed",0,.514773333],["knot","kn",[],"speed",0,.514444444444444],["meter per hour","m/h",["m/hr"],"speed",0,.0002777777777777778],["meter per second","m/s",["m/sec"],"speed",0,1],["miles per hour","mph",[],"speed",0,.44704]],bt={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},Tt={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};function Ct(e){for(var t="",n=0;n<e.length;n++)12288!==e.charCodeAt(n)?e.charCodeAt(n)>65280&&e.charCodeAt(n)<65375?t+=String.fromCharCode(e.charCodeAt(n)-65248):t+=String.fromCharCode(e.charCodeAt(n)):t+=String.fromCharCode(e.charCodeAt(n)-12256);return t}function St(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);0<=r&&r<=31||127===r||t.push(e[n])}return t.join("")}e.PMTFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="PMT",n.operands=3,n.optionOperands=2,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)}],n}return r(n,e),n.prototype.func=function(e,n,r,i,o,a){var s=n.getValue(),u=r.getValue(),l=i.getValue(),c=o.getValue(),h=a.getValue();0!==h&&(h=1);var d=z(s,u,l,c,h);return new t.NumberVar(d)},n}(t.FuncOpBase),e.PPMTFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="PPMT",n.operands=4,n.optionOperands=2,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)},{type:t.VAR_TYPE.NUMBER,default:t.NUM_ERR_VAR},{type:t.VAR_TYPE.NUMBER,default:t.NUM_ERR_VAR},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)}],n}return r(n,e),n.prototype.func=function(e,n,r,i,o,a,s){var u=n.getValue(),l=r.getValue(),c=i.getValue(),h=o.getValue(),d=a.getValue(),f=s.getValue();if(0!==f&&(f=1),l<1)return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO]({funcName:this.name,index:2,value:l,lowerBound:1});if(c<=0)return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN]({funcName:this.name,index:3,value:c,lowerBound:0});if(l>c)return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_SHOULD_BE_LESS_THAN_OR_EQUAL_TO]({funcName:this.name,index:2,value:l,upperBound:c});var p=X(u,l,c,h,d,f);return new t.NumberVar(p)},n}(t.FuncOpBase),e.PVFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="PV",n.operands=3,n.optionOperands=2,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)}],n}return r(n,e),n.prototype.func=function(e,n,r,i,o,a){var s=n.getValue(),u=r.getValue(),l=o.getValue(),c=i.getValue(),h=a.getValue();if(0!==h&&(h=1),0===u)return new t.NumberVar(-l);var d=Math.pow(1+s,u),f=(c*(1+s*h)*(d-1)/s+l)/d;return new t.NumberVar(-f)},n}(t.FuncOpBase),e.FVFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="FV",n.operands=3,n.optionOperands=2,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)}],n}return r(n,e),n.prototype.func=function(e,n,r,i,o,a){var s=n.getValue(),u=r.getValue(),l=i.getValue(),c=o.getValue(),h=a.getValue();0!==h&&(h=1);var d=K(s,u,l,c,h);return new t.NumberVar(d)},n}(t.FuncOpBase),e.GCDFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="GCD",n.operands=1,n.optionOperands=255,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=1,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL|t.VAR_TYPE.ERROR|t.VAR_TYPE.COLLECTION,default:t.NA_ERR_VAR},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL|t.VAR_TYPE.ERROR|t.VAR_TYPE.COLLECTION}],n}return r(n,e),n.prototype.func=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Je(e,t,qe,0)},n}(t.FuncOpBase),e.NAFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="NA",n.operands=0,n.optionOperands=0,n.resultType=t.VAR_TYPE.ERROR,n.repeatedLastParam=0,n.paramsDesc=[],n}return r(n,e),n.prototype.func=function(e){return t.NA_ERR_VAR},n}(t.FuncOpBase),e.NORMSINVFunc=function(e){function n(n){void 0===n&&(n="NORM.S.INV");var r=e.call(this,n)||this;return r.name=n,r.operands=1,r.optionOperands=0,r.resultType=t.VAR_TYPE.NUMBER,r.repeatedLastParam=0,r.paramsDesc=[{type:t.VAR_TYPE.NUMBER}],r}return r(n,e),n.prototype.func=function(e,n){var r=n.getValue();if(r<=0||r>=1)return t.tractorErrorVarCreators[t.ErrorCode.SHOULD_BE_BETWEEN_EXCLUSIVE]({funcName:this.name,index:1,value:r,lowerBound:0,upperBound:1});var i=w(r,0,1);return new t.NumberVar(i)},n}(t.FuncOpBase),e.FACTFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="FACT",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n){var r=n.getValue();if(r<0)return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_POSITIVE_OR_ZERO]({funcName:this.name,index:1});var i=it(r);return new t.NumberVar(i)},n}(t.FuncOpBase),e.FACTDOUBLEFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="FACTDOUBLE",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n){var r=n.getValue();if(r<0)return t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_POSITIVE_OR_ZERO]({funcName:this.name,index:1});if(r>300)return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_SHOULD_BE_LESS_THAN_OR_EQUAL_TO]({funcName:this.name,index:1,value:r,upperBound:300});var i=it(r,2);return new t.NumberVar(i)},n}(t.FuncOpBase),e.FALSEFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="FALSE",n.operands=0,n.optionOperands=0,n.resultType=t.VAR_TYPE.BOOL,n.repeatedLastParam=0,n.paramsDesc=[],n}return r(n,e),n.prototype.func=function(e){return new t.BooleanVar(!1)},n}(t.FuncOpBase),e.FILTERFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="FILTER",n.operands=2,n.optionOperands=0,n.resultType=t.VAR_TYPE.COLLECTION,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.COLLECTION},{type:t.VAR_TYPE.COLLECTION|t.VAR_TYPE.BOOL}],n}return r(n,e),n.prototype.func=function(e,n,r){if(r.isBool())return r.getValue()?n:new t.ArrayVar([]);var i=r.iter(e),o=[];return n.iter(e).forEach((function(t){var n=i.next();n&&n.isPrimitive()&&n.toBooleanVar(e.service).getValue()&&o.push(t)})),new t.ArrayVar([new t.ArrayVar(o)])},n}(t.FuncOpBase),e.ASINFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="ASIN",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n){var r=n.getValue();return r<-1||r>1?t.tractorErrorVarCreators[t.ErrorCode.NUM_SHOULD_BE_BETWEEN_INCLUSIVE_PARAMETER]({funcName:this.name,index:1,value:r,lowerBound:-1,upperBound:1}):new t.NumberVar(Math.asin(r))},n}(t.FuncOpBase),e.ATANHFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="ATANH",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n){var r=n.getValue();return r<-1||r>1?t.tractorErrorVarCreators[t.ErrorCode.NUM_SHOULD_BE_BETWEEN_INCLUSIVE_PARAMETER]({funcName:this.name,index:1,value:r,lowerBound:-1,upperBound:1}):new t.NumberVar(Math.atanh(r))},n}(t.FuncOpBase),e.TANFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="TAN",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n){var r=n.getValue();return new t.NumberVar(Math.tan(r))},n}(t.FuncOpBase),e.TANHFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="TANH",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n){var r=n.getValue();return new t.NumberVar(Math.tanh(r))},n}(t.FuncOpBase),e.ATANFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="ATAN",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n){var r=n.getValue();return new t.NumberVar(Math.atan(r))},n}(t.FuncOpBase),e.ATAN2Func=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="ATAN2",n.operands=2,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n,r){var i=n.getValue(),o=r.getValue();return 0===i&&0===o?t.tractorErrorVarCreators[t.ErrorCode.DIVIDE_BY_ZERO_FROM_FUNCTION_EVAL]({funcName:this.name}):new t.NumberVar(Math.atan2(o,i))},n}(t.FuncOpBase),e.COSFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="COS",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n){var r=n.getValue();return new t.NumberVar(Math.cos(r))},n}(t.FuncOpBase),e.ERRORTYPEFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="ERROR.TYPE",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.BASIC}],n}return r(n,e),n.prototype.func=function(e,n){var r=n.getVar(e);return r.isError()?new t.NumberVar(r.errorType):t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_IS_NOT_AN_ERROR]({funcName:this.name,index:1})},n}(t.FuncOpBase),e.SINFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="SIN",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n){var r=n.getValue();return new t.NumberVar(Math.sin(r))},n}(t.FuncOpBase),e.SINHFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="SINH",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n){var r=n.getValue();return new t.NumberVar(Math.sinh(r))},n}(t.FuncOpBase),e.COSHFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="COSH",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n){var r=n.getValue();return new t.NumberVar(Math.cosh(r))},n}(t.FuncOpBase),e.TRUNCFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="TRUNC",n.operands=1,n.optionOperands=1,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER},{type:t.VAR_TYPE.NUMBER,default:new t.NumberVar(0)}],n}return r(n,e),n}(e.ROUNDDOWNFunc),e.SIGNFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="SIGN",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n){var r=Math.sign(n.getValue());return 0===r&&(r=0),new t.NumberVar(r)},n}(t.FuncOpBase),e.ASINHFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="ASINH",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER}],n}return r(n,e),n.prototype.func=function(e,n){var r=n.getValue();return new t.NumberVar(Math.asinh(r))},n}(t.FuncOpBase),e.ISNAFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="ISNA",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.BOOL,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.BASIC}],n}return r(n,e),n.prototype.func=function(e,n){return new t.BooleanVar(n.isError()&&n.getVar().getValue()===t.ErrorConstant.NA)},n}(t.FuncOpBase),e.ISERRFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="ISERR",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.BOOL,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.BASIC}],n}return r(n,e),n.prototype.func=function(e,n){return new t.BooleanVar(n.isError()&&n.getVar().getValue()!==t.ErrorConstant.NA)},n}(t.FuncOpBase),e.ISERRORFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="ISERROR",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.BOOL,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.BASIC}],n}return r(n,e),n.prototype.func=function(e,n){return new t.BooleanVar(n.isError())},n}(t.FuncOpBase),e.ASCFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="ASC",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.STRING}],n}return r(n,e),n.prototype.func=function(e,n){return new t.StringVar(Ct(n.getValue()))},n}(t.FuncOpBase),e.CLEANFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="CLEAN",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.STRING,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.STRING}],n}return r(n,e),n.prototype.func=function(e,n){return new t.StringVar(St(n.getValue()))},n}(t.FuncOpBase),e.MROUNDFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="MROUND",n.operands=2,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL,default:t.NA_ERR_VAR},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL,default:t.NA_ERR_VAR}],n}return r(n,e),n.prototype.func=function(e,n,r){if(!n.isNumber()||!r.isNumber()){var i=n.isBool()?1:2,o=1===i?n:r;return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:i,value:o.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE})}var a=n.getValue(),s=r.getValue();return a>0&&s<0||a<0&&s>0?t.tractorErrorVarCreators[t.ErrorCode.DIFFERENT_SIGNS]({funcName:this.name}):new t.NumberVar(0===s?0:_e(a/s)*s)},n}(t.FuncOpBase);var wt=1e3,Rt=1e-8;e.XIRRFunc=function(n){function i(){var e=null!==n&&n.apply(this,arguments)||this;return e.name="XIRR",e.operands=2,e.optionOperands=1,e.resultType=t.VAR_TYPE.NUMBER,e.repeatedLastParam=0,e.paramsDesc=[{type:t.VAR_TYPE.COLLECTION,default:t.NA_ERR_VAR},{type:t.VAR_TYPE.COLLECTION,default:t.NA_ERR_VAR},{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL,default:new t.NumberVar(.1)}],e}return r(i,n),i.prototype.func=function(n,r,i,o){var a=this;if(o.isBool())return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:3,value:o.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE});var s=[],u=[],l=!1,c=!1,h=null,d=function(e){return e.iter(n).exitWhen((function(e){return e.isError()?(h=e,!0):e.isBool()?(h=t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:a.name,index:1,value:e.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE}),!0):!!e.toNumberVar(n.service).isNull()&&(h=t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:a.name,index:1,value:e.getValue(),argType:t.FormulaErrorPhrases.DATA_TYPE_STRING,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE}),!0)}))};if(d(r).forEach((function(e){var t=e.getValue(n);e.isNumber()||(t=e.toNumberVar(n.service).getValue()),t>0&&(l=!0),t<0&&(c=!0),s.push(t)})),null!==h)return h;if(d(i).first_if((function(r){var i=r.getValue(n);return r.isNumber()||(i=r.toNumberVar(n.service).getValue()),i<e.SheetDate.MIN_DATE_VALUE||i>e.SheetDate.MAX_DATE_VALUE?(h=t.tractorErrorVarCreators[t.ErrorCode.CONDITIONAL_OPTION_DATE_IS_BETWEEN_INSTRUCTION]({minDate:Xe(e.SheetDate.MIN_DATE_VALUE),maxDate:Xe(e.SheetDate.MAX_DATE_VALUE)}),!0):u.length>0&&u[0]>i?(h=t.tractorErrorVarCreators[t.ErrorCode.CONDITIONAL_OPTION_DATE_IS_ON_OR_AFTER_INSTRUCTION]({date:Xe(i)}),!0):(u.push(Math.floor(i)),!1)})),null!==h)return h;if(!l||!c)return t.tractorErrorVarCreators[t.ErrorCode.REQUIRES_POSITIVE_AND_NEGATIVE_VALUES]({funcName:this.name});if(s.length!==u.length)return t.tractorErrorVarCreators[t.ErrorCode.ARRAY_SIZES_NOT_EQUAL]({funcName:this.name});function f(e){return $(e,s,u)}var p=ne(f,o.getValue(),wt,Rt);return null===p?t.tractorErrorVarCreators[t.ErrorCode.INTERNAL_RATE_OF_RETURN_BAD_GUESS]({funcName:this.name}):new t.NumberVar(p)},i}(t.FuncOpBase),e.SQRTPIFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="SQRTPI",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL}],n}return r(n,e),n.prototype.func=function(e,n){if(!n.isNumber())return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:1,value:n.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE});var r=n.getValue();return r<0?t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_SHOULD_BE_POSITIVE_OR_ZERO]({funcName:this.name,index:1}):new t.NumberVar(Math.sqrt(Math.PI*r))},n}(t.FuncOpBase),e.XNPVFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="XNPV",n.operands=3,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL,default:t.NA_ERR_VAR},{type:t.VAR_TYPE.COLLECTION,default:t.NA_ERR_VAR},{type:t.VAR_TYPE.COLLECTION,default:t.NA_ERR_VAR}],n}return r(n,e),n.prototype.func=function(e,n,r,i){var a=this;if(!n.isNumber())return t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:this.name,index:1,value:n.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE});var s=[],u=[],l=null;if(r.iter(o(o({},e),{skipEmptyRef:!1})).exitWhen((function(e){return e.isError()?(l=e,!0):!e.isNumber()&&(l=t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_WRONG_DATA_TYPE]({funcName:a.name,index:2,value:e.getValue(),argType:t.FormulaErrorPhrases.DATA_TYPE_STRING,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE}),!0)})).forEach((function(t){s.push(t.getValue(e))})),null!==l)return l;if(i.iter(o(o({},e),{skipEmptyRef:!1})).exitWhen((function(e){return!!e.isError()&&(l=e,!0)})).first_if((function(e){if(!e.isNumber())return l=t.tractorErrorVarCreators[t.ErrorCode.NUM_PARAMETER_WRONG_DATA_TYPE]({funcName:a.name,index:3,value:e.getValue(),argType:t.FormulaErrorPhrases.DATA_TYPE_STRING,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_DOUBLE}),!0;var n=e.getValue();return u.length>0&&u[0]>n?(l=t.tractorErrorVarCreators[t.ErrorCode.DATES_CANNOT_PRECEDE_FIRST_DATE]({funcName:a.name,firstDate:Xe(u[0]),curDate:Xe(n)}),!0):(u.push(Math.floor(n)),!1)})),null!==l)return l;if(s.length!==u.length)return t.tractorErrorVarCreators[t.ErrorCode.ARRAY_SIZES_NOT_EQUAL]({funcName:this.name});var c=n.getValue();if(-1===c)return t.tractorErrorVarCreators[t.ErrorCode.POSITIVE_OVERFLOW]({upperBound:t.MAX_NUMBER_VALUE});var h=$(c,s,u);return new t.NumberVar(h)},n}(t.FuncOpBase),e.LISTFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="LIST",n.operands=0,n.optionOperands=255,n.resultType=t.VAR_TYPE.COLLECTION,n.repeatedLastParam=1,n.paramsDesc=[{type:t.VAR_TYPE.ATOM}],n}return r(n,e),n.prototype.func=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return new t.ArrayVar(n)},n}(t.FuncOpBase),e.ISBLANKFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="ISBLANK",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.BOOL,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.BASIC}],n}return r(n,e),n.prototype.func=function(e,n){return new t.BooleanVar(n.isNull())},n}(t.FuncOpBase),e.TRUEFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="TRUE",n.operands=0,n.optionOperands=0,n.resultType=t.VAR_TYPE.BOOL,n.repeatedLastParam=0,n.paramsDesc=[],n}return r(n,e),n.prototype.func=function(e){return new t.BooleanVar(!0)},n}(t.FuncOpBase),e.XORFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="XOR",n.operands=1,n.optionOperands=255,n.resultType=t.VAR_TYPE.BOOL,n.repeatedLastParam=1,n.paramsDesc=[{type:t.VAR_TYPE.BOOL|t.VAR_TYPE.NULL|t.VAR_TYPE.COLLECTION},{type:t.VAR_TYPE.BOOL|t.VAR_TYPE.NULL|t.VAR_TYPE.COLLECTION}],n}return r(n,e),n.prototype.func=function(e){for(var n,r,i=this,o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var l=!1,c=!1,h=function(n,r){var o=null;if(r.iter(e).first_if((function(r){if(r.isError())return o=r,!0;if(r.isPrimitive()&&!r.isNull()){var a=r.toBooleanVar(e.service).getValue();if(null===a)return o=t.tractorErrorVarCreators[t.ErrorCode.PARAMETER_WRONG_DATA_TYPE]({funcName:i.name,index:n+1,value:r.getValue().toString().toUpperCase(),argType:t.FormulaErrorPhrases.DATA_TYPE_STRING,requiredArgType:t.FormulaErrorPhrases.DATA_TYPE_BOOLEAN}),!0;c=!0,l=l?!a:a}return!1})),o)return{value:o}};try{for(var d=a(o.entries()),f=d.next();!f.done;f=d.next()){var p=s(f.value,2),v=h(p[0],p[1]);if("object"==typeof v)return v.value}}catch(e){n={error:e}}finally{try{f&&!f.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}return c?new t.BooleanVar(l):t.tractorErrorVarCreators[t.ErrorCode.NO_VALID_DATA]({funcName:this.name})},n}(t.FuncOpBase),e.NFunc=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="N",n.operands=1,n.optionOperands=0,n.resultType=t.VAR_TYPE.NUMBER,n.repeatedLastParam=0,n.paramsDesc=[{type:t.VAR_TYPE.NUMBER|t.VAR_TYPE.BOOL|t.VAR_TYPE.STRING|t.VAR_TYPE.NULL}],n}return r(n,e),n.prototype.func=function(e,n){return n.isNumber()?n:n.isBool()?n.toNumberVar():new t.NumberVar(0)},n}(t.FuncOpBase),e.averageVar=u,e.betaDistCdf=N,e.betaDistPdf=P,e.betaInv=B,e.buildCriteria=Le,e.calcGcdOrLcm=Je,e.ceiling=pe,e.ceilingWith15Digits=ve,e.combin=ot,e.compareFunction=Fe,e.complexToString=we,e.constantToVar=xe,e.convertCriteriaVar=Ze,e.countVar=Me,e.countaVar=ke,e.createComplex=Re,e.dec2signedBin=f,e.digitsNumberChecker=Ie,e.erf=Ke,e.escapeRgeExp=We,e.excelDateToJSDate=Xe,e.factorialCalc=it,e.findRoot=ne,e.floor=fe,e.floorWith15Digits=ge,e.fv=K,e.gamma=O,e.gammaInv=x,e.gammadistCdf=I,e.gammaln=M,e.gcd=qe,e.getBetaOrLogbeta=V,e.getCriteriaType=Ue,e.getLanczosSum=k,e.getSameSuffix=Se,e.inverseCode2TrueForm=_,e.ipmt=Y,e.isComparableVar=Ne,e.isValidBinary=m,e.isValidComplex=Te,e.isValidDec=T,e.isValidHex=b,e.isValidOct=E,e.largeVar=at,e.lcm=$e,e.log10=Oe,e.log2=Ae,e.maxVar=Qe,e.minVar=oe,e.newtonMethod=J,e.normInv=w,e.normdistPdf=A,e.normsdistCdf=R,e.npv=q,e.oneCriteriaCount=Pe,e.percentileVar=lt,e.pmt=z,e.power=et,e.ppmt=X,e.productVar=tt,e.quartVar=nt,e.quartileVar=ut,e.round=de,e.roundWith15Digits=_e,e.signedBin2dec=c,e.signedBin2signedHex=d,e.signedBin2signedOct=h,e.signedHex2signedBin=v,e.signedOct2signedBin=p,e.sln=ie,e.smallVar=st,e.splitAsterisk=ze,e.sumVar=l,e.trueForm2ComplementCode=y,e.trueForm2InverseCode=g,e.varianceVar=rt,e.wildcardToFastRegExp=Ye,e.wildcardToRegExp=Ge,e.xnpv=$,Object.defineProperty(e,"__esModule",{value:!0})}(t,n("vsh_22485"))},vsh_81611:function(e,t,n){!function(e,t,n){"use strict";var r,i,o=function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)};function a(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function s(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function u(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function l(e){return{textDocument:e}}function c(e,t){return{capabilities:e,initializeOptions:t}}function h(e){return{textDocument:{formula:e}}}function d(e,t){return{textDocument:{formula:e},position:{character:t}}}function f(e,t,n,r){return{red:e,green:t,blue:n,alpha:r}}function p(e,t){return{line:t,character:e}}function v(e,t){return{start:p(e),end:p(t)}}function g(e,t,n,r,i){return{range:v(e,t),tokenType:n,refId:r,color:i}}function _(e,n,r){return void 0===r&&(r=t.LSPDocumentHighlightType.BracketMatching),{range:v(e,n),highlightType:r}}function y(e,t){return{label:e,labelDetails:{description:t}}}function m(e,t,n){return{label:e,documentation:t,type:n}}function E(e,t,n,r,i){return{label:e,example:t,documentation:n,parameters:r,activeParameter:i}}function b(e){return{signatures:[e]}}function T(e){return{capabilities:e}}function C(e,t,n,r){return{jsonrpc:null,id:e,result:t,error:n,metaData:r}}function S(e,t){return{code:e,message:t}}e.LocalLSPConnection=function(){function e(e,t){this.client=e,this.server=t,this.client.setConnection(this),this.server.setConnection(this)}return e.prototype.sendRequest=function(e){return this.server.handleRequest(e)},e}(),e.ParamsCreators={createInitializeParams:c,createDocumentColorParams:h,createTextDocumentPositionParams:d},e.ContextItemType=void 0,(i=e.ContextItemType||(e.ContextItemType={})).FUNCTION="func",i.PARENTHESIS="paren",e.TractorTextDocumentCapabilities=void 0,(r=e.TractorTextDocumentCapabilities||(e.TractorTextDocumentCapabilities={})).COMPLETION="completion",r.SIGNATURE_HELP="signatureHelp",r.DOCUMENT_HIGHLIGHT="documentHighlight",r.COLOR_PROVIDER="colorProvider",e.OpenParenPattern=/(?:\(|\uFF08)/,e.CloseParenPattern=/(?:\)|\uFF09)/,e.CommaPattern=/(?:,|\uFF0C)/;var w=function(){function e(){}return e.getColorInfos=function(e){for(var t=e.tokens,n=e.tokenInfoGetters,r=e.tokenTypes,i=[],o=0,a=new Map,s=0;s<t.length;s++){var u=t[s],l=n.getTokenText(u),c=n.getTokenType(u),h=n.getStartOffset(u),d=n.getEndOffset(u);switch(c){case r.LogicalConstant:case r.LogicalTrue:case r.LogicalFalse:case r.NumericalConstant:case r.StringConstant:i.push(g(h,d,c));break;case r.LocalReferenceR1C1:case r.ExternalReferenceR1C1:case r.LocalReferenceA1:case r.ExternalReferenceA1:var f=-1;a.has(l)?f=a.get(l).id:(a.set(l,{id:o}),f=o,o+=1),i.push(g(h,d,c,f))}}return i},e.handle=function(t){var n=e.getColorInfos(t);return null==n||0===n.length?null:n},e}(),R=function(){function n(){}return n.getHighlightInfos=function(t,n,r){for(var i=new Map,o=[],a=0;a<t.length;a++){var s=t[a],u=r.getTokenText(s),l=r.getTokenType(s),c=r.getStartOffset(s);switch(l){case n.FunctionName:var h=u&&u.trim();o.push({type:e.ContextItemType.FUNCTION,name:h.slice(0,h.length-1),operandStarts:[c+h.length-1],start:c});break;case n.OpenParen:o.push({type:e.ContextItemType.PARENTHESIS,start:c});break;case n.CloseParen:if(0===o.length)break;var d=o.pop(),f=0,p=u.search(e.CloseParenPattern);if(-1===p)return null;var v=c+p;f=d.type===e.ContextItemType.FUNCTION?d.operandStarts[0]:d.start,i.set(f,v),i.set(v,f)}}return i},n.handle=function(r){var i=r.formula,o=r.index,a=i[o];if(o<0||o>=i.length||!e.OpenParenPattern.test(a)&&!e.CloseParenPattern.test(a))return null;var s=n.getHighlightInfos(r.tokens,r.tokenTypes,r.tokenInfoGetters);if(null==s)return null;var u=[],l=o,c=s.get(l);if(null==c)return null;if(l>c){var h=l;l=c,c=h}return u.push(_(l,l,t.LSPDocumentHighlightType.BracketMatching)),u.push(_(c,c,t.LSPDocumentHighlightType.BracketMatching)),u},n}(),A=function(){function e(){}return e.handle=function(e){var t=e.getToken(e.character),n=e.i18n;if(null==t||e.getTokenType(t)!==e.tokenTypes.Name)return null;var r=e.getTokenText(t),i=e.getMatchedFuncs(r);if(null==i||0===i.length)return null;for(var o=[],a=0;a<i.length;a++){var s=i[a],u=n.getFuncDesc(s);o.push(y(s,u))}return o},e}();function O(e,t){return e===t}function M(e,t){var n=e-1;if(n<0)return null;for(var r=null,i=null,o=0;o<t.length;o++){var a=t[o];a.start<=n&&n<a.stop&&(i=r,r=a)}if(null!=i&&null!=r&&n<r.operandStarts[0]&&(r=i),null==r)return null;var s=r.operandStarts,u=-1;for(o=0;o<s.length&&!(n<s[o]);o++)u++;return{func:r.func,operands:r.operands,activeOperand:u}}e.DEFAULT_RANGE_COLORS=[f(255,136,0,1),f(127,59,245,1),f(255,198,10,1),f(20,192,255,1),f(245,74,69,1),f(0,214,185,1),f(240,29,148,1)],e.PRIMITIVE_COLOR={STRING:f(52,199,36,1),NUMBER:f(51,112,255,1),LOGICAL_CONSTANT:f(51,112,255,1)};var k=function(){function n(){}return n.getFuncInfos=function(t,n,r,i,o){for(var a=[],s=[],u=0;u<n.length;u++){var l=n[u],c=i.getTokenText(l),h=i.getTokenType(l),d=i.getStartOffset(l);switch(h){case r.FunctionName:var f=c&&c.trim();s.push({type:e.ContextItemType.FUNCTION,name:f.slice(0,f.length-1),operandStarts:[d+f.length-1],start:d});break;case r.OpenParen:s.push({type:e.ContextItemType.PARENTHESIS,start:d});break;case r.CloseParen:if(0===s.length)break;var p=s.pop();if(-1===(_=c.search(e.CloseParenPattern)))return null;var v=d+_;p.type===e.ContextItemType.FUNCTION&&null!=(m=o(p.name.toUpperCase()))&&a.push({func:m,operandStarts:p.operandStarts,operands:p.operandStarts.length,start:p.start,stop:v});break;case r.Comma:var g=s[s.length-1];if(g&&g.type===e.ContextItemType.FUNCTION){var _=c.search(e.CommaPattern);g.operandStarts.push(d+_)}}}for(;s.length>0;){var y=s.pop();if(y.type===e.ContextItemType.FUNCTION){var m;null!=(m=o((c=y.name).toUpperCase()))&&a.push({func:m,operandStarts:y.operandStarts,operands:y.operandStarts.length,start:y.start,stop:t.length});break}}return a.reverse(),a},n.handle=function(e){var r=n.getFuncInfos(e.formula,e.tokens,e.tokenTypes,e.tokenInfoGetters,e.getFunctionOp),i=[];function o(e,t){e.forEach((function(e){i.push(m(e.name,e.desc,t))}))}if(null==r)return null;var a=M(e.character,r);if(null==a||null==a.func)return null;var s=a.func,u=e.i18n,l=u.getFuncDesc(s.name),c=u.getFuncExample(s.name),h=u.getRequiredParams(s),d=u.getOptionalNotRepeatParams(s),f=u.getOptionalRepeatParams(s);return null==h||null==d||null==f?null:(o(h,t.ArgumentTypes.Required),o(d,t.ArgumentTypes.OptionalNotRepeated),o(f,t.ArgumentTypes.OptionalRepeated),b(E(s.name,c,l,i,a.activeOperand)))},n}(),I={onCancel:function(){return t.LSPErrorCodes.RequestCancelled},onDispose:function(){return t.LSPErrorCodes.ServerCancelled}};function x(e,n,r){var i=r.value;r.value=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=e[0].textDocument.formula,o=this.lexFormula(r),a=o.errors,s=o.tokens,u=null;return null!=a&&a.length>0&&(u=S(t.LSPErrorCodes.ParseError,"Errors happened during tokenizing.")),0===s.length?{error:u,result:null}:{result:i.apply(this,e).result,error:u}}}function N(){var t=new e.TractorLSPClient,n=new e.TractorLSPServer;return{client:t,server:n,connection:new e.LocalLSPConnection(t,n)}}function P(e,t){return o({jsonrpc:null,id:e},t)}e.TractorLSPServer=function(){function r(){var n,r,i,o=this;this.connection=null,this.isInitialized=!1,this.tokenTypes=null,this.formulaService=null,this.getFuncOp=null,this.compileTokens=null,this.tokenInfoGetters=null,this.funcNameList=[],this.tokens=[],this.errors=null,this.formula="",this.dispatchers=((n={})[t.LSPMethods.initialize]=function(e){return o.handleInitRequest(e)},n[t.LSPMethods.documentColor]=function(e){return o.handleDocumentColor(e)},n[t.LSPMethods.documentHighlight]=function(e){return o.handleDocumentHighlight(e)},n[t.LSPMethods.completion]=function(e){return o.handleCompletion(e)},n[t.LSPMethods.signatureHelp]=function(e){return o.handleSignatureHelp(e)},n),this.capabilities=((r={})[e.TractorTextDocumentCapabilities.COLOR_PROVIDER]=!1,r[e.TractorTextDocumentCapabilities.DOCUMENT_HIGHLIGHT]=!1,r[e.TractorTextDocumentCapabilities.COMPLETION]=!1,r[e.TractorTextDocumentCapabilities.SIGNATURE_HELP]=!1,r),this.methods2Capabilities=((i={})[t.LSPMethods.documentColor]=e.TractorTextDocumentCapabilities.COLOR_PROVIDER,i[t.LSPMethods.documentHighlight]=e.TractorTextDocumentCapabilities.DOCUMENT_HIGHLIGHT,i[t.LSPMethods.completion]=e.TractorTextDocumentCapabilities.COMPLETION,i[t.LSPMethods.signatureHelp]=e.TractorTextDocumentCapabilities.SIGNATURE_HELP,i)}return r.prototype.setConnection=function(e){this.connection=e},r.prototype.getConnection=function(){return this.connection},r.prototype.hasCapability=function(e){return this.methods2Capabilities[e]&&this.capabilities[this.methods2Capabilities[e]]},r.prototype.handleRequest=function(e){return this.dispatch(e)},r.prototype.dispatch=function(e){var n=e.id,r=e.method,i=e.params;if(r!==t.LSPMethods.initialize&&!this.isInitialized){var o=C(n,null,S(t.LSPErrorCodes.ServerNotInitialized,'"'.concat(r,'" request failed. The server has not initialized!')));return Promise.resolve(o)}if(this.isInitialized&&!this.hasCapability(r)){var a=C(n,null,S(t.LSPErrorCodes.InvalidRequest,"The server does not provide the capability for request ".concat(r)));return Promise.resolve(a)}var s=this.dispatchers[r](i),u=C(n,s.result,s.error,{tokens:this.tokens});return Promise.resolve(u)},r.prototype.handleInitRequest=function(e){var n,r,i=e.capabilities,o=e.initializeOptions,a=null;if(null==i?a=S(t.LSPErrorCodes.InvalidParams,"Initialization Failed: The required arguments (clientCapabilities or initializeOptions) for initializing the server are not found."):null==i.textDocument?a=S(t.LSPErrorCodes.InvalidParams,"Initialization Failed: The textDocument capability is not found"):null==o&&(a=S(t.LSPErrorCodes.InvalidParams,"Initialization Failed: The required arguments initializeOptions for initializing the server are not found.")),null!=a)return{result:null,error:a};var s=o,l=s.getTokenTypes,c=s.getTokenText,h=s.getStartOffset,d=s.getEndOffset,f=s.getTokenType,p=s.getFunctionNameList,v=s.compileTokens,g=s.getFunctionOperator,_=s.getFormulaService;if(null==_||null==_()||null==_().getFunctionOpManager?a=S(t.LSPErrorCodes.InvalidParams,"Initialization Failed:The method getFunctionOpManager in the provided formulaService is not found."):null!=l&&null!=l()&&null!=c&&null!=h&&null!=d&&null!=f&&null!=p&&null!=p()&&null!=v&&null!=g&&null!=_&&null!=_()||(a=S(t.LSPErrorCodes.InvalidParams,"Initialization Failed: The required arguments in initializeOptions for initializing the server are not found.")),null!=a)return{result:null,error:a};this.tokenTypes=l(),this.tokenInfoGetters={getTokenText:c,getStartOffset:h,getEndOffset:d,getTokenType:f},this.funcNameList=p().sort(),this.compileTokens=v,this.formulaService=_(),this.getFuncOp=g,this.isInitialized=!0;var y=i.textDocument;if((y.completion||y.signatureHelp)&&null==_().i18n)return{result:null,error:a=S(t.LSPErrorCodes.InvalidParams,"Initialization Failed: The properties in the formulaService.i18nare not found for auto-completion and signatureHelp capabilities.")};try{for(var m=u(Object.keys(this.capabilities)),E=m.next();!E.done;E=m.next()){var b=E.value;b in y&&y[b]&&(this.capabilities[b]=!0)}}catch(e){n={error:e}}finally{try{E&&!E.done&&(r=m.return)&&r.call(m)}finally{if(n)throw n.error}}return{result:T(this.capabilities),error:null}},r.prototype.reset=function(){this.tokens=[],this.errors=null},r.prototype.setFormula=function(e){this.formula=e},r.prototype.getFormula=function(){return this.formula},r.prototype.setTokens=function(e){this.tokens=e},r.prototype.getTokens=function(){return this.tokens},r.prototype.getFunctionOp=function(e){var t=this.formulaService.getFunctionOpManager(),n=t.find(e);if(null!=n)return n;var r=" ",i=e.trim();r=0!==i.length?i:r;var o=this.getFuncOp(r);if(null==o)return null;var a=new o(r);return t.register(a),a},r.prototype.lexFormula=function(e){if(O(e,this.getFormula()))return{tokens:this.tokens,errors:this.errors};this.setFormula(e),this.reset();var t=this.compileTokens(e);return this.setTokens(t.tokens),this.errors=t.errors,t},r.prototype.getToken=function(e){if(e<=0)return null;for(var t=e-1,n=this.getTokens(),r=0;r<n.length;r++){var i=n[r],o=this.tokenInfoGetters.getStartOffset(i),a=this.tokenInfoGetters.getEndOffset(i);if(o<=t&&t<=a)return i}return null},r.prototype.getMatchedFuncs=function(e){if(""===e)return[];e=e.toUpperCase();for(var t=[],r=n.lowerBound(this.funcNameList,e,(function(e,t){return e<t}));r<this.funcNameList.length;r++){var i=this.funcNameList[r];if(!i.startsWith(e))break;t.push(i)}return t},r.prototype.handleDocumentColor=function(e){var t={tokens:this.tokens,tokenTypes:this.tokenTypes,tokenInfoGetters:this.tokenInfoGetters};return{result:w.handle(t),error:null}},r.prototype.handleDocumentHighlight=function(e){var t=e.textDocument.formula,n=e.position.character,r={formula:t,tokens:this.tokens,tokenTypes:this.tokenTypes,tokenInfoGetters:this.tokenInfoGetters,index:n-1};return{result:R.handle(r),error:null}},r.prototype.handleCompletion=function(e){var t=this,n={character:e.position.character,i18n:this.formulaService.i18n,tokenTypes:this.tokenTypes,getToken:function(e){return t.getToken(e)},getMatchedFuncs:function(e){return t.getMatchedFuncs(e)},getTokenType:function(e){return t.tokenInfoGetters.getTokenType(e)},getTokenText:function(e){return t.tokenInfoGetters.getTokenText(e)}};return{result:A.handle(n),error:null}},r.prototype.handleSignatureHelp=function(e){var t=this,n={formula:e.textDocument.formula,character:e.position.character,tokens:this.tokens,tokenTypes:this.tokenTypes,tokenInfoGetters:this.tokenInfoGetters,i18n:this.formulaService.i18n,getFunctionOp:function(e){return t.getFunctionOp(e)}};return{result:k.handle(n),error:null}},r.prototype.dispose=function(){this.connection=null,this.tokenTypes=null,this.tokenInfoGetters=null,this.funcNameList=[],this.compileTokens=null,this.getFuncOp=null,this.formulaService=null,this.formula="",this.reset(),this.dispatch.dispose()},a([t.withCancelable(I),s("design:type",Function),s("design:paramtypes",[Object]),s("design:returntype",Object)],r.prototype,"dispatch",null),a([x,s("design:type",Function),s("design:paramtypes",[Object]),s("design:returntype",Object)],r.prototype,"handleDocumentColor",null),a([x,s("design:type",Function),s("design:paramtypes",[Object]),s("design:returntype",Object)],r.prototype,"handleDocumentHighlight",null),a([x,s("design:type",Function),s("design:paramtypes",[Object]),s("design:returntype",Object)],r.prototype,"handleCompletion",null),a([x,s("design:type",Function),s("design:paramtypes",[Object]),s("design:returntype",Object)],r.prototype,"handleSignatureHelp",null),r}(),e.TractorLSPClient=function(){function n(){this.requestId=0,this.docCapabilities=null,this.connection=null}return n.prototype.setConnection=function(e){this.connection=e},n.prototype.getConnection=function(){return this.connection},n.prototype.initialize=function(n,r){var i=this,o=e.ParamsCreators.createInitializeParams(n,r);if(null==n.textDocument)return null;this.docCapabilities=n.textDocument;var a={method:t.LSPMethods.initialize,params:o},s=this.sendRequest(a);return null==s?null:s.promise.then((function(e){return i.handleInitResponse(e)})).catch((function(e){return e}))},n.prototype.sendRequest=function(e){var t=P(this.requestId,e);if(null==this.connection)return null;var n=this.connection.sendRequest(t);return this.requestId+=1,n},n.prototype.handleInitResponse=function(e){var t,n;if(e.error)throw new Error("".concat(e.error.code,": ").concat(e.error.message));if(null==e.result)return null;var r=e.result.capabilities;if(null==this.docCapabilities)return null;try{for(var i=u(Object.keys(this.docCapabilities)),o=i.next();!o.done;o=i.next()){var a=o.value;a in r&&r[a]||(this.docCapabilities[a]=!1)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return this.docCapabilities},n.prototype.sendColorRequest=function(n){var r=e.ParamsCreators.createDocumentColorParams(n),i={method:t.LSPMethods.documentColor,params:r};return this.sendRequest(i)},n.prototype.sendHighlightRequest=function(n,r){var i=e.ParamsCreators.createTextDocumentPositionParams(n,r),o={method:t.LSPMethods.documentHighlight,params:i};return this.sendRequest(o)},n.prototype.sendCompletionRequest=function(n,r){var i=e.ParamsCreators.createTextDocumentPositionParams(n,r),o={method:t.LSPMethods.completion,params:i};return this.sendRequest(o)},n.prototype.sendSignatureHelpRequest=function(n,r){var i=e.ParamsCreators.createTextDocumentPositionParams(n,r),o={method:t.LSPMethods.signatureHelp,params:i};return this.sendRequest(o)},n}(),e.creatTractorLSPRange=v,e.createClientCapabilities=l,e.createLSPConnection=N,e.createTractorLSPColor=f,e.createTractorLSPColorInformation=g,e.createTractorLSPCompletionItem=y,e.createTractorLSPDocumentHighlight=_,e.createTractorLSPInitializeResult=T,e.createTractorLSPParameterInformation=m,e.createTractorLSPPosition=p,e.createTractorLSPResponseError=S,e.createTractorLSPResponseMsg=C,e.createTractorLSPSignatureHelp=b,e.createTractorLSPSignatureInformation=E,e.getCurrentFuncDeclaration=M,e.isSameText=O,e.validate=x,Object.defineProperty(e,"__esModule",{value:!0})}(t,n("vsh_22485"),n("vsh_76925"))},vsh_28185:function(e,t,n){!function(e,t){"use strict";e.BaseRef=function(){function e(){}return e.prototype.isRef=function(){return!0},e.prototype.parentRef=function(){return null},e.prototype.isValid=function(){return!0},e.prototype.intersect=function(e){return this.isIntersect(e)?this:null},e.prototype.isIntersect=function(e){return this.equal(e)},e.prototype.contain=function(e){return this.equal(e)},e.prototype.equal=function(e){return this.id()===e.id()&&this.type()===e.type()&&this.namespace()===e.namespace()},e}();var n,r,i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function a(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function s(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function u(t){return t.effectType()===e.ReactiveEffectType.Reactive}function l(t){return t.effectType()===e.ReactiveEffectType.Computed}function c(e){for(var t="".concat(e.type(),"[").concat(e.id(),"]"),n=e.parentRef();null!=n;)t="".concat(n.type(),"[").concat(n.id(),"].").concat(t),n=n.parentRef();return"".concat(e.namespace(),"::").concat(t)}function h(t){return"function"==typeof t.hashIter?t.hashIter():new e.THashIterator(t)}function d(e){return"function"==typeof e.effectedHashIter?e.effectedHashIter():h(e)}e.ReactiveEffectType=void 0,(r=e.ReactiveEffectType||(e.ReactiveEffectType={})).Computed="Computed",r.Reactive="Reactive",e.ReactivityEvent=void 0,(n=e.ReactivityEvent||(e.ReactivityEvent={})).onMarkDirtyCompleted="onMarkDirtyCompleted",n.onDependenciesValueChanged="onDependenciesValueChanged",n.beforeDependenciesRefChange="beforeDependenciesRefChange",n.afterDependenciesRefChange="afterDependenciesRefChange",e.WatchedRefHub=function(){function e(){this._wRefs=new Map,this._refOpHandler=new Map}return e.prototype.setRefOpHandler=function(e,t){null!==t?this._refOpHandler.set(e,t):this._refOpHandler.delete(e)},e.prototype.onRefOp=function(e,t,n){var r=this;if(!(this._wRefs.size<=0)){Array.isArray(e)||(e=[e]);for(var i=function(i){var a=e[i],s=a.effectedRef(),u=[];o._wRefs.forEach((function(e,i){s.every((function(e){return!e.isIntersect(i)}))||("function"==typeof t&&e.forEach((function(e){return t(i,e)})),r._refOpHandler.has(a.type())?r._refOpHandler.get(a.type())(i,a):"function"==typeof i.onOp&&i.onOp(a),"function"==typeof n&&e.forEach((function(e){return n(i,e)})),i.isValid()||u.push(i))}));for(var l=0;l<u.length;l++)o._wRefs.delete(u[l])},o=this,a=0;a<e.length;a++)i(a)}},e.prototype.watchRef=function(e,t){var n=this._wRefs.get(e);void 0===n&&(n=new Set,this._wRefs.set(e,n)),n.add(t)},e.prototype.unWatchRef=function(e,t){var n=this._wRefs.get(e);void 0!==n&&(void 0!==t?n.delete(t):this._wRefs.delete(e),0===n.size&&this._wRefs.delete(e))},e.prototype.refIter=function(){return this._wRefs.entries()},e.prototype.hasValue=function(e,t){var n=this._wRefs.get(e);return void 0!==n&&n.has(t)},e.prototype.size=function(){var e=0;return this._wRefs.forEach((function(t){e+=t.size})),e},e.prototype.clear=function(){this._wRefs.clear()},e}(),e.THashIterator=function(){function e(e){this.ref=e,this.done=!1}return e.prototype.next=function(){return this.done?null:(this.done=!0,c(this.ref))},e}(),e.RefHashNode=function(){function e(e){void 0===e&&(e=new Map),this.innerNode=e}return e.prototype.removeValue=function(e,t){var n,r,i=this.innerNode;if(0===e.length)i.clear();else if(null!=t&&i.has(t)){var o=i.get(t);this.nextLevelRemove(e,o,t)}else if(null==t)try{for(var u=a(i),l=u.next();!l.done;l=u.next()){var c=s(l.value,2),h=c[0];o=c[1],this.nextLevelRemove(e,o,h)}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}},e.prototype.nextLevelRemove=function(e,t,n){var r=e.pop();t.forEach((function(i,o){r.contain(o)&&0===e.length?t.delete(o):null!==i&&e.length>0&&r.isIntersect(o)&&(i.removeValue(e,n),0===i.data.size&&t.delete(o))})),e.push(r),0===t.size&&this.innerNode.delete(n)},e.prototype.isEmpty=function(){return 0===this.innerNode.size},e}(),e.RefHashMap=function(){function t(){this._data=new Map}return t.prototype.addValue=function(n,r){var i,o=n.pop();if(void 0!==o){for(var a=h(o),s=a.next();null!==s;){var u=this._data.get(s);void 0===u&&(u=new e.RefHashNode,this._data.set(s,u));var l=u.innerNode.get(r),c=n.length>0?new t:null;void 0===l?(l=new Map,u.innerNode.set(r,l)):c=null!==(i=l.get(o))&&void 0!==i?i:c,l.set(o,c),null!==c&&c.addValue(n,r),s=a.next()}n.push(o)}},t.prototype.removeValue=function(e,t){if(!(this._data.size<=0)&&0!==e.length)for(var n=h(e[e.length-1]),r=n.next();null!==r;){var i=this._data.get(r);void 0!==i&&(i.removeValue(e,t),i.isEmpty()&&this._data.delete(r)),r=n.next()}},t.prototype.iterValueByRef=function(e,t,n,r){var i,o,u,l;if(!(this._data.size<=0)){var c=e.pop();if(void 0!==c){for(var f=t?d(c):h(c),p=f.next();null!==p;){var v=this._data.get(p);if(null!=v)try{for(var g=(i=void 0,a(v.innerNode)),_=g.next();!_.done;_=g.next()){var y=s(_.value,2),m=y[0],E=y[1];if(null!==E&&!(null==r?void 0:r.isValueIterated(m)))try{for(var b=(u=void 0,a(E)),T=b.next();!T.done;T=b.next()){var C=s(T.value,2),S=C[0],w=C[1];if(S.isIntersect(c)){if(null==w||0===e.length){if(n(m,S))return}else w.iterValueByRef(e,t,n,r);if(null==r?void 0:r.isValueIterated(m))break}}}catch(e){u={error:e}}finally{try{T&&!T.done&&(l=b.return)&&l.call(b)}finally{if(u)throw u.error}}}}catch(e){i={error:e}}finally{try{_&&!_.done&&(o=g.return)&&o.call(g)}finally{if(i)throw i.error}}p=f.next()}e.push(c)}}},t.prototype.clear=function(){this._data.clear()},Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!1,configurable:!0}),t}(),e.RefHash=function(){function t(){this._hashMap=new e.RefHashMap}return t.prototype.addValue=function(e,t){var n=this.refPathStack(e);this._hashMap.addValue(n,t)},t.prototype.getValues=function(e){var t=new Set;return this.iterValueByRef(e,!1,(function(e){return t.add(e),!1})),Array.from(t)},t.prototype.removeValue=function(e,t){var n=this.refPathStack(e);this._hashMap.removeValue(n,t)},t.prototype.iterValueByRef=function(e,t,n,r){var i=this.refPathStack(e);return this._hashMap.iterValueByRef(i,t,n,r)},t.prototype.hashMap=function(){return this._hashMap},t.prototype.clear=function(){this._hashMap.clear()},t.prototype.refPathStack=function(e){for(var t=[],n=e;null!==n;)t.push(n),n=n.parentRef();return t},t}();var f,p,v=function(){function e(e){this.reactivitySpace=e,this.scheduler=null,this.queues=new Map}return e.prototype.batchMarkDirty=function(e,t){var n=this.queues.get(t);void 0===n?this.queues.set(t,[e]):_(n,e),this.schedule()},e.prototype.forceMarkDirtyDone=function(){for(;this.queues.size>0;)this.markDirty();this.scheduler=null},e.prototype.createScheduler=function(){return Promise.resolve()},e.prototype.schedule=function(){var e=this;0!==this.queues.size&&null===this.scheduler&&(this.scheduler=this.createScheduler().then((function(){e.scheduler=null,e.markDirty(),e.schedule()})))},e.prototype.markDirty=function(){var e=this.queues.keys().next().value;if(void 0!==e){for(var t=this.queues.get(e),n=0;n<t.length;n++)this.reactivitySpace.markDirty(t[n],e);this.queues.delete(e)}},e}();function g(e){return"function"==typeof e.union&&"function"==typeof e.isUnionable}function _(e,t){if(g(t)){for(var n=0;n<e.length;n++)if(t.isUnionable(e[n])){var r=t.union(e[n]);if(null!==r)return void(e[n]=r)}e.push(t)}else e.push(t)}e.DirtyStateService=function(){function e(){this.dirtyValues=new Set}return e.prototype.isDirty=function(e){return this.dirtyValues.has(e)},e.prototype.markDirty=function(e){this.dirtyValues.add(e)},e.prototype.getDirtyStates=function(){return this.dirtyValues},e.prototype.resetDirtyStates=function(){this.dirtyValues=new Set},e}(),e.ReactivityOptions=void 0,(p=e.ReactivityOptions||(e.ReactivityOptions={})).dependRefAdjust="dependRefAdjust",p.mountedRefAdjust="mountedRefAdjust",p.dirtinessTransfer="dirtinessTransfer";var y,m=((f={})[e.ReactivityOptions.dependRefAdjust]=1,f[e.ReactivityOptions.mountedRefAdjust]=2,f[e.ReactivityOptions.dirtinessTransfer]=4,f),E=m[e.ReactivityOptions.dependRefAdjust]|m[e.ReactivityOptions.mountedRefAdjust]|m[e.ReactivityOptions.dirtinessTransfer];e.DirtyType=void 0,(y=e.DirtyType||(e.DirtyType={}))[y.References=1]="References",y[y.Reactivities=2]="Reactivities";var b={isDirtyAlwaysCalc:!0};e.ReactivitySpace=function(t){function n(n){void 0===n&&(n=new e.DirtyStateService);var r=t.call(this)||this;return r.dirtyStateService=n,r.refSpace=new e.RefHash,r.dependenciesWatch=new e.WatchedRefHub,r.reactivitiesWatch=new e.WatchedRefHub,r.computedValues=new Set,r.reactiveValues=new Set,r.options=new WeakMap,r.dirtyComputedValues=new Map,r.invalidRefs=new Map,r.reactivitiesToMarkDirty=new Set,r.dirtyIgnored=!1,r.markDirtyQueue=new v(r),r}return o(n,t),n.prototype.registerReactivity=function(t,n){var r=t.getDependencies();this.setReactivityOption(t,n),this.registerDependencies(t,r),u(t)?(this.reactiveValues.add(t),this.getReactivityOption(t,e.ReactivityOptions.mountedRefAdjust)&&this.reactivitiesWatch.watchRef(t.getRef(),t)):this.computedValues.add(t)},n.prototype.registerDependencies=function(t,n){for(var r=0;r<n.length;r++){var i=n[r];i.isValid()?(this.getReactivityOption(t,e.ReactivityOptions.dirtinessTransfer)&&this.refSpace.addValue(i,t),this.getReactivityOption(t,e.ReactivityOptions.dependRefAdjust)&&this.dependenciesWatch.watchRef(i,t)):this.collectInvalidRef(t,i)}},n.prototype.unregisterReactivity=function(e){var t=e.getDependencies();this.unregisterDependencies(e,t),u(e)?(this.reactiveValues.delete(e),this.reactivitiesWatch.unWatchRef(e.getRef(),e)):this.computedValues.delete(e)},n.prototype.unregisterDependencies=function(e,t){for(var n=this.invalidRefs.get(e),r=0;r<t.length;r++)this.refSpace.removeValue(t[r],e),this.dependenciesWatch.unWatchRef(t[r],e),null==n||n.delete(t[r]);0===(null==n?void 0:n.size)&&this.invalidRefs.delete(e)},n.prototype.getReactivityOption=function(e,t){var n=this.options.get(e);return null==n||(n&m[t])===m[t]},n.prototype.setReactivityOption=function(t,n){if(null!=n){var r=E;!1===(null==n?void 0:n[e.ReactivityOptions.dependRefAdjust])&&(r&=~m[e.ReactivityOptions.dependRefAdjust]),!1===(null==n?void 0:n[e.ReactivityOptions.mountedRefAdjust])&&(r&=~m[e.ReactivityOptions.mountedRefAdjust]),!1===(null==n?void 0:n[e.ReactivityOptions.dirtinessTransfer])&&(r&=~m[e.ReactivityOptions.dirtinessTransfer]),this.options.set(t,r)}},n.prototype.onOp=function(e,t){this.executeRefOps(e),this.rebuildDependencies(t)},n.prototype.executeRefOps=function(t){var n=this;Array.isArray(t)||(t=[t]),this.markDirtyQueue.forceMarkDirtyDone(),this.refSpace.clear();for(var r=function(r){var o=t[r];i.reactivitiesWatch.onRefOp(o,(function(e,t){n.reactivitiesToMarkDirty.add(t)})),i.dependenciesWatch.onRefOp(o,(function(t,r){n.emit(e.ReactivityEvent.beforeDependenciesRefChange,t,r,o)}),(function(t,r){t.isValid()||n.collectInvalidRef(r,t),n.reactivitiesToMarkDirty.add(r),n.emit(e.ReactivityEvent.afterDependenciesRefChange,t,r,o)}))},i=this,o=0;o<t.length;o++)r(o)},n.prototype.rebuildDependencies=function(e){var t=this;this.reactiveValues.forEach((function(e){t.rebuildDependency(e)})),this.computedValues.forEach((function(e){t.rebuildDependency(e)})),!1===this.dirtyIgnored&&this.markDirtyByReactivities(Array.from(this.reactivitiesToMarkDirty),e),this.reactivitiesToMarkDirty.clear()},n.prototype.rebuildDependency=function(t){if(!1!==this.getReactivityOption(t,e.ReactivityOptions.dirtinessTransfer))for(var n=t.getDependencies(),r=0;r<n.length;r++){var i=n[r];i.isValid()&&this.refSpace.addValue(i,t)}},n.prototype.markDirty=function(t,n){this._markDirty(e.DirtyType.References,t,n)},n.prototype.markDirtyByReferences=function(t,n){this._markDirty(e.DirtyType.References,t,n)},n.prototype.markDirtyByReactivities=function(t,n){this._markDirty(e.DirtyType.Reactivities,t,n)},n.prototype._markDirty=function(t,n,r){void 0===r&&(r=b),this.dirtyIgnored||(!0!==r.useLastDirtyStates&&this.dirtyStateService.resetDirtyStates(),t===e.DirtyType.Reactivities?this._markDirtyByReactivities(n,r):this._markDirtyByReferences(n,r),"function"==typeof r.afterMarkDirty&&r.afterMarkDirty(),this.dirtyNotify(r))},n.prototype.batchMarkDirty=function(e,t){void 0===t&&(t=b),this.dirtyIgnored||this.markDirtyQueue.batchMarkDirty(e,t)},n.prototype._markDirtyByReferences=function(e,t){var n,r=this;void 0===t&&(t=b),Array.isArray(e)||(e=[e]);for(var i=null!==(n=t.validator)&&void 0!==n?n:null,o=e,a=new Set,s={isValueIterated:this.dirtyStateService.isDirty.bind(this.dirtyStateService)},l=function(){var e=o.shift();c.refSpace.iterValueByRef(e,!0,(function(n,s){if(null!==i&&!i.validateFn(n))return!1;if(u(n)){var l=r.markDirtyByReactiveValue(n,e,t);if(null==l)return!1;a.add(n);for(var c=0;c<l.length;c++)_(o,l[c])}else{var h=r.dirtyComputedValues.get(n);void 0===h&&r.dirtyComputedValues.set(n,h=new Set),h.add(s)}return!1}),s),null===i||i.isValidateAll||(i=null)},c=this;o.length>0;)l()},n.prototype._markDirtyByReactivities=function(e,t){void 0===t&&(t=b),Array.isArray(e)||(e=[e]);for(var n=[],r=new Set,i=0;i<e.length;++i){var o=e[i];if(u(o)){var a=this.markDirtyByReactiveValue(o,o.getRef(),t);if(null!=a){r.add(o);for(var s=0;s<a.length;s++)_(n,a[s])}}}this._markDirtyByReferences(n,t)},n.prototype.markDirtyByReactiveValue=function(t,n,r){if(!this.getReactivityOption(t,e.ReactivityOptions.dirtinessTransfer))return null;if(!0!==r.ignoreValueDirtyState&&t.isDirty(n))return null;var i=t.markDirty(n);return this.dirtyStateService.isDirty(t,i)?null:(this.dirtyStateService.markDirty(t,i),i)},n.prototype.collectInvalidRef=function(e,t){var n=this.invalidRefs.get(e);void 0===n&&this.invalidRefs.set(e,n=new Set),n.add(t)},n.prototype.dirtyNotify=function(t){this.dirtyComputedValues.forEach((function(t,n){n.emit(e.ReactivityEvent.onDependenciesValueChanged,t)})),this.dirtyComputedValues.clear(),this.emit(e.ReactivityEvent.onMarkDirtyCompleted,t)},n.prototype.ignoreDirty=function(e){this.dirtyIgnored=e},n.prototype.isIgnoreDirty=function(){return this.dirtyIgnored},n}(t.EventEmitter),e.ComputedRef=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return o(n,t),n.prototype.effectType=function(){return e.ReactiveEffectType.Computed},n.prototype.getRef=function(){return this},n}(t.withEventEmitter(e.BaseRef)),e.getEffectedHashIterator=d,e.getHashIterator=h,e.getRefHash=c,e.isComputedValue=l,e.isReactiveValue=u,Object.defineProperty(e,"__esModule",{value:!0})}(t,n("vsh_76925"))},vsh_63603:function(e,t){!function(e){"use strict";var t,n,r,i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}e.TType=function(){function e(){}return e.prototype.isAsync=function(){return!1},e.prototype.isRef=function(){return!1},e}(),e.Primitive=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t}(e.TType),e.Collection=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t}(e.TType),e.TractorFormulaCacheProps=void 0,(r=e.TractorFormulaCacheProps||(e.TractorFormulaCacheProps={})).value="v",r.info="i",r.type="t",r.specialInfo="s",r.error="e",r.customType="c",e.TractorFormulaCacheErrorProps=void 0,(n=e.TractorFormulaCacheErrorProps||(e.TractorFormulaCacheErrorProps={})).type="t",n.code="c",n.arguments="a",e.TractorCacheFormulaInfoProps=void 0,(t=e.TractorCacheFormulaInfoProps||(e.TractorCacheFormulaInfoProps={})).alwaysCalc="a",t.customDepends="p",t.customData="d",Object.defineProperty(e,"__esModule",{value:!0})}(t)},vsh_76925:function(e,t){!function(e){"use strict";function t(e,t,n){for(var r=e.length,i=0;r>0;){var o=r>>1,a=i+o;n(e[a],t)?(i=a+1,r-=o+1):r=o}return i}function n(e,t,n){for(var r=e.length,i=0;r>0;){var o=r>>1,a=i+o;n(t,e[a])?r=o:(i=a+1,r-=o+1)}return i}var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function o(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function a(e,t){switch(t.length){case 0:return e();case 1:return e(t[0]);case 2:return e(t[0],t[1]);case 3:return e(t[0],t[1],t[2]);default:return e.apply(void 0,t)}}function s(e){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.events={},t}return i(t,e),t.prototype.addListener=function(e,t){var n=this.events[e];return null==n?this.events[e]=[t]:n.push(t),this},t.prototype.removeListener=function(e,t){var n=this.events[e];if(null!=n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}return this},t.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this.events[e];if(null!=r)for(var i=0;i<r.length;i++)a(r[i],t)},t}(e)}function u(e,t){for(var n,r=0;r<t.length;r++)for(var i=t[r],o=Object.getOwnPropertyNames(i.prototype),a=0;a<o.length;a++){var s=o[a];Object.defineProperty(e.prototype,s,null!==(n=Object.getOwnPropertyDescriptor(i.prototype,s))&&void 0!==n?n:Object.create(null))}}e.Graph=function(){function e(){this.vertices=new Set,this.outgoing=new Map,this.incoming=new Map}return e.prototype.bfs=function(e){var t,n,r,i,a,s,u=[],l=new Map;try{for(var c=o(this.vertices),h=c.next();!h.done;h=c.next()){var d=h.value,f=null!==(s=null===(a=this.incoming.get(d))||void 0===a?void 0:a.size)&&void 0!==s?s:0;l.set(d,f),0===f&&u.push(d)}}catch(e){t={error:e}}finally{try{h&&!h.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}for(;u.length>0;){var p=u.shift();e(p);var v=this.outgoing.get(p);if(null!=v)try{for(var g=(r=void 0,o(v.keys())),_=g.next();!_.done;_=g.next())d=_.value,f=l.get(d)-1,l.set(d,f),0===f&&u.push(d)}catch(e){r={error:e}}finally{try{_&&!_.done&&(i=g.return)&&i.call(g)}finally{if(r)throw r.error}}}},e.prototype.insertEdge=function(e,t){var n=this.outgoing.get(e),r=this.incoming.get(t),i=this.insertVertex(e),o=this.insertVertex(t);if(void 0===n&&this.outgoing.set(e,n=new Map),void 0===r&&this.incoming.set(t,r=new Map),n.has(t))return n.get(t).refPtr++,!0;var a={refPtr:1};return n.set(t,a),r.set(e,a),!this.search(t,e)||(i&&this.removeVertex(e),o&&this.removeVertex(t),n.delete(t),r.delete(e),!1)},e.prototype.search=function(e,t){var n=this.outgoing.get(e);if(n)for(var r=n.entries(),i=r.next();i.value;i=r.next()){var o=i.value[0];if(o===t)return!0;if(this.search(o,t))return!0}return!1},e.prototype.removeEdge=function(e,t){var n,r,i=this.outgoing.get(e),o=this.incoming.get(t);if(void 0===i||void 0===o)return!1;if(!i.has(t)||!o.has(e))return!1;var a=i.get(t);return a.refPtr--,a.refPtr>0||(i.delete(t),o.delete(e),0===i.size&&(this.outgoing.delete(e),(null===(n=this.incoming.get(e))||void 0===n?void 0:n.size)||this.removeVertex(e)),0===o.size&&(this.incoming.delete(t),(null===(r=this.outgoing.get(t))||void 0===r?void 0:r.size)||this.removeVertex(t))),!0},e.prototype.insertVertex=function(e){return!this.vertices.has(e)&&(this.vertices.add(e),!0)},e.prototype.removeVertex=function(e){return!!this.vertices.has(e)&&(this.vertices.delete(e),!0)},e.prototype.size=function(){return this.vertices.size},e}(),e.LRUCache=function(){function e(e){this.capacity=e,this.map=new Map}return e.prototype.get=function(e){var t=this.map.get(e);return null==t?null:(this.map.delete(e),this.map.set(e,t),t)},e.prototype.set=function(e,t){this.map.has(e)?this.map.delete(e):this.map.size>=this.capacity&&this.map.delete(this.map.keys().next().value),this.map.set(e,t)},e.prototype.remove=function(e){return this.map.delete(e)},e.prototype.getOldest=function(){return[this.map.keys().next().value,this.map.values().next().value]},e.prototype.removeOldest=function(){var e=this.map.keys().next().value;return this.map.delete(e),e},e.prototype.size=function(){return this.map.size},e.prototype.clear=function(){this.map.clear()},e}(),e.EventEmitter=function(){function e(){this.events={}}return e.prototype.addListener=function(e,t){var n=this.events[e];return void 0===n?this.events[e]=[t]:n.push(t),this},e.prototype.removeListener=function(e,t){var n=this.events[e];if(void 0===n)return this;var r=n.indexOf(t);return-1!==r&&n.splice(r,1),this},e.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this.events[e];if(void 0!==r)for(var i=0;i<r.length;i++)a(r[i],t)},e}(),e.Task=function(){function t(){}return t.prototype.isSync=function(){return!1},t.prototype.isAsync=function(){return!1},t.sync=function(t){return new e.SyncTask(t)},t.async=function(t){return new e.AsyncTask(t)},t.catch=function(e,n){try{var r=e();return r.isAsync()?t.from(r.toPromise().catch((function(e){return n(e).resolve()}))):r}catch(e){return n(e)}},t.from=function(t){return t instanceof Promise?new e.AsyncTask(t):new e.SyncTask(t)},t.parallel=function(e){for(var n=[],r=[],i=function(t){var i=e[t].resolve();i instanceof Promise?r.push(i.then((function(e){return n[t]=e}))):n[t]=i},o=0;o<e.length;o++)i(o);return 0===r.length?t.sync(n):t.async(Promise.all(r).then((function(){return n})))},t.prototype.sync=function(e){return this.next((function(n){return t.sync(e(n))}))},t.prototype.async=function(e){return this.next((function(n){return t.async(e(n))}))},t.prototype.pipe=function(e){var t=this;return this.next((function(n){return e(n),t}))},t}(),e.SyncTask=function(e){function t(t){var n=e.call(this)||this;return n.value=t,n}return i(t,e),t.prototype.isSync=function(){return!0},t.prototype.resolve=function(){return this.value},t.prototype.next=function(e){return e(this.value)},t}(e.Task),e.AsyncTask=function(t){function n(e){var n=t.call(this)||this;return n.state={done:!1,result:null},n.value=e.then((function(e){return n.onTaskResolved(e),e})),n}return i(n,t),n.prototype.onTaskResolved=function(e){this.state.done=!0,this.state.result=e},n.prototype.isAsync=function(){return!0},n.prototype.isDone=function(){return this.state.done},n.prototype.toPromise=function(){return this.value},n.prototype.resolve=function(){return this.state.done?this.state.result:this.value},n.prototype.next=function(t){if(this.state.done)return t(this.state.result);var n=this.value.then((function(e){return t(e).resolve()}));return e.Task.async(n)},n}(e.Task),e.apply=a,e.applyMixins=u,e.lowerBound=t,e.upperBound=n,e.withEventEmitter=s,Object.defineProperty(e,"__esModule",{value:!0})}(t)},vsh_22485:function(e,t,n){var r=n("vsh_14224");!function(e,t,n,i){"use strict";var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},o(e,t)};function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s,u,l,c,h=function(){return h=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},h.apply(this,arguments)};function d(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function p(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function g(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function _(e,t){return"object"==typeof t?t.check(e):t&e.type}function y(e){return"object"==typeof e?e.type:e}function m(t,n){var r={},i=n[e.TractorCacheFormulaInfoProps.alwaysCalc];null!=i&&(r.alwaysCalc=i);var o=n[e.TractorCacheFormulaInfoProps.customData];null!=o&&(r.customData=JSON.parse(o));var a=t.getInfo();null!=a?Object.assign(a,r):t.setInfo(r)}function E(t){var n,r=null===(n=t.getState(t.getRef()).cache)||void 0===n?void 0:n.getInfo();if(null==r)return null;var i={};return null!=r.alwaysCalc&&(i[e.TractorCacheFormulaInfoProps.alwaysCalc]=r.alwaysCalc),null!=r.customData&&(i[e.TractorCacheFormulaInfoProps.customData]=JSON.stringify(r.customData)),b(i)?null:i}function b(e){for(var t in e)return!1;return!0}e.VAR_TYPE=void 0,(c=e.VAR_TYPE||(e.VAR_TYPE={}))[c.NULL=1]="NULL",c[c.NUMBER=2]="NUMBER",c[c.STRING=4]="STRING",c[c.BOOL=8]="BOOL",c[c.ERROR=16]="ERROR",c[c.PRIMITIVE=32]="PRIMITIVE",c[c.COLLECTION=64]="COLLECTION",c[c.FORMULA=128]="FORMULA",c[c.OPERATOR=256]="OPERATOR",c[c.THROW=512]="THROW",c[c.ASYNC=1024]="ASYNC",c[c.UNPREDICTABLE=2048]="UNPREDICTABLE",c[c.CUSTOM_PRIMITIVE=4096]="CUSTOM_PRIMITIVE",c[c.CUSTOM_COLLECTION=8192]="CUSTOM_COLLECTION",c[c.BASIC=31]="BASIC",c[c.ATOM=12384]="ATOM",c[c.ALL=14304]="ALL",e.BaseVar=function(){function t(){}return t.prototype.getVar=function(){return this},t.prototype.predict=function(){return this},t.prototype.clone=function(){throw new Error("Unimplemented clone methods")},t.prototype.toAsyncVar=function(){return new e.AsyncVar(this)},t.prototype.isString=function(){return this.type===e.VAR_TYPE.STRING},t.prototype.isNumber=function(){return this.type===e.VAR_TYPE.NUMBER},t.prototype.isBool=function(){return this.type===e.VAR_TYPE.BOOL},t.prototype.isError=function(){return this.type===e.VAR_TYPE.ERROR},t.prototype.isNull=function(){return this.type===e.VAR_TYPE.NULL},t.prototype.isOp=function(){return this.type===e.VAR_TYPE.OPERATOR},t.prototype.isPrimitive=function(){return this.type===e.VAR_TYPE.PRIMITIVE},t.prototype.isCollection=function(){return this.type===e.VAR_TYPE.COLLECTION},t.prototype.isCustomPrimitive=function(){return!1},t.prototype.isCustomCollection=function(){return!1},t.prototype.isFormula=function(){return this.type===e.VAR_TYPE.FORMULA},t.prototype.isAsync=function(){return this.type===e.VAR_TYPE.ASYNC},t.prototype.isRef=function(){return!1},t.prototype.isAsyncData=function(){return!1},t.prototype.isValid=function(){return!0},t.prototype.toValidVar=function(){return this},t.prototype.equals=function(e){return this===e},t.prototype.variantEquals=function(e){return this===e||this.type===e.type&&Object.getPrototypeOf(this).constructor===Object.getPrototypeOf(e).constructor&&this.strictEquals(e)},t.prototype.strictEquals=function(e){return this.equals(e)},t.prototype.notEquals=function(e){return!this.equals(e)},t.prototype.setSpecialInfo=function(e){var t;this.specialInfo=Object.assign(null!==(t=this.specialInfo)&&void 0!==t?t:{},e)},t.prototype.getSpecialInfo=function(){return this.specialInfo},t}(),e.PrimitiveVarIter=function(e){function t(t){var n=e.call(this)||this;return n.variant=t,n.idx=-1,n}return a(t,e),t.prototype.next=function(){return this.idx++,this.value()},t.prototype.value=function(){return 0===this.idx?this.variant:null},t}(t.FIterator),e.CollectionVarIter=function(e){function t(t,n){var r=e.call(this)||this;return r.v=t,r.ctx=n,r.idx=-1,r.size=0,r.size=t.size(),r}return a(t,e),t.prototype.next=function(){return++this.idx,this.value()},t.prototype.value=function(){return this.idx<this.size?this.v.nth(this.idx,this.ctx):null},t}(t.FIterator),e.TractorFormulaCacheProps=void 0,(l=e.TractorFormulaCacheProps||(e.TractorFormulaCacheProps={})).value="v",l.info="i",l.type="t",l.specialInfo="s",l.error="e",l.customType="c",e.TractorFormulaCacheErrorProps=void 0,(u=e.TractorFormulaCacheErrorProps||(e.TractorFormulaCacheErrorProps={})).type="t",u.code="c",u.arguments="a",e.TractorCacheFormulaInfoProps=void 0,(s=e.TractorCacheFormulaInfoProps||(e.TractorCacheFormulaInfoProps={})).alwaysCalc="a",s.customDepends="p",s.customData="d",e.FormulaCache=function(){function e(e,t){void 0===t&&(t=e),this.rawVar=e,this.variant=t,this.info=null}return e.prototype.getRawVar=function(){return this.rawVar},e.prototype.getVar=function(){return this.variant},e.prototype.setInfo=function(e){this.info=e},e.prototype.getInfo=function(){return this.info},e}(),e.PrimitiveVar=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.VAR_TYPE.PRIMITIVE,n}return a(n,t),n.prototype.isPrimitive=function(){return!0},n.prototype.isCollection=function(){return!1},n.prototype.iter=function(t){return new e.PrimitiveVarIter(this)},n.prototype.serialize=function(t){var n,r=((n={})[e.TractorFormulaCacheProps.type]=this.type,n);return null===this.specialInfo||void 0===this.specialInfo||b(this.specialInfo)||(r[e.TractorFormulaCacheProps.specialInfo]=JSON.stringify(this.specialInfo)),r},n}(e.BaseVar);var T,C,S=/^\s*[+-]?\s*(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:[eE][+-]?\d+)?[ \t]*/;function w(e){if(""===e)return null;var t=e.match(S);if(null==t)return null;var n=t[0].length;return n===e.length||"\n"===e[n]||"\r"===e[n]?parseFloat(t[0].replace(/\s/g,"")):null}function R(e){return e.getRef()}function A(e){return e.isLoad()}function O(e){return e.load()}function M(e){e.prototype.getRef=function(){var e=this.getAtom();return e.isRef()?e:null},e.prototype.isLoad=function(){var e=this.getAtom();return!e.isAsync()||e.isLoad()},e.prototype.load=function(){var e=this.getAtom();return e.isAsync()?e.load():Promise.resolve()}}e.BooleanConstant=void 0,(C=e.BooleanConstant||(e.BooleanConstant={})).TRUE="TRUE",C.FALSE="FALSE",e.BooleanVar=function(t){function n(n){var r=t.call(this)||this;return r.value=n,r.type=e.VAR_TYPE.BOOL,r}return a(n,t),n.prototype.getVar=function(){return this},n.prototype.getValue=function(){return this.value},n.prototype.toNumberVar=function(){return this.value?new e.NumberVar(1):new e.NumberVar(0)},n.prototype.toStringVar=function(){return this.value?new e.StringVar(n.TRUE):new e.StringVar(n.FALSE)},n.prototype.toBooleanVar=function(){return new n(this.value)},n.prototype.equals=function(e){return!!e.isBool()&&this.getValue()===e.getValue()},n.prototype.greaterThan=function(e){return!(!e.isBool()||this.equals(e))&&this.getValue()},n.prototype.lessThan=function(e){return!(!e.isBool()||this.equals(e)||this.getValue())},n.prototype.greaterThanEquals=function(e){return this.equals(e)||this.greaterThan(e)},n.prototype.lessThanEquals=function(e){return this.equals(e)||this.lessThan(e)},n.prototype.clone=function(){return new n(this.value)},n.prototype.serialize=function(n){var r=t.prototype.serialize.call(this,n);return r[e.TractorFormulaCacheProps.value]=this.value,r},n.TRUE=e.BooleanConstant.TRUE,n.FALSE=e.BooleanConstant.FALSE,n}(e.PrimitiveVar),e.BOOLEAN_VAR_MAP=((T={})[e.BooleanConstant.TRUE]=new e.BooleanVar(!0),T[e.BooleanConstant.FALSE]=new e.BooleanVar(!1),T),e.MAX_CALC_RESULT_STRING_LENGTH=32767,e.StringVar=function(t){function n(n){var r=t.call(this)||this;return r.value=n,r.type=e.VAR_TYPE.STRING,r}return a(n,t),n.prototype.getValue=function(){return this.value},n.prototype.toNumberVar=function(){var t=w(this.value);if(null==t)return e.NULL_VAR;var n=new e.NumberVar(t);return n.isValid()?n:e.NULL_VAR},n.prototype.toStringVar=function(){return new n(this.value)},n.prototype.toBooleanVar=function(){switch(this.value.toUpperCase()){case e.BooleanVar.TRUE:return new e.BooleanVar(!0);case e.BooleanVar.FALSE:return new e.BooleanVar(!1);default:return e.NULL_VAR}},n.prototype.equals=function(e,t){return void 0===t&&(t=!0),!!e.isString()&&(t?this.getValue().toLowerCase()===e.getValue().toLowerCase():this.getValue()===e.getValue())},n.prototype.greaterThan=function(e,t){return void 0===t&&(t=!0),!(!e.isString()||this.equals(e,t))&&(t?this.getValue().toLowerCase()>e.getValue().toLowerCase():this.getValue()>e.getValue())},n.prototype.lessThan=function(e,t){return void 0===t&&(t=!0),!(!e.isString()||this.equals(e,t))&&(t?this.getValue().toLowerCase()<e.getValue().toLowerCase():this.getValue()<e.getValue())},n.prototype.greaterThanEquals=function(e){return this.equals(e)||this.greaterThan(e)},n.prototype.lessThanEquals=function(e){return this.equals(e)||this.lessThan(e)},n.prototype.clone=function(){return new n(this.value)},n.prototype.isValid=function(){return this.value.length<=e.MAX_CALC_RESULT_STRING_LENGTH},n.prototype.toValidVar=function(){return this.isValid()?this:e.tractorErrorVarCreators[e.ErrorCode.TEXT_TOO_LONG]({funcName:"",maxCalcResultTextLength:e.MAX_CALC_RESULT_STRING_LENGTH})},n.prototype.serialize=function(n){var r=t.prototype.serialize.call(this,n);return r[e.TractorFormulaCacheProps.value]=this.value,r},n}(e.PrimitiveVar);var k,I,x,N,P,L=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13,1e14,1e15,1e16,1e17,1e18,1e19,1e20,1e21,1e22,1e23,1e24,1e25,1e26,1e27,1e28,1e29,1e30,1e31,1e32,1e33,1e34,1e35,1e36,1e37,1e38,1e39,1e40,1e41,1e42,1e43,1e44,1e45,1e46,1e47,1e48,1e49,1e50,1e51,1e52,1e53,1e54,1e55,1e56,1e57,1e58,1e59,1e60,1e61,1e62,1e63,1e64,1e65,1e66,1e67,1e68,1e69,1e70,1e71,1e72,1e73,1e74,1e75,1e76,1e77,1e78,1e79,1e80,1e81,1e82,1e83,1e84,1e85,1e86,1e87,1e88,1e89,1e90,1e91,1e92,1e93,1e94,1e95,1e96,1e97,1e98,1e99,1e100,1e101,1e102,1e103,1e104,1e105,1e106,1e107,1e108,1e109,1e110,1e111,1e112,1e113,1e114,1e115,1e116,1e117,1e118,1e119,1e120,1e121,1e122,1e123,1e124,1e125,1e126,1e127,1e128,1e129,1e130,1e131,1e132,1e133,1e134,1e135,1e136,1e137,1e138,1e139,1e140,1e141,1e142,1e143,1e144,1e145,1e146,1e147,1e148,1e149,1e150,1e151,1e152,1e153,1e154,1e155,1e156,1e157,1e158,1e159,1e160,1e161,1e162,1e163,1e164,1e165,1e166,1e167,1e168,1e169,1e170,1e171,1e172,1e173,1e174,1e175,1e176,1e177,1e178,1e179,1e180,1e181,1e182,1e183,1e184,1e185,1e186,1e187,1e188,1e189,1e190,1e191,1e192,1e193,1e194,1e195,1e196,1e197,1e198,1e199,1e200,1e201,1e202,1e203,1e204,1e205,1e206,1e207,1e208,1e209,1e210,1e211,1e212,1e213,1e214,1e215,1e216,1e217,1e218,1e219,1e220,1e221,1e222,1e223,1e224,1e225,1e226,1e227,1e228,1e229,1e230,1e231,1e232,1e233,1e234,1e235,1e236,1e237,1e238,1e239,1e240,1e241,1e242,1e243,1e244,1e245,1e246,1e247,1e248,1e249,1e250,1e251,1e252,1e253,1e254,1e255,1e256,1e257,1e258,1e259,1e260,1e261,1e262,1e263,1e264,1e265,1e266,1e267,1e268,1e269,1e270,1e271,1e272,1e273,1e274,1e275,1e276,1e277,1e278,1e279,1e280,1e281,1e282,1e283,1e284,1e285,1e286,1e287,1e288,1e289,1e290,1e291,1e292,1e293,1e294,1e295,1e296,1e297,1e298,1e299,1e300,1e301,1e302,1e303,1e304,1e305,1e306,1e307,1e308];function D(e){if(-1/0===e||1/0===e)return e;if(22250738585072014e-324>Math.abs(e))return 0;var t=14-B(Math.floor(Math.log10(Math.abs(e))))|0;return 308<t?F(1e308*e*(t=L[t-308|0]))/1e308/t:0<=t?F(e*(t=L[t]))/t:(t=L[0|-t],t*=F(e/t),179769313486231e294<=e||179769313486231e294<=t?179769313486231e294:-179769313486231e294>=e||-179769313486231e294>=t?-179769313486231e294:t)}function F(e){if((e=Math.round(e))>0)return e>=0x8000000000000000?0x8000000000000000:4294967296*(e/4294967296|0)+((0|e)>>>0);if(e<0){if(e<=-0x8000000000000000)return-0x8000000000000000;var t=1+~(0|-e)|0;return 4294967296*(~(-e/4294967296|0)+!t|0)+(t>>>0)}return 0}function B(e){return 0|Math.max(Math.min(e,2147483647),-2147483648)}e.NumberVar=function(t){function n(n){var r=t.call(this)||this;return r.value=n,r.type=e.VAR_TYPE.NUMBER,r}return a(n,t),n.prototype.getVar=function(){return this},n.prototype.getValue=function(){return this.value},n.prototype.toNumberVar=function(){return this},n.prototype.toStringVar=function(){return new e.StringVar(this.getCompareValue().toString())},n.prototype.toBooleanVar=function(){return this.value?new e.BooleanVar(!0):new e.BooleanVar(!1)},n.prototype.isValid=function(){return Number.isFinite(this.value)},n.prototype.toValidVar=function(){return this.isValid()?this:e.NUM_ERR_VAR},n.prototype.getCompareValue=function(){return void 0===this.compareValue&&(this.compareValue=D(this.value)),this.compareValue},n.prototype.equals=function(e){return!!e.isNumber()&&this.getCompareValue()===e.getCompareValue()},n.prototype.greaterThan=function(e){return!!e.isNumber()&&this.getCompareValue()>e.getCompareValue()},n.prototype.lessThan=function(e){return!!e.isNumber()&&this.getCompareValue()<e.getCompareValue()},n.prototype.greaterThanEquals=function(e){return!!e.isNumber()&&this.getCompareValue()>=e.getCompareValue()},n.prototype.lessThanEquals=function(e){return!!e.isNumber()&&this.getCompareValue()<=e.getCompareValue()},n.doubleEqual=function(e,t){if(!Number.isFinite(e)||!Number.isFinite(t))return e===t;if(Number.isNaN(e)||Number.isNaN(t))return!1;var n=Math.abs(e-t);if(0===n)return!0;var r=Math.max(Math.abs(e),Math.abs(t));return n<Math.pow(2,Math.floor(Math.log2(r))-49)},n.toFixed=function(e,t){var n=Math.pow(10,t);return Math.floor(D(e*n))/n},n.prototype.clone=function(){return new n(this.value)},n.prototype.serialize=function(n){var r=t.prototype.serialize.call(this,n);return r[e.TractorFormulaCacheProps.value]=this.value,r},n}(e.PrimitiveVar),e.NullVar=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.VAR_TYPE.NULL,n}return a(n,t),n.prototype.toNumberVar=function(){return new e.NumberVar(0)},n.prototype.toStringVar=function(){return new e.StringVar("")},n.prototype.toBooleanVar=function(){return new e.BooleanVar(!1)},n.prototype.getValue=function(){return null},n.prototype.equals=function(e){return e.isNull()},n.prototype.notEquals=function(e){return!this.equals(e)},n.prototype.greaterThan=function(e){return!1},n.prototype.lessThan=function(e){return!1},n.prototype.greaterThanEquals=function(e){return!0},n.prototype.lessThanEquals=function(e){return!0},n.prototype.clone=function(){return new n},n.prototype.serialize=function(n){var r=t.prototype.serialize.call(this,n);return r[e.TractorFormulaCacheProps.value]=null,r},n}(e.PrimitiveVar),e.NULL_VAR=new e.NullVar,e.ErrorConstant=void 0,(P=e.ErrorConstant||(e.ErrorConstant={})).UNKNOWN="UNKNOWN",P.NULL="#NULL!",P.DIV0="#DIV/0!",P.VALUE="#VALUE!",P.REF="#REF!",P.NAME="#NAME?",P.NUM="#NUM!",P.NA="#N/A",P.GETTING_DATA="#GETTING_DATA",P.CALC="#CALC!",P.RUNTIME_ERROR="#ERROR",P.CIRCULAR_DEPENDENCY="#CIRCLE@",P.SUSPENDED="",P.WAIT_ASYNC="Loading...",e.ErrorType=void 0,(N=e.ErrorType||(e.ErrorType={}))[N.UNKNOWN=-1]="UNKNOWN",N[N.NULL=1]="NULL",N[N.DIV0=2]="DIV0",N[N.VALUE=3]="VALUE",N[N.REF=4]="REF",N[N.NAME=5]="NAME",N[N.NUM=6]="NUM",N[N.NA=7]="NA",N[N.GETTING_DATA=8]="GETTING_DATA",N[N.CALC=14]="CALC",N[N.RUNTIME_ERROR=1e4]="RUNTIME_ERROR",N[N.WAIT_ASYNC=10001]="WAIT_ASYNC",N[N.CIRCULAR_DEPENDENCY=10003]="CIRCULAR_DEPENDENCY",N[N.SUSPENDED=10004]="SUSPENDED",e.error2DescriptionMap=((k={})[e.ErrorType.UNKNOWN]=e.ErrorConstant.UNKNOWN,k[e.ErrorType.NULL]=e.ErrorConstant.NULL,k[e.ErrorType.DIV0]=e.ErrorConstant.DIV0,k[e.ErrorType.VALUE]=e.ErrorConstant.VALUE,k[e.ErrorType.REF]=e.ErrorConstant.REF,k[e.ErrorType.NAME]=e.ErrorConstant.NAME,k[e.ErrorType.NUM]=e.ErrorConstant.NUM,k[e.ErrorType.NA]=e.ErrorConstant.NA,k[e.ErrorType.GETTING_DATA]=e.ErrorConstant.GETTING_DATA,k[e.ErrorType.CALC]=e.ErrorConstant.CALC,k[e.ErrorType.RUNTIME_ERROR]=e.ErrorConstant.RUNTIME_ERROR,k[e.ErrorType.CIRCULAR_DEPENDENCY]=e.ErrorConstant.CIRCULAR_DEPENDENCY,k[e.ErrorType.SUSPENDED]=e.ErrorConstant.SUSPENDED,k[e.ErrorType.WAIT_ASYNC]=e.ErrorConstant.WAIT_ASYNC,k);var V,H,U=2;function Z(e,t){return!!W(e,t)||!!j(e,t)}function W(t,n){var r,i,o,a,s=n.type;if(_(t,s))if(t.isCustomPrimitive()&&y(s)&e.VAR_TYPE.CUSTOM_PRIMITIVE){if((null!==(i=null===(r=n.customType)||void 0===r?void 0:r.primitive)&&void 0!==i?i:[]).includes(t.customType))return!0}else{if(!(t.isCustomCollection()&&y(s)&e.VAR_TYPE.CUSTOM_COLLECTION))return!0;if((null!==(a=null===(o=n.customType)||void 0===o?void 0:o.collection)&&void 0!==a?a:[]).includes(t.customType))return!0}return!1}function j(t,n){var r=n.type;return!!(t.isPrimitive()&&y(r)&e.VAR_TYPE.PRIMITIVE)||!!(t.isCustomCollection()&&y(r)&e.VAR_TYPE.COLLECTION)}function G(e){return e.isAsync()||e.isAsyncData()&&!A(e)}function z(e){return e.isAsyncData()&&!A(e)&&(e=e.toAsyncVar()),e.isAsync()?e.isResolved()?e.getVar():e.resolve().then((function(e){return z(e)})):e}e.ErrorVar=function(t){function n(n,r,i,o){var a=t.call(this)||this;return a.errorType=n,a.desc=r,a.errorCode=i,a.info=o,a.type=e.VAR_TYPE.ERROR,a}return a(n,t),n.prototype.isRuntimeError=function(){return Math.floor(this.errorCode/1e4)%10===U},n.prototype.getMessage=function(){return this.info&&this.info.message},n.prototype.getVar=function(){return this},n.prototype.getValue=function(){return this.desc},n.prototype.toBooleanVar=function(){return e.NULL_VAR},n.prototype.toNumberVar=function(){return e.NULL_VAR},n.prototype.toStringVar=function(){return e.NULL_VAR},n.prototype.equals=function(e){return e.isError()&&this.errorType===e.errorType},n.prototype.clone=function(){return null==this.info?new n(this.errorType,this.desc,this.errorCode):new n(this.errorType,this.desc,this.errorCode,JSON.parse(JSON.stringify(this.info)))},n.prototype.serialize=function(n){var r,i,o,a=t.prototype.serialize.call(this,n),s=((r={})[e.TractorFormulaCacheErrorProps.type]=this.errorType,r[e.TractorFormulaCacheErrorProps.code]=this.errorCode,r);return null!=(null===(i=this.info)||void 0===i?void 0:i.args)&&(s[e.TractorFormulaCacheErrorProps.arguments]=JSON.stringify(null===(o=this.info)||void 0===o?void 0:o.args)),a[e.TractorFormulaCacheProps.error]=s,a},n}(e.PrimitiveVar),e.ErrorCode=void 0,(H=e.ErrorCode||(e.ErrorCode={}))[H.UNKNOWN=1011e4]="UNKNOWN",H[H.NULL=10110010]="NULL",H[H.DIV0=10110020]="DIV0",H[H.DIV0_POSITIVE_OVERFLOW=10110150]="DIV0_POSITIVE_OVERFLOW",H[H.DIVIDE_BY_ZERO_FROM_PARAMETER_BEING_ZERO=10210010]="DIVIDE_BY_ZERO_FROM_PARAMETER_BEING_ZERO",H[H.DIVIDE_BY_ZERO_FROM_FUNCTION_EVAL=10210020]="DIVIDE_BY_ZERO_FROM_FUNCTION_EVAL",H[H.DIV0_NO_VALID_DATA=10210030]="DIV0_NO_VALID_DATA",H[H.DIV0_REQUIRES_POSITIVE_AND_NEGATIVE_VALUES=10210040]="DIV0_REQUIRES_POSITIVE_AND_NEGATIVE_VALUES",H[H.VALUE=10110030]="VALUE",H[H.MISSING_VALUE_BEFORE_OPERATOR=10110160]="MISSING_VALUE_BEFORE_OPERATOR",H[H.MISSING_VALUE_AFTER_OPERATOR=10110161]="MISSING_VALUE_AFTER_OPERATOR",H[H.ARGUMENTS_COUNT_SHOULD_BE_EXACTLY=10210050]="ARGUMENTS_COUNT_SHOULD_BE_EXACTLY",H[H.ARGUMENTS_COUNT_SHOULD_BE_BETWEEN=10210051]="ARGUMENTS_COUNT_SHOULD_BE_BETWEEN",H[H.ARGUMENTS_COUNT_SHOULD_BE_AT_LEAST=10210052]="ARGUMENTS_COUNT_SHOULD_BE_AT_LEAST",H[H.NON_PAIR_ARGUMENTS=10210060]="NON_PAIR_ARGUMENTS",H[H.PARAMETER_WRONG_DATA_TYPE=10210070]="PARAMETER_WRONG_DATA_TYPE",H[H.OUT_OF_RANGE_PARAMETER=10210080]="OUT_OF_RANGE_PARAMETER",H[H.PARAMETER_VALUE_NOT_IN_LIST=10210090]="PARAMETER_VALUE_NOT_IN_LIST",H[H.NO_VALID_DATA=10210100]="NO_VALID_DATA",H[H.TEXT_TOO_LONG=10210110]="TEXT_TOO_LONG",H[H.STRING_SEARCH_FAILED=10210120]="STRING_SEARCH_FAILED",H[H.SHOULD_BE_BETWEEN_INCLUSIVE_PARAMETER=10210130]="SHOULD_BE_BETWEEN_INCLUSIVE_PARAMETER",H[H.PARAMETER_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO=10210140]="PARAMETER_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO",H[H.PARAMETER_SHOULD_BE_GREATER_THAN=10210141]="PARAMETER_SHOULD_BE_GREATER_THAN",H[H.PARAMETER_SHOULD_BE_POSITIVE_OR_ZERO=10210142]="PARAMETER_SHOULD_BE_POSITIVE_OR_ZERO",H[H.COMPLEX_NUMBERS_WITH_DIFFERENT_SUFFIXES=10210150]="COMPLEX_NUMBERS_WITH_DIFFERENT_SUFFIXES",H[H.CANNOT_PARSE_TEXT_TO_NUMBER=10210160]="CANNOT_PARSE_TEXT_TO_NUMBER",H[H.UNABLE_TO_ENCODE_INPUT_TEXT=10210170]="UNABLE_TO_ENCODE_INPUT_TEXT",H[H.VALUE_REQUIRES_POSITIVE_AND_NEGATIVE_VALUES=10210460]="VALUE_REQUIRES_POSITIVE_AND_NEGATIVE_VALUES",H[H.REF=10110040]="REF",H[H.NAME=10110050]="NAME",H[H.UNKNOWN_FUNCTION=10110170]="UNKNOWN_FUNCTION",H[H.NUM=10110060]="NUM",H[H.POSITIVE_OVERFLOW=10110180]="POSITIVE_OVERFLOW",H[H.NUM_SHOULD_BE_BETWEEN_INCLUSIVE_PARAMETER=10210180]="NUM_SHOULD_BE_BETWEEN_INCLUSIVE_PARAMETER",H[H.SHOULD_BE_BETWEEN_EXCLUSIVE=10210190]="SHOULD_BE_BETWEEN_EXCLUSIVE",H[H.NUM_DIVIDE_BY_ZERO_FROM_FUNCTION_EVAL=10210200]="NUM_DIVIDE_BY_ZERO_FROM_FUNCTION_EVAL",H[H.NUM_PARAMETER_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO=10210210]="NUM_PARAMETER_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO",H[H.NUM_PARAMETER_SHOULD_BE_GREATER_THAN=10210211]="NUM_PARAMETER_SHOULD_BE_GREATER_THAN",H[H.PARAMETER_SHOULD_BE_LESS_THAN_OR_EQUAL_TO=10210212]="PARAMETER_SHOULD_BE_LESS_THAN_OR_EQUAL_TO",H[H.PARAMETER_SHOULD_BE_LESS_THAN=10210213]="PARAMETER_SHOULD_BE_LESS_THAN",H[H.PARAMETER_SHOULD_BE_LESS_THAN_OR_EQUAL_TO_OTHER_PARAM=10210220]="PARAMETER_SHOULD_BE_LESS_THAN_OR_EQUAL_TO_OTHER_PARAM",H[H.PARAMETER_SHOULD_BE_LESS_THAN_OTHER_PARAM=10210221]="PARAMETER_SHOULD_BE_LESS_THAN_OTHER_PARAM",H[H.NUM_PARAMETER_VALUE_NOT_IN_LIST=10210230]="NUM_PARAMETER_VALUE_NOT_IN_LIST",H[H.NUM_PARAMETER_SHOULD_BE_POSITIVE_OR_ZERO=10210240]="NUM_PARAMETER_SHOULD_BE_POSITIVE_OR_ZERO",H[H.STRING_TOO_LONG=10210250]="STRING_TOO_LONG",H[H.INVALID_NON_DECIMAL_REPRESENTATION=10210260]="INVALID_NON_DECIMAL_REPRESENTATION",H[H.INSUFFICIENT_PLACES=10210270]="INSUFFICIENT_PLACES",H[H.DIFFERENT_SIGNS=10210280]="DIFFERENT_SIGNS",H[H.INVALID_COMPLEX_NUMBER=10210290]="INVALID_COMPLEX_NUMBER",H[H.NUM_OUT_OF_RANGE_PARAMETER=10210300]="NUM_OUT_OF_RANGE_PARAMETER",H[H.REQUIRES_POSITIVE_AND_NEGATIVE_VALUES=10210310]="REQUIRES_POSITIVE_AND_NEGATIVE_VALUES",H[H.NUM_NO_VALID_DATA=10210320]="NUM_NO_VALID_DATA",H[H.NOT_A_NUMBER=10210330]="NOT_A_NUMBER",H[H.CONDITIONAL_OPTION_DATE_IS_ON_OR_AFTER_INSTRUCTION=10210340]="CONDITIONAL_OPTION_DATE_IS_ON_OR_AFTER_INSTRUCTION",H[H.DATES_CANNOT_PRECEDE_FIRST_DATE=10210350]="DATES_CANNOT_PRECEDE_FIRST_DATE",H[H.ARRAY_SIZES_NOT_EQUAL=10210360]="ARRAY_SIZES_NOT_EQUAL",H[H.INTERNAL_RATE_OF_RETURN_BAD_GUESS=10210370]="INTERNAL_RATE_OF_RETURN_BAD_GUESS",H[H.NUM_PARAMETER_WRONG_DATA_TYPE=10210380]="NUM_PARAMETER_WRONG_DATA_TYPE",H[H.CONDITIONAL_OPTION_DATE_IS_BETWEEN_INSTRUCTION=10210450]="CONDITIONAL_OPTION_DATE_IS_BETWEEN_INSTRUCTION",H[H.SCENARIO_NOT_POSSIBLE=10210470]="SCENARIO_NOT_POSSIBLE",H[H.NA=10110070]="NA",H[H.INVALID_UNIT_CONVERSION=10210390]="INVALID_UNIT_CONVERSION",H[H.ARGUMENT_SIZES_NOT_EQUAL=10210400]="ARGUMENT_SIZES_NOT_EQUAL",H[H.NO_MATCH=10210410]="NO_MATCH",H[H.NA_DIVIDE_BY_ZERO_FROM_PARAMETER_BEING_ZERO=10210420]="NA_DIVIDE_BY_ZERO_FROM_PARAMETER_BEING_ZERO",H[H.NA_NO_VALID_DATA=10210430]="NA_NO_VALID_DATA",H[H.PARAMETER_IS_NOT_AN_ERROR=10210440]="PARAMETER_IS_NOT_AN_ERROR",H[H.PARAMETER_SHOULD_BE_NON_BLANK=10210480]="PARAMETER_SHOULD_BE_NON_BLANK",H[H.GETTING_DATA=10110080]="GETTING_DATA",H[H.CALC=10110140]="CALC",H[H.DEFAULT_RUNTIME_ERROR=1012e4]="DEFAULT_RUNTIME_ERROR",H[H.WAIT_ASYNC=10120010]="WAIT_ASYNC",H[H.SUSPENDED=10120020]="SUSPENDED",H[H.UNMATCHED_MODE=10120030]="UNMATCHED_MODE",H[H.CIRCULAR_DEPENDENCY=10120040]="CIRCULAR_DEPENDENCY",H[H.ABORTED=10120050]="ABORTED",e.UNKNOWN=new e.ErrorVar(e.ErrorType.UNKNOWN,e.ErrorConstant.UNKNOWN,e.ErrorCode.UNKNOWN),e.NULL_ERR_VAR=new e.ErrorVar(e.ErrorType.NULL,e.ErrorConstant.NULL,e.ErrorCode.NULL),e.DIV0_ERR_VAR=new e.ErrorVar(e.ErrorType.DIV0,e.ErrorConstant.DIV0,e.ErrorCode.DIV0),e.VALUE_ERR_VAR=new e.ErrorVar(e.ErrorType.VALUE,e.ErrorConstant.VALUE,e.ErrorCode.VALUE),e.REF_ERR_VAR=new e.ErrorVar(e.ErrorType.REF,e.ErrorConstant.REF,e.ErrorCode.REF),e.NAME_ERR_VAR=new e.ErrorVar(e.ErrorType.NAME,e.ErrorConstant.NAME,e.ErrorCode.NAME),e.NUM_ERR_VAR=new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.NUM),e.NA_ERR_VAR=new e.ErrorVar(e.ErrorType.NA,e.ErrorConstant.NA,e.ErrorCode.NA),e.GETTING_DATA_ERR_VAR=new e.ErrorVar(e.ErrorType.GETTING_DATA,e.ErrorConstant.GETTING_DATA,e.ErrorCode.GETTING_DATA),e.CALC_ERR_VAR=new e.ErrorVar(e.ErrorType.CALC,e.ErrorConstant.CALC,e.ErrorCode.CALC),e.RUNTIME_ERR_VAR=new e.ErrorVar(e.ErrorType.RUNTIME_ERROR,e.ErrorConstant.RUNTIME_ERROR,e.ErrorCode.DEFAULT_RUNTIME_ERROR),e.CIRCULAR_DEPENDENCY_ERR_VAR=new e.ErrorVar(e.ErrorType.CIRCULAR_DEPENDENCY,e.ErrorConstant.CIRCULAR_DEPENDENCY,e.ErrorCode.CIRCULAR_DEPENDENCY),e.SUSPENDED_ERR_VAR=new e.ErrorVar(e.ErrorType.SUSPENDED,e.ErrorConstant.SUSPENDED,e.ErrorCode.SUSPENDED),e.WAIT_ASYNC_ERR_VAR=new e.ErrorVar(e.ErrorType.WAIT_ASYNC,e.ErrorConstant.WAIT_ASYNC,e.ErrorCode.WAIT_ASYNC),e.UNMATCHED_MODE_ERR_VAR=new e.ErrorVar(e.ErrorType.RUNTIME_ERROR,e.ErrorConstant.RUNTIME_ERROR,e.ErrorCode.UNMATCHED_MODE),e.ABORTED_ERR_VAR=new e.ErrorVar(e.ErrorType.RUNTIME_ERROR,e.ErrorConstant.RUNTIME_ERROR,e.ErrorCode.ABORTED),e.ERROR_VAR_MAP=((I={})[e.ErrorConstant.NULL]=e.NULL_ERR_VAR,I[e.ErrorConstant.DIV0]=e.DIV0_ERR_VAR,I[e.ErrorConstant.VALUE]=e.VALUE_ERR_VAR,I[e.ErrorConstant.REF]=e.REF_ERR_VAR,I[e.ErrorConstant.NAME]=e.NAME_ERR_VAR,I[e.ErrorConstant.NUM]=e.NUM_ERR_VAR,I[e.ErrorConstant.NA]=e.NA_ERR_VAR,I[e.ErrorConstant.GETTING_DATA]=e.GETTING_DATA_ERR_VAR,I[e.ErrorConstant.CALC]=e.CALC_ERR_VAR,I),e.tractorErrorVarCreators=((x={})[e.ErrorCode.DEFAULT_RUNTIME_ERROR]=function(t){return new e.ErrorVar(e.ErrorType.RUNTIME_ERROR,e.ErrorConstant.RUNTIME_ERROR,e.ErrorCode.DEFAULT_RUNTIME_ERROR,{message:t})},x[e.ErrorCode.UNKNOWN]=function(t){return new e.ErrorVar(e.ErrorType.UNKNOWN,e.ErrorConstant.UNKNOWN,e.ErrorCode.UNKNOWN,{message:t})},x[e.ErrorCode.NAME]=function(t){return new e.ErrorVar(e.ErrorType.NAME,e.ErrorConstant.NAME,e.ErrorCode.NAME,{message:t})},x[e.ErrorCode.NULL]=function(t){return new e.ErrorVar(e.ErrorType.NULL,e.ErrorConstant.NULL,e.ErrorCode.NULL,{message:t})},x[e.ErrorCode.DIV0]=function(t){return new e.ErrorVar(e.ErrorType.DIV0,e.ErrorConstant.DIV0,e.ErrorCode.DIV0,{message:t})},x[e.ErrorCode.VALUE]=function(t){return new e.ErrorVar(e.ErrorType.VALUE,e.ErrorConstant.VALUE,e.ErrorCode.VALUE,{message:t})},x[e.ErrorCode.REF]=function(t){return new e.ErrorVar(e.ErrorType.REF,e.ErrorConstant.REF,e.ErrorCode.REF,{message:t})},x[e.ErrorCode.NUM]=function(t){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.NUM,{message:t})},x[e.ErrorCode.NA]=function(t){return new e.ErrorVar(e.ErrorType.NA,e.ErrorConstant.NA,e.ErrorCode.NA,{message:t})},x[e.ErrorCode.GETTING_DATA]=function(t){return new e.ErrorVar(e.ErrorType.GETTING_DATA,e.ErrorConstant.GETTING_DATA,e.ErrorCode.GETTING_DATA,{message:t})},x[e.ErrorCode.CALC]=function(t){return new e.ErrorVar(e.ErrorType.CALC,e.ErrorConstant.CALC,e.ErrorCode.CALC,{message:t})},x[e.ErrorCode.CIRCULAR_DEPENDENCY]=function(t){return new e.ErrorVar(e.ErrorType.CIRCULAR_DEPENDENCY,e.ErrorConstant.CIRCULAR_DEPENDENCY,e.ErrorCode.CIRCULAR_DEPENDENCY,{message:t})},x[e.ErrorCode.SUSPENDED]=function(t){return new e.ErrorVar(e.ErrorType.SUSPENDED,e.ErrorConstant.SUSPENDED,e.ErrorCode.SUSPENDED,{message:t})},x[e.ErrorCode.WAIT_ASYNC]=function(t){return new e.ErrorVar(e.ErrorType.WAIT_ASYNC,e.ErrorConstant.WAIT_ASYNC,e.ErrorCode.WAIT_ASYNC,{message:t})},x[e.ErrorCode.UNMATCHED_MODE]=function(t){return new e.ErrorVar(e.ErrorType.RUNTIME_ERROR,e.ErrorConstant.RUNTIME_ERROR,e.ErrorCode.UNMATCHED_MODE,{message:t})},x[e.ErrorCode.ABORTED]=function(t){return new e.ErrorVar(e.ErrorType.RUNTIME_ERROR,e.ErrorConstant.RUNTIME_ERROR,e.ErrorCode.ABORTED,{message:t})},x[e.ErrorCode.ARGUMENTS_COUNT_SHOULD_BE_EXACTLY]=function(t,n){return new e.ErrorVar(e.ErrorType.VALUE,e.ErrorConstant.VALUE,e.ErrorCode.ARGUMENTS_COUNT_SHOULD_BE_EXACTLY,{message:n,args:t})},x[e.ErrorCode.ARGUMENTS_COUNT_SHOULD_BE_BETWEEN]=function(t,n){return new e.ErrorVar(e.ErrorType.VALUE,e.ErrorConstant.VALUE,e.ErrorCode.ARGUMENTS_COUNT_SHOULD_BE_BETWEEN,{message:n,args:t})},x[e.ErrorCode.ARGUMENTS_COUNT_SHOULD_BE_AT_LEAST]=function(t,n){return new e.ErrorVar(e.ErrorType.VALUE,e.ErrorConstant.VALUE,e.ErrorCode.ARGUMENTS_COUNT_SHOULD_BE_AT_LEAST,{message:n,args:t})},x[e.ErrorCode.NON_PAIR_ARGUMENTS]=function(t,n){return new e.ErrorVar(e.ErrorType.VALUE,e.ErrorConstant.VALUE,e.ErrorCode.NON_PAIR_ARGUMENTS,{message:n,args:t})},x[e.ErrorCode.PARAMETER_WRONG_DATA_TYPE]=function(t,n){return new e.ErrorVar(e.ErrorType.VALUE,e.ErrorConstant.VALUE,e.ErrorCode.PARAMETER_WRONG_DATA_TYPE,{message:n,args:t})},x[e.ErrorCode.OUT_OF_RANGE_PARAMETER]=function(t,n){return new e.ErrorVar(e.ErrorType.VALUE,e.ErrorConstant.VALUE,e.ErrorCode.OUT_OF_RANGE_PARAMETER,{message:n,args:t})},x[e.ErrorCode.PARAMETER_VALUE_NOT_IN_LIST]=function(t,n){return new e.ErrorVar(e.ErrorType.VALUE,e.ErrorConstant.VALUE,e.ErrorCode.PARAMETER_VALUE_NOT_IN_LIST,{message:n,args:t})},x[e.ErrorCode.NO_VALID_DATA]=function(t,n){return new e.ErrorVar(e.ErrorType.VALUE,e.ErrorConstant.VALUE,e.ErrorCode.NO_VALID_DATA,{message:n,args:t})},x[e.ErrorCode.MISSING_VALUE_BEFORE_OPERATOR]=function(t,n){return new e.ErrorVar(e.ErrorType.VALUE,e.ErrorConstant.VALUE,e.ErrorCode.MISSING_VALUE_BEFORE_OPERATOR,{message:n,args:t})},x[e.ErrorCode.MISSING_VALUE_AFTER_OPERATOR]=function(t,n){return new e.ErrorVar(e.ErrorType.VALUE,e.ErrorConstant.VALUE,e.ErrorCode.MISSING_VALUE_AFTER_OPERATOR,{message:n,args:t})},x[e.ErrorCode.TEXT_TOO_LONG]=function(t,n){return new e.ErrorVar(e.ErrorType.VALUE,e.ErrorConstant.VALUE,e.ErrorCode.TEXT_TOO_LONG,{message:n,args:t})},x[e.ErrorCode.STRING_SEARCH_FAILED]=function(t,n){return new e.ErrorVar(e.ErrorType.VALUE,e.ErrorConstant.VALUE,e.ErrorCode.STRING_SEARCH_FAILED,{message:n,args:t})},x[e.ErrorCode.SHOULD_BE_BETWEEN_INCLUSIVE_PARAMETER]=function(t,n){return new e.ErrorVar(e.ErrorType.VALUE,e.ErrorConstant.VALUE,e.ErrorCode.SHOULD_BE_BETWEEN_INCLUSIVE_PARAMETER,{message:n,args:t})},x[e.ErrorCode.PARAMETER_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO]=function(t,n){return new e.ErrorVar(e.ErrorType.VALUE,e.ErrorConstant.VALUE,e.ErrorCode.PARAMETER_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO,{message:n,args:t})},x[e.ErrorCode.PARAMETER_SHOULD_BE_NON_BLANK]=function(t,n){return new e.ErrorVar(e.ErrorType.VALUE,e.ErrorConstant.VALUE,e.ErrorCode.PARAMETER_SHOULD_BE_NON_BLANK,{message:n,args:t})},x[e.ErrorCode.PARAMETER_SHOULD_BE_GREATER_THAN]=function(t,n){return new e.ErrorVar(e.ErrorType.VALUE,e.ErrorConstant.VALUE,e.ErrorCode.PARAMETER_SHOULD_BE_GREATER_THAN,{message:n,args:t})},x[e.ErrorCode.PARAMETER_SHOULD_BE_POSITIVE_OR_ZERO]=function(t,n){return new e.ErrorVar(e.ErrorType.VALUE,e.ErrorConstant.VALUE,e.ErrorCode.PARAMETER_SHOULD_BE_POSITIVE_OR_ZERO,{message:n,args:t})},x[e.ErrorCode.COMPLEX_NUMBERS_WITH_DIFFERENT_SUFFIXES]=function(t){return new e.ErrorVar(e.ErrorType.VALUE,e.ErrorConstant.VALUE,e.ErrorCode.COMPLEX_NUMBERS_WITH_DIFFERENT_SUFFIXES,{message:t})},x[e.ErrorCode.CANNOT_PARSE_TEXT_TO_NUMBER]=function(t,n){return new e.ErrorVar(e.ErrorType.VALUE,e.ErrorConstant.VALUE,e.ErrorCode.CANNOT_PARSE_TEXT_TO_NUMBER,{message:n,args:t})},x[e.ErrorCode.UNABLE_TO_ENCODE_INPUT_TEXT]=function(t){return new e.ErrorVar(e.ErrorType.VALUE,e.ErrorConstant.VALUE,e.ErrorCode.UNABLE_TO_ENCODE_INPUT_TEXT,{message:t})},x[e.ErrorCode.VALUE_REQUIRES_POSITIVE_AND_NEGATIVE_VALUES]=function(t,n){return new e.ErrorVar(e.ErrorType.VALUE,e.ErrorConstant.VALUE,e.ErrorCode.VALUE_REQUIRES_POSITIVE_AND_NEGATIVE_VALUES,{message:n,args:t})},x[e.ErrorCode.DIVIDE_BY_ZERO_FROM_PARAMETER_BEING_ZERO]=function(t,n){return new e.ErrorVar(e.ErrorType.DIV0,e.ErrorConstant.DIV0,e.ErrorCode.DIVIDE_BY_ZERO_FROM_PARAMETER_BEING_ZERO,{message:n,args:t})},x[e.ErrorCode.DIV0_POSITIVE_OVERFLOW]=function(t,n){return new e.ErrorVar(e.ErrorType.DIV0,e.ErrorConstant.DIV0,e.ErrorCode.DIV0_POSITIVE_OVERFLOW,{message:n,args:t})},x[e.ErrorCode.DIVIDE_BY_ZERO_FROM_FUNCTION_EVAL]=function(t,n){return new e.ErrorVar(e.ErrorType.DIV0,e.ErrorConstant.DIV0,e.ErrorCode.DIVIDE_BY_ZERO_FROM_FUNCTION_EVAL,{message:n,args:t})},x[e.ErrorCode.DIV0_NO_VALID_DATA]=function(t,n){return new e.ErrorVar(e.ErrorType.DIV0,e.ErrorConstant.DIV0,e.ErrorCode.DIV0_NO_VALID_DATA,{message:n,args:t})},x[e.ErrorCode.DIV0_REQUIRES_POSITIVE_AND_NEGATIVE_VALUES]=function(t,n){return new e.ErrorVar(e.ErrorType.DIV0,e.ErrorConstant.DIV0,e.ErrorCode.DIV0_REQUIRES_POSITIVE_AND_NEGATIVE_VALUES,{message:n,args:t})},x[e.ErrorCode.UNKNOWN_FUNCTION]=function(t,n){return new e.ErrorVar(e.ErrorType.NAME,e.ErrorConstant.NAME,e.ErrorCode.UNKNOWN_FUNCTION,{message:n,args:t})},x[e.ErrorCode.POSITIVE_OVERFLOW]=function(t,n){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.POSITIVE_OVERFLOW,{message:n,args:t})},x[e.ErrorCode.NUM_SHOULD_BE_BETWEEN_INCLUSIVE_PARAMETER]=function(t,n){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.NUM_SHOULD_BE_BETWEEN_INCLUSIVE_PARAMETER,{message:n,args:t})},x[e.ErrorCode.SHOULD_BE_BETWEEN_EXCLUSIVE]=function(t,n){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.SHOULD_BE_BETWEEN_EXCLUSIVE,{message:n,args:t})},x[e.ErrorCode.NUM_DIVIDE_BY_ZERO_FROM_FUNCTION_EVAL]=function(t,n){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.NUM_DIVIDE_BY_ZERO_FROM_FUNCTION_EVAL,{message:n,args:t})},x[e.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO]=function(t,n){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO,{message:n,args:t})},x[e.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN]=function(t,n){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.NUM_PARAMETER_SHOULD_BE_GREATER_THAN,{message:n,args:t})},x[e.ErrorCode.PARAMETER_SHOULD_BE_LESS_THAN_OR_EQUAL_TO]=function(t,n){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.PARAMETER_SHOULD_BE_LESS_THAN_OR_EQUAL_TO,{message:n,args:t})},x[e.ErrorCode.PARAMETER_SHOULD_BE_LESS_THAN]=function(t,n){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.PARAMETER_SHOULD_BE_LESS_THAN,{message:n,args:t})},x[e.ErrorCode.PARAMETER_SHOULD_BE_LESS_THAN_OR_EQUAL_TO_OTHER_PARAM]=function(t,n){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.PARAMETER_SHOULD_BE_LESS_THAN_OR_EQUAL_TO_OTHER_PARAM,{message:n,args:t})},x[e.ErrorCode.PARAMETER_SHOULD_BE_LESS_THAN_OTHER_PARAM]=function(t,n){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.PARAMETER_SHOULD_BE_LESS_THAN_OTHER_PARAM,{message:n,args:t})},x[e.ErrorCode.STRING_TOO_LONG]=function(t,n){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.STRING_TOO_LONG,{message:n,args:t})},x[e.ErrorCode.INVALID_NON_DECIMAL_REPRESENTATION]=function(t,n){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.INVALID_NON_DECIMAL_REPRESENTATION,{message:n,args:t})},x[e.ErrorCode.INSUFFICIENT_PLACES]=function(t,n){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.INSUFFICIENT_PLACES,{message:n,args:t})},x[e.ErrorCode.DIFFERENT_SIGNS]=function(t,n){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.DIFFERENT_SIGNS,{message:n,args:t})},x[e.ErrorCode.NUM_PARAMETER_VALUE_NOT_IN_LIST]=function(t,n){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.NUM_PARAMETER_VALUE_NOT_IN_LIST,{message:n,args:t})},x[e.ErrorCode.NUM_PARAMETER_SHOULD_BE_POSITIVE_OR_ZERO]=function(t,n){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.NUM_PARAMETER_SHOULD_BE_POSITIVE_OR_ZERO,{message:n,args:t})},x[e.ErrorCode.INVALID_COMPLEX_NUMBER]=function(t){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.INVALID_COMPLEX_NUMBER,{message:t})},x[e.ErrorCode.NUM_OUT_OF_RANGE_PARAMETER]=function(t,n){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.NUM_OUT_OF_RANGE_PARAMETER,{message:n,args:t})},x[e.ErrorCode.NUM_NO_VALID_DATA]=function(t,n){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.NUM_NO_VALID_DATA,{message:n,args:t})},x[e.ErrorCode.REQUIRES_POSITIVE_AND_NEGATIVE_VALUES]=function(t,n){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.REQUIRES_POSITIVE_AND_NEGATIVE_VALUES,{message:n,args:t})},x[e.ErrorCode.NOT_A_NUMBER]=function(t){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.NOT_A_NUMBER,{message:t})},x[e.ErrorCode.CONDITIONAL_OPTION_DATE_IS_ON_OR_AFTER_INSTRUCTION]=function(t,n){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.CONDITIONAL_OPTION_DATE_IS_ON_OR_AFTER_INSTRUCTION,{message:n,args:t})},x[e.ErrorCode.DATES_CANNOT_PRECEDE_FIRST_DATE]=function(t,n){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.DATES_CANNOT_PRECEDE_FIRST_DATE,{message:n,args:t})},x[e.ErrorCode.ARRAY_SIZES_NOT_EQUAL]=function(t,n){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.ARRAY_SIZES_NOT_EQUAL,{message:n,args:t})},x[e.ErrorCode.INTERNAL_RATE_OF_RETURN_BAD_GUESS]=function(t,n){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.INTERNAL_RATE_OF_RETURN_BAD_GUESS,{message:n,args:t})},x[e.ErrorCode.NUM_PARAMETER_WRONG_DATA_TYPE]=function(t,n){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.NUM_PARAMETER_WRONG_DATA_TYPE,{message:n,args:t})},x[e.ErrorCode.CONDITIONAL_OPTION_DATE_IS_BETWEEN_INSTRUCTION]=function(t,n){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.CONDITIONAL_OPTION_DATE_IS_BETWEEN_INSTRUCTION,{message:n,args:t})},x[e.ErrorCode.SCENARIO_NOT_POSSIBLE]=function(t,n){return new e.ErrorVar(e.ErrorType.NUM,e.ErrorConstant.NUM,e.ErrorCode.SCENARIO_NOT_POSSIBLE,{message:n,args:t})},x[e.ErrorCode.INVALID_UNIT_CONVERSION]=function(t){return new e.ErrorVar(e.ErrorType.NA,e.ErrorConstant.NA,e.ErrorCode.INVALID_UNIT_CONVERSION,{message:t})},x[e.ErrorCode.ARGUMENT_SIZES_NOT_EQUAL]=function(t,n){return new e.ErrorVar(e.ErrorType.NA,e.ErrorConstant.NA,e.ErrorCode.ARGUMENT_SIZES_NOT_EQUAL,{message:n,args:t})},x[e.ErrorCode.NO_MATCH]=function(t){return new e.ErrorVar(e.ErrorType.NA,e.ErrorConstant.NA,e.ErrorCode.NO_MATCH,{message:t})},x[e.ErrorCode.NA_DIVIDE_BY_ZERO_FROM_PARAMETER_BEING_ZERO]=function(t,n){return new e.ErrorVar(e.ErrorType.NA,e.ErrorConstant.NA,e.ErrorCode.NA_DIVIDE_BY_ZERO_FROM_PARAMETER_BEING_ZERO,{message:n,args:t})},x[e.ErrorCode.NA_NO_VALID_DATA]=function(t,n){return new e.ErrorVar(e.ErrorType.NA,e.ErrorConstant.NA,e.ErrorCode.NA_NO_VALID_DATA,{message:n,args:t})},x[e.ErrorCode.PARAMETER_IS_NOT_AN_ERROR]=function(t,n){return new e.ErrorVar(e.ErrorType.NA,e.ErrorConstant.NA,e.ErrorCode.PARAMETER_IS_NOT_AN_ERROR,{message:n,args:t})},x),e.FormulaErrorPhrases=void 0,(V=e.FormulaErrorPhrases||(e.FormulaErrorPhrases={})).PARAMETER_NAME="PARAMETER_NAME",V.DIMENSION_ROW="DIMENSION_ROW",V.DIMENSION_COLUMN="DIMENSION_COLUMN",V.DATA_TYPE_BOOLEAN="DATA_TYPE_BOOLEAN",V.DATA_TYPE_DOUBLE="DATA_TYPE_DOUBLE",V.DATA_TYPE_STRING="DATA_TYPE_STRING",V.DATA_TYPE_ERROR="DATA_TYPE_ERROR",V.DATA_TYPE_EMPTY="DATA_TYPE_EMPTY",V.PARAMETER="PARAMETER",V.INVALIDITY="INVALIDITY",V.RANGE="RANGE",V.DATA_TYPE_REFERENCE="DATA_TYPE_REFERENCE",V.DATA_TYPE_MATRIX="DATA_TYPE_MATRIX",V.FUNCTION="FUNCTION",V.BINARY="BINARY",V.OCTAL="OCTAL",V.DECIMAL="DECIMAL",V.HEXADECIMAL="HEXADECIMAL";var Y,X,K=[{typeCheck:"isCustomPrimitive",getPointFn:$},{typeCheck:"isCustomCollection",getPointFn:J},{typeCheck:"isPrimitive",getPointFn:Q},{typeCheck:"isCollection",getPointFn:ee}];function q(e,t){var n=t.ops;if(0===n.length)return null;if(1===n.length)return n[0];for(var r={point:-1,op:null},i=t.args.map((function(t,n){return t.isOp()?e.service.op.resolveOperatorArgument(e,t,n):t})),o=function(e){for(var t=n[e],o=0,a=!1,s=function(e){var n=i[e],r=t.operandDesc(e);K.some((function(e){var t,i=e.typeCheck,s=e.getPointFn;if(null===(t=n[i])||void 0===t?void 0:t.call(n)){var u=s(n,r);return-1===u?(a=!0,!0):(o+=u,!0)}return!1}))},u=0;u<i.length;u++)s(u);!a&&o>r.point&&(r={op:t,point:o})},a=0;a<n.length;a++)o(a);return r.op}function $(t,n){return W(t,n)?1e4:j(t,n)?1e3:0==(y(n.type)&(e.VAR_TYPE.CUSTOM_COLLECTION|e.VAR_TYPE.CUSTOM_PRIMITIVE))?1:-1}function J(e,t){return W(e,t)?1e4:j(e,t)?1e3:-1}function Q(t,n){return W(t,n)?100:j(t,n)?10:y(n.type)&(e.VAR_TYPE.CUSTOM_PRIMITIVE|e.VAR_TYPE.CUSTOM_COLLECTION)?-1:1}function ee(t,n){return W(t,n)?100:y(n.type)&(e.VAR_TYPE.CUSTOM_PRIMITIVE|e.VAR_TYPE.CUSTOM_COLLECTION)?-1:1}function te(e){if(e.isAsync()){if(!e.isResolved())throw e;e=e.getVar()}if(e.isError()&&e.isRuntimeError())throw e;return e}function ne(t,n,r){if(void 0===r&&(r=new Set),null==t)return e.NULL_VAR;switch(typeof t){case"number":return Number.isFinite(t)?new e.NumberVar(t.valueOf()):e.VALUE_ERR_VAR;case"string":return new e.StringVar(t.valueOf());case"boolean":return new e.BooleanVar(t.valueOf());case"object":if(Array.isArray(t)){if(r.has(t))return e.tractorErrorVarCreators[e.ErrorCode.DEFAULT_RUNTIME_ERROR]("Converting circular structure to native value.");r.add(t);for(var i=[],o=[],a=function(e){var r=ne(t[e],n);r.isAsync()?o.push(r.resolve().then((function(t){i[e]=t}))):i[e]=r},s=0;s<t.length;s++)a(s);return o.length>0?n?new e.AsyncVar(Promise.all(o).then((function(){return new e.ArrayVar(i)}))):e.tractorErrorVarCreators[e.ErrorCode.DEFAULT_RUNTIME_ERROR]("Cannot create asyncVar without context."):new e.ArrayVar(i)}if(t instanceof Error)return ie(t.message);if(t instanceof e.BaseVar)return t;if(t instanceof e.Collection)return new e.CustomCollectionVar(t);if(t instanceof e.Primitive)return new e.CustomPrimitiveVar(t);if(t instanceof Promise)return n?new e.AsyncVar(t.then((function(e){return ne(e,n,r)})).catch((function(t){var n;return e.tractorErrorVarCreators[e.ErrorCode.DEFAULT_RUNTIME_ERROR](null!==(n=null==t?void 0:t.message)&&void 0!==n?n:"Unknown error.")}))):e.tractorErrorVarCreators[e.ErrorCode.DEFAULT_RUNTIME_ERROR]("Cannot create asyncVar without context.");default:return e.tractorErrorVarCreators[e.ErrorCode.DEFAULT_RUNTIME_ERROR]("Unknown value type ".concat(Object.prototype.toString.call(t)," when boxing value."))}}function re(e,t,n){if(void 0===n&&(n=new Set),e.isError())return new Error(e.getValue());if(e.isAsync())return re(e.getVar(),t,n);if(e.isPrimitive())return e.getValue(t);if(e.isCollection()){if(n.has(e))throw new Error("Converting circular structure to native value");n.add(e);for(var r=e.size(),i=[],o=0;o<r;o++)i.push(re(e.nth(o,t),t,n));return n.delete(e),i}return new Error("Expected PrimitiveVar or CollectionVar, but got ".concat(e,"."))}function ie(t){var n;return null!==(n=e.ERROR_VAR_MAP[t])&&void 0!==n?n:e.tractorErrorVarCreators[e.ErrorCode.DEFAULT_RUNTIME_ERROR](t)}function oe(e){var t=[],n=e.getRoot();t.push(n);for(var r=new Set;t.length;){var i=t.shift();if(i.isOp()){for(var o=i.op().alwaysCalc,a=i.getArgs(),s=0;s<a.length;++s)t.push(a[s]);o&&r.add(i)}}return r.size>0?{isAlwaysCalc:!0,alwaysCalcOps:r}:{isAlwaysCalc:!1}}function ae(t,r,i){var o=r.index,a=r.parameter,s=r.op,u=i(t,r),l=u.isError,c=u.convertedArgument;if(l)return n.Task.sync(u);if(G(c))return n.Task.from(z(c)).next((function(e){return ae(t,{argument:e,index:o,parameter:a,op:s},i)}));if(!(Z(c,a)||c.type&e.VAR_TYPE.UNPREDICTABLE&&t.executeMode===e.ExecuteMode.PREDICT))throw new Error("The type of argument after transformation is not compatible with parameter type");return n.Task.sync(u)}function se(e,t,n){var r=[e];n&&r.push(n);for(var i=0;i<t.length;i++)r.push(t[i]);return r}function ue(e,t,n){var r;return null!==(r=n.isMappable)&&void 0!==r&&!r&&!!t.isCollection()&&!_(t,n.type)}function le(e,t,n){return e.service.arg.isArgMappable(e,t,n)}function ce(e,t){return e.service.arg.transformVariant(e,t)}function he(t,n){var r=n.argument,i=n.parameter;if(Z(r,i)||r.type&e.VAR_TYPE.UNPREDICTABLE&&t.executeMode===e.ExecuteMode.PREDICT)return{isError:!1,convertedArgument:r,srcArg:r};if(r.isError())return{isError:!0,convertedArgument:r,srcArg:r};if(r.isPrimitive()&&i.type===e.VAR_TYPE.COLLECTION)return{isError:!1,convertedArgument:new e.ArrayVar([r]),srcArg:r};if(r.isPrimitive()){var o=de(t.service,r,i.type);if(null!=o)return{isError:!1,convertedArgument:o,srcArg:r}}return{isError:!0,convertedArgument:e.VALUE_ERR_VAR,srcArg:r}}function de(t,n,r){var i=e.NULL_VAR;return(r=y(r))&e.VAR_TYPE.NUMBER&&(i=n.toNumberVar(t)),i.isNull()&&r&e.VAR_TYPE.STRING&&(i=n.toStringVar(t)),i.isNull()&&r&e.VAR_TYPE.BOOL&&(i=n.toBooleanVar(t)),i.isNull()?null:i}e.AsyncVar=function(t){function n(n){var r=t.call(this)||this;return r.type=e.VAR_TYPE.ASYNC,r.data={resolved:!0,value:e.WAIT_ASYNC_ERR_VAR,promise:Promise.resolve(e.WAIT_ASYNC_ERR_VAR)},n instanceof Promise?r.fromPromise(n):n.isAsync()?r.data=n.data:n.isAsyncData()&&!A(n)?r.fromPromise(O(n).then((function(){return n}))):r.data={resolved:!0,value:n,promise:Promise.resolve(n)},r}return a(n,t),n.prototype.resolve=function(){return this.data.promise},n.prototype.isResolved=function(){return this.data.resolved},n.prototype.getValue=function(e){return this.getVar().getValue(e)},n.prototype.clone=function(){return new n(this)},n.prototype.getVar=function(){if(this.data.resolved)return this.data.value;var t=e.WAIT_ASYNC_ERR_VAR.clone();return t.setSpecialInfo({promise:this.data.promise}),t},n.prototype.toAsyncVar=function(){return this},n.prototype.map=function(e){return this.data.resolved?new n(e(this.data.value)):new n(this.resolve().then((function(t){return e(t)})))},n.prototype.fromPromise=function(e){var t=this;this.data.resolved=!1,this.data.promise=e.then((function(e){return z(e)})).then((function(e){return Object.assign(t.data,{resolved:!0,value:e}),e}))},n.prototype.serialize=function(e){return null},n}(e.BaseVar),e.BaseCustomPrimitiveVar=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.VAR_TYPE.CUSTOM_PRIMITIVE,n}return a(n,t),n.prototype.isCustomPrimitive=function(){return!0},n.prototype.serialize=function(){var n=t.prototype.serialize.call(this);return n[e.TractorFormulaCacheProps.customType]=this.customType,n[e.TractorFormulaCacheProps.value]=this.serializeValue(),n},n.prototype.equals=function(e){return!!e.isCustomPrimitive()&&this.customType===e.customType&&this.getValue()===e.getValue()},n.prototype.variantEquals=function(e){return!!t.prototype.variantEquals.call(this,e)&&this.customType===e.customType&&this.strictEquals(e)},n.prototype.lessThan=function(e){return!1},n.prototype.greaterThan=function(e){return!1},n}(e.PrimitiveVar),e.CustomPrimitiveVar=function(t){function n(n){var r=t.call(this)||this;return r.primitive=n,r.type=e.VAR_TYPE.CUSTOM_PRIMITIVE,r}var r;return a(n,t),r=n,Object.defineProperty(n.prototype,"customType",{get:function(){return this.primitive.customType},enumerable:!1,configurable:!0}),n.prototype.toNumberVar=function(){var t=this.primitive.toNumberValue();return null==t?e.NULL_VAR:new e.NumberVar(t)},n.prototype.toStringVar=function(){var t=this.primitive.toStringValue();return null==t?e.NULL_VAR:new e.StringVar(t)},n.prototype.toBooleanVar=function(){var t=this.primitive.toBooleanValue();return null==t?e.NULL_VAR:new e.BooleanVar(t)},n.prototype.getAtom=function(){return this.primitive},n.prototype.getValue=function(){return this.primitive.getValue()},n.prototype.isRef=function(){return this.primitive.isRef()},n.prototype.isAsyncData=function(){return this.primitive.isAsync()},n.prototype.isCustomPrimitive=function(){return!0},n.prototype.clone=function(){return new r(this.primitive)},n.prototype.serializeValue=function(){return null},n=r=d([M,f("design:paramtypes",[Function])],n)}(e.BaseCustomPrimitiveVar),e.CollectionVar=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.VAR_TYPE.COLLECTION,n}return a(n,t),n.prototype.isCollection=function(){return!0},n.prototype.iter=function(t){return new e.CollectionVarIter(this,t).do((function(e){return te(e)}))},n.prototype.serialize=function(e){return null},n}(e.BaseVar),e.ArrayVar=function(t){function n(e){var n=t.call(this)||this;return n.value=e,n}return a(n,t),n.prototype.getValue=function(e){return this.nth(0).getValue(e)},n.prototype.nth=function(t){return t<0||t>=this.size()?e.VALUE_ERR_VAR:this.value[t]},n.prototype.size=function(){return this.value.length},n.prototype.clone=function(){return new n(this.value)},n.prototype.strictEquals=function(e){if(this.value.length!==e.value.length)return!1;for(var t=0;t<this.value.length;t++)if(!this.value[t].variantEquals(e.value[t]))return!1;return!0},n}(e.CollectionVar),e.TType=function(){function e(){}return e.prototype.isAsync=function(){return!1},e.prototype.isRef=function(){return!1},e}(),e.Primitive=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t}(e.TType),e.Collection=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t}(e.TType),e.BaseCustomCollectionVar=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.VAR_TYPE.CUSTOM_COLLECTION,n}return a(n,t),n.prototype.isCustomCollection=function(){return!0},n.prototype.variantEquals=function(e){return!!t.prototype.variantEquals.call(this,e)&&this.customType===e.customType&&this.strictEquals(e)},n}(e.CollectionVar),e.CustomCollectionVar=function(t){function n(n){var r=t.call(this)||this;return r.collection=n,r.type=e.VAR_TYPE.CUSTOM_COLLECTION,r}var r;return a(n,t),r=n,Object.defineProperty(n.prototype,"customType",{get:function(){return this.collection.customType},enumerable:!1,configurable:!0}),n.prototype.getAtom=function(){return this.collection},n.prototype.getValue=function(){return this.collection},n.prototype.nth=function(t,n){if(t>=this.size())return e.VALUE_ERR_VAR;var r=ne(this.collection.nth(t,n));if(!r.isAsync())return r;if(r.isResolved())return r.getVar();throw r},n.prototype.size=function(){return this.collection.size()},n.prototype.isRef=function(){return this.collection.isRef()},n.prototype.isAsyncData=function(){return this.collection.isAsync()},n.prototype.isCustomCollection=function(){return!0},n.prototype.clone=function(){return new r(this.collection)},n=r=d([M,f("design:paramtypes",[Object])],n)}(e.BaseCustomCollectionVar),e.BaseFormulaState=function(){function e(e){this.formulaVar=e,this._calcId=null,this._cache=null}return Object.defineProperty(e.prototype,"cache",{get:function(){return this._cache},set:function(e){this._cache=e,null!=this.formulaVar&&(null==e?this.formulaVar.formulaSpace.addDirtyFormula(this.formulaVar):this.formulaVar.formulaSpace.deleteDirtyFormula(this.formulaVar))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"calcId",{get:function(){return this._calcId},set:function(e){this._calcId=e},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this.formulaVar=null},e}(),e.FormulaStack=function(){function e(){this.maxStackSize=64,this.level=0,this.calcId=0}return e.prototype.setMaxStackSize=function(e){this.maxStackSize=e},e.prototype.getMaxStackSize=function(){return this.maxStackSize},e.prototype.enterFormula=function(e,t){var n,r;if(this.level>=1&&null==(null==t?void 0:t.calcId))throw new Error("calcId not found in context");this.level++;var i={ref:null!==(n=null==t?void 0:t.customRef)&&void 0!==n?n:e.getRef(),calcId:null!==(r=null==t?void 0:t.calcId)&&void 0!==r?r:++this.calcId,info:{},formula:e,service:e.getFormulaService()};return null!=(null==t?void 0:t.customCtx)&&(i.customCtx=t.customCtx),null!=(null==t?void 0:t.formulaChainPerformance)&&(i.formulaChainPerformance=t.formulaChainPerformance),null!=(null==t?void 0:t.executeMode)&&(i.executeMode=t.executeMode),i},e.prototype.exitFormula=function(e){if(this.level>=1&&null==e.calcId)throw new Error("calcId not found in context");this.level--},e.prototype.getLevel=function(){return this.level},e}(),e.FormulaSpaceEvents=void 0,(X=e.FormulaSpaceEvents||(e.FormulaSpaceEvents={})).onBatchFormulasDirty="onBatchFormulasDirty",X.onDirtyFormulaAdded="onDirtyFormulaAdded",X.onDirtyFormulaRemoved="onDirtyFormulaRemoved",X.onFormulaUnregistered="onFormulaUnregistered",X.onFormulaRegistered="onFormulaRegistered",e.FormulaSpace=function(t){function n(e){var n=t.call(this)||this;return n.formulas=new Set,n.dirtyFormulas=new Set,n.dirtyNotifyTrigger=null,n.alwaysCalcFormulas=new Map,n.handleMarkDirtyCompleted=function(e){var t;(null===(t=null==e?void 0:e.isDirtyAlwaysCalc)||void 0===t||t)&&n.dirtyAlwaysCalc(e),n.formulaService.getFuncCacheManager().clear()},n.formulaService=e,n.reactivitySpace=e.reactivitySpace,n.initial(),n}return a(n,t),n.prototype.getAlwaysCalcFormulas=function(){return this.alwaysCalcFormulas},n.prototype.initial=function(){this.reactivitySpace.addListener(i.ReactivityEvent.onMarkDirtyCompleted,this.handleMarkDirtyCompleted)},n.prototype.dispose=function(){this.reactivitySpace.removeListener(i.ReactivityEvent.onMarkDirtyCompleted,this.handleMarkDirtyCompleted)},n.prototype.addAlwaysCalcFmls=function(e){var t=e.getAlwaysCalcInfo();if(null==t&&(t=oe(e),e.setAlwaysCalcInfo(t)),t.isAlwaysCalc){var n=t.alwaysCalcOps;this.alwaysCalcFormulas.set(e,n)}},n.prototype.registerFml=function(t,n){var r=t.getRef();this.formulas.add(t),this.reactivitySpace.registerReactivity(t,n),t.isDirty(r)&&this.addDirtyFormula(t),this.addAlwaysCalcFmls(t),this.emit(e.FormulaSpaceEvents.onFormulaRegistered,t)},n.prototype.unRegisterFml=function(t){this.formulas.delete(t),this.reactivitySpace.unregisterReactivity(t),this.deleteDirtyFormula(t),this.alwaysCalcFormulas.delete(t),this.formulaService.removeValueChangedFormula(t),this.emit(e.FormulaSpaceEvents.onFormulaUnregistered,t)},n.prototype.dirtyAllFormulas=function(e){this.markDirtyByFormulas(Array.from(this.formulas),e)},n.prototype.consumeDirtyInfo=function(e,t){var n,r;try{for(var i=p(e),o=i.next();!o.done;o=i.next()){var a=v(o.value,2),s=a[0],u=a[1];s.consumeDirtyRefs(u)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}this.handleMarkDirtyCompleted(h({isDirtyAlwaysCalc:!1},t))},n.prototype.markDirty=function(e,t){this.reactivitySpace.markDirty(e,t)},n.prototype.markDirtyByReferences=function(e,t){this.reactivitySpace.markDirtyByReferences(e,t)},n.prototype.markDirtyByFormulas=function(e,t){this.reactivitySpace.markDirtyByReactivities(e,t)},n.prototype.batchMarkDirty=function(e,t){this.reactivitySpace.batchMarkDirty(e,t)},n.prototype.onOp=function(e,t){this.reactivitySpace.onOp(e,t)},n.prototype.iterFormulasDependOn=function(t,n,r){this.reactivitySpace.refSpace.iterValueByRef(t,n,(function(t,n){return t instanceof e.BaseFormulaVar&&r(t,n)}))},n.prototype.markAlwaysCalcFormulasDirty=function(e){this.dirtyAlwaysCalc(e)},n.prototype.dirtyAlwaysCalc=function(e){var t,n,r,i,o=[];try{for(var a=p(this.alwaysCalcFormulas),s=a.next();!s.done;s=a.next()){var u=v(s.value,2),l=u[0],c=u[1];try{for(var d=(r=void 0,p(c)),f=d.next();!f.done;f=d.next()){var g=f.value;if(g.op().shouldMarkDirty(g)){o.push(l);break}}}catch(e){r={error:e}}finally{try{f&&!f.done&&(i=d.return)&&i.call(d)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}o.length>0&&this.markDirtyByFormulas(o,h(h({},e),{isDirtyAlwaysCalc:!1}))},n.prototype.handleDirtyFormulaAdded=function(t){var n=this;this.emit(e.FormulaSpaceEvents.onDirtyFormulaAdded,t),null===this.dirtyNotifyTrigger&&(this.dirtyNotifyTrigger=Promise.resolve().then((function(){n.dirtyFormulas.size>0&&n.emit(e.FormulaSpaceEvents.onBatchFormulasDirty,n.dirtyFormulas),n.dirtyNotifyTrigger=null})))},n.prototype.addDirtyFormula=function(e){this.dirtyFormulas.has(e)||(this.dirtyFormulas.add(e),this.handleDirtyFormulaAdded(e))},n.prototype.deleteDirtyFormula=function(t){this.dirtyFormulas.has(t)&&(this.dirtyFormulas.delete(t),this.emit(e.FormulaSpaceEvents.onDirtyFormulaRemoved,t))},n.prototype.iterDirtyFormulas=function(e){var t,n;try{for(var r=p(this.dirtyFormulas),i=r.next();!i.done;i=r.next()){var o=i.value;if(o.isDirty(o.getRef())&&e(o))break}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},n}(n.EventEmitter),e.getDefaultCustomData=function(){return null},e.getFirstCustomData=function(e){return e()[0]},e.getFirstValidCustomData=function(e){for(var t=e(),n=0;n<t.length;n++)if(null!=t[n])return t[n];return null},e.DefaultParam=void 0,(Y=e.DefaultParam||(e.DefaultParam={})).IfNotInput="ifNotInput",Y.IfInputNull="ifInputNull",e.OpBase=function(){function t(t,n){void 0===t&&(t=ce),void 0===n&&(n=e.getDefaultCustomData),this.convertVariant=t,this.calcCustomData=n,this.executeMode=e.ExecuteMode.CALCULATE|e.ExecuteMode.PREVIEW|e.ExecuteMode.PREDICT|e.ExecuteMode.FORCE}return t.prototype.isStatic=function(){return!1},t.prototype.getDependencies=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e},t.prototype.getConvertVariantFn=function(){return this.convertVariant},t.prototype.operandDesc=function(e){var t=this.convertToDescIdx(e);return t<0?null:this.paramsDesc[t]},t.prototype.operandType=function(t){var n,r;return null!==(r=null===(n=this.operandDesc(t))||void 0===n?void 0:n.type)&&void 0!==r?r:e.VAR_TYPE.NULL},t.prototype.convertToDescIdx=function(e){if(0===this.paramsDesc.length)return-1;if(e<this.paramsDesc.length)return e;if(0===this.repeatedLastParam)return-1;var t=(e-this.paramsDesc.length)%this.repeatedLastParam;return this.paramsDesc.length-this.repeatedLastParam+t},t.prototype.calc=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.service.op.calc(e,this,t)},t.prototype.func=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return e.NULL_VAR},t.prototype.predict=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return e.UNPREDICTABLE_VAR},t.prototype.shouldMarkDirty=function(e){return!0},t}(),e.FuncOpBase=function(e){function t(t){void 0===t&&(t="");var n=e.call(this)||this;return n.name=t,n}return a(t,e),t}(e.OpBase),e.BinaryOpBase=function(e){function t(t){void 0===t&&(t="");var n=e.call(this)||this;return n.name=t,n.operands=2,n.optionOperands=0,n.repeatedLastParam=0,n}return a(t,e),t}(e.OpBase),e.PrefixUnaryOpBase=function(t){function n(n){void 0===n&&(n="");var r=t.call(this)||this;return r.name=n,r.operands=1,r.optionOperands=0,r.repeatedLastParam=0,r.calcCustomData=e.getFirstCustomData,r}return a(n,t),n}(e.OpBase),e.SuffixUnaryOpBase=function(e){function t(t){void 0===t&&(t="");var n=e.call(this)||this;return n.name=t,n.operands=1,n}return a(t,e),t}(e.OpBase);var fe=/^\$([^[]+)\[([^\]]+)\]$/;function pe(e){var t=e.match(fe);return null==t||t.length<3?null:{refType:t[1],refId:t[2]}}function ve(t){var n=t.resolve();return n instanceof Promise?new e.AsyncVar(n):n}function ge(e){var t,n;return{promise:new Promise((function(r,i){t=r,n=i,null!=e&&e(r,i)})),resolve:t,reject:n}}var _e,ye=function(){function e(e){var t=this;this.options=e,this.queue=new Map,this.isRunning=!1,this.poll=function(){if(!(t.isRunning||t.queue.size<=0)){var e=t.queue.keys().next().value,n=t.queue.get(e),r=n.resolve,i=n.reject,o=n.func,a=n.params;t.isRunning=!0;var s=a.shift();o.apply(s,a).then(r).catch(i).finally((function(){t.isRunning=!1,t.queue.delete(e),t.poll()}))}},this.dispose=function(){var e,n;try{for(var r=p(t.queue),i=r.next();!i.done;i=r.next())(0,v(i.value,2)[1].reject)(t.options.onDispose())}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}t.isRunning=!1,t.queue.clear()},this.cancelableFunc=function(e,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];r.unshift(n);var o=ge(),a=o.promise,s=o.resolve,u=o.reject,l=function(){t.queue.delete(a),u(t.options.onCancel())};return t.queue.set(a,{resolve:s,reject:u,func:e,params:r}),t.poll(),{promise:a,cancel:l}}}return e}();function me(e){return function(t,n,r){var i=r.value,o=new ye(e);return r.value=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.cancelableFunc.apply(o,g([i,this],v(e),!1))},r.value.dispose=o.dispose,r}}function Ee(e,t,n){e.getDependencies().forEach((function(e){(n||e.isValid())&&t(e)}))}function be(t){var n=null==t?void 0:t.op;if(n)return new(e.OperatorVar.bind.apply(e.OperatorVar,g([void 0,n],v(t.args),!1)));var r=t,i=r.operatorName,o=r.namespaces,a=r.args,s=r.findOperator,u=r.operateNotFoundHook,l=null,c=r.caller||a[0];if(null!=o?l=o:c&&(c.isRef()||c.isOp())?c&&c.isRef()&&(l=[c.getRef().namespace(),""]):l=[""],null===l)return new(e.OperatorVar.bind.apply(e.OperatorVar,g([void 0,new e.FuncCreatorOp(h({findOperator:s,funInfo:{funcName:i,namespaces:o}},t))],v(a),!1)));if(void 0===c)n=s(i,{namespaces:l});else{if(c.isOp())return new(e.OperatorVar.bind.apply(e.OperatorVar,g([void 0,new e.FuncCreatorOp(h({findOperator:s,funInfo:{funcName:i,namespaces:l}},t))],v(a),!1)));n=c.isCustomCollection()||c.isCustomPrimitive()?s(i,{namespaces:l,customType:c.customType}):s(i,{namespaces:l})}if(null===n){if(u)return u();throw new Error("[Tractor] unknown op ".concat(i))}return new(e.OperatorVar.bind.apply(e.OperatorVar,g([void 0,n],v(a),!1)))}function Te(t,n,r,i){return le(t,r,n.operandDesc(i))&&r.isCollection()?new e.MatrixArgument(t,n,r,i):new e.SingleArgument(t,n,r,i)}function Ce(){return new e.TArguments}e.MAX_NUMBER_VALUE=179769e303,e.ExternalNativeFuncOp=function(e){function t(t){var n,r,i,o=this;return(o=e.call(this,t.name)||this).repeatedLastParam=0,o.paramsDesc=[],o.needCtx=!1,o.name=t.name,o.resultType=t.resultType,o.operands=t.operands,o.optionOperands=t.optionOperands,o.repeatedLastParam=null!==(n=t.repeatedLastParam)&&void 0!==n?n:0,o.paramsDesc=null!==(r=t.paramsDesc)&&void 0!==r?r:[],o.formula=t.formula,o.needCtx=null!==(i=t.needCtx)&&void 0!==i&&i,o}return a(t,e),t.prototype.isFormulaWithoutCtx=function(){return!this.needCtx},t.prototype.func=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];for(var i=[],o=0;o<n.length;o++)i.push(re(n[o],e));return ne(this.isFormulaWithoutCtx()?(t=this).formula.apply(t,g([],v(i),!1)):this.formula.apply(this,g([e],v(i),!1)),e)},t}(e.FuncOpBase),e.OpMgr=function(){function e(e){this.map=new Map,this.overrideOperators=null,this.prefixes=null,this.namespace=e}return e.prototype.getOverrideOperators=function(){return null===this.overrideOperators&&(this.overrideOperators=new Map),this.overrideOperators},e.prototype.clearOverrideOperators=function(){null!==this.overrideOperators&&this.overrideOperators.clear(),this.overrideOperators=null},e.prototype.registerCustomOp=function(e,t,n){void 0===n&&(n=e.name);var r=this.getOverrideOperators().get(t)||new Map;r.set(n,e),this.overrideOperators.set(t,r)},e.prototype.unregisterCustomOp=function(e,t){if(null!==this.overrideOperators){var n=this.overrideOperators.get(t);null!=n&&(n.delete(e),0===n.size&&(this.overrideOperators.delete(t),0===this.overrideOperators.size&&this.clearOverrideOperators()))}},e.prototype.register=function(e,t){void 0===t&&(t=e.name),this.map.set(t,e),this.prefixes=null},e.prototype.find=function(e){var t,n;if(e.length<=1)return null!==(t=this.map.get(e))&&void 0!==t?t:null;var r=e.trim();return null!==(n=this.map.get(0===r.length?" ":r))&&void 0!==n?n:null},e.prototype.findCustomOp=function(e,t){var n;if(null===this.overrideOperators)return null;var r=this.overrideOperators.get(t);return void 0===r?null:null!==(n=r.get(e))&&void 0!==n?n:null},e.prototype.getFunctions=function(){return Array.from(this.map.values())},e.prototype.getCustomOpsByOpName=function(e){if(null===this.overrideOperators)return null;var t=[];return this.overrideOperators.forEach((function(n){var r=n.get(e);null!=r&&t.push(r)})),0===t.length?null:t},e.prototype.getPrefixFunction=function(e){if(""===e)return[];null==this.prefixes&&(this.prefixes=Array.from(this.map.keys()).sort());for(var t=n.lowerBound(this.prefixes,e,(function(e,t){return e<t})),r=[];t<this.prefixes.length&&this.prefixes[t].startsWith(e);t++)r.push(this.map.get(this.prefixes[t]));return r},e.prototype.unregister=function(e){this.map.delete(e),this.prefixes=null},e.prototype.clear=function(){var e;this.map.clear(),null===(e=this.overrideOperators)||void 0===e||e.clear(),this.prefixes=null},e}(),e.NameSpaceMgr=function(){function t(){this.mapToOpMgr=new Map}return t.prototype.getAllNamespaces=function(){return Array.from(this.mapToOpMgr.keys())},t.prototype.register=function(e,t,n){void 0===t&&(t=e.name),void 0===n&&(n=""),this.createOpMgr(n).register(e,t)},t.prototype.unregister=function(e,t){void 0===t&&(t="");var n=this.getOpMgr(t);n&&n.unregister(e)},t.prototype.registerCustomOp=function(e,t,n,r){void 0===n&&(n=e.name),void 0===r&&(r=""),this.createOpMgr(r).registerCustomOp(e,t,n)},t.prototype.unregisterCustomOp=function(e,t,n){void 0===n&&(n="");var r=this.getOpMgr(n);r&&r.unregisterCustomOp(e,t)},t.prototype.registerExternalNativeFunction=function(t,n){void 0===n&&(n="");var r=new e.ExternalNativeFuncOp(t);this.register(r,r.name,n)},t.prototype.find=function(e,t,n){return void 0===t&&(t=[""]),this.findOpByNamespaces(e,t,n)},t.prototype.findOps=function(e){var t=[];return this.mapToOpMgr.forEach((function(n){var r=n.getCustomOpsByOpName(e);null!==r&&t.push.apply(t,g([],v(r),!1));var i=n.find(e);null!==i&&t.push(i)})),0===t.length?null:t},t.prototype.findOpByNamespaces=function(e,t,n){for(var r=0;r<t.length;r++){var i=this.getOpMgr(t[r]);if(null!=i){if(void 0!==typeof n){var o=i.findCustomOp(e,n);if(o)return o}var a=i.find(e);if(a)return a}}return null},t.prototype.getFunctions=function(e){void 0===e&&(e="");var t=this.getOpMgr(e);return t?t.getFunctions():[]},t.prototype.getPrefixFunction=function(e,t){void 0===t&&(t="");var n=this.getOpMgr(t);return n?n.getPrefixFunction(e):[]},t.prototype.getOpMgr=function(e){return this.mapToOpMgr.get(e)},t.prototype.createOpMgr=function(t){var n=this.mapToOpMgr.get(t);return n||(n=new e.OpMgr(t),this.mapToOpMgr.set(t,n)),n},t.prototype.clear=function(){this.mapToOpMgr.forEach((function(e){return e.clear()})),this.mapToOpMgr.clear()},t}(),e.FuncCreatorOp=function(t){function n(n){var r=t.call(this)||this;return r.options=n,r.name="FUNC_CREATOR",r.operands=0,r.optionOperands=255,r.paramsDesc=[{type:e.VAR_TYPE.ALL}],r.repeatedLastParam=1,r.resultType=e.VAR_TYPE.PRIMITIVE|e.VAR_TYPE.COLLECTION,r}return a(n,t),n.prototype.getFuncInfo=function(){return this.options.funInfo},n.prototype.func=function(t,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var o=this.getFuncInfo(),a=o.funcName,s=o.namespaces,u=this.options,l=u.findOperator,c=u.hook,h=s,d=n,f=null;return void 0===s&&n&&(n.isOp()&&(d=n.getVar(t))&&t.info.customData&&d.setSpecialInfo({customData:t.info.customData}),d&&d.isRef()&&(h=[d.getRef().namespace(),""])),null===(f=(null==d?void 0:d.isCustomCollection())||(null==d?void 0:d.isCustomPrimitive())?l(a,{namespaces:h,customType:d.customType}):l(a,{namespaces:h}))?(null==c?void 0:c.operateNotFoundHook)?c.operateNotFoundHook():e.NAME_ERR_VAR:null!=d?f.calc.apply(f,g([t,d],v(r),!1)):f.calc.apply(f,g([t],v(r),!1))},n}(e.OpBase),e.ArgumentType=void 0,(_e=e.ArgumentType||(e.ArgumentType={})).Single="Single",_e.Matrix="Matrix",e.TArgument=function(){function t(){}return t.prototype.isMatrix=function(){return this.type===e.ArgumentType.Matrix},t.prototype.isSingle=function(){return this.type===e.ArgumentType.Single},t}(),e.MatrixArgument=function(t){function n(n,r,i,o){var a=t.call(this)||this;return a.ctx=n,a.op=r,a.argument=i,a.index=o,a.type=e.ArgumentType.Matrix,a}return a(n,t),n.prototype.dimension=function(){return this.argument.size()},n.prototype.nth=function(e){return ae(this.ctx,{argument:this.argument.nth(e,this.ctx),index:this.index,parameter:this.op.operandDesc(this.index),op:this.op},this.op.getConvertVariantFn())},n}(e.TArgument),e.SingleArgument=function(t){function n(n,r,i,o){var a=t.call(this)||this;return a.argument=i,a.type=e.ArgumentType.Single,a.cache=ae(n,{argument:i,index:o,parameter:r.operandDesc(o),op:r},r.getConvertVariantFn()),a}return a(n,t),n.prototype.nth=function(){return this.cache},n}(e.TArgument),e.TBaseArguments=function(){function e(){this._args=[],this._isMappable=!1}return e.prototype.isMappable=function(){return this._isMappable},e}(),e.TArguments=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.index=0,t.dimension=1,t}return a(t,e),t.prototype.appendArgument=function(e){if(this._args.push(e),e.isMatrix()){if(!1===this._isMappable)return this._isMappable=!0,void(this.dimension=e.dimension());if(this.dimension!==e.dimension())throw new Error("Dimension of arguments are not consistent.")}},t.prototype.done=function(){return this.index>=this.dimension},t.prototype.next=function(){var e=this;if(this.done())return null;var t=this._args.map((function(t){return t.nth(e.index)}));return++this.index,n.Task.parallel(t)},t}(e.TBaseArguments);var Se=function(){function e(){this.graph=new n.Graph}return e.prototype.enterFormula=function(e,t){return null==t.calcId?(t.calcId=e.calcId,!0):this.graph.insertEdge(e.calcId,t.calcId)},e.prototype.exitFormula=function(e,t){null!=e.calcId&&null!=t.calcId&&this.graph.removeEdge(e.calcId,t.calcId),e.calcId===t.calcId&&(t.calcId=null)},e}();function we(e){return e.funcDesc}function Re(e){return e.example||""}function Ae(e,t){var n=null==t?void 0:t.paramName,r=null==t?void 0:t.paramDesc;return e.paramsDesc.map((function(e,t){return{name:n&&n[t]||"",type:e.type,desc:r&&r[t]}}))}function Oe(e,t){return Ae(e,t).slice(0,e.operands)}function Me(e,t){if(0===e.optionOperands)return[];var n=Ae(e,t);return 0===e.repeatedLastParam?n.slice(-e.optionOperands):n.length<=e.operands+e.repeatedLastParam?n.slice(-e.repeatedLastParam):n.slice(-(n.length-e.operands))}function ke(e,t){return 0===e.repeatedLastParam?[]:Me(e,t).slice(-e.repeatedLastParam)}function Ie(e,t){var n=Me(e,t);return n.length>e.repeatedLastParam?Me(e,t).slice(0,n.length-e.repeatedLastParam):[]}function xe(e,t){e.innerMapToFuncCache.forEach(t),e.outerMapToFuncCache.forEach(t)}e.I18nService=function(){function e(e){this.service=e}return e.prototype.getFuncMeta=function(e){return null},e.prototype.getFuncDesc=function(e){var t=this.getFuncMeta(e);return t&&t.funcDesc||""},e.prototype.getFuncExample=function(e){var t=this.getFuncMeta(e);return t&&t.example||""},e.prototype.getParamsDesc=function(e){var t=this.getFuncMeta(e.name);return null==t?null:Ae(e,t)},e.prototype.getRequiredParams=function(e){var t=this.getFuncMeta(e.name);return null==t?null:Oe(e,t)},e.prototype.getOptionalParams=function(e){var t=this.getFuncMeta(e.name);return null==t?null:Me(e,t)},e.prototype.getOptionalRepeatParams=function(e){var t=this.getFuncMeta(e.name);return null==t?null:ke(e,t)},e.prototype.getOptionalNotRepeatParams=function(e){var t=this.getFuncMeta(e.name);return null==t?null:Ie(e,t)},e}();var Ne=4096,Pe=50,Le=.5;e.BaseFuncCache=function(){function e(e,t){void 0===e&&(e=Ne),void 0===t&&(t=!0),this.disableCacheWhenLowHitRate=t,this.getCacheCount=0,this.cacheHitCount=0,this.cache=new n.LRUCache(e)}return e.prototype.addCacheByKey=function(e,t){e&&this.cache.set(e,t)},e.prototype.getCacheByKey=function(e){if(!e)return null;this.getCacheCount++;var t=this.cache.get(e);return null!==t&&this.cacheHitCount++,t},e.prototype.addCache=function(e,t,n){var r=this.hashMethod(e,n);null!=r&&this.cache.set(r,t)},e.prototype.getCache=function(e,t){var n=this.hashMethod(e,t);if(null==n)return null;this.getCacheCount++;var r=this.cache.get(n);return null!=r&&this.cacheHitCount++,r},e.prototype.getKey=function(e,t){return this.hashMethod(e,t)},e.prototype.removeCache=function(e){this.cache.clear(),!0===(null==e?void 0:e.resetMetrics)&&(this.cacheHitCount=0,this.getCacheCount=0)},e.prototype.setHashMethod=function(e){this.hashMethod=e},e.prototype.isCacheValid=function(){return!this.disableCacheWhenLowHitRate||this.getCacheCount<Pe||this.cacheHitCount/this.getCacheCount>=Le},e}(),e.FuncCache=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hashMethod=function(e){return e},t}return a(t,e),t}(e.BaseFuncCache),e.FuncCacheManager=function(){function t(){this.useCache=!0,this.innerMapToFuncCache=new Map,this.outerMapToFuncCache=new Map}return t.prototype.startUseCache=function(){this.useCache=!0},t.prototype.stopUseCache=function(){this.useCache=!1,this.dispose()},t.prototype.registerInnerCache=function(e,t){this.useCache&&this.innerMapToFuncCache.set(e,t)},t.prototype.unregisterInnerCache=function(e){this.innerMapToFuncCache.delete(e)},t.prototype.registerOuterCache=function(e,t){this.useCache&&this.outerMapToFuncCache.set(e,t)},t.prototype.unregisterOuterCache=function(e){this.outerMapToFuncCache.delete(e)},t.prototype.getInnerFuncCache=function(t,n){if(!this.useCache)return null;if(!1===(null==n?void 0:n.shouldUseCache))return null;var r=this.innerMapToFuncCache.get(t);if(null==r){if(!1===(null==n?void 0:n.autoBuildCache))return null;r=new e.FuncCache(null==n?void 0:n.capacity,null==n?void 0:n.disableCacheWhenLowHitRate),this.registerInnerCache(t,r)}return r.isCacheValid()?r:(r.removeCache(),null)},t.prototype.getOuterFuncCache=function(t,n){if(!this.useCache)return null;if(!1===(null==n?void 0:n.shouldUseCache))return null;var r=this.outerMapToFuncCache.get(t);if(null==r){if(!1===(null==n?void 0:n.autoBuildCache))return null;r=new e.FuncCache(null==n?void 0:n.capacity,null==n?void 0:n.disableCacheWhenLowHitRate),this.registerOuterCache(t,r)}return r.isCacheValid()?r:(r.removeCache(),null)},t.prototype.clear=function(){xe(this,(function(e){return e.removeCache()}))},t.prototype.resetCache=function(){xe(this,(function(e){return e.removeCache({resetMetrics:!0})}))},t.prototype.dispose=function(){this.innerMapToFuncCache.clear(),this.outerMapToFuncCache.clear()},t}(),e.OpService=function(){function t(e){this.service=e}return t.prototype.checkArgs=function(t,n,r){if(n.length<t.operands||t.operands+t.optionOperands<n.length)return 0===t.optionOperands?e.tractorErrorVarCreators[e.ErrorCode.ARGUMENTS_COUNT_SHOULD_BE_EXACTLY]({funcName:t.name,argCount:n.length,requiredOperandCount:t.operands}):n.length<t.operands?e.tractorErrorVarCreators[e.ErrorCode.ARGUMENTS_COUNT_SHOULD_BE_AT_LEAST]({funcName:t.name,argCount:n.length,requiredOperandCount:t.operands}):e.tractorErrorVarCreators[e.ErrorCode.ARGUMENTS_COUNT_SHOULD_BE_BETWEEN]({funcName:t.name,argCount:n.length,requiredOperandCount:t.operands,totalOperandCount:t.operands+t.optionOperands});var i=n.length-(t.paramsDesc.length-t.repeatedLastParam);return t.repeatedLastParam>1&&i>0&&i%t.repeatedLastParam!=0?e.tractorErrorVarCreators[e.ErrorCode.NON_PAIR_ARGUMENTS]({funcName:t.name,argIndex:t.paramsDesc.length-t.repeatedLastParam}):null==(null==r?void 0:r.executeMode)||r.executeMode&t.executeMode?void 0:e.UNMATCHED_MODE_ERR_VAR},t.prototype.resolveDefaultArguments=function(t,n,r){var i=t.paramsDesc.length;if(!(n.length<t.operands)){t.repeatedLastParam>0&&n.length>t.paramsDesc.length&&(i=t.operands+Math.ceil((n.length-t.operands)/t.repeatedLastParam)*t.repeatedLastParam);for(var o=n.length;o<i;o++){var a=this.resolveDefaultArgument(t,o,e.DefaultParam.IfNotInput);if(null==a)break;n[o]=a}}},t.prototype.resolveArgument=function(t,n,r,i,o,a){var s,u,l=null===(s=r.getSpecialInfo())||void 0===s?void 0:s.customData;l&&(a[i]=l),r.isNull()&&(r=null!==(u=this.resolveDefaultArgument(n,i,e.DefaultParam.IfInputNull))&&void 0!==u?u:e.NULL_VAR),r.isOp()&&!_(r,n.operandType(i))&&(r=this.resolveOperatorArgument(t,r,i,a)),o[i]=r},t.prototype.shouldUseOuterCacheMethod=function(){return!1},t.prototype.calc=function(t,n,r){var i=r.length;this.resolveDefaultArguments(n,r,t);var o=this.checkArgs(n,r,t);if(o)return o;for(var a=[],s=0;s<i;s++){var u=r[s],l=this.resolveArgument(t,n,u,s,r,a);if(l)return l}return t.executeMode===e.ExecuteMode.PREDICT?this.predictImpl(t,n,r,this.predict):this.calcImpl(t,n,r,a)},t.prototype.getOpMeta=function(e){return null},t.prototype.createOpVar=function(e){return be(e)},t.prototype.callFunctionImpl=function(e,t,n,r){return n.isMappable()?this.callMatrixFunction(e,t,n,r):this.callSingleFunction(e,t,n,r)},t.prototype.predictImpl=function(t,r,i,o){var a=this;i=i.map((function(t){return t.isAsync()?e.UNPREDICTABLE_VAR:t}));for(var s=this.service.arg.createTArguments(),u=0;u<i.length;u++)s.appendArgument(this.service.arg.createTArgument(t,r,i[u],u));var l=n.Task.catch((function(){return a.callFunctionImpl(t,r,s,o)}),(function(){return n.Task.sync(e.UNPREDICTABLE_VAR)}));return l.isSync()?l.resolve():e.UNPREDICTABLE_VAR},t.prototype.calcImpl=function(t,r,i,o,a){var s=this,u=function(){for(var e,n=0;n<i.length;n++){var r=i[n];if(r.isRef()){var a=r.getRef();if(a.isValid()){var s=null===(e=a.getCustomData)||void 0===e?void 0:e.call(a,t);s&&(o[n]=s)}else o[n]=null}}return o},l=i.map((function(e){return n.Task.from(z(e))})),c=n.Task.parallel(l).next((function(e){for(var n=t.service.arg.createTArguments(),i=0;i<e.length;i++)n.appendArgument(t.service.arg.createTArgument(t,r,e[i],i));return s.callFunctionImpl(t,r,n,a)})).pipe((function(e){null==t.info?t.info={}:null==t.info.customData&&(t.info.customData=r.calcCustomData(u)),t.info.customData&&e.setSpecialInfo({customData:t.info.customData})}));return c.isSync()?c.resolve():new e.AsyncVar(c.resolve())},t.prototype.callSingleFunction=function(e,t,n,r){var i=this;return void 0===r&&(r=this.callFunction),n.next().sync((function(n){return r.call(i,e,t,n)}))},t.prototype.getMappableResult=function(t,n){return new e.ArrayVar(t)},t.prototype.callMatrixFunction=function(t,r,i,o){var a=this;void 0===o&&(o=this.callFunction);for(var s=[];!i.done();){var u=i.next().next((function(e){var i=o.call(a,t,r,e);return i.isAsync()?i.isResolved()?n.Task.sync(i.getVar()):n.Task.async(i.resolve()):n.Task.sync(i)})).sync((function(t){var n=t.toValidVar();return n.isCollection()||n.isPrimitive()?n:e.tractorErrorVarCreators[e.ErrorCode.UNKNOWN]("The return value of function is not primitive or collection.")}));s.push(u)}return n.Task.parallel(s).sync((function(e){return a.getMappableResult(e,i)}))},t.prototype.predict=function(e,t,n){for(var r=[e],i=0;i<n.length;i++){var o=n[i],a=o.convertedArgument;if(o.isError)return a;r.push(a)}return t.predict.apply(t,r)},t.prototype.callFunction=function(e,t,n){for(var r=[e],i=[],o=0;o<n.length;o++){var a=n[o],s=a.isError,u=a.convertedArgument,l=a.srcArg;if(s)return u;r.push(u),i.push(l)}if(!this.shouldUseOuterCacheMethod(t,r,i))return t.func.apply(t,r);var c=e.service.getFuncCacheManager().getOuterFuncCache(t);if(null==c)return t.func.apply(t,r);var h=c.getCache(r,e);if(null!=h)return h;var d=t.func.apply(t,r);return c.addCache(r,d,e),d},t.prototype.predictOperatorArgument=function(e,t){for(var n=t;n&&n.isOp();)n=n.predict(e);return n},t.prototype.resolveDefaultArgument=function(e,t,n){var r=e.operandDesc(t);return null!=(null==r?void 0:r.default)?this.getDefaultValue(r.default,n):null},t.prototype.resolveOperatorArgument=function(e,t,n,r){var i;e.info.customData=null;for(var o=t;o.isOp();)o=o.getVar(e);return r&&(r[n]=null===(i=e.info)||void 0===i?void 0:i.customData),e.info.customData=null,o},t.prototype.getDefaultValue=function(t,n){return t instanceof e.BaseVar?t:t[n]},t}(),e.ArgumentService=function(){function t(e){this.service=e}return t.prototype.isArgMappable=function(e,t,n){var r;return null!==(r=n.isMappable)&&void 0!==r&&!r&&!!t.isCollection()&&!Z(t,n)},t.prototype.transformVariant=function(t,n){var r=n.argument,i=n.parameter;if(Z(r,i)||r.type&e.VAR_TYPE.UNPREDICTABLE&&t.executeMode===e.ExecuteMode.PREDICT)return{isError:!1,convertedArgument:r,srcArg:r};if(r.isError())return{isError:!0,convertedArgument:r,srcArg:r};if(r.isPrimitive()&&(i.type===e.VAR_TYPE.COLLECTION||i.type===(e.VAR_TYPE.CUSTOM_COLLECTION|e.VAR_TYPE.COLLECTION)))return{isError:!1,convertedArgument:new e.ArrayVar([r]),srcArg:r};if(r.isPrimitive()){var o=de(t.service,r,i.type);if(null!=o)return{isError:!1,convertedArgument:o,srcArg:r}}return{isError:!0,convertedArgument:e.VALUE_ERR_VAR,srcArg:r}},t.prototype.createTArgument=function(t,n,r,i){return r&&this.isArgMappable(t,r,n.operandDesc(i))&&r.isCollection()?new e.MatrixArgument(t,n,r,i):new e.SingleArgument(t,n,r,i)},t.prototype.createTArguments=function(){return new e.TArguments},t}();var De,Fe,Be=.1;function Ve(t,r,i){if(!r.circleChecker.enterFormula(t,i))return n.Task.sync(new e.FormulaCache(e.CIRCULAR_DEPENDENCY_ERR_VAR));if(i.cache)return n.Task.sync(i.cache);var o=r.getRoot(),a=r.level!==r.maxStackSize?n.Task.sync(o):n.Task.async(Promise.resolve(o)),s=t.service.formulaChainPerformanceService;return 1===r.level&&s.isCollect&&Math.random()<s.sampleRate&&(t.formulaChainPerformance=new e.FormulaChainPerformance(s),t.formulaChainPerformance.startCalc()),null!=t.formulaChainPerformance&&t.formulaChainPerformance.enterFormula(r),n.Task.catch((function(){var e=a.sync((function(e){return e.isOp()?e.getVar(t):e}));return r.dereference(t,ve(e))}),(function(o){return o instanceof e.AsyncVar?n.Task.async(o.resolve()).next((function(){return r.circleChecker.exitFormula(t,i),i.reset(),null!=t.formulaChainPerformance&&(t.formulaChainPerformance=void 0),Ve(t,r,i)})):o instanceof e.ErrorVar?n.Task.sync(new e.FormulaCache(o)):o instanceof Error?n.Task.sync(new e.FormulaCache(e.tractorErrorVarCreators[e.ErrorCode.DEFAULT_RUNTIME_ERROR]("Message: ".concat(o.message,"\nstack: ").concat(o.stack,".")))):n.Task.sync(new e.FormulaCache(e.tractorErrorVarCreators[e.ErrorCode.DEFAULT_RUNTIME_ERROR]("Unknown error occurred during calculation.")))}))}function He(t,n,r,i){if(i.isSync())return i.resolve();var o=ve((i=i.pipe((function(){n.getFormulaService().emit(e.FormulaEvents.onAsyncFormulaValueChanged,n)}))).sync((function(e){return e.getRawVar()}))),a=ve(i.sync((function(e){return e.getVar()})));return Ue(t,r,new e.FormulaCache(o,a))}function Ue(t,n,r){return r.setInfo(t.info),t.executeMode!==e.ExecuteMode.PREVIEW&&(n.cache=r),r}function Ze(t,n){var r=null;switch(t[e.TractorFormulaCacheProps.type]){case e.VAR_TYPE.ERROR:r=We(t,n);break;case e.VAR_TYPE.NULL:r=e.NULL_VAR;break;case e.VAR_TYPE.STRING:r=je(t);break;case e.VAR_TYPE.NUMBER:r=Ge(t);break;case e.VAR_TYPE.BOOL:r=ze(t);break;default:return null}if(null==r)return null;var i=t[e.TractorFormulaCacheProps.specialInfo];return null==i||r.setSpecialInfo(JSON.parse(i)),r}function We(t,n){var r=t[e.TractorFormulaCacheProps.error];if(null==r)return null;if(null!=n&&!n.loadRuntimeError&&r[e.TractorFormulaCacheErrorProps.code]===e.ErrorCode.DEFAULT_RUNTIME_ERROR)return null;var i=r[e.TractorFormulaCacheErrorProps.type],o=e.error2DescriptionMap[i],a=r[e.TractorFormulaCacheErrorProps.arguments],s=null!=a?JSON.parse(a):void 0;return new e.ErrorVar(i,o,r[e.TractorFormulaCacheErrorProps.code],null!=s?{args:s}:void 0)}function je(t){var n=t[e.TractorFormulaCacheProps.value];return"string"!=typeof n?null:new e.StringVar(n)}function Ge(t){var n=t[e.TractorFormulaCacheProps.value];return"number"!=typeof n?null:new e.NumberVar(n)}function ze(t){var n=t[e.TractorFormulaCacheProps.value];return"boolean"!=typeof n?null:new e.BooleanVar(n)}function Ye(t,r,i){return void 0===i&&(i=new Set),n.Task.from(z(r)).next((function(r){return r.isCollection()&&r.isRef()?i.has(r)?n.Task.sync(e.CIRCULAR_DEPENDENCY_ERR_VAR):(i.add(r),Xe(t,r,i)):n.Task.sync(r)}))}function Xe(t,r,i){void 0===i&&(i=new Set);for(var o=r.size(),a=[],s=0;s<o;s++)a.push(Ye(t,r.nth(s,t),i));return n.Task.parallel(a).sync((function(t){for(var n=0;n<t.length;n++){if(t[n]===e.CIRCULAR_DEPENDENCY_ERR_VAR)return t[n];t[n].isCollection()||t[n].isPrimitive()||(t[n]=e.tractorErrorVarCreators[e.ErrorCode.UNKNOWN]("Expected collection or primitive, but got ".concat(r.type,".")))}return new e.ArrayVar(t)}))}function Ke(e,t){if(!t.isCollection())return t.getValue(e);for(var n=t.size(),r=[],i=0;i<n;i++){var o=t.nth(i,e);o.isPrimitive()?r.push(o.getValue(e)):r.push(Ke(e,o))}return r}function qe(t,n){return new e.NumberVar(t.getValue()+n.getValue())}function $e(t,n){return new e.NumberVar(t.getValue()-n.getValue())}function Je(t,n){return new e.NumberVar(t.getValue()*n.getValue())}function Qe(t,n){return 0===n.getValue()?e.tractorErrorVarCreators[e.ErrorCode.DIVIDE_BY_ZERO_FROM_PARAMETER_BEING_ZERO]({funcName:"DIVIDE",argIndex:2}):new e.NumberVar(t.getValue()/n.getValue())}function et(t,n){var r=t.getValue(),i=n.getValue();return 0===i?e.tractorErrorVarCreators[e.ErrorCode.DIVIDE_BY_ZERO_FROM_PARAMETER_BEING_ZERO]({funcName:"MOD",argIndex:2}):new e.NumberVar(r-i*Math.floor(r/i))}function tt(t,n){var r=t.getValue(),i=n.getValue(),o=e.NumberVar.doubleEqual(r,-i)?0:r+i;return new e.NumberVar(o)}function nt(t,n){var r=t.getValue(),i=n.getValue(),o=e.NumberVar.doubleEqual(r,i)?0:r-i;return new e.NumberVar(o)}function rt(t,n){var r=t.getValue(),i=n.getValue();if(0===r&&i<=0)return 0===i?e.NUM_ERR_VAR:e.tractorErrorVarCreators[e.ErrorCode.DIV0_POSITIVE_OVERFLOW]({upperBound:e.MAX_NUMBER_VALUE});var o=Math.pow(r,i);return Number.isFinite(o)?new e.NumberVar(o):e.tractorErrorVarCreators[e.ErrorCode.POSITIVE_OVERFLOW]({upperBound:e.MAX_NUMBER_VALUE})}e.FormulaChainPerformance=function(){function e(e){this.formulaChainPerformanceService=e,this.calcStartTime=0,this.formulaChainPerformanceData={maxLevel:0,formulaCount:0,calcTime:0,averageCalcTime:0}}return e.prototype.now=function(){var e;if("undefined"!=typeof window&&void 0!==window.performance)e=window.performance.now();else{var t=r.hrtime();e=1e3*t[0]+t[1]/1e6}return e},e.prototype.startCalc=function(){this.formulaChainPerformanceService.isCollect&&(this.calcStartTime=this.now())},e.prototype.endCalc=function(){if(this.formulaChainPerformanceService.isCollect){var e=this.now()-this.calcStartTime,t=this.formulaChainPerformanceData.formulaCount;this.formulaChainPerformanceData.calcTime=e,t>0&&(this.formulaChainPerformanceData.averageCalcTime=e/t),this.formulaChainPerformanceService.reportData(this.formulaChainPerformanceData)}},e.prototype.enterFormula=function(e){var t=e.level;t>this.formulaChainPerformanceData.maxLevel&&(this.formulaChainPerformanceData.maxLevel=t),this.formulaChainPerformanceData.formulaCount+=1},e}(),e.FormulaChainPerformanceService=function(){function e(){this.isCollect=!1,this.sampleRate=Be,this.reportDataFunc=null}return e.prototype.startCollect=function(){this.isCollect=!0},e.prototype.stopCollect=function(){this.isCollect=!1},e.prototype.setReportDataFunc=function(e){this.reportDataFunc=e},e.prototype.reportData=function(e){this.isCollect&&null!=this.reportDataFunc&&this.reportDataFunc(e)},e}(),e.FormulaEvents=void 0,(Fe=e.FormulaEvents||(e.FormulaEvents={})).onFormulaValuesChanged="onFormulaValuesChanged",Fe.onFormulaValueChanged="onFormulaValueChanged",Fe.onAsyncFormulaCalculating="onAsyncFormulaCalculating",Fe.onAsyncFormulaValueChanged="onAsyncFormulaValueChanged",Fe.onResumed="onResumed",Fe.onSuspended="onSuspended",e.FormulaService=function(t){function n(n){void 0===n&&(n={});var r,o,a,s,u,l,c=this;return(c=t.call(this)||this).compiler=null,c.prefixUnaryOpMgr=new e.NameSpaceMgr,c.suffixUnaryOpMgr=new e.NameSpaceMgr,c.binaryOpMgr=new e.NameSpaceMgr,c.functionOpMgr=new e.NameSpaceMgr,c.valueChangedTrigger=null,c.valueChangedFormulas=new Set,c.scheduler=null,c.suspended=0,c.formulaId=0,c.op=new(null!==(r=n.OpService)&&void 0!==r?r:e.OpService)(c),c.i18n=new(null!==(o=n.I18nService)&&void 0!==o?o:e.I18nService)(c),c.arg=new(null!==(a=n.ArgumentService)&&void 0!==a?a:e.ArgumentService)(c),c.formulaChainPerformanceService=new(null!==(s=n.FormulaChainPerformanceService)&&void 0!==s?s:e.FormulaChainPerformanceService)(c),c.reactivitySpace=new i.ReactivitySpace(new(null!==(u=n.DirtyStateService)&&void 0!==u?u:i.DirtyStateService)),c.funcCacheManager=new(null!==(l=n.FuncCacheManager)&&void 0!==l?l:e.FuncCacheManager)(c),c.formulaSpace=new e.FormulaSpace(c),c.formulaStack=new e.FormulaStack,c.circleChecker=new Se,c}return a(n,t),n.prototype.registerExternalNativeFunc=function(e){this.functionOpMgr.registerExternalNativeFunction(e)},n.prototype.setCompiler=function(e){this.compiler=e},n.prototype.getCompiler=function(){return this.compiler},n.prototype.getFormulaSpace=function(){return this.formulaSpace},n.prototype.getFormulaCircleChecker=function(){return this.circleChecker},n.prototype.getFuncCacheManager=function(){return this.funcCacheManager},n.prototype.getSuffixUnaryOpManager=function(){return this.suffixUnaryOpMgr},n.prototype.getPrefixUnaryOpManager=function(){return this.prefixUnaryOpMgr},n.prototype.getBinaryOpManager=function(){return this.binaryOpMgr},n.prototype.getFunctionOpManager=function(){return this.functionOpMgr},n.prototype.getFormulaStack=function(){return this.formulaStack},n.prototype.getScheduler=function(){return this.scheduler},n.prototype.setScheduler=function(e){this.scheduler=e},n.prototype.suspend=function(){this.isSuspended()||this.emit(e.FormulaEvents.onSuspended),this.suspended++},n.prototype.resume=function(){this.suspended<=0||(this.suspended--,this.isSuspended()||this.emit(e.FormulaEvents.onResumed))},n.prototype.isSuspended=function(){return this.suspended>0},n.prototype.addValueChangedFormula=function(t){var n=this;this.valueChangedFormulas.add(t),this.emit(e.FormulaEvents.onFormulaValueChanged,t),null===this.valueChangedTrigger&&(this.valueChangedTrigger=Promise.resolve().then((function(){n.handleFormulasValueChanged()})))},n.prototype.removeValueChangedFormula=function(e){this.valueChangedFormulas.delete(e)},n.prototype.handleFormulasValueChanged=function(){var t=new Set(this.valueChangedFormulas);this.valueChangedTrigger=null,this.valueChangedFormulas=new Set,t.size>0&&this.emit(e.FormulaEvents.onFormulaValuesChanged,t)},n}(n.EventEmitter),e.BaseFormulaVar=function(t){function r(n,r,i){var o=t.call(this)||this;return o.ref=n,o.root=r,o.service=i,o.type=e.VAR_TYPE.FORMULA,o.customDepends=null,o.tokens=null,o.refMap=null,o.tree=null,o.alwaysCalcInfo=null,o.id=-1,o}return a(r,t),r.prototype.getId=function(){return this.id},r.prototype.setId=function(e){this.id=e},r.prototype.isLatestState=function(e,t){return this.getState(e)===t},r.prototype.getAlwaysCalcInfo=function(){return this.alwaysCalcInfo},r.prototype.setAlwaysCalcInfo=function(e){this.alwaysCalcInfo=e},r.prototype.effectType=function(){return i.ReactiveEffectType.Reactive},r.prototype.getRoot=function(){return this.root},r.prototype.getRef=function(){return this.ref},r.prototype.setRef=function(e){this.ref=e},r.prototype.ast=function(){return this.tree},r.prototype.setAst=function(e){this.tree=e},r.prototype.setTokens=function(e){this.tokens=e},r.prototype.getTokens=function(){return this.tokens},r.prototype.setRefMap=function(e){this.refMap=e},r.prototype.getRefMap=function(){return this.refMap},r.prototype.getCustomDepends=function(){return this.customDepends},r.prototype.getFormulaService=function(){return this.service},Object.defineProperty(r.prototype,"formulaStack",{get:function(){return this.service.getFormulaStack()},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"circleChecker",{get:function(){return this.service.getFormulaCircleChecker()},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"formulaSpace",{get:function(){return this.service.getFormulaSpace()},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"level",{get:function(){return this.formulaStack.getLevel()},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"maxStackSize",{get:function(){return this.formulaStack.getMaxStackSize()},enumerable:!1,configurable:!0}),r.prototype.getValue=function(e){return this.getVar(e).getValue(e)},r.prototype.getVar=function(e){return this.calc(e).getVar()},r.prototype.getRawVar=function(e){return this.calc(e).getRawVar()},r.prototype.getInfo=function(e){var t=this.formulaStack.enterFormula(this,e),n=this.getState(t.ref).cache;return this.formulaStack.exitFormula(t),null==n?this.calc(e).getInfo():n.getInfo()},r.prototype.getDependencies=function(){for(var e=[],t=[this.getRoot()];t.length>0;){var n=t.shift();if(n.isOp())for(var r=n.getDependencies(),i=0;i<r.length;i++)t.push(r[i]);else if(n.isRef()){var o=n.getRef();e.push(o)}}var a=this.getCustomDepends();if(null!=a)for(i=0;i<a.length;i++)e.push(a[i]);return e},r.prototype.predict=function(t){var n=this.formulaStack.enterFormula(this,t),r=this.getRoot();try{return r.isOp()?r.predict(n):r}catch(t){return t instanceof Error?e.tractorErrorVarCreators[e.ErrorCode.DEFAULT_RUNTIME_ERROR](t.message):e.tractorErrorVarCreators[e.ErrorCode.DEFAULT_RUNTIME_ERROR]("Unknown error occurred during prediction.")}finally{this.formulaStack.exitFormula(n)}},r.prototype.calc=function(t){var n,i=this,o=this.formulaStack.enterFormula(this,t);try{var a=this.getState(o.ref);if(this.service.isSuspended()&&(null==t?void 0:t.executeMode)!==e.ExecuteMode.FORCE)return null!==(n=a.cache)&&void 0!==n?n:r.SUSPENDED_FORMULA_CACHE;var s=Ve(o,this,a).sync((function(e){return i.afterCalc(o,i,a,e)}));return!a.cache&&s.isAsync()&&this.getFormulaService().emit(e.FormulaEvents.onAsyncFormulaCalculating,this),He(o,this,a,s)}catch(t){var u=void 0;return u=t instanceof Error?e.tractorErrorVarCreators[e.ErrorCode.DEFAULT_RUNTIME_ERROR]("Message: ".concat(t.message,"\nstack: ").concat(t.stack,".")):e.tractorErrorVarCreators[e.ErrorCode.DEFAULT_RUNTIME_ERROR]("Unknown error occurred during calculation."),new e.FormulaCache(u)}finally{this.formulaStack.exitFormula(o)}},r.prototype.markDirty=function(e){void 0===e&&(e=this.ref);var t=this.getEffectedRefs(e);return this.consumeDirtyRefs(t),t},r.prototype.consumeDirtyRefs=function(e){this.resetState(e),this.formulaSpace.addDirtyFormula(this)},r.prototype.registerCustomDepends=function(e){void 0===e&&(e=null);var t=this.isRegistered();t&&null!=this.customDepends&&this.formulaSpace.reactivitySpace.unregisterDependencies(this,this.customDepends),this.customDepends=e,t&&null!=this.customDepends&&this.formulaSpace.reactivitySpace.registerDependencies(this,this.customDepends)},r.prototype.isRegistered=function(){return this.formulaSpace.formulas.has(this)},r.prototype.dereference=function(t,r){var i=this;return Ye(t,r).next((function(o){return o.isAsync()?i.dereference(t,o):n.Task.sync(new e.FormulaCache(r,o))}))},r.prototype.afterCalc=function(t,n,r,i){var o;if(n.circleChecker.exitFormula(t,r),null!=t.formulaChainPerformance&&1===n.level&&(t.formulaChainPerformance.endCalc(),t.formulaChainPerformance=void 0),!n.isLatestState(t.ref,r))return t.customRef=t.ref,n.calc(t);if(r.cache===i)return i;n.registerCustomDepends(t.info.customDepends);var a=r.cache;if((null==a?void 0:a.getRawVar())===e.CIRCULAR_DEPENDENCY_ERR_VAR)return a;var s=i.getRawVar();if(s.isRef()){var u=s.getRef(),l=null===(o=u.getCustomData)||void 0===o?void 0:o.call(u,t);l&&(t.info.customData=l)}var c=Ue(t,r,i);return n.getFormulaService().addValueChangedFormula(n),c},r.prototype.serialize=function(e){return null},r.prototype.fromCache=function(e,t){if(!(null==t?void 0:t.forceOverride)&&!this.isDirty(this.getRef()))return!1;var n=this.deserializeCache(e,t);return null!=n&&(this.getState(this.getRef()).cache=n,this.service.addValueChangedFormula(this),!0)},r.prototype.deserializeCache=function(t,n){var r=Ze(t,n);if(null==r)return null;var i=new e.FormulaCache(r,r),o=t[e.TractorFormulaCacheProps.info];return null!=o&&m(i,o),i},r.prototype.serializeCache=function(){var t=this.getRef(),n=this.getState(t);if(null==n.cache)return null;var r=n.cache.getVar().serialize();if(null==r)return null;var i=r,o=E(this);return null!=o&&(i[e.TractorFormulaCacheProps.info]=o),i},r.SUSPENDED_FORMULA_CACHE=new e.FormulaCache(e.SUSPENDED_ERR_VAR),r.WAIT_ASYNC_FORMULA_CACHE=new e.FormulaCache(e.WAIT_ASYNC_ERR_VAR),r}(e.BaseVar),e.ExecuteMode=void 0,(De=e.ExecuteMode||(e.ExecuteMode={}))[De.CALCULATE=1]="CALCULATE",De[De.PREVIEW=2]="PREVIEW",De[De.PREDICT=4]="PREDICT",De[De.FORCE=8]="FORCE",e.FormulaState=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.reset=function(){this.cache=null,this.calcId=null},t}(e.BaseFormulaState),e.FormulaVar=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.VAR_TYPE.FORMULA,n.state=new e.FormulaState(n),n}return a(n,t),n.prototype.getState=function(){return this.state},n.prototype.resetState=function(){this.state.dispose(),this.state=new e.FormulaState(this)},n.prototype.getEffectedRefs=function(){return[this.ref]},n.prototype.isDirty=function(){return null===this.state.calcId&&null===this.state.cache},n}(e.BaseFormulaVar),e.OperatorVar=function(t){function n(n){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var o=t.call(this)||this;return o._op=n,o.args=[],o.type=e.VAR_TYPE.OPERATOR,o.args=r,o.resultType=o._op.resultType,o}return a(n,t),n.prototype.predict=function(t,n){return t.executeMode=e.ExecuteMode.PREDICT,this.getVar(t,n)},n.prototype.getValue=function(e){return this.getVar(e).getValue(e)},n.prototype.getVar=function(e,t){var n=se(e,this.args,t);return this._op.calc.apply(this._op,n).toValidVar()},n.prototype.toNumberVar=function(){throw new Error("OperatorVar can not convert toNumberVar")},n.prototype.toStringVar=function(){throw new Error("OperatorVar can not convert toStringVar")},n.prototype.toBooleanVar=function(){throw new Error("OperatorVar can not convert toBooleanVar")},n.prototype.getArgs=function(){return this.args},n.prototype.getDependencies=function(){var e;return this._op.isStatic()?(e=this._op).getDependencies.apply(e,g([],v(this.args),!1)):this.args},n.prototype.op=function(){return this._op},n.prototype.clone=function(){return new n(this._op)},n.prototype.serialize=function(e){return null},n}(e.BaseVar),e.UnpredictableVar=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.VAR_TYPE.UNPREDICTABLE,n}return a(n,t),n.prototype.getValue=function(){return null},n.prototype.toNumberVar=function(){return e.NULL_VAR},n.prototype.toStringVar=function(){return e.NULL_VAR},n.prototype.toBooleanVar=function(){return e.NULL_VAR},n.prototype.clone=function(){return new n},n}(e.PrimitiveVar),e.UNPREDICTABLE_VAR=new e.UnpredictableVar,e.NumberBinaryOp=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.operands=2,n.optionOperands=0,n.resultType=e.VAR_TYPE.NUMBER,n.paramsDesc=[{type:e.VAR_TYPE.NUMBER},{type:e.VAR_TYPE.NUMBER}],n.calcCustomData=e.getDefaultCustomData,n}return a(n,t),n.prototype.func=function(e,t,n){return this.opImpl(t,n)},n}(e.BinaryOpBase),e.AddOp=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.name="+",n.calcCustomData=e.getFirstValidCustomData,n.opImpl=qe,n}return a(n,t),n}(e.NumberBinaryOp),e.SubOp=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.name="-",n.calcCustomData=e.getFirstValidCustomData,n.opImpl=$e,n}return a(n,t),n}(e.NumberBinaryOp),e.MultiplyOp=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="*",t.opImpl=Je,t}return a(t,e),t}(e.NumberBinaryOp),e.DivideOp=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="/",t.opImpl=Qe,t}return a(t,e),t}(e.NumberBinaryOp),e.ModOp=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="%",t.opImpl=et,t}return a(t,e),t}(e.NumberBinaryOp),e.PrecisionAddOp=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.name="+",n.calcCustomData=e.getFirstValidCustomData,n.opImpl=tt,n}return a(n,t),n}(e.NumberBinaryOp),e.PrecisionSubOp=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.name="-",n.calcCustomData=e.getFirstValidCustomData,n.opImpl=nt,n}return a(n,t),n}(e.NumberBinaryOp),e.PowerOp=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="^",t.opImpl=rt,t}return a(t,e),t}(e.NumberBinaryOp);var it=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.operands=2,n.optionOperands=0,n.resultType=e.VAR_TYPE.STRING,n.paramsDesc=[{type:e.VAR_TYPE.STRING},{type:e.VAR_TYPE.STRING}],n}return a(n,t),n.prototype.func=function(e,t,n){return this.opImpl(t,n)},n}(e.BinaryOpBase);function ot(e,t,n){return!(!t.isNull()||!n.isNull())||(t.isNull()?t=de(e.service,t,n.type):n.isNull()&&(n=de(e.service,n,t.type)),t.type===n.type&&t.equals(n))}function at(e,t,n){return!ot(e,t,n)}function st(t,n,r){var i,o=((i={})[e.VAR_TYPE.NUMBER]=1,i[e.VAR_TYPE.STRING]=2,i[e.VAR_TYPE.BOOL]=3,i);return!ot(t,n,r)&&(n.isNull()?n=de(t.service,n,r.type):r.isNull()&&(r=de(t.service,r,n.type)),o[n.type]>o[r.type]||o[n.type]===o[r.type]&&n.greaterThan(r))}function ut(e,t,n){return!ot(e,t,n)&&!st(e,t,n)}function lt(e,t,n){return!ut(e,t,n)}function ct(e,t,n){return!st(e,t,n)}e.ConcatenateOp=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="&",e}return a(n,t),n.prototype.opImpl=function(t,n){return new e.StringVar(t.getValue()+n.getValue())},n}(it);var ht=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.resultType=e.VAR_TYPE.BOOL,n.paramsDesc=[{type:e.VAR_TYPE.NUMBER|e.VAR_TYPE.BOOL|e.VAR_TYPE.STRING|e.VAR_TYPE.NULL},{type:e.VAR_TYPE.NUMBER|e.VAR_TYPE.BOOL|e.VAR_TYPE.STRING|e.VAR_TYPE.NULL}],n}return a(n,t),n.prototype.func=function(e,t,n){return this.opImpl(e,t,n)},n}(e.BinaryOpBase);e.EqualsOp=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="=",e}return a(n,t),n.prototype.opImpl=function(t,n,r){return new e.BooleanVar(ot(t,n,r))},n}(ht),e.NotEqualsOp=function(t){function n(e){void 0===e&&(e="!=");var n=t.call(this,e)||this;return n.name=e,n}return a(n,t),n.prototype.opImpl=function(t,n,r){return new e.BooleanVar(at(t,n,r))},n}(ht),e.GreaterThanOp=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.name=">",e}return a(n,t),n.prototype.opImpl=function(t,n,r){return new e.BooleanVar(st(t,n,r))},n}(ht),e.GreaterThanEqualsOp=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.name=">=",e}return a(n,t),n.prototype.opImpl=function(t,n,r){return new e.BooleanVar(lt(t,n,r))},n}(ht),e.LessThanOp=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="<",e}return a(n,t),n.prototype.opImpl=function(t,n,r){return new e.BooleanVar(ut(t,n,r))},n}(ht),e.LessThanEqualsOp=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="<=",e}return a(n,t),n.prototype.opImpl=function(t,n,r){return new e.BooleanVar(ct(t,n,r))},n}(ht),e.AndOp=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.name="&&",n.paramsDesc=[{type:e.VAR_TYPE.BOOL},{type:e.VAR_TYPE.BOOL}],n}return a(n,t),n.prototype.opImpl=function(t,n,r){return new e.BooleanVar(n.getValue()&&r.getValue())},n}(ht),e.OrOp=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.name="||",n.paramsDesc=[{type:e.VAR_TYPE.BOOL},{type:e.VAR_TYPE.BOOL}],n}return a(n,t),n.prototype.opImpl=function(t,n,r){return new e.BooleanVar(n.getValue()||r.getValue())},n}(ht);var dt=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.operands=1,n.optionOperands=0,n.repeatedLastParam=0,n.resultType=e.VAR_TYPE.NUMBER,n.paramsDesc=[{type:e.VAR_TYPE.NUMBER}],n}return a(n,t),n.prototype.func=function(e,t){return this.opImpl(t)},n}(e.SuffixUnaryOpBase);e.PercentOp=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="%",e}return a(n,t),n.prototype.opImpl=function(t){return new e.NumberVar(t.getValue()/100)},n}(dt);var ft,pt,vt,gt=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.paramsDesc=[{type:e.VAR_TYPE.NUMBER}],n.resultType=e.VAR_TYPE.NUMBER,n}return a(n,t),n.prototype.func=function(e,t){return this.opImpl(t)},n}(e.PrefixUnaryOpBase);function _t(e){var t;return null!==(t=null==e?void 0:e.logger)&&void 0!==t?t:console}e.PositiveOp=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.paramsDesc=[{type:e.VAR_TYPE.NUMBER|e.VAR_TYPE.STRING|e.VAR_TYPE.BOOL}],n.resultType=e.VAR_TYPE.NUMBER|e.VAR_TYPE.STRING|e.VAR_TYPE.BOOL,n.name="+",n}return a(n,t),n.prototype.func=function(e,t){return t},n}(e.PrefixUnaryOpBase),e.NegativeOp=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="-",e}return a(n,t),n.prototype.opImpl=function(t){return new e.NumberVar(-t.getValue())},n}(gt),e.ParenOp=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.operands=1,n.optionOperands=0,n.repeatedLastParam=0,n.name="()",n.paramsDesc=[{type:e.VAR_TYPE.PRIMITIVE|e.VAR_TYPE.COLLECTION}],n.resultType=e.VAR_TYPE.PRIMITIVE|e.VAR_TYPE.COLLECTION,n}return a(n,t),n.prototype.func=function(e,t){return t.isOp()?t.getVar(e):t},n}(e.OpBase),e.LSPMethods=void 0,(vt=e.LSPMethods||(e.LSPMethods={})).initialize="initialize",vt.completion="textDocument/completion",vt.documentColor="textDocument/documentColor",vt.documentHighlight="textDocument/documentHighlight",vt.signatureHelp="textDocument/signatureHelp",e.LSPErrorCodes=void 0,(pt=e.LSPErrorCodes||(e.LSPErrorCodes={}))[pt.ParseError=-32700]="ParseError",pt[pt.InvalidRequest=-32600]="InvalidRequest",pt[pt.MethodNotFound=-32601]="MethodNotFound",pt[pt.InvalidParams=-32602]="InvalidParams",pt[pt.InternalError=-32603]="InternalError",pt[pt.ServerNotInitialized=-32002]="ServerNotInitialized",pt[pt.UnknownErrorCode=-32001]="UnknownErrorCode",pt[pt.RequestFailed=-32803]="RequestFailed",pt[pt.ServerCancelled=-32802]="ServerCancelled",pt[pt.RequestCancelled=-32800]="RequestCancelled",e.LSPDocumentHighlightType=void 0,(e.LSPDocumentHighlightType||(e.LSPDocumentHighlightType={})).BracketMatching="BracketMatching",e.ArgumentTypes=void 0,(ft=e.ArgumentTypes||(e.ArgumentTypes={}))[ft.Required=0]="Required",ft[ft.OptionalNotRepeated=1]="OptionalNotRepeated",ft[ft.OptionalRepeated=2]="OptionalRepeated",e.addOpImpl=qe,e.boxValue=ne,e.cacheFormulaResult=Ue,e.calculateFormula=Ve,e.combineCtxArgs=se,e.convert=ae,e.convertTo15Digits=D,e.convertTo15DigitsInt=F,e.convertToBasicType=de,e.createOpVar=be,e.createTArgument=Te,e.createTArguments=Ce,e.defaultIsArgMappable=ue,e.defaultTransformVariant=he,e.dereferenceCollection=Xe,e.dereferenceVariant=Ye,e.deserializeBaseVar=Ze,e.deserializeBooleanVar=ze,e.deserializeErrorVar=We,e.deserializeNumberVar=Ge,e.deserializeStringVar=je,e.divideOpImpl=Qe,e.equals=ot,e.findPriorityOperate=q,e.getFormulaAlwaysCalcInfo=oe,e.getFuncDesc=we,e.getFuncExample=Re,e.getLogger=_t,e.getOptionalNotRepeatParams=Ie,e.getOptionalParams=Me,e.getOptionalRepeatParams=ke,e.getParamsDesc=Ae,e.getRef=R,e.getRequiredParams=Oe,e.getTractorFormulaInfo=E,e.getVarType=y,e.greaterThan=st,e.greaterThanEquals=lt,e.isArgMappable=le,e.isAsyncVariant=G,e.isEmptyObject=b,e.isLoad=A,e.isTypeCompatible=Z,e.iterFmlRefDepends=Ee,e.lessThan=ut,e.lessThanEquals=ct,e.limitToInt32=B,e.load=O,e.modOpImpl=et,e.multiplyOpImpl=Je,e.notEquals=at,e.parseIdReference=pe,e.parseNumber=w,e.power=rt,e.precisionAddOpImpl=tt,e.precisionSubOpImpl=nt,e.resolveAsyncVariant=z,e.resolveFormulaCache=He,e.setTractorFormulaInfo=m,e.subOpImpl=$e,e.tType=M,e.taskToVariant=ve,e.toErrorVar=ie,e.toNativeValue=Ke,e.transformVariant=ce,e.traversalFuncCache=xe,e.typeMatchAccurate=W,e.typeMatchLooser=j,e.unboxVariant=re,e.varCheck=te,e.varTypeCheck=_,e.withCancelable=me,Object.defineProperty(e,"__esModule",{value:!0})}(t,n("vsh_8073"),n("vsh_76925"),n("vsh_28185"))},vsh_91497:function(e,t,n){!function(e,t,n){"use strict";var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o,a,s=function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},s.apply(this,arguments)};function u(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function l(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function c(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function d(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}(function(e){e[e.None=0]="None",e[e.Dragging=1]="Dragging"})(o||(o={})),e.ScrollSnapSide=void 0,(a=e.ScrollSnapSide||(e.ScrollSnapSide={}))[a.Inside=0]="Inside",a[a.OutSide=1]="OutSide";var f,p=1e3,v=8,g=4,_=2,y=function(n){function r(e){var r=n.call(this,e)||this;return r._status=o.None,r._press=!1,r._scrollToPt=new t.FPoint(0,0),r.lastActiveTime=0,r.idleCheck=function(){Date.now()-r.lastActiveTime>p&&!r.hovered?r._slider.updateByCfg({hidden:!0}):t.FApp.registerIdleCallback(r.idleCheck,!0)},r._slider=new t.FWidget(r),r._gapScope=new t.FWidget(r),r._gapScope.updateByCfg({zindex:1}),t.Bind.propBind(r._slider,"background",r,"color"),r._slider.updateByCfg({hidden:!0}),r}return i(r,n),Object.defineProperty(r.prototype,"min",{get:function(){return this._cfg.min||0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"max",{get:function(){return this._cfg.max||0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"page",{get:function(){return this._cfg.page||0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"value",{get:function(){return this._cfg.value||0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"hovered",{get:function(){return this._cfg.hover},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"autoHide",{get:function(){return this._cfg.autoHide},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"snapSide",{get:function(){return this._cfg.snapSide||e.ScrollSnapSide.Inside},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"thick",{get:function(){return this._cfg.thick||v},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"thin",{get:function(){return this._cfg.thin||g},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"gap",{get:function(){return this._cfg.gap||_},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"color",{get:function(){return this._cfg.color},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"hoverColor",{get:function(){return this._cfg.hoverColor},enumerable:!1,configurable:!0}),r.prototype.mouseDown=function(e){var n=this;if(e.target!==this)return!1;if(e.buttons&t.FMouseButtons.MainButton){this._press=!0,this._scrollToPt=new t.FPoint(e.x,e.y);var r=this._pt2Value(this._scrollToPt),i=r-this.value;if(Math.abs(i)>10){var o=i/50,a=function(){n.updateByCfg({value:n.value+o}),n._press&&Math.abs(n.value-r)>1&&setTimeout((function(){return a()}),20)};a()}else this.updateByCfg({value:r})}return!1},r.prototype.mouseMove=function(e){return e.target!==this||e.buttons&t.FMouseButtons.MainButton&&(this._scrollToPt=new t.FPoint(e.x,e.y)),!1},r.prototype.mouseUp=function(e){return e.target!==this||(this._press=!1),!1},r.prototype.mouseEnter=function(){return this.updateByCfg({hover:!0}),!1},r.prototype.mouseLeave=function(){return this.updateByCfg({hover:!1}),!1},r.prototype.click=function(){return!0},r.prototype.pos2View=function(){var e=this.scrollSize()-this.page;return 0===e?0:(this.value-this.min)/e*(this.barSize()-this.slideSize())},r.prototype._pt2Value=function(e){var t=this._pickPos(e)/this.barSize()*this.scrollSize()-this.page/2+this.min;return this.validValue(t)},r.prototype.slideSize=function(){var e=this.scrollSize(),t=20;if(0===e)return 0;var n=this.page/e,r=this.barSize()*n;return r<t&&(r=t),r},r.prototype.scrollSize=function(){return this.max-this.min},r.prototype.validValue=function(e){var t=this.max-this.page;return t<=0?0:(e>t?e=t:e<this.min&&(e=this.min),e)},r.prototype.barSize=function(){return console.error("implment this in derive class"),0},r.prototype._pickPos=function(e){return console.error("implment this in derive class"),0},r.prototype._defalutCfg=function(){var r=n.prototype._defalutCfg.call(this);return r.min=0,r.max=0,r.page=0,r.value=0,r.color=t.SCROLLBAR_COLOR,r.hover=!1,r.snapSide=e.ScrollSnapSide.Inside,r.autoHide=!0,r.onlyNecessary=!1,r.thick=v,r.thin=g,r.gap=_,r},r.prototype.beforeChange=function(e){var t=e.changes;void 0!==t.value&&1===Object.keys(t).length&&(t.value.current=this.validValue(t.value.current))},r.prototype.afterChange=function(e){n.prototype.afterChange.call(this,e);var t=this._sliderCfg();this._slider.updateByCfg(t);var r=e.changes;if(void 0===r.value||Object.keys(r).length>1){var i=this.validValue(this.value);this.value!==i&&this.updateByCfg({value:i})}},r.prototype.beforeFlush=function(e){var n=e.changes;if(this._cfg.onlyNecessary&&(void 0!==n.max||void 0!==n.page)){var r=this.max>this.page;this.updateByCfg({hidden:!r})}return this.autoHide?((void 0!==e.changes.value||void 0!==e.changes.hover)&&(this.lastActiveTime=Date.now(),!0===this.autoHide&&t.FApp.registerIdleCallback(this.idleCheck,!0),this._slider.hidden&&this._slider.updateByCfg({hidden:!1})),!1):(this._slider.hidden&&this._slider.updateByCfg({hidden:!1}),!1)},r.prototype._sliderCfg=function(){return console.error("implement this in derive class"),{}},r}(t.FWidget),m=function(n){function r(e){var r=n.call(this,e)||this;return r._mouseY=0,r._gapScope.addListener(t.FEventType.MouseDown,(function(e){var t=e;return r._mouseY=t.y+t.target.y,r._status=o.Dragging,!1})),r._gapScope.addListener(t.FEventType.MouseMove,(function(e){if(0===e.nativeEvent.buttons&&(r._status=o.None),r._status===o.Dragging&&r.height>0){var t=e,n=t.y+t.target.y,i=n-r._mouseY;r._mouseY=n,i=i/r.height*r.scrollSize(),r.updateByCfg({value:i+r.value})}return!1})),r._gapScope.addListener(t.FEventType.MouseUp,(function(e){return r._status=o.None,!1})),r._gapScope.addListener(t.FEventType.PanStart,(function(e){e.srcEventPreventDefault();var t=e;return r._mouseY=t.deltaY,r._status=o.Dragging,!0})),r._gapScope.addListener(t.FEventType.PanMove,(function(e){if(r._status===o.Dragging&&r.width>0){e.srcEventPreventDefault();var t=e.deltaY,n=t-r._mouseY;r._mouseY=t,n=n/r.height*r.scrollSize(),r.updateByCfg({value:r.value+n})}return!1})),r._gapScope.addListener(t.FEventType.PanEnd,(function(e){return r._status=o.None,!0})),t.Bind.propBind(r._gapScope,"width",r._slider,"width",(function(e){return e+2*r.gap})),t.Bind.propBind(r._gapScope,"x",r._slider,"x",(function(e){return e-r.gap})),t.Bind.propBind(r._gapScope,"y",r._slider,"y"),t.Bind.propBind(r._gapScope,"height",r._slider,"height"),r}return i(r,n),r.prototype.mouseWheel=function(e){return this.updateByCfg({value:e.deltaY+this.value}),!1},r.prototype._defalutCfg=function(){var e=n.prototype._defalutCfg.call(this);return e.width=e.thick+2*e.gap,e},r.prototype._pickPos=function(e){return e.y},r.prototype.barSize=function(){return this.height},r.prototype._sliderCfg=function(){var t=0,n=0;t=this.autoHide?this.hovered?this.thick:this.thin:this.thick;var r=this.hovered&&this.hoverColor?this.hoverColor:this.color;return n=this.snapSide===e.ScrollSnapSide.Inside?this.width-t-this.gap:this.gap,{width:t,height:this.slideSize(),x:n,y:this.pos2View(),radius:t/2,background:r}},r}(y),E=function(n){function r(e){var r=n.call(this,e)||this;return r._mouseX=0,r._gapScope.addListener(t.FEventType.MouseDown,(function(e){var t=e;return r._mouseX=t.x+t.target.x,r._status=o.Dragging,!0})),r._gapScope.addListener(t.FEventType.MouseMove,(function(e){if(0===e.nativeEvent.buttons&&(r._status=o.None),r._status===o.Dragging&&r.width>0){var t=e,n=t.x+t.target.x,i=n-r._mouseX;r._mouseX=n,i=i/r.width*r.scrollSize(),r.updateByCfg({value:r.value+i})}return!1})),r._gapScope.addListener(t.FEventType.MouseUp,(function(e){return r._status=o.None,!0})),r._gapScope.addListener(t.FEventType.PanStart,(function(e){e.srcEventPreventDefault();var t=e;return r._mouseX=t.deltaX,r._status=o.Dragging,!0})),r._gapScope.addListener(t.FEventType.PanMove,(function(e){if(r._status===o.Dragging&&r.width>0){e.srcEventPreventDefault();var t=e.deltaX,n=t-r._mouseX;r._mouseX=t,n=n/r.width*r.scrollSize(),r.updateByCfg({value:r.value+n})}return!1})),r._gapScope.addListener(t.FEventType.PanEnd,(function(e){return r._status=o.None,!0})),t.Bind.propBind(r._gapScope,"width",r._slider,"width"),t.Bind.propBind(r._gapScope,"x",r._slider,"x"),t.Bind.propBind(r._gapScope,"y",r._slider,"y",(function(e){return e-r.gap})),t.Bind.propBind(r._gapScope,"height",r._slider,"height",(function(e){return e+2*r.gap})),r}return i(r,n),r.prototype._defalutCfg=function(){var e=n.prototype._defalutCfg.call(this);return e.height=e.thick+2*e.gap,e},r.prototype.mouseWheel=function(e){return this.updateByCfg({value:this.value+e.deltaX}),!1},r.prototype._pickPos=function(e){return e.x},r.prototype.barSize=function(){return this.width},r.prototype._sliderCfg=function(){var t=0,n=0;n=this.autoHide?this.hovered?this.thick:this.thin:this.thick;var r=this.hovered&&this.hoverColor?this.hoverColor:this.color;return t=this.snapSide===e.ScrollSnapSide.Inside?this.height-n-this.gap:this.gap,{width:this.slideSize(),height:n,x:this.pos2View(),y:t,radius:n/2,background:r}},r}(y);function b(e){var t=0,n=0;return e.children().forEach((function(e){e.hidden||(n=Math.max(n,e.rect.y+e.rect.height),t=Math.max(t,e.rect.x+e.rect.width))})),{width:t,height:n}}e.FAutoScrollType=void 0,(f=e.FAutoScrollType||(e.FAutoScrollType={}))[f.HScroll=1]="HScroll",f[f.VScroll=2]="VScroll";var T,C=function(e){function t(t){return e.call(this,t)||this}return i(t,e),Object.defineProperty(t.prototype,"minHeight",{get:function(){return this._cfg.minHeight||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxHeight",{get:function(){return this._cfg.maxHeight||1/0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minWidth",{get:function(){return this._cfg.minWidth||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxWidth",{get:function(){return this._cfg.maxWidth||1/0},enumerable:!1,configurable:!0}),t.prototype.beforeChange=function(e){var t=e.changes,n=this.rect,r=t.minHeight,i=t.maxHeight,o=function(e){return e&&void 0!==e.current};if(void 0!==r||void 0!==i){var a=o(r)?r.current:this.minHeight,s=o(i)?i.current:this.maxHeight;this.updateByCfg({height:Math.min(Math.max(n.height,a),s)})}var u=t.minWidth,l=t.maxWidth;if(void 0!==u||void 0!==l){var c=o(u)?u.current:this.minWidth,h=o(l)?l.current:this.maxWidth;this.updateByCfg({width:Math.min(Math.max(n.height,c),h)})}},t.prototype.onChildChange=function(e,t){var n=b(this);n.height=Math.min(Math.max(n.height,this.minHeight),this.maxHeight),n.width=Math.min(Math.max(n.width,this.minWidth),this.maxWidth),this.updateByCfg({width:n.width,height:n.height})},t.prototype._defalutCfg=function(){var t=e.prototype._defalutCfg.call(this);return t.minHeight=0,t.maxHeight=1/0,t.minWidth=0,t.maxWidth=1/0,t},t}(t.FWidget),S=function(n){function r(t,r){var i=n.call(this,t)||this;return i.hscroll=null,i.vscroll=null,i.container=new C(i),n.prototype.addChild.call(i,i.container),r&e.FAutoScrollType.HScroll&&i.initHscroll(),r&e.FAutoScrollType.VScroll&&i.initVscroll(),i.addChild=i._addChild,i.removeChild=i._removeChild,i}return i(r,n),Object.defineProperty(r.prototype,"scrollTop",{get:function(){return this.vscroll?this.vscroll.value:0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"scrollLeft",{get:function(){return this.hscroll?this.hscroll.value:0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"scrollHeight",{get:function(){return this.container.height},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"scrollWidth",{get:function(){return this.container.width},enumerable:!1,configurable:!0}),r.prototype.scrollTo=function(e,t){this.vscroll&&this.vscroll.updateByCfg({value:t}),this.hscroll&&this.hscroll.updateByCfg({value:e})},r.prototype.mouseWheel=function(e){return this.vscroll&&this.vscroll.mouseWheel(e),this.hscroll&&this.hscroll.mouseWheel(e),!1},r.prototype.afterChange=function(e){var t=e.changes,n={};void 0!==t.height&&(n.minHeight=t.height.current),void 0!==t.width&&(n.minWidth=t.width.current),this.container.updateByCfg(n),this.vscroll&&this.vscroll.updateByCfg({hidden:this.container.rect.height<=this.rect.height}),this.hscroll&&this.hscroll.updateByCfg({hidden:this.container.rect.width<=this.rect.width})},r.prototype._addChild=function(e){this.container.addChild(e)},r.prototype._removeChild=function(e){this.container.removeChild(e)},r.prototype.initVscroll=function(){var e=this;this.vscroll=new m(this),n.prototype.addChild.call(this,this.vscroll),this.vscroll.updateByCfg({x:0,y:0,height:0,hidden:!0,zindex:1}),t.Bind.propBind(this.vscroll,"max",this.container,"height"),t.Bind.propBind(this.vscroll,"x",this,"width",(function(t){return t-e.vscroll.width})),t.Bind.propBind(this.vscroll,"height",this,"height"),t.Bind.propBind(this.vscroll,"page",this,"height"),t.Bind.propBind(this.container,"y",this.vscroll,"value",(function(e){return-e})),t.Bind.propBind(this.vscroll,"hidden",this.container,"height",(function(){return e.container.height<=e.height}))},r.prototype.initHscroll=function(){var e=this;this.hscroll=new E(this),n.prototype.addChild.call(this,this.hscroll),this.hscroll.updateByCfg({x:0,y:0,width:0,hidden:!0}),t.Bind.propBind(this.hscroll,"max",this.container,"width"),t.Bind.propBind(this.hscroll,"y",this,"height",(function(t){return t-e.hscroll.height})),t.Bind.propBind(this.hscroll,"width",this,"width"),t.Bind.propBind(this.hscroll,"page",this,"width"),t.Bind.propBind(this.container,"x",this.hscroll,"value",(function(e){return-e})),t.Bind.propBind(this.hscroll,"hidden",this.container,"width",(function(){return e.container.width<=e.width}))},r}(t.FWidget),w=function(){function e(e,t){this.row=e,this.col=t}return e}(),R=function(){function e(){}return e.hasImage=function(t){return e._images.has(t)},e.getImage=function(t){return e._images.get(t)},e.crateImage=function(t,n){e._images.set(t,n)},e.release=function(n){e.released.add(n),0===e.idleHandle&&(e.idleHandle=t.FApp.addIdleListener(e.gcCheck))},e.gcCheck=function(){e.released.size&&(e.released.forEach((function(t){0===t.refCount()&&e._images.delete(t.element().src)})),e.released.clear()),t.FApp.removeIdleListener(e.idleHandle),e.idleHandle=0},e._images=new Map,e.released=new Set,e.idleHandle=0,e}(),A=function(){function e(e,t){var n=this;this._isReady=!1,this._loaded=!1,this._ref=0,this._errorHandlers=[],this._loadedHandlers=[],this._onloaded=function(){n._isReady=!0,n._loaded=!0,n._loadedHandlers.forEach((function(e){return e()})),n._loadedHandlers.length=n._errorHandlers.length=0},this._onerror=function(e){n._isReady=!0,n._err=e,n._errorHandlers.forEach((function(t){return t(e)})),n._errorHandlers.length=n._loadedHandlers.length=0},this._img=new Image,this._listen(),void 0===t&&(t="anonymous"),t&&(this._img.crossOrigin=t),this._img.src=e,R.crateImage(e,this)}return e.newImage=function(t,n){var r;return R.hasImage(t)?(r=R.getImage(t),R.released.has(r)&&(r._listen(),R.released.delete(r))):(r=new e(t,n),R.crateImage(t,r)),r.addRef()},Object.defineProperty(e.prototype,"isReady",{get:function(){return this._isReady},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLoaded",{get:function(){return this._loaded},enumerable:!1,configurable:!0}),e.prototype.addRef=function(){return this._ref++,this},e.prototype.release=function(){0==--this._ref&&(this._errorHandlers.length=this._loadedHandlers.length=0,this._img.removeEventListener("load",this._onloaded),this._img.removeEventListener("error",this._onerror),R.release(this))},e.prototype.refCount=function(){return this._ref},e.prototype.element=function(){return this._img},e.prototype.onLoaded=function(e){this._isReady?this._loaded&&setTimeout((function(){return e()})):this._loadedHandlers.push(e)},e.prototype.onError=function(e){var t=this;this._isReady?this._loaded||setTimeout((function(){return e(t._err)})):this._errorHandlers.push(e)},e.prototype.offLoaded=function(e){for(var t=this._loadedHandlers.length;--t>=0;)if(this._loadedHandlers[t]===e)return this._loadedHandlers.splice(t,1),t;return-1},e.prototype.offError=function(e){for(var t=this._errorHandlers.length;--t>=0;)if(this._errorHandlers[t]===e)return this._errorHandlers.splice(t,1),t;return-1},e.prototype._listen=function(){this._img.addEventListener("load",this._onloaded),this._img.addEventListener("error",this._onerror)},e}(),O=function(){function e(e,t){this._ref=A.newImage(e,t)}return Object.defineProperty(e.prototype,"ref",{get:function(){return this._ref},enumerable:!1,configurable:!0}),e.prototype.onceLoaded=function(e){var t=this;if(this._ref.isReady)this._ref.onLoaded(e);else{var n,r=function(){return setTimeout((function(){t._ref.offError(r),t._ref.offLoaded(n)}))};n=function(){e(),r()},this._ref.onLoaded(n),this._ref.onError(r)}},e.prototype.onceError=function(e){var t=this;if(this._ref.isReady)this._ref.onError(e);else{var n,r=function(){return setTimeout((function(){t._ref.offLoaded(r),t._ref.offError(n)}))};n=function(t){e(t),r()},this._ref.onLoaded(r),this._ref.onError(n)}},e.prototype.width=function(){return this._ref.element().width},e.prototype.height=function(){return this._ref.element().height},e.prototype.release=function(){this._ref.release()},e.prototype.element=function(){return this._ref.element()},e.prototype.isReady=function(){return this._ref.isReady},e.prototype.isLoaded=function(){return this._ref.isLoaded},e.prototype.imgUrl=function(){return this._ref.element().src},e}();e.FDocCustomEvent=void 0,(T=e.FDocCustomEvent||(e.FDocCustomEvent={}))[T.MarkDirty=t.CustomEventStart]="MarkDirty";var M,k,I=function(t){function n(n,r){var i=t.call(this,e.FDocCustomEvent.MarkDirty,n)||this;return i._area=r.clone(),i}return i(n,t),n.prototype.dirtyArea=function(){return this._area},n}(t.FEvent),x=function(){function e(){this._info=new Map}return e.prototype.setData=function(e,t,n){var r=this._info.get(e);void 0===r&&(r=new Map,this._info.set(e,r)),r.set(t,n)},e.prototype.getData=function(e,t){var n=this._info.get(e);if(void 0!==n)return n.get(t)},e.prototype.each=function(e){this._info.forEach((function(t,n){t.forEach((function(t,r){return e(n,r,t)}))}))},e}(),N=function(){function e(e,t,n,r){void 0===n&&(n=[]),this.name=e,this.iterCreator=t,this._ctxKeys=n,this._isEmptyLayer=r,this._measure=null,this._valToKey=null,this._keyToPos=null,this._enabled=!0}return e.prototype.isEmptyLayer=function(){return!!this._isEmptyLayer&&this._isEmptyLayer()},e.prototype.disabled=function(){this._enabled=!1},e.prototype.enabled=function(){this._enabled=!0},e.prototype.isEnabled=function(){return this._enabled},e.prototype.setValToKey=function(e){this._valToKey=e},e.prototype.setKeyToPos=function(e){this._keyToPos=e},e.prototype.ctxKeys=function(){return this._ctxKeys},e.prototype.setMeasurer=function(e){this._measure=e},e.prototype.event=function(e){return!1},e.prototype.reset=function(){},e.prototype.destroy=function(){},e.prototype.fvgNode=function(e,t,n){return[]},e.prototype.render=function(e,t,n,r,i){},e.prototype.updateViewRect=function(e,t,n,r){},e.prototype.recChg=function(e){if(null===this.iterCreator||null===this._valToKey)return[];var n,r=e.x,i=e.y,o=e.maxX,a=e.maxY,s=new t.FPoint(r,i),u=new t.FPoint(o,a),l=this._measure.docPos2Cell(s),c=this._measure.docPos2Cell(u),d=this.iterCreator(l.row,l.col,c.row,c.col),f=[],p=function(){if(null!==(n=d.next())){var e=h(n,2),t=e[0],r=e[1],i=r.row,o=r.col,a=v._valToKey(t,{row:i,col:o});f.find((function(e){return e.pos===a.pos}))||f.push(a)}},v=this;do{p()}while(null!==n);return f},e.prototype.chgRect=function(e){var t=this,n=[];return null!==this._keyToPos&&e.forEach((function(e){n.push(t._keyToPos(e))})),n},e}(),P=function(){function e(){}return e.prototype.cell2DocPos=function(e,n){var r=this.measureWidth(0,n),i=this.measureHeight(0,e);return new t.FPoint(r,i)},e.prototype.docPos2Cell=function(e){return{col:this.measureCol(e.x),row:this.measureRow(e.y)}},e}(),L=function(e){function n(n,r,i){var o=e.call(this,n)||this;return o._measurer=r,o.iterCtxFn=i,o._layersWithZIndex=new Array,o._layers=[],o._renderCtx=new Map,o._padding=0,o._emptySpace=0,o._prevRecChgs=null,o._lastRowColRect=new t.FRect,o._lastViewRect=new t.FRect,o._reuseChildMgr=new t.ReuseChildManager(o),o.markDirtyRect=function(e){t.ListenersControl.sendEvent(o,new I(o,e))},o}return i(n,e),n.prototype.ctx=function(){return this._renderCtx},n.prototype.getPadding=function(){return this._padding},n.prototype.setPadding=function(e){this._padding=e},n.prototype.getEmptySpace=function(){return this._emptySpace},n.prototype.setEmptySpace=function(e){this._emptySpace=e},n.prototype.dangerousRemoveAllChild=function(){e.prototype.removeAllChild.call(this)},n.prototype.reuseChild=function(e,t,n){return this._reuseChildMgr.useWidget(e,t,n)},n.prototype.reset=function(){this._lastRowColRect.reset(),this._lastViewRect.reset(),this._reuseChildMgr.recycle(),this._layers.forEach((function(e){return e.reset()}))},n.prototype.measurer=function(){return this._measurer},n.prototype.addLayer=function(e,t){void 0===t&&(t=0),e.setMeasurer(this._measurer);for(var n=this._layersWithZIndex.length-1;n>-1&&!(this._layersWithZIndex[n].zIndex<=t);)n--;this._layersWithZIndex.splice(n+1,0,{zIndex:t,layer:e}),this._layers=this._layersWithZIndex.map((function(e){return e.layer}))},n.prototype.removeLayer=function(e){this._layersWithZIndex=this._layersWithZIndex.filter((function(t){return t.layer!==e})),this._layers=this._layersWithZIndex.map((function(e){return e.layer}))},n.prototype.updateViewRect=function(e){var t=this;if(!e.isEmpty()){var n,r=this.viewRect2RowColRect(e),i=this.rowColRect2ViewRect(r);if(this.iterCtxFn){var o=r.sub(this._lastRowColRect);n=this.iterCtxFn(o)}this._renderCtx.clear(),this._layers.forEach((function(e){e.ctxKeys().forEach((function(e){return t._renderCtx.set(e,new x)}))})),this._layers.forEach((function(o){!1!==o.isEnabled()&&(o.isEmptyLayer()||o.updateViewRect(e,t._renderCtx,t,{newRowColRect:r,newViewRect:i,lastRowColRect:t._lastRowColRect,lastViewRect:t._lastViewRect,iterCtx:n}))})),this._reuseChildMgr.clear(),this.updateByCfg(this.docSize()),this._lastViewRect=i,this._lastRowColRect=r}},n.prototype.recChg=function(e){var t=[],n=null;return this._layers.forEach((function(n){var r=n.recChg(e);t.push.apply(t,d([],h(r),!1))})),null!==this._prevRecChgs&&(n=this._chgDiff(this._prevRecChgs,t)),this._prevRecChgs=t,n},n.prototype.chgRect=function(e){var t=[];return this._layers.forEach((function(n){var r=n.chgRect(e);t.push.apply(t,d([],h(r),!1))})),t},n.prototype.docSize=function(){var e=this._measurer.size(),n=e.width,r=e.height,i=h(t.QuaterSplit(this._padding,0),4),o=i[0],a=i[1],s=i[2],u=i[3],l=h(t.QuaterSplit(this._emptySpace,0),4),c=l[0],d=l[1],f=l[2];return{width:n+=a+u+d+l[3],height:r+=o+s+c+f}},n.prototype.docContentRect=function(){var e=this._measurer.size(),n=e.width,r=e.height,i=t.QuaterSplit(this._padding,0),o=h(t.QuaterSplit(this._emptySpace,0),4),a=o[0],s=o[1],u=o[2];n+=s+o[3],r+=a+u;var l=i[0],c=i[3];return new t.FRect(c,l,n,r)},n.prototype.event=function(t){for(var n=this._layers.length-1;n>=0;--n){var r=this._layers[n].event(t);if(r)return r}return e.prototype.event.call(this,t)},n.prototype.renderWidget=function(n,r){var i=this;e.prototype.renderWidget.call(this,n,r);var o=this.pCfg||this._cfg;n.save();var a=o.x,s=o.y,u=this.docContentRect(),l=r.clone().move(-a,-s);n.translate(a+u.x,s+u.y),l.intersectRect(u),l.move(-u.x,-u.y);var c,h=this.area2Range(l);this.iterCtxFn&&(c=this.iterCtxFn([h])),this._layers.forEach((function(e){!1!==e.isEnabled()&&(e.isEmptyLayer()||(i.event(new t.FLayerRenderEvent(t.FEventType.BeforeLayerRender,i,e.name)),e.render(n,l.clone(),i._renderCtx,i,{renderRange:h,iterCtx:c}),i.event(new t.FLayerRenderEvent(t.FEventType.AfterLayerRender,i,e.name))))})),n.restore()},n.prototype.viewRect2RowColRect=function(e){var n=this._measurer,r=n.measureRow(e.y),i=n.measureCol(e.x),o=n.measureRow(e.maxY),a=n.measureCol(e.maxX),s=n.cell2DocPos(o,a);return s.y===e.maxY&&(o-=1),s.x===e.maxX&&(a-=1),new t.FRect(i,r,a-i+1,o-r+1)},n.prototype.rowColRect2ViewRect=function(e){var n=this._measurer,r=n.cell2DocPos(e.y,e.x),i=n.measureWidth(e.x,e.maxX),o=n.measureHeight(e.y,e.maxY);return new t.FRect(r.x,r.y,i,o)},n.prototype.area2Range=function(e){var n=new t.FPoint(e.x,e.y),r=new t.FPoint(e.x+e.width-1,e.y+e.height-1),i=this._measurer.docPos2Cell(n),o=this._measurer.docPos2Cell(r);return new t.FRect(i.col,i.row,o.col-i.col+1,o.row-i.row+1)},n.prototype._chgDiff=function(e,t){for(var n={dels:[],adds:[],moves:[],keeps:[]},r=0,i=0,o=e.length,a=t.length;r<o&&i<a;)e[r].pos<t[i].pos?(n.dels.push(e[r]),r++):e[r].pos>t[i].pos?(n.adds.push(t[i]),i++):(r!==i?n.moves.push({before:e[r],current:t[i]}):n.keeps.push(e[r]),r++,i++);for(;r<o;)n.dels.push(e[r]),r++;for(;i<a;)n.adds.push(t[i]),i++;return n},n.prototype.markChildDirty=function(){this._dirtyList(t.WidgetProps.ChildDirty)},n.prototype.destroy=function(){this._reuseChildMgr.clear(),e.prototype.destroy.call(this),this._layers.forEach((function(e){return e.destroy()})),this._layers=[],this._layersWithZIndex=[]},n.prototype.fvgNode=function(){var n={type:t.WidgetType.widget,cfg:e.prototype.fvgNode.call(this).cfg,children:[]},r=new Map(this._renderCtx),i=this.parent(),o=i.paintedRect().move(-i.x,-i.y),a=i.parent();if(null!==a){var s=a.paintedRect();o.intersectRect(new t.FRect(-i.x,-i.y,s.width,s.height)),o.move(-this.x,-this.y);var u=this.area2Range(o);this._layers.forEach((function(e){var t=e.fvgNode(o,r,u);t.length>0&&(n.children=n.children.concat(t))}))}return n},n}(t.FWidget),D=Math.tan(30*Math.PI/180),F=1/D;e.IAnimDirection=void 0,(k=e.IAnimDirection||(e.IAnimDirection={}))[k.Horizontal=0]="Horizontal",k[k.Vertical=1]="Vertical",e.FPosAction=void 0,(M=e.FPosAction||(e.FPosAction={}))[M.auto=0]="auto",M[M.none=1]="none",M[M.x=2]="x",M[M.y=3]="y";var B=function(e){function t(){return e.call(this,document.createElement("canvas"),!1,!0)||this}return i(t,e),t.prototype.resize=function(t,n){(t>this._width||n>this._height)&&(t=Math.max(t,this._width),n=Math.max(n,this._height),e.prototype.resize.call(this,t,n))},t}(t.FCanvas),V=function(r){function o(n,i,o){var a=r.call(this,n)||this;return a._bufferedArea=new t.FRect,a._bufferScreen=null,a._swapScreen=null,a._bufferZone=100,a._bufferWnd=new t.FRect,a._dirtyBuffer=new t.FRect,a._startPanAnchor=new t.FPoint(0,0),a._panDirection="x",a.animateId=0,a._ignoreBuffer=!1,a._useSwap=!0,a._oDocScreen=null,a._nDocScreen=null,a._isAnimating=!1,a.xEnabled=!0,a.yEnabled=!0,a._doc=new L(a,i,o),t.Bind.propBind(a._doc,"x",a,"posX",(function(e){return-e})),t.Bind.propBind(a._doc,"y",a,"posY",(function(e){return-e})),t.Bind.propBind(a,"posX",a._doc,"x",(function(e){return-e})),t.Bind.propBind(a,"posY",a._doc,"y",(function(e){return-e})),a._doc.addListener(e.FDocCustomEvent.MarkDirty,(function(e){var t=e.dirtyArea().intersectRect(a._bufferedArea);return a._dirtyBuffer.union(t),!1})),a.addEventFilter((function(e){return e.type===t.FEventType.Tap&&a._stopInertia()})),a}return i(o,r),o.createSwapScreen=function(){return this._swapCount++,this._swapScreen||(this._swapScreen=new B,this._swapScreen.ctx().setTransform(1,0,0,1,0,0),document.addEventListener("visibilitychange",this._onVisibilityChange)),this._swapScreen},o.destroySwapScreen=function(){this._swapCount--,0===this._swapCount&&this._swapScreen&&(this._swapScreen.destroy(),this._swapScreen=null,document.removeEventListener("visibilitychange",this._onVisibilityChange))},o._onVisibilityChange=function(){document.visibilityState===t.VisibilityState.Hidden?o._swapScreen&&o._swapScreen.suspend():o._swapScreen&&o._swapScreen.wakeup()},Object.defineProperty(o.prototype,"posY",{get:function(){return void 0!==this._cfg.posY?this._cfg.posY:this.minPosY},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"posX",{get:function(){return void 0!==this._cfg.posX?this._cfg.posX:this.minPosX},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"doc",{get:function(){return this._doc},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"minPosX",{get:function(){return void 0!==this._cfg.minPosX?this._cfg.minPosX:0},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"minPosY",{get:function(){return void 0!==this._cfg.minPosY?this._cfg.minPosY:0},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"maxPosX",{get:function(){return void 0!==this._cfg.maxPosX?this._cfg.maxPosX:this.docSize().width-this.width},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"maxPosY",{get:function(){return void 0!==this._cfg.maxPosY?this._cfg.maxPosY:this.docSize().height-this.height},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"posAction",{get:function(){return this._cfg.posAction||e.FPosAction.auto},enumerable:!1,configurable:!0}),o.prototype.addLayer=function(e,t){this._doc.addLayer(e,t)},o.prototype.removeLayer=function(e){this._doc.removeLayer(e)},o.prototype.measurer=function(){return this._doc.measurer()},o.prototype.doc2View=function(e){return e.move(-this.posX,-this.posY),e},o.prototype.view2Doc=function(e){return e.move(this.posX,this.posY),e},o.prototype.cell2DocPos=function(e){return this._doc.measurer().cell2DocPos(e.row,e.col)},o.prototype.docPos2Cell=function(e){return this._doc.measurer().docPos2Cell(e)},o.prototype.cell2ViewPos=function(e){return this.doc2View(this.cell2DocPos(e))},o.prototype.viewPos2Cell=function(e){return this.docPos2Cell(this.view2Doc(e))},o.prototype.panStart=function(e){this._stopInertia();var n=this._validX(e.deltaX),r=this._validY(e.deltaY);return Math.abs(n)>=Math.abs(r)?this._panDirection="x":this._panDirection="y",this._startPanAnchor=new t.FPoint(0,0),this.panMove(e)},o.prototype.panMove=function(e){var n=this._startPanAnchor,r=this._validX(n.x-e.deltaX),i=this._validY(n.y-e.deltaY),o=this,a=o.posX,s=o.posY;return("x"===this._panDirection?a<=this.minPosX&&r<0||a>=this.maxPosX&&r>0:s<=this.minPosY&&i<0||s>=this.maxPosY&&i>0)||(this._wheelStep(r,i),e.srcEventPreventDefault()),this._startPanAnchor=new t.FPoint(e.deltaX,e.deltaY),!1},o.prototype.panEnd=function(e){return this._startPanAnchor=new t.FPoint(0,0),!1},o.prototype.swipe=function(e){var t=this._validX(e.velocityX),n=this._validY(e.velocityY);if(0===t&&0===n)return!1;var r=Math.abs(n)/Math.abs(t);return r>F?t=0:r<D&&(n=0),0===n||this.yEnabled||(n=0),0===t||this.xEnabled||(t=0),this.inertia(Date.now(),t,n),!1},o.prototype.inertia=function(e,n,r){var i=this,o=.95;this._stopInertia(),this.animateId=t.FApp.addIdleListener((function(){var t=Date.now(),a=t-e,s=!0,u=Math.pow(o,a/16),l=u*n,c=u*r,h=0,d=0;Math.abs(l)>.05&&(s=!1,h=(n+l)/2*a),Math.abs(c)>.05&&(s=!1,d=(r+c)/2*a),i._wheelStep(-h,-d),s?i._abortInertia():(e=t,n=l,r=c)}))},o.prototype.mouseWheel=function(e){return e.shiftKey&&e.deltaY&&(e.deltaX=e.deltaY,e.deltaY=0),this._wheelStep(e.deltaX,e.deltaY),!1},o.prototype.reset=function(){this._doc.reset(),this._bufferedArea.reset(),this._bufferWnd.reset(),this._dirtyBuffer.reset();var e=this._bufferScreen;if(null!==e)if(this._useSwap)e.ctx().clearRect(0,0,e.width(),e.height());else{var t=e.ctx(),n=t.getTransform();t.setTransform(1,0,0,1,0,0),this.clearRect(t,0,0,e.width(),e.height()),t.setTransform(n.a,n.b,n.c,n.d,n.e,n.f)}this.detectLifetimeOnce()},o.prototype.clearRect=function(e,n,r,i,o){var a=e.fillStyle,s=e.fillType;e.beginPath(),e.rect(n,r,i,o),e.fillStyle=t.convertThemeColor(this,this._cfg.bufferBackground||"#fff",t.ColorThemeType.Background),e.fillType=t.ColorThemeType.Background,e.fill(),e.closePath(),e.fillStyle=a,e.fillType=s},o.prototype.docSize=function(){return this._doc.docSize()},o.prototype.paint=function(e,t){if(!this._isAnimating){e.save(),e.beginPath();var i=this.paintedRect();n.preciseRect(e,i),e.clip(),r.prototype.paint.call(this,e,t),e.restore()}},o.prototype.renderWidget=function(e,n){var i=this;if(r.prototype.renderWidget.call(this,e,n),this._needBuff()){this._buffScreenReady(e),this._fixBuffer();var o=this._bufferWnd,a=this._cfg,s=a.x,u=a.y,l=a.posX,c=a.posY,h=this._bufferScreen,d=h.ctx();if(!this._bufferedArea.equal(o)){var f=o.sub(this._bufferedArea);d.save(),d.translate(l-o.x,c-o.y),f.forEach((function(e){e.move(-l,-c),i._doc.paint(d,e)})),d.restore(),this._bufferedArea=o.clone()}var p=n.clone().move(-s,-u);p.move(l,c).intersectRect(o);var v=this._buffMatrix();if(v){var g=p.move(-o.x,-o.y);v.mapRect(g).rounds(),g.isEmpty()||((n=n.clone()).intersectRect(this._doc.rect.move(s,u)),t.transformMatrix(e).mapRect(n).rounds(),n.width=g.width,n.height=g.height,e.save(),e.setTransform(1,0,0,1,0,0),e.drawImage(h.element(),g.x,g.y,g.width,g.height,n.x,n.y,n.width,n.height),e.restore())}}},o.prototype.destroy=function(){r.prototype.destroy.call(this),this._bufferScreen&&(t.FCanvasPool.backCanvas(this._bufferScreen),this._bufferScreen=null),this._swapScreen&&(o.destroySwapScreen(),this._swapScreen=null),this._oDocScreen&&(t.FCanvasPool.backCanvas(this._oDocScreen),this._oDocScreen=null),this._nDocScreen&&(t.FCanvasPool.backCanvas(this._nDocScreen),this._nDocScreen=null)},o.prototype._isChildNeedPaint=function(e,t){return(e!==this._doc||!this._needBuff())&&r.prototype._isChildNeedPaint.call(this,e,t)},o.prototype.afterFlush=function(e){("width"in e.changes||"height"in e.changes)&&(this._bufferedArea.reset(),this._bufferWnd.reset());var n=e.changes;if(2===Object.keys(n).length&&n.docHeight&&n.docWidth){var r=h(this.validatePos(this.posX,this.posY),2),i=r[0],o=r[1],a={};return i!==this.posX&&Object.assign(a,{posX:i}),o!==this.posY&&Object.assign(a,{posY:o}),void this.updateByCfg(a)}var s=this.rect.move(-this.x,-this.y);s.move(this.posX,this.posY),this._letBuffWndContain(s),this._doc.updateViewRect(this._bufferWnd),this._bufferWnd.intersectRect(new t.FRect(0,0,this._doc.width,this._doc.height)),this._bufferWnd.isEmpty()&&this._bufferWnd.reset();var u=this._buffMatrix();u&&u.roundRect(this._bufferWnd);var l=this.docSize();this.updateByCfg({docHeight:l.height,docWidth:l.width})},o.prototype.beforeChange=function(e){var n=e.changes.posX,r=e.changes.posY;if(n||r){var i=n?n.current:this.posX,o=r?r.current:this.posY,a=h(this.validatePos(i,o),2),s=a[0],u=a[1];n&&(n.current=s),r&&(r.current=u)}var l=this._buffMatrix();if(l){if(e.changes.x||e.changes.y){var c=e.changes.x?e.changes.x.current:this.x,d=e.changes.y?e.changes.y.current:this.y,f=l.roundPoint(new t.FPoint(c,d));e.changes.x&&(e.changes.x.current=f.x),e.changes.y&&(e.changes.y.current=f.y)}if(e.changes.width||e.changes.height){var p=e.changes.width?e.changes.width.current:this.width,v=e.changes.height?e.changes.height.current:this.height;f=l.roundPoint(new t.FPoint(p,v)),e.changes.width&&(e.changes.width.current=f.x),e.changes.height&&(e.changes.height.current=f.y)}}return!1},o.prototype.validatePos=function(e,t){return[Math.max(this.minPosX,Math.min(this.maxPosX,e)),Math.max(this.minPosY,Math.min(this.maxPosY,t))]},o.prototype._fixBuffer=function(){var e=this._dirtyBuffer;if(!e.isEmpty()){var r=this._cfg,i=r.posX,o=r.posY,a=this._bufferWnd,s=this._bufferScreen.ctx();if(s.save(),s.translate(-a.x,-a.y),this._useSwap){var u=t.Faster.findFaster(this),l=u?u.defaultBackground:void 0;null!=l?(s.beginPath(),s.fillStyle=l,n.preciseRect(s,e),s.fill()):n.preciseClearRect(s,e)}else this.clearRect(s,e.x,e.y,e.width,e.height);s.translate(i,o),e.move(-i,-o),this._doc.paint(s,e),s.restore(),e.reset()}},o.prototype._wheelStep=function(e,n){e=this._validX(e),n=this._validY(n);var r=this.mapToGlobal(new t.FPoint(0,0)),i=this.mapToGlobal(new t.FPoint(1,1));e/=Math.abs(i.x-r.x),n/=Math.abs(i.y-r.y);var o=this._wheelValidStep(e),a=this._wheelValidStep(n),s=this.posX+o,u=this.posY+a;this.updateByCfg({posY:this.yEnabled?u:this.posY,posX:this.xEnabled?s:this.posX}),this._isReachEdge(s,u)&&this._stopInertia()},o.prototype._stopInertia=function(){return 0!==this.animateId&&(this._abortInertia(),!0)},o.prototype._abortInertia=function(){t.FApp.removeIdleListener(this.animateId),this.animateId=0},o.prototype._wheelValidStep=function(e){var t=.7*this._bufferZone;return e>t?t:e<-t?-t:e},o.prototype._validX=function(t){var n=this.posAction;return n!==e.FPosAction.none&&n!==e.FPosAction.y||(t=0),t},o.prototype._validY=function(t){var n=this.posAction;return n!==e.FPosAction.none&&n!==e.FPosAction.x||(t=0),t},o.prototype._isReachEdge=function(e,t){var n=e!==this.posX,r=t!==this.posY;return n&&r},o.prototype._letBuffWndContain=function(e){var t=this._bufferWnd;if(!t.containRect(e)){var n=this._bufferZone;e.maxX>t.maxX?(t.x=e.x,t.width=e.maxX+n-e.x):e.x<t.x&&(t.x=Math.max(e.x-n,0),t.width=e.maxX+n-e.x),e.maxY>t.maxY?(t.y=e.y,t.height=e.maxY+n-e.y):e.y<t.y&&(t.y=Math.max(e.y-n,0),t.height=e.maxY+n-e.y);var r=this._buffMatrix();r&&r.roundRect(this._bufferWnd)}},o.prototype.doublicationOffScreenToBuffWnd=function(e){var n=this,r=this._bufferedArea,i=this._bufferWnd;if(r.x!==i.x||r.y!==i.y){var o=this._bufferScreen,a=o.ctx(),s=new t.FPoint(e.x-r.x,e.y-r.y),u=new t.FRect(e.x-i.x,e.y-i.y,e.width,e.height),l=a.getTransform(),c=new t.TMatrix(l.a,l.b,l.c,l.d,l.e,l.f);if(c.mapPoint(s),c.mapRect(u),this._useSwap){var h=this._swapScreen.ctx();this._swapScreen.clear(),h.drawImage(o.element(),s.x,s.y,u.width,u.height,u.x,u.y,u.width,u.height),o.clear(),a.save(),a.setTransform(1,0,0,1,0,0),a.drawImage(this._swapScreen.element(),u.x,u.y,u.width,u.height,u.x,u.y,u.width,u.height),a.restore()}else a.save(),a.setTransform(1,0,0,1,0,0),a.drawImage(o.element(),s.x,s.y,u.width,u.height,u.x,u.y,u.width,u.height),new t.FRect(0,0,o.width(),o.height()).sub(u).forEach((function(e){n.clearRect(a,e.x,e.y,e.width,e.height)})),a.restore()}},o.prototype._pickReusefulArea=function(){var e=this._bufferedArea.clone().intersectRect(this._bufferWnd);if(e.isEmpty())if(this._bufferedArea.reset(),this._useSwap)this._bufferScreen.clear();else{var t=this._bufferScreen,n=t.ctx();n.save(),n.setTransform(1,0,0,1,0,0),this.clearRect(n,0,0,t.width(),t.height()),n.restore()}else this.doublicationOffScreenToBuffWnd(e),this._bufferedArea=e},o.prototype._buffScreenReady=function(e){var n=this;if(null===this._bufferScreen){var r=t.Faster.findFaster(this);this._bufferScreen=t.FCanvasPool.borrowCanvas(r,void 0,!1),this._bufferScreen.fakeHide(),this._bufferScreen.registerNotify((function(e){e!==t.FCanvasNotify.Suspend&&e!==t.FCanvasNotify.Wakeup||n.clearBufferCanvas()}))}this._useSwap&&null===this._swapScreen&&(this._swapScreen=o.createSwapScreen(),this._swapScreen.fakeHide()),this._bufferScreen.isSuspend()&&this._bufferScreen.wakeup(),this._useSwap&&this._swapScreen.isSuspend()&&this._swapScreen.wakeup();var i=e.getTransform();this._resizebuffScreen(i);var a=this._bufferScreen.ctx(),s=a.getTransform();s.a===i.a&&s.b===i.b&&s.c===i.c&&s.d===i.d||(this._bufferedArea.reset(),a.setTransform(i.a,i.b,i.c,i.d,s.e,s.f)),this._pickReusefulArea()},o.prototype._resizebuffScreen=function(e){var t=this._bufferScreen,n=this._bufferWnd,r=Math.round(n.width*e.a),i=Math.round(n.height*e.d);(r>t.width()||i>t.height())&&(t.resize(r,i),this._bufferedArea.reset(),this._useSwap&&this._swapScreen.resize(r,i))},o.prototype.setIgnoreBuffer=function(e){this._ignoreBuffer=e},o.prototype.disableSwapCanvas=function(){this._useSwap=!1,this._bufferedArea.reset(),this._swapScreen&&(o.destroySwapScreen(),this._swapScreen=null)},o.prototype.enableSwapCanvas=function(){this._useSwap=!0,this._bufferedArea.reset()},o.prototype._needBuff=function(){return!this._ignoreBuffer&&null===this._doc.pCfg&&(this._doc.height>this.height||this._doc.width>this.width)},o.prototype._buffMatrix=function(){if(this._bufferScreen){var e=this._bufferScreen.ctx().getTransform();return new t.TMatrix(e.a,0,0,e.d,0,0)}return null},o.prototype.clearBufferCanvas=function(){this._bufferScreen&&(t.FCanvasPool.backCanvas(this._bufferScreen),this._bufferScreen=null),this._bufferedArea.reset(),this._swapScreen&&(o.destroySwapScreen(),this._swapScreen=null)},o._swapScreen=null,o._swapCount=0,o}(t.FWidget),H=new Map,U=function(e){function r(n,r,i){var o=e.call(this,"compatibility_document",null,i)||this;return o._parent=n,o._model=null,o._rowsPos=new Map,o._colsPos=new Map,o._overCells=new Map,o._refToPull=new Map,o._cellWidgetPoll=[],o._removedCell=[],o._rowCompare=function(e,t){return e<t.row?-1:e>t.row?1:0},o._colCompare=function(e,t){return e<t.col?-1:e>t.col?1:0},o._dataInfo={loadRect:new t.FRect,cellRect:new t.FRect,cells:new t.SortedArray(o._rowCompare)},null!==r&&o.setModel(r),o}return i(r,e),r.prototype.setModel=function(e){if(this._model=e,this.reset(),this._cellWidgetPoll.length){var t=this._cellWidgetPoll[0],n=this._model.emptyCellWidget();t.constructor!==n.constructor&&(this._cellWidgetPoll.length=0),this._cellWidgetPoll.push(n)}this._parent.updateByCfg(this.docSize());var r=this._parent.findAncestor((function(e){return e instanceof V}));null!==r&&r.reset()},r.prototype.docSize=function(){if(this._model){var e=this._model.width(),t=this._model.height();return-1===e&&(e=this._hintWidth()),-1===t&&(t=this._hintHeight()),{width:e,height:t}}return{width:0,height:0}},r.prototype.reset=function(){var e=this;this._rowsPos.clear(),this._colsPos.clear(),this._dataInfo.cellRect.reset(),this._dataInfo.loadRect.reset();for(var t=this._dataInfo.cells.len(),n=0;n<t;n++)for(var r=this._dataInfo.cells.at(n),i=r.cells.len(),o=0;o<i;o++){var a=r.cells.at(o).info.content;null!==a&&this._removeCellWidget(a)}this._dataInfo.cells.clear(),this._overCells.forEach((function(t){return e._removeCellWidget(t)})),this._overCells.clear()},r.prototype.updateViewRect=function(e){var n=this;if(null!=this._model){var r=this.docSize();if(!(r.width<=0||r.height<=0||e.isEmpty())){var i=this._dataInfo.loadRect;if(!i.containRect(e)){var o=this._dataInfo.cellRect,a=this.measureRow(o.y,i.y,e.y-i.y),s=this.measureRow(o.maxY,i.maxY,e.maxY-i.maxY);s.pos<e.maxY&&this._model.hasRow(s.row)&&(s.pos+=this._model.rowHeight(s.row)[0],s.row+=1);var u=this.measureCol(o.x,i.x,e.x-i.x),l=this.measureCol(o.maxX,i.maxX,e.maxX-i.maxX);l.pos<e.maxX&&this._model.hasCol(l.col)&&(l.pos+=this._model.colWidth(l.col)[0],l.col+=1),this._dataInfo.loadRect=new t.FRect(u.pos,a.pos,l.pos-u.pos,s.pos-a.pos),o.y<a.row&&(this._cutRows(o.y,a.row),o.height=o.maxY-a.row,o.y=a.row),o.maxY>s.row&&(this._cutRows(s.row,o.maxY),o.height=s.row-o.y),o.x<u.col&&(this._cutCols(o.x,u.col),o.width=o.maxX-u.col,o.x=u.col),o.maxX>l.col&&(this._cutCols(l.col,o.maxX),o.width=l.col-o.x),a.row<o.maxY&&o.y<s.row?(a.row<o.y&&this._loadRows(a.row,o.y,a.pos),s.row>o.maxY&&this._loadRows(o.maxY,s.row,i.maxY)):this._loadRows(a.row,s.row,a.pos),o.y=a.row,o.height=s.row-a.row,u.col<o.maxX&&o.x<l.col?(u.col<o.x&&this._loadCols(u.col,o.x,u.pos),l.col>o.maxX&&this._loadCols(o.maxX,l.col,i.maxX)):this._loadCols(u.col,l.col,u.pos),o.x=u.col,o.width=l.col-u.col,this._overCells.forEach((function(e,t){e.rect.intersect(i)||(n._removedCell.push(e),n._overCells.delete(t))})),this._pullRefCells(),this._removedCell.forEach((function(e){return n._removeCellWidget(e)})),this._removedCell.length=0,this._parent.updateByCfg(this.docSize())}}}},r.prototype.cell2DocPos=function(e){var n=this.measureWidth(0,e.col),r=this.measureHeight(0,e.row);return new t.FPoint(n,r)},r.prototype.docPos2Cell=function(e){return{col:this.measureCol(0,0,e.x).col,row:this.measureRow(0,0,e.y).row}},r.prototype.measureCol=function(e,t,n){var r=0,i=e,o=this._model;if(n>0){for(;o.hasCol(i)&&r<n;){var a=h(o.colWidth(i),2),s=a[0],u=a[1],l=s*u;if(r+l>n){r+=s*(u=Math.floor((n-r)/s)),i+=u;break}r+=l,i+=u}return{col:i,pos:r+t}}for(;o.hasCol(i-1)&&r<-n;)r+=o.colWidth(i-1)[0],i-=1;return{col:i,pos:t-r}},r.prototype.measureRow=function(e,t,n){var r=0,i=e,o=this._model;if(n>0){for(;o.hasRow(i)&&r<n;){var a=h(o.rowHeight(i),2),s=a[0],u=a[1],l=s*u;if(r+l>n){r+=s*(u=Math.floor((n-r)/s)),i+=u;break}r+=l,i+=u}return{row:i,pos:r+t}}for(;o.hasRow(i-1)&&r<-n;)r+=o.rowHeight(i-1)[0],i-=1;return{row:i,pos:t-r}},r.prototype.measureWidth=function(e,t){for(var n=this._model,r=0;n.hasCol(e)&&e<t;){var i=h(n.colWidth(e),2),o=i[0],a=i[1],s=Math.min(a,t-e);r+=o*s,e+=s}return r},r.prototype.measureHeight=function(e,t){for(var n=this._model,r=0;n.hasRow(e)&&e<t;){var i=h(n.rowHeight(e),2),o=i[0],a=i[1],s=Math.min(a,t-e);r+=o*s,e+=s}return r},r.prototype.getResponsePattern=function(e,n,r){var i=r.repeat,o=t.FCanvasPool.borrowCanvas(null),a=n.element(),s=a.width,u=a.height;o.resize(s,u),o.ctx().drawImage(n.element(),0,0,s,u);var l=e.createPattern(o.element(),i||"repeat");return t.FCanvasPool.backCanvas(o),l},r.prototype.getCanvasPattern=function(e,n){var r=this,i=n.imgSrc,o=n.repeat,a=t.FCanvasPool.ratioX,s=t.FCanvasPool.ratioY,u="".concat(i,"_").concat(o,"_").concat(a,"_").concat(s),l=H.get(u);if(l instanceof CanvasPattern)return l;if("LOADING"===l)return null;var c=new O(i);if(c.isReady()){var h=this.getResponsePattern(e,c,n);return H.set(u,h),h}return c.onceLoaded((function(){var t=r.getResponsePattern(e,c,n);H.set(u,t);var i=r._parent.findAncestor((function(e){return e instanceof V}));i&&i.reset()})),H.set(u,"LOADING"),null},r.prototype.render=function(e,r,i){var o=this,a=function(e){o._iterCell((function(n,i,a){if(null===a.style)return!1;var s=o._rowsPos.get(n),u=o._colsPos.get(i),l=new t.FRect(u.pos,s.pos,u.width,s.height),c=r.clone().intersectRect(l);return c.isEmpty()||e(l,c,a.style),!1}))};e.save();var s=e.fillType,u=e.strokeType;e.fillType=t.ColorThemeType.Background,a((function(r,i,a){var s=a.background,u=a.pattern;if(void 0!==s&&(e.beginPath(),n.preciseRect(e,i),e.fillStyle!==s&&(e.fillStyle=s,"string"==typeof e.fillStyle&&(e.fillStyle=t.convertThemeColor(o._parent,e.fillStyle,t.ColorThemeType.Background))),e.fill()),u&&u.imgSrc){var l=o.getCanvasPattern(e,u);l&&(e.beginPath(),n.preciseRect(e,i),e.fillStyle=l,e.fill())}})),e.beginPath(),e.strokeType=t.ColorThemeType.Border,a((function(r,i,a){var s,u,l=function(r,i,a,s,u){u.width<=0&&u.color===c||(e.strokeStyle=t.convertThemeColor(o._parent,u.color,t.ColorThemeType.Border),e.lineWidth=u.width,n.preciseDrawLine(e,r,i,a,s))},c=a.background,d=a.border,f=a.borderBottom,p=a.borderLeft,v=a.borderRight,g=a.borderTop,_=h(t.QuaterSplit(d,{width:0,color:""},g,v,f,p),4),y=_[0],m=_[1],E=_[2],b=_[3],T=b.width,C=m.width,S=y.width,w=E.width,R=r.x,A=r.y,O=r.width,M=r.height;S>0&&((u=(s=new t.FRect(R,A,O,S)).intersectRect(s)).isEmpty()||l(u.x,A,u.x+u.width,A,y)),C>0&&((u=(s=new t.FRect(R+O-C,A,C,M)).intersectRect(s)).isEmpty()||l(u.x,u.y,u.x,u.y+u.height,m)),w>0&&((u=(s=new t.FRect(R,A+M-w,O,w)).intersectRect(s)).isEmpty()||l(u.x,u.y,u.x+u.width,u.y,E)),T>0&&((u=(s=new t.FRect(R,A,T,M)).intersectRect(s)).isEmpty()||l(R,u.y,R,u.y+u.height,b))})),e.fillType=s,e.strokeType=u,e.restore()},r.prototype._cutRows=function(e,t){var n=this._dataInfo.cells,r=n.ubound(e,!0);if(-1!==r){n.at(r).row<e&&++r;var i=n.lbound(t,!0);if(-1!==i){n.at(i).row<t&&++i;for(var o=r;o<i;o++)for(var a=n.at(o),s=a.cells.len(),u=0;u<s;u++){var l=a.cells.at(u);this._cutCell(a.row,l.col,l.info)}n.remove(r,i-r)}}},r.prototype._cutCols=function(e,t){for(var n=this._dataInfo.cells,r=0;r<n.len();r++){var i=n.at(r),o=i.cells.ubound(e,!0);if(-1!==o){i.cells.at(o).col<e&&++o;var a=i.cells.lbound(t,!0);if(-1!==a){i.cells.at(a).col<t&&++a;for(var s=o;s<a;s++){var u=i.cells.at(s);this._cutCell(i.row,u.col,u.info)}i.cells.remove(o,a-o)}}}},r.prototype._loadRows=function(e,n,r){for(var i=this._dataInfo.cellRect,o=i.x,a=i.maxX;e<n;){var s=h(this._model.rowHeight(e),2),u=s[0],l=s[1];if(0===u)if(0===e)l=1;else{if(this._model.hasRow(e+l)){e+=l;continue}e+=l-1,l=1}for(;l-- >0&&e<n;){var c=this._dataInfo.cells.find(e,!1),d=void 0;-1===c?(d={row:e,cells:new t.SortedArray(this._colCompare)},this._dataInfo.cells.insert(d,e),this._rowsPos.set(e,{pos:r,height:u})):d=this._dataInfo.cells.at(c);for(var f=o;f<a;f++){var p=this._colsPos.get(f);if(p){var v=this._cellInfo(p.pos,r,e,f);null!==v&&d.cells.insert({col:f,info:v},f)}}r+=u,++e}}},r.prototype._loadCols=function(e,t,n){for(;e<t;){var r=h(this._model.colWidth(e),2),i=r[0],o=r[1];if(0===i)if(0===e)o=1;else if(this._model.hasCol(e+o)){if(e+=o,this._model.hasCol(e))continue}else e+=o-1,o=1;for(;o-- >0&&e<t;){for(var a=this._dataInfo.cells.len(),s=0;s<a;s++){var u=this._dataInfo.cells.at(s),l=this._rowsPos.get(u.row).pos,c=this._cellInfo(n,l,u.row,e);null!==c&&u.cells.insert({col:e,info:c},e)}this._colsPos.has(e)||this._colsPos.set(e,{pos:n,width:i}),n+=i,++e}}},r.prototype._cutCell=function(e,t,n){var r=n.content;if(null!=r){var i=this._dataInfo.loadRect;r.rect.intersect(i)?this._overCells.set(this._cellHash(e,t),r):this._removedCell.push(r)}},r.prototype._cellInfo=function(e,t,n,r){var i=this,o=this._model,a=null;if(this._overCells.size>0){var s=this._cellHash(n,r);this._overCells.has(s)&&(a=this._overCells.get(s),this._overCells.delete(s))}var u,l=o.cellData(n,r);l instanceof w&&(l=[l]),l instanceof Array?(l.forEach((function(e){e instanceof w?i._refToPull.set(i._cellHash(e.row,e.col),e):null===a&&(u=e)})),u&&(a=this._cellWidget(e,t,u))):null===a&&null!==l&&(a=this._cellWidget(e,t,l));var c=o.cellStyle(n,r);return null===c&&null===a?null:{style:c,content:a}},r.prototype._hintWidth=function(){var e=this._dataInfo.cellRect.maxX;return this._model.hasCol(e+1)?this._dataInfo.loadRect.maxX+20:this._dataInfo.loadRect.maxX},r.prototype._hintHeight=function(){var e=this._dataInfo.cellRect.maxY;return this._model.hasRow(e+1)?this._dataInfo.loadRect.maxY+20:this._dataInfo.loadRect.maxY},r.prototype._cellHash=function(e,t){return"".concat(e,"_").concat(t)},r.prototype._pullRefCells=function(){var e=this;0!==this._refToPull.size&&(this._refToPull.forEach((function(t){return e._refCell(t)})),this._refToPull.clear())},r.prototype._refCell=function(e){var t=this;if(!this._cellLoaded(e.row,e.col)){var n=this._cellHash(e.row,e.col);if(this._overCells.has(n))return;var r=this._model.cellData(e.row,e.col);if(null===r)return;var i=function(r){var i=t._rowsPos.get(e.row);i||(i={pos:t.measureHeight(0,e.row),height:t._model.rowHeight(e.row)[0]},t._rowsPos.set(e.row,i));var o=t._colsPos.get(e.col);o||(o={pos:t.measureWidth(0,e.col),width:t._model.colWidth(e.col)[0]});var a=t._cellWidget(o.pos,i.pos,r);t._overCells.has(n)?console.error("{row: ".concat(e.row,", col: ").concat(e.col,"} already has a cell widget.")):t._overCells.set(n,a)};r instanceof w?this._refCell(e):r instanceof Array?r.forEach((function(e){e instanceof w?t._refCell(e):i(e)})):i(r)}},r.prototype._iterCell=function(e){for(var t=this._dataInfo.cells.len(),n=!1,r=0;r<t&&!n;r++)for(var i=this._dataInfo.cells.at(r),o=i.cells.len(),a=0;a<o&&!n;a++){var s=i.cells.at(a);n=e(i.row,s.col,s.info)}},r.prototype._cellWidget=function(e,t,n){var r=this._removedCell.pop();return r||(r=this._cellWidgetPoll.pop()||this._model.emptyCellWidget(),this._parent.addChild(r)),r.reuse(n),r.updateByCfg({x:e+r.x,y:t+r.y}),r},r.prototype._removeCellWidget=function(e){var t=this._parent.reuseChild(e);t.release(),t.setParent(null),this._cellWidgetPoll.push(t)},r.prototype._cellLoaded=function(e,n){var r=this._dataInfo,i=r.cellRect,o=r.cells;if(!i.containPoint(new t.FPoint(n,e)))return!1;var a=o.find(e,!1);return-1!==a&&-1!==o.at(a).cells.find(n,!1)},r.prototype.getCellWidget=function(e,t){var n=this._dataInfo.cells,r=n.find(e,!1);if(-1===r)return null;var i=n.at(r).cells,o=i.find(t,!1);return-1===o?null:i.at(o).info.content},r.prototype.destroy=function(){this._cellWidgetPoll.forEach((function(e){return e.destroy()})),this._removedCell.forEach((function(e){return e.destroy()})),this._cellWidgetPoll.length=0,this._removedCell.length=0},r}(N),Z=function(e){function t(t){var n=e.call(this)||this;return n._doc=t,n}return i(t,e),t.prototype.setDoc=function(e){this._doc=e},t.prototype.size=function(){return null===this._doc?{width:0,height:0}:this._doc.docSize()},t.prototype.measureCol=function(e){return this._doc.measureCol(0,0,e).col},t.prototype.measureRow=function(e){return this._doc.measureRow(0,0,e).row},t.prototype.measureWidth=function(e,t){return this._doc.measureWidth(e,t)},t.prototype.measureHeight=function(e,t){return this._doc.measureHeight(e,t)},t}(P),W=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype._beforeRender=function(e){},t.prototype._afterRender=function(e){},t.prototype.render=function(e,t,n,r,i){if(null!==this._measure){var o=this._area2Iter(i.renderRange,i.iterCtx);if(null!==o){var a;this._beforeRender(e);do{if(a=o.next()){var s=h(a,2),u=s[0],l=s[1],c=l.row,d=l.col;this._renderCell(e,u,c,d,n,r)}}while(null!==a);this._afterRender(e)}}},t.prototype._area2Iter=function(e,t){return null===this.iterCreator?null:this.iterCreator(e.y,e.x,e.maxY-1,e.maxX-1,t)},t.prototype._iterFVGNode=function(e,t,n,r){return null},t.prototype.fvgNode=function(e,t,n){var r=this._area2Iter(n),i=[];if(null===r)return i;for(var o=r.next();null!==o;o=r.next()){var a=h(o,2),s=a[0],u=a[1],l=u.row,c=u.col,d=this._iterFVGNode(s,l,c,t);null!==d&&i.push(d)}return i},t}(N);function j(e,n,r){var i=e.cell2DocPos(n,r),o=e.measureHeight(n,n+1),a=e.measureWidth(r,r+1);return new t.FRect(i.x,i.y,a,o)}var G,z=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t._patternsMap=new Map,t._fillRect=new n.ContinuouslyFillRect,t}return i(r,e),r.prototype._beforeRender=function(e){this._fillRect.start(e)},r.prototype._afterRender=function(e){this._fillRect.end(e)},r.prototype._renderCell=function(e,n,r,i,o,a){var s=j(this._measure,r,i);if("string"==typeof n){var u=e.fillType;e.fillType=t.ColorThemeType.Background,this._fillStyle(e,t.convertThemeColor(a,n,t.ColorThemeType.Background),s),e.fillType=u}else this._fillPattern(e,n,s,a)},r.prototype._fillStyle=function(e,t,n,r){this._fillRect.continueFillRect(e,n,t,r)},r.prototype._fillPattern=function(e,t,n,r){var i=this._getCanvasPattern(e,t,n,r);i&&this._fillRect.continueFillRect(e,n,i)},r.prototype._getResponsePattern=function(e,n,r){var i=r.repeat,o=t.FCanvasPool.borrowCanvas(null),a=n.element(),s=a.width,u=a.height;o.resize(s,u),o.ctx().drawImage(n.element(),0,0,s,u);var l=e.createPattern(o.element(),i||"repeat");return t.FCanvasPool.backCanvas(o),l},r.prototype._getCanvasPattern=function(e,n,r,i){var o=this,a=n.imgSrc,s=n.repeat,u=t.FCanvasPool.ratioX,l=t.FCanvasPool.ratioY,c="".concat(a,"_").concat(s,"_").concat(u,"_").concat(l),h=this._patternsMap.get(c);if(h instanceof CanvasPattern)return h;var d=new O(a);if(d.isLoaded()){var f=this._getResponsePattern(e,d,n);return this._patternsMap.set(c,f),d.release(),f}return d.onceLoaded((function(){var t=o._getResponsePattern(e,d,n);o._patternsMap.set(c,t),i.markChildDirty(),d.release()})),null},r.prototype._iterFVGNode=function(e,n,r){var i={type:t.WidgetType.widget,cfg:{}},o=j(this._measure,n,r);return Object.assign(i.cfg,o),"string"==typeof e&&(i.cfg.background=e),i},r.prototype.destroy=function(){e.prototype.destroy.call(this),this._patternsMap.clear()},r}(W),Y=function(e){function n(t,n,r,i){var o=e.call(this,t,r,i)||this;return o._parent=n,o._dataInfo={cells:new Map},o}return i(n,e),n.prototype.reset=function(){this._dataInfo.cells.clear()},n.prototype.updateViewRect=function(e,n,r,i){var o=this,a=i.lastRowColRect,s=i.lastViewRect,u=i.newRowColRect,l=i.newViewRect,c=this._measure;if(!s.containRect(l)){var d=u.sub(a);this._dataInfo.cells.forEach((function(e,n){n<u.y||u.maxY<=n?(e.forEach((function(e){o.removeWidgets(e)})),o._dataInfo.cells.delete(n)):e.forEach((function(r,i){if(i<u.x||u.maxX<=i)return o.removeWidgets(r),void e.delete(i);d.forEach((function(a){a.containPoint(new t.FPoint(i,n))&&(o.removeWidgets(r),e.delete(i))}))}))})),d.forEach((function(e){if(null!==o.iterCreator){var t,r=o.iterCreator(e.y,e.x,e.maxY-1,e.maxX-1,n,i);do{if(t=r.next()){var a=h(t,2),s=a[0],u=a[1],l=u.row,d=u.col,f=c.cell2DocPos(l,d);s=o._parent.reuseChild(s,s.x+f.x,s.y+f.y);var p=o._dataInfo.cells.get(l);p||(p=new Map,o._dataInfo.cells.set(l,p));var v=p.get(d);v||(v=[],p.set(d,v)),v.push(s)}}while(null!==t)}}))}},n.prototype.hasWidget=function(e,t){var n=this._dataInfo.cells.get(e);return!!n&&!!n.get(t)},n.prototype.removeWidgets=function(e){e.forEach((function(e){return e.destroy()}))},n}(N),X=function(){function e(e){this.idx=e}return e}(),K=function(e){function n(n,r){var i=e.call(this,n)||this,o=i._scrollModel2DocModel(r),a=new Z(null);return i._doc=new V(i,a),i._layer=new U(i._doc.doc,o),a.setDoc(i._layer),i._doc.addLayer(i._layer),null!==r&&i.setModel(r),t.Bind.propBind(i._doc,"width",i,"width"),t.Bind.propBind(i._doc,"height",i,"height"),i}return i(n,e),n.prototype.setModel=function(e){var t=this._scrollModel2DocModel(e);this._layer.setModel(t)},n.prototype.destroy=function(){e.prototype.destroy.call(this),this._doc.destroy(),this._layer.destroy()},n.prototype.doc=function(){return this._doc},n.prototype.c_layer=function(){return this._layer},n.prototype._scrollModel2DocModel=function(e){return console.error('"_scrollModel2DocModel" must be implementd in dirive class.'),{}},n}(t.FWidget),q=function(){function e(e,t){this._view=e,this._model=t}return e.prototype.height=function(){return this._model.sumSize()},e.prototype.width=function(){return this._view.width},e.prototype.rowHeight=function(e){return this._model.blockSize(e)},e.prototype.colWidth=function(e){return[this._view.width,1]},e.prototype.hasRow=function(e){return this._model.has(e)},e.prototype.hasCol=function(e){return 0===e},e.prototype.rowStyle=function(e){return null},e.prototype.colStyle=function(e){return null},e.prototype.cellStyle=function(e,t){return this._model.blockStyle(e)},e.prototype.cellData=function(e,t){var n=this._model.blockData(e);return n instanceof X&&(n=[n]),n instanceof Array?n.map((function(e){return e instanceof X?new w(e.idx,t):e})):n},e.prototype.emptyCellWidget=function(){return this._model.emptyBlockWidget()},e}(),$=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype._scrollModel2DocModel=function(e){return new q(this,e)},t}(K),J=function(){function e(e,t){this._view=e,this._model=t}return e.prototype.height=function(){return this._view.height},e.prototype.width=function(){return this._model.sumSize()},e.prototype.rowHeight=function(e){return[this._view.height,1]},e.prototype.colWidth=function(e){return this._model.blockSize(e)},e.prototype.hasRow=function(e){return 0===e},e.prototype.hasCol=function(e){return this._model.has(e)},e.prototype.rowStyle=function(e){return null},e.prototype.colStyle=function(e){return null},e.prototype.cellStyle=function(e,t){return this._model.blockStyle(t)},e.prototype.cellData=function(e,t){var n=this._model.blockData(t);return n instanceof X&&(n=[n]),n instanceof Array?n.map((function(t){return t instanceof X?new w(e,t.idx):t})):n},e.prototype.emptyCellWidget=function(){return this._model.emptyBlockWidget()},e}(),Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype._scrollModel2DocModel=function(e){return new J(this,e)},t}(K);e.FDimensionType=void 0,(G=e.FDimensionType||(e.FDimensionType={}))[G.Fr=0]="Fr",G[G.Pr=1]="Pr",G[G.Abs=2]="Abs";var ee="auto";function te(t){return{type:e.FDimensionType.Fr,value:t}}function ne(t){return{type:e.FDimensionType.Pr,value:t}}var re=function(){function e(){var e=this;this.inLayout=!1,this.needLayout=!1,this.bubbleLayout=!0,this.layoutIfNecessary=function(t){return e.doLayout(),!1},this.onChildInOut=function(n){return e.setNeedLayout(),n.type===t.FEventType.AddChild&&n.target.addListener(t.FEventType.AfterChange,e.onContainerOrChildChange),n.type===t.FEventType.RemoveChild&&n.target.removeListener(t.FEventType.AfterChange,e.onContainerOrChildChange),!1},this.onContainerOrChildChange=function(t){var n=t.target;if(n!==e.container&&!e.respondElement(n))return!1;var r=t;if(e.inLayout)return!1;var i=r.changes;return void 0===i.width&&void 0===i.height||e.setNeedLayout(),!1}}return e.prototype.ensureContainer=function(){if(void 0===this.container)throw new Error("Layout should attach to a widget")},e.prototype.needForceLayout=function(){return this.needLayout},e.prototype.isElementSizeAuto=function(e){return!!e.layoutManager&&e.layoutManager.isSizeAuto()},e.prototype.setElementFrame=function(e,t){this.isElementSizeAuto(e)?e.origin=t.leftTop():e.frame=t},e.prototype.getElements=function(){var e=this.container.children(),t=[];return e.forEach((function(e){!e.hidden&&t.push(e)})),t},e.prototype.measure=function(e){return e.layoutManager&&e.layoutManager.isSizeAuto()&&e.layoutManager.doLayout(),new t.FSize(e.width,e.height)},e.prototype.resolveChildrenSize=function(){var e=this,t=this.getElements(),n=0,r=0,i=0,o=0,a=0;return t.forEach((function(t){var a=e.measure(t);i+=a.width,o+=a.height,n=Math.max(a.width,n),r=Math.max(a.height,r)})),{maxWidth:n,maxHeight:r,fullHeight:o,fullWidth:i,fullSpace:a}},e.prototype.doLayout=function(){if(this.ensureContainer(),this.needForceLayout()){this.inLayout=!0;var e=this.resolveChildrenSize();this.arrangeChildrenPosition(e),this.resolveSizeFromChildren(),this.needLayout=!1,this.inLayout=!1}},e.prototype.setNeedLayout=function(){if(this.ensureContainer(),!this.inLayout&&!this.needLayout){this.needLayout=!0,this.container.isSelfDirty||this.container.updateByCfg({needLayout:!0});var e=this.container.parent();e&&e.layoutManager&&this.bubbleLayout&&e.layoutManager.setNeedLayout()}},e.prototype.attach=function(e){var n=this;this.container=e,e.addListener(t.FEventType.BeforeFlush,this.layoutIfNecessary),e.addListener(t.FEventType.AddChild,this.onChildInOut),e.addListener(t.FEventType.RemoveChild,this.onChildInOut),e.children().forEach((function(e){e.addListener(t.FEventType.AfterChange,n.onContainerOrChildChange)})),e.addListener(t.FEventType.AfterChange,this.onContainerOrChildChange),this.setNeedLayout()},e.prototype.detach=function(){var e=this;this.ensureContainer(),this.container.removeListener(t.FEventType.BeforeFlush,this.layoutIfNecessary),this.container.removeListener(t.FEventType.AddChild,this.onChildInOut),this.container.removeListener(t.FEventType.RemoveChild,this.onChildInOut),this.container.children().forEach((function(n){n.removeListener(t.FEventType.AfterChange,e.onContainerOrChildChange)})),this.container.removeListener(t.FEventType.AfterChange,this.onContainerOrChildChange)},e}();function ie(e){return void 0===e}function oe(t){return"object"==typeof t&&t.type===e.FDimensionType.Pr}function ae(t){return"object"==typeof t&&t.type===e.FDimensionType.Fr}function se(e){return"number"==typeof e}function ue(e){return e===ee}var le,ce,he=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.elementParamMap=new Map,t.bubbleLayout=!1,t}return i(n,e),n.prototype.changeElementParams=function(e,t){var n=this.elementParamMap.get(e),r=Object.assign({},n,t);this.elementParamMap.set(e,r),this.container&&this.setNeedLayout()},n.prototype.isSizeAuto=function(){return!1},n.prototype.respondElement=function(e){return this.elementParamMap.has(e)},n.prototype.parseParams=function(e,n){var r,i,o,a,s,u,l,c,h=n.width,d=n.height,f=n.left,p=n.right,v=n.top,g=n.bottom,_=this.container.width,y=this.container.height,m=!(ie(f)||ie(p)),E=!(ie(v)||ie(g));ie(h)?o=e.width:oe(h)?o=h.value*_:se(h)?o=h:this.panic(),ie(d)?a=e.height:oe(d)?a=d.value*y:se(d)?a=d:this.panic();var b=m?0:o;ie(f)||(oe(f)?s=f.value*_-f.value*b:se(f)?s=f:this.panic()),ie(p)||(oe(p)?u=_-(u=p.value*_-p.value*b):se(p)?u=_-p:this.panic());var T=E?0:a;return ie(v)||(oe(v)?l=v.value*y-v.value*T:se(v)?l=v:this.panic()),ie(g)||(oe(g)?c=y-(c=g.value*y-g.value*T):se(g)?c=y-g:this.panic()),m?(r=s,o=u-s):(ie(s)||(r=s),ie(u)||(r=u-o)),E?(i=l,a=c-l):(ie(l)||(i=l),ie(c)||(i=c-a)),new t.FRect(r,i,o,a)},n.prototype.panic=function(){throw new Error("Unsupported")},n.prototype.arrangeChildrenPosition=function(){var e=this;this.elementParamMap.forEach((function(t,n){var r=e.parseParams(n,t);e.setElementFrame(n,r)}))},n.prototype.resolveSizeFromChildren=function(){},n}(re);e.FAlignment=void 0,(ce=e.FAlignment||(e.FAlignment={}))[ce.Start=0]="Start",ce[ce.Center=1]="Center",ce[ce.End=2]="End",ce[ce.Stretch=3]="Stretch",ce[ce.Auto=4]="Auto",e.FDistribution=void 0,(le=e.FDistribution||(e.FDistribution={}))[le.Start=0]="Start",le[le.Center=1]="Center",le[le.End=2]="End",le[le.SpaceBetween=3]="SpaceBetween",le[le.SpaceAround=4]="SpaceAround";var de={autoResizing:!1,horizontal:!1,alignment:e.FAlignment.Start,distribution:e.FDistribution.Start,spacing:0},fe={alignSelf:e.FAlignment.Auto},pe=function(n){function r(e){var t=n.call(this)||this;return t.containerParams=Object.assign({},de),t.elementParamMap=new Map,void 0!==e&&t.changeContainerParams(e),t}return i(r,n),r.prototype.changeContainerParams=function(e){Object.assign(this.containerParams,e),this.container&&this.setNeedLayout()},r.prototype.changeElementParams=function(e,t){var n=this.elementParamMap.get(e),r=Object.assign({},n,t);this.elementParamMap.set(e,r),this.container&&this.setNeedLayout()},r.prototype.getElementParams=function(e){var t=this.elementParamMap.get(e);return Object.assign({},fe,t)},r.prototype.setMainExtent=function(e,t){this.containerParams.horizontal?e.updateByCfg({width:t}):e.updateByCfg({height:t})},Object.defineProperty(r.prototype,"mainAxisAuto",{get:function(){return this.containerParams.autoResizing},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"mainAxisExtent",{get:function(){return this.containerParams.horizontal?this.container.width:this.container.height},enumerable:!1,configurable:!0}),r.prototype.respondElement=function(e){return!0},r.prototype.isSizeAuto=function(){return this.containerParams.autoResizing},r.prototype.resolveChildrenSize=function(){var e=this,t=this.getElements(),n=0,r=0,i=0,o=0,a=0,s=this.containerParams.spacing,u=t.length,l=0,c=[];t.forEach((function(t){var a=e.getElementParams(t).basis,s=!1;if(ie(a)||e.isElementSizeAuto(t))e.measure(t);else{if(se(a)&&e.setMainExtent(t,a),oe(a)&&!e.mainAxisAuto){var u=a.value*e.mainAxisExtent;e.setMainExtent(t,u)}ae(a)&&(c.push({child:t,fraction:a.value}),l+=a.value,s=!0)}s||(i+=t.width,o+=t.height),s&&!e.containerParams.horizontal||(r=Math.max(t.height,r)),s&&e.containerParams.horizontal||(n=Math.max(t.width,n))})),a=(u-1)*s;var h=this.containerParams.horizontal?i:o;h+=a;var d=this.mainAxisExtent-h;return c.forEach((function(t){var n=d/l*t.fraction;d>0&&e.setMainExtent(t.child,n),i+=t.child.width,o+=t.child.height})),{maxWidth:n,maxHeight:r,fullHeight:o,fullWidth:i,fullSpace:a}},r.prototype.arrangeChildrenPosition=function(n){var r=this,i=this.containerParams.horizontal,o=this.getElements(),a=o.length,s=0,u=0,l=this.containerParams.spacing,c=0,h=this.container.width,d=this.container.height,f=this.containerParams.distribution;if(this.containerParams.autoResizing)i?(d=n.maxHeight,h=n.fullWidth+n.fullSpace):(h=n.maxWidth,d=n.fullHeight+n.fullSpace);else{var p=0;if(p=i?h-n.fullWidth:d-n.fullHeight,f===e.FDistribution.SpaceBetween&&p>=0&&(l=p/(a-1)),f===e.FDistribution.SpaceAround){var v=p/a/2;l=v,c=v}}i?u=ve(f,h,n.fullWidth+n.fullSpace):s=ve(f,d,n.fullHeight+n.fullSpace),o.forEach((function(n){var i=n.width,o=n.height,a=r.containerParams.alignment,f=r.getElementParams(n);f.alignSelf!==e.FAlignment.Auto&&(a=f.alignSelf),r.containerParams.horizontal?a===e.FAlignment.Stretch?(o=d,s=0):s=ve(a,d,n.height):a===e.FAlignment.Stretch?(i=h,u=0):u=ve(a,h,n.width),r.containerParams.horizontal?u+=c:s+=c;var p=new t.FRect(u,s,i,o);r.setElementFrame(n,p),r.containerParams.horizontal?u+=n.width+l:s+=n.height+l}))},r.prototype.resolveSizeFromChildren=function(){if(this.containerParams.autoResizing){var e=new t.FRect(0,0,0,0);this.getElements().forEach((function(t){return e.union(t.frame)})),this.container.size=e.size}},r}(re);function ve(t,n,r){return t===e.FAlignment.Center?(n-r)/2:t===e.FAlignment.End?n-r:0}var ge,_e,ye,me,Ee=function(e){function n(t){var n=e.call(this)||this;return n.elementParamMap=new Map,n.containerParams=n.getDefaultGridParams(),void 0!==t&&Object.assign(n.containerParams,t),n}return i(n,e),n.prototype.isSizeAuto=function(){return!1},n.prototype.respondElement=function(e){return this.elementParamMap.has(e)},n.prototype.changeContainerParams=function(e){var n=Object.assign({},this.containerParams);Object.assign(this.containerParams,e),this.container&&!t.equals(n,this.containerParams)&&this.setNeedLayout()},n.prototype.needForceLayout=function(){return!!this.needLayout||!this.colWidthArr||!this.rowHeightArr||this.colWidthArr[this.colWidthArr.length-1]!==this.container.width||this.rowHeightArr[this.rowHeightArr.length-1]!==this.container.height},n.prototype.changeElementParams=function(e,t,n,r,i){void 0===r&&(r=1),void 0===i&&(i=1),this.elementParamMap.set(e,{row:n,column:t,rowSpan:i,columnSpan:r}),this.container&&this.setNeedLayout()},n.prototype.addArrangedChild=function(e,t,n,r,i){void 0===r&&(r=1),void 0===i&&(i=1),this.ensureContainer(),this.container.addChild(e),this.changeElementParams(e,t,n,r,i)},n.prototype.getDefaultGridParams=function(){return{rows:[],columns:[]}},n.prototype.getElements=function(){var t=(this.containerParams.rows.length||1)*(this.containerParams.columns.length||1);return e.prototype.getElements.call(this).slice(0,t)},n.prototype.resolveRowColDimensions=function(){0===this.containerParams.columns.length?this.colWidthArr=[this.container.width]:this.colWidthArr=be(this.container.width,this.containerParams.columns),0===this.containerParams.rows.length?this.rowHeightArr=[this.container.height]:this.rowHeightArr=be(this.container.height,this.containerParams.rows)},n.prototype.getCellSize=function(e){for(var t=e.col,n=e.colSpan,r=e.row,i=e.rowSpan,o=0,a=0;n-- >0;){var s=this.colWidthArr[t++];o+=void 0===s?0:s}for(;i-- >0;){var u=this.rowHeightArr[r++];a+=void 0===u?0:u}return[o,a]},n.prototype.getOrders=function(){var e=this;return Array.from(this.elementParamMap.keys()).forEach((function(t){e.container.ancestorOf(t)||e.elementParamMap.delete(t)})),this.elementParamMap},n.prototype.arrangeChildrenPosition=function(e){var n=this,r=this.getOrders();this.resolveRowColDimensions();var i=function(e){return e>0&&e<=n.rowHeightArr.length?n.rowHeightArr[e-1]:0},o=function(e){return e>0&&e<=n.colWidthArr.length?n.colWidthArr[e-1]:0};r.forEach((function(e,r){var a=i(e.row),s=o(e.column),u=o(e.column+(e.columnSpan||1))-s,l=i(e.row+(e.rowSpan||1))-a,c=new t.FRect(s,a,u,l);n.setElementFrame(r,c)}))},n.prototype.resolveSizeFromChildren=function(){},n}(re);function be(e,t){var n=0,r=0;t.forEach((function(t,i){se(t)&&(r+=t),oe(t)&&(r+=t.value*e),ae(t)&&(n+=t.value)}));var i=Math.max(0,e-r),o=[];t.forEach((function(t,r){se(t)&&o.push(t),oe(t)&&o.push(t.value*e),ae(t)&&o.push(t.value/n*i)}));var a=0;return o.map((function(e){return a+=e}))}e.MainAxisSize=void 0,(me=e.MainAxisSize||(e.MainAxisSize={})).Max="Max",me.Min="Min",e.AxisAlignment=void 0,(ye=e.AxisAlignment||(e.AxisAlignment={}))[ye.Start=0]="Start",ye[ye.Center=1]="Center",ye[ye.End=2]="End",e.FlexDirection=void 0,(_e=e.FlexDirection||(e.FlexDirection={}))[_e.Row=0]="Row",_e[_e.Column=1]="Column",e.VerticalDirection=void 0,(ge=e.VerticalDirection||(e.VerticalDirection={}))[ge.Up=0]="Up",ge[ge.Down=1]="Down";var Te,Ce=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._widthBindHandler=null,t._heightBindHander=null,t}return i(n,e),Object.defineProperty(n.prototype,"marginTop",{get:function(){return this._cfg.marginTop||0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"marginRight",{get:function(){return this._cfg.marginRight||0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"marginBottom",{get:function(){return this._cfg.marginBottom||0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"marginLeft",{get:function(){return this._cfg.marginLeft||0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"horizontalSpace",{get:function(){return this.width+this.marginLeft+this.marginRight},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"verticalSpace",{get:function(){return this.height+this.marginTop+this.marginBottom},enumerable:!1,configurable:!0}),n.prototype.addChild=function(t){if(this.children().length>1)throw Error("Expanded need only one Child");this.detectLifetimeOnce(!0),e.prototype.addChild.call(this,t)},n.prototype.beforeFlush=function(t){var n=this.parent();if(n instanceof we||n instanceof Se)return e.prototype.beforeFlush.call(this,t);throw Error("Container FWiget need use in Flex")},n.prototype.afterFlush=function(t){e.prototype.afterFlush.call(this,t),this.trySetConfigDirectly(this._calcSize())},n.prototype._calcSize=function(){var e=this.childrenArr()[0];return e?e instanceof n?{width:e.marginLeft+e.marginRight+e.width,height:e.marginTop+e.marginBottom+e.height}:{width:e.width,height:e.height}:{width:0,height:0}},n.prototype.destroy=function(){this._unBindHandler(),e.prototype.destroy.call(this)},n.prototype._unBindHandler=function(){null!==this._widthBindHandler&&(t.Bind.propsUnBind(this._widthBindHandler),this._widthBindHandler=null),null!==this._heightBindHander&&(t.Bind.propsUnBind(this._heightBindHander),this._heightBindHander=null)},n}(t.FWidget),Se=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),Object.defineProperty(n.prototype,"flex",{get:function(){return void 0===this._cfg.flex?1:this._cfg.flex},enumerable:!1,configurable:!0}),n.prototype.onChildChange=function(e,t){var n=!1;e instanceof Ce&&(t.marginTop||t.marginRight||t.marginBottom||t.marginLeft)&&(n=!0),n&&this.detectLifetimeOnce(!0)},n.prototype.afterFlush=function(n){var r=this,i=this.children();if(i.length>1)throw Error("Expanded need only one Child");var o=this.parent();if(!(o instanceof we))throw Error("Expanded FWidget need use in Flex");if(o.mainAxisSize===e.MainAxisSize.Min&&0!==this._cfg.flex)throw Error("Expanded can't replace inside mainAxisSize min Flex, only this cfg is `flex: 0`");return i.forEach((function(e){0===r._cfg.flex&&r.trySetConfigDirectly({width:e.horizontalSpace,height:e.verticalSpace}),e instanceof Ce&&e.trySetConfigDirectly({x:e.marginLeft,y:e.marginTop})})),t.prototype.afterFlush.call(this,n)},n}(t.FWidget),we=function(n){function r(){var e=null!==n&&n.apply(this,arguments)||this;return e._bindSizeHandler=null,e._childrenCollection=[],e}return i(r,n),Object.defineProperty(r.prototype,"direction",{get:function(){return this._cfg.direction||e.FlexDirection.Row},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"mainAxisSize",{get:function(){return void 0===this._cfg.mainAxisSize?e.MainAxisSize.Max:this._cfg.mainAxisSize},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"mainAxisAlignment",{get:function(){return this._cfg.mainAxisAlignment||e.AxisAlignment.Start},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"crossAxisAlignment",{get:function(){return this._cfg.crossAxisAlignment||e.AxisAlignment.Start},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"verticalDirection",{get:function(){return this._cfg.verticalDirection||e.VerticalDirection.Down},enumerable:!1,configurable:!0}),r.prototype.isRow=function(){return this.direction===e.FlexDirection.Row},r.prototype.isColumn=function(){return this.direction===e.FlexDirection.Column},r.prototype.onChildChange=function(t,n){var r=!1;(this.direction===e.FlexDirection.Row&&n.width||this.direction===e.FlexDirection.Column&&n.height)&&(r=!0),t instanceof Ce&&(n.marginTop||n.marginRight||n.marginBottom||n.marginLeft)&&(r=!0),r&&this.detectLifetimeOnce(!0)},r.prototype.addChild=function(e){n.prototype.addChild.call(this,e),this._childrenCollection.push(e),this.detectLifetimeOnce(!0)},r.prototype.removeChild=function(e){n.prototype.removeChild.call(this,e);var t=this._childrenCollection.findIndex((function(t){return t===e}));this._childrenCollection.splice(t,1),this.detectLifetimeOnce(!0)},r.prototype.setParent=function(t){n.prototype.setParent.call(this,t),t instanceof r&&this.direction===t.direction&&this.mainAxisSize===e.MainAxisSize.Max?this.updateByCfg({mainAxisSize:e.MainAxisSize.Min}):null!==t&&this._bindSize()},r.prototype.renderFlexChildren=function(e){},r.prototype.flush=function(){this.flushCfg(!1)},r.prototype.flushCfg=function(e){var n=this._changes,r=n.size>0,i={};this.renderFlexChildren(n),this._childrenCollection.forEach((function(t){for(;(!(t instanceof Se)||0===t.flex)&&(t.isSelfDirty||t.isChildDirty);)t.flushCfg(e)})),r&&(n.forEach((function(e,t){i[t]=e})),this.event(new t.FChangeEvent(t.FEventType.BeforeFlush,this,i)),n.has("width")&&(i.width=n.get("width")),n.has("height")&&(i.height=n.get("height")),this._flushProps(i)),this._childrenCollection.forEach((function(t){for(;t instanceof Se&&(t.isSelfDirty||t.isChildDirty);)t.flushCfg(e)})),this.isChildDirty&&this._setProps(t.WidgetProps.ChildDirty,!1),r&&this.event(new t.FChangeEvent(t.FEventType.AfterFlush,this,i))},r.prototype.afterChange=function(e){var t=e.changes;(t.direction||t.mainAxisSize)&&this._bindSize()},r.prototype.beforeFlush=function(t){var n=this;if(t.changes._phantom||t.changes.mainAxisSize){var r=[],i=0,o=0;if(this._childrenCollection.forEach((function(t){if(t instanceof Se&&t.flex>0)r.push(t),i+=t.flex;else if(t instanceof Ce){var a=n.direction===e.FlexDirection.Row?t.horizontalSpace:t.verticalSpace;o+=a}else a=n.direction===e.FlexDirection.Row?t.width:t.height,o+=a})),this.mainAxisSize===e.MainAxisSize.Min?(this.isRow()&&this.updateByCfg({width:o}),this.isColumn()&&this.updateByCfg({height:o})):"number"==typeof this.mainAxisSize&&(this.isRow()&&this.updateByCfg({width:this.mainAxisSize}),this.isColumn()&&this.updateByCfg({height:this.mainAxisSize})),r.length>0){var a=(this.isRow()?this.width:this.height)-o,s=(a>0?a:0)/i;this.direction===e.FlexDirection.Row?r.forEach((function(e){e.updateByCfg({width:s*e.flex})})):r.forEach((function(e){e.updateByCfg({height:s*e.flex})}))}}return!1},r.prototype.afterFlush=function(e){if(e.changes._phantom||e.changes.mainAxisSize){if(this.isRow()){var t=0;this._childrenCollection.forEach((function(e){e instanceof Ce?(e.trySetConfigDirectly({x:t+e.marginLeft,y:e.marginTop}),t+=e.marginLeft+e.marginRight):e.trySetConfigDirectly({x:t}),t+=e.width}))}if(this.isColumn()){var n=0;this._childrenCollection.forEach((function(e){e instanceof Ce?(e.trySetConfigDirectly({y:n+e.marginTop,x:e.marginLeft}),n+=e.marginBottom+e.marginTop):e.trySetConfigDirectly({y:n}),n+=e.height}))}}return!1},r.prototype._unbindSize=function(){this._bindSizeHandler&&(t.Bind.propsUnBind(this._bindSizeHandler),this._bindSizeHandler=null)},r.prototype._bindSize=function(){var n=this.parent();this._unbindSize(),null!==n&&this.mainAxisSize===e.MainAxisSize.Max&&(this.direction===e.FlexDirection.Row?this._bindSizeHandler=t.Bind.propBind(this,"width",n,"width"):this.direction===e.FlexDirection.Column&&(this._bindSizeHandler=t.Bind.propBind(this,"height",n,"height")))},r.prototype.destroy=function(){n.prototype.destroy.call(this),this._unbindSize()},r}(t.FWidget),Re=function(t){function n(n){var r=t.call(this,n)||this;return r.updateByCfg({direction:e.FlexDirection.Row}),r}return i(n,t),n.prototype.beforeChange=function(n){if(t.prototype.beforeChange.call(this,n),n.changes.direction&&n.changes.direction.current!==e.FlexDirection.Row)throw new Error("Can't change the main axis direction in Row.")},n}(we);e.WrapAlignment=void 0,(Te=e.WrapAlignment||(e.WrapAlignment={}))[Te.Start=0]="Start",Te[Te.End=1]="End",Te[Te.Center=2]="Center",Te[Te.SpaceBetween=3]="SpaceBetween",Te[Te.SpaceAround=4]="SpaceAround",Te[Te.SpaceEvenly=5]="SpaceEvenly";var Ae,Oe,Me,ke,Ie=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e._lines=[],e}return i(n,t),n.prototype._setNewLine=function(e){void 0===e&&(e=0),this._lines[e]={elements:[],expanded:[],yShift:0,height:0},e>=1&&(this._lines[e].yShift=this._lines[e-1].yShift+this._lines[e-1].height)},n.prototype._setHeight=function(e,t){void 0===e&&(e=0);var n=t instanceof Ce?t.verticalSpace:t.height;this._lines[e].height=Math.max(n,this._lines[e].height)},n.prototype._assignExpanded=function(e){if(e.expanded.length){var t=e.elements.reduce((function(e,t){var n=e+t.width;return t instanceof Ce&&(n+=t.marginLeft+t.marginRight),n}),0),n=this.width-t,r=(n>0?n:0)/e.expanded.reduce((function(e,t){return e+t.flex}),0);e.expanded.forEach((function(e){e.updateByCfg({width:r*e.flex})}))}},n.prototype.beforeFlush=function(t){var n=this;if(t.changes._phantom||t.changes.mainAxisSize){if(this.mainAxisSize===e.MainAxisSize.Min)throw Error("Can't assign min size in Wrap.");"number"==typeof this.mainAxisSize&&(this.isRow()&&this.updateByCfg({width:this.mainAxisSize}),this.isColumn()&&this.updateByCfg({height:this.mainAxisSize}));var r=this.width,i=0,o=0;this._lines=[],this._setNewLine(o),this._childrenCollection.forEach((function(e){if(e instanceof Se)return n._lines[o].elements.push(e),n._lines[o].expanded.push(e),void n._setHeight(o,e);var t=e instanceof Ce?e.horizontalSpace:e.width,a=!n._lines[o].elements.length;return t>r?(a||(n._assignExpanded(n._lines[o]),n._setNewLine(o+=1)),n._lines[o].elements.push(e),n._setHeight(o,e),n._setNewLine(o+=1),void(i=0)):i+t>r?(n._assignExpanded(n._lines[o]),n._setNewLine(o+=1),n._lines[o].elements.push(e),n._setHeight(o,e),void(i=t)):(n._lines[o].elements.push(e),n._setHeight(o,e),void(i+=t))})),this._assignExpanded(this._lines[o])}return!1},n.prototype.afterFlush=function(e){return(e.changes._phantom||e.changes.mainAxisSize)&&this._lines.forEach((function(e){var t=0;e.elements.forEach((function(n){n instanceof Ce?(n.trySetConfigDirectly({x:t+n.marginLeft,y:e.yShift+n.marginTop}),t+=n.marginLeft+n.marginRight):n.trySetConfigDirectly({x:t,y:e.yShift}),t+=n.width}))})),!1},n}(Re),xe=function(t){function n(n){var r=t.call(this,n)||this;return r.updateByCfg({direction:e.FlexDirection.Column}),r}return i(n,t),n.prototype.beforeChange=function(n){if(t.prototype.beforeChange.call(this,n),n.changes.direction&&n.changes.direction.current!==e.FlexDirection.Column)throw new Error("Can't change the main axis direction in Column.")},n}(we),Ne=function(e){function n(n,r){var i=e.call(this,n)||this;i._corner=null,i._model=null,i._layout=new Ee,i._model=r;var o=new Z(null);i._content=new V(i,o),i._docCompatibility=new U(i._content.doc,r),o.setDoc(i._docCompatibility),i._content.addLayer(i._docCompatibility);var a=new Le(i._model,i),s=new Pe(i._model,0,i);return i._colHeader=new Q(i,a),i._rowheader=new $(i,s),t.Bind.propBind(i._content,"posX",i._colHeader.doc(),"posX"),t.Bind.propBind(i._content,"posY",i._rowheader.doc(),"posY"),t.Bind.propBind(i._colHeader.doc(),"posX",i._content,"posX"),t.Bind.propBind(i._rowheader.doc(),"posY",i._content,"posY"),i.setLayout(i._layout),r&&i.setModel(r),i}return i(n,e),n.prototype.docPos2Cell=function(e,n){return this._content.docPos2Cell(new t.FPoint(e,n))},n.prototype.viewPos2Cell=function(e,n){var r=new t.FPoint(e,n);return r=this.viewPos2Doc(r),this._content.docPos2Cell(r)},n.prototype.cell2DocPos=function(e){return this._content.cell2DocPos(e)},n.prototype.cell2ViewPos=function(e){var t=this.cell2DocPos(e);return this.docPos2View(t)},n.prototype.docPos2View=function(e){return this._content.doc2View(e).move(this._content.x,this._content.y)},n.prototype.viewPos2Doc=function(e){return e.move(-this._content.x,-this._content.y),this._content.view2Doc(e)},n.prototype.rowHeader=function(){return this._rowheader},n.prototype.colHeader=function(){return this._colHeader},n.prototype.contentDoc=function(){return this._content},n.prototype.setModel=function(e){this._model=e,this._docCompatibility.setModel(e);var t=new Le(this._model,this);this._rowheader.setModel(t);var n=new Pe(this._model,0,this);this._colHeader.setModel(n),this.reset(),this._updateCorner(),this.updateLayout()},n.prototype.updateLayout=function(){var e=this._model.colHeaderHeight(),t=this._model.rowHeaderWidth();this._layout.changeContainerParams({rows:[e,te(1)],columns:[t,te(1)]}),this._corner&&this._layout.changeElementParams(this._corner,0,0),this._layout.changeElementParams(this._rowheader,0,1),this._layout.changeElementParams(this._colHeader,1,0),this._layout.changeElementParams(this._content,1,1)},n.prototype.reset=function(){this._rowheader.doc().reset(),this._colHeader.doc().reset(),this._content.reset(),this._updateCorner(),this.updateLayout()},n.prototype.model=function(){return this._model},n.prototype._updateCorner=function(){null!==this._corner&&(this._corner.destroy(),this._corner=null),null!==this._model&&(this._corner=this._model.leftTopCorner(),null!==this._corner&&this.addChild(this._corner))},n}(t.FWidget),Pe=function(){function e(e,t,n){this._tblModel=e,this._row=t,this._tableView=n}return e.prototype.sumSize=function(){return this._tblModel.width()},e.prototype.blockSize=function(e){return this._tblModel.colWidth(e)},e.prototype.has=function(e){return this._tblModel.hasCol(e)},e.prototype.blockStyle=function(e){return null},e.prototype.blockData=function(e){return this._tblModel.colHeaderData(e)},e.prototype.emptyBlockWidget=function(){return this._tblModel.emptyColHeaderWidget()},e}(),Le=function(){function e(e,t){this._tblModel=e,this._tblView=t}return e.prototype.sumSize=function(){return this._tblModel.height()},e.prototype.blockSize=function(e){return this._tblModel.rowHeight(e)},e.prototype.has=function(e){return this._tblModel.hasRow(e)},e.prototype.blockStyle=function(e){return null},e.prototype.blockData=function(e){return this._tblModel.rowHeaderData(e)},e.prototype.emptyBlockWidget=function(){return this._tblModel.emptyRowHeaderWidget()},e}(),De=function(e){function n(n,r){var i=e.call(this,n)||this;i._table=new Ne(i,r),i._hscrollbar=new E(i),i._hscrollbar.updateByCfg({hidden:!0}),i._vscrollbar=new m(i),i._vscrollbar.updateByCfg({hidden:!0});var o=i._table.contentDoc();return t.Bind.propBind(i._hscrollbar,"y",i,"height",(function(e){return e-i._hscrollbar.height})),t.Bind.propBind(i._hscrollbar,"width",i,"width",(function(e){return e-i._vscrollVisibleWidth()})),t.Bind.propBind(i._hscrollbar,"page",o,"width"),t.Bind.propBind(i._hscrollbar,"value",o,"posX"),t.Bind.propBind(i._hscrollbar,"hidden",i,"hscroll"),t.Bind.propBind(i._vscrollbar,"x",i,"width",(function(e){return e-i._vscrollbar.width})),t.Bind.propBind(i._vscrollbar,"height",i,"height",(function(e){return e-i._hscrollVisibleHeight()})),t.Bind.propBind(i._vscrollbar,"page",o,"height"),t.Bind.propBind(i._vscrollbar,"value",o,"posY"),t.Bind.propBind(i._vscrollbar,"hidden",i,"vscroll"),t.Bind.propBind(o,"posX",i._hscrollbar,"value"),t.Bind.propBind(o,"posY",i._vscrollbar,"value"),t.Bind.propBind(i._table,"width",i,"width"),t.Bind.propBind(i._table,"height",i,"height"),i._table.setModel(r),t.Bind.propBind(i._vscrollbar,"max",o,"docHeight"),t.Bind.propBind(i._hscrollbar,"max",o,"docWidth"),t.Bind.propBind(i._vscrollbar,"hidden",o,"docHeight",(function(e){return!i._hasVScroll()})),t.Bind.propBind(i._hscrollbar,"hidden",o,"docWidth",(function(e){return!i._hasHscroll()})),i}return i(n,e),n.prototype.model=function(){return this._table.model()},n.prototype.setModel=function(e){this._table.setModel(e)},n.prototype.reset=function(){this._table.reset()},n.prototype.rowHeader=function(){return this._table.rowHeader()},n.prototype.colHeader=function(){return this._table.colHeader()},n.prototype.docPos2Cell=function(e,t){return this._table.docPos2Cell(e,t)},n.prototype.viewPos2Cell=function(e,t){return this._table.viewPos2Cell(e,t)},n.prototype.cell2DocPos=function(e){return this._table.cell2DocPos(e)},n.prototype.cell2ViewPos=function(e){return this._table.cell2ViewPos(e)},n.prototype.docPos2View=function(e){return this._table.docPos2View(e)},n.prototype.viewPos2Doc=function(e){return this._table.viewPos2Doc(e)},Object.defineProperty(n.prototype,"hscroll",{get:function(){return this._cfg.hscroll},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"vscroll",{get:function(){return this._cfg.vscroll},enumerable:!1,configurable:!0}),n.prototype._hasVScroll=function(){return!1!==this.vscroll&&this._table.contentDoc().docSize().height>this._table.height},n.prototype._hasHscroll=function(){return!1!==this.hscroll&&this._table.contentDoc().docSize().width>this._table.width},n.prototype._vscrollVisibleWidth=function(){return this._hasVScroll()?this._vscrollbar.width:0},n.prototype._hscrollVisibleHeight=function(){return this._hasHscroll()?this._hscrollbar.height:0},n}(t.FWidget),Fe=12;function Be(e){var t=e.fontStyle?e.fontStyle:"normal",n=e.fontWeight?e.fontWeight:400,r=e.fontSize?e.fontSize:Fe,i=e.fontFamily?e.fontFamily:"Arial";return"".concat(t," ").concat(n," ").concat(r,"px ").concat(i)}e.FontWeight=void 0,(ke=e.FontWeight||(e.FontWeight={}))[ke.normal=400]="normal",ke[ke.bold=700]="bold",e.HorizontalAlign=void 0,(Me=e.HorizontalAlign||(e.HorizontalAlign={}))[Me.Left=0]="Left",Me[Me.Center=1]="Center",Me[Me.Right=2]="Right",e.VerticalAlign=void 0,(Oe=e.VerticalAlign||(e.VerticalAlign={}))[Oe.Top=0]="Top",Oe[Oe.Center=1]="Center",Oe[Oe.Bottom=2]="Bottom",e.TextDecoration=void 0,(Ae=e.TextDecoration||(e.TextDecoration={}))[Ae.None=0]="None",Ae[Ae.Bottom=1]="Bottom",Ae[Ae.Mid=2]="Mid",Ae[Ae.Top=4]="Top";var Ve,He={arial:{fontSize:128,fontHeight:143,fontAscent:116,fontDescent:27,emAscent:108.5,emDescent:19.5,lineHeight:147,xHeight:66,capHeight:101,ascender:28,descender:26,slope:11.8}},Ue=128,Ze={fontFamily:"Arial",fontSize:Fe,fontWeight:400,color:"#000",fontStyle:"normal"},We={fontSize:12,fontFamily:"Arial",fontStyle:"normal",fontWeight:e.FontWeight.normal},je=65533,Ge=.82;function ze(t){return t<1535?e.CharType.Latin:t>11904&&t<40959||t>131072&&t<191471?e.CharType.CJK:e.CharType.Other}e.CharType=void 0,(Ve=e.CharType||(e.CharType={}))[Ve.Latin=0]="Latin",Ve[Ve.CJK=1]="CJK",Ve[Ve.Other=2]="Other";var Ye=function(){function e(t,n,r){void 0===r&&(r=10),this._fontFamily=t,this._fontWeight=n,this._fontSize=r,this._factor=r/Fe,this._lineHeight=e.fontLineHeight(t),this._uid=e._getHash(t,n,r)}return Object.defineProperty(e,"canvas",{get:function(){return null===this._canvas&&(this._canvas=t.FCanvasPool.borrowCanvas(null,void 0,!1)),this._canvas},set:function(e){this._canvas=e},enumerable:!1,configurable:!0}),e._getHash=function(e,t,n){var r=this._hashMap.get(e);void 0===r&&(r=new Map,this._hashMap.set(e,r));var i=r.get(n);void 0===i&&(i=new Map,r.set(n,i));var o=i.get(t);return void 0===o&&(o=this._uid++,i.set(t,o)),o},e.createSpanElement=function(){var e=document.createElement("span");return e.style.lineHeight="normal",e},Object.defineProperty(e,"DefaultBaselineRatio",{get:function(){return Ge},enumerable:!1,configurable:!0}),e.createCanvas=function(n){e.canvas=t.FCanvasPool.borrowCanvas(null,n,!1)},e.getBaseline=function(t){var n=this._baselineCaches.get(t);if(void 0!==n)return n;var r=document.body,i=document.createElement("div");i.style.fontFamily=t,i.style.display="block",i.style.position="fixed",i.style.top="0",i.style.left="0",i.style.transform="translate(-100%, -100%)";var o=e.createSpanElement();o.innerText="A",o.style.fontSize="0px",o.style.display="inline-block";var a=e.createSpanElement();a.innerText="A",a.style.fontSize="999px",a.style.display="inline-block",i.append(o),i.append(a),r.append(i),setTimeout((function(){i.removeChild(o),i.removeChild(a),r.removeChild(i)}));var s=a.getBoundingClientRect().height,u=(o.offsetTop-a.offsetTop)/s;return(!Number.isFinite(u)||Number.isNaN(u)||u<0||u>1)&&(u=Ge),this._baselineCaches.set(t,u),u},e.fontLineHeight=function(t){if(null===e._span){var n=e.createSpanElement();n.innerHTML="H";var r=n.style;r.visibility="hidden",r.top="-100%",r.left="-100%",r.position="absolute",r.fontSize="".concat(Fe,"px"),document.body.insertBefore(n,null),e._span=n}var i=e._fontLineHeightCaches.get(t);return i||(e._span.style.fontFamily=t,i=e._span.offsetHeight||1.2*Fe,e._fontLineHeightCaches.set(t,i)),i},e.clearMeasurerCache=function(){e._uid=0,e._curId=-1,e._hashMap.clear(),e._wordMeasureCaches.clear(),e._fontLineHeightCaches.clear(),e._canvas&&(t.FCanvasPool.backCanvas(e._canvas),e._canvas=null)},e.prototype.update=function(t,n,r){void 0===r&&(r=10),this._factor=r/Fe,this._fontFamily===t&&this._fontWeight===n&&this._fontSize===r||(this._fontFamily=t,this._fontWeight=n,this._fontSize=r,this._uid=e._getHash(t,n,r),this._lineHeight=e.fontLineHeight(t))},e.prototype._setupStyle=function(t){e._curId!==this._uid&&(t.font=Be({fontFamily:this._fontFamily,fontSize:this._fontSize,fontWeight:this._fontWeight}),e._curId=this._uid)},e.prototype.measureWord=function(t){var n=e._wordMeasureCaches.get(this._uid);if(n){var r=n.get(t);if(void 0!==r)return r}else n=new Map,e._wordMeasureCaches.set(this._uid,n);var i=e.canvas.ctx();this._setupStyle(i);var o=i.measureText(t).width;return n.set(t,o),o},e.prototype.lineHeight=function(){return this._lineHeight*this._factor},e._uid=0,e._curId=-1,e._hashMap=new Map,e._wordMeasureCaches=new Map,e._fontLineHeightCaches=new Map,e._canvas=null,e._span=null,e._baselineCaches=new Map,e}();t.FApp.onAppExit((function(){return Ye.clearMeasurerCache()}));var Xe=function(){function t(e){this._str=e,this._idx=Number.NEGATIVE_INFINITY,this._needJoin=!1,this._charInfo={codePoint:0,units:0}}return t.breakableChar=function(t){var n=t.codePoint(),r=t.char();return 8205===r.codePointAt(r.length-2)&&(n=r.codePointAt(r.length-1)||n,r=r.substring(r.length-1)||r),ze(n)!==e.CharType.Latin||" "===r},t.prototype.reset=function(e){void 0!==e&&(this._str=e),this._idx=Number.NEGATIVE_INFINITY,this._charInfo.codePoint=0,this._charInfo.units=0},t.prototype.next=function(){this._idx===Number.NEGATIVE_INFINITY&&(this._idx=0);var e=this._charInfo.units;if(this._idx>=this._str.length-e)return this._idx=Number.NEGATIVE_INFINITY,this._charInfo={codePoint:0,units:0},null;this._idx+=e;try{var t=this._idx;for(this._getWholeChar();this._checkSkinToneModifier()||this._checkEmojiIndicator()||this._checkZeroWidthJoiner();)this._needJoin&&(this._idx+=this._charInfo.units,this._getWholeChar(),this._needJoin=!1);this._charInfo.units=this._idx+this._charInfo.units-t,this._idx=t,this._charInfo.codePoint=this._str.codePointAt(this._idx)}catch(e){this._charInfo.codePoint=je,this._charInfo.units=1}return this},t.prototype.prev=function(){if(this._idx===Number.NEGATIVE_INFINITY&&(this._idx=this._str.length),this._idx<=0)return this._idx=Number.NEGATIVE_INFINITY,this._charInfo={codePoint:0,units:0},null;this._idx--;try{var e=this._idx;for(this._getWholeChar();this._checkSkinToneModifier(!0)||this._checkEmojiIndicator(!0)||this._checkZeroWidthJoiner(!0);)this._needJoin&&(this._idx--,this._getWholeChar(),this._needJoin=!1);this._charInfo.units=e+1-this._idx,this._charInfo.codePoint=this._str.codePointAt(this._idx)}catch(e){this._charInfo.codePoint=je,this._charInfo.units=1}return this},t.prototype.codePoint=function(){return this._charInfo.units<=0?-1:this._charInfo.codePoint},t.prototype.char=function(){var e=this._charInfo,t=this._str;return e.units<=0?"":1===e.units?t.charAt(this._idx):t.substring(this._idx,this._idx+e.units)},t.prototype.idx=function(){return this._idx},t.prototype.units=function(){return this._charInfo.units},t.prototype.seek=function(e){return this._charInfo.codePoint=0,this._charInfo.units=0,e<0||this._str.length<=e?this._idx=Number.NEGATIVE_INFINITY:(this._idx=e,this.next()),this},t.prototype.isValid=function(){return this._idx!==Number.NEGATIVE_INFINITY},t.prototype._getWholeChar=function(){var e=this._str,t=this._idx,n=e.charCodeAt(t);if(n<55296||n>57343)this._charInfo.codePoint=e.codePointAt(t),this._charInfo.units=1;else if(n>=55296&&n<=56319){if(e.length<=t+1)throw new Error("High surrogate without following low surrogate");var r=e.charCodeAt(t+1);if(r<56320||r>57343)throw new Error("High surrogate without following low surrogate");this._charInfo.codePoint=e.codePointAt(t),this._charInfo.units=2}else{if(t<=0)throw new Error("Low surrogate without preceding high surrogate");var i=e.charCodeAt(t-1);if((i<55296||i>56319)&&n)throw new Error("Low surrogate without preceding high surrogate");this._idx-=1,this._charInfo.codePoint=e.codePointAt(t-1),this._charInfo.units=2}},t.prototype._checkZeroWidthJoiner=function(e){void 0===e&&(e=!1);var t=8205,n=this._str,r=e?this._idx-1:this._idx+this._charInfo.units,i=n.charCodeAt(r)===t;return i&&(this._needJoin=!0,this._idx=r,this._charInfo.units=1),i},t.prototype._checkEmojiIndicator=function(e){void 0===e&&(e=!1);var t=65039,n=this._str,r=e?this._idx:this._idx+this._charInfo.units,i=n.charCodeAt(r)===t;return i&&(e&&(this._needJoin=!0),this._idx=r,this._charInfo.units=1),i},t.prototype._checkSkinToneModifier=function(e){void 0===e&&(e=!1);var t=e?this._idx-1:this._idx+this._charInfo.units,n=this._str.charCodeAt(t),r=this._str.charCodeAt(t+1);if(!n||!r)return!1;var i=55356===n&&r>=57339&&r<=57343;return i&&(e&&(this._needJoin=!0),this._idx=t,this._charInfo.units=2),i},t}(),Ke=function(){function e(e){this._str=e,this._staging={idx:0,len:0},this._word=null,this._curBreakChar=!1,this._isEnd=!1,this._iter=new Xe(e)}return e.prototype.next=function(){if(this._isEnd)return null;var e=this._iter;for(this._word=null;null!==e.next();){var t=e.char();if("\r"===t||"\n"===t){if("\r"===t&&(null!==e.next()&&"\n"===e.char()||e.prev()),this._staging)return this._word=this._staging,this._staging={idx:e.idx()+1,len:0},this._str.substr(this._word.idx,this._word.len)}else if(Xe.breakableChar(e)){if(this._staging.len>0&&(this._word=this._staging,this._staging={idx:e.idx(),len:0}),this._staging.len+=e.units(),this._curBreakChar=!0,this._word)return this._str.substr(this._word.idx,this._word.len)}else if(this._curBreakChar&&(this._staging.len>0&&(this._word=this._staging),this._staging={idx:e.idx(),len:0},this._curBreakChar=!1),this._staging.len+=e.units(),this._word)return this._str.substr(this._word.idx,this._word.len)}return this._isEnd=!0,this._staging&&(this._word=this._staging,this._staging={idx:e.idx(),len:0}),this._word?this._str.substr(this._word.idx,this._word.len):null},e.prototype.isValid=function(){return this._iter.isValid()},e.prototype.charIter=function(){return this._iter},e.prototype.reset=function(e){this._str=e,this._staging.idx=0,this._staging.len=0,this._curBreakChar=!1,this._word=null,this._isEnd=!1,this._iter.reset(e)},e.prototype.word=function(){return this._word?this._str.substr(this._word.idx,this._word.len):this._word},e}();function qe(e,t){return e.rg.from>t.rg.from?1:e.rg.from<t.rg.from?-1:0}function $e(e,t){return e.pos>t.pos?1:e.pos<t.pos?-1:0}var Je,Qe=function(){function e(e,n){void 0===n&&(n={}),this._typher=e,this._defalutStyle=n,this._str="",this._styles=new t.SortedArray(qe),this._aligns=new t.SortedArray(qe),this._insets=new t.SortedArray($e),this._fillDefaultStyle()}return e.prototype.updateDefaultStyle=function(e){this._defalutStyle=e,this._fillDefaultStyle()},e.prototype.updateStr=function(e){this._str=e,this._typher.reset()},e.prototype.addStyleAttr=function(e){this._styles.insert(e),this._typher.reset()},e.prototype.addInset=function(e){!1!==e.wrapText&&(e.wrapText=!0),this._insets.insert(e),this._typher.reset()},e.prototype.addAlignAttr=function(e){this._aligns.insert(e),this._typher.reset()},e.prototype.removeAlignAttr=function(t,n){e._removeAttr(this._aligns,t,n),this._typher.reset()},e.prototype.removeStyleAttr=function(t,n){e._removeAttr(this._styles,t,n),this._typher.reset()},e.prototype.removeInset=function(e,t){var n=this._insets.lbound({pos:e},!0);if(-1!==n){var r=this._insets.ubound({pos:t},!0);-1!==r&&(this._insets.at(n).pos<e&&++n,this._insets.at(r).pos>t&&--r,this._insets.remove(n,r-n+1),this._typher.reset())}},e.prototype.removeAllDecorator=function(e,t){this.removeStyleAttr(e,t),this.removeInset(e,t),this.removeAlignAttr(e,t)},e.prototype.defaultStyle=function(){return this._defalutStyle},e.prototype.aligns=function(){return this._aligns},e.prototype.styles=function(){return this._styles},e.prototype.str=function(){return this._str},e.prototype.insets=function(){return this._insets},e.prototype.iter=function(){return new et(this)},e.prototype._fillDefaultStyle=function(){var e=this._defalutStyle;if(e.fontInfo){var t=e.fontInfo;t.fontFamily||(t.fontFamily=We.fontFamily),t.fontSize||(t.fontSize=We.fontSize),t.fontStyle||(t.fontStyle=We.fontStyle),t.fontWeight||(t.fontWeight=We.fontWeight)}else e.fontInfo=We;e.color||(e.color="black")},e._removeAttr=function(e,t,n){var r=e.lbound({rg:{from:t,to:n}},!0);if(-1!==r){var i=e.ubound({rg:{from:n,to:n}},!0);if(-1!==i){var o=e.at(r);o.rg.to<t&&++r<e.len()&&(o=e.at(r));var a=e.at(i);a.rg.from>n&&--i>=0&&(a=e.at(i)),e.remove(r,i-r+1),o.rg.from<t&&t<o.rg.to&&(o.rg.to=t-1,e.insert(o)),a.rg.from<n&&n<a.rg.to&&(a.rg.from=n+1,e.insert(a))}}},e}(),et=function(){function t(e){this._reader=e,this._citer=new Xe(this._reader.str()),this._insetIter=this._reader.insets().iter(),this._styleIter=this._reader.styles().iter(),this._alignIter=this._reader.aligns().iter()}return t.prototype.reset=function(){this._citer.reset(this._reader.str()),this._insetIter.reset(this._reader.insets().getArray()),this._styleIter.reset(this._reader.styles().getArray()),this._alignIter.reset(this._reader.aligns().getArray())},t.prototype.next=function(){var e=this._citer,t=this._insetIter,n=this._reader.insets(),r=this._reader.str();if(this.isValid())if(e.isValid()&&t.isValid())t.value().pos===e.idx()?t.next():t.value().pos<e.idx()?(t.next(),t.isValid()&&t.value().pos===e.idx()||e.next()):e.next();else if(e.isValid()&&!t.isValid()){var i=e.idx()+e.units();e.next();var o=n.first();o&&(!e.isValid()&&o.pos>=i||o.pos===e.idx())&&t.next()}else!e.isValid()&&t.isValid()&&(i=t.value().pos,t.next(),i<=0&&(!t.isValid()||t.value().pos>0)&&e.next());else n.len()?r.length?n.first().pos<=0?t.next():e.next():t.next():e.next(),this._styleIter.next(),this._alignIter.next();return this._nextAttr(),this.isValid()?this:null},t.prototype.prev=function(){var e=this._citer,t=this._insetIter,n=this._reader.insets(),r=this._reader.str();if(this.isValid())if(e.isValid()&&t.isValid()){var i=function(){e.prev(),t.isValid()&&e.idx()===t.value().pos&&t.next()};t.value().pos>=e.idx()?(t.prev(),t.isValid()&&t.value().pos===e.idx()||i()):i()}else if(e.isValid()&&!t.isValid()){var o=n.last();if(o&&o.pos===e.idx())t.prev();else{var a=e.idx();e.prev(),o&&!e.isValid()&&o.pos<=a&&t.prev()}}else!e.isValid()&&t.isValid()&&(a=t.value().pos,r.length>0&&a>=r.length?e.prev():(t.prev(),r.length>0&&r.length<=a&&(!t.isValid()||t.value().pos<r.length)&&e.prev()));else n.len()?r.length?n.last().pos>=r.length?t.prev():e.prev():t.prev():e.prev(),this._styleIter.prev(),this._alignIter.prev();return this._prevAttr(),this.isValid()?this:null},t.prototype.value=function(){return this.atInset()?this._insetIter.value():this._citer.char()},t.prototype.codePoint=function(){return this._citer.codePoint()},t.prototype.char=function(){return this._citer.char()},t.prototype.charPos=function(){return this._citer.isValid()?this._citer.idx():this._insetIter.isValid()?this._insetIter.value().pos:-1},t.prototype.units=function(){return this._citer.units()},t.prototype.isValid=function(){return this._citer.isValid()||this._insetIter.isValid()},t.prototype.atInset=function(){var e=this._insetIter,t=this._citer;return!t.isValid()&&e.isValid()||e.isValid()&&e.value().pos===t.idx()},t.prototype.currentAlign=function(){var t=this._currentAttr(this._alignIter);return{hAlign:t&&t.hAlign||e.HorizontalAlign.Left,vAlign:t&&t.vAlign||e.VerticalAlign.Top}},t.prototype.currentStyle=function(){var e=this._currentAttr(this._styleIter);return null!==e?e.style:this._reader.defaultStyle()},t.prototype.seek=function(e){this._citer.seek(e);var t=this._attrIdx(this._reader.styles()),n=this._attrIdx(this._reader.aligns());return this._styleIter.seek(t),this._alignIter.seek(n),this},t.prototype._attrIdx=function(e){var t=this.charPos();return this._citer.isValid()?e.lbound({rg:{from:t,to:t}},!0):t},t.prototype._currentAttr=function(e){if(!e.isValid())return null;var t=e.value(),n=this.charPos();return n<t.rg.from||t.rg.to<n?null:t},t.prototype._nextAttr=function(){this._nextAttrIter(this._alignIter),this._nextAttrIter(this._styleIter)},t.prototype._prevAttr=function(){this._prevAttrIter(this._alignIter),this._prevAttrIter(this._styleIter)},t.prototype._nextAttrIter=function(e){if(e.isValid()){var t=this.charPos();t<0||t>e.value().rg.to&&e.next()}},t.prototype._prevAttrIter=function(e){if(e.isValid()){var t=this.charPos();t<0||t<e.value().rg.from&&e.prev()}},t}(),tt=function(){function n(e){this._typher=e,this._insetSegPainter=null}return n.prototype.setInsetSegPainter=function(e){this._insetSegPainter=e},n.prototype.paintLines=function(e){e.save();var t=this._typher.visualInfo();null!==t.ellipsLine&&this._paintLine(e,t.ellipsLine);for(var n=this._typher.lines(),r=0;r<t.lineCount;r++)this._paintLine(e,n[r]);e.restore()},n.prototype.convertThemeColor=function(e,t){return e},n.prototype._paintLine=function(e,t){var n=this,r=this._typher.stream().defaultStyle();t.segs.forEach((function(i){i instanceof it||n._paintSeg(e,i,t.baseline,t.maxTextSeg),n._insetSegPainter&&i instanceof it&&n._insetSegPainter.paint(e,i,r)}))},n.prototype._paintSeg=function(n,r,i,o){var a,s=this._typher.stream().defaultStyle(),u=r.style||s;a=r instanceof rt?r.ellipsis:this._typher.stream().str().substr(r.from,r.len);var l=u.fontInfo||s.fontInfo,c=s.fontInfo,h=l.fontSize||c.fontSize||Fe,d=l.fontFamily||c.fontFamily||"Arial",f=l.fontStyle||c.fontStyle||"normal",p=l.fontWeight||c.fontWeight||400,v=n.fillType;n.font=Be({fontSize:h,fontFamily:d,fontStyle:f,fontWeight:p}),n.fillStyle=this.convertThemeColor(u.color||s.color,t.ColorThemeType.Color),n.fillType=t.ColorThemeType.Color,n.fillText(a,r.rect.x,i),n.fillType=v;var g=(void 0!==u.decoration?u.decoration:s.decoration)||e.TextDecoration.None;if(g!==e.TextDecoration.None){var _=n.strokeType;n.strokeType=t.ColorThemeType.Color,"string"===n.fillStyle?n.strokeStyle=this.convertThemeColor(n.fillStyle,t.ColorThemeType.Color):n.strokeStyle=n.fillStyle;var y=Math.max(1,Math.floor(h/16));n.lineWidth=y;var m=r.rect.x,E=r.rect.width;if(g&e.TextDecoration.Bottom){var b=void 0;if(o){var T=o.style.fontInfo,C=T&&T.fontSize||c.fontSize||Fe,S=Math.max(1,Math.floor(C/16));b=o.rect.maxY-(o.rect.height-C)/2,b=Math.min(o.rect.maxY-S,b)}else b=r.rect.maxY-(r.rect.height-h)/2,b=Math.min(r.rect.maxY-y,b);n.beginPath(),n.moveTo(m,b),n.lineTo(m+E,b),n.stroke()}if(g&e.TextDecoration.Mid&&(b=r.rect.y+r.rect.height/2,n.beginPath(),n.moveTo(m,b),n.lineTo(m+E,b),n.stroke()),g&e.TextDecoration.Top){if(b=void 0,o){var w=o.style.fontInfo,R=w&&w.fontSize||c.fontSize||Fe;b=o.rect.y-(o.rect.height-R)/2}else b=r.rect.y+(r.rect.height-h)/2;n.beginPath(),n.moveTo(m,b),n.lineTo(m+E,b),n.stroke()}n.strokeType=_}},n.prototype.flush=function(e){},n}(),nt=function(){function e(e,t,n,r,i){this.from=e,this.len=t,this.chars=n,this.rect=r,this.style=i}return e.prototype.clone=function(){return new e(this.from,this.len,this.chars,this.rect.clone(),this.style)},e}(),rt=function(){function e(e,t,n){this.rect=e,this.ellipsis=t,this.style=n}return e.prototype.clone=function(){return new e(this.rect.clone(),this.ellipsis,this.style)},e}(),it=function(){function e(e,t){this.rect=e,this.inset=t}return e.prototype.clone=function(){return new e(this.rect.clone(),this.inset)},e}();!function(e){e[e.Existed=0]="Existed",e[e.Nope=1]="Nope"}(Je||(Je={}));var ot,at=function(){function n(e){this._lines=[],this._cursor=new t.FPoint(0,0),this._typhyLine=null,this._effectedInset=[],this._ellipsisStatus=Je.Nope,this._stream=new Qe(this,e.defaultStyle),this._width=e.width||Number.MAX_VALUE,this._maxWidth=e.maxWidth||-1,this._minWidth=e.minWidth||-1,this._height=e.height||Number.MAX_VALUE,this._wordWrap=!!e.wordWrap,this._ellipsis=e.ellipsis,this._inlineAlign=!1!==e.inlineAlign,this._iter=this._stream.iter(),this._textSeg=null,this._wordsBox={width:0,height:0,segs:[]},this._currMeasure=this._newMeasurer(this._stream.defaultStyle()),this._visualInfo={x:Number.MAX_VALUE,lineCount:0,width:0,height:0,ellipsLine:null}}return n.createTypographer=function(e){return void 0===e&&(e={ellipsis:null}),new n(e)},n.createTypographyPainter=function(e){return new tt(e)},n.prototype.typography=function(e){var t=this._iter;if(e=Math.min(e,this._height),!(this._cursor.y>=e)&&(!(this._lines.length>0)||t.isValid())){for(;this._cursor.y<e&&null!==t.next();){var n=t.value();if(t.atInset()?this._placeInset(n):"\r"===n||"\n"===n?(this._segMeasureIn(),this._smartPlaceWord(!1),this._placeWords(),null===this._typhyLine&&this._newLine(),this._placeLine(!1),"\r"===n&&(null!==t.next()&&"\n"===t.char()||t.prev())):Xe.breakableChar(t)?(this._segMeasureIn(),this._smartPlaceWord(!0),n===t.value()&&(this._preplaceChar(),this._segMeasureIn(),this._smartPlaceWord(!0))):this._preplaceChar(),!t.isValid())break}this._segMeasureIn(),this._smartPlaceWord(!0),this._placeWords(),this._placeLine(!0),this._updateVisualInfo();var r=this._visualInfo.ellipsLine;r&&(this._alignHorizontal(r),this._alignVertical(r))}},n.prototype.updateOptions=function(e){this._width=e.width||Number.MAX_VALUE,this._maxWidth=e.maxWidth||-1,this._minWidth=e.minWidth||-1,this._height=e.height||Number.MAX_VALUE,this._wordWrap=!!e.wordWrap,this._ellipsis=e.ellipsis,this._inlineAlign=!1!==e.inlineAlign,e.defaultStyle&&this._stream.updateDefaultStyle(e.defaultStyle),this.reset()},n.prototype.reset=function(){this._lines.length=0,this._iter.reset(),this._effectedInset.length=0,this._cursor.x=0,this._cursor.y=0,this._typhyLine=null,this._resetWordBox(),this._resetTyphingWords(),this._updateMeasurer(this._stream.defaultStyle()),this._visualInfo.lineCount=0,this._visualInfo.width=0,this._visualInfo.height=0,this._visualInfo.ellipsLine=null,this._ellipsisStatus=Je.Nope},n.prototype.visualInfo=function(){return this._visualInfo},n.prototype.stream=function(){return this._stream},n.prototype.lines=function(){return this._lines},n.prototype.wordWrap=function(){return this._wordWrap||!1},n.prototype.isOverflowWithEllipsis=function(){return this._ellipsisStatus===Je.Existed},n.prototype.posHitChar=function(e){var n=new t.SortedArray((function(e,t){return e.y<t.y?-1:e.y>t.y?1:0}),this._lines),r=n.lbound({y:e.y},!0);if(-1===r)return-1;var i=n.at(r);if(i.y<=e.y&&e.y<i.y+i.height){var o=new t.SortedArray((function(e,t){return e.rect.x<t.rect.x?-1:e.rect.x>t.rect.x?1:0}),i.segs),a=o.lbound({rect:{x:e.x}},!0);if(-1===a)return-1;var s=o.at(a);if(s instanceof nt&&s.rect.x<=e.x&&e.x<s.rect.maxX)return this._measureChar(s,e.x-s.rect.x,!1).idx}return-1},n.prototype.posHitSeg=function(e){var n=new t.SortedArray((function(e,t){return e.y<t.y?-1:e.y>t.y?1:0}),this._lines),r=n.lbound({y:e.y},!0);if(-1===r)return null;var i=n.at(r);if(i.y<=e.y&&e.y<i.y+i.height){var o=new t.SortedArray((function(e,t){return e.rect.x<t.rect.x?-1:e.rect.x>t.rect.x?1:0}),i.segs),a=o.lbound({rect:{x:e.x}},!0);if(-1===a)return null;var s=o.at(a);if(s.rect.x<=e.x&&e.x<s.rect.maxX)return s}return null},n.prototype.charRect=function(e){var n=new t.FRect,r=[],i=this._lines.filter((function(e){var t=e.segs.filter((function(e){return e instanceof nt}));return t.length>0&&(r.push(t),!0)})),o=new t.SortedArray((function(e,t){return e.from<t.from?-1:e.from>t.from?1:0}),i).lbound({from:e},!0);if(-1===o)return n;var a=new t.SortedArray((function(e,t){return e.from<t.from?-1:e.from>t.from?1:0}),r[o]),s=a.lbound({from:e},!0);if(-1===s)return n;var u=a.at(s);if(u.from<=e&&e<u.from+u.len){var l=this._newMeasurer(u.style),c=this._stream.str().substr(u.from,e-u.from);n.y=u.rect.y,n.height=u.rect.height,n.x=u.rect.x+l.measureWord(c);var h=new Xe(this._stream.str());h.seek(e),n.width=l.measureWord(h.char())}return n},n.prototype._alignHorizontal=function(n){if(n.hAlign!==e.HorizontalAlign.Left){var r=this._width!==Number.MAX_VALUE?this._validWidth(this._width):this._validWidth(this._visualInfo.width),i=n.segs,o=[new t.FRect(0,n.y,r,n.height)],a=function(){if(0!==i.length){for(var t=i[i.length-1].rect.maxX-i[0].rect.x,r=o.shift();r&&o.length&&r.width<t;)r=o.shift();if(r){var a=r.x-i[0].rect.x,s=r.width-t;n.hAlign===e.HorizontalAlign.Right?i.forEach((function(e){return e.rect.x+=a+s})):i.forEach((function(e){return e.rect.x+=a+s/2}))}}};a(),this._effectedInset.length&&(i=[],o=[new t.FRect(0,n.y,r,n.height)],this._effectedInset.forEach((function(e){var n=[];o.forEach((function(r){if(r.intersect(e.seg.rect)){var i=e.seg.rect.x;i>r.x&&n.push(new t.FRect(r.x,r.y,i-r.x,r.height));var o=e.seg.rect.maxX;o<r.maxX&&n.push(new t.FRect(o,r.y,r.maxX-o,r.height))}else n.push(r)})),o=n})),o.sort((function(e,t){return e.x<t.x?-1:e.x>t.x?1:0})),n.segs.forEach((function(e){i.length&&(e instanceof it||i[i.length-1].rect.maxX!==e.rect.x)?(a(),i.length=0,e instanceof it||i.push(e)):i.push(e)})),a())}},n.prototype._alignVertical=function(e){var t=this,n=this._stream.defaultStyle().fontInfo;if(e.segs.forEach((function(t){if(!(t instanceof it&&!0!==t.inset.inline)){var r=n;t instanceof nt&&t.style&&(r=t.style.fontInfo||n),t instanceof it||(t.rect.height=r.fontSize||n.fontSize),t instanceof nt&&(!e.maxTextSeg||t.rect.height>e.maxTextSeg.rect.height)&&(e.maxTextSeg=t)}})),e.maxTextSeg){var r=e.maxTextSeg.style.fontInfo,i=r&&r.fontFamily||n.fontFamily||"Arial";e.maxTextSeg.rect.y=this._calcSegYByVAlign(e,e.maxTextSeg),e.baseline=e.maxTextSeg.rect.y+e.maxTextSeg.rect.height*Ye.getBaseline(i),e.segs.forEach((function(n){n!==e.maxTextSeg&&(n.rect.y=t._calcSegYByBaseline(e,n))}))}else e.segs.forEach((function(n){n.rect.y=t._calcSegYByVAlign(e,n)}))},n.prototype._calcSegYByVAlign=function(t,n){return this._inlineAlign&&t.vAlign!==e.VerticalAlign.Center?t.vAlign===e.VerticalAlign.Bottom?t.y+t.height-n.rect.height:t.y:t.y+t.height/2-n.rect.height/2},n.prototype._calcSegYByBaseline=function(e,t){if(t instanceof it&&!0!==t.inset.inline)return this._calcSegYByVAlign(e,t);var n=this._stream.defaultStyle().fontInfo,r=n;t instanceof nt&&t.style&&(r=t.style.fontInfo||n);var i=r&&r.fontFamily||n.fontFamily||"Arial";return e.baseline-t.rect.height*Ye.getBaseline(i)},n.prototype._rsegsSplit=function(e,t,n){for(var r=[],i=new Xe(this._stream.str()),o=e.length-1;o>=0;o--){var a=e[o];if(!(a instanceof nt))break;i.seek(a.from+a.len);for(var s=0;null!==i.prev()&&i.idx()>=a.from&&!t(a,i);)++s;var u=i.idx();if(n||(u+=i.units()),!(u<=a.from)){var l=this._splitSeg(a,u,s);r.unshift(l);break}r.unshift(a),e.pop()}return r},n.prototype._splitSeg=function(e,t,n){var r=new nt(t,e.from+e.len-t,n,e.rect.clone(),e.style);e.len-=r.len,e.chars-=n;var i=this._stream.str().substr(r.from,r.len);return r.rect.width=i?this._newMeasurer(r.style).measureWord(i):0,e.rect.width-=r.rect.width,r},n.prototype._trim=function(e){if(null!==e){var t=new Xe(this._stream.str()),n=e.from+e.len;t.seek(e.from);for(var r=0;t.idx()<n&&" "===t.char();)t.next(),r++;var i=t.idx();i===n?(e.len=0,e.chars=0,e.rect.width=0,e.from=i):i>e.from&&(e=this._splitSeg(e,i,r))}},n.prototype._trimEnd=function(e){var t=this._rsegsSplit(e.segs,(function(e,t){return" "!==t.char()}),!1);return t.length>0&&(e.height=(e.segs.length?e.segs:t).reduce((function(e,t){return t instanceof nt?Math.max(e,t.rect.height):e}),0),e.width-=t.reduce((function(e,t){return e+t.rect.width}),0)),t},n.prototype._placeLine=function(e){if(null!==this._typhyLine){var t=this._typhyLine;t.segs.length>0&&this._trimEnd(t),this._cursor.x=0,t.y=this._cursor.y,this._cursor.y+=t.height,this._effectedInset.length>0&&(t.refLines=this._effectedInset.map((function(e){return e.place}))),this._width!==Number.MAX_VALUE&&this._alignHorizontal(t),this._alignVertical(t),this._typhyLine=null,e&&this._currPosIsLineBegin()&&" "===this._iter.value()&&(this._skipBlank()," "===this._iter.value()&&this._skipOneLineBreak())}},n.prototype._currPosIsLineBegin=function(){return this._textSeg&&this._textSeg.from===this._iter.charPos()},n.prototype._skipOneLineBreak=function(){this._iter.next(),"\r"===this._iter.value()?this._iter.next():"\n"!==this._iter.value()&&this._iter.prev()},n.prototype._newLine=function(){this._shakeInsets(this._cursor.y);var e=this._iter.charPos();this._wordsBox.segs.length>0?e=this._wordStart(this._wordsBox):this._textSeg&&(e=this._textSeg.from);var t=this._alignment(e),n=t.hAlign,r=t.vAlign,i=this._currLineHeight();this._typhyLine={hAlign:n,vAlign:r,y:this._cursor.y,segs:[],from:e,width:0,height:i,baseline:i*Ye.DefaultBaselineRatio},this._lines.push(this._typhyLine)},n.prototype._shakeInsets=function(e){this._effectedInset=this._effectedInset.filter((function(t){return e<t.seg.rect.maxY}))},n.prototype._placeInset=function(e){var n;if(this._segMeasureIn(),this._smartPlaceWord(!0),null!==this._wordsBox&&(this._trimEnd(this._wordsBox),this._placeWords()),e.wrapText){var r=this._typhyLine?this._typhyLine.height:0;(n=this._findEmptySpace(this._cursor.x,this._cursor.y,e.width,Math.max(e.height,r))).y!==this._cursor.y&&(this._placeLine(!1),this._cursor=n)}else this._placeLine(!0),n=new t.FPoint(this._cursor.x,this._cursor.y);null==this._typhyLine&&this._newLine();var i=new it(new t.FRect(n.x,n.y,e.width,e.height),e),o=this._typhyLine;o.segs.push(i),o.width+=i.rect.width,!0!==e.inline&&e.wrapText?this._effectedInset.push({place:this._lines.length,seg:i}):o.height=Math.max(o.height,e.height),this._cursor.x=i.rect.maxX,e.wrapText||this._placeLine(!0),this._skipBlank()},n.prototype._findEmptySpace=function(e,n,r,i){var o=this._contentWidth(),a=function(){e=0,n+=i},s=0;do{s=0,0!==e&&e+r>o&&a(),this._effectedInset.forEach((function(t){var u=t.seg.rect;u.x<e+r&&e<u.maxX&&u.y<n+i&&n<u.maxY&&(o-u.maxX>r?e=u.maxX:e>r?a():(e=0,n=u.maxY),s++)}))}while(s);return new t.FPoint(e,n)},n.prototype._newMeasurer=function(t){var n=this._stream.defaultStyle().fontInfo,r=t.fontInfo||n;return new Ye(r.fontFamily||n.fontFamily,r.fontWeight||e.FontWeight.normal,r.fontSize||n.fontSize)},n.prototype._updateMeasurer=function(t){var n=this._stream.defaultStyle().fontInfo,r=t.fontInfo||n;this._currMeasure.update(r.fontFamily||n.fontFamily,r.fontWeight||e.FontWeight.normal,r.fontSize||n.fontSize)},n.prototype._contentWidth=function(){return!0===this._wordWrap?this._validWidth(this._width):Number.MAX_VALUE},n.prototype._alignment=function(t){if(t!==this._iter.charPos()){var n=this._stream.aligns(),r=n.lbound({rg:{from:t,to:t}},!0);if(-1!==r){var i=n.at(r);if(i.rg.to>=t)return{hAlign:i.hAlign,vAlign:i.vAlign}}return{hAlign:e.HorizontalAlign.Left,vAlign:e.VerticalAlign.Top}}return this._iter.currentAlign()},n.prototype._resetTyphingWords=function(){this._wordsBox.segs.length=0,this._wordsBox.height=0,this._wordsBox.width=0},n.prototype._newAttrSeg=function(){var e=this._iter.currentStyle();this._updateMeasurer(e);var n=new nt(this._iter.charPos(),0,0,new t.FRect(0,0,0,this._currLineHeight()),e);this._textSeg=n},n.prototype._applyEllipsis=function(e){for(var n=this._stream.defaultStyle(),r=0,i=e.segs,o=this._validWidth(this._width),a=i.length-1;a>=0;a--){var s=i[a],u=void 0;s instanceof nt?(n=s.style,u=this._newMeasurer(n)):u=this._currMeasure;var l=o-(r=u.measureWord(this._ellipsis));if(s.rect.x>=l)i.pop();else if(s.rect.maxX>l&&s instanceof nt){this._splitSegByWidth(s,l-s.rect.x,!1);break}}var c=0;if(i.length>0){if(i[i.length-1]instanceof rt)return;c=i[i.length-1].rect.maxX}var h=new rt(new t.FRect(c,e.y,r,this._currLineHeight()),this._ellipsis,n);i.push(h),e.width=h.rect.maxX,this._ellipsisStatus=Je.Existed},n.prototype._preplaceChar=function(){if(null===this._textSeg)this._newAttrSeg();else{var e=this._textSeg,t=this._iter.currentStyle();e.style!==t&&(this._segMeasureIn(),this._smartPlaceWord(!1),this._newAttrSeg())}this._textSeg.len+=this._iter.units(),this._textSeg.chars+=1},n.prototype._tryEarlyCheckIn=function(){null===this._typhyLine&&this._newLine();var t=this._typhyLine,n=this._textSeg,r=this._wordsBox;!this._wordWrap&&this._cursor.x+r.width+n.rect.width>this._validWidth(this._width)&&(null!==this._ellipsis||t.hAlign===e.HorizontalAlign.Left)&&(this._placeWord(!0),this._placeWords(),null!==this._ellipsis?(this._applyEllipsis(t),this.isNowLineBreak()||this._skipToNextLine()):t.hAlign===e.HorizontalAlign.Left&&(this.isNowLineBreak()||this._skipToNextLine()))},n.prototype._segMeasureIn=function(){if(null!==this._textSeg){var e=this._textSeg,t=this._stream.str().substr(e.from,e.len),n=this._currMeasure.measureWord(t);e.rect.width+=n,this._tryEarlyCheckIn()}},n.prototype._smartPlaceWord=function(e){var t=this._textSeg;if(null!==t){var n=this._wordsBox,r=this._cursor.x,i=this._cursor.y,o=Math.max(t.rect.height,n.height);null!==this._typhyLine&&(o=Math.max(this._typhyLine.height,o));var a=this._findEmptySpace(r+n.width,i,t.rect.width,Math.max(n.height,o));a.x!==r+n.width||a.y!==i?n.segs.length>0?(this._placeWords(),this._smartPlaceWord(e)):(a.y!==i&&this._placeLine(e),this._cursor=a,this._trim(t),this._placeWord(e)):this._placeWord(e)}},n.prototype._placeWord=function(e){var t=this._textSeg;if(null!==t){var n=this._validWidth(this._width);if(this._wordWrap&&t.rect.width>n){for(;t&&t.rect.width>n;)this._textSeg=this._splitSegByWidth(t,n,!0),this._trim(t),t.chars>0&&(this._innerPlaceInWord(t),this._innerPlaceWords(),this._placeLine(e)),t=this._textSeg;null!==this._textSeg&&this._placeWord(e)}else this._innerPlaceInWord(this._textSeg),this._resetWordBox()}},n.prototype._innerPlaceInWord=function(e){if(!(null===e||e.len<=0)){var t=this._wordsBox;t.width+=e.rect.width,this._connectTextSegs(t.segs,[e],!1),t.height=Math.max(e.rect.height,t.height)}},n.prototype._placeWords=function(){this._innerPlaceWords()},n.prototype._wordStart=function(e){var t=0;return e.segs.forEach((function(e){return e instanceof nt&&(t=e.from,!0)})),t},n.prototype._innerPlaceWords=function(){if(0!==this._wordsBox.segs.length){null===this._typhyLine&&this._newLine();var e=this._typhyLine,t=this._cursor.x,n=this._cursor.y;this._wordsBox.segs.forEach((function(e){e.rect.x=t,e.rect.y=n,t=e.rect.maxX})),this._connectTextSegs(e.segs,this._wordsBox.segs,!0),e.height=Math.max(e.height,this._wordsBox.height),e.width+=this._wordsBox.width,this._cursor.x=t,this._resetTyphingWords()}},n.prototype._connectTextSegs=function(e,t,n){if(e.length>0&&t.length>0){var r=e[e.length-1],i=t[0];r instanceof nt&&r.style===i.style&&(!n||r.rect.maxX===i.rect.x)&&(i.rect.x=r.rect.x,i.from=r.from,i.len+=r.len,i.chars+=r.chars,i.rect.width+=r.rect.width,e.pop())}Array.prototype.push.apply(e,t)},n.prototype._resetWordBox=function(){this._textSeg=null},n.prototype.isNowLineBreak=function(){var e=this._iter.value();return"\r"===e||"\n"===e},n.prototype._skipToNextLine=function(){var e=function(e){return"\r"===e||"\n"===e};this._skipTo(e)},n.prototype._skipBlank=function(){this._skipTo((function(e){return" "!==e}))},n.prototype._skipTo=function(e){var t=this._iter;do{if(null===t.next()||e(t.value())){t.prev();break}}while(t.isValid())},n.prototype._updateVisualInfo=function(){var e=this._visualInfo;e.lineCount=this._lines.length,e.width=0,e.height=0;var t=this._lines;if(null!==this._ellipsis){for(var n=t.length-1;n>0&&!((i=t[n]).y+i.height<=this._height);)--n;if(e.lineCount=n+1,e.lineCount<t.length||this._iter.isValid()||n>=0&&n<t.length&&t[n].width>this._validWidth(this._width)){var r=s({},t[n]);r.segs=r.segs.map((function(e){return e.clone()})),this._applyEllipsis(r),e.ellipsLine=r,e.lineCount-=1}}if(e.lineCount>0){for(n=0;n<e.lineCount;n++){var i=t[n];e.width=Math.max(i.width,e.width),i.segs.length>0&&(e.x=Math.min(i.segs[0].rect.x,e.x))}var o=t[e.lineCount-1];e.height=o.y+o.height}null!==e.ellipsLine&&(e.width=Math.max(e.width,e.ellipsLine.width),e.height=e.ellipsLine.y+e.ellipsLine.height)},n.prototype._splitSegByWidth=function(e,t,n){var r=this._measureChar(e,t,n),i=r.chars,o=r.idx,a=r.measureWidth;if(e.chars-i>0){var s=e.clone();return s.chars=e.chars-i,s.from=o,s.len=e.from+e.len-s.from,s.rect.width=e.rect.width-a,s.rect.x=e.rect.x+i,e.len-=s.len,e.chars=i,e.rect.width=a,s}return null},n.prototype._measureChar=function(e,t,n){var r=new Xe(this._stream.str()),i=e.rect.width/e.chars,o=Math.floor(t/i);r.seek(e.from);for(var a=0;a<o&&null!==r.next();a++);for(var s=this._stream.str().substr(e.from,r.idx()-e.from),u=this._newMeasurer(e.style),l=u.measureWord(s);l<t&&r.isValid();)l+=u.measureWord(r.char()),++o,r.next();for(;(!n||o>1)&&l>t&&null!==r.prev();)l-=u.measureWord(r.char()),--o;return{idx:r.idx(),chars:o,measureWidth:l}},n.prototype._currLineHeight=function(){var e=this._iter.currentStyle().lineHeight||this._stream.defaultStyle().lineHeight||0;return e>0?e:this._currMeasure.lineHeight()},n.prototype._validWidth=function(e){return this._maxWidth>0&&(e=Math.min(this._maxWidth,e)),this._minWidth>0&&(e=Math.max(this._minWidth,e)),e<0&&(e=Number.MAX_VALUE),e},n}();function st(e,t){return{width:Math.max(Math.min(t.width,e.maxWidth),e.minWidth),height:Math.max(Math.min(t.height,e.maxHeight),e.minHeight)}}e.WdkFvgType=void 0,(ot=e.WdkFvgType||(e.WdkFvgType={})).image="wdk/image",ot.label="wdk/label",ot.text="wdk/text",ot.richtext="wdk/richtext";var ut,lt=function(r){function o(e,t){var n=r.call(this,e,t)||this;return n._typher=null,n._painter=null,n._autoWidth=!0,n._autoHeight=!0,n._autoSet=!1,n}return i(o,r),Object.defineProperty(o.prototype,"typher",{get:function(){return this._typher||(this._typher=o.typoCreator.createTypographer(this._typographyOptions())),this._typher},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"painter",{get:function(){return this._painter||(this._painter=o.typoCreator.createTypographyPainter(this.typher)),this._painter},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fontSize",{get:function(){return this._cfg.fontSize},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fontFamily",{get:function(){return this._cfg.fontFamily},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fontStyle",{get:function(){return this._cfg.fontStyle},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fontWeight",{get:function(){return this._cfg.fontWeight},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"lineHeight",{get:function(){return this._cfg.lineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"text",{get:function(){return this._cfg.text},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"color",{get:function(){return this._cfg.color},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"textDecoration",{get:function(){return this._cfg.textDecoration||0},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"hAlign",{get:function(){return this._cfg.hAlign},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"vAlign",{get:function(){return this._cfg.vAlign},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"wordWrap",{get:function(){return this._cfg.wordWrap||!1},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"ellipsis",{get:function(){return this._cfg.ellipsis},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"minWidth",{get:function(){return this._cfg.minWidth||-1},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"minHeight",{get:function(){return this._cfg.minHeight||-1},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"maxWidth",{get:function(){return this._cfg.maxWidth||-1},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"maxHeight",{get:function(){return this._cfg.maxHeight||-1},enumerable:!1,configurable:!0}),o.prototype.fvgNode=function(){var t=r.prototype.fvgNode.call(this);return t.type=e.WdkFvgType.label,t.cfg.fontSize=this.fontSize,this.fontFamily&&(t.cfg.fontFamily=this.fontFamily),this.fontStyle&&(t.cfg.fontStyle=this.fontStyle),this.fontWeight&&(t.cfg.fontWeight=this.fontWeight),this.lineHeight&&(t.cfg.lineHeight=this.lineHeight),this.ellipsis&&(t.cfg.ellipsis=this.ellipsis),this.wordWrap&&(t.cfg.wordWrap=this.wordWrap),t.cfg.color=this.color,t.cfg.text=this.text,t.cfg.hAlign=this.hAlign,t.cfg.vAlign=this.vAlign,t.cfg.textDecoration=this.textDecoration,t.cfg.minHeight=this.minHeight,t.cfg.maxHeight=this.maxHeight,t.cfg.minWidth=this.minWidth,t.cfg.maxWidth=this.maxWidth,t.cfg.inlineAlign=this._cfg.inlineAlign,this._autoWidth&&delete t.cfg.width,t},o.prototype.posHitChar=function(e){return this.typher.posHitChar(e)},o.prototype.charRect=function(e){var t=this.contentRect(!0).move(-this.x,-this.y);return this.typher.charRect(e).move(t.x,t.y)},o.prototype.release=function(){this.typher.reset(),this.setParent(null)},o.prototype.reuse=function(e){this._autoWidth=!0,this._autoHeight=!0,this._autoSet=!1,this.typher.reset(),this._cfg=this._defalutCfg(),this._changes.clear(),this.typher.stream().removeAllDecorator(0,Number.MAX_VALUE),this.typher.stream().updateStr(""),this._insetCache&&(this._insetCache.forEach((function(e,t){return e.destroy()})),this._insetCache.clear()),this.updateByCfg(e)},o.prototype.isOmitted=function(){return this.typher.isOverflowWithEllipsis()},o.prototype.insetCreator=function(e,t){return null},o.prototype.afterChange=function(e){return this._autoSet||("width"in e.changes&&(this._autoWidth=e.changes.width.current<0),"height"in e.changes&&(this._autoHeight=e.changes.height.current<0)),r.prototype.afterChange.call(this,e)},o.prototype.beforeChange=function(e){var t=e.changes.width;t&&(t.current=this._validWidth(t.current));var n=e.changes.height;n&&(n.current=this._validHeight(n.current))},o.prototype.afterFlush=function(e){var n=this;r.prototype.afterFlush.call(this,e);var i=!1,a=0;this._autoHeight&&"height"in e.changes&&(a+=1),this._autoWidth&&"width"in e.changes&&(a+=1),Object.keys(e.changes).length!==a&&(o._typographyOptions.some((function(t){return t in e.changes}))&&(i=!0,this.typher.updateOptions(this._typographyOptions()),this.painter.convertThemeColor=function(e,r){return t.convertThemeColor(n,e,r)}),"text"in e.changes&&(i=!0,this.typher.stream().updateStr(this._cfg.text)),this._beforeTypography(e)&&(i=!0),i&&this._typography())},o.prototype._beforeTypography=function(e){return!!o._alignOptions.some((function(t){return t in e.changes}))&&(this._setAlign(),!0)},o.prototype._setAlign=function(){var e=this.typher.stream(),t=this._cfg.text.length-1;e.aligns().clear(),e.addAlignAttr({rg:{from:0,to:t},hAlign:this._cfg.hAlign,vAlign:this._cfg.vAlign})},o.prototype.renderWidget=function(e,t){r.prototype.renderWidget.call(this,e,t);var i=this.contentRect(!0),o=this.typher.visualInfo(),a=h(this._paddingBorderSize(),2),s=a[0],u=a[1];if(o.width+s>this.width||o.height+u>this.height){e.beginPath();var l=this.paintedRect();n.preciseRect(e,l),e.clip()}e.translate(i.x,i.y),this.painter.paintLines(e),e.translate(-i.x,-i.y)},o.prototype._defalutCfg=function(){var t=r.prototype._defalutCfg.call(this);return t.fontFamily="Arial",t.fontSize=12,t.color="#000",t.text="",t.hAlign=e.HorizontalAlign.Left,t.vAlign=e.VerticalAlign.Top,t.textDecoration=0,t.width=-1,t.height=-1,t.minHeight=-1,t.maxHeight=-1,t.minWidth=-1,t.maxWidth=-1,t.inlineAlign=!1,t},o.prototype._typography=function(){var e=this,t=this._autoHeight?Number.MAX_VALUE:this._cfg.height;if(t=this._validHeight(t),this.typher.typography(t),this._autoHeight||this._autoWidth){var n=this.typher.visualInfo(),r=h(this._paddingBorderSize(),2),i=r[0],o=r[1],a=n.width+i,s=n.height+o;this._autoSet=!0,this._autoHeight&&this.updateByCfg({height:this._validHeight(s)}),this._autoWidth&&this.updateByCfg({width:this._validWidth(a)}),this._autoSet=!1}this.typher.lines().forEach((function(t){t.y<e.height&&t.segs.forEach((function(t){t instanceof it&&t.rect.x<e.width&&e._createInset(t)}))}))},o.prototype._typographyOptions=function(){var e=this.contentRect(!0),t=this._autoWidth?Number.MAX_VALUE:e.width,n=this._autoHeight?Number.MAX_VALUE:e.height,r={width:t,height:n=this._validHeight(n),wordWrap:this.wordWrap,ellipsis:void 0!==this.ellipsis?this.ellipsis:null,defaultStyle:{decoration:this._cfg.textDecoration,fontInfo:{fontSize:this._cfg.fontSize,fontFamily:this._cfg.fontFamily,fontStyle:this._cfg.fontStyle,fontWeight:this._cfg.fontWeight},color:this._cfg.color,lineHeight:this._cfg.lineHeight},inlineAlign:this._cfg.inlineAlign},i=this._paddingBorderSize()[0];return this.minWidth>0&&(r.minWidth=this.minWidth-i),this.maxWidth>0&&(r.maxWidth=this.maxWidth-i),r},o.prototype._createInset=function(e){if(this._insetCache||(this._insetCache=new Map),!this._insetCache.has(e)){var t=this.contentRect(!0).move(-this.x,-this.y),n=e.rect.clone().move(t.x,t.y),r=this.insetCreator(e.inset,n);r&&this._insetCache.set(e,r)}var i=this._insetCache.get(e);i&&i.parent()!==this&&i.setParent(this)},o.prototype._validWidth=function(e){return this.maxWidth>0&&(e=Math.min(this.maxWidth,e)),this.minWidth>0&&(e=Math.max(this.minWidth,e)),e},o.prototype._validHeight=function(e){return this.maxHeight>0&&(e=Math.min(this.maxHeight,e)),this.minHeight>0&&(e=Math.max(this.minHeight,e)),e},o.prototype._paddingBorderSize=function(){var e=0,n=0;if(this._cfg.border){var r=t.QuaterSplit(this._cfg.border,{width:0,color:""});e+=r[1].width+r[3].width,n+=r[0].width+r[2].width}if(this._cfg.padding){var i=t.QuaterSplit(this._cfg.padding,0);e+=i[1]+i[3],n+=i[0]+i[2]}return[e,n]},o._typographyOptions=["wordWrap","ellipsis","width","height","fontSize","maxWidth","maxHeight","minWidth","minHeight","fontFamily","fontStyle","fontWeight","lineHeight","color","inlineAlign"],o._alignOptions=["hAlign","vAlign","text"],o.typoCreator=at,o}(t.FWidget);e.FRichTextEvent=void 0,(ut=e.FRichTextEvent||(e.FRichTextEvent={}))[ut.HoverChar=t.CustomEventStart]="HoverChar";var ct,ht,dt,ft=function(t){function n(n,r,i){var o=t.call(this,e.FRichTextEvent.HoverChar,n)||this;return o.charIdx=r,o.srcEvent=i,o}return i(n,t),n}(t.FEvent),pt=function(n){function r(e){return n.call(this,e)||this}return i(r,n),r.prototype.setStyle=function(e,t,n){this.typher.stream().addStyleAttr({rg:{from:e,to:t},style:n}),this.detectLifetimeOnce(!0)},r.prototype.addInset=function(e){this.typher.stream().addInset(e),this.detectLifetimeOnce(!0)},r.prototype.addAlign=function(e,t,n){var r=n.hAlign,i=n.vAlign;this.typher.stream().addAlignAttr({rg:{from:e,to:t},hAlign:r,vAlign:i}),this.detectLifetimeOnce(!0)},r.prototype._beforeTypography=function(e){var t=this,r=n.prototype._beforeTypography.call(this,e);return"defaultStyle"in e.changes&&(this.typher.stream().updateDefaultStyle(this._cfg.defaultStyle),r=!0),"styles"in e.changes&&(this._cfg.styles.forEach((function(e){return t.setStyle(e.rg.from,e.rg.to,e.style)})),r=!0),"insets"in e.changes&&(this._cfg.insets.forEach((function(e){return t.addInset(e)})),r=!0),"aligns"in e.changes&&(this._cfg.aligns.forEach((function(e){return t.addAlign(e.rg.from,e.rg.to,{hAlign:e.hAlign,vAlign:e.vAlign})})),r=!0),r},r.prototype.mouseMove=function(e){return this._onMmouseMove(e),n.prototype.mouseMove.call(this,e)},r.prototype.mouseEnter=function(e){return this._onMmouseMove(e),n.prototype.mouseEnter.call(this,e)},r.prototype.mouseLeave=function(e){return t.ListenersControl.sendEvent(this,new ft(this,-1,e)),n.prototype.mouseLeave.call(this,e)},r.prototype.fvgNode=function(){var t=n.prototype.fvgNode.call(this);t.type=e.WdkFvgType.richtext;var r=this.typher.stream();return t.cfg.defaultStyle=r.defaultStyle(),t.cfg.styles=r.styles().toArray(),t.cfg.insets=r.insets().toArray(),t.cfg.aligns=r.aligns().toArray(),t},r.prototype._onMmouseMove=function(e){if(e.target===this){var n=this.posHitChar(new t.FPoint(e.x,e.y));if(-1!==n){t.ListenersControl.sendEvent(this,new ft(this,n,e));var r=this.typher.stream().styles(),i=r.lbound({rg:{from:n,to:n}},!0);if(-1!==i){var o=r.at(i),a="";(a=o.rg.from<=n&&n<=o.rg.to?o.style.cursor||this.cursor||"default":this.cursor||"default")!==this.cursor&&this.updateByCfg({cursor:a})}}}},r}(lt);e.SegmentType=void 0,(dt=e.SegmentType||(e.SegmentType={}))[dt.TextSegment=0]="TextSegment",dt[dt.InsetSegment=1]="InsetSegment",function(e){e.Left="left",e.Center="center",e.Right="right"}(ct||(ct={})),e.TextTrim=void 0,(ht=e.TextTrim||(e.TextTrim={}))[ht.None=0]="None",ht[ht.All=1]="All",ht[ht.Left=2]="Left",ht[ht.Right=3]="Right";var vt,gt=function(){function n(e,n,r){this._options=e,this._measurer=n,this._text="",this._viewText="",this._height=-1,this._ellipsisWidth=0,this._hasEllipsis=!1,this._textRect=new t.FRect(0,0,0,0),this._contentWidth=0,this._offsetX=0,this._offsetY=0;var i=r.words,o=r.height;this._height=o,this._text=i.join(""),this._updateFont(),this._typography(i),this._alignHorizontal(),this._alignVertical()}return n.textDefaultFontMeasurer=function(){return this._textDefaultFontMeasurer||(this._textDefaultFontMeasurer=new Ye(Ze.fontFamily,Ze.fontWeight,Ze.fontSize)),this._textDefaultFontMeasurer},Object.defineProperty(n.prototype,"_ellipsis",{get:function(){return this._options.ellipsis||""},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textRect",{get:function(){return this._textRect},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"viewText",{get:function(){return this._viewText},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hasEllipsis",{get:function(){return this._hasEllipsis},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"text",{get:function(){return this._text},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hAlign",{get:function(){return this._options.hAlign},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"vAlign",{get:function(){return this._options.vAlign},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"style",{get:function(){return{decoration:this._options.textDecoration,fontInfo:{fontSize:this._options.fontSize,fontFamily:this._options.fontFamily,fontStyle:this._options.fontStyle,fontWeight:this._options.fontWeight},color:this._options.color,lineHeight:this._height}},enumerable:!1,configurable:!0}),n.prototype.convertThemeColor=function(e,t){return e},n.prototype.paint=function(n){if(this._options.width&&this._height){var r=n.fillType;n.save(),n.beginPath(),n.font=Be({fontSize:this._options.fontSize,fontFamily:this._options.fontFamily,fontStyle:this._options.fontStyle,fontWeight:this._options.fontWeight}),n.fillStyle=this.convertThemeColor(this._options.color,t.ColorThemeType.Color),n.fillType=t.ColorThemeType.Color;var i=this._textRect.y+this._textRect.height*Ye.getBaseline(this._options.fontFamily),o=0;switch(this._options.hAlign){case e.HorizontalAlign.Left:n.textAlign=ct.Left;break;case e.HorizontalAlign.Center:o=this._contentWidth/2,n.textAlign=ct.Center;break;case e.HorizontalAlign.Right:o=this._contentWidth,n.textAlign=ct.Right}n.fillText(this.viewText,o+this._offsetX,i),this._paintTextDecoration(n),n.restore(),n.fillType=r}},n.prototype.offsetX=function(e){void 0===e&&(e=0),this._offsetX=e,this._alignHorizontal()},n.prototype.offsetY=function(e){void 0===e&&(e=0),this._offsetY=e,this._alignVertical()},n.prototype.addEllipsis=function(e){this._hasEllipsis||this._applyEllipsis(e)},n.prototype._typography=function(t){if(0===this._options.width)return this._viewText=this._text,void(this._textRect.width=0);if(this._options.width<0)return this._viewText=this._text,void(this._textRect.width=this._measureWords(t));if(this._ellipsis)this._textRect.width=this._measureWords(t),this._viewText=this._text,this._textRect.width>=this._options.width&&this._applyEllipsis(t);else switch(this._options.hAlign){case e.HorizontalAlign.Center:this._viewText=this._text,this._textRect.width=this._measureWords(t);break;case e.HorizontalAlign.Left:this._applyActualTextToRight(t);break;case e.HorizontalAlign.Right:this._applyActualTextToLeft(t)}this._options.contentWidth&&this._options.contentWidth>0?this._contentWidth=this._options.contentWidth:this._options.width>0?this._contentWidth=this._options.width:this._contentWidth=this._textRect.width},n.prototype._applyActualTextToRight=function(e){var t=[];this._textRect.width=0;for(var n=e.length,r=0;r<n&&this._textRect.width<=this._options.width;r++){var i=e[r];this._textRect.width+=this._measurer.measureWord(i),t.push(i)}this._viewText=t.join("")},n.prototype._applyActualTextToLeft=function(e){var t=[];this._textRect.width=0;for(var n=e.length-1;n>=0;n--){var r=e[n];this._textRect.width+=this._measurer.measureWord(r),t.splice(0,0,r)}this._viewText=t.join("")},n.prototype._applyEllipsis=function(e){this._hasEllipsis=!0;var t=e.slice();this._ellipsisWidth||(this._ellipsisWidth=this._measurer.measureWord(this._ellipsis));var n=this._options.width-this._ellipsisWidth;if(this._textRect.width>n){for(var r=e.length-1,i=void 0;r>=0&&n<=this._textRect.width;r--){var o=this._measurer.measureWord(e[r]);this._textRect.width-=o,i=t.pop()}if(i&&n>this._textRect.width){for(var a=new Xe(i),s="";n>this._textRect.width;)if(null!==a.next()){var u=this._measurer.measureWord(a.char());if(this._textRect.width+u>n)break;this._textRect.width+=u,s+=a.char()}t.push(s)}}else t=e.slice();t.push(this._ellipsis),this._viewText=t.join(""),this._textRect.width+=this._ellipsisWidth},n.prototype._updateFont=function(){this._textRect.height=this._options.fontSize},n.prototype.updateMeasurer=function(e){this._measurer=e},n.prototype._alignHorizontal=function(){if(this._options.width<=0)return this._textRect.x=this._offsetX,void(this._contentWidth=this._textRect.width);switch(this._options.hAlign){case e.HorizontalAlign.Left:this._textRect.x=0;break;case e.HorizontalAlign.Center:this._textRect.x=(this._contentWidth-this._textRect.width)/2;break;case e.HorizontalAlign.Right:this._textRect.x=this._contentWidth-this._textRect.width}this._textRect.x+=this._offsetX},n.prototype._alignVertical=function(){if(this._height<=0)this._textRect.y=this._offsetY;else if(this._options.inlineAlign){switch(this._options.vAlign){case e.VerticalAlign.Top:this._textRect.y=0;break;case e.VerticalAlign.Center:this._textRect.y=this._calcVerticalCenter();break;case e.VerticalAlign.Bottom:this._textRect.y=this._height-this._textRect.height}this._textRect.y+=this._offsetY}else this._textRect.y=this._offsetY+this._calcVerticalCenter()},n.prototype._calcVerticalCenter=function(){return(this._height-this._textRect.height)/2},n.prototype._paintTextDecoration=function(n){var r=this._options.textDecoration;if(r!==e.TextDecoration.None){var i=this._options.fontSize,o=Math.max(1,Math.floor(i/16)),a=this._textRect,s=a.x,u=a.y,l=a.width,c=a.height,h=a.maxY,d=n.strokeType;if("string"===n.fillStyle?n.strokeStyle=this.convertThemeColor(n.fillStyle,t.ColorThemeType.Color):n.strokeStyle=n.fillStyle,n.strokeType=t.ColorThemeType.Color,n.lineWidth=o,r&e.TextDecoration.Bottom){var f=h-(c-i)/2;f=Math.min(h-o,f),n.beginPath(),n.moveTo(s,f),n.lineTo(s+l,f),n.stroke()}r&e.TextDecoration.Mid&&(f=u+c/2,n.beginPath(),n.moveTo(s,f),n.lineTo(s+l,f),n.stroke()),r&e.TextDecoration.Top&&(f=u+(c-i)/2,n.beginPath(),n.moveTo(s,f),n.lineTo(s+l,f),n.stroke()),n.strokeType=d}},n.prototype._measureWords=function(e){var t=this;return e.reduce((function(e,n){return t._measurer.measureWord(n)+e}),0)},n._textDefaultFontMeasurer=null,n}(),_t=function(){function n(n){this._options={width:-1,height:-1,fontSize:Ze.fontSize,fontFamily:Ze.fontFamily,fontStyle:Ze.fontStyle,fontWeight:Ze.fontWeight,color:Ze.color,text:"",ellipsis:"",hAlign:e.HorizontalAlign.Left,vAlign:e.VerticalAlign.Top,textDecoration:e.TextDecoration.None,contentWidth:0,trim:e.TextTrim.None,inlineAlign:!0},this._text="",this._measurer=gt.textDefaultFontMeasurer(),this._lineHeight=this._measurer.lineHeight(),this._textRect=new t.FRect(0,0,0,0),this._painters=[],n&&this.update(n)}return Object.defineProperty(n.prototype,"text",{get:function(){return this._text},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textRect",{get:function(){return this._textRect},enumerable:!1,configurable:!0}),n.prototype.visualInfo=function(){return{x:this._textRect.x,lineCount:this._painters.length,width:this._textRect.width,height:this._textRect.height,ellipsisLine:null}},n.prototype.lines=function(){var e=this;return this._painters.map((function(t,n){return{y:n*e._lineHeight,height:e._lineHeight,width:t.textRect.width,hAlign:t.hAlign,vAlign:t.vAlign,painter:t}}))},n.prototype.convertThemeColor=function(e,t){return e},n.prototype.update=function(e){return"string"==typeof e?(this._options.text=e,this._reset(),this._typography(),this):(Object.assign(this._options,e),this._measurer.update(this._options.fontFamily,this._options.fontWeight,this._options.fontSize),this._reset(),this._typography(),this)},n.prototype.paint=function(e){var t=this;e.save(),this._painters.forEach((function(n){n.paint(e),e.translate(0,t._lineHeight)})),e.restore()},n.prototype._typography=function(){var e=this._applyLines(),t=this._painters.length;if(this._textRect.y=0,this._textRect.height=this._lineHeight*t,this._options.ellipsis&&n._iter.isValid()){var r=this._painters[t-1];r&&!r.hasEllipsis&&r.addEllipsis(e)}},n.prototype._applyLines=function(){for(var e=this,t=this._getMaxLine()||1,r=0,i=[];r<t;){i=this._seekNextLine();var o={height:this._lineHeight||-1,words:i,trim:this._options.trim};0===this._painters.length&&this._options.firstLineTrim&&(o.trim=this._options.firstLineTrim);var a=new gt(this._options,this._measurer,o);if(a.convertThemeColor=function(t,n){return e.convertThemeColor(t,n)},this._painters.push(a),this._textRect.width<a.textRect.width&&(this._textRect.width=a.textRect.width,this._textRect.x=a.textRect.x),r++,!n._iter.isValid())break}return i},n.prototype._getMaxLine=function(){if(!this._options.height)return 0;if(this._options.height<0)return Number.MAX_VALUE;var e=this._options.height/this._lineHeight;return this._options.ellipsis?Math.floor(e):Math.ceil(e)},n.prototype._reset=function(){this._lineHeight=this._options.lineHeight||this._measurer.lineHeight(),this._text=this._options.text||"",n._iter.reset(this._text),this._textRect.reset(),this._painters=[]},n.prototype._seekNextLine=function(){var e=[];do{var t=n._iter.next();if(!t)break;e.push(t)}while(!this._isWrap());return e},n.prototype._isWrap=function(){return!n._iter.isValid()||"\n"===n._iter.charIter().char()||"\r"===n._iter.charIter().char()&&(n._iter.charIter().next()&&"\n"===n._iter.charIter().char()||n._iter.charIter().prev(),!0)},n._iter=new Ke(""),n}(),yt=function(r){function o(){var e=null!==r&&r.apply(this,arguments)||this;return e._autoWidth=!0,e._autoHeight=!0,e._autoSet=!1,e._painter=new _t,e}return i(o,r),Object.defineProperty(o.prototype,"fontSize",{get:function(){return this._cfg.fontSize},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fontFamily",{get:function(){return this._cfg.fontFamily},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fontStyle",{get:function(){return this._cfg.fontStyle},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fontWeight",{get:function(){return this._cfg.fontWeight},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"text",{get:function(){return this._cfg.text},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"color",{get:function(){return this._cfg.color},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"textDecoration",{get:function(){return this._cfg.textDecoration||0},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"hAlign",{get:function(){return this._cfg.hAlign},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"vAlign",{get:function(){return this._cfg.vAlign},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"ellipsis",{get:function(){return this._cfg.ellipsis},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"minWidth",{get:function(){return this._cfg.minWidth||0},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"minHeight",{get:function(){return this._cfg.minHeight||0},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"maxWidth",{get:function(){return this._cfg.maxWidth||0},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"maxHeight",{get:function(){return this._cfg.maxHeight||0},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"lineHeight",{get:function(){return this._cfg.lineHeight},enumerable:!1,configurable:!0}),o.prototype.fvgNode=function(){var t=r.prototype.fvgNode.call(this);return t.type=e.WdkFvgType.text,t.cfg.fontSize=this.fontSize,this.fontFamily&&(t.cfg.fontFamily=this.fontFamily),this.fontStyle&&(t.cfg.fontStyle=this.fontStyle),this.fontWeight&&(t.cfg.fontWeight=this.fontWeight),t.cfg.color=this.color,t.cfg.text=this.text,t.cfg.hAlign=this.hAlign,t.cfg.vAlign=this.vAlign,t.cfg.textDecoration=this.textDecoration,t.cfg.lineHeight=this.lineHeight,t},o.prototype.textRect=function(){return this._painter.textRect},o.prototype.afterChange=function(e){return this._autoSet||("width"in e.changes&&(this._autoWidth=e.changes.width.current<0),"height"in e.changes&&(this._autoHeight=e.changes.height.current<0)),r.prototype.afterChange.call(this,e)},o.prototype.beforeChange=function(e){var t=e.changes.width;t&&(t.current=this._validWidth(t.current));var n=e.changes.height;n&&(n.current=this._validHeight(n.current))},o.prototype.afterFlush=function(e){var n=this;r.prototype.afterFlush.call(this,e);var i=0;if(this._autoHeight&&"height"in e.changes&&(i+=1),this._autoWidth&&"width"in e.changes&&(i+=1),Object.keys(e.changes).length!==i){var o=this.contentRect(!0),a=this._autoWidth?-1:o.width,u=this._autoHeight?-1:o.height;if(this._painter.convertThemeColor=function(e,r){return t.convertThemeColor(n,e,r)},this._painter.update(s(s({},this._cfg),{width:a,height:u})),this._autoHeight||this._autoWidth){var l=this._painter.textRect,c=h(this._paddingBorderSize(),2),d=c[0],f=c[1],p=l.width+d,v=l.height+f;this._autoSet=!0,this._autoHeight&&this.trySetConfigDirectly({height:v}),this._autoWidth&&this.trySetConfigDirectly({width:p}),this._autoSet=!1}}},o.prototype.renderWidget=function(e,t){r.prototype.renderWidget.call(this,e,t);var i=this.contentRect(!0),o=i.x,a=i.y,s=h(this._paddingBorderSize(),2),u=s[0],l=s[1],c=this._painter.textRect;if(c.width+u>this.width||c.height+l>this.height){e.beginPath();var d=this.paintedRect();n.preciseRect(e,d),e.clip()}e.translate(o,a),this._painter.paint(e),e.translate(-o,-a)},o.prototype._defalutCfg=function(){var t=r.prototype._defalutCfg.call(this);return t.fontFamily="Arial",t.fontSize=12,t.color="#000",t.text="",t.hAlign=e.HorizontalAlign.Left,t.vAlign=e.VerticalAlign.Top,t.textDecoration=0,t.width=-1,t.height=-1,t.minHeight=-1,t.maxHeight=-1,t.minWidth=-1,t.maxWidth=-1,t},o.prototype._validWidth=function(e){return this.maxWidth>0&&(e=Math.min(this.maxWidth,e)),this.minWidth>0&&(e=Math.max(this.minWidth,e)),e},o.prototype._validHeight=function(e){return this.maxHeight>0&&(e=Math.min(this.maxHeight,e)),this.minHeight>0&&(e=Math.max(this.minHeight,e)),e},o.prototype._paddingBorderSize=function(){var e=0,n=0;if(this._cfg.border){var r=t.QuaterSplit(this._cfg.border,{width:0,color:""});e+=r[1].width+r[3].width,n+=r[0].width+r[2].width}if(this._cfg.padding){var i=t.QuaterSplit(this._cfg.padding,0);e+=i[1]+i[3],n+=i[0]+i[2]}return[e,n]},o}(t.FWidget),mt=function(n){function r(){var t=null!==n&&n.apply(this,arguments)||this;return t.text="",t.hAlign=e.HorizontalAlign.Left,t.vAlign=e.VerticalAlign.Center,t.color="#000",t.fontSize=12,t.fontWeight=e.FontWeight.normal,t._painter=new _t,t._width=-1,t._height=-1,t}return i(r,n),r.prototype.textRect=function(){return this._painter.textRect},r.prototype.performLayout=function(e){this._width=-1,this._height=-1;var t=e.hasMaxHeight();t&&(this._width=e.maxWidth);var n=e.hasMaxHeight();return n&&(this._height=e.maxHeight),this.updateTextPainter(),this.size=t&&n?{width:this._width,height:this._height}:{width:this._painter.textRect.width,height:this._painter.textRect.height},this.size},r.prototype.paintSelf=function(e){var t=this.pos,n=t.x,r=t.y;e.translate(n,r),this._painter.paint(e),e.translate(-n,-r)},r.prototype.updateTextPainter=function(){this._painter.update({text:this.text,color:this.color,width:this._width,height:this._height,hAlign:this.hAlign,vAlign:this.vAlign,lineHeight:this.lineHeight,fontSize:this.fontSize,fontWeight:this.fontWeight})},u([t.State,l("design:type",String)],r.prototype,"text",void 0),u([t.State,l("design:type",Number)],r.prototype,"hAlign",void 0),u([t.State,l("design:type",Number)],r.prototype,"vAlign",void 0),u([t.State,l("design:type",String)],r.prototype,"color",void 0),u([t.State,l("design:type",Number)],r.prototype,"lineHeight",void 0),u([t.State,l("design:type",Number)],r.prototype,"fontSize",void 0),u([t.State,l("design:type",Number)],r.prototype,"fontWeight",void 0),r}(t.FBaseWidget);e.ObjectFit=void 0,(vt=e.ObjectFit||(e.ObjectFit={}))[vt.Fill=0]="Fill",vt[vt.Contain=1]="Contain",vt[vt.Cover=2]="Cover";var Et=function(r){function o(e){var t=r.call(this,e)||this;return t._errorHandlers=[],t._loadedHandlers=[],t.imgUrl&&t._newDomImage(t.imgUrl),t}return i(o,r),Object.defineProperty(o.prototype,"imgUrl",{get:function(){return this._cfg.imgUrl},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"crossOrigin",{get:function(){return this._cfg.crossOrigin},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"objectFit",{get:function(){return this._cfg.objectFit||e.ObjectFit.Fill},enumerable:!1,configurable:!0}),o.prototype.fvgNode=function(){var t=r.prototype.fvgNode.call(this);return t.type=e.WdkFvgType.image,t.cfg.imgUrl=this._cfg.imgUrl,t},o.prototype.beforeFlush=function(e){var t=e.changes,n=t.imgUrl;if(n){var r=n.current;this._newDomImage(r),0===this._img.width()&&0===this._img.height()&&(delete t.imgUrl,this._cfg.imgUrl=r)}},o.prototype.onLoaded=function(e){this._loadedHandlers.push(e)},o.prototype.onError=function(e){this._errorHandlers.push(e)},o.prototype.isReady=function(){return!!this._img&&this._img.isReady()},o.prototype.onReady=function(e){this._img&&(this._img.onceLoaded(e),this._img.onceError(e))},o.prototype.destroy=function(){r.prototype.destroy.call(this),this._img&&(this._img.release(),this._img=void 0),this._loadedHandlers.length=0,this._errorHandlers.length=0},o.prototype.clip=function(e,t,n,r){this._clip={dx:e,dy:t,dw:n,dh:r}},o.prototype.clearClip=function(){this._clip=void 0},o.prototype.paint=function(e,t){var n=this.pCfg||this._cfg,i=n.radius,o=n.width,a=n.height,s=this._quaterSplitRadius(i,o,a);e.save(),Tt(s,0)&&(e.beginPath(),bt(e,this.paintedRect(),s),e.clip()),r.prototype.paint.call(this,e,t),e.restore()},o.prototype.renderWidget=function(i,o){if(r.prototype.renderWidget.call(this,i,o),this._img){var a=this.pCfg||this._cfg,s=a.x,u=a.y,l=a.width,c=a.height,h=this._img.width(),d=this._img.height(),f=h/d;l&&!c?c=l/f:!l&&c?l=c*f:l||c||(l=this._img.width(),c=this._img.height());var p=l/c,v=0,g=0,_=h,y=d,m=s,E=u,b=l,T=c,C=1;switch(a.objectFit){case e.ObjectFit.Contain:_=h,y=d,f>=p?(b=l,E+=(c-(T=d/(C=h/l)))/2):(T=c,m+=(l-(b=h/(C=d/c)))/2);break;case e.ObjectFit.Cover:f>=p?(y=d,v=(h-l*(C=d/c))/2,_=l*C):(_=h,g=(d-c*(C=h/l))/2,y=c*C);case e.ObjectFit.Fill:}try{if(this._clip){var S=this._clip;i.save(),i.beginPath(),n.preciseRect(i,new t.FRect(s,u,l,c)),i.clip(),i.drawImage(this._img.element(),s+S.dx,u+S.dy,l+S.dw,c+S.dh),i.restore()}else i.drawImage(this._img.element(),v,g,_,y,m,E,b,T)}catch(e){}}},o.prototype._defalutCfg=function(){var e=r.prototype._defalutCfg.call(this);return e.imgUrl="",e},o.prototype._newDomImage=function(e){var n=this;this._img=new O(e,this.crossOrigin),this._img.onceLoaded((function(){n._dirtyList(t.WidgetProps.ChildDirty)})),this._loadedHandlers.length>0&&this._img.onceLoaded((function(){n._loadedHandlers.forEach((function(e){return e()}))})),this._errorHandlers.length>0&&this._img.onceError((function(e){n._errorHandlers.forEach((function(t){return t(e)}))}))},o}(t.FWidget);function bt(e,t,n){e.arc(t.x+n[0],t.y+n[0],n[0],Math.PI,1.5*Math.PI),e.lineTo(t.x+t.width-n[1],t.y),e.arc(t.x+t.width-n[1],t.y+n[1],n[1],1.5*Math.PI,2*Math.PI),e.lineTo(t.x+t.width,t.y+t.height-n[2]),e.arc(t.x+t.width-n[2],t.y+t.height-n[2],n[2],0,.5*Math.PI),e.lineTo(t.x+n[3],t.y+t.height),e.arc(t.x+n[3],t.y+t.height-n[3],n[3],.5*Math.PI,Math.PI),e.closePath()}function Tt(e,t){for(var n=e.length;--n>=0;)if(e[n]>t)return!0;return!1}function Ct(e,t,n){e.save(),e.fillStyle=n.fillStyle||t.attributes.fill||e.fillStyle;var r=n.fillRule||t.attributes["fill-rule"];if(e.globalAlpha=Number(t.attributes["fill-opacity"]||e.globalAlpha||1),e.strokeStyle=n.strokeStyle||t.attributes.stroke||e.strokeStyle,e.lineWidth=n.lineWidth||parseFloat(t.attributes["stroke-width"])||e.lineWidth,"path"===t.name){var i=t.attributes.d;i&&((n.strokeStyle||t.attributes.stroke)&&e.stroke(new Path2D(i)),e.fill(new Path2D(i),r))}t.children.forEach((function(t){return Ct(e,t,n)})),e.restore()}function St(e,t,n,r){e.save(),e.fillStyle="transparent";var i=n.attributes.viewBox;if(i){var o=h(i.split(/\s+|,/),4),a=o[0],s=o[1],u=o[2],l=o[3];isNaN(Number(a))||isNaN(Number(s))||isNaN(Number(u))||isNaN(Number(l))||(e.scale(t.width/Number(u),t.height/Number(l)),e.translate(Number(a),Number(s)))}Ct(e,n,r),e.restore()}e.IconFvgType=void 0,(e.IconFvgType||(e.IconFvgType={})).icon="wdk/icon";var wt=function(n){function r(e,t){var r=n.call(this,e)||this;return r._drawSVG=t,r._isHover=!1,r}return i(r,n),Object.defineProperty(r.prototype,"hoverBackground",{get:function(){return this._cfg.hoverBackground},enumerable:!1,configurable:!0}),r.prototype.clip=function(e,t,n,r){this._clip={dx:e,dy:t,dw:n,dh:r}},r.prototype.clearClip=function(){this._clip=void 0},r.prototype.mouseEnter=function(e){return!this._isHover&&this.hasHoverProperty()&&(this._isHover=!0,this.detectLifetimeOnce(!0)),!1},r.prototype.mouseLeave=function(e){return this._isHover&&(this._isHover=!1,this.detectLifetimeOnce(!0)),!1},r.prototype.fvgNode=function(){var t=n.prototype.fvgNode.call(this),r=this._cfg;return t.type=e.IconFvgType.icon,this._clip&&(t.cfg.x+=this._clip.dx,t.cfg.y+=this._clip.dy,t.cfg.width+=this._clip.dw,t.cfg.height+=this._clip.dh),r.fillStyle&&(t.cfg.fillStyle=r.fillStyle),r.fillRule&&(t.cfg.fillRule=r.fillRule),r.path2D&&(t.cfg.path2D=r.path2D),r.svg&&(t.cfg.svg=r.svg),r.viewBox&&(t.cfg.viewBox=r.viewBox),t},r.prototype.hasHoverProperty=function(){return this._cfg.hoverFillStyle||this._cfg.hoverBackground},r.prototype.renderRect=function(e,n){var r,i=this.pCfg||this._cfg;if(r=i.hoverBackground&&this._isHover?i.hoverBackground:i.background){var o,a=i.x,s=i.y,u=i.width,l=i.height,c=i.radius;o=i.shadow&&i.shadow.color?Object.assign({},i.shadow,{color:t.convertThemeColor(this,i.shadow.color,t.ColorThemeType.Border)}):i.shadow;var h=e.fillType;e.fillType=t.ColorThemeType.Background,t.paintRoundedRectangle(e,a,s,u,l,r,c,o),e.fillType=h}},r.prototype.renderWidget=function(e,n){this.renderRect(e,n);var r=this._drawSVG,i=this._cfg,o=i.x,a=void 0===o?0:o,s=i.y,u=void 0===s?0:s,l=i.svg,c=i.path2D,d=i.fillRule,f=i.viewBox,p=this._cfg,v=p.width,g=void 0===v?0:v,_=p.height,y=void 0===_?0:_,m=new t.FRect(a,u,g,y),E=this._isHover&&this._cfg.hoverFillStyle||this._cfg.fillStyle,b=this._cfg.strokeStyle,T=this._cfg.lineWidth||1;"string"==typeof b&&(b=t.convertThemeColor(this,b,t.ColorThemeType.Color)),"string"==typeof E&&(E=t.convertThemeColor(this,E,t.ColorThemeType.Color));try{e.save(),e.translate(a,u);var C=e.fillType;if(e.fillType=t.ColorThemeType.Color,"[object Object]"===Object.prototype.toString.call(l)&&St(e,m,l,{strokeStyle:b,lineWidth:T,fillRule:d,fillStyle:E}),E&&(e.fillStyle=E),this._clip){var S=this._clip;e.rect(0,0,g,y),e.clip(),g+=S.dw,y+=S.dh,m=new t.FRect(a+S.dx,u+S.dy,g,y),e.translate(S.dx,S.dy)}if(f){var w=h(f,4),R=w[2],A=w[3];e.scale(g/R,y/A)}e.beginPath(),Array.isArray(c)?c.forEach((function(t){return e.fill(new Path2D(t),d)})):e.fill(new Path2D(c),d),r&&r(e,m),e.restore(),e.fillType=C}catch(e){}},r}(t.FWidget),Rt=function(){function t(){}return t.prototype.constructWidget=function(t){var n=null;switch(t.type){case e.WdkFvgType.text:(n=new yt(null)).updateByCfg(t.cfg);break;case e.WdkFvgType.richtext:(n=new pt(null)).updateByCfg(t.cfg);break;case e.WdkFvgType.label:(n=new lt(null)).updateByCfg(t.cfg);break;case e.IconFvgType.icon:(n=new wt(null)).updateByCfg(t.cfg);break;case e.WdkFvgType.image:(n=new Et(null)).updateByCfg(s(s({},t.cfg),{crossOrigin:"anonymous"}))}return n},t}(),At=18,Ot="M14.3083615,5.1372937 C14.1253032,4.95423543 13.8285072,4.95423543 13.6454489,5.1372937 L13.6454489,5.1372937 L8.22790643,10.5537316 L5.46311891,7.78894413 C5.28006065,7.60588586 4.98326457,7.60588586 4.8002063,7.78894413 L4.8002063,7.78894413 L4.1372937,8.45185673 C3.95423543,8.63491499 3.95423543,8.93171108 4.1372937,9.11476934 L4.1372937,9.11476934 L7.89065191,12.8681276 C7.93641648,12.9138921 7.98928966,12.9482155 8.05527153,12.9742444 C8.22455399,13.0428912 8.42582521,13.0085678 8.56311891,12.8712741 L8.56311891,12.8712741 L14.9712741,6.46311891 C15.1543324,6.28006065 15.1543324,5.98326457 14.9712741,5.8002063 L14.9712741,5.8002063 Z",Mt=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return i(r,n),r.prototype.renderWidget=function(e,n){var r=e.fillType;e.save(),e.fillStyle=t.convertThemeColor(this,this._fillStyle,t.ColorThemeType.Color),e.fillType=t.ColorThemeType.Color,e.scale(this._zoomWidth,this._zoomHeight),e.fill(new Path2D(Ot)),e.restore(),e.fillType=r},Object.defineProperty(r.prototype,"_fillStyle",{get:function(){return this._cfg.iconColor||"white"},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"_zoomWidth",{get:function(){return this.width/At},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"_zoomHeight",{get:function(){return this.height/At},enumerable:!1,configurable:!0}),r.prototype.fvgNode=function(){var t=n.prototype.fvgNode.call(this),r="0 0 ".concat(At," ").concat(At),i=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" viewBox="'.concat(r,'" height="').concat(this.height,'" width="').concat(this.width,'"><path d="').concat(Ot,'" fill="').concat(this._fillStyle,'"/></svg>'));return{type:e.WdkFvgType.image,cfg:s(s({},t.cfg),{imgUrl:"data:image/svg+xml,".concat(i)})}},r}(t.FWidget),kt={checkedHoverBackground:"#2EA121",checkedBackground:"#34C724",noCheckBorderColor:"#BBBFC4",noCheckBorderHoverColor:"#8F959E",noCheckBackground:"#FFFFFF",noCheckHoverBackground:"#F5F6F7",disabledBackground:"#b3b7bc",horizontalLineColor:"#fff",indeterminate:!1},It=function(e){function n(n){var r=e.call(this,n)||this;return r._instance=new t.FWidget(r),r._icon=new Mt(r),t.Bind.bindSize(r._instance,r),t.Bind.bindSize(r._icon,r),t.Bind.propBind(r._icon,"hidden",r,"checked",(function(e){return!e})),t.Bind.propBind(r._icon,"iconColor",r,"iconColor"),r}return i(n,e),Object.defineProperty(n.prototype,"width",{get:function(){return this._cfg.width||At},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._cfg.height||At},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"disabled",{get:function(){return this._cfg.disabled||!1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"checkedHoverBackground",{get:function(){return this._cfg.checkedHoverBackground||kt.checkedHoverBackground},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"checkedBackground",{get:function(){return this._cfg.checkedBackground||kt.checkedBackground},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"noCheckBackground",{get:function(){return this._cfg.noCheckBackground||kt.noCheckBackground},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"noCheckHoverBackground",{get:function(){return this._cfg.noCheckHoverBackground||kt.noCheckHoverBackground},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"noCheckBorderColor",{get:function(){return this._cfg.noCheckBorderColor||kt.noCheckBorderColor},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"noCheckBorderWidth",{get:function(){return this._cfg.noCheckBorderWidth||null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"noCheckBorderHoverColor",{get:function(){return this._cfg.noCheckBorderHoverColor||kt.noCheckBorderHoverColor},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"horizontalLineColor",{get:function(){return kt.horizontalLineColor},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"indeterminate",{get:function(){return this._cfg.indeterminate||kt.indeterminate},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"checked",{get:function(){return this._cfg.checked||!1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"disabledBackground",{get:function(){return kt.disabledBackground},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hover",{get:function(){return this._cfg.hover||!1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"radius",{get:function(){var e=this._cleanProp("radius");return void 0===e?Math.min(this.height,this.width)/9:e},enumerable:!1,configurable:!0}),n.prototype.afterChange=function(e){var t=e.changes;(t.checked||t.hover||t.noCheckBorderColor||t.noCheckBorderHoverColor||t.noCheckBorderWidth||t.height||t.width)&&this._updateBorder(),(t.checked||t.hover||t.checkedHoverBackground||t.checkedBackground||t.noCheckBackground||t.noCheckHoverBackground)&&this._updateBackgroundColor(),(t.height||t.width||t.radius)&&this._updateRadius()},n.prototype._updateBorder=function(){var e;if(!this.checked){var t=this.hover?this.noCheckBorderHoverColor:this.noCheckBorderColor;e="number"==typeof this.noCheckBorderWidth?{color:t,width:this.noCheckBorderWidth}:[{color:t,width:this.height/9},{color:t,width:this.width/9}]}this._instance.updateByCfg({border:e})},n.prototype._updateBackgroundColor=function(){var e="";this.checked&&this.hover?e=this.checkedHoverBackground:this.checked&&!this.hover?e=this.checkedBackground:!this.checked&&this.hover?e=this.noCheckHoverBackground:this.checked||this.hover||(e=this.noCheckBackground),this._instance.updateByCfg({background:e})},n.prototype._updateRadius=function(){this._instance.updateByCfg({radius:this.radius})},n}(t.FWidget),xt=[0,8,0,8],Nt={fontSize:"fontSize",fontWeight:"fontWeight",ellipsis:"ellipsis",minHeight:"labelMinHeight",maxHeight:"labelMaxHeight",minWidth:"labelMinWidth",maxWidth:"labelMaxWidth",x:"boxWidth",height:"height",lineHeight:"height",text:"label",vAlign:"labelAlign"},Pt={checked:"checked",disabled:"disabled",indeterminate:"indeterminate",hover:"hover",checkedHoverBackground:"checkedHoverBackground",checkedBackground:"checkedBackground",noCheckBackground:"noCheckBackground",noCheckHoverBackground:"noCheckHoverBackground",noCheckBorderColor:"noCheckBorderColor",noCheckBorderHoverColor:"noCheckBorderHoverColor",noCheckBorderWidth:"noCheckBorderWidth",height:"boxHeight",width:"boxWidth",radius:"boxRadius",iconColor:"iconColor"},Lt=function(n){function r(e){var r=n.call(this,e)||this;return r.box=new It(r),r.label=new lt(r),r._onMouseEnter=function(e){var n={};return r.disabled?n.cursor=t.Cursor.NotAllowed:n.cursor=t.Cursor.Pointer,n.hover=!0,r.updateByCfg(n),!1},r._onMouseLeave=function(e){var n={};return r.disabled&&(n.cursor=t.Cursor.Default),n.hover=!1,r.updateByCfg(n),!1},r._bindEvents(),r._initBox(),r._initLabel(),r._bindProps(),r}return i(r,n),r.prototype._initLabel=function(){this.label.updateByCfg({x:this.boxWidth||At,padding:xt,hAlign:e.HorizontalAlign.Left,vAlign:e.VerticalAlign.Center})},r.prototype._initBox=function(){this.box.updateByCfg({width:At,height:At})},Object.defineProperty(r.prototype,"disabled",{get:function(){return this._cfg.disabled||!1},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"checked",{get:function(){return this._cfg.checked||!1},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"boxWidth",{get:function(){return this._cfg.boxWidth||At},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"eventLists",{get:function(){return[{name:t.FEventType.MouseEnter,handle:this._onMouseEnter},{name:t.FEventType.MouseLeave,handle:this._onMouseLeave}]},enumerable:!1,configurable:!0}),r.prototype._bindEvents=function(){var e,t;try{for(var n=c(this.eventLists),r=n.next();!r.done;r=n.next()){var i=r.value;this.addListener(i.name,i.handle)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},r.prototype._removeEvents=function(){var e,t;try{for(var n=c(this.eventLists),r=n.next();!r.done;r=n.next()){var i=r.value;this.removeListener(i.name,i.handle)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},r.prototype._bindProps=function(){var e=this;for(var n in Nt)t.Bind.propBind(this.label,n,this,Nt[n]);for(var n in t.Bind.propBind(this.label,"width",this,"width",(function(t){return t-e.boxWidth})),t.Bind.propBind(this.label,"width",this,"boxWidth",(function(t){return e.width-t})),Pt)t.Bind.propBind(this.box,n,this,Pt[n]);t.Bind.propBind(this.box,"y",this,"height",(function(){return e.moveBoxToCenterOffsetY})),t.Bind.propBind(this.box,"y",this,"boxHeight",(function(){return e.moveBoxToCenterOffsetY}))},Object.defineProperty(r.prototype,"moveBoxToCenterOffsetY",{get:function(){var e=this.box.height||0;return((this._cfg.height||0)-e)/2},enumerable:!1,configurable:!0}),r.prototype.destroy=function(){this._removeEvents(),n.prototype.destroy.call(this)},r}(t.FWidget),Dt=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.background="transparent",t.radius=0,t}return i(n,e),n.prototype.paintSelf=function(e){var n=e.fillType;e.fillType=t.ColorThemeType.Background,t.paintRoundedRectangle(e,this.pos.x,this.pos.y,this.size.width,this.size.height,t.convertThemeColor(this,this.background,t.ColorThemeType.Background),this.radius),e.fillType=n},u([t.State,l("design:type",String)],n.prototype,"background",void 0),u([t.State,l("design:type",Object)],n.prototype,"radius",void 0),n}(t.FBaseWidget),Ft=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.color="transparent",t.radius=0,t}return i(n,e),n.prototype.performLayout=function(e){var t=this.children()[0];if(t){var n=t.layout(e.copy());this.size={width:e.hasMaxWidth()?e.maxWidth:n.width,height:e.hasMaxHeight()?e.maxHeight:n.height}}else this.size={width:e.hasMaxWidth()?e.maxWidth:this.size.width,height:e.hasMaxHeight()?e.maxHeight:this.size.height};return this.size=st(e,this.size),this.size},n.prototype.paintSelf=function(e){var n=e.fillType;e.fillType=t.ColorThemeType.Background,t.paintRoundedRectangle(e,this.pos.x,this.pos.y,this.size.width,this.size.height,t.convertThemeColor(this,this.color,t.ColorThemeType.Background),this.radius),e.fillType=n},u([t.State,l("design:type",String)],n.prototype,"color",void 0),u([t.State,l("design:type",Object)],n.prototype,"radius",void 0),n}(t.FSingleLayout),Bt=18,Vt="M14.3083615,5.1372937 C14.1253032,4.95423543 13.8285072,4.95423543 13.6454489,5.1372937 L13.6454489,5.1372937 L8.22790643,10.5537316 L5.46311891,7.78894413 C5.28006065,7.60588586 4.98326457,7.60588586 4.8002063,7.78894413 L4.8002063,7.78894413 L4.1372937,8.45185673 C3.95423543,8.63491499 3.95423543,8.93171108 4.1372937,9.11476934 L4.1372937,9.11476934 L7.89065191,12.8681276 C7.93641648,12.9138921 7.98928966,12.9482155 8.05527153,12.9742444 C8.22455399,13.0428912 8.42582521,13.0085678 8.56311891,12.8712741 L8.56311891,12.8712741 L14.9712741,6.46311891 C15.1543324,6.28006065 15.1543324,5.98326457 14.9712741,5.8002063 L14.9712741,5.8002063 Z",Ht=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.isChecked=!1,t.color="white",t}return i(n,e),n.prototype.paintSelf=function(e){if(this.isChecked){var n=e.fillType;e.save(),e.fillStyle=t.convertThemeColor(this,this.color,t.ColorThemeType.Color),e.fillType=t.ColorThemeType.Color,e.scale(this._zoomWidth,this._zoomHeight),e.fill(new Path2D(Vt)),e.fillType=n,e.restore()}},Object.defineProperty(n.prototype,"_zoomWidth",{get:function(){return this.size.width/Bt},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_zoomHeight",{get:function(){return this.size.height/Bt},enumerable:!1,configurable:!0}),u([t.State,l("design:type",Boolean)],n.prototype,"isChecked",void 0),u([t.State,l("design:type",String)],n.prototype,"color",void 0),n}(t.FBaseWidget),Ut=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"angle",{get:function(){return this._cfg.angle||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"originX",{get:function(){return this._cfg.originX||.5},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"originY",{get:function(){return this._cfg.originY||.5},enumerable:!1,configurable:!0}),t.prototype.getPCfgByCfg=function(){var t=e.prototype.getPCfgByCfg.call(this);return Object.assign(t,this._cfg,{angle:this.angle}),t},t.prototype.renderChildren=function(t,n){var r=this,i=r.originX,o=r.originY,a=(this.pCfg||this._cfg).angle,s=void 0===a?0:a,u=this.width*i,l=this.height*o;t.save(),t.translate(u,l),t.rotate(s/180*Math.PI),t.translate(-u,-l),e.prototype.renderChildren.call(this,t,n),t.restore()},t}(t.FWidget),Zt=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.imgSrc="",t}return i(n,e),n.prototype.paintSelf=function(e){var t=this.pos,n=t.x,r=t.y,i=this.size,o=i.width,a=i.height,s=e.getTransform(),u=document.createElement("img");u.src=this.imgSrc,u.addEventListener("load",(function(t){e.translate(n,r),e.drawImage(u,0,0,720,720,s.e/s.a,s.f/s.d,o,a),e.translate(-n,-r)}))},u([t.State,l("design:type",String)],n.prototype,"imgSrc",void 0),n}(t.FBaseWidget);e.Auto=ee,e.CharIter=Xe,e.Column=xe,e.Container=Ce,e.DEFAULT_METRICS_FONT_SIZE=Ue,e.DomImagePool=R,e.EllipsisSeg=rt,e.Expanded=Se,e.FAbsoluteLayout=he,e.FBackground=Ft,e.FBlock=Dt,e.FCheckbox=Lt,e.FCheckboxWithoutLabel=It,e.FCompatibilityDocumentLayer=U,e.FCompatibilityMeasurer=Z,e.FContainerWidget=S,e.FDocDirtyEvent=I,e.FDocMeasurer=P,e.FDocView=V,e.FDocument=L,e.FDomImage=O,e.FFillLayer=z,e.FGridLayout=Ee,e.FHScrollView=Q,e.FHScrollbar=E,e.FIcon=wt,e.FImage=Et,e.FIterLayer=W,e.FLabel=lt,e.FLayer=N,e.FLayout=re,e.FRawTableView=Ne,e.FRichText=pt,e.FRotate=Ut,e.FScrollView=K,e.FStackLayout=pe,e.FTableView=De,e.FText=yt,e.FTextLinePainter=gt,e.FTextPainter=_t,e.FTypographer=at,e.FTypographyPainter=tt,e.FTypographyStream=Qe,e.FVGWdkConstructor=Rt,e.FVScrollView=$,e.FVScrollbar=m,e.FWidgetLayer=Y,e.Flex=we,e.FontMeasurer=Ye,e.Fraction=te,e.HScrollDocModel=J,e.HoverCharEvent=ft,e.ImageRef=A,e.InsetSeg=it,e.NCheckbox=Ht,e.NImg=Zt,e.NText=mt,e.Percent=ne,e.Ref=w,e.Row=Re,e.RowColRenderData=x,e.ScrollRef=X,e.StreamIterator=et,e.TEXT_DEFAULT_FONT_STYLE=Ze,e.TextSeg=nt,e.VScrollDocModel=q,e.WordIter=Ke,e.Wrap=Ie,e.baseFontSize=Fe,e.charType=ze,e.clampSizeByConstraint=st,e.defaultFont=We,e.fontString=Be,e.isAbs=se,e.isAuto=ue,e.isFrc=ae,e.isPer=oe,e.metricsData=He,e.posComp=$e,e.rgComp=qe,e.toBeGreaterThanBase=Tt,e.undef=ie,Object.defineProperty(e,"__esModule",{value:!0})}(t,n("vsh_33916"),n("vsh_60029"))},vsh_68133:function(e,t){"use strict";var n="";function r(e){return(Array(4).join("0")+parseInt(e,2).toString(16)).slice(-4)}function i(e){if(!e)return"00000000000000000000000000000000";var t=e.split(/\./).map((function(e){return t=e,(Array(8).join("0")+parseInt(t,10).toString(2)).slice(-8);var t})),n=[];return n[0]=r(t[0]+t[1]),n[1]=r(t[2]+t[3]),["0000","0000","0000","0000","0000","ffff",n[0],n[1]].join("")}t.M=function(e){var t=""+Date.now(),r="";return e?(r=i(e),n=r):r=n||(n=i(function(){for(var e=[],t=0;t<4;t++)e.push(Math.floor(256*Math.random()));return e.join(".")}())),"02"+t+r+Math.random().toString(16).slice(-6)}},vsh_9452:function(e,t,n){"use strict";n.d(t,{VY:function(){return o},AX:function(){return i},YC:function(){return r},n2:function(){return w},T5:function(){return S},ak:function(){return C},VB:function(){return T},iw:function(){return b},hH:function(){return E},xS:function(){return m},xA:function(){return y},f5:function(){return d},KH:function(){return h},bV:function(){return c},vJ:function(){return _},HD:function(){return g},J1:function(){return v},$H:function(){return p},gR:function(){return f},WZ:function(){return a},cS:function(){return l},jC:function(){return u},q3:function(){return s}});var r="#3370ff",i="#4e83fd",o="#bacefd",a="#fff258",s="#dc9b04",u="#fad355",l="#f8e6ab",c="#ff8800",h="#ffa53d",d="#fed4a4",f="#f54a45",p="#f76964",v="#7f3bf5",g="#935af6",_="#cdb2fa",y="#1f2329",m="#bbbfc4",E="#dee0e3",b="#eff0f1",T="#34c724",C="#62d256",S="#b7edb1",w=["#3370FF","#64E8D6","#667901","#FF8800","#520A32","#AD82F7","#049FD7","#2EA121","#795101","#F76964","#B220B2","#0A1285","#50CEFB","#186010","#B26206","#F57AC0","#7F3BF5","#00D6B9","#354200","#FFBA6B","#9E1361","#270561","#1C4CBA","#078372","#B3D600","#6B3900","#F01D94","#4E1BA7","#D83931","#DB66DB","#2933C7","#006185","#62D256","#812520","#681268","#616AE5","#024B41","#82A7FC","#0C296E"]},vsh_32991:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n("vsh_50098"),i=n("vsh_26278"),o=n("vsh_1139"),a=n("vsh_51626"),s=n("vsh_98125"),u=["icon","className","svgProps"],l=0;var c=s.forwardRef((function(e,t){var n,c=e.icon,h=e.className,d=e.svgProps,f=(0,i.Z)(e,u);return s.createElement("span",(0,r.Z)({className:(0,a.default)("universe-icon",h),ref:t},f),s.createElement(c,(0,r.Z)({prefixId:(n=s.useState((function(){return l++,"u".concat(l.toString(32))})),(0,o.Z)(n,1)[0])},d)))}))},vsh_47821:function(e,t,n){"use strict";n.d(t,{Ni:function(){return i},f6:function(){return o},Fg:function(){return a}});var r=n("vsh_98125"),i=r.createContext("light"),o=function(e){var t=e.children,n=e.mode,o=void 0===n?"light":n;return r.createElement(i.Provider,{value:o},t)},a=function(){return r.useContext(i)}},vsh_74016:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n("vsh_50098"),i=n("vsh_26278"),o=n("vsh_98125"),a=n("vsh_32991"),s=n("vsh_47821"),u=["prefixId"];function l(e){e.prefixId;var t=(0,i.Z)(e,u),n={light:{c1:"#FF811A"},dark:{c1:"#F3871B"}},a=n[(0,s.Fg)()]||n.light;return o.createElement("svg",(0,r.Z)({width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),o.createElement("circle",{cx:12,cy:12,r:11,fill:a.c1}),o.createElement("path",{d:"M12 7a1 1 0 0 0-1 1v5a1 1 0 1 0 2 0V8a1 1 0 0 0-1-1Zm0 10a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z",fill:"#fff"}))}var c=o.forwardRef((function(e,t){return o.createElement(a.Z,(0,r.Z)({icon:l},e,{ref:t,svgProps:{"data-icon":"WarningColorful"}}))}))},vsh_39504:function(e,t){"use strict";t.Z={"ccmtoken-doc-block-bg-area":"rgba(166, 166, 166, 0.08)","ccmtoken-doc-block-bg-hover":"rgba(51, 112, 235, 0.16)","ccmtoken-doc-block-bg-selected":"rgba(51, 112, 235, 0.26)","ccmtoken-doc-blockbackground-blue":"#192a4c","ccmtoken-doc-blockbackground-blue-solid":"#203e78","ccmtoken-doc-blockbackground-gray":"#434343","ccmtoken-doc-blockbackground-gray-solid":"#5f5f5f","ccmtoken-doc-blockbackground-green":"#1f471b","ccmtoken-doc-blockbackground-green-solid":"#296b22","ccmtoken-doc-blockbackground-netural":"#292929","ccmtoken-doc-blockbackground-netural-solid":"#373737","ccmtoken-doc-blockbackground-orange":"#57330a","ccmtoken-doc-blockbackground-orange-solid":"#845117","ccmtoken-doc-blockbackground-purple":"#361d61","ccmtoken-doc-blockbackground-purple-solid":"#4d2691","ccmtoken-doc-blockbackground-red":"#4a1d1b","ccmtoken-doc-blockbackground-red-solid":"#6b2827","ccmtoken-doc-blockbackground-yellow":"#5c5514","ccmtoken-doc-blockbackground-yellow-solid":"#877b10","ccmtoken-doc-bottom-like-bg-hover":"#e1b420","ccmtoken-doc-bottom-like-bg-nomal":"#fac823","ccmtoken-doc-button-bg-blue":"#192a4c","ccmtoken-doc-button-bg-blue-solid":"#4c88ff","ccmtoken-doc-button-bg-carmine":"#5c2542","ccmtoken-doc-button-bg-carmine-solid":"#cc4792","ccmtoken-doc-button-bg-green":"#1f471b","ccmtoken-doc-button-bg-green-solid":"#3bb02e","ccmtoken-doc-button-bg-neutral":"#373737","ccmtoken-doc-button-bg-neutral-solid":"#e8e8e8","ccmtoken-doc-button-bg-orange":"#57330a","ccmtoken-doc-button-bg-orange-solid":"#de8218","ccmtoken-doc-button-bg-purple":"#361d61","ccmtoken-doc-button-bg-purple-solid":"#7c4ad4","ccmtoken-doc-button-bg-red":"#4a1d1b","ccmtoken-doc-button-bg-red-solid":"#cc4743","ccmtoken-doc-button-bg-wathet":"#173742","ccmtoken-doc-button-bg-wathet-solid":"#42bdeb","ccmtoken-doc-calloutborder-blue":"#2851a3","ccmtoken-doc-calloutborder-green":"#339428","ccmtoken-doc-calloutborder-orange":"#bd7017","ccmtoken-doc-calloutborder-purple":"#6533bd","ccmtoken-doc-calloutborder-red":"#9e3836","ccmtoken-doc-calloutborder-yellow":"#c7b300","ccmtoken-doc-calloutborder-yellow-solid":"#e8d100","ccmtoken-doc-highlightcolor-bg-blue-soft":"rgba(76, 136, 255, 0.21)","ccmtoken-doc-highlightcolor-bg-blue-solid":"rgba(76, 136, 255, 0.35)","ccmtoken-doc-highlightcolor-bg-green-soft":"rgba(84, 194, 72, 0.17)","ccmtoken-doc-highlightcolor-bg-green-solid":"rgba(84, 194, 72, 0.28)","ccmtoken-doc-highlightcolor-bg-neutral-light":"rgba(41, 41, 41, 0.6)","ccmtoken-doc-highlightcolor-bg-orange-soft":"rgba(242, 150, 44, 0.17)","ccmtoken-doc-highlightcolor-bg-orange-solid":"rgba(242, 150, 44, 0.28)","ccmtoken-doc-highlightcolor-bg-purple-soft":"rgba(151, 98, 245, 0.24)","ccmtoken-doc-highlightcolor-bg-purple-solid":"rgba(151, 98, 245, 0.4)","ccmtoken-doc-highlightcolor-bg-red-soft":"rgba(240, 91, 86, 0.22)","ccmtoken-doc-highlightcolor-bg-red-solid":"rgba(240, 91, 86, 0.36)","ccmtoken-doc-highlightcolor-bg-sunflower-soft":"rgba(245, 226, 49, 0.13)","ccmtoken-doc-highlightcolor-bg-sunflower-solid":"rgba(245, 226, 49, 0.21)","ccmtoken-doc-highlightcolor-blue-soft":"rgba(76, 136, 255, 0.28)","ccmtoken-doc-highlightcolor-blue-solid":"rgba(76, 136, 255, 0.46)","ccmtoken-doc-highlightcolor-callout-neutral-light":"rgba(41, 41, 41, 0.6)","ccmtoken-doc-highlightcolor-green-soft":"rgba(84, 194, 72, 0.22)","ccmtoken-doc-highlightcolor-green-solid":"rgba(84, 194, 72, 0.36)","ccmtoken-doc-highlightcolor-neutral-light":"rgba(67, 67, 67, 0.4)","ccmtoken-doc-highlightcolor-neutral-soft":"rgba(80, 80, 80, 0.5)","ccmtoken-doc-highlightcolor-neutral-solid":"rgba(95, 95, 95, 0.6)","ccmtoken-doc-highlightcolor-orange-soft":"rgba(242, 150, 44, 0.22)","ccmtoken-doc-highlightcolor-orange-solid":"rgba(242, 150, 44, 0.36)","ccmtoken-doc-highlightcolor-purple-soft":"rgba(151, 98, 245, 0.31)","ccmtoken-doc-highlightcolor-purple-solid":"rgba(151, 98, 245, 0.51)","ccmtoken-doc-highlightcolor-red-soft":"rgba(240, 91, 86, 0.28)","ccmtoken-doc-highlightcolor-red-solid":"rgba(240, 91, 86, 0.47)","ccmtoken-doc-highlightcolor-sunflower-soft":"rgba(245, 226, 49, 0.16)","ccmtoken-doc-highlightcolor-sunflower-solid":"rgba(245, 226, 49, 0.26)","ccmtoken-doc-picture-toolbar-bg":"rgba(41, 41, 41, 0.7)","ccmtoken-doc-tableheader-bg-hover":"#505050","ccmtoken-doc-textcolor-blue":"#70a0ff","ccmtoken-doc-textcolor-callout-gray":"#ebebeb","ccmtoken-doc-textcolor-gray":"#757575","ccmtoken-doc-textcolor-green":"#6dd162","ccmtoken-doc-textcolor-orange":"#f5a54a","ccmtoken-doc-textcolor-purple":"#a472fc","ccmtoken-doc-textcolor-red":"#fa7873","ccmtoken-doc-textcolor-yellow":"#fcd456","ccmtoken-doc-toolbar-btn-bg-blue-hover":"rgba(117, 164, 255, 0.3)","ccmtoken-doc-toolbar-btn-bg-blue-pressed":"rgba(117, 164, 255, 0.4)"}},vsh_39560:function(e,t){"use strict";t.Z={"ccmtoken-doc-block-bg-area":"rgba(100, 106, 115, 0.05)","ccmtoken-doc-block-bg-hover":"rgba(20, 86, 240, 0.1)","ccmtoken-doc-block-bg-selected":"rgba(20, 86, 240, 0.18)","ccmtoken-doc-blockbackground-blue":"#e1eaff","ccmtoken-doc-blockbackground-blue-solid":"#bacefd","ccmtoken-doc-blockbackground-gray":"#dee0e3","ccmtoken-doc-blockbackground-gray-solid":"#bbbfc4","ccmtoken-doc-blockbackground-green":"#d9f5d6","ccmtoken-doc-blockbackground-green-solid":"#b7edb1","ccmtoken-doc-blockbackground-netural":"#f2f3f5","ccmtoken-doc-blockbackground-netural-solid":"#eff0f1","ccmtoken-doc-blockbackground-orange":"#feead2","ccmtoken-doc-blockbackground-orange-solid":"#fed4a4","ccmtoken-doc-blockbackground-purple":"#ece2fe","ccmtoken-doc-blockbackground-purple-solid":"#cdb2fa","ccmtoken-doc-blockbackground-red":"#fde2e2","ccmtoken-doc-blockbackground-red-solid":"#fbbfbc","ccmtoken-doc-blockbackground-yellow":"#ffffcc","ccmtoken-doc-blockbackground-yellow-solid":"#fffca3","ccmtoken-doc-bottom-like-bg-hover":"#ffd13b","ccmtoken-doc-bottom-like-bg-nomal":"#ffc60a","ccmtoken-doc-button-bg-blue":"#e1eaff","ccmtoken-doc-button-bg-blue-solid":"#3370ff","ccmtoken-doc-button-bg-carmine":"#fdddef","ccmtoken-doc-button-bg-carmine-solid":"#f14ba9","ccmtoken-doc-button-bg-green":"#d9f5d6","ccmtoken-doc-button-bg-green-solid":"#62d256","ccmtoken-doc-button-bg-neutral":"#eff0f1","ccmtoken-doc-button-bg-neutral-solid":"#2b2f36","ccmtoken-doc-button-bg-orange":"#feead2","ccmtoken-doc-button-bg-orange-solid":"#ffa53d","ccmtoken-doc-button-bg-purple":"#ece2fe","ccmtoken-doc-button-bg-purple-solid":"#935af6","ccmtoken-doc-button-bg-red":"#fde2e2","ccmtoken-doc-button-bg-red-solid":"#f76964","ccmtoken-doc-button-bg-wathet":"#d9f3fd","ccmtoken-doc-button-bg-wathet-solid":"#14c0ff","ccmtoken-doc-calloutborder-blue":"#82a7fc","ccmtoken-doc-calloutborder-green":"#8ee085","ccmtoken-doc-calloutborder-orange":"#ffba6b","ccmtoken-doc-calloutborder-purple":"#ad82f7","ccmtoken-doc-calloutborder-red":"#f98e8b","ccmtoken-doc-calloutborder-yellow":"#fff67a","ccmtoken-doc-calloutborder-yellow-solid":"#fff258","ccmtoken-doc-highlightcolor-bg-blue-soft":"#f0f4ff","ccmtoken-doc-highlightcolor-bg-blue-solid":"#e1eaff","ccmtoken-doc-highlightcolor-bg-green-soft":"#f0fbef","ccmtoken-doc-highlightcolor-bg-green-solid":"#d9f5d6","ccmtoken-doc-highlightcolor-bg-neutral-light":"rgba(245, 246, 247, 0.9)","ccmtoken-doc-highlightcolor-bg-orange-soft":"#fff5eb","ccmtoken-doc-highlightcolor-bg-orange-solid":"#feead2","ccmtoken-doc-highlightcolor-bg-purple-soft":"#f6f1fe","ccmtoken-doc-highlightcolor-bg-purple-solid":"#ece2fe","ccmtoken-doc-highlightcolor-bg-red-soft":"#fef1f1","ccmtoken-doc-highlightcolor-bg-red-solid":"#fde2e2","ccmtoken-doc-highlightcolor-bg-sunflower-soft":"#fefff0","ccmtoken-doc-highlightcolor-bg-sunflower-solid":"#ffffcc","ccmtoken-doc-highlightcolor-blue-soft":"rgba(186, 206, 253, 0.7)","ccmtoken-doc-highlightcolor-blue-solid":"rgba(78, 131, 253, 0.55)","ccmtoken-doc-highlightcolor-callout-neutral-light":"#f5f6f7","ccmtoken-doc-highlightcolor-green-soft":"rgba(183, 237, 177, 0.8)","ccmtoken-doc-highlightcolor-green-solid":"#62d256","ccmtoken-doc-highlightcolor-neutral-light":"#f2f3f5","ccmtoken-doc-highlightcolor-neutral-soft":"rgba(222, 224, 227, 0.8)","ccmtoken-doc-highlightcolor-neutral-solid":"#bbbfc4","ccmtoken-doc-highlightcolor-orange-soft":"rgba(254, 212, 164, 0.8)","ccmtoken-doc-highlightcolor-orange-solid":"#ffa53d","ccmtoken-doc-highlightcolor-purple-soft":"rgba(205, 178, 250, 0.7)","ccmtoken-doc-highlightcolor-purple-solid":"rgba(147, 90, 246, 0.55)","ccmtoken-doc-highlightcolor-red-soft":"#fbbfbc","ccmtoken-doc-highlightcolor-red-solid":"#f76964","ccmtoken-doc-highlightcolor-sunflower-soft":"rgba(255, 246, 122, 0.8)","ccmtoken-doc-highlightcolor-sunflower-solid":"#ffe928","ccmtoken-doc-picture-toolbar-bg":"rgba(0, 0, 0, 0.7)","ccmtoken-doc-tableheader-bg-hover":"#dee0e3","ccmtoken-doc-textcolor-blue":"#245bdb","ccmtoken-doc-textcolor-callout-gray":"#1f2329","ccmtoken-doc-textcolor-gray":"#8f959e","ccmtoken-doc-textcolor-green":"#2ea121","ccmtoken-doc-textcolor-orange":"#de7802","ccmtoken-doc-textcolor-purple":"#6425d0","ccmtoken-doc-textcolor-red":"#d83931","ccmtoken-doc-textcolor-yellow":"#dc9b04","ccmtoken-doc-toolbar-btn-bg-blue-hover":"rgba(20, 86, 240, 0.2)","ccmtoken-doc-toolbar-btn-bg-blue-pressed":"rgba(20, 86, 240, 0.3)"}},vsh_40289:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e,t,n){var i=n.value;if("function"!=typeof i)throw new TypeError("@boundMethod decorator can only be applied to methods not: ".concat(r(i)));var o=!1;return{configurable:!0,get:function(){if(o||this===e.prototype||this.hasOwnProperty(t)||"function"!=typeof i)return i;var n=i.bind(this);return o=!0,Object.defineProperty(this,t,{configurable:!0,get:function(){return n},set:function(e){i=e,delete this[t]}}),o=!1,n},set:function(e){i=e}}}n.d(t,{MR:function(){return i}})},vsh_38105:function(e,t,n){"use strict";n.d(t,{N:function(){return T}});var r=n("vsh_19264"),i=n("vsh_4175"),o=n("vsh_60591"),a=n("vsh_18801"),s=n("vsh_22488"),u=n("vsh_50662"),l=n("vsh_87326"),c=n("vsh_83190"),h=n("vsh_13885"),d=n("vsh_25285"),f=n("vsh_98125"),p=n.n(f),v=n("vsh_24627"),g=n("vsh_72834"),_=n("vsh_74340"),y=n("vsh_89454"),m=n("vsh_73043");function E(e){return e&&e.store?e.store:a.store}function b(e){var t;return(null==e||null===(t=e.getParent())||void 0===t?void 0:t.getActiveSheet())!==e}var T=function(){function e(t,n){(0,r.Z)(this,e),this.context=t,this.sdk=n}return(0,i.Z)(e,[{key:"addComments",value:function(e,t,n){var r=this,i=n.value.comments;n.value.comments=i.filter((function(e){return-1===e.id.indexOf("-")}));var o=e.excuteActionImpl(t,n);return o.forEach((function(e){var t=e.id,i=e.isResolved;r.context.trigger(_.YVA.ACCEPT_COMMENT_CHANGE,{sheet_id:n.sheet_id,comment_id:t}),r.context.trigger(_.YVA.ADD_COMMENT,{sheet_id:n.sheet_id,comment_id:t,isResolved:i})})),o}},{key:"setSpans",value:function(e,t,n){var r=e.excuteActionImpl(t,n);return this.context.trigger(_.YVA.SPANS_CHANGE,{spans:r,sheet:t}),r}},{key:"addSheet",value:function(e,t,n){var r=E(t);e.excuteActionImpl(t,n),(0,d.rV)(this.sdk,(0,h.editableSelector)(r.getState()))}},{key:"restoreSheet",value:function(e,t,n){var r=E(t);e.excuteActionImpl(t,n);var i=n.sheet_id;(0,d.rV)(this.sdk,(0,h.editableWithSheetPermissionSelector)(r.getState())),this.context.trigger(_.YVA.RESTORE_SHEET,i)}},{key:"copySheet",value:function(e,t,n){var r=E(t);e.excuteActionImpl(t,n),(0,d.rV)(this.sdk,(0,h.editableSelector)(r.getState()))}},{key:"delSheet",value:function(e,t,n,r){"function"==typeof t.cancelPaste&&t.cancelPaste(),C({sdk:this.sdk,spread:t.parent,sheetId:t.id(),local:r,context:this.context,collaborator:this.collaborator,cellEditor:this.cellEditor,handler:function(){e.excuteActionImpl(t,n)}})}},{key:"delView",value:function(e,t,n,r){!function(e,t,n){var r=e.viewsModel.activeView;!n&&r&&r.getId()===t.value.view_id&&o.Toast.show({key:"sheetFilterViewDelete",type:"error",content:m("sheets.filter_view.filter_been_deleted"),duration:2500,closable:!1,style:{top:"200px"}})}(t,n,r),e.excuteActionImpl(t,n)}},{key:"softDelSheet",value:function(e,t,n){var r;e.excuteActionImpl(t,n),this.context.trigger(_.YVA.SOFT_DEL_SHEET),null===(r=this.collaborator)||void 0===r||r.resumeApplyAction("softDelSheet")}},{key:"addRow",value:function(e,t,n,r,i){var o,s,u,d,f=this,p=n.target,g=function(){e.excuteActionImpl(t,n,i),f.context.trigger(_.YVA.CELL_COORD_CHANGE,{type:"add",local:r,target:{row:p.row,rowCount:p.rowCount},sheet:t})},y=t.getActiveRowIndex(),m=t.getActiveColumnIndex();if(null===(o=this.cellEditor)||void 0===o||!o.isEditing(t)){var E;g();var T=null===(E=n.extra)||void 0===E?void 0:E.keepSelection,C=!(0,l.UQ)()&&!T&&(0,h.selectShouldUpdateSelection)(a.store.getState());return C&&w({target:p.row,count:p.rowCount},t,r,"row"),void(!C&&a.store.dispatch((0,c.setShouldUpdateSelection)(!0)))}var S=null===(s=this.cellEditor)||void 0===s?void 0:s.getEditorValue();g(),y<p.row||b(t)||(null===(u=this.cellEditor)||void 0===u||u.endEdit({sheet:t,ignoreValueChange:!0}),t.setActiveCell(y+p.rowCount,m,{source:v.QOl.ADD_ROW}),null===(d=this.cellEditor)||void 0===d||d.startEdit({sheet:t,defaultText:S}))}},{key:"addCol",value:function(e,t,n,r,i){var o,a,s,u,c,h=this,d=n.target,f=t.getActiveRowIndex(),p=t.getActiveColumnIndex(),g=function(){e.excuteActionImpl(t,n,i),h.context.trigger(_.YVA.CELL_COORD_CHANGE,{type:"add",local:r,target:{col:d.col,colCount:d.colCount},sheet:t})};if(null===(o=this.cellEditor)||void 0===o||!o.isEditing(t))return g(),void(!(null===(c=n.extra)||void 0===c?void 0:c.keepSelection)&&!(0,l.UQ)()&&w({target:d.col,count:d.colCount},t,r,"col"));var y=null===(a=this.cellEditor)||void 0===a?void 0:a.getEditorValue();g(),p<d.col||b(t)||(null===(s=this.cellEditor)||void 0===s||s.endEdit({sheet:t,ignoreValueChange:!0}),t.setActiveCell(f,p+d.colCount,{source:v.QOl.ADD_COL}),null===(u=this.cellEditor)||void 0===u||u.startEdit({sheet:t,defaultText:y}))}},{key:"delRow",value:function(e,t,n,r,i){var o,a,c,h=this,d=n.target,f=function(){e.excuteActionImpl(t,n,i),h.context.trigger(_.YVA.CELL_COORD_CHANGE,{target:{row:d.row,rowCount:d.rowCount},type:"del",local:r,sheet:t})},g=t.getActiveRowIndex(),y=t.getActiveColumnIndex();if(g<d.row||b(t))return f();if(null===(o=this.cellEditor)||void 0===o||!o.isEditing(t))return f(),void((0,l.UQ)()||S({target:d.row,count:d.rowCount},t,r,"row"));var E,T=null===(a=this.cellEditor)||void 0===a?void 0:a.getEditorValue();(null===(c=this.cellEditor)||void 0===c||c.endEdit({sheet:t,ignoreValueChange:!0}),f(),g<d.row+d.rowCount)?(0,u.x2)(v.ZB9.ERROR_CELL_NOT_EXIST,{body:p().createElement("div",null,p().createElement("p",null,m("common.cell_has_deleted")),s.browser.mobile?null:p().createElement("p",{style:{wordBreak:"break-word"}},m("sheet.current_content"),T))}):(t.setActiveCell(g-d.rowCount,y),null===(E=this.cellEditor)||void 0===E||E.startEdit({sheet:t,defaultText:T}))}},{key:"setRowHeight",value:function(e,t,n,r){e.excuteActionImpl(t,n),this.context.trigger(_.YVA.CELL_COORD_CHANGE,{type:"set_row_height",local:r})}},{key:"delCol",value:function(e,t,n,r,i){var o,a,c,h=this,d=n.target,f=function(){e.excuteActionImpl(t,n,i),h.context.trigger(_.YVA.CELL_COORD_CHANGE,{target:{col:d.col,colCount:d.colCount},type:"del",local:r,sheet:t})},g=t.getActiveRowIndex(),y=t.getActiveColumnIndex();if(y<d.col||b(t))return f();if(null===(o=this.cellEditor)||void 0===o||!o.isEditing(t))return f(),void((0,l.UQ)()||S({target:d.col,count:d.colCount},t,r,"col"));var E,T=null===(a=this.cellEditor)||void 0===a?void 0:a.getEditorValue();(null===(c=this.cellEditor)||void 0===c||c.endEdit({sheet:t,ignoreValueChange:!0}),f(),y<d.col+d.colCount)?(0,u.x2)(v.ZB9.ERROR_CELL_NOT_EXIST,{body:p().createElement("div",null,p().createElement("p",null,m("common.cell_has_deleted")),s.browser.mobile?null:p().createElement("p",{style:{wordBreak:"break-word"}},m("sheet.current_content"),T))}):(t.setActiveCell(g,y-d.colCount),null===(E=this.cellEditor)||void 0===E||E.startEdit({sheet:t,defaultText:T}))}},{key:"hideRow",value:function(e,t,n){var r,i,o,a=this,s=n.target,l=t.getActiveRowIndex(),c=t.getActiveColumnIndex();if(l<s.row||b(t))return e.excuteActionImpl(t,n);var h=!!t.getSelections().length;if(null!==(r=this.cellEditor)&&void 0!==r&&r.isEditing(t))if(l<s.row+s.rowCount)setTimeout((function(){var r;null===(r=a.cellEditor)||void 0===r||r.endEdit({sheet:t}),e.excuteActionImpl(t,n);var i=A(t,l,c,!0);h&&t.setActiveCell(i,c),(0,u.x2)(v.ZB9.ERROR_CELL_NOT_EXIST,{body:p().createElement("div",null,p().createElement("p",null,m("common.cell_has_hidden")))})}),0);else{var d=null===(i=this.cellEditor)||void 0===i?void 0:i.getEditorValue();null===(o=this.cellEditor)||void 0===o||o.endEdit({sheet:t,ignoreValueChange:!0}),e.excuteActionImpl(t,n),setTimeout((function(){var e;h&&t.setActiveCell(l,c),null===(e=a.cellEditor)||void 0===e||e.startEdit({sheet:t,defaultText:d})}),0)}else if(e.excuteActionImpl(t,n),l>=s.row&&l<s.row+s.rowCount){var f=A(t,l,c,!0);h&&t.setActiveCell(f,c)}}},{key:"unhideRow",value:function(e,t,n){var r,i,o,a=this,s=n.target,u=t.getActiveRowIndex(),l=t.getActiveColumnIndex();if(u<s.row||b(t)||null===(r=this.cellEditor)||void 0===r||!r.isEditing(t))return e.excuteActionImpl(t,n);var c=null===(i=this.cellEditor)||void 0===i?void 0:i.getEditorValue(),h=!!t.getSelections().length;null===(o=this.cellEditor)||void 0===o||o.endEdit({sheet:t,ignoreValueChange:!0}),e.excuteActionImpl(t,n),setTimeout((function(){var e;h&&t.setActiveCell(u,l),null===(e=a.cellEditor)||void 0===e||e.startEdit({sheet:t,defaultText:c})}),0)}},{key:"hideCol",value:function(e,t,n){var r,i,o,a=this,s=n.target,l=t.getActiveRowIndex(),c=t.getActiveColumnIndex();if(c<s.col||b(t))return e.excuteActionImpl(t,n);var h=!!t.getSelections().length;if(null!==(r=this.cellEditor)&&void 0!==r&&r.isEditing(t))if(c<s.col+s.colCount)setTimeout((function(){var r;null===(r=a.cellEditor)||void 0===r||r.endEdit({sheet:t}),e.excuteActionImpl(t,n);var i=A(t,l,c,!1);h&&t.setActiveCell(l,i),(0,u.x2)(v.ZB9.ERROR_CELL_NOT_EXIST,{body:p().createElement("div",null,p().createElement("p",null,m("common.cell_has_hidden")))})}),0);else{var d=null===(i=this.cellEditor)||void 0===i?void 0:i.getEditorValue();null===(o=this.cellEditor)||void 0===o||o.endEdit({sheet:t,ignoreValueChange:!0}),e.excuteActionImpl(t,n),setTimeout((function(){var e;h&&t.setActiveCell(l,c),null===(e=a.cellEditor)||void 0===e||e.startEdit({sheet:t,defaultText:d})}),0)}else if(e.excuteActionImpl(t,n),c>=s.col&&c<s.col+s.colCount){var f=A(t,l,c,!1);h&&t.setActiveCell(l,f)}}},{key:"unhideCol",value:function(e,t,n){var r,i,o,a=this,s=n.target,u=t.getActiveRowIndex(),l=t.getActiveColumnIndex();if(l<s.col||b(t)||null===(r=this.cellEditor)||void 0===r||!r.isEditing(t))return e.excuteActionImpl(t,n);var c=null===(i=this.cellEditor)||void 0===i?void 0:i.getEditorValue(),h=!!t.getSelections().length;null===(o=this.cellEditor)||void 0===o||o.endEdit({sheet:t,ignoreValueChange:!0}),e.excuteActionImpl(t,n),setTimeout((function(){var e;h&&t.setActiveCell(u,l),null===(e=a.cellEditor)||void 0===e||e.startEdit({sheet:t,defaultText:c})}),0)}},{key:"updateOutline",value:function(e,t,n){var r,i,o,a=this;if(t!==t.parent.getActiveSheet())return e.excuteActionImpl(t,n);var s=n.target,l=(0,g.ClL)(s);if(!l)return!1;var c=l.type===v.xj7.ROW,h=c?l.row:l.col,d=c?l.rowCount:l.colCount,f=h+d,_=t.getActiveRowIndex(),y=t.getActiveColumnIndex(),E=c?_:y;if(E<h)return e.excuteActionImpl(t,n);if(null!==(r=this.cellEditor)&&void 0!==r&&r.isEditing(t))if(E<f)setTimeout((function(){var r;null===(r=a.cellEditor)||void 0===r||r.endEdit({sheet:t});var i=c?_+d:_,o=c?y:y+d;t.setActiveCell(i,o),e.excuteActionImpl(t,n),(0,u.x2)(v.ZB9.ERROR_CELL_NOT_EXIST,{body:p().createElement("div",null,p().createElement("p",null,m("common.cell_has_hidden")))})}),0);else{var b=null===(i=this.cellEditor)||void 0===i?void 0:i.getEditorValue();null===(o=this.cellEditor)||void 0===o||o.endEdit({sheet:t,ignoreValueChange:!0}),e.excuteActionImpl(t,n),setTimeout((function(){var e;t.setActiveCell(_,y),null===(e=a.cellEditor)||void 0===e||e.startEdit({sheet:t,defaultText:b})}),0)}else if(e.excuteActionImpl(t,n),h<=E&&E<f){var T=c?_+d:_,C=c?y:y+d;t.setActiveCell(T,C)}}},{key:"freezeSheet",value:function(e,t,n){s.browser.mobile||e.excuteActionImpl(t,n)}},{key:"setSheet",value:function(e,t,n,r){!function(e,t,n){var r=e.getParent();if(!r.permissionManager.curSheetVisiblePerm)return;var i=e.id(),a=r.getActiveSheet().id(),u=E(r).getState().sheet,l=u.sheetMode[u.sheetMode.length-1],c=u.translateMode.isActive,h="normal"===l&&!c;if(!n&&h&&a===i&&"gridLine"===t.value.property_name){var d=t.member_id,f="";if(void 0!==d){var p=(0,s.getUserByMemberId)(d);f=(0,s.getUserShowNameForLang)(p)||""}if(""===f)return;var v=m("CreationDoc_Sheets_gridline_Showtip",f);!0===t.value.grid_line_hidden&&(v=m("CreationDoc_Sheets_gridline_Hidetip",f)),o.Toast.show({key:"showGirdLineToast",type:"info",content:v,duration:2500,closable:!1})}}(t,n,r),e.excuteActionImpl(t,n)}},{key:"coverSnapshot",value:function(e,t,n,r){var i=E(t);e.excuteActionImpl(t,n),(0,d.rV)(this.sdk,(0,h.editableSelector)(i.getState()))}},{key:"coverSheet",value:function(e,t,n){var r=E(t);e.excuteActionImpl(t,n),(0,d.qv)(t,(0,h.editableSelector)(r.getState()))}},{key:"addBlock",value:function(e,t,n){var r=E(t);e.excuteActionImpl(t,n),(0,d.rV)(this.sdk,(0,h.editableSelector)(r.getState()))}},{key:"restoreBlock",value:function(e,t,n){var r=E(t);e.excuteActionImpl(t,n),(0,d.rV)(this.sdk,(0,h.editableSelector)(r.getState()))}},{key:"delBlock",value:function(e,t,n,r){C({sdk:this.sdk,spread:t,sheetId:n.sheet_id,local:r,context:this.context,collaborator:this.collaborator,cellEditor:this.cellEditor,handler:function(){e.excuteActionImpl(t,n)}})}},{key:"cellEditor",get:function(){var e;return null===(e=this.sdk)||void 0===e?void 0:e.getPlugin("CellEditorPlugin")}},{key:"collaborator",get:function(){var e;return null===(e=this.sdk)||void 0===e?void 0:e.getPlugin("CollaborationPlugin")}}]),e}();function C(e){var t=e.sdk,n=e.spread,r=e.sheetId,i=e.local,o=e.context,a=e.collaborator,c=e.cellEditor,h=e.handler;null==a||a.suspendApplyAction("deleteAndChangeActiveSheet"),function(e){var t=e.sdk,n=e.spread,r=e.sheetId,i=e.local,o=e.context,a=e.cellEditor,c=e.handler,h=n.getActiveSheet(),d=n.getSheetFromId(r);if(!d)return;i||!h||h.name()!==d.name()||s.browser.isFeishuRooms||(0,l.UQ)()?c():(null!=a&&a.isEditing(h)&&a.endEdit({sheet:h,ignoreValueChange:!0}),(0,y.st)(t),(0,u.x2)(v.ZB9.ERROR_SHEET_NOT_EXIST,{onConfirm:c,onCancel:function(){o.trigger(_.YVA.FREEZE_SPREAD),(0,y.o_)(t)}}))}({sdk:t,spread:n,sheetId:r,local:i,context:o,cellEditor:c,handler:function(){h(),null==a||a.resumeApplyAction("deleteAndChangeActiveSheet"),n.forceResumeEvent()}})}function S(e,t,n,r){var i="row"===r?"rowFrom":"colFrom",o="row"===r?"rowTo":"colTo",a="row"===r?"rowCount":"colCount",s="row"===r?"_activeRowIndex":"_activeColIndex",u="row"===r?g.lq$:g.rvb,l="row"===r?t.getRowCount():t.getColumnCount(),c=t.getSelections();if(c&&c.length){var h=c;n||(h=R("del",c,t,e,{TYPE_FROM:i,TYPE_TO:o,TYPE_COUNT:a,TypeRange:u,type:r})),h=h.map((function(n){var o=n[i](),s=n[a](!0);return o+s>l?n instanceof u?new u(Math.max(l-e.count,0),Math.min(l,e.count),t):"row"===r?new g.e6w(Math.max(o-e.count,0),n.colFrom(),Math.min(s,l),n.colCount(!0),t):new g.e6w(n.rowFrom(),Math.max(o-e.count,0),n.rowCount(!0),Math.min(s,l),t):n})),t[s]=h[h.length-1][i](),t.setSelections(h)}}function w(e,t,n,r){var i="row"===r?"rowFrom":"colFrom",o="row"===r?"rowTo":"colTo",a="row"===r?"rowCount":"colCount",s="row"===r?g.lq$:g.rvb,u="row"===r?"_activeRowIndex":"_activeColIndex",l=t.getSelections();if(l&&l.length){var c=l;c=n?c.map((function(n){var r=n[i](),o=n[a]();return r+o===e.target?new s(e.target,e.count,t):r>e.target?new s(r+e.count,o,t):new s(r,o,t)})):R("add",l,t,e,{TYPE_FROM:i,TYPE_TO:o,TYPE_COUNT:a,TypeRange:s,type:r}),t[u]=c[c.length-1][i](),t.setSelections(c)}}function R(e,t,n,r,i){var o=i.TYPE_FROM,a=i.TYPE_TO,s=i.TYPE_COUNT,u=i.TypeRange,l=i.type,c="row"===l?n.getRowCount():n.getColumnCount();return t.map((function(t){var i=t[o](),h=t[s](!0);return t[a]()<r.target?t:function(t,i,o){return t instanceof u?"add"===e?new u(i+r.count,o,n):new u(Math.max(i-r.count,0),Math.min(o,c),n):"row"===l?"add"===e?new g.e6w(i+r.count,t.colFrom(),o,t.colCount(!0),n):new g.e6w(Math.max(i-r.count,0),t.colFrom(),Math.min(o,c),t.colCount(!0),n):"add"===e?new g.e6w(t.rowFrom(),i+r.count,t.rowCount(!0),o,n):new g.e6w(t.rowFrom(),Math.max(i-r.count,0),t.rowCount(!0),Math.min(o,c),n)}(t,i,h)}))}function A(e,t,n,r){if(r){var i=e._getNextVisualRow(t);return null!==i?i:e._getPrevVisualRow(t)}var o=e._getNextVisualColumn(n);return null!==o?o:e._getPrevVisualColumn(n)}},vsh_10455:function(e,t,n){"use strict";var r,i;n.d(t,{j:function(){return r},g:function(){return i}}),function(e){e.Sheet="sheet",e.Database="database"}(r||(r={})),function(e){e[e.DEFAULT=1]="DEFAULT",e[e.STATIC=2]="STATIC",e[e.THIRD_PARTY=3]="THIRD_PARTY"}(i||(i={}))},vsh_10607:function(e,t,n){"use strict";n.d(t,{BT:function(){return o},cy:function(){return a},Rv:function(){return s},i0:function(){return u},Ep:function(){return l},U:function(){return c},fY:function(){return h},cq:function(){return d},gh:function(){return f},wY:function(){return p},j0:function(){return v},rU:function(){return g},Qk:function(){return _},Hy:function(){return y}});var r=n("vsh_98125"),i=n("vsh_73043"),o=(0,r.createContext)({}),a=function(){return(0,r.useContext)(o)},s=(0,r.createContext)({}),u=function(){return(0,r.useContext)(s)},l=(0,r.createContext)({}),c=function(){return(0,r.useContext)(l)},h=(0,r.createContext)({}),d=function(){return(0,r.useContext)(h)},f=((0,r.createContext)({}),(0,r.createContext)(i)),p=(0,r.createContext)({}),v=function(){return(0,r.useContext)(p)},g=(0,r.createContext)({}),_=(0,r.createContext)(null),y=function(){return(0,r.useContext)(_)}},vsh_36557:function(e,t,n){"use strict";n.d(t,{Ep:function(){return r.Ep},U:function(){return r.U},sq:function(){return i},C9:function(){return o}});var r=n("vsh_10607"),i=function(){var e=(0,r.U)();return"true"!=={NODE_ENV:"production",CDN_URL:navigator.cdn_host+"/eesz/bear/sheet/module",FASTER_TEST:void 0}.bear_web_custom_story&&e._context.isEmbed()},o=function(){var e=(0,r.U)();return"true"!=={NODE_ENV:"production",CDN_URL:navigator.cdn_host+"/eesz/bear/sheet/module",FASTER_TEST:void 0}.bear_web_custom_story&&e._context.isFullScreenMode()}},vsh_50013:function(e,t,n){"use strict";n.d(t,{u9:function(){return r},bR:function(){return i}});function r(e){var t=e.row,n=e.col,r=e.row_count,i=e.col_count;return null!=t&&null!=n&&null==r&&null==i}function i(e){var t=e.row,n=e.col,r=e.row_count,i=e.col_count;return null!=t&&null!=n&&null!=r&&0!==r&&null!=i&&0!==i}},vsh_87979:function(e,t,n){"use strict";n.r(t),n.d(t,{provider:function(){return w}});var r=n("vsh_67017"),i=n.n(r),o=n("vsh_35067"),a=n("vsh_4561"),s=n("vsh_59980"),u=n("vsh_98125"),l=n.n(u),c=n("vsh_52856"),h=n.n(c),d=n("vsh_12484"),f=n("vsh_22488"),p=n("vsh_96579"),v=n("vsh_72929"),g=n("vsh_45495");(0,f.removeSheetWeakNetworkToast)();var _,y=function(){return Promise.all([n.e("vsh_7554"),n.e("vsh_4546"),n.e("vsh_7659"),n.e("vsh_5936"),n.e("vsh_9414"),n.e("vsh_2639"),n.e("vsh_7335"),n.e("vsh_3167")]).then(n.bind(n,"vsh_34699"))},m=function(){return Promise.all([n.e("vsh_7554"),n.e("vsh_4546"),n.e("vsh_7659"),n.e("vsh_5936"),n.e("vsh_9414"),n.e("vsh_2639"),n.e("vsh_7335"),n.e("vsh_3167")]).then(n.bind(n,"vsh_38768"))},E=function(){return Promise.all([n.e("vsh_7554"),n.e("vsh_4546"),n.e("vsh_7659"),n.e("vsh_9329"),n.e("vsh_4563"),n.e("vsh_9414"),n.e("vsh_2639"),n.e("vsh_1683")]).then(n.bind(n,"vsh_78808"))},b=function(){return Promise.all([n.e("vsh_4670"),n.e("vsh_2509"),n.e("vsh_2172"),n.e("vsh_7554"),n.e("vsh_4546"),n.e("vsh_7659"),n.e("vsh_5390"),n.e("vsh_9329"),n.e("vsh_5936"),n.e("vsh_4563"),n.e("vsh_9414"),n.e("vsh_6543"),n.e("vsh_1099"),n.e("vsh_1548")]).then(n.bind(n,"vsh_69745"))},T=h()({loader:m,loading:function(e){var t=e.error;return t&&(console.error(t),S("FeedSpreadsheet",t)),null}}),C=h()({loader:(_=y,(0,o.Z)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=_(),e.next=3,new Promise((function(e){var t=g.Hb.SpreadAppInstance;t&&!d.isShortCutServer?t.spreadSheetObservableVars.spreadLoading.subscribe((function(t){t||e(null)})):e(null)}));case 3:return e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))),loading:function(e){var t=e.error;return t&&(console.error(t),S("PcSpreadsheet",t)),null}});try{window.scmsheet=window.scmsheet||{},window.scmsheet.scmInfo={version:"1.1.2.9812",branch:"release-web-2025.6.3",type:"online",commit_hash:"undefined",build_time:"2025-06-16 20:39:29.273"},p.collector.updateConfig({"custom.scmsheet":(0,s.default)(window,"scmsheet.version","")})}catch(e){console.log(e)}if("true"==={NODE_ENV:"production",CDN_URL:navigator.cdn_host+"/eesz/bear/sheet/module",FASTER_TEST:void 0}.bear_web_custom_cov_enabled){!function(){console.log("start uploading coverage ...");try{n.e("vsh_7120").then(n.t.bind(n,"vsh_7120",23)).then((function(e){var t=e.createCoverageUploader,n=e.preReport,r="".concat({NODE_ENV:"production",CDN_URL:navigator.cdn_host+"/eesz/bear/sheet/module",FASTER_TEST:void 0}.bear_web_custom_cov_base_url,"/api/v2/front/cover_data_upload"),i={NODE_ENV:"production",CDN_URL:navigator.cdn_host+"/eesz/bear/sheet/module",FASTER_TEST:void 0}.bear_web_custom_cov_repoId,o=window.__coverage_info__[i];console.log("coverage config: ".concat(JSON.stringify(o))),t({url:r,interval:1e4,repoId:i,preReport:n.qaPreReport({reqParams:{pid:"570436",commitId:o.commitId,git_branch:o.gitBranch}})}).init()})).catch((function(e){console.error("Failed to load '@byted/work-flow-coverage-uploader'",e)}))}catch(e){console.error("coverage start up failed: ",e)}}()}function S(e,t){(0,p.collectSuiteEvent)("ccm_sheet_plugin_load_fail_dev",{reason:e,message:t.message}),p.moirae.ravenCatch(t,{tags:{key:"SHEET_MAIN_CHUNK_LOAD_ERROR"}})}var w=function(){return{render:a.default,destroy:a.default,routes:[{path:"",name:"sheet",component:function(e){var t=f.browser.isFeed?T:C;return l().createElement(t,Object.assign({},e))}}],redux:{getSheetModule:v._,getReduxModule:v._},bridge:E,templateSpreadsheet:b,pc:y,feed:m}};window.sheetProvider=w,window.sheetRunMiniApp&&n("vsh_6409").P(),Promise.resolve().then((function(){(0,f.mountApp)(w(),f.MicroServiceType.SHEET)})),console.info("Sheet index Merged Garr Loaded!")},vsh_6409:function(e,t,n){"use strict";n.d(t,{P:function(){return s}});var r=n("vsh_72929"),i=n("vsh_18801"),o=n("vsh_22488"),a=n("vsh_45495");function s(){var e=(0,o.getToken)();i.store.addModule((0,r._)()),(0,a.Ur)(e)}},vsh_18993:function(e,t,n){"use strict";n.d(t,{dt:function(){return r},gY:function(){return c},p4:function(){return h}});var r,i=n("vsh_74561"),o=n("vsh_19264"),a=n("vsh_4175"),s=n("vsh_18801"),u=n("vsh_12484"),l=n("vsh_22488");function c(){return l.ClipboardHelper.getCcmClipboardSecurityEnable()}!function(e){e.TEXT="text/plain",e.HTML="text/html",e.SHEET="text/sheet",e.AJSON="application/json",e.ABUSSINESSKEY="application/x-editor-kit-business-key",e.AFRAGMENT="application/x-editor-kit-fragment",e.TEXT_IE="Text",e.TEXT_URI_LIST="text/uri-list"}(r||(r={}));var h=new(function(){function e(t){(0,o.Z)(this,e),this.ClipboardHelper=t}return(0,a.Z)(e,[{key:"formatArrayFlat",value:function(e){return[e].flat(1/0)}},{key:"getDataWithEventPreventDefault",value:function(e,t){var n=this;return new Promise((function(r){var i=n.formatArrayFlat(t);r(n.getDataWithErrorHandler(n.ClipboardHelper.handlePasteEvent,{event:e,type:i},!0))}))}},{key:"setDataWithEventPreventDefault",value:function(e,t){var n=this;return new Promise((function(r){r(n.setDataWithErrorHandler(n.ClipboardHelper.handleCopyEvent,{event:e,data:t},!0))}))}},{key:"getData",value:function(e,t){var n=this;return new Promise((function(r){var i=n.formatArrayFlat(t);r(n.getDataWithErrorHandler(n.ClipboardHelper.getData,{clipboardData:e,type:i},!1))}))}},{key:"setData",value:function(e,t,n){var r=this;return new Promise((function(o){o(r.setDataWithErrorHandler(r.ClipboardHelper.setData,{clipboardData:e,data:(0,i.Z)({},t,n)},!1))}))}},{key:"getDataWithErrorHandler",value:function(e,t,n){var r;try{return r=e(t),this.generateResult(!0,n,r)}catch(e){return console.log(e),r={},t.type.forEach((function(e){r[e]=""})),this.generateResult(!1,n,r)}}},{key:"setDataWithErrorHandler",value:function(e,t,n){try{return e(t),this.generateResult(!0,n)}catch(e){return console.log(e),this.generateResult(!1,n)}}},{key:"generateResult",value:function(e,t,n){return{success:e,isEvent:t,data:n}}},{key:"getDataSynchronization",value:function(e,t){return this.ClipboardHelper.getData({clipboardData:e,type:this.formatArrayFlat(t)})}},{key:"getCcmClipboardSecurityEnable",value:function(){return this.ClipboardHelper.getCcmClipboardSecurityEnable()}},{key:"getClipboardSecurityEnable",value:function(){return this.ClipboardHelper.getClipboardSecurityEnable()}},{key:"showPasteErrorToast",value:function(){this.ClipboardHelper.showPasteErrorToast()}},{key:"showCopyErrorToast",value:function(){s.store.dispatch({type:u.actionTypes.permission.COPY_TEXT_FAIL})}}]),e}())(l.ClipboardHelper)},vsh_43350:function(e,t,n){"use strict";function r(e){var t,n=!1;return function(){return n||(t=e(),n=!0),t}}function i(e,t){var n,r=[],i=!1,o=function(e,n){return t?t(e,r[n]):e===r[n]};return function(){for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return i&&a.length===r.length&&a.every(o)||(n=e.apply(void 0,a),r=a,i=!0),n}}n.d(t,{DI:function(){return r},HP:function(){return i}})},vsh_51504:function(e,t,n){"use strict";n.d(t,{sX:function(){return _},M$:function(){return y},Q_:function(){return m},s9:function(){return E},LG:function(){return b},qG:function(){return T},R3:function(){return C},OR:function(){return S},O:function(){return w},O7:function(){return R},d_:function(){return A},V_:function(){return M},P_:function(){return k},hP:function(){return I},JX:function(){return x}});var r,i=n("vsh_98652"),o=n("vsh_74561"),a=n("vsh_69691"),s=n("vsh_22488"),u=n("vsh_96579"),l=n("vsh_24627"),c=n("vsh_72834"),h=n("vsh_7959"),d=n("vsh_33272"),f=n("vsh_73264"),p=n("vsh_73043");function v(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _=(0,s.getMinaNumberConfig)("sheet_cf_max_count",20),y=function(e){return!!e&&(e.conditionalFormatModel.getAllRules().length||0)>=_};function m(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=arguments.length>5?arguments[5]:void 0,a=t.map((function(e){return(0,c.z3T)(e)}));e.addConditionalFormat({ranges:a,ruleType:r,style:n,attrs:i,cfId:o})}function E(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],a=n.map((function(e){return(0,c.z3T)(e)}));e.setConditionalFormat(t,{ranges:a,ruleType:i,style:r,attrs:o})}function b(e,t){e.clearRangeConditionalFormat(t)}function T(e){var t=e.conditionalFormatModel.getAllRules().filter((function(e){return e.ruleType===l.eFJ.DUPLICATE_VALUES})).map((function(e){return e.cfId}));e.delConditionalFormat(t)}function C(e,t){e.delConditionalFormat([t])}function S(e,t){return e.conditionalFormatModel.getRulesByRange(t)}function w(e){return e.conditionalFormatModel.getAllRules()}function R(e,t){var n=t.oldIndex,r=t.newIndex;return e.moveConditionalFormat(n,r)}function A(e){var t=e.getSelections(),n=e.conditionalFormatModel.getAllRules(),r=new Map,i=[];return n.forEach((function(e){var n,o=v(t);try{for(o.s();!(n=o.n()).done;){var a=n.value;if(e.isIntersect(a))return r.set(e.cfId,e),void i.push(e.cfId)}}catch(e){o.e(e)}finally{o.f()}})),{cfIds:i,ruleMap:r}}var O=(r={},(0,o.Z)(r,l.eFJ.DATA_BAR,p("LarkCCM_Sheets_Toolbar_Condition_DataBar_Menu")),(0,o.Z)(r,l.eFJ.COLOR_SCALE,p("LarkCCM_Sheets_Toolbar_Condition_ColorScales_Menu")),(0,o.Z)(r,l.eFJ.RANK,(function(e){var t,n=function(e){return e?"bottom":"top"},r=(t={},(0,o.Z)(t,n(!1)+l.cPJ.Sort,(function(e){return p("LarkCCM_Sheets_Toolbar_Condition_TopNItem_Menu",e)})),(0,o.Z)(t,n(!0)+l.cPJ.Sort,(function(e){return p("LarkCCM_Sheets_Toolbar_Condition_BottomNItem_Menu",e)})),(0,o.Z)(t,n(!1)+l.cPJ.Percent,(function(e){return p("CreationDoc_Sheets_TopNumberPercent",e)})),(0,o.Z)(t,n(!0)+l.cPJ.Percent,(function(e){return p("CreationDoc_Sheets_BottomNumberPercent",e)})),t);try{var i=e.getAttr(),a=i.isBottom,s=i.valueType,u=i.value;return r[n(a)+s](u)}catch(e){return console.error(e),""}})),(0,o.Z)(r,l.eFJ.AVERAGE,(function(e){var t,n=(t={},(0,o.Z)(t,l.S7R.Greater,p("LarkCCM_Sheets_Toolbar_Condition_AboveAverage_Menu")),(0,o.Z)(t,l.S7R.Less,p("LarkCCM_Sheets_Toolbar_Condition_BelowAverage_Menu")),t);try{return n[e.getAttr().operator]}catch(e){return console.error(e),""}})),(0,o.Z)(r,l.eFJ.EXPRESSION,(function(e){try{var t=e.getAttr().formula;return p("CreationDoc_Sheets_ManageRules_CustomFormula",t[0])}catch(e){return console.error(e),""}})),(0,o.Z)(r,l.eFJ.ICON_SET,p("LarkCCM_Sheets_Toolbar_Condition_IconSets_Menu")),(0,o.Z)(r,l.eFJ.DUPLICATE_VALUES,p("LarkCCM_Sheets_Toolbar_Condition_ContainsDuplicateValues_Menu")),(0,o.Z)(r,l.eFJ.UNIQUE_VALUES,p("LarkCCM_Sheets_Toolbar_Condition_ContainsUniqueValues_Menu")),(0,o.Z)(r,l.eFJ.CELL_IS,(function(e){var t,n=(t={},(0,o.Z)(t,l.gAB.Greater,(function(e){return p.apply(void 0,["CreationDoc_Sheets_ConditionalFormatting.rule.greater"].concat((0,i.Z)(e)))})),(0,o.Z)(t,l.gAB.Between,(function(e){return p.apply(void 0,["CreationDoc_Sheets_ConditionalFormatting.is.between"].concat((0,i.Z)(e)))})),(0,o.Z)(t,l.gAB.Equal,(function(e){return p.apply(void 0,["CreationDoc_Sheets_ConditionalFormatting.rule.equal"].concat((0,i.Z)(e)))})),(0,o.Z)(t,l.gAB.GreaterOrEqual,(function(e){return p.apply(void 0,["CreationDoc_Sheets_ConditionalFormatting.rule.greaterequal"].concat((0,i.Z)(e)))})),(0,o.Z)(t,l.gAB.Less,(function(e){return p.apply(void 0,["CreationDoc_Sheets_ConditionalFormatting.rule.less"].concat((0,i.Z)(e)))})),(0,o.Z)(t,l.gAB.LessOrEqual,(function(e){return p.apply(void 0,["CreationDoc_Sheets_ConditionalFormatting.rule.lessequal"].concat((0,i.Z)(e)))})),(0,o.Z)(t,l.gAB.NotBetween,(function(e){return p.apply(void 0,["CreationDoc_Sheets_ConditionalFormatting.is.not.between"].concat((0,i.Z)(e)))})),(0,o.Z)(t,l.gAB.NotEqual,(function(e){return p.apply(void 0,["CreationDoc_Sheets_ConditionalFormatting.rule.notequal"].concat((0,i.Z)(e)))})),t);try{var r=e.getAttr();return n[r.operator](void 0===r.plaintext?(0,f.oE)(r.formula):r.plaintext)}catch(e){return console.error(e),""}})),(0,o.Z)(r,l.eFJ.CONTAINS_TEXT,(function(e){var t,n=(t={},(0,o.Z)(t,l.CyK.BeginsWith,(function(e){return p("CreationDoc_Sheets_ConditionalFormatting.rule.startwith",e)})),(0,o.Z)(t,l.CyK.Contains,(function(e){return p("CreationDoc_Sheets_ConditionalFormatting.rule.including",e)})),(0,o.Z)(t,l.CyK.DoesNotContain,(function(e){return p("CreationDoc_Sheets_ConditionalFormatting.rule.notincluding",e)})),(0,o.Z)(t,l.CyK.EndsWith,(function(e){return p("CreationDoc_Sheets_ConditionalFormatting.rule.endwith",e)})),(0,o.Z)(t,l.CyK.Is,(function(e){return p("CreationDoc_Sheets_ConditionalFormatting.rule.textis",e)})),t);try{var r=e.getAttr();return n[r.operator](r.text)}catch(e){return""}})),(0,o.Z)(r,l.eFJ.CONTAINS_BLANKS,p("CreationDoc_Sheets_ConditionalFormatting.is.empty")),(0,o.Z)(r,l.eFJ.NOT_CONTAINS_BLANKS,p("CreationDoc_Sheets_ConditionalFormatting.is.filled")),(0,o.Z)(r,l.eFJ.TIME_PERIOD,(function(e){var t,n=(t={},(0,o.Z)(t,l.rrR.Last7Days,p("CreationDoc_Sheets_ConditionalFormatting.rule.last7days")),(0,o.Z)(t,l.rrR.Today,p("CreationDoc_Sheets_ConditionalFormatting.rule.today")),(0,o.Z)(t,l.rrR.Tomorrow,p("CreationDoc_Sheets_ConditionalFormatting.rule.tomorrow")),(0,o.Z)(t,l.rrR.Yesterday,p("CreationDoc_Sheets_ConditionalFormatting.rule.yesterday")),t);try{return n[e.getAttr().timePeriod]}catch(e){return""}})),r);function M(e){for(var t=O[e.ruleType];"string"!=typeof t&&"function"==typeof t;)t=t(e);return t||(0,u.collectSuiteEvent)("client_sheet_conditional_format_exception",{stage:"get_rule_title",type:"p0",rule_type:e.ruleType}),t}function k(e,t,n){if(!e||!t)return!1;var r=Array.isArray(n)?n:[n];return!(!e.permissionManager.hasPermission(t.id())||!t.protectionModel.getRangePermissions(r).hasPermission)}function I(e){var t=e.getSelections();return(0,c.Bym)(t)}function x(e){var t;return{backgroundColor:"transparent"===e.backColor?void 0:(t=e.backColor,t&&(0,h.ebx)(t,a.ColorType.BACKGROUND)),color:"transparent"===e.foreColor?void 0:function(e){return e?(0,h.ebx)(e,a.ColorType.FOREGROUND):(0,a.getThemeColorByToken)(d.x)}(e.foreColor),fontStyle:e.italic?"italic":"",fontWeight:e.bold?"bold":"",textDecoration:"".concat(e.underLine?"underline":""," ").concat(e.lineThrough?"line-through":"")}}},vsh_33058:function(e,t,n){"use strict";n.r(t),n.d(t,{getMentionContainer:function(){return f},getMentionShowable:function(){return p},getMentionSource:function(){return v},handleSecureLink:function(){return g},handleUrlMouseEnter:function(){return _},handleUrlMouseLeave:function(){return y},getEditorOptions:function(){return m}});var r=n("vsh_47361"),i=n("vsh_18801"),o=n("vsh_12484"),a=n("vsh_69691"),s=n("vsh_22488"),u=n("vsh_18856"),l=n("vsh_13885"),c=n("vsh_25285"),h=n("vsh_24627"),d=n("vsh_82905");function f(e){var t,n,r;if(null!=e&&null!==(t=e.spread)&&void 0!==t&&t._context.isFullScreenMode())r=document.querySelector(".full-spreadsheet-wrap");else if(null!=e&&null!==(n=e.spread)&&void 0!==n&&n._context.isEmbed())r=document.querySelector(".doc-position");else{var i=null==e?void 0:e.getPlugin("CellEditorPlugin");r=null==i?void 0:i.wrapper}return r}function p(){if((0,i.getIsAnonymousAccess)())return!1;var e=i.store.getState();return(0,l.editablePermissionSelector)(e)}function v(){var e=i.store.getState(),t=(0,u.selectCurrentSuiteType)(e),n=o.SOURCE_ENUM.DOC;return t===o.NUM_SUITE_TYPE.SHEET?n=o.SOURCE_ENUM.SHEET:t===o.NUM_SUITE_TYPE.DOCX&&(n=o.SOURCE_ENUM.DOCX),n}function g(e,t,n){if(e.preventDefault(),(0,s.getCommentCopyLinkEnableV2)()){var o=i.store.getState(),u=(0,l.historyVisible)(o),d=(0,i.parseAnchorUrl)(t),f=d.isCommentAnchor,p=d.commentId;f&&p&&!u&&(0,a.isSameFileToken)(window.location.href,t,"sheet")?i.eventEmitter.emit("commentAnchorJumpToActiveComment",{commentId:p}):(0,c.dq)(t)}else(0,c.dq)(t);h.Ps3.collectSuiteEvent("link_clicked",{scene:r.SECURE_LINK_SCENE.CCM,location:r.SECURE_LINK_LOG.CCM_SHEET})}function _(e,t,n){var r=e.target,i=t.editorUtils.closest(r,"[data-href]"),o=t.editorUtils.closest(r,"[outer-u-container]")||i,a=null==i?void 0:i.props["data-href"];a&&o&&n.getActiveSheet().dispatch(h.U_F.EditorLinkHover,{hrefText:a,hyperDom:o,context:{editorInfo:t}})}function y(e,t){t.getActiveSheet().dispatch(h.U_F.EditorLinkLeave)}function m(e){var t={onClick:function(t,n){return g(t,n,e.spread)},onMouseEnter:function(t,n){return _(t,n,e.spread)},onMouseLeave:function(t){return y(0,e.spread)}},n={hoverArea:".spreadsheet-wrap",boxWidth:419,getSource:v,getShowable:p,getContainer:function(){return f(e)},token:(0,s.getToken)(),suiteTypeNum:(0,s.suiteTypeNum)(),UDMentionEnable:!0},r={hyperlink:t};return e.getService(d.tb).resolve("isMentionEnable",!0)&&(r.mention=n),r}},vsh_6539:function(e,t,n){"use strict";n.d(t,{c:function(){return l},m:function(){return c}});var r=n("vsh_67017"),i=n.n(r),o=n("vsh_35067"),a=n("vsh_12484"),s=n("vsh_23585"),u=n("vsh_32841");function l(e){return t={url:a.GET_FETCH_WIKI_ENTITY,method:"GET",params:{wiki_token:e},headers:{"Content-Type":"application/json"}},new Promise((function(e,n){var r="POST"===t.method?{headers:{"Content-Type":"application/json"}}:{};(0,u.request)(Object.assign({},t,{},r)).then((function(t){e(t.data)})).catch(n)}));var t}function c(e,t,n){return h.apply(this,arguments)}function h(){return h=(0,o.Z)(i().mark((function e(t,n,r){var o,a,u,l=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=l.length>3&&void 0!==l[3]?l[3]:20,e.next=3,(0,s.importGenInitSearch)();case 3:return a=e.sent,e.next=6,a();case 6:return u=e.sent,e.abrupt("return",(function(e,i){var a;return u({query:e,docTypes:t,onlyTitle:!0,category:n,sortRuleType:r,offset:null!==(a=i)&&void 0!==a?a:1,pageSize:o})}));case 8:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}},vsh_84523:function(e,t,n){"use strict";n.d(t,{p:function(){return s}});var r=n("vsh_69691"),i=n("vsh_34539"),o=n.n(i),a=n("vsh_73043");function s(e,t){var n=o()(e<1e12?1e3*e:e),i=t?o()(t):o()(Date.now()),s=i.clone().subtract(1,"days").startOf("day"),u=(0,r.getLanguage)();if(n.isSame(i,"day"))switch(u){case"zh":case"ja":return n.format("HH:mm");default:return n.format("h:mm A")}if(n.isSame(s,"day")){var l;switch(u){case"zh":case"ja":l=n.format("HH:mm");break;default:l=n.format("h:mm A")}return a("sheet.history.time.yesterday",l)}if(n.isSame(i,"year"))switch(u){case"zh":case"ja":return a("sheet.history.time.in_1year",n.month()+1,n.date(),n.format("HH:mm"));default:return n.format("h:mm A MMM D")}switch(u){case"zh":case"ja":return a("sheet.history.time_before_this_year",n.year(),n.month()+1,n.date());default:return n.format("MMM D, YYYY")}}},vsh_76197:function(e,t,n){"use strict";n.d(t,{le:function(){return c},J6:function(){return h},UC:function(){return d},cK:function(){return p},Xz:function(){return v}});var r,i=n("vsh_22488"),o=n("vsh_96579"),a=n("vsh_34539"),s=n.n(a),u=n("vsh_24627"),l="ldi:ccm_sheet_content_page_view:timestamp";function c(e,t){var n,a=function(e){var t={};try{var n=(0,u.dK5)(e),r=(0,i.getContainerParams)();Object.assign(t,n),Object.assign(t,r)}catch(e){console.info("collectSheetEvent is error",e)}return t}(null===(n=r)||void 0===n?void 0:n.getActiveSheet()),c=a;t&&Object.assign(c,t),(0,o.collectSuiteEvent)(e,c),"ccm_docs_edit_click"!==e&&"ccm_sheet_content_page_view"!==e||function(e,t){var n;try{switch(e){case"ccm_sheet_content_page_view":return void(null===(n=window.localStorage)||void 0===n||n.setItem(l,s()().format("YYYY-MM-DD")));case"ccm_docs_edit_click":if(window.localStorage){var r=window.localStorage.getItem(l);r&&!s()(r).isSame(s()(),"day")&&(0,o.collectSuiteEvent)("ccm_sheet_content_page_view")}return;default:;}}catch(e){console.log("[sheetEventReport]: ",e)}}(e)}function h(e){r=e}function d(){r=null}function f(){if("visible"===document.visibilityState&&window.localStorage){var e=window.localStorage.getItem(l);e&&!s()(e).isSame(s()(),"day")&&c("ccm_sheet_content_page_view")}}function p(){document.addEventListener("visibilitychange",f)}function v(){document.removeEventListener("visibilitychange",f)}},vsh_46162:function(e,t,n){"use strict";n.r(t),n.d(t,{getSheetRequestBlockLimit:function(){return o.getSheetRequestBlockLimit},getBlockParallelTaskCount:function(){return o.getBlockParallelTaskCount},getSheetClientvarsTimeout:function(){return o.getSheetClientvarsTimeout},getMinaBooleanConfigHelper:function(){return o.getMinaBooleanConfig},getMinaNumberConfigHelper:function(){return o.getMinaNumberConfig},getSubBlocksTimeout:function(){return o.getSubBlocksTimeout},getSyncProtobufTimeout:function(){return o.getSyncProtobufTimeout},getDLPUploadEnable:function(){return o.getDLPUploadEnable},getBooleanConfigAlwaysTrueInDev:function(){return o.getBooleanConfigAlwaysTrueInDev},getBooleanConfigDefaultTrueInDev:function(){return o.getBooleanConfigDefaultTrueInDev},getMinaNumberConfig:function(){return s},getMinaBooleanConfig:function(){return u},getReadingModeAiEnable:function(){return l},getCreateUseNewSnapshot:function(){return c},getChangesetPayloadLimit:function(){return h},getSheetTranslateTextCount:function(){return d},getSheetSendUserChangeDebounce:function(){return f},getSheetRangeActionCount:function(){return p},getMissVersionThreshold:function(){return v},getChartSeriesMaxCount:function(){return g},getSheetGroupToolBtnEnable:function(){return _},getSheetSyncBufferEnable:function(){return y},getSheetCellsUpperLimit:function(){return m},getSheetCellLimitNum:function(){return E},getSheetCellCharLimitNum:function(){return b},getBitableActionsSizeLimit:function(){return T},getSearchThresholdValue:function(){return C},getSheetCopyDataVersion:function(){return S},getSheetDropdownOptionNumLimit:function(){return w},getSheetDropdownOptionTotalCharLimit:function(){return R},getIsDataValidationV2OldUser:function(){return A},getShouldShowDataValidationV2Guide:function(){return O},getResolveParamEnabled:function(){return M},getSheetCfCopyEnabled:function(){return k},getCommentFollowEnabled:function(){return I},getImageRectByEqualEnable:function(){return x},getIsSupportSheetExportImageLogo:function(){return N},getExpandMentionPanelEnabled:function(){return P},getMentionPanelEnabled:function(){return L},getSheetWorkerEnable:function(){return D},getCommentLingoEnabled:function(){return F},getSheetFontDataCleanEnable:function(){return B},getFollowRetryIntervalTime:function(){return V},getSheetContextMenuPerfIterMaxCellNum:function(){return H},getSheetFilterDateAggregationEnabled:function(){return U},getWatchdogEventThreshold:function(){return Z},getWhiteBoardLinkShared:function(){return W},getIsSheetCustomIconEnabled:function(){return j},getSheetAiInferFormulaEnabled:function(){return G},getSheetAiDeepSeekWriteFormulaEnabled:function(){return z},getSheetAiAskFormulaEnable:function(){return Y},getSheetAiClassifyFormulaNewEnable:function(){return X},getSheetAiInlineDataInsightEnabled:function(){return K},getSheetAiInlineChartEnabled:function(){return q},getSheetAiInlinePivotTableEnabled:function(){return $},getSheetAiChatModeOnboardingEnabled:function(){return J},getAiWriteFormulaEnabled:function(){return Q},getAiCreationEnabled:function(){return ee},getDataConnectorEnable:function(){return te},getImportFormulaEnable:function(){return ne},getSheetAiInlineOnboardingEnabled:function(){return re},getSheetAiEnabled:function(){return ie},getMainSwitchEnabled:function(){return oe},getDocxTranslationLLMEnabled:function(){return ae},getAIClassifyDatabaseEnabled:function(){return se},getAddNoteEnabled:function(){return ue},getAddDiagonalEnabled:function(){return le},getMentionOptimizeEnabled:function(){return ce},getSheetDataConnectorMaxNumPerTenant:function(){return he},getSheetDataConnectorUnlimitedEnabled:function(){return de},getDataConnectorOceanEngineAdsEnabled:function(){return fe},getDataConnectorOceanEngineShoppingAdsEnabled:function(){return pe},getAiInlineTipsNewEnabled:function(){return ve},getAiProgressBarEnabled:function(){return ge},getImportRangeV3Enable:function(){return _e},getImportRangeV2Enable:function(){return ye},isCcmStorageEditLimitPopup:function(){return me},getSheetInvisibleProtectionEnabled:function(){return Ee},getSheetInvisibleProtectionPortEnabled:function(){return be},getSheetInvisibleProtectionEntranceEnabled:function(){return Te},getHistoryOnDemandLoadEnable:function(){return Ce},getSheetHistoryAlonePageSettings:function(){return Se},getSheetCopySelectionLinkInFilterView:function(){return we},getSheetDirtyRangeCacheOptimize:function(){return Re},getIndexDBOverTimeLimit:function(){return Ae},getSheetTranslateSliceRequestConfig:function(){return Oe},getSheetColDataAnalysisConfig:function(){return Me}});var r=n("vsh_21469"),i=n("vsh_69691"),o=n("vsh_22488"),a=n("vsh_72834");function s(e,t){return(0,o.getMinaNumberConfig)(e,t)}function u(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,o.getMinaBooleanConfig)(e,t)}function l(){return u("ccm.sheet.ai.inline.reading-enable")}function c(){return(0,o.getBooleanConfigCoverByUrl)("ccm.sheet.create_use_new_snapshot")}function h(){return Number(s("sheet_cs_payload_limit",5e3))}function d(){return s("sheet_translate_text_count",64)}function f(){return s("sheet_send_user_change_debounce",500)}function p(){return s("sheet_range_action_count",5e3)}function v(){return s("sheet_missversion_threshold",200)}function g(){return s("sheet_chart_series_max_count",50)}function _(){return!1}function y(){return(0,o.getBooleanConfigAlwaysTrueInDev)("sheet_sync_buffer_enable")}var m=function(){return u("creation.sheet.cells.upper_limit",!1)};function E(){return m()?5e6:s("sheet_cell_limit",2e6)}function b(){return s("sheet_cell_char_limit",5e4)}function T(){return s("bitable_cs_size",4194304)}function C(){return s("sheet_search_threshold_value",5e4)}function S(){return s("sheet_copy_data_version",0)}function w(){return s("sheet_dropdown_option_num_limit",a.xQG)}function R(){return s("sheet_dropdown_option_total_char_limit",5e4)}var A=function(){return(0,o.isOldUser)(new Date(2021,10,20))},O=function(){return A()},M=function(){return u("sheet_comment_resolve_param_enable",!1)},k=function(){return u("ccm.sheet.conditional_format_copy",!1)},I=function(){return u("ccm.ms.comment_follow_enabled")},x=(0,r.Z)((function(){var e=/sheet_render_image_equal=(true|false)(?:$|&)/.exec(location.search);return e?"true"===e[1]:u("ccm.sheet.img_render_by_equal",!0)})),N=function(){return u("ccm.sheet.sheet_export_image_lark_logo_enabled",!1)},P=function(){return u("ccm.docx.expand_mention_panel",!1)},L=function(){return u("ccm.gpe.optimize.mention_refactor_show_panel",!1)},D=function(){return-1===(0,o.getMinaConfig)("sheet_worker_block_list",[]).indexOf((0,i.encryptTea)((0,o.getToken)()))},F=function(){return u("ccm.sheet.comment.lingo_enable",!1)},B=function(){return u("ccm.sheet.web.style_font_data_clean",!1)},V=function(){return s("ccm_sheet_follow_retry_interval_time",15)},H=function(){return s("ccm.sheet.context_menu_perf_iter_max_cell_num",100)},U=function(){return(0,o.getBooleanConfigCoverByUrl)("ccm.sheet.filter_date_aggregation")},Z=function(){return(0,o.getMinaConfig)("ccm_sheet_watchdog_threshold",null)},W=function(){return u("ccm.sheet.whiteboard_link_parse",!1)};function j(){return(0,o.getIsCustomIconPartEnabled)()}var G=function(){return u("ccm.sheet.ai.formula.infer",!1)},z=function(){return u("ccm.sheet.ai.formula.deepseek_write",!1)},Y=function(){return u("ccm.sheet.ai.formula.ai_ask",!1)},X=function(){return u("ccm.sheet.ai.inline.classify_new",!1)},K=function(){return u("ccm.sheet.ai.inline.data-insight",!1)},q=function(){return u("ccm.sheet.ai.inline.ai-chart",!1)},$=function(){return u("ccm.sheet.ai.inline.ai-pivot_table",!1)},J=function(){return u("ccm.sheet.ai.chatmode_onboarding",!1)},Q=function(){return u("ccm.sheet.ai.formula_assistant",!1)},ee=function(){return u("ccm.sheet.ai.inline.entrance",!1)},te=function(){return u("ccm.sheet.web.data_connector_enable",!1)},ne=function(){return u("ccm.sheet.formula.importformula",!1)},re=function(){return u("ccm.sheet.ai.onboarding",!1)},ie=function(){return u("ccm.sheets.ai.enable",!1)},oe=function(){return u("lark.my_ai.main_switch",!1)},ae=function(){return u("ccm.docx.all.translation_llm")},se=function(){return u("ccm.sheet.ai_classify.database")},ue=function(){return u("ccm.sheet.add_note_enabled",!1)},le=function(){return u("ccm.sheet.add_diagonal_enabled",!1)},ce=function(){return u("ccm.mention.optimizing_authorizaiton_v2",!1)},he=function(){return s("ccm_sheet_connector_max_count",50)},de=function(){return u("ccm.sheet.data_connector_unlimited_list",!1)},fe=function(){return u("ccm.sheet.data_connector_oceanengine_ads_enabled",!1)},pe=function(){return u("ccm.sheet.data_connector_oceanengine_shoppingads_enabled",!1)},ve=function(){return u("ccm.sheet.ai.inline.tip.new",!1)},ge=function(){return u("ccm.sheet.ai.progress_bar_enable",!1)},_e=function(){return u("ccm.sheet.formula.importrange_v3",!1)},ye=function(){return u("ccm.sheet.formula.importrange_v2_enable",!0)},me=function(){return u("ccm.storage.edit_limit_popup",!1)},Ee=function(){return u("ccm.sheet.invisible_protection",!1)},be=function(){return u("ccm.sheet.invisible_protection_port",!1)},Te=function(){return u("ccm.sheet.invisible_protection_entrance",!1)},Ce=function(){return(0,o.getBooleanConfigCoverByUrl)("ccm.sheet.history_on_demand_load_enable")},Se=function(){return(0,o.getMinaConfig)("ccm_sheet_history_alone_page_settings",{maxFormulaCount:1/0,maxCellCount:1/0,blankSheetMemory:1/0,factor:.75})},we=function(){return(0,o.getBooleanConfigCoverByUrl)("ccm.sheet.copy_selection_link_in_filter_view")},Re=function(){return(0,o.getBooleanConfigCoverByUrl)("ccm.sheet.dirty_range_cache_optimize")},Ae=function(){return s("sheet_index_db_overtime",0)},Oe=function(){return(0,o.getMinaConfig)("sheet_translate_slice_request_config",{max_concurrency:5,text_size_per_slice:{default:500},scheduler:{max_qps:10,qps_time:1e3}})};function Me(){return(0,o.getMinaConfig)("ccm_sheet_col_data_analysis_config",{maxSheetCount:1,percent:5,maxColCount:10})}},vsh_89454:function(e,t,n){"use strict";n.d(t,{o_:function(){return o},st:function(){return a},zm:function(){return s},$p:function(){return u}});var r=n("vsh_8892"),i=n("vsh_24627");function o(e,t){var n,i;null===(n=e.getPlugin)||void 0===n||null===(i=n.call(e,r.$L))||void 0===i||i.setFocus(t)}function a(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(o){var a=e.spread,s=a.getActiveSheet();s.dispatch(i.U_F.ClearActiveComment)}null===(t=e.getPlugin(r.$L))||void 0===t||t.resetFocus(n)}function s(e){var t;null===(t=e.getPlugin(r.$L))||void 0===t||t.resume()}function u(e){var t;null===(t=e.getPlugin(r.$L))||void 0===t||t.suspend()}},vsh_45003:function(e,t,n){"use strict";n.d(t,{ml:function(){return S},L3:function(){return N}});var r=n("vsh_67017"),i=n.n(r),o=n("vsh_1139"),a=n("vsh_35067"),s=n("vsh_29033"),u=n("vsh_69691"),l=n("vsh_18043"),c=n("vsh_18801"),h=n("vsh_12484"),d=n("vsh_22488"),f=n("vsh_96579"),p=n("vsh_24627"),v=n("vsh_72834"),g=n("vsh_65420"),_=(n("vsh_66242"),n("vsh_46162")),y=n("vsh_73043");function m(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return E(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return E(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var b=p.TcH.CHANGED_FLAG,T=p.TcH.CELL_VALUE,C=function(e,t){var n=(0,l.parseSuiteInfoFromText)(e,t);return n&&!(0,_.getWhiteBoardLinkShared)()&&(delete n.blockToken,delete n.blockTypeNum),n};function S(e,t,n){return w.apply(this,arguments)}function w(){return(w=(0,a.Z)(i().mark((function e(t,n,r){var a,s,u,h,d,f,g,_,y,E,C,S,w,O,M,I,x,P,L,D,F,B,V,H,U,Z;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=new Map,s=new Map,e.prev=2,u=[],h=0;h<n.length;h++)if(R(d=n[h])&&Array.isArray(d.value.value))f=d.value.value.filter(A),(g=N(f)).length>0&&(a.set(d,new v.zof(d.target.row,d.target.col,t)),Array.prototype.push.apply(u,g));else if(d.action===p.aOo.SET_RANGE_VALUES)for(_=new Map,y=d.target,E=y.row,C=y.col,S=y.row_count,w=y.col_count,O=E+S-1,M=C+w-1,I=0,x=E;x<=O;x++)for(P=C;P<=M;P++,I++)L=d.value.value[I],D=null==L?void 0:L[T],Array.isArray(D)&&(0,v.Cyn)(T,L[b])&&(F=D.filter(A),(B=N(F)).length>0&&(s.has(d)||s.set(d,_),_.set(I,new v.zof(x,P,t)),Array.prototype.push.apply(u,B)));return e.next=7,(0,l.getMetas)(u,c.ioRequestClient);case 7:for(V=e.sent,H=[],U=function(e){var i=n[e];if(R(i)&&Array.isArray(i.value.value)){var u=a.get(i),l=k(t,i.value.value,V,r);l&&u&&H.push({row:u.row,col:u.col,newSegmentArray:l})}else if(i.action===p.aOo.SET_RANGE_VALUES){var c=s.get(i);if(c){var h,d=m(c);try{for(d.s();!(h=d.n()).done;){var f=(0,o.Z)(h.value,2),g=f[0],_=f[1],y=i.value.value[g];if(Array.isArray(null==y?void 0:y[T])){var E=k(t,y[T],V,r);E&&_&&(E.forEach((function(e){var t=e.styleId;if("number"==typeof t){var n,r=(0,v.V8g)(null===(n=i.value.style)||void 0===n?void 0:n[t]);r&&(e.style=v.OBY.deserialize([r])[0]),delete e.styleId}})),H.push({row:_.row,col:_.col,newSegmentArray:E}))}}}catch(e){d.e(e)}finally{d.f()}}}},Z=0;Z<n.length;Z++)U(Z);H.length&&t._commandManager().execute({cmd:p.rvF.CONVERT_LINK,sheetId:t.id(),data:H}),a.forEach((function(e){return e.destroy()})),a.clear(),s.forEach((function(e){return e.forEach((function(e){return e.destroy()}))})),s.clear(),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(2),console.log(e.t0);case 21:case"end":return e.stop()}}),e,null,[[2,18]])})))).apply(this,arguments)}function R(e){return e.action===p.aOo.SET_CELL}function A(e){return e.type===p.K6s.URL}function O(e){return e.link&&e.text!==e.link&&e.text!=="http://".concat(e.link)}function M(e){return!e.link&&e.cellPosition&&!(0,p.CBv)(e.text)}function k(e,t,n,r){var i,o,a,s,u=[],c=!1;if(function(e){if(e.length<=0)return!1;var t=e[0];return t.type===p.K6s.TEXT&&(0,v.GG9)(t.text)}(t))return null;for(var h=0;h<t.length;h++){var y,m,E=Object.assign({},t[h]);if(!A(E)||O(E)||M(E))u.push(E);else{var b=E.text,T=(i=b,o=!0,a=void 0,s=void 0,(s=(0,l.parseOriginUrl)(i,o,a))&&!(0,_.getWhiteBoardLinkShared)()&&(delete s.blockToken,delete s.blockType),s);if(T){var C=T.token,S=T.search,w=n[T.blockToken||C],R=null===(y=e.parent)||void 0===y||null===(m=y._context)||void 0===m?void 0:m.isEmbed(),k=(0,d.getCommentCopyLinkEnableV2)()&&/comment_id=\d+/.test(S)&&/comment_anchor=true/.test(S);if(R||!I(window.location.href,b)||k)if(w){var N=x(b,w);N?(E.style&&(N.style=E.style),u.push(N),u.push({type:p.K6s.TEXT,text:" "}),c=!0):(u.push(E),(0,f.collectSuiteEvent)("sheet_insert_hyperlink",{action:"submit_hyperlink",source:"editCell"===r?"hyperlink_bar":"paste",type:"normal_hyperlink"}))}else u.push(E),(0,f.collectSuiteEvent)("sheet_insert_hyperlink",{action:"submit_hyperlink",source:"editCell"===r?"hyperlink_bar":"paste",type:"normal_hyperlink"});else{var P=(0,p.XwI)(b),L=e&&e.parent,D=(0,g.a4)(L,P);if(P&&D)E.cellPosition=P,E.text=D;else{E.cellPosition=null;var F=L.getActiveSheet(),B=F&&F.id(),V=F&&F.name();B&&V&&(E.text=V,E.cellPosition={sheetId:B})}E.link="",u.push(E),c=!0;var H=(0,g.AK)(e.parent,E.cellPosition),U=(0,g.hM)(H,E.cellPosition);(0,f.collectSuiteEvent)("sheet_insert_hyperlink",{action:"submit_hyperlink",source:"editCell"===r?"hyperlink_bar":"paste",type:U})}}else u.push(E)}}return c?u:null}function I(e,t){return!!(0,u.isSameFileToken)(e,t)&&(0,u.getAllUrlParams)(e)[c.QUERY_FIELDS.VERSION_PAGE]===(0,u.getAllUrlParams)(t)[c.QUERY_FIELDS.VERSION_PAGE]}function x(e,t){if(!(0,l.isDocUrl)(e))return null;var n=C(e,!0)||{},r=n.token,i=n.type,o=n.mentionTypeNum,a=n.suiteTypeNum,c=n.blockTypeNum,h=n.blockToken;if(!r||!i||(0,s.default)(o)||(0,s.default)(a))return null;var d=t.icon_info,f=t.title,v=(f||"").replace(/(?!\\)\n/g," "),g={type:p.K6s.MENTION,mentionType:P({mentionType:o,realType:t.type,blockType:c}),mentionNotify:!1,text:v||(0,u.getUnnamedTitle)(a)||y("common.unnamed_document"),token:h||r,link:e};return(0,_.getIsSheetCustomIconEnabled)()&&(g.iconInfo=d),g}function N(e){for(var t=[],n=new Set,r=0;r<e.length;r++){var i=e[r],o=i.text,a=C(o,!0)||{},u=a.token,c=a.suiteTypeNum,h=a.blockToken,d=a.blockTypeNum;!(0,l.isDocUrl)(o)||O(i)||!u||(0,s.default)(c)||n.has(u)||(t.push({token:u,typeNum:c,blockToken:h,blockTypeNum:d}),n.add(h||u))}return t}function P(e){var t=e.mentionType,n=e.realType,r=e.blockType;return r||(t===h.NUM_FILE_TYPE.WIKI?n||p.UkI.DOC:t||p.UkI.DOC)}},vsh_91781:function(e,t,n){"use strict";n.d(t,{cr:function(){return m},nU:function(){return b},II:function(){return T},Wz:function(){return S},GN:function(){return R}});var r=n("vsh_67017"),i=n.n(r),o=n("vsh_35067"),a=n("vsh_98652"),s=n("vsh_1139"),u=n("vsh_12484"),l=n("vsh_18801"),c=n("vsh_22488"),h=n("vsh_96579"),d=n("vsh_39371"),f=n("vsh_24627"),p=n("vsh_72834"),v=n("vsh_79088"),g=n("vsh_82905"),_=n("vsh_46162"),y=(0,l.isUseExcel)()?u.MountPointType.SHEET_TMPIMAGE:u.MountPointType.SHEET_IMAGE;function m(e){for(var t=(0,_.getSheetContextMenuPerfIterMaxCellNum)(),n=e.getSelections(),r=0,i=!1,o=0;o<n.length;o++){var a=n[o],s=a.rowFrom(),u=a.colFrom(),l=a.rowCount(),c=a.colCount();if(e.iterCell(s,u,l,c).exitWhen((function(){return i})).first_if((function(e){return r++,i=r>t,(0,p.uUo)(e.segmentArray)||(0,p.onc)(e.variant)})))return!0}return!1}function E(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"select",n=e.getRowCount(),r=e.getColumnCount(),i="all"===t?[new p.e6w(0,0,n,r,e)]:e.getSelections(),o=[],a=new Set,u=!1,l=0;l<i.length;l++){var c=i[l],h=c.rowFrom(),d=c.colFrom(),f=c.rowCount(),v=c.colCount();e.iterContentWithPos(h,d,f,v).forEach((function(t){var n=(0,s.Z)(t,2)[1],r=n.row,i=n.col,l="".concat(r,"_").concat(i),c=new p.e6w(r,i,1,1,e),h=(0,p.Pq3)(e,r,i);h&&(e.protectionModel.getRangePermissions([c]).hasPermission||(u=!0),h&&!a.has(l)&&(a.add(l),o.push(Object.assign({},n,{seg:h,isFormulaImage:(0,p.rwT)(e,r,i)}))))}))}return{result:o,someImageCellProtected:u}}function b(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"select",n=(0,_.getSheetContextMenuPerfIterMaxCellNum)(),r=e.getRowCount(),i=e.getColumnCount(),o="all"===t?[new p.e6w(0,0,r,i,e)]:e.getSelections(),a=[],u=new Set,l=!1,c=!1,h=0,d=new p.e6w(0,0,1,1,e),f=0;f<o.length;f++){var v=o[f],g=v.rowFrom(),y=v.colFrom(),m=v.rowCount(),E=v.colCount();if(e.iterContentWithPos(g,y,m,E).exitWhen((function(){return c})).forEach((function(t){h++,c=h>n;var r=(0,s.Z)(t,2)[1],i=r.row,o=r.col,f="".concat(i,"_").concat(o);d.setRowFrom(i),d.setColFrom(o);var v=(0,p.Pq3)(e,i,o);if(v)return e.protectionModel.getRangePermissions([d]).hasPermission||(l=!0),v&&!u.has(f)?(u.add(f),void a.push(Object.assign({},r,{seg:v,isFormulaImage:(0,p.rwT)(e,i,o)}))):void 0})),c)break}return{result:a,someImageCellProtected:l}}function T(e,t,n,r){var i=e.getActiveSheet(),o=E(i,t),a=o.result,s=o.someImageCellProtected;a.length&&(s?(0,d.w5)():(e.commandManager().execute({cmd:f.rvF.CONVERT_IMAGE,sheetId:i.id(),commandType:p.GzH.EmbedToFloat,data:a}),null==r||r(a),(0,h.collectSuiteEvent)("sheet_opration",{action:"img_transfer_to_over_cell",item_located_type:"in_cell",object_count:a.length,op_item:"select"===t?"select_item":"all_item",source:n})))}var C=function(){(0,v.getCollectorSecurityAuditSheet)().then((function(e){var t=e.collectSecurityAuditSheet,n=e.ISecurityAudit,r=e.getCCMOpStatus,i=e.getDefaultCommonDrawerItemList,o=r(!0),s=i();t(n.OperationType.OperationDownload,[].concat((0,a.Z)(o),(0,a.Z)(s),[{Key:"ccm_download_type",Value:"image"}]))}))};function S(e){return w.apply(this,arguments)}function w(){return(w=(0,o.Z)(i().mark((function e(t){var n,r,o,a,s,u,l,h;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.getActiveSheet(),r=E(n),o=r.result,a=o.filter((function(e){return!!e.seg.fileToken})).map((function(e){return e.seg.fileToken})),s=o.filter((function(e){return!e.seg.fileToken})).map((function(e){return e.seg.link})),u={type:(0,c.suiteTypeNum)(),token:(0,c.getToken)()},e.next=7,Promise.all(a.map((function(e){return t.getService(g.Qh).check(g.Vw.ATTACHMENTDOWNLOAD,e,u)})));case 7:l=e.sent,h=a.filter((function(e,t){return l[t]})),R(t,h),s.forEach((function(e){var t=document.createElement("a");t.href=e,t.setAttribute("download","true"),t.click(),console.error("正在下载旧存储图片，该下载不经过 DLP 检查！！！使用 drive 的图片才经过 DLP 检查！！！")})),C();case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e,t){return A.apply(this,arguments)}function A(){return(A=(0,o.Z)(i().mark((function e(t,n){var r,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==n.length){e.next=2;break}return e.abrupt("return");case 2:r=t._context.getToken(),o=n.map((function(e){return{token:e,type:u.NUM_SUITE_TYPE.FILE,mountPoint:{token:r,type:y}}})),(0,c.downloadFiles)(o);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},vsh_87464:function(e,t,n){"use strict";n.d(t,{Lw:function(){return Z},nU:function(){return j.nU},II:function(){return j.II},VF:function(){return S},NU:function(){return T},nN:function(){return M},Wz:function(){return j.Wz},Jd:function(){return s},N:function(){return u},pl:function(){return l},cr:function(){return j.cr}});var r=n("vsh_18801"),i=n("vsh_12484"),o=n("vsh_22488"),a=(0,r.isUseExcel)()?i.MountPointType.SHEET_TMPIMAGE:i.MountPointType.SHEET_IMAGE;function s(e,t){var n={mountPoint:{type:a,token:t},coverOptions:{width:1280,height:1280,policy:r.CoverPolicy.EQUAL}};return(0,o.getDriveImageUrl)(e,n)}function u(e,t){var n={mountPoint:{type:a,token:t}};return(0,o.getDriveImageUrl)(e,n)}function l(e,t,n){return e?u(e,t):n}var c=n("vsh_1139"),h=n("vsh_67017"),d=n.n(h),f=n("vsh_35067"),p=n("vsh_69691"),v=n("vsh_60591"),g=n("vsh_98125"),_=n.n(g),y=n("vsh_24627"),m=n("vsh_73043");function E(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function T(e,t,n){return C.apply(this,arguments)}function C(){return(C=(0,f.Z)(d().mark((function e(t,n,r){var a,s,u,l,c,h;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.copyTo)(n,r,i.MountPointType.SHEET_IMAGE).promise;case 2:if(a=e.sent,Object.keys(a).length){e.next=5;break}return e.abrupt("return",null);case 5:s=Object.keys(t),u=0;case 7:if(!(u<s.length)){e.next=20;break}if(l=s[u],c=t[l],!(h=c.fileToken)||!a[h]){e.next=16;break}R(c,a[h],r),t[l]=c,e.next=17;break;case 16:return e.abrupt("return",null);case 17:u++,e.next=7;break;case 20:return e.abrupt("return",t);case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e,t,n,r,i,o,a){return w.apply(this,arguments)}function w(){return w=(0,f.Z)(d().mark((function e(t,n,r,a,s,u,l){var h,f,g,E,b,T,C,S,w,R,M,k,I,x,N,P,L,D,F,B,V,H=arguments;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h=H.length>7&&void 0!==H[7]&&H[7],f=(0,o.copyTo)(r,u,h?i.MountPointType.SHEET_TMPIMAGE:i.MountPointType.SHEET_IMAGE,{drive_route_token:u}),g=f.promise,E=f.cancel,b=(0,o.copyTo)(a,u,h?i.MountPointType.SHEET_TMPFILE:i.MountPointType.SHEET_FILE,{drive_route_token:u}),T=b.promise,C=b.cancel,S=!1,w=null,R=function(){return E()&&C()},l&&(w=setTimeout((function(){S=!0,v.Toast.remove(y.iPD.PASTING),v.Toast.show({key:y.iPD.PASTE_CANCELABLE,type:"loading",duration:0,content:_().createElement("div",null,_().createElement("span",null,m("sheet.paste_for_a_while")),_().createElement("span",{style:{cursor:"pointer",color:(0,p.getThemeColorByToken)("text-link-hover")},onClick:R},m("sheet.cancel_paste")))})}),5e3)),e.prev=7,t.cancelPaste=R,e.next=11,Promise.all([g,T]);case 11:k=e.sent,I=(0,c.Z)(k,2),x=I[0],N=I[1],M=Object.assign({},x,N),e.next=21;break;case 18:throw e.prev=18,e.t0=e.catch(7),e.t0;case 21:return e.prev=21,t.cancelPaste=null,e.finish(21);case 24:l&&(w&&clearTimeout(w),S&&(v.Toast.remove(y.iPD.PASTE_CANCELABLE),Object.keys(M).length&&v.Toast.show({key:y.iPD.PASTING,type:"loading",duration:0,content:m("sheet.pasting")}))),e.t1=d().keys(s);case 26:if((e.t2=e.t1()).done){e.next=51;break}P=e.t2.value,L=s[P],e.t3=d().keys(L);case 30:if((e.t4=e.t3()).done){e.next=49;break}if(D=e.t4.value,L[D]){e.next=35;break}return e.abrupt("continue",30);case 35:if(F=n[P][D].value,B=n[P][D].proxyValue,V=n[P][D].floatImages,A(F,M,u)){e.next=41;break}return e.abrupt("return",null);case 41:if(A(B,M,u)){e.next=44;break}return e.abrupt("return",null);case 44:if(O(V,M)){e.next=47;break}return e.abrupt("return",null);case 47:e.next=30;break;case 49:e.next=26;break;case 51:return e.abrupt("return",n);case 52:case"end":return e.stop()}}),e,null,[[7,18,21,24]])}))),w.apply(this,arguments)}function R(e,t,n){e.type===y.K6s.EMBED_IMAGE&&(e.link=s(t,n),e.fileToken=t)}function A(e,t,n){if(!Array.isArray(e))return!0;var r,i=E(e);try{for(i.s();!(r=i.n()).done;){var o,a=r.value;if(a.type===y.K6s.EMBED_IMAGE||a.type===y.K6s.ATTACHMENT){var s=t[null!==(o=a.fileToken)&&void 0!==o?o:""];if(!s)return!1;a.type===y.K6s.EMBED_IMAGE&&R(a,s,n),a.type===y.K6s.ATTACHMENT&&(a.fileToken=s)}}}catch(e){i.e(e)}finally{i.f()}return!0}function O(e,t){if(!Array.isArray(e))return!0;var n,r=E(e);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=t[i.floatImageSetting.imageToken];if(!o)return!1;i.floatImageSetting.imageToken=o}}catch(e){r.e(e)}finally{r.f()}return!0}function M(e,t,n,r){return k.apply(this,arguments)}function k(){return(k=(0,f.Z)(d().mark((function e(t,n,r,i){var a,s,u,l;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,o.copyTo)(n,r,i,{drive_route_token:r}),s=a.promise,u=a.cancel,l={},e.prev=2,t.cancelPaste=u,e.next=6,s;case 6:l=e.sent,e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(2),e.t0;case 12:return e.prev=12,t.cancelPaste=null,e.finish(12);case 15:return e.abrupt("return",l);case 16:case"end":return e.stop()}}),e,null,[[2,9,12,15]])})))).apply(this,arguments)}var I,x=n("vsh_19264"),N=n("vsh_4175"),P=n("vsh_94760"),L=n("vsh_82905"),D=n("vsh_96579"),F=n("vsh_21955"),B=function(){function e(t){(0,x.Z)(this,e),this.imageWorkerHelper=t,this.queue=new F.lC,this.tasks=new Map,this.resolvers=new Map,this.ongoingTasks=0,this.scheduledTickTask=null}return(0,N.Z)(e,[{key:"destroy",value:function(){this.resolvers.forEach((function(e){return e.forEach((function(e){var t=(0,c.Z)(e,2);t[0];return(0,t[1])("[image-fetcher-queue]: aborted!")}))})),this.resolvers.clear(),this.tasks.clear(),this.queue.reset()}},{key:"requestImage",value:function(e){var t=this,n=e.originSrc;if(this.tasks.has(n))return this.doPrioritize(n),new Promise((function(e,r){t.resolvers.get(n).push([e,r])}));var r=new Promise((function(e,r){t.resolvers.set(n,[[e,r]])}));return this.tasks.set(n,e),this.queue.unshift(n),this.run(),r}},{key:"prioritize",value:function(e){this.queue.peek()!==e&&this.queue.has(e)&&this.doPrioritize(e)}},{key:"doPrioritize",value:function(e){this.queue.remove(e),this.queue.unshift(e)}},{key:"run",value:function(){var e=this;this.scheduledTickTask||(this.scheduledTickTask=Promise.resolve().then((function(){0===e.ongoingTasks&&e.tickTask(),e.scheduledTickTask=null})))}},{key:"getTasksForNextTick",value:function(){for(var e=Math.min(16-this.ongoingTasks,this.queue.size),t=new Array(e);e>0&&this.queue.size>0;)t[--e]=this.queue.shift();return t}},{key:"tickTask",value:function(){var e=this,t=this.getTasksForNextTick();this.ongoingTasks+=t.length,t.forEach((function(t){var n=e.tasks.get(t);e.imageWorkerHelper.fetch(n).then((function(n){e.resolvers.get(t).forEach((function(e){var t=(0,c.Z)(e,2),r=t[0];t[1];return r(n)}))})).catch((function(n){e.resolvers.get(t).forEach((function(e){var t=(0,c.Z)(e,2);t[0];return(0,t[1])(n)}))})).finally((function(){e.tasks.delete(t),e.resolvers.delete(t),e.ongoingTasks-=1,e.ongoingTasks<10&&e.tickTask()}))}))}}]),e}(),V=n("vsh_73043"),H=!1,U=!1;!function(e){e[e.COPYING=204]="COPYING",e[e.COPY_FAIL=299]="COPY_FAIL"}(I||(I={}));var Z=function(){function e(t){var n=this;(0,x.Z)(this,e),this.spread=t,this.imageWorkerHelper=new o.ImageWorkerHelper,this.oldImageSrcDescriptor=Object.getOwnPropertyDescriptor(Image.prototype,"src"),this.isImageWorkerEffective=!1,this.instanceId=e.INSTANCE_ID++,this.getFetchOptions=function(e){var t=(0,o.getDriveImageToken)(e),n=(0,p.parseQuery)(e),r=n.width,i=n.height,a=n.policy;return{fileToken:t,originSrc:e.replace("bdDriveImg://","https://"),coverOptions:{width:Number(r),height:Number(i),policy:a},reqCdnUrl:(0,o.prependAPI)("/api/box/file/cdn_url/")}},this.processDLPCheck=function(e,t){var r=e.fileToken,i=function(e){var t,a;if(n.oldImageSrcDescriptor.set&&r){var s=e.result,u=L.j6.NORMAL;s===o.DLP_ATTACHMENT_RESULT.DELETED||s===o.DLP_ATTACHMENT_RESULT.SENSITIVE?u=L.j6.DELETED:e.result===o.DLP_ATTACHMENT_RESULT.CHECKING&&(u=L.j6.CHECKING),null===(t=(a=n.spread.getService(L.Qh)).setAttachmentPreviewResultCode)||void 0===t||t.call(a,r,u),o.attachmentPermissionManager.deleteFetchCallback(r,i)}};i=i.bind(n),o.attachmentPermissionManager.setFetchCallback(r,i)},this.imageFetcherQueue=new B(this.imageWorkerHelper),this.proxyImageSetter()}var t;return(0,N.Z)(e,[{key:"prioritize",value:function(e){var t;null===(t=this.imageFetcherQueue)||void 0===t||t.prioritize(e)}},{key:"proxyImageSetter",value:function(){if(this.oldImageSrcDescriptor){var e=this.proxySetterHandler.bind(this),t=this.oldImageSrcDescriptor;Object.defineProperty(Image.prototype,"src",Object.assign({},this.oldImageSrcDescriptor,{set:function(t){this._originSrc=t,e(t,this)},get:function(){var e,n,r;return null!==(e=null!==(n=this._originSrc)&&void 0!==n?n:null===(r=t.get)||void 0===r?void 0:r.call(this))&&void 0!==e?e:""}})),this.isImageWorkerEffective=!0}}},{key:"proxySetterHandler",value:(t=(0,f.Z)(d().mark((function t(n,r){var o,a,s,u,l,c,h,f,p,g,_,y,m,E=arguments;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=E.length>2&&void 0!==E[2]?E[2]:1,a=/^bdDriveImg:\/\//,s=this.getFetchOptions(n),this.oldImageSrcDescriptor.set){t.next=5;break}return t.abrupt("return");case 5:if(a.test(n)){t.next=7;break}return t.abrupt("return",this.oldImageSrcDescriptor.set.call(r,n));case 7:return t.prev=7,t.next=10,this.imageFetcherQueue?this.imageFetcherQueue.requestImage(s):this.imageWorkerHelper.fetch(s);case 10:u=t.sent,l=u.displayStatus,c=u.blobUrl,this.oldImageSrcDescriptor.set.call(r,c||s.originSrc),this.collectRequestFail(l),W(u.originSrc,u.displayStatus.request_origin_time_cost),t.next=31;break;case 17:if(t.prev=17,t.t0=t.catch(7),console.error(t.t0),h=t.t0.errorCode,f=t.t0.xForbiddenCode,p=s.fileToken,!(h===I.COPYING&&o<=e.MAX_RETRY_TIMES)){t.next=27;break}return t.next=25,new Promise((function(t){return setTimeout(t,e.RETRY_DELAY)}));case 25:return this.proxySetterHandler(n,r,++o),t.abrupt("return");case 27:h===I.COPY_FAIL&&v.Toast.error({content:V("common.upload_image_failed"),closable:!0}),[i.INTERNAL_DLP_CHECKING,i.EXTERNAL_DLP_CHECKING].includes(Number(f))&&(p&&(null===(g=(_=this.spread.getService(L.Qh)).setAttachmentPreviewResultCode)||void 0===g||g.call(_,p,L.j6.CHECKING)),this.processDLPCheck(s,r)),h===i.DELETED&&p&&(null===(y=(m=this.spread.getService(L.Qh)).setAttachmentPreviewResultCode)||void 0===y||y.call(m,p,L.j6.DELETED)),this.oldImageSrcDescriptor.set.call(r,s.originSrc);case 31:case"end":return t.stop()}}),t,this,[[7,17]])}))),function(e,n){return t.apply(this,arguments)})},{key:"collectRequestFail",value:function(e){var t=(0,P.Z)(["request_origin_fail","decrypt_fail","request_cdn_fail","request_key_fail"],(function(t){return e[t]}));t&&y.OCe.collectImageError({ex:t})}},{key:"destroy",value:function(){var t;this.imageWorkerHelper.destroy(),this.isImageWorkerEffective=!1,this.instanceId===e.INSTANCE_ID-1&&Object.defineProperty(Image.prototype,"src",this.oldImageSrcDescriptor),null===(t=this.imageFetcherQueue)||void 0===t||t.destroy()}}]),e}();function W(e,t){if(e.includes("mount_point=sheet_image")){var n,r,i=e.includes("/v2/cover/"),o=e.includes("/download/all/");if(!H&&i)(0,D.collectSuiteEvent)("client_sheet_perf_optimize_tracker_dev",{subject:"cover_image_fetch",cost_time:null!==(n=t)&&void 0!==n?n:0}),H=!0;if(!U&&o)(0,D.collectSuiteEvent)("client_sheet_perf_optimize_tracker_dev",{subject:"origin_image_fetch",cost_time:null!==(r=t)&&void 0!==r?r:0}),U=!0}}Z.MAX_RETRY_TIMES=6,Z.RETRY_DELAY=800,Z.INSTANCE_ID=0;var j=n("vsh_91781")},vsh_66242:function(e,t,n){"use strict";n.d(t,{F:function(){return l}});var r=n("vsh_67017"),i=n.n(r),o=n("vsh_35067"),a=n("vsh_12484"),s=n("vsh_22488"),u=n("vsh_32841");function l(e,t){return c.apply(this,arguments)}function c(){return(c=(0,o.Z)(i().mark((function e(t,n){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t!==a.NUM_FILE_TYPE.WIKI){e.next=7;break}return e.next=4,u.request.get("".concat(a.apiUrls.GET_WIKI).concat(n,"/"),{baseURL:(0,s.prependAPI)("/")});case 4:r=e.sent,e.next=10;break;case 7:return e.next=9,u.request.get(a.apiUrls.GET_META,{baseURL:(0,s.prependAPI)("/"),params:{type:t,token:n}});case 9:r=e.sent;case 10:return e.abrupt("return",r.data);case 13:return e.prev=13,e.t0=e.catch(0),e.abrupt("return",null);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})))).apply(this,arguments)}},vsh_69847:function(e,t,n){"use strict";n.d(t,{eE:function(){return o},kR:function(){return a},ZD:function(){return s}});var r=n("vsh_74561"),i=n("vsh_64299"),o=function(){return{afterTTU$:new i.X(!1),collaborativeSpread:new i.X(null),fasterDom$:new i.X(null),spreadLoading:new i.X(!0)}},a=function(e){e.afterTTU$.complete(),e.collaborativeSpread.complete(),e.fasterDom$.complete(),e.spreadLoading.complete()};function s(){var e,t=new i.X(null),n=new i.X(null),o=new i.X(null),a=new i.X(null),s=new i.X(null),u=new i.X(null),l=new i.X(null),c=(e={},(0,r.Z)(e,"LoadStatusStore/ClientVarsMessageValid",t),(0,r.Z)(e,"LoadStatusStore/ClientVarsMessageInvalid",n),(0,r.Z)(e,"LoadStatusStore/ContentMetaApply",o),(0,r.Z)(e,"LoadStatusStore/FirstActiveSheetLoaded",a),(0,r.Z)(e,"LoadStatusStore/SheetToUsage",s),(0,r.Z)(e,"LoadStatusStore/SpreadLoaded",u),(0,r.Z)(e,"LoadStatusStore/ReloadStart",l),e);return{stateMaps$:c,reset:function(){Object.keys(c).forEach((function(e){c[e].complete()}))}}}},vsh_38588:function(e,t,n){"use strict";n.d(t,{iQ:function(){return u},Yo:function(){return l},ir:function(){return c}});var r=n("vsh_6127"),i=n.n(r),o=n("vsh_18801"),a=n("vsh_12484"),s=n("vsh_18856");function u(e){var t;return!i().isOpendoc||(null===(t=null==e?void 0:e.partial.enable)||void 0===t||t)}function l(e){var t;return!i().isOpendoc||(null===(t=null==e?void 0:e.enable)||void 0===t||t)}function c(){var e;if(!i().isOpendoc)return!0;var t=(0,s.getFeatureConfigSelector)(a.FEATURE.CONTENT)(o.store.getState());return null===(e=null==t?void 0:t.recognizeHyperlink)||void 0===e||e}},vsh_50834:function(e,t,n){"use strict";n.d(t,{O:function(){return s},q:function(){return u}});var r=n("vsh_1139"),i=n("vsh_63738"),o=n("vsh_22488"),a=n("vsh_72834");function s(){var e=(0,o.getCurrentUser)();if(e){for(var t={id:e.get("id"),name:e.get("name"),enName:e.get("en_name")||e.get("name"),avatarUrl:e.get("avatar_url")},n=0,r=Object.keys(t);n<r.length;n++){if(!t[r[n]])return null}return t}return null}function u(e,t){for(var n=e._getModel().iterContentWithPos(t.rowFrom(),t.colFrom(),t.rowCount(),t.colCount()),o=n.next();null!==o;o=n.next()){var s=o,u=(0,r.Z)(s,2),l=u[0],c=u[1],h=c.row,d=c.col;if(l&&l.variant&&!e.getReminder(h,d)){var f=e.getCellFormatter(h,d);if(!f||!(0,i.isDateTimeFormatter)(f)||!(0,a.Avh)(l.variant.getValue()))return!0}}return!1}},vsh_65593:function(e,t,n){"use strict";n.d(t,{K:function(){return l}});var r=n("vsh_19264"),i=n("vsh_54997"),o=n.n(i),a=n("vsh_12484"),s=n("vsh_22488"),u=n("vsh_32841"),l=new function e(){(0,r.Z)(this,e),this.apiUrls=Object.assign({},a.apiUrls,{getClientVarsUrl:s.getClientVarsUrl,getSheetSubblocksUrl:s.getSheetSubblocksUrl}),this.prependAPI=s.prependAPI,this.getRequest=function(e,t){var n=(0,u.request)(Object.assign({url:e,method:"GET"},t));return{source:o().CancelToken.source(),promise:n}},this.postRequest=function(e,t,n){var r=(0,u.request)(Object.assign({url:e,data:t,method:"POST"},n));return{source:o().CancelToken.source(),promise:r}},this.putRequest=function(e,t,n){var r=(0,u.request)(Object.assign({url:e,data:t,method:"PUT"},n));return{source:o().CancelToken.source(),promise:r}},this.deleteRequest=function(e,t){var n=(0,u.request)(Object.assign({},{url:e,method:"DELETE"},t));return{source:o().CancelToken.source(),promise:n}}}},vsh_3789:function(e,t,n){"use strict";n.d(t,{Vi:function(){return c},w0:function(){return h},LJ:function(){return d},MZ:function(){return f},TD:function(){return p},sF:function(){return v},h_:function(){return g},Ju:function(){return _},H5:function(){return y},JV:function(){return m},Nw:function(){return C},wG:function(){return A},ub:function(){return O},iD:function(){return M},QF:function(){return k}});n("vsh_22485");var r=n("vsh_72834"),i=function(e,t){if(!e||!t)return null;var n=t.row,i=t.col,o=t.colCount,a=t.rowCount,s=t.sheetId;return new r.e6w(n,i,a,o,e.getSheetFromId(s))},o=/^[A-Za-z]+[0-9]+$/,a=/^[A-Za-z]+[0-9]+[:：][A-Za-z]+[0-9]+$/,s=/^[0-9]+[:：][0-9]+$/,u=/^[A-Za-z]+[:：][A-Za-z]+$/,l=/^(?:'([^*:/?[\]\\]+)'!)?(\$?[A-Za-z]+\$?[0-9]+|\$?[A-Za-z]+\$?[0-9]+[:：]\$?[A-Za-z]+\$?[0-9]+|\$?[0-9]+[:：]\$?[0-9]+|\$?[A-Za-z]+[:：]\$?[A-Za-z]+)$/,c=/,|，/,h=function(e,t){return(t?a:new RegExp("(".concat(o.source,")|(").concat(a.source,")|(").concat(s.source,")|(").concat(u.source,")"))).test(e.trim())},d=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=l;return r.test(t)?n?{isValid:!0,sheetName:RegExp.$1||e.getActiveSheet().name(),rangeString:RegExp.$2}:RegExp.$1?{isValid:!0,sheetName:RegExp.$1,rangeString:RegExp.$2}:{isValid:!1}:{isValid:!1}},f=function(e){var t=[];return Array.isArray(e)?(e.forEach((function(e){var n=function(e){if(e instanceof r.W7I){var t=e.sheet();if(t)return{row:e.rowFrom(),col:e.colFrom(),rowCount:e.rowCount(),colCount:e.colCount(),sheetId:t.id()}}return null}(e);n&&t.push(n)})),t):t},p=function(e,t,n,i,o){var a=[];if(!e||!t)return a;return(Array.isArray(t)?t:t.split(c)).forEach((function(t){if(t&&e&&(i?d(e.parent,t):h(t,n))){var s=(0,r.h0Q)(e,t,o);s&&a.push(s)}})),a},v=function(e,t){return e&&t?(0,r.Ywm)(i(e,t),!0):""},g=function(e,t){if(e&&t){var n=e.getRowCount(),r=e.getColumnCount(),i=t.rowFrom(),o=t.colFrom(),a=t.rowFrom()+t.rowCount(!0),s=t.colFrom()+t.colCount(!0);return!(i<=n&&o<=r&&a<=n&&s<=r)}return!0},_=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;if(!t)return{valid:!1,rangeStringArray:[],selections:[]};var i=[],o=[],a=!0;return t.split(c).forEach((function(t){if(h(t,n)&&e&&t){var s=(0,r.h0Q)(e,t);if(s&&!g(e,s))return i.push(s),void o.push((0,r.Ywm)(s,n))}a=!1})),{valid:a,rangeStringArray:o,selections:i}};function y(e,t){if(!e||!t)return null;if(g(e,t)){var n=e.getRowCount(),i=e.getColumnCount(),o=t.rowFrom(),a=t.colFrom(),s=t.rowFrom()+t.rowCount(!0),u=t.colFrom()+t.colCount(!0);if(o+1>n||a+1>i)return null;var l=s<=n?t.rowCount(!0):n-o,c=u<=i?t.colCount(!0):i-a;return new r.e6w(o,a,l,c,e)}return t}var m=function(e,t){return Array.from(e).some((function(e){return!!(t&&e&&e.contains(t))}))},E=function(e){return e.getActiveSheet().getSelections()[0]},b=function(e){var t=E(e);return t?t.rowCount():0},T=function(e){var t=E(e);return t?t.colCount():0},C=function(e){var t=E(e);return t?t.rowCount()*t.colCount():0},S=function(e){var t=e.getActiveSheet().getColumnCount();return 1===b(e)&&T(e)===t},w=function(e){var t=e.getActiveSheet().getRowCount();return 1===T(e)&&b(e)===t},R=function(e){return 1===b(e)&&1===T(e)},A=function(e,t){return(S(e)?"row":"")+(w(e)?"col":"")+(R(e)?"cell":"")+(S(e)||w(e)||R(e)?"":t)},O=function(e){var t=e.getActiveSheet(),n=t.getRowCount(),r=t.getColumnCount(),i=E(e);if(!i)return{};var o=i.rowCount(),a=i.colCount();return{isRow:n!==o&&r===a,rowCount:o,isCol:r!==a&&n===o,colCount:a}},M=function(e){return!(!Array.isArray(e)||1!==e.length)&&function(e){return!(!Array.isArray(e)||!e.length)&&e.some((function(e){var t=e.sheet();return!(!t||e.rowCount()!==t.getRowCount())}))}(e)},k=function(e){if(!e)return null;Array.isArray(e)||(e=[e]);for(var t=[],n=0;n<e.length;n++){var i=e[n],o=i.sheet(),a=i.toJSON(),s=a.row,u=a.rowCount,l=a.col,c=a.colCount;if(o&&u===o.getRowCount())for(var h=0;h<c;h++){var d,f=(null===(d=o.getSpan(s,l+h))||void 0===d?void 0:d.rowCount())||1;t.push(new r.e6w(f,l+h,u-f,1,o))}else t.push(i)}return t}},vsh_76309:function(e,t,n){"use strict";n.d(t,{R:function(){return y},E:function(){return _}});var r=n("vsh_67017"),i=n.n(r),o=n("vsh_98652"),a=n("vsh_35067"),s=n("vsh_59980"),u=n("vsh_79591"),l=n("vsh_79261"),c=n("vsh_84783");function h(e){var t,n,r=e.brand,i=e.scenario,o=e.params;return(null!==(t=e.request)&&void 0!==t?t:u.request)({baseURL:null!==(n=e.domain)&&void 0!==n?n:"/",url:c.B,data:{mode:l.yW.inline,scenario:i,brand:r,trigger_params_map:o},method:"POST"}).then((function(e){var t,n,r;return n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.actions,r=[],n&&n.forEach((function(e){var t,n=e.extra_map.Comment;try{n=JSON.parse(e.extra_map.Comment)}catch(t){console.log("aigc json parse error",t,e)}r.push({id:e.id,priority:Number(e.extra_map.Priority),extraMap:n,icon:e.icon,params:e.params,name:e.name,description:e.description,paramDetails:null===(t=e.param_details)||void 0===t?void 0:t.map((function(e){return Object.assign(Object.assign({},e),{displayName:null==e?void 0:e.display_name,isOptional:null==e?void 0:e.is_optional,needConfirm:null==e?void 0:e.need_confirm})}))})})),r}))}var d=n("vsh_22488"),f=n("vsh_24627"),p=n("vsh_96579");function v(e){var t;return e.forEach((function(e){f.nbU in e&&(e[f.nbU]&&(t=e[f.nbU]),delete e[f.nbU])})),t}var g=!1,_=function(){g=!1};function y(e){return{getAiResult:(n=(0,a.Z)(i().mark((function t(n,r,a,s,u){var l,c,h,_,y,m,E,b,T=arguments;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l=T.length>5&&void 0!==T[5]&&T[5],c=(0,d.generateRequestId)(),h={token:r,member_id:a,no_calc:l},_=v(n),g||((0,p.ccmEventTracking)("ccm_sheet_formula_view",Object.assign({},(0,f.dK5)(),{is_ai_formula:!0,formula_name:(0,o.Z)(new Set(n.map((function(e){return e.funcName})))).join(",")})),g=!0),t.next=7,e.postRequest(f.Ps3.apiURLs.GET_SHEET_ASK_AI,{content_contexts:n,lang:s||"zh",operate_id:u||"",refresh:_},{headers:{"Content-Type":"application/json","Request-Id":c,"x-request-id":c,"x-tt-trace-id":c},baseURL:e.prependAPI("/"),params:h}).promise;case 7:if(y=t.sent,!(l&&y&&y.data&&y.data.formula_results)){t.next=12;break}for(E in m={},y.data.formula_results)b=y.data.formula_results[E],m[E]=b.status===f.crM.Pending?{text:"",status:f.crM.Success}:b;return t.abrupt("return",{formula_results:m});case 12:return t.abrupt("return",y&&y.data);case 13:case"end":return t.stop()}}),t)}))),function(e,t,r,i,o){return n.apply(this,arguments)}),getAiActionList:(t=(0,a.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",h({brand:"feishu"===(0,s.default)(window,"globalConfig.common.product")?0:1,scenario:2,params:{is_formula:"true"}}));case 1:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})};var t,n}},vsh_97910:function(e,t,n){"use strict";n.d(t,{d:function(){return v}});var r=n("vsh_67017"),i=n.n(r),o=n("vsh_35067"),a=n("vsh_59980"),s=n("vsh_12484"),u=n("vsh_32841"),l=n("vsh_22488"),c=n("vsh_69691"),h=n("vsh_18856"),d=(0,a.default)(window,"globalConfig.common.domain.setting","internal-api-lark-api.feishu.cn"),f="",p=!1,v=function(){var e=(0,o.Z)(i().mark((function e(t){var n,r,o,v,g,_,y,m;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t||(v=null===(n=window)||void 0===n||null===(r=n.store)||void 0===r?void 0:r.getState(),t=(null===(o=(0,h.selectCurrentSuiteOwner)(v))||void 0===o?void 0:o.id)||(0,a.default)(window,"SERVER_DATA.benefitSettings.data.withOwner.ownerUserId")),t){e.next=3;break}return e.abrupt("return",!1);case 3:if(t!==f){e.next=5;break}return e.abrupt("return",p);case 5:return e.prev=5,g={version:"0.0.0",app_id:(0,c.isLark)()?"1664":"1161",app:"lark",platform:"web",app_channel:(0,l.getCommonChannel)(),user_id:t,tags:"sheetPerm",fg_tags:"sheetPerm"},e.next=9,(0,u.request)({url:"https://".concat(d).concat("/settings/v3/"),method:s.apiUrls.METHOD.GET,withCredentials:!1,headers:{"Content-Type":"application/json"},params:g});case 9:return _=e.sent,y=_.data,m="true"===(0,a.default)(y,["lark_features","values","ccm.sheet.invisible_protection"]),f=t,p=m,e.abrupt("return",p);case 17:return e.prev=17,e.t0=e.catch(5),console.log("getOwnerProtectionFG error",e.t0),e.abrupt("return",p);case 21:case"end":return e.stop()}}),e,null,[[5,17]])})));return function(t){return e.apply(this,arguments)}}()},vsh_98000:function(e,t,n){"use strict";n.d(t,{Sk:function(){return s},fQ:function(){return u},s:function(){return a}});var r=n("vsh_59980"),i=n("vsh_69691"),o=n("vsh_22488");function a(e){try{localStorage.setItem("sheet_toolbar_preference_is_single_V2",e?"true":"false")}catch(e){!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.level,r=t.tags,i=t.extras,a=Object.assign({},r,{file_type:"sheet"});(0,o.captureException)(e,{level:n,tags:a,extras:i})}(e)}}var s=function(){var e,t=localStorage.getItem("sheet_toolbar_preference_is_single_V2");if(t)try{e=JSON.parse(t)}catch(e){localStorage.removeItem("sheet_toolbar_preference_is_single_V2")}var n={hasOpenSheet:(0,r.default)(window.User,"user_profile.sheet_pc_is_open",!0),hasSetted:(0,r.default)(window.User,"user_profile.sheet_toolbar_history",!1),isSingle:!(0,r.default)(window.User,"user_profile.sheet_toolbar_setting",!0),hasConflict:!1,comeFrom:"server"};return void 0!==e?Object.assign({},n,{hasOpenSheet:!0,hasSetted:!0,hasConflict:n.isSingle!==e,isSingle:e,comeFrom:"localStorage"}):n};function u(){if(function(){try{localStorage.removeItem("sheet_toolbar_preference_is_single")}catch(e){}}(),"true"===localStorage.getItem("faster-shadow-recording"))return!0;if((0,i.isTestAccount)())return!1;var e=s(),t=e.hasSetted,n=e.isSingle;return!!t&&n}},vsh_68706:function(e,t,n){"use strict";n.d(t,{y:function(){return l}});var r,i=n("vsh_69691"),o=n("vsh_12484"),a=n("vsh_96579"),s=function(e,t){t&&(r=window.shortcutRenderStart||e);var n=r;return r=e,n};function u(e,t){return e-s(e,t===o.SHEET_LOAD_MAIN_STAGE_DURATION_LIST_KEY.FETCH_FILE_CLIENTVARS_START)}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if((0,i.isShortCut)()){var n=Date.now(),r={render_time:n,duration:u(n,e)};(0,a.reportSheetRenderStageDuration)(e,r,t)}}},vsh_73985:function(e,t,n){"use strict";n.d(t,{y:function(){return s}});var r=n("vsh_67017"),i=n.n(r),o=n("vsh_35067"),a=n("vsh_18801"),s=function(){var e=(0,o.Z)(i().mark((function e(t,n,r){var o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.store.getState().bitable?(0,a.makeBitableSdk)().then((function(e){var i=e.toggleFormSettingsPanel;a.store.dispatch(i(t,n,r))})):o=a.store.subscribe((function(){a.store.getState().bitable&&((0,a.makeBitableSdk)().then((function(e){var i=e.toggleFormSettingsPanel;a.store.dispatch(i(t,n,r))})),o())}));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},vsh_4623:function(e,t,n){"use strict";n.d(t,{rB:function(){return s},sp:function(){return a},Ae:function(){return u}});var r=n("vsh_60591"),i="__sheet_formula_calculating",o=n("vsh_73043");function a(){r.Toast.show({key:i,type:"loading",duration:3e3,content:o("CreationDoc_Sheets_Calculate_CalculatingPleaseWait")})}function s(){r.Toast.remove(i)}function u(){r.Toast.show({key:"warn-intersect-pivot-table",type:"warning",content:o("CreationDoc_Sheets_PivotTable_Failed_CanNotEditPivot")})}},vsh_65981:function(e,t,n){"use strict";n.r(t),n.d(t,{addChart:function(){return le},addEmbeddedBlock:function(){return _e},addFloatBlock:function(){return fe},addFloatImage:function(){return Se},addReminder:function(){return z},cellStatus:function(){return K},changeDecimalPlace:function(){return j},clear:function(){return F},clearAll:function(){return B},clearDataValidation:function(){return V},clearValues:function(){return H},computeRange:function(){return J},delChart:function(){return he},delDataRange:function(){return Te},delEmbeddedBlock:function(){return me},delFloatBlock:function(){return ve},delFloatImage:function(){return Re},freezeSheet:function(){return X},getEditorSelectInfo:function(){return De},hasFilter:function(){return Me},hasHiddenCol:function(){return xe},hasHiddenRow:function(){return ke},hiddenColCount:function(){return Ne},hiddenRowCount:function(){return Ie},isCleanMerge:function(){return G},rangeCalcStatus:function(){return te},rangeStatus:function(){return ee},rangesSubOverlap:function(){return Le},redo:function(){return D},rowColChangeLimit:function(){return oe},setCell:function(){return ue},setChart:function(){return ce},setDataRange:function(){return be},setEmbeddedBlock:function(){return ye},setFilterAction:function(){return Oe},setFloatBlock:function(){return pe},setFloatImage:function(){return we},setFontStyle:function(){return Z},setFormatter:function(){return U},setFormulaFromToolBar:function(){return re},setHyperlink:function(){return se},setRangeStyle:function(){return Y},setRowColChangeLimitExc:function(){return ae},setRowColVisible:function(){return Pe},setTextDecoration:function(){return W},undo:function(){return L}});var r=n("vsh_67017"),i=n.n(r),o=n("vsh_1139"),a=n("vsh_35067"),s=n("vsh_93301"),u=n("vsh_63738"),l=n("vsh_8073"),c=n("vsh_22485"),h=n("vsh_60591"),d=n("vsh_22488"),f=n("vsh_96579"),p=n("vsh_24627"),v=n("vsh_72834"),g=n("vsh_22233"),_=n("vsh_93766"),y=n("vsh_19264"),m=n("vsh_4175"),E=n("vsh_12064"),b=n("vsh_22462"),T=n("vsh_73455"),C=function(e){function t(){return(0,y.Z)(this,t),(0,E.Z)(this,(0,b.Z)(t).apply(this,arguments))}return(0,T.Z)(t,e),(0,m.Z)(t,[{key:"loop",value:function(e,t){var n=this;return new Promise((function(r,i){var o={run:function(){var i=n.next();return i instanceof Promise?(i.then((function(r){t=e(r,t),n._scheduler.add(o)})),l.TaskState.FINISHED):null!==i?(t=e(i,t),l.TaskState.RUNNING):(n._task=null,r(t),l.TaskState.FINISHED)},reject:i};n._task=o,n._scheduler.add(o)}))}}]),t}(l.NonBlockIterator),S=function(e){function t(){return(0,y.Z)(this,t),(0,E.Z)(this,(0,b.Z)(t).apply(this,arguments))}return(0,T.Z)(t,e),(0,m.Z)(t,[{key:"next",value:function(){var e=this;try{return this.asyncNext()}catch(t){return t instanceof c.AsyncVar?t.resolve().then((function(){return e.value()})):t}}}]),t}(v.I8v),w=n("vsh_50834"),R=n("vsh_63992"),A=n("vsh_97237"),O=n("vsh_73043");function M(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var I,x=(0,d.getAsyncCalcThresholdValue)(),N="async_calc_tip_key",P=(0,A.Wc)(window.location);function L(e){e.undoManager().undo()}function D(e){e.undoManager().redo()}function F(e,t){e.getActiveSheet().clearFormatting(t)}function B(e,t){e.getActiveSheet().clearValuesAndFormatting(t)}function V(e,t){e.getActiveSheet().clearDataValidation(t)}function H(e,t){e.getActiveSheet().clearValues(t)}function U(e,t){var n=e.getActiveSheet();null!=t&&(0,v.$aH)(p.NfN.GENERAL).isMatch(e,t)&&(t=void 0),n.setFormatter(n.getSelections(),t)}function Z(e,t,n){var r=e.getActiveSheet();r.setFontStyle(r.getSelections(),t,n)}function W(e,t,n){var r=e.getActiveSheet();r.setTextDecoration(r.getSelections(),t,n)}function j(e,t,n){var r=e.getActiveSheet(),i=r.getSelections();if(!(i.length<=0)){var o=i.sort((function(e,t){return e.rowFrom()===t.rowFrom()?e.colFrom()-t.colFrom():e.rowFrom()-t.rowFrom()})),a=[],l=null;if(r.cellModel){var c,h=M(o);try{var d=function(){var n=c.value,i=n.rowFrom(),o=n.colFrom(),h=n.rowCount(),d=n.colCount(),f=void 0,p=void 0;r.cellModel.iterVisibleCell(i,o,i+h-1,o+d-1).first_if((function(t){var n=t.row,i=t.col;return f=r.getSafeValue(n,i),!(!(0,s.default)(f)||!Number.isFinite(f)||r.getReminder(n,i))&&(p=r.getActualFormatter(n,i)||(0,u.createFormatter)(e.formatterService),!(!(0,u.isGeneralFormatter)(p,f)&&!(0,u.isDigitalFormatter)(p,f)))}))&&void 0!==f&&void 0!==p&&(l=(0,u.changeFormatterDecimalPlace)(e.formatterService,p,f,t)),a.push(new v.e6w(i,o,h,d,r))};for(h.s();!(c=h.n()).done;)d()}catch(e){h.e(e)}finally{h.f()}l&&0!==a.length&&r.setFormatter(a,l.getFormatCode())}}}function G(e){var t=e.getActiveSheet(),n=t.getSelections()[0];if(!n)return!1;for(var r=n.rowFrom(),i=n.colFrom(),o=n.rowCount(),a=n.colCount(),s=0,u=r;u<r+o;u++)for(var l=i;l<i+a;l++)(null!==t.getValue(u,l)||t.getSegmentArray(u,l))&&s++;return s<=1}function z(e){var t=e.getSelections();if(!t||0===t.length)return!0;var n=(0,w.O)(),r=new Date;r.setSeconds(0),r.setMilliseconds(0);var i=Number(r),o={expireTime:i,notifyTime:i,notifyUsers:n?[n]:[],notifyStrategy:p.FJE.AT_TIME_OF_EVENT};return e.addReminder(o,t,_.C)}function Y(e){var t=e.spread,n=e.prop,r=e.value,i=e.selections,o=t.getActiveSheet();o.setRangeStyle(i||o.getSelections(),n,r)}function X(e,t,n){e.getActiveSheet().freeze(t,n)}function K(e){var t=e.getActiveSheet();if(!t)return{};var n=t.getActiveColumnIndex(),r=t.getActiveRowIndex(),i=t._getCompositeStyle(r,n,p.A_Y.viewport),o=(0,v.Ab2)(t,r,n),a=(0,v.rwT)(t,r,n),s=(0,v.h7R)(t.getDataValidation(r,n)),u=i&&i.toJSON(!0)||{hAlign:void 0};u.hAlign=t.getCellHAlign(r,n);var l=i.fontInfo;return l&&(u.fontSize=l.fontSize,u.fontStyle=l.fontStyle,u.fontWeight=l.fontWeight),u.isEmbedImageCell=o,u.isFormulaImageCell=a,u.isImageCell=o||a,u.showDateEditIcon=s,u}function q(e,t){return e.isError()&&(t.sum=0,t.hasError=!0),!t.hasError&&e.isNumber()&&(t.sum+=e.getValue(),t.len++),e.isNull()||t.count++,t}function $(e,t){var n=l.FIterator.fromArray(t).map((function(t){return e.cellModel.iterVisibleRange(t.rowFrom(),t.colFrom(),t.rowTo(!0),t.colTo(!0))})).flatten().map((function(e){return new v.z4O(e).iterIf([],{skipEmptyRef:!0},S)})).flatten(),r=new C(n,e.parent.fIdleScheduler);return{asyncPromise:r.reduce(q,{sum:0,len:0,count:0,hasError:!1}),cancelCalc:function(){r.abort()}}}function J(e,t){return Q.apply(this,arguments)}function Q(){return(Q=(0,a.Z)(i().mark((function e(t,n){var r,o,a,s,u,l,d,f,v;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=P,o={average:0,sum:0,count:0},1!==n.length||1!==n[0].rowCount()||1!==n[0].colCount()){e.next=4;break}return e.abrupt("return",o);case 4:if(I&&I(),h.Toast.remove(N),I=void 0,(a=[]).push(n[0]),n.length>1)for(s=1;s<n.length;s++)(0,p.hTd)(a,Le(n.slice(0,s),[n[s]],0));return u=r?null:setTimeout((function(){h.Toast.show({key:N,content:O("CreationDoc_Sheets_Calculating"),type:"loading"})}),x),t.parent.sheetIdle.turnOnIdle(),l=$(t,a),d=l.asyncPromise,f=l.cancelCalc,I=f,e.prev=14,e.next=17,d.then((function(e){var t=e.sum,n=e.count,r=e.len;return{sum:t,count:n,average:t?t/r:t}}));case 17:v=e.sent,o.average=(0,c.convertTo15Digits)(v.average),o.sum=(0,c.convertTo15Digits)(v.sum),o.count=(0,c.convertTo15Digits)(v.count),e.next=25;break;case 23:e.prev=23,e.t0=e.catch(14);case 25:return e.prev=25,u&&clearTimeout(u),h.Toast.remove(N),t.parent.sheetIdle.turnOffIdle(),I=void 0,e.finish(25);case 31:return e.abrupt("return",o);case 32:case"end":return e.stop()}}),e,null,[[14,23,25,31]])})))).apply(this,arguments)}function ee(e){var t=e.getActiveSheet(),n={};if(!t||"-1"===t._id_)return n;var r=t.getSelections(),i=(0,v.ANU)(e),o=i.splitable,a=i.mergable;return n.splitable=o,n.mergable=a,n.isSingleCell=1===r.length&&1===r[0].rowCount()&&1===r[0].colCount(),n.sortable=1===r.length&&1!==r[0].rowCount(),n.painterFormatable=1===r.length,n}function te(e){return ne.apply(this,arguments)}function ne(){return(ne=(0,a.Z)(i().mark((function e(t){var n,r,o,a,s,l,c,h,d,f,p,v;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.getActiveSheet()){e.next=3;break}return e.abrupt("return");case 3:if(r=n.getSelections(),o=n.getActiveCellIndex(),a=o.row,s=o.column,l=n.getCellFormatter(a,s),c=l&&(0,u.isDigitalFormatter)(l),!(r.length>0)){e.next=21;break}return e.next=10,J(n,r);case 10:return h=e.sent,d=h.sum,f=h.average,p=h.count,(v={}).sum=d||0,v.average=f||0,v.count=p||0,v.formattedSum=c?l.format(v.sum):v.sum,v.formattedAverage=c?l.format(v.average):v.average,e.abrupt("return",v);case 21:return e.abrupt("return");case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function re(e,t){var n=e.spread.getActiveSheet(),r=n.getSelections();if(!(r.length<1)){var i=r[r.length-1],o="=".concat(t,"(").concat(i.toString({ref:i}));1===i.size()?o="=".concat(t,"("):i.rowTo()+1>=n.getRowCount()||(1===i.rowCount()&&i.colTo()+1<n.getColumnCount()?n.setActiveCell(i.rowFrom(),i.colTo()+1):n.setActiveCell(i.rowTo()+1,i.colFrom()));var a=e.getPlugin("CellEditorPlugin");a&&(a.updateEditorStyleState({hAlign:p.KqL.Left}),a.startEdit({sheet:n,enableFocus:!0,defaultText:o}))}}function ie(e,t){var n=Array.isArray(t)?t:[t],r=e.getRowCount(),i=e.getColumnCount();return n.forEach((function(e){e.method===v.Dx_.ADD&&(e.type===v.NHZ.ROW?r+=e.count:e.type===v.NHZ.COL&&(i+=e.count))})),[r,i]}function oe(e,t){var n=ie(e,t),r=(0,o.Z)(n,2);return r[0]*r[1]<=(0,p.$$w)()}function ae(e,t){var n=Array.isArray(t)?t:[t],r=ie(e,t),i=(0,o.Z)(r,2),a=i[0],s=i[1],u=Date.now(),l=n[0].type,c=l===v.NHZ.ROW?v.NHZ.COL:v.NHZ.ROW,h=function(e,t){var n=-1;return t===v.NHZ.COL?n=e.getLastBlankRowPos():t===v.NHZ.ROW&&(n=e.getLastBlankColPos()),0===n?n+1:n}(e,l),d=Date.now()-u;l===v.NHZ.COL?a=h:l===v.NHZ.ROW&&(s=h);var _=!(-1===h),y=a*s>(0,p.$$w)(),m=l===v.NHZ.ROW?e.getColumnCount()-h:e.getRowCount()-h;if(_&&(0,f.collectSuiteEvent)("client_sheet_rowcol_change_limit_exceed",{add_row_or_col:l,del_row_or_col:c,add_target:n[0].target,add_count:n[0].count,del_target:h,del_count:m,del_still_exceed:y,get_pos_cost_time:d}),_&&!y){(0,g.K4)({title:O("sheet.cell_limit_exceed"),body:O("LarkCCM_Sheets_CellLimitClearColRow_Desc",(0,p.ytD)()),confirmText:O("sheet.auto_clear.blank_ranks"),cancelText:O("common.cancel"),onConfirm:function(){var t;(t=e._commandManager())&&(t.execute({cmd:p.rvF.SET_ROW_COL_CHANGE,sheetId:e.id(),method:v.Dx_.DEL,type:c,target:h,count:m}),t.execute({ranges:n,method:v.Dx_.ADD,cmd:p.rvF.SET_ROW_COL_CHANGE,sheetId:e.id(),type:l}))},onCancel:function(){}})}else e._raiseInvalidOperation(6,O("sheet.cell_limit_exceed"))}function se(e,t){e.getActiveSheet().setCellValue(t.row,t.col,t.newValue)}function ue(e,t,n){var r=e.getSheetFromId(t);r&&r.setCellValue(n.row,n.col,n.newValue)}function le(e,t){return de(e,t,p.RWb.Add)}function ce(e,t){return de(e,t,p.RWb.Set)}function he(e,t,n){var r=e.getSheetFromId(t);r&&r.delChart(n)}function de(e,t,n){var r=e.getSheetFromId(t.sheetId);n===p.RWb.Add?r&&r.addChart(t.chartId,t):r&&r.setChart(t.chartId,t)}function fe(e,t){return ge(e,t,p.ubj.Add)}function pe(e,t){return ge(e,t,p.ubj.Set)}function ve(e,t,n){var r=e.getSheetFromId(t);r&&r.delFloatBlock(n)}function ge(e,t,n){var r=e.getSheetFromId(t.sheetId);n===p.ubj.Add?r&&r.addFloatBlock(t):r&&r.setFloatBlock(t)}function _e(e,t,n){var r=e.getSheetFromId(t);r&&r.addEmbeddedBlock(n)}function ye(e,t,n){var r=e.getSheetFromId(t);r&&r.setEmbeddedBlock(n)}function me(e,t,n){var r=e.getSheetFromId(t);r&&r.delEmbeddedBlock(n)}var Ee=function(e){return!!e&&(void 0===e.type||e.type===p.xj7.NORMAL?""!==e.rangeId&&e.colCount>0&&e.rowCount>0&&e.col>-1&&e.row>-1&&e.rangeId.split("_")&&e.sheetId===e.rangeId.split("_")[0]:e.type===p.xj7.ROW?""!==e.rangeId&&e.rowCount>0&&e.row>-1&&e.rangeId.split("_")&&e.sheetId===e.rangeId.split("_")[0]:e.type===p.xj7.COL?""!==e.rangeId&&e.colCount>0&&e.col>-1&&e.rangeId.split("_")&&e.sheetId===e.rangeId.split("_")[0]:e.type===p.xj7.ALL&&(""!==e.rangeId&&e.rangeId.split("_")&&e.sheetId===e.rangeId.split("_")[0]))};function be(e,t,n){return Ce(e,p.r16.Set,t.filter(Ee),n)}function Te(e,t,n){if(Array.isArray(t)&&t.length)return Ce(e,p.r16.Del,t.filter(Ee),n)}function Ce(e,t,n,r){t===p.r16.Set?e.setDataRange(n,r):e.delDataRange(n,r)}function Se(e,t){Ae(e,t,p.NxK.Add);var n=e.getActiveSheet();n&&n.floatImageModel.setActiveId(t.map((function(e){return e.floatImageId})))}function we(e,t){return Ae(e,t,p.NxK.Set)}function Re(e,t,n){var r=e.getSheetFromId(t);r&&r.delFloatImage(n)}function Ae(e,t,n){var r=e.getSheetFromId(t[0].sheetId);n===p.NxK.Add?r&&r.addFloatImage(t):r&&r.setFloatImage(t)}function Oe(e){var t=e.sheet,n=e.status,r=e.range;switch(n){case"delFilter":t.delFilter();break;case"addFilter":t.addFilter(r)}}function Me(e){return e.getActiveSheet().sheetFilterModel.hasFilter()}function ke(e,t,n){for(var r=t+n;t<r;){if(e.isRowOrColHidden(t,!0))return!0;t++}return!1}function Ie(e){return e?e.getHiddenRowCount():0}function xe(e,t,n){for(var r=t+n;t<r;){if(e.isRowOrColHidden(t,!1))return!0;t++}return!1}function Ne(e){return e?e.getHiddenColCount():0}function Pe(e,t,n,r){var i=e.getActiveSheet(),o=(n=Array.isArray(n)?n:[n]).map((function(e){var n="hideRow"===t||"unhideRow"===t;return{target:n?e.rowFrom():e.colFrom(),count:n?e.rowCount():e.colCount()}}));switch(t){case"hideRow":i.hideRow(o);break;case"unhideRow":i.unhideRow(o);break;case"hideCol":i.hideCol(o);break;case"unhideCol":i.unhideCol(o)}}function Le(e,t,n){var r=e[n];if(r){for(var i=t.length,o=[],a=0;a<i;a++)(0,p.hTd)(o,t[a].sub(r));return Le(e,o,++n)}return t}var De=function(e){var t=e.spread.getActiveSheet(),n=e.getPlugin("CellEditorPlugin");if(n&&n.isEditing(t)){var r=n.sheetEditor.editor,i=r.selection.getSelection(),o=i.start,a=i.end,s=r.getContentState().getActiveZone().slice(o,a),u=(0,R.p)(s,t),l=s.length()-1;return{object_count:u.length-l,is_select_all:r.selection.isSelectingAll(),mode:"editor"}}return null}},vsh_97237:function(e,t,n){"use strict";n.d(t,{De:function(){return h},ms:function(){return d},XU:function(){return f},eN:function(){return p},j1:function(){return v},Wc:function(){return g},DP:function(){return _}});var r,i=n("vsh_65498"),o=n("vsh_26278"),a=n("vsh_69691"),s=n("vsh_22488"),u=n("vsh_60505"),l=n("vsh_18801");function c(e){var t=function(e,t){if("object"!==(0,i.Z)(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==(0,i.Z)(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===(0,i.Z)(t)?t:String(t)}function h(){return(0,a.parseQuery)(location.search)[l.QUERY_FIELDS.CCM_OPEN_TYPE]||((0,l.isUnderVersionIndex)()?l.VersionOpenType.FROM_VERSION_LINK:void 0)}function d(){var e=(0,a.parseQuery)(location.search),t=l.QUERY_FIELDS.CCM_OPEN_TYPE,n=e[t],r=(0,o.Z)(e,[t].map(c));n&&s.history.replace({search:(0,s.formatQuery)(r)})}function f(){return(0,s.getIsSheet)()&&(0,l.checkVersionPageStatus)()}function p(e){var t=e.search,n=e.hash;return(0,u.parse)(t.slice(1))[r.SHEET]||n.slice(1)||""}function v(e){var t=e.search;return(0,u.parse)(t.slice(1))[r.RANGE_TOKEN]||""}function g(e){var t=e.search;return(0,u.parse)(t.slice(1))[r.RANGE_ID]||""}function _(e){var t=e.search;return(0,u.parse)(t.slice(1))[r.FLOAT_BLOCK]||""}!function(e){e.SHEET="sheet",e.RANGE_TOKEN="range",e.FLOAT_BLOCK="floatBlock",e.RANGE_ID="rangeId"}(r||(r={}))},vsh_39371:function(e,t,n){"use strict";n.d(t,{Gg:function(){return r},w5:function(){return s},eY:function(){return u},B$:function(){return l},i_:function(){return c},AZ:function(){return h}});var r,i=n("vsh_29098"),o=n("vsh_4644"),a=n("vsh_73043");!function(e){e.LOCAL="local",e.COLLABORATIVE="collaborative",e.NULL="null"}(r||(r={}));var s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"NotPerm";(0,o.o2)(void 0,e)},u=function(e){for(var t=e.getActiveSheet(),n=t.inject(i.G),r=arguments.length,o=new Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];return n.handleAddFilterView.apply(n,o)},l=function(e,t){return e.getActiveSheet().inject(i.G).handleAddPersonalView(t)},c=function(e,t){return e.getActiveSheet().inject(i.G).handleExitPersonalView(t)},h=function(e,t){for(var n=new Date,r="".concat(d(n.getMonth()+1),"/").concat(d(n.getDate())),i=1,o="";o=1===i?a("CreationDoc_Sheets_Filter_DefaultViewName",e,r):a("CreationDoc_Sheets_Filter_DefaultViewNameNumber",e,r,i),t.isNameExit(o);)i++;return o};function d(e){return"0".concat(e).slice(-2)}},vsh_20881:function(e,t,n){"use strict";n.d(t,{lr:function(){return s},qE:function(){return u},bZ:function(){return l},oc:function(){return c},$G:function(){return h},gb:function(){return d}});var r=n("vsh_98125"),i=n.n(r),o=n("vsh_52856"),a=n.n(o),s=a()({loader:function(){return n.e("vsh_2369").then(n.bind(n,"vsh_27609"))},loading:function(){return null}}),u=a()({loader:function(){return n.e("vsh_7425").then(n.bind(n,"vsh_96503"))},loading:function(){return null}}),l=a()({loader:function(){return n.e("vsh_6549").then(n.bind(n,"vsh_18597"))},loading:function(){return null}}),c=a()({loader:function(){return n.e("vsh_2580").then(n.bind(n,"vsh_95896"))},loading:function(){return null},render:function(e,t){return i().createElement(e.I18n,Object.assign({},t))}}),h=a()({loader:function(){return n.e("vsh_7456").then(n.bind(n,"vsh_12838"))},loading:function(){return null}}),d=a()({loader:function(){return n.e("vsh_3676").then(n.bind(n,"vsh_68083"))},loading:function(){return null},render:function(e,t){return i().createElement(e.Loading,Object.assign({},t))}})},vsh_90795:function(e,t,n){"use strict";n.d(t,{xE:function(){return d},sZ:function(){return s},V5:function(){return v},Wj:function(){return g},XE:function(){return m},tT:function(){return E},mG:function(){return b},Bd:function(){return T},dH:function(){return C},He:function(){return f},d4:function(){return p},FK:function(){return w},C2:function(){return S}});var r,i,o,a,s,u=n("vsh_74561"),l=n("vsh_24627"),c=n("vsh_79261"),h=n("vsh_73043"),d=150;!function(e){e[e.emptySheet=0]="emptySheet",e[e.formulaCell=1]="formulaCell",e[e.notFormulaCell=2]="notFormulaCell",e[e.range=3]="range",e[e.emptyCell=4]="emptyCell",e[e.emptyRange=5]="emptyRange",e[e.unKnow=6]="unKnow",e[e.singleRow=7]="singleRow"}(a||(a={})),function(e){e.userPrompt="user_prompt",e.sheetWriteFormula="sheetWriteFormula",e.sheetFasterBtn="sheetFasterBtn",e.sheetInsert="sheetInsert",e.sheetRedo="sheetRedo",e.sheetReset="sheetReset",e.sheetExit="sheetExit",e.sheetCopy="sheetCopy",e.redo="redo",e.analysis="analysis",e.analysisError="analysisError",e.dataProcessing="dataProcessing",e.dataInsights="dataInsights",e.dataProcessingUndo="dataProcessingUndo",e.dataProcessingFinish="dataProcessingFinish",e.extract="extract",e.classify="classify",e.sentiment="sentiment",e.translate="translate",e.createSheet="createSheet",e.aiWrite="aiWrite",e.polish="polish",e.summary="summary",e.back="back",e.done="done",e.undo="undo",e.createSheetRecommendFields="createSheetRecommendFields",e.createSheetAddRecords="createSheetAddRecords",e.createSheetAddFields="createSheetAddFields",e.viewMore="viewMore",e.writeFormulaRecommendMore="writeFormulaRecommendMore"}(s||(s={}));var f,p,v=(r={},(0,u.Z)(r,s.sheetWriteFormula,"formula_assistant"),(0,u.Z)(r,s.sheetFasterBtn,"write_formula"),(0,u.Z)(r,s.analysis,"explain_formula"),(0,u.Z)(r,s.analysisError,"correct_formula"),(0,u.Z)(r,s.dataInsights,"data_analysis"),(0,u.Z)(r,s.aiWrite,"write"),(0,u.Z)(r,s.createSheet,"create_sheet"),(0,u.Z)(r,s.createSheetRecommendFields,"create_sheet_recommend_fields"),(0,u.Z)(r,s.createSheetAddRecords,"create_sheet_add_records"),(0,u.Z)(r,s.createSheetAddFields,"create_sheet_add_fields"),(0,u.Z)(r,s.sentiment,"sentiment"),(0,u.Z)(r,s.polish,"polish"),(0,u.Z)(r,s.summary,"summary"),(0,u.Z)(r,s.extract,"extract"),(0,u.Z)(r,s.classify,"classify"),(0,u.Z)(r,s.translate,"translate"),(0,u.Z)(r,s.viewMore,"view_more"),r),g={text:h("LarkCCM_Sheets_ASKAI_Exit_Button"),type:s.sheetExit,uiType:c.x4.Normal},_={text:h("LarkCCM_Sheets_ASKAI_Retry_Button"),type:s.sheetRedo,uiType:c.x4.Normal},y={text:h("LarkCCM_Sheets_ASKAI_InsertCell_Button"),type:s.sheetInsert,uiType:c.x4.Primary},m=function(e){return{title:e.text,text:e.text,itemType:c.zg.Normal,type:e.type,uiType:e.uiType}},E={operator:[y,_,g]},b={operator:[_,g]},T={operator:[{text:h("LarkCCM_Sheets_AI_DataAnalysis_Complete_Button"),type:s.dataProcessingFinish,uiType:c.x4.Primary},{text:h("LarkCCM_Sheets_AI_DataAnalysis_Revoke_Button"),type:s.dataProcessingUndo,uiType:c.x4.Normal}],failOperator:[_,g]},C=(i={},(0,u.Z)(i,l.crM.TNS_AREA,(function(e){return h("LarkCCM_Docs_MyAI_UnavailRegion_aiName_Text",{aiName:e})})),(0,u.Z)(i,l.crM.TNS_BRAND,(function(e){return h("LarkCCM_Docs_MyAI_LogInToUse_aiName_Text",{aiName:e})})),(0,u.Z)(i,l.crM.TNS_OUTPUT,(function(){return h("LarkCCM_Sheets_MyAI_SafetyRestrict_Title")})),(0,u.Z)(i,l.crM.TNS_INPUT,(function(){return h("LarkCCM_Sheets_MyAI_TryAnotherPrompt_Title")})),(0,u.Z)(i,l.crM.PermissionDeny,(function(){return h("LarkCCM_Sheets_ASKAI_NoPerm_Toast")})),(0,u.Z)(i,l.crM.MyAIStop,(function(e){return h("LarkCCM_Sheets_MyAI_NoPermissionToUse_aiName_Desc",{aiName:e})})),(0,u.Z)(i,l.crM.ContextTooLong,(function(e){return h("LarkCCM_Sheets_MyAI_Processing_TooMuchData_aiName_Description",{aiName:e})})),i);!function(e){e.aiWriteFormula="sheet_ai_formula_assistant",e.insight="sheet_data_insight",e.formulaAssistant="sheet_formula_assistant",e.conditionalFormat="sheet_action_conditional_format",e.sort="sheet_action_sort_filter",e.createTable="sheet_create_table_v2",e.createRecord="sheet_create_record",e.recommendField="sheet_recommend_field",e.createField="sheet_create_field",e.explainFormula="sheet_explain_formula"}(f||(f={})),function(e){e.filter="filter",e.threeConclusion="threeConclusion",e.aiChart="aiChart",e.aiPivotTable="aiPivotTable",e.condition="condition",e.analysis="analysis",e.analysisError="analysisError",e.createSheet="createSheet",e.sheetFasterBtn="sheetFasterBtn",e.extract="extract",e.classify="classify",e.sentiment="sentiment",e.translate="translate",e.write="write",e.polish="polish",e.summary="summary"}(p||(p={}));var S,w=(o={},(0,u.Z)(o,s.dataInsights,f.insight),(0,u.Z)(o,s.sheetFasterBtn,f.formulaAssistant),(0,u.Z)(o,s.createSheet,f.createTable),o);!function(e){e[e.AI_KEY_CONCLUSIONS=1]="AI_KEY_CONCLUSIONS",e[e.AI_CHART=2]="AI_CHART",e[e.CREATE_FORMULA=3]="CREATE_FORMULA",e[e.AI_EXTRACT=4]="AI_EXTRACT",e[e.AI_CLASSIFY=5]="AI_CLASSIFY",e[e.AI_SENTIMENT=6]="AI_SENTIMENT",e[e.AI_TRANSLATE=7]="AI_TRANSLATE",e[e.AI_WRITE=8]="AI_WRITE",e[e.AI_POLISH=9]="AI_POLISH",e[e.AI_SUMMARY=10]="AI_SUMMARY",e[e.AI_CREATE_SHEET=11]="AI_CREATE_SHEET",e[e.AI_DEEPSEEK_WRITE=12]="AI_DEEPSEEK_WRITE",e[e.AI_ASK=13]="AI_ASK",e[e.VIEW_MORE=50]="VIEW_MORE"}(S||(S={}))},vsh_7273:function(e,t,n){"use strict";n.d(t,{V:function(){return L},S:function(){return D}});var r=n("vsh_67017"),i=n.n(r),o=n("vsh_35067"),a=n("vsh_19264"),s=n("vsh_4175"),u=n("vsh_4561"),l=n("vsh_31630"),c=n("vsh_64299"),h=n("vsh_34792"),d=n("vsh_18801"),f=n("vsh_22488"),p=n("vsh_96579"),v=n("vsh_43350"),g=n("vsh_46162"),_=n("vsh_24627"),y=n("vsh_72834"),m=n("vsh_74340"),E=n("vsh_10455"),b=n("vsh_69691"),T=n("vsh_30430"),C=n("vsh_37224"),S=n("vsh_28213"),w=n("vsh_14071"),R=n("vsh_74561"),A=n("vsh_36506"),O=n("vsh_60591"),M=n("vsh_73985"),k=n("vsh_73043"),I=function(e,t,n,r,i){var o={cmd:_.rvF.ADD_BLOCK,index:r,blockType:_.kHU.BITABLE_BLOCK,blockData:t,sheetName:n,blockId:i};return e.commandManager().execute(o)},x=function(){var e=(0,o.Z)(i().mark((function e(t){var n,r,o,a,s,u,l,c,h,f,p,v,g,_,m,E,b,T,C,S;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.memberId,r=t.snapshots,o=t.tabType,a=t.index,s=t.spread,u=t.blockId,n){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,(0,d.importTypes)();case 5:return l=e.sent,c=l.BitableType,h=l.ViewType,e.prev=8,e.next=11,(0,d.importBitableDefaultActions)();case 11:if(f=e.sent,!r||!r.length){e.next=20;break}return p=c.EmbeddedInSheet,e.next=16,f.addTables(n,r,p);case 16:e.sent.forEach((function(e,n){e.operations[0].actions[0].contentCreation=!0;var i=r[n].name;I(s,JSON.stringify(e),i,t.index,u)})),e.next=29;break;case 20:return v={},(0,R.Z)(v,y.AOr.Grid,h.Grid),(0,R.Z)(v,y.AOr.Kanban,h.Kanban),(0,R.Z)(v,y.AOr.Gantt,h.Gantt),(0,R.Z)(v,y.AOr.Gallery,h.Gallery),(0,R.Z)(v,y.AOr.Form,h.Form),(0,R.Z)(v,y.AOr.Calendar,h.Calendar),g=v[o],_=o===y.AOr.Gantt?13:3,e.next=25,f.addTable(n,o,g,_);case 25:m=e.sent,E=JSON.stringify(m),I(s,E,t.sheetName,a,u),o===y.AOr.Form&&(b=m.operations[0].actions[0],T=b.data,C=b.tableId,(S=(0,A.Z)(T.snapshot.viewMap,(function(e){return e.type===h.Form})))&&(0,M.y)(C,S,!0));case 29:e.next=35;break;case 31:return e.prev=31,e.t0=e.catch(8),O.Toast.show({type:"error",content:k("sheet.add_tab_fail"),duration:2e3,closable:!0}),e.abrupt("return");case 35:case"end":return e.stop()}}),e,null,[[8,31]])})));return function(t){return e.apply(this,arguments)}}(),N=n("vsh_82905"),P=n("vsh_73043"),L=function(){function e(t,n,r){var s,c,p,g,y,m,E,S,R,A,O,M,k,I,x,P=this;(0,a.Z)(this,e),this.blockManager=t,this.spread=n,this.blockDataSetMap=new Map,this.createSourceMap={},this.bridgeLoaded={},this.innerMountedSheetIds=new Set,this.loadedSubjects=new Map,this.blockIds=new Map,this.commentManager={setCommentData:(S=(0,o.Z)(i().mark((function e(t,n){var r,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=P.getTableIdBySheetId(t)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,P.getBridge();case 5:return o=e.sent,e.next=8,o.setCommentData(r,n);case 8:case"end":return e.stop()}}),e)}))),function(e,t){return S.apply(this,arguments)}),showCommentInNcc:(E=(0,o.Z)(i().mark((function e(t,n){var r,o,a,s,u,l,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=JSON.parse(n.extra||"{}"),s=P.getTableIdBySheetId(t)){e.next=4;break}return e.abrupt("return");case 4:return u=(null===(r=a.notify_extra)||void 0===r?void 0:r.view)||"",l={commentId:n.comment_id,table:s,view:u,noticeStatus:n.notice_status,noticeType:n.notice_type,replyId:n.reply_id,reactionKey:n.reaction_key,formUserId:null===(o=n.from_user)||void 0===o?void 0:o.user_id},e.next=8,P.getBridge();case 8:return c=e.sent,e.next=11,c.showCommentInNcc(s,l);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)}))),function(e,t){return E.apply(this,arguments)}),getCommentPositions:(m=(0,o.Z)(i().mark((function e(t){var n,r,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=P.getTableIdBySheetId(t)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,P.getBridge();case 5:return r=e.sent,o=r.getCommentPositions(n),e.abrupt("return",o);case 8:case"end":return e.stop()}}),e)}))),function(e){return m.apply(this,arguments)}),reopenComment:(y=(0,o.Z)(i().mark((function e(t,n){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=P.getTableIdBySheetId(t)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,P.getBridge();case 5:e.sent.reopenComment(r,n);case 7:case"end":return e.stop()}}),e)}))),function(e,t){return y.apply(this,arguments)}),startNewComment:(g=(0,o.Z)(i().mark((function e(t,n){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=P.getTableIdBySheetId(t)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,P.getBridge();case 5:e.sent.startNewComment(r,n);case 7:case"end":return e.stop()}}),e)}))),function(e,t){return g.apply(this,arguments)}),resolveComment:(p=(0,o.Z)(i().mark((function e(t,n){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=P.getTableIdBySheetId(t)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,P.getBridge();case 5:e.sent.resolveComment(r,n);case 7:case"end":return e.stop()}}),e)}))),function(e,t){return p.apply(this,arguments)}),removeComment:(c=(0,o.Z)(i().mark((function e(t,n){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=P.getTableIdBySheetId(t)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,P.getBridge();case 5:e.sent.removeComment(r,n);case 7:case"end":return e.stop()}}),e)}))),function(e,t){return c.apply(this,arguments)}),activateComment:(s=(0,o.Z)(i().mark((function e(t,n){var r,o,a,s,u,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=n.comment_id,o=void 0===r?"":r,a=n.extra,s=void 0===a?"":a,u=JSON.parse(s).notify_extra.table){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,P.waitTableClientVarLoaded(u);case 7:return e.next=9,P.getBridge();case 9:return l=e.sent,e.next=12,l.activateComment(u,o);case 12:return e.next=14,P.commentManager.showCommentInNcc(t,n);case 14:return e.abrupt("return");case 17:return e.prev=17,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return");case 21:case"end":return e.stop()}}),e,null,[[0,17]])}))),function(e,t){return s.apply(this,arguments)})},this.mentionManager={locateMention:(R=(0,o.Z)(i().mark((function e(t,n){var r,o,a,s,u,l,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=n.mention_id,o=void 0===r?"":r,a=n.extra,s=void 0===a?"":a,u=JSON.parse(JSON.parse(s).source_file_type),l=u.tableId){e.next=6;break}return e.abrupt("return",!1);case 6:return e.next=8,P.waitTableClientVarLoaded(l);case 8:return e.next=10,P.getBridge();case 10:return c=e.sent,e.abrupt("return",c.locateMention(l,o,s));case 14:return e.prev=14,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",!1);case 18:case"end":return e.stop()}}),e,null,[[0,14]])}))),function(e,t){return R.apply(this,arguments)})},this.historyManager={exitHistory:(M=(0,o.Z)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.getBridge();case 2:(t=e.sent).exitHistory&&t.exitHistory();case 4:case"end":return e.stop()}}),e)}))),function(){return M.apply(this,arguments)}),previewHistory:(O=(0,o.Z)(i().mark((function e(t){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("block-manager preview history"),e.next=3,P.getBridge();case 3:if(!(n=e.sent).previewHistory){e.next=7;break}return e.next=7,n.previewHistory(t);case 7:case"end":return e.stop()}}),e)}))),function(e){return O.apply(this,arguments)}),recoverHistory:(A=(0,o.Z)(i().mark((function e(t){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("block-manager recover history"),e.next=3,P.getBridge();case 3:if(!(n=e.sent).recoverHistory){e.next=7;break}return e.next=7,n.recoverHistory(t);case 7:case"end":return e.stop()}}),e)}))),function(e){return A.apply(this,arguments)})},this.translateManager={enterTranslateMode:(I=(0,o.Z)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.getBridge();case 2:if(!(t=e.sent).enterTranslateMode){e.next=8;break}return e.next=6,P.waitForBitableManager;case 6:return e.next=8,t.enterTranslateMode();case 8:case"end":return e.stop()}}),e)}))),function(){return I.apply(this,arguments)}),exitTranslateMode:(k=(0,o.Z)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.getBridge();case 2:if(!(t=e.sent).exitTranslateMode){e.next=6;break}return e.next=6,t.exitTranslateMode();case 6:return P.destroyBridge(),e.next=9,P.getAdapter();case 9:e.sent.destory("");case 11:case"end":return e.stop()}}),e)}))),function(){return k.apply(this,arguments)})},this.viewportManager={setBlockHeight:(x=(0,o.Z)(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.getBridge();case 2:e.sent.setHeight(t);case 4:case"end":return e.stop()}}),e)}))),function(e){return x.apply(this,arguments)})},this.awaitBlock=function(){var e=(0,o.Z)(i().mark((function e(t){var n,r,o,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.loadAditBundle)();case 2:return n=e.sent,r=n.BlockManager,o=n.SheetAdapter,e.next=7,P.getBitableCreator(t);case 7:return a=e.sent,e.abrupt("return",{BlockManager:r,SheetAdapter:o,creater:a});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getAdapter=(0,v.DI)((0,o.Z)(i().mark((function e(){var t,n,r,o,a,s,u,l,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=P.options,n=(0,b.isShortCut)()?void 0:(0,f.waitFetchI18N)(f.I18nBizType.BITABLE),r=(0,T.asyncLoadModuleWrapper)("bitable-block-manager-adapter",(function(){return P.awaitBlock(t)})),e.next=6,n;case 6:return e.next=8,r;case 8:return o=e.sent,a=o.BlockManager,s=o.SheetAdapter,u=o.creater,l=[u],P.adapter=new s({editor:null,blockManager:new a(l),undoDispatcher:t.undoDispatcher}),e.abrupt("return",P.adapter);case 17:throw e.prev=17,e.t0=e.catch(0),null===(c=P.spread)||void 0===c||c.getService(N.zv).captureException(e.t0,{key:"BITABLE_BLOCK_MANAGER_ADAPTER_INIT"}),console.error(e.t0),e.t0;case 22:case"end":return e.stop()}}),e,null,[[0,17]])})))),this.invokeBitableBridgeMethod=function(){var e=(0,o.Z)(i().mark((function e(t,n){var r,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=P.getTableIdBySheetId(t)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,P.getBridge();case 5:return o=e.sent,e.abrupt("return",o[n](r));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.getBridge=(0,o.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P.bridge||(P.bridge=P.createBitableBridge((function(){return P.getOrders(_.kHU.BITABLE_BLOCK)}),{getCreatedSource:P.getCreatedSource,setBitableFaster:function(e){return P.blockManager.fasterManager.setBitableFaster(e)},onConflict:function(e){return P.spread.trigger(_.zW2.BitableBlockRejectCommit,e)}})),e.abrupt("return",P.bridge);case 2:case"end":return e.stop()}}),e)}))),this.getCreatedSource=function(e,t){var n=[e,t].join("_");if(P.createSourceMap[n])return P.createSourceMap[n];var r=d.CreatedSource.INSIDE_PAGE;return!!P.spread.getBlockWorksheetIsNew(n)&&(r=d.CreatedSource.USER_INSERT),P.createSourceMap[n]=r,{createdSource:r}},this.updateToken=function(){var e=(0,o.Z)(i().mark((function e(t,n){var r,o,a,s,u,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=P.getBlockIdBySheetId(n)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,P.getAdapter();case 5:if(o=e.sent,!w.Z.checkValid(t,C.Z.LOG.UPDATE_TOKEN_FAIL_INVALID_TOKEN)){e.next=8;break}return e.abrupt("return");case 8:if(!w.Z.checkValid(r,C.Z.LOG.UPDATE_TOKEN_FAIL_INVALID_BLOCKID1)){e.next=10;break}return e.abrupt("return");case 10:if(P.blockDataSetMap.has(r)){e.next=13;break}return w.Z.throwError(C.Z.LOG.UPDATE_TOKEN_FAIL_INVALID_BLOCKID2),e.abrupt("return");case 13:if(a=P.blockDataSetMap.get(r),!w.Z.checkValid(a,C.Z.LOG.UPDATE_TOKEN_FAIL_INVALID_DATA)){e.next=16;break}return e.abrupt("return");case 16:return s=P.parseBlockToken(t),u=s.token,l=s.props,a.token=u,a.props=l,e.next=21,P.triggerBridgeLoadWholeModule(u);case 21:return e.next=23,P.waitForBitableManager;case 23:return e.next=25,o.updateBlock(a);case 25:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.onChannelStateChange=function(){var e=(0,o.Z)(i().mark((function e(t){var n,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=_.kHU.BITABLE_BLOCK,!(0,d.getIsAnonymousAccess)()||!P.bridgeLoaded[n]){e.next=13;break}return e.next=5,P.getBridge();case 5:r=e.sent,e.t0=t,e.next=e.t0===l.NetworkState.offline?9:e.t0===l.NetworkState.online?11:13;break;case 9:return r.disableEdit(),e.abrupt("break",13);case 11:return r.enableEdit(),e.abrupt("break",13);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getTableDataForServerCopy=function(){var e=(0,o.Z)(i().mark((function e(t){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.getBridge();case 2:return n=e.sent,e.next=5,n.getTableDataForServerCopy(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.removeBitableLocalConflictRecord=function(){var e=(0,o.Z)(i().mark((function e(t){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.getBridge();case 2:return n=e.sent,e.next=5,n.removeBitableLocalConflictRecord(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.waitTableClientVarLoaded=function(){var e=(0,o.Z)(i().mark((function e(t){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return e.next=3,P.getBridge();case 3:return n=e.sent,e.next=6,n.waitTableClientVarLoaded(t);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getBitableCSV=function(){var e=(0,o.Z)(i().mark((function e(t){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.invokeBitableBridgeMethod(t,"getBitableCSV");case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getBitableBridgeMD5Token=(0,o.Z)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.getBridge();case 2:return t=e.sent,e.abrupt("return",t.md5Token);case 4:case"end":return e.stop()}}),e)}))),this.notifyBlocksChange=(0,o.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.getBridge();case 2:e.sent.notifyBitablesChange();case 4:case"end":return e.stop()}}),e)})));var L={undoDispatcher:null,onBlockDataChanged:u.default,onViewChange:u.default,onFieldLocalValueChange:u.default,reduxStore:d.store};this.options=Object.assign({},L,{},r),this.waitForBitableManager=new Promise((function(e){return P.waitForBitableManagerResolve=e}))}var t,n,r,m,R,A,O,M,k,I,L,F,B,V,H;return(0,s.Z)(e,[{key:"getBlockIdBySheetId",value:function(e){var t=this.spread.getSheetFromId(e);if(t)return this.blockIds.get(e)||t.blockId||void 0}},{key:"getTableIdBySheetId",value:function(e){var t=this.getBlockIdBySheetId(e);if(t){var n=this.blockDataSetMap.get(t);if(n)return n.props.tableId}}},{key:"createBitableBridge",value:(H=(0,o.Z)(i().mark((function e(t,n){var r,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,S.p)("loadBitableBridge"),e.next=3,(0,d.importBitableBridgeForSheet)();case 3:return o=e.sent,r(),this.bridgeLoaded[_.kHU.BITABLE_BLOCK]=!0,e.abrupt("return",new o(t,n,{pure:this.options.isTemplateMode,store:this.options.reduxStore}));case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return H.apply(this,arguments)})},{key:"getOrders",value:function(e){return this.getBlockInfos().filter((function(t){return t.blockType===e&&t.blockToken})).map((function(e){return{blockId:e.blockId,blockName:e.blockName,tableId:w.Z.processToken(e.blockToken).id,blockSheetId:e.blockSheetId}}))}},{key:"triggerBridgeLoadWholeModule",value:(V=(0,o.Z)(i().mark((function e(){var t,n,r=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:"",e.next=3,this.getBridge();case 3:return n=e.sent,e.next=6,n.loadBitableManager(t);case 6:e.sent&&this.waitForBitableManagerResolve();case 8:case"end":return e.stop()}}),e,this)}))),function(){return V.apply(this,arguments)})},{key:"getBitableCreator",value:(B=(0,o.Z)(i().mark((function e(t){var n,r,o=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getBridge();case 2:return n=e.sent,e.next=5,C.Z.CREATOR.BITABLE();case 5:return r=e.sent,e.abrupt("return",new r({ExternalServices:{onSwitchNewTableView:function(){return o.spread.trigger(_.zW2.SwitchBlockTab)},getBitableBridge:function(){return n},activeBlock:function(e){o.spread.onSetActiveBlock(e)},onBitableChanged:function(e){var n=Array.from(o.blockDataSetMap.values()).filter((function(e){return e.blockType===_.kHU.BITABLE_BLOCK})).find((function(t){return t.props.tableId===e}));n&&t.onBlockDataChanged(n.blockId)},onViewChange:function(){var e;null===(e=t.onViewChange)||void 0===e||e.call(t)},onFieldLocalValueChange:function(){var e;null===(e=t.onFieldLocalValueChange)||void 0===e||e.call(t)},onRecover:function(e){t.onRecover&&t.onRecover(_.kHU.BITABLE_BLOCK,e)},onTableLoaded:t.onTableLoaded||u.default,onBatchUpdateBlockComment:function(){return o.spread.trigger(_.zW2.onBatchUpdateBlockComment)},onStartNewComment:function(e){return o.spread.trigger(_.zW2.onStartNewComment,e)},mountOptions:Object.assign({},t.isHistoryMode?{historyMode:_.Uhd.CONTENT}:{},{},t.mountOptions||{})}}));case 7:case"end":return e.stop()}}),e,this)}))),function(e){return B.apply(this,arguments)})},{key:"destroyBridge",value:(F=(0,o.Z)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.bridge;case 2:null==(t=e.sent)||t.destroy(),this.bridge=void 0;case 5:case"end":return e.stop()}}),e,this)}))),function(){return F.apply(this,arguments)})},{key:"mountBlock",value:(L=(0,o.Z)(i().mark((function e(t,n){var r,o,a,s,u,l=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadedSubjects.has(n)||this.loadedSubjects.set(n,new c.X(!1)),r=function(){var e;null===(e=l.loadedSubjects.get(n))||void 0===e||e.complete(),l.loadedSubjects.delete(n)},e.next=4,this.getAdapter();case 4:if(o=e.sent,a=this.getBlockIdBySheetId(n)){e.next=9;break}return r(),e.abrupt("return",!1);case 9:if(s={blockId:a,blockType:_.kHU.BITABLE_BLOCK,props:{}},u=o.createBlockPlaceholder({blockDataSet:s,options:C.Z.DEFAULT.PLACE_HOLDER_OPTIONS}),!w.Z.checkValid(u,C.Z.LOG.CREATOR_FAIL)){e.next=14;break}return r(),e.abrupt("return",!1);case 14:if(!w.Z.checkValid(t,C.Z.LOG.BLOCK_WRAP_NULL)){e.next=17;break}return r(),e.abrupt("return",!1);case 17:return this.blockDataSetMap.set(s.blockId,s),this.blockIds.set(n,a),u.setAttribute("bitable-block-html","true"),u.style.height="100%",t.appendChild(u),this.triggerBridgeLoadWholeModule(),e.abrupt("return",!0);case 24:case"end":return e.stop()}}),e,this)}))),function(e,t){return L.apply(this,arguments)})},{key:"unmountBlock",value:(I=(0,o.Z)(i().mark((function e(t,n){var r,o,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.getBlockIdBySheetId(t)){e.next=3;break}return e.abrupt("return",!1);case 3:if(n){e.next=5;break}return e.abrupt("return",!0);case 5:if(this.adapter){e.next=7;break}return e.abrupt("return",!1);case 7:if(!w.Z.checkValid(o,C.Z.LOG.DELETE_BLOCK_FAIL_INVALID_BLOCKID1)){e.next=9;break}return e.abrupt("return",!1);case 9:if(this.blockDataSetMap.has(o)){e.next=12;break}return w.Z.throwWarning(C.Z.LOG.DELETE_BLOCK_FAIL_INVALID_BLOCKID2),e.abrupt("return",!1);case 12:if(a=this.blockDataSetMap.get(o),!w.Z.checkValid(a,C.Z.LOG.DELETE_BLOCK_FAIL_INVALID_DATA)){e.next=15;break}return e.abrupt("return",!1);case 15:return this.adapter.deleteBlock(a),this.blockDataSetMap.delete(o),this.blockIds.delete(o),null===(r=this.loadedSubjects.get(t))||void 0===r||r.complete(),this.loadedSubjects.delete(t),this.innerMountedSheetIds.delete(t),this.notifyBlocksChange(),e.abrupt("return",!0);case 23:case"end":return e.stop()}}),e,this)}))),function(e,t){return I.apply(this,arguments)})},{key:"activeBlock",value:(k=(0,o.Z)(i().mark((function e(t){var n,r,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==t){e.next=3;break}return console.log("bitable blocks all inactive."),e.abrupt("return");case 3:if(this.innerMountedSheetIds.has(t)){e.next=13;break}if(n=this.spread.getSheetFromId(t)){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,n.getBlockToken();case 9:if(r=e.sent,n===this.spread.getActiveSheet()){e.next=12;break}return e.abrupt("return");case 12:this.innerMount(t,r);case 13:if(o=this.getTableIdBySheetId(t)){e.next=16;break}return e.abrupt("return");case 16:return e.next=18,this.getBridge();case 18:e.sent.activeBitable(o);case 20:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"addBlock",value:(M=(0,o.Z)(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,f.waitFetchI18N)(f.I18nBizType.BITABLE);case 2:return e.abrupt("return",x(Object.assign({},t,{spread:this.spread})));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return M.apply(this,arguments)})},{key:"delBlock",value:(O=(0,o.Z)(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.unmountBlock(t,!0);case 1:case"end":return e.stop()}}),e,this)}))),function(e){return O.apply(this,arguments)})},{key:"copyBlock",value:(A=(0,o.Z)(i().mark((function e(t){var n,r,o,a,s,u,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,p.collectSuiteEvent)("sheet_tab",{action:"copy_sheet",source:"bottom_bar",eventType:"click",op_item:E.j.Database}),n=this.spread.getSheetFromId(t)){e.next=4;break}return e.abrupt("return");case 4:return r=(0,y.mC6)(this.spread,n.name(),P("sheet.copy_item")),e.next=7,this.getBlockData(t,r);case 7:if(!(o=e.sent)||!o.operations){e.next=14;break}if(a=D(o,(0,g.getBitableActionsSizeLimit)()),s=a.overSize,u=a.size,!s){e.next=14;break}return(0,p.collectSuiteEvent)("client_bitable_execute_command_oversize",{command:"copyBlock",size:u}),_.Ps3.Toast.show({key:"BITABLE_ACTION_OVERSIZE",type:"error",content:P("Bitable_Copy_UnableToCopySheet"),duration:3e3,closable:!0}),e.abrupt("return");case 14:return e.next=16,(0,d.importBitableDefaultActions)();case 16:l=e.sent,this.spread.commandManager().execute({cmd:_.rvF.COPY_BLOCK,copySheetId:n.id(),copyBlockData:JSON.stringify(l.addTableUsingBlockData(o)),sheetName:r});case 18:case"end":return e.stop()}}),e,this)}))),function(e){return A.apply(this,arguments)})},{key:"isBlockLoaded",value:function(e){return this.innerMountedSheetIds.has(e)}},{key:"disableEdit",value:(R=(0,o.Z)(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getBridge();case 2:e.sent.disableEdit();case 4:case"end":return e.stop()}}),e,this)}))),function(e){return R.apply(this,arguments)})},{key:"parseBlockToken",value:function(e){var t={token:e,props:{}},n=w.Z.processToken(e),r=n.token,i=n.id;return t.token=r,t.props.tableId=i,t}},{key:"getCustomMethods",value:function(){return[["getBitableBridgeMD5Token",this.getBitableBridgeMD5Token],["getBitableCSV",this.getBitableCSV],["removeBitableLocalConflictRecord",this.removeBitableLocalConflictRecord],["getTableDataForServerCopy",this.getTableDataForServerCopy]]}},{key:"destroy",value:(m=(0,o.Z)(i().mark((function e(){var t,n=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAdapter();case 2:t=e.sent,this.blockDataSetMap.forEach((function(e,r){t.deleteBlock(e),n.blockDataSetMap.delete(r)})),this.blockDataSetMap.clear(),this.loadedSubjects.forEach((function(e){return e.complete()})),this.loadedSubjects.clear(),t.destory("");case 8:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"getBlockInfos",value:function(){return this.spread.sheets.filter((function(e){return e instanceof y.isD})).map((function(e){return{blockId:e.blockId,blockType:e.blockType,blockToken:e.blockToken,blockName:e.name(),blockSheetId:e.id()}}))}},{key:"getBlockData",value:(r=(0,o.Z)(i().mark((function e(t,n){var r,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.getTableIdBySheetId(t)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.getBridge();case 5:return o=e.sent,e.abrupt("return",o.getBitableData(r,!1,n));case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"innerMount",value:(n=(0,o.Z)(i().mark((function e(t,n){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.updateToken(n,t);case 2:this.innerMountedSheetIds.add(t),null===(r=this.loadedSubjects.get(t))||void 0===r||r.next(!0),this.notifyBlocksChange();case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"applyTemplate",value:(t=(0,o.Z)(i().mark((function e(t,n){var r,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.getTableIdBySheetId(t)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.getBridge();case 5:return o=e.sent,e.next=8,o.applyBitableTemplate({templateToken:n,tableId:r});case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"getLoadedSubject",value:function(e){return this.loadedSubjects.get(e)}},{key:"hasSheet",value:function(e){return this.loadedSubjects.has(e)}}],[{key:"parseToken",value:function(e,t){return e===_.kHU.BITABLE_BLOCK?w.Z.processToken(t):{token:t}}}]),e}();function D(e,t){var n=!1,r=-1;try{var i=JSON.stringify(e);n=(r=(0,m.xEU)(i))>t}catch(e){n=!0}return{overSize:n,size:r}}},vsh_37224:function(e,t,n){"use strict";var r,i=n("vsh_67017"),o=n.n(i),a=n("vsh_35067"),s=n("vsh_24627");t.Z={DEFAULT:{BLOCK_WRAP:"div",PLACE_HOLDER_OPTIONS:{renderDirectly:!0},BITABLE_BLOCK_TYPE:s.kHU.BITABLE_BLOCK},CREATOR:{BITABLE:(r=(0,a.Z)(o().mark((function e(){var t,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("vsh_4670"),n.e("vsh_7554"),n.e("vsh_3168")]).then(n.t.bind(n,"vsh_33580",23));case 2:return t=e.sent,r=t.BitableCreator,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},LOG:{PREFIX:"[BlockMgr]",ADAPTER_NULL:"adapter is null",BLOCK_WRAP_NULL:"block wrap create fail!",CREATOR_FAIL:"can not createBlockContainer(0)",UPDATE_TOKEN_FAIL_INVALID_TOKEN:"updateToken fail! the token is invalid",UPDATE_TOKEN_FAIL_INVALID_BLOCKID1:"updateToken fail! the blockid is invalid(1)",UPDATE_TOKEN_FAIL_INVALID_BLOCKID2:"updateToken fail! the blockid is invalid(2)",UPDATE_TOKEN_FAIL_INVALID_DATA:"updateToken fail! the data is invalid",DELETE_BLOCK_FAIL_INVALID_BLOCKID1:"delete block fail! the blockid in invalid(1)",DELETE_BLOCK_FAIL_INVALID_BLOCKID2:"delete block fail! the blockid in invalid(2)",DELETE_BLOCK_FAIL_INVALID_DATA:"delete block fail! the data is invalid"}}},vsh_28213:function(e,t,n){"use strict";n.d(t,{p:function(){return i}});var r=performance&&performance.now?function(){return performance.now()}:function(){return Number(new Date)},i=function(e,t){var n=r();return function(){var i=Math.floor(r()-n);return e&&console.log("timeTracking::[".concat(e,"] [").concat(i,"] "),t),i}}},vsh_70231:function(e,t,n){"use strict";n.d(t,{Z:function(){return ie}});var r,i=n("vsh_98652"),o=n("vsh_74561"),a=n("vsh_1139"),s=n("vsh_67017"),u=n.n(s),l=n("vsh_35067"),c=n("vsh_19264"),h=n("vsh_4175"),d=n("vsh_71484"),f=n("vsh_56450"),p=n("vsh_96579"),v=n("vsh_24627"),g=n("vsh_72834"),_=n("vsh_7273"),y=n("vsh_47253"),m=n("vsh_82898"),E=n("vsh_13867"),b=n("vsh_89443"),T=n("vsh_93301"),C=n("vsh_69691"),S=n("vsh_27185"),w=n.n(S),R=n("vsh_60505"),A=n("vsh_18801"),O=n("vsh_22488"),M=n("vsh_18856"),k=n("vsh_14801"),I=n("vsh_43350"),x=n("vsh_13885"),N=n("vsh_22758"),P=n("vsh_28213"),L=n("vsh_64299"),D=(0,l.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=2;break}return e.abrupt("return",r);case 2:return e.next=4,(0,A.importDocx)();case 4:return e.abrupt("return",r=e.sent);case 5:case"end":return e.stop()}}),e)}))),F=function(){var e,t=function(){var e=(0,l.Z)(u().mark((function e(){var t,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D();case 2:return t=e.sent,e.next=5,t.bridge();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,l.Z)(u().mark((function n(){var r;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e){n.next=2;break}return n.abrupt("return",e);case 2:return r=(0,P.p)("loadDocxBridge"),n.next=5,t();case 5:return e=n.sent,r(),n.abrupt("return",e);case 8:case"end":return n.stop()}}),n)})))}(),B=w()("DocxInstanceManager"),V=function(){function e(){(0,c.Z)(this,e),this.ids=[],this.instanceProps=new Map,this.activeIds=new Set,this.mountedIds=new Set,this.loadedSubjects=new Map,this.updating=!1}var t;return(0,h.Z)(e,[{key:"createEmbedDocxInstance",value:function(e){var t=(0,v.EsU)();return B("[createEmbedDocxInstance] id: ".concat(t)),this.ids.push(t),this.instanceProps.set(t,e),this.loadedSubjects.set(t,new L.X(!1)),this.update(),t}},{key:"getInstance",value:function(e){return e===this.getTargetInstanceId()?this.curInstance:void 0}},{key:"activate",value:function(e){B("[activate] id: ".concat(e)),this.activeIds.add(e),this.update()}},{key:"inactivate",value:function(e){B("[inactivate] id: ".concat(e)),this.activeIds.delete(e),this.update()}},{key:"destroyInstance",value:function(e){var t,n;(B("[destroyInstance] id: ".concat(e)),e===this.curInstanceId)&&(this.curInstance&&B("[actrually destroy] id: ".concat(this.curInstanceId)),null===(n=this.curInstance)||void 0===n||n.destroy(),this.curInstance=void 0,this.curInstanceId=void 0,this.curInstanceMounted=!1);this.instanceProps.delete(e),this.activeIds.delete(e),this.mountedIds.delete(e),null===(t=this.loadedSubjects.get(e))||void 0===t||t.complete(),this.loadedSubjects.delete(e),this.ids=this.ids.filter((function(t){return e!==t})),this.update()}},{key:"isMounted",value:function(e){return this.mountedIds.has(e)}},{key:"getTargetInstanceId",value:function(){return this.ids[this.ids.length-1]}},{key:"update",value:(t=(0,l.Z)(u().mark((function e(){var t,n,r,i,o,a,s,l,c,h,d,f,p,v;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.updating){e.next=2;break}return e.abrupt("return");case 2:if(this.updating=!0,i=this.getTargetInstanceId()){e.next=12;break}return this.curInstance&&B("[actrually destroy] id: ".concat(this.curInstanceId)),null===(o=this.curInstance)||void 0===o||o.destroy(),this.curInstance=void 0,this.curInstanceId=void 0,this.curInstanceMounted=!1,this.updating=!1,e.abrupt("return");case 12:if(this.curInstanceId===i){e.next=35;break}return this.curInstance&&(B("[actrually destroy] id: ".concat(this.curInstanceId)),this.curInstance.destroy(),null===(a=this.loadedSubjects.get(this.curInstanceId))||void 0===a||a.next(!1),this.curInstance=void 0),this.curInstanceId=void 0,this.curInstanceMounted=!1,e.next=18,F();case 18:if(s=e.sent,this.getTargetInstanceId()===i){e.next=23;break}return this.updating=!1,this.update(),e.abrupt("return");case 23:if(l=this.instanceProps.get(i)){e.next=26;break}return e.abrupt("return");case 26:return B("[actrually createEmbedDocx] id: ".concat(i)),e.next=29,s.createEmbedDocx(l.docxToken,l.options);case 29:if(this.curInstance=e.sent,this.curInstanceId=i,this.getTargetInstanceId()===i){e.next=35;break}return this.updating=!1,this.update(),e.abrupt("return");case 35:if(!this.activeIds.has(i)||this.curInstanceMounted){e.next=50;break}if(f=null===(c=this.instanceProps.get(i))||void 0===c?void 0:c.getMountPoint(),B("[actrually mount] id: ".concat(i)),e.t0=f,!e.t0){e.next=43;break}return e.next=43,null===(h=this.curInstance)||void 0===h?void 0:h.mount(f);case 43:if(this.curInstanceMounted=!0,this.mountedIds.add(i),null===(d=this.loadedSubjects.get(i))||void 0===d||d.next(!0),this.getTargetInstanceId()===i){e.next=50;break}return this.updating=!1,this.update(),e.abrupt("return");case 50:p=this.activeIds.has(i),this.curInstance&&B("[actrually toggleActive] to: ".concat(p,", id: ").concat(i)),null===(t=this.curInstance)||void 0===t||t.toggleActive(p),(v=null===(n=this.instanceProps.get(i))||void 0===n||null===(r=n.options.shareState)||void 0===r?void 0:r.permission)&&this.updateOptions(i,{shareState:{permission:v}}),this.updating=!1;case 56:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"updateOptions",value:function(e,t){var n=this.instanceProps.get(e);if(n){var r,i=(0,m.Z)(n,{options:t});if(this.instanceProps.set(e,i),this.curInstanceId===e&&this.curInstanceMounted&&this.activeIds.has(e))null===(r=this.curInstance)||void 0===r||r.update(t)}}},{key:"getLoadedSubject",value:function(e){return this.loadedSubjects.get(e)}}]),e}(),H=new V,U=n("vsh_73043"),Z=w()("DocxBlockManager"),W=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Z.apply(void 0,[e].concat(n))}},j="docx_",G=function(){function e(t,n,r){var i,o,s=this;(0,c.Z)(this,e),this.spread=n,this.options=r,this.instanceManager=H,this.instanceIds=new Map,this.mountPoints=new Map,this.commentManager={setCommentData:W("setCommentData"),getCommentPositions:W("getCommentPositions"),reopenComment:W("reopenComment"),startNewComment:W("startNewComment"),resolveComment:W("resolveComment"),removeComment:W("removeComment"),activateComment:W("activateComment")},this.mentionManager={locateMention:W("locateMention")},this.historyManager={exitHistory:(o=(0,l.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Z("exitHistory"));case 1:case"end":return e.stop()}}),e)}))),function(){return o.apply(this,arguments)}),previewHistory:(i=(0,l.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Z("previewHistory"));case 1:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)}),recoverHistory:W("recoverHistory"),previewDocxOwnHistory:function(){Z("previewDocxOwnHistory");var e=s.instanceManager.getInstance(s.instanceIds.get(s.sheetId));null==e||e.toggleHistory(!0)}},this.translateManager={enterTranslateMode:W("enterTranslateMode"),exitTranslateMode:W("exitTranslateMode")},this.viewportManager={setBlockHeight:W("setBlockHeight"),scrollTo:function(e){var t,n=s.instanceManager.getInstance(s.instanceIds.get(s.sheetId));return null==n||null===(t=n.locateWithAnchorInfo)||void 0===t?void 0:t.call(n,e)}},this.effectManager={onEditorMounted:function(){s.eventTrackingForMount&&s.eventTrackingForMount();var e=location.search,t=(0,R.parse)(e.slice(1)),n=s.parseAnchorLink(t);n&&s.viewportManager.scrollTo(n)}},this.parseBlockToken=W("parseBlockToken"),this.getAnchorLink=function(e){var t;if((0,b.Z)(e)){var n=(t=e,Object.keys(t).filter((function(e){var n=t[e];return(0,E.Z)(n)||(0,T.default)(n)})).map((function(e){return["".concat(j).concat(e),t[e]]})).reduce((function(e,t){var n=(0,a.Z)(t,2),r=n[0],i=n[1];return e[r]=i,e}),{})),r=location.search,i=(0,R.parse)(r.slice(1)).sheet,o=Object.assign({},n,{sheet:i});return"".concat(location.origin).concat(location.pathname,"?").concat((0,R.stringify)(o))}throw new Error("getAnchorLink params is error ")},this.parseAnchorLink=function(e){try{var t=new RegExp("^".concat(j)),n=Object.keys(e).filter((function(e){return t.test(e)}));if(n.length)return n.reduce((function(t,n){var r=e[n];return t[n.replace("".concat(j),"")]=r,t}),{})}catch(e){console.error("docx parseAnchorLink error.")}return null},this.createToken=(0,l.Z)(u().mark((function e(){var t,n,r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F();case 3:return n=e.sent,e.next=6,n.createDocxToken({parent_token:(0,O.getToken)(),parent_type:(0,O.suiteTypeNum)(),sub_type:5});case 6:if(r=e.sent,t=r.data.meta.token){e.next=10;break}throw new Error("token is null");case 10:e.next=17;break;case 12:throw e.prev=12,e.t0=e.catch(0),console.log(e.t0),f.toast.warning(U("CreationDoc_Tasks_FailedToCreateTaskTryAgain_Toast")),new Error("createDocxToken error");case 17:return e.abrupt("return",t);case 18:case"end":return e.stop()}}),e,null,[[0,12]])}))),this.mountBlock=function(){var e=(0,l.Z)(u().mark((function e(t,n,r){var i,o,a,l,c,h,d,f,p,v,g;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=s.options,o=i.isHistoryMode,a=i.isTemplateMode,l=s.options.isTranslateMode||(null==r?void 0:r.isTranslateMode),c=(0,O.waitFetchI18N)(O.I18nBizType.FULL),e.prev=3,n&&t&&!O.browser.isInVC&&!l){e.next=6;break}return e.abrupt("return",!1);case 6:if(!s.instanceIds.has(n)){e.next=8;break}return e.abrupt("return",!0);case 8:if(Z("mountBlock",n),s.sheetId=n,s.mountPoints.set(n,t),h=A.store.getState(),d=s.spread.getSheetFromId(n),f=d.blockToken){e.next=16;break}return e.abrupt("return",!1);case 16:return p=(0,m.Z)(Object.assign({hostBusiness:"sheet"},s.options),{hostScene:s.hostScene,injectModule:{getAnchorLink:s.getAnchorLink,activeBlock:function(e){s.spread.onSetActiveBlock(e)}},event:{onEditorMounted:s.effectManager.onEditorMounted},shareState:{permission:{editPermission:!(o||a||l||!(0,x.editableWithSheetPermissionSelector)(h)),copyable:(0,N.S)(),commentable:!1,exportable:!!(0,M.selectCurrentSuiteOtherPermissions)(h).exportable}}}),Z("createEmbedDocx"),v=(0,P.p)("createEmbedDocxInstance",{sheetId:n}),g=s.instanceManager.createEmbedDocxInstance({docxToken:f,options:p,getMountPoint:function(){return s.mountPoints.get(n)}}),v(),s.instanceIds.set(n,g),s.isBlockActive(n)&&(s.eventTrackingForMount=(0,P.p)("instance.mount",{sheetId:n,instanceId:g}),s.instanceManager.activate(g)),e.next=25,c;case 25:return e.abrupt("return",!0);case 28:return e.prev=28,e.t0=e.catch(3),Z("mountBlock error",e.t0),e.abrupt("return",!1);case 32:case"end":return e.stop()}}),e,null,[[3,28]])})));return function(t,n,r){return e.apply(this,arguments)}}(),this.activeBlock=function(){var e=(0,l.Z)(u().mark((function e(t,n){var r,i,o,a,l,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Z("activeBlock",t),!t||!O.browser.isInVC){e.next=5;break}return"Record"===(null===(a=window)||void 0===a||null===(l=a.vcSdk)||void 0===l?void 0:l.status)&&f.toast.warning(U("LarkCCM_Sheets_NewDoc_MsNa_Toast")),e.abrupt("return");case 5:if(Z("start activeBlock"),c=s.instanceIds.get(t||void 0),t&&c){e.next=10;break}return s.instanceIds.forEach((function(e){return s.instanceManager.inactivate(e)})),e.abrupt("return");case 10:null===(r=s.options)||void 0===r||null===(i=r.shareState)||void 0===i||null===(o=i.store)||void 0===o||o.dispatch((0,k.setHelpBtnVisible)(!1)),s.eventTrackingForMount=(0,P.p)("instance.mount",{sheetId:t,instanceId:c}),s.instanceIds.forEach((function(e){return e!==c&&s.instanceManager.inactivate(e)})),s.instanceManager.activate(c),s.updatePermission();case 15:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.addBlock=function(){var e=(0,l.Z)(u().mark((function e(t){var n,r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!s.limitCount()){e.next=9;break}if(e.t0=t.blockToken,e.t0){e.next=6;break}return e.next=5,s.createToken();case 5:e.t0=e.sent;case 6:return n=e.t0,r={sheetName:t.sheetName,index:t.index,blockId:t.blockId,cmd:v.rvF.ADD_BLOCK,blockType:v.kHU.DOCX_BLOCK,blockToken:n},e.abrupt("return",s.spread.commandManager().execute(r));case 9:return e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.delBlock=function(){var e=(0,l.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Z("delBlock",t),s.unmountBlock(t,!0);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.copyBlock=W("copyBlock"),this.onChannelStateChange=W("onChannelStateChange"),this.disableEdit=W("disableEdit"),this.applyTemplate=W("applyTemplate"),this.limitCount=function(){return 0===s.spread.sheets.filter((function(e){return e.blockType===v.kHU.DOCX_BLOCK})).length},this.memorizedUpdateEmbedDocx=(0,I.HP)((function(e,t,n,r){s.instanceIds.forEach((function(i){return s.instanceManager.updateOptions(i,{shareState:{permission:{editPermission:e,commentable:n,copyable:t,exportable:r}}})}))})),this.updatePermission=(0,y.default)((function(){var e=A.store.getState(),t=!s.options.isHistoryMode&&!!(0,x.editableWithSheetPermissionSelector)(e),n=(0,N.S)(),r=!!(0,M.selectCurrentSuiteOtherPermissions)(e).exportable;s.memorizedUpdateEmbedDocx(t,n,!1,r)}),30),this.subscribePermission()}var t,n;return(0,h.Z)(e,[{key:"isBlockActive",value:function(e){var t;return!!e&&(null===(t=this.spread.getActiveSheet())||void 0===t?void 0:t.id())===e}},{key:"unmountBlock",value:(n=(0,l.Z)(u().mark((function e(t,n){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Z("unmountBlock",t),this.eventTrackingForMount=null,n){e.next=4;break}return e.abrupt("return",!0);case 4:if(this.instanceIds.has(t)){e.next=6;break}return e.abrupt("return",!0);case 6:return this.instanceManager.destroyInstance(this.instanceIds.get(t)),this.instanceIds.delete(t),e.abrupt("return",!0);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"isBlockLoaded",value:function(e){return this.instanceManager.isMounted(this.instanceIds.get(e))}},{key:"destroy",value:(t=(0,l.Z)(u().mark((function e(){var t,n=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Z("destroy"),null===(t=this.unSubsribePermission)||void 0===t||t.call(this),this.instanceIds.forEach((function(e){return n.instanceManager.destroyInstance(e)})),this.instanceIds.clear(),this.mountPoints.clear(),e.abrupt("return");case 6:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"getCustomMethods",value:function(){return[["scrollTo",this.viewportManager.scrollTo],["previewDocxOwnHistory",this.historyManager.previewDocxOwnHistory]]}},{key:"subscribePermission",value:function(){var e=this;this.unSubsribePermission=A.store.subscribe((function(){e.options.isTranslateMode||e.options.isTemplateMode||e.options.isHistoryMode||e.instanceIds.size&&e.updatePermission()}))}},{key:"hasSheet",value:function(e){return this.instanceIds.has(e)}},{key:"getLoadedSubject",value:function(e){return this.instanceManager.getLoadedSubject(this.instanceIds.get(e))}},{key:"hostScene",get:function(){return C.isShortCutServer?"shortcut":this.options.isTemplateMode?"preview":"normal"}}]),e}(),z=function(){function e(t){(0,c.Z)(this,e),this.getBlockManagerImpBySheetId=t.getBlockManagerImpBySheetId}var t,n,r,i,o,a,s;return(0,h.Z)(e,[{key:"setCommentData",value:(s=(0,l.Z)(u().mark((function e(t,n){var r,i,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(r=this.getBlockManagerImpBySheetId(t))||void 0===r||null===(i=(o=r.commentManager).setCommentData)||void 0===i?void 0:i.call(o,t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"getCommentPositions",value:(a=(0,l.Z)(u().mark((function e(t){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(n=this.getBlockManagerImpBySheetId(t))||void 0===n?void 0:n.commentManager.getCommentPositions(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"reopenComment",value:(o=(0,l.Z)(u().mark((function e(t,n){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(r=this.getBlockManagerImpBySheetId(t))||void 0===r?void 0:r.commentManager.reopenComment(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"startNewComment",value:(i=(0,l.Z)(u().mark((function e(t,n){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(r=this.getBlockManagerImpBySheetId(t))||void 0===r?void 0:r.commentManager.startNewComment(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"resolveComment",value:(r=(0,l.Z)(u().mark((function e(t,n){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(r=this.getBlockManagerImpBySheetId(t))||void 0===r?void 0:r.commentManager.resolveComment(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"removeComment",value:(n=(0,l.Z)(u().mark((function e(t,n){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(r=this.getBlockManagerImpBySheetId(t))||void 0===r?void 0:r.commentManager.removeComment(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"activateComment",value:(t=(0,l.Z)(u().mark((function e(t,n){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(r=this.getBlockManagerImpBySheetId(t))||void 0===r?void 0:r.commentManager.activateComment(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]),e}(),Y=function(){function e(){(0,c.Z)(this,e),this.fasterBlockType=null}return(0,h.Z)(e,[{key:"setCanvasReuseSwitcher",value:function(e){this.canvasReuseSwitcher=e}},{key:"getCanvasReuseSwitcher",value:function(){return this.canvasReuseSwitcher}},{key:"setSheetFaster",value:function(e){this.sheetFaster=e}},{key:"setBitableFaster",value:function(e){this.bitableFaster=e}},{key:"switchBlockType",value:function(e){e!==this.fasterBlockType&&(this.fasterBlockType=e,this.canvasReuseSwitcher&&(e===v.kHU.BITABLE_BLOCK&&this.bitableFaster?this.canvasReuseSwitcher.wakeup(this.bitableFaster):this.sheetFaster&&this.canvasReuseSwitcher.wakeup(this.sheetFaster)))}},{key:"destroy",value:function(){var e;null===(e=this.canvasReuseSwitcher)||void 0===e||e.destroy()}}]),e}(),X=function(){function e(t){(0,c.Z)(this,e),this.blockManagerImps=t.blockManagerImps}var t,n,r;return(0,h.Z)(e,[{key:"exitHistory",value:(r=(0,l.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,i.Z)(this.blockManagerImps.values()).map((function(e){return e.historyManager.exitHistory()}));case 1:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"previewHistory",value:(n=(0,l.Z)(u().mark((function e(t,n){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(r=this.blockManagerImps.get(t))||void 0===r?void 0:r.historyManager.previewHistory(n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"recoverHistory",value:(t=(0,l.Z)(u().mark((function e(t,n){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(r=this.blockManagerImps.get(t))||void 0===r?void 0:r.historyManager.recoverHistory(n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]),e}(),K=n("vsh_14071"),q=function(){function e(t){(0,c.Z)(this,e),this.getBlockManagerImpBySheetId=t.getBlockManagerImpBySheetId,this.getSpread=t.getSpread}var t;return(0,h.Z)(e,[{key:"locateMention",value:(t=(0,l.Z)(u().mark((function e(t,n){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(r=this.getBlockManagerImpBySheetId(t))||void 0===r?void 0:r.mentionManager.locateMention(t,n);case 2:return e.abrupt("return",!!e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"getMentionSheet",value:function(e){var t=this.getSpread();try{var n=JSON.parse(e).source_file_type;if(!n)return;var r=JSON.parse(n).tableId;if(!r)return;return t.sheets.filter((function(e){return e.blockType===v.kHU.BITABLE_BLOCK&&K.Z.processToken(e.blockToken||"").id===r})).map((function(e){return e.id()})).pop()}catch(e){return}}}]),e}(),$=function(){function e(t){(0,c.Z)(this,e),this.blockManagerImps=t.blockManagerImps}var t,n;return(0,h.Z)(e,[{key:"enterTranslateMode",value:(n=(0,l.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all((0,i.Z)(this.blockManagerImps.values()).map((function(e){return e.translateManager.enterTranslateMode()}))));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"exitTranslateMode",value:(t=(0,l.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all((0,i.Z)(this.blockManagerImps.values()).map((function(e){return e.translateManager.exitTranslateMode()}))));case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),J=function(){function e(t){(0,c.Z)(this,e),this.blockManagerImps=t.blockManagerImps}var t;return(0,h.Z)(e,[{key:"setBlockHeight",value:(t=(0,l.Z)(u().mark((function e(t,n){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(r=this.blockManagerImps.get(t))||void 0===r?void 0:r.viewportManager.setBlockHeight(n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]),e}(),Q=n("vsh_82905"),ee=n("vsh_73043");function te(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ne(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ne(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var re=function(){function e(t,n){var r,i=this;(0,c.Z)(this,e),this.spread=t,this.imps=new Map,this.customMethods=new Map,this.getImpBySheetId=function(e){var t=i.spread.getSheetFromId(e);if(t){var n=null==t?void 0:t.blockType;if(n)return i.imps.get(n)}else{var r,o=te(i.imps.values());try{for(o.s();!(r=o.n()).done;){var a=r.value;if(a.hasSheet(e))return a}}catch(e){o.e(e)}finally{o.f()}}},this.contextProvider={blockManagerImps:this.imps,getBlockManagerImpBySheetId:this.getImpBySheetId,getSpread:function(){return i.spread}},this.commentManager=new z(this.contextProvider),this.translateManager=new $(this.contextProvider),this.historyManager=new X(this.contextProvider),this.mentionManager=new q(this.contextProvider),this.viewportManager=new J(this.contextProvider),this.fasterManager=new Y,this.mountNodeStack=new Map,this.onChannelStateChange=function(){var e=(0,l.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.imps.forEach((function(e){return e.onChannelStateChange(t)}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.onSpreadEvent=function(){},this.imps.set(v.kHU.BITABLE_BLOCK,new _.V(this,this.spread,n)),this.imps.set(v.kHU.DOCX_BLOCK,new G(this,this.spread,{injectModule:{undoDispatcher:n.undoDispatcher},shareState:{},isHistoryMode:n.isHistoryMode,isTemplateMode:n.isTemplateMode,isTranslateMode:null===(r=n.mountOptions)||void 0===r?void 0:r.isTranslateMode})),this.imps.forEach((function(e,t){e.getCustomMethods().forEach((function(e){var n=(0,a.Z)(e,2),r=n[0],o=n[1];i.registerCustomMethod(r,{method:o,blockType:t})}))})),this.unsubscribe=K.Z.createLifeHook((function(){var e,n=t.subscribe((e={},(0,o.Z)(e,v.Fsj.BeforeApply,(function(e){var t=e.actions;e.fromUndoRedo,e.local;t.forEach((function(e){if(e.action===v.aOo.DEL_BLOCK){var t,n=e.sheet_id;i.delBlockInner(n),null===(t=i.getImpBySheetId(n))||void 0===t||t.delBlock(n)}}))})),(0,o.Z)(e,v.HaZ.LimitDocx,(function(){f.toast.warning(ee("LarkCCM_Sheets_NewDoc_MaxTabs_Toast"))})),e));return function(){n.unsubscribe()}}))}var t,n,r,s,y,m,E,b,T;return(0,h.Z)(e,[{key:"isSupport",value:function(e){return this.imps.has(e)}},{key:"registerCustomMethod",value:function(e,t){if(this.customMethods.has(e)){var n="[BlockManager.registerCustomMethod] 重复注册 ".concat(e," 方法，已放弃执行注册，请排查问题。");return console.error(n),void p.moirae.ravenCatch(new Error(n))}this.customMethods.set(e,t)}},{key:"log",value:function(e){this.spread.getService(Q.QX).log("BlockManager",e)}},{key:"delBlockInner",value:function(e){var t=this.mountNodeStack.get(e);t&&(t.wrapNode.remove(),t.parents.length=0,this.mountNodeStack.delete(e)),this.log("delBlockInner ".concat(e,", stackInfo exists: ").concat(!!t))}},{key:"mountBlock",value:(T=(0,l.Z)(u().mark((function e(t,n,r){var i,o,a,s,l,c,h,f;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.spread.getSheetFromId(n),a=(null==o?void 0:o.blockType)||void 0){e.next=4;break}return e.abrupt("return",!1);case 4:if((s=this.mountNodeStack.get(n))||((l=document.createElement("div")).setAttribute("id","block-wrap-node-".concat(n)),l.classList.add("block-wrap-node"),l.style.height="100%",l.style.width="100%",s={parents:[],wrapNode:l},this.mountNodeStack.set(n,s)),!s.parents.includes(t)){e.next=8;break}return e.abrupt("return",!0);case 8:if(c=s.parents.length>0&&(0,d.Z)(s.parents).contains(s.wrapNode),s.parents.push(t),t.appendChild(s.wrapNode),!c){e.next=13;break}return e.abrupt("return",!0);case 13:return h=(0,P.p)("mountBlock",{sheetId:n,blockType:a}),e.next=16,null===(i=this.imps.get(a))||void 0===i?void 0:i.mountBlock(s.wrapNode,n,r);case 16:return f=e.sent,h(),e.abrupt("return",f||!1);case 19:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return T.apply(this,arguments)})},{key:"unmountBlock",value:(b=(0,l.Z)(u().mark((function e(t,n){var r,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((i=this.mountNodeStack.get(t))&&i.parents.length>0)){e.next=11;break}if(i.parents.pop(),!(i.parents.length>0)){e.next=9;break}return i.parents[i.parents.length-1].appendChild(i.wrapNode),e.abrupt("return",!0);case 9:i.wrapNode.remove(),this.mountNodeStack.delete(t);case 11:return e.abrupt("return",(null===(r=this.getImpBySheetId(t))||void 0===r?void 0:r.unmountBlock(t,!(n&&n.isTranslateMode)))||!1);case 12:case"end":return e.stop()}}),e,this)}))),function(e,t){return b.apply(this,arguments)})},{key:"activeBlock",value:(E=(0,l.Z)(u().mark((function e(t){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==t){e.next=3;break}return this.imps.forEach((function(e){return e.activeBlock(null)})),e.abrupt("return");case 3:if(n=this.getImpBySheetId(t)){e.next=6;break}return e.abrupt("return");case 6:this.imps.forEach(function(){var e=(0,l.Z)(u().mark((function e(r){var i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r!==n){e.next=6;break}return i=(0,P.p)("activeBlock",{sheetId:t}),e.next=4,r.activeBlock(t);case 4:return i(),e.abrupt("return");case 6:return e.next=8,r.activeBlock(null);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:case"end":return e.stop()}}),e,this)}))),function(e){return E.apply(this,arguments)})},{key:"addBlock",value:(m=(0,l.Z)(u().mark((function e(t){var n,r,i,o,a,s,l,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=void 0===t.index?this.spread.sheets.length:t.index,r=t.sheetName||this.spread._getDefaultSheetName(),this.spread.getSheetFromName(r)&&(r=(0,g.mC6)(this.spread,r,ee("sheet.copy_item"))),i=this.createBlockId(),o=(0,P.p)("addBlock",{blockToken:t.blockToken}),e.t0=t.tabType,e.next=e.t0===g.AOr.Form||e.t0===g.AOr.Gallery||e.t0===g.AOr.Gantt||e.t0===g.AOr.Grid||e.t0===g.AOr.Kanban||e.t0===g.AOr.Calendar||e.t0===g.AOr.Template?8:e.t0===v.kHU.DOCX_BLOCK?13:18;break;case 8:return e.next=10,null===(a=this.imps.get(v.kHU.BITABLE_BLOCK))||void 0===a?void 0:a.addBlock(Object.assign({},t,{index:n,sheetName:r,blockId:i}));case 10:return s=e.sent,o(),e.abrupt("return",s);case 13:return e.next=15,null===(l=this.imps.get(v.kHU.DOCX_BLOCK))||void 0===l?void 0:l.addBlock(Object.assign({},t,{index:n,sheetName:r,blockId:i}));case 15:return c=e.sent,o(),e.abrupt("return",c);case 18:o();case 19:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"delBlock",value:(y=(0,l.Z)(u().mark((function e(t){var n,r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=this.spread.getSheetFromId(t))&&n instanceof g.isD){e.next=6;break}return r="[BlockManager] delBlock， sheet ".concat(t," 不存在，无法删除"),console.error(r),p.moirae.ravenCatch(new Error(r)),e.abrupt("return");case 6:this.spread.commandManager().execute({cmd:v.rvF.DEL_BLOCK,sheetId:t}),this.delBlockInner(t);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"copyBlock",value:(s=(0,l.Z)(u().mark((function e(t){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(n=this.getImpBySheetId(t))||void 0===n?void 0:n.copyBlock(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"isBlockLoaded",value:function(e){var t;return!(null===(t=this.getImpBySheetId(e))||void 0===t||!t.isBlockLoaded(e))}},{key:"applyTemplate",value:(r=(0,l.Z)(u().mark((function e(t,n){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(r=this.getImpBySheetId(t))||void 0===r?void 0:r.applyTemplate(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"disableEdit",value:(n=(0,l.Z)(u().mark((function e(t){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(n=this.imps.get(t))||void 0===n?void 0:n.disableEdit(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"createBlockId",value:function(){return K.Z.createBlockId()}},{key:"parseBlockToken",value:function(e,t){var n;return null===(n=this.imps.get(e))||void 0===n?void 0:n.parseBlockToken(t)}},{key:"getLoadedSubject",value:function(e){var t;return null===(t=this.getImpBySheetId(e))||void 0===t?void 0:t.getLoadedSubject(e)}},{key:"invokeCustomMethod",value:function(e){var t=this.customMethods.get(e);if(!t){var n="[BlockManager.invokeCustomMethod] 命中 ".concat(e," 方法失败，无此方法。");return console.error(n),void p.moirae.ravenCatch(new Error(n))}var r=this.spread.getActiveSheet(),i=r.blockType;if(t.blockType===i){for(var o=arguments.length,a=new Array(o>1?o-1:0),s=1;s<o;s++)a[s-1]=arguments[s];var u=(0,P.p)("invokeCustomMethod-".concat(e),a),l=t.method.apply(t,a);return l&&l.finally?l.finally(u):u(),l}var c="[BlockManager.invokeCustomMethod] 命中 ".concat(e," 方法失败，当前激活页签与注册类型不一致。");console.error(c)}},{key:"destroy",value:(t=(0,l.Z)(u().mark((function e(){var t,n,r=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.customMethods.clear(),this.mountNodeStack.forEach((function(e,t){r.delBlockInner(t)})),this.mountNodeStack.clear(),t=(0,i.Z)(this.imps.values()),e.next=6,Promise.all(t.map((function(e){return e.destroy()})));case 6:return n=e.sent,this.imps.clear(),this.fasterManager.destroy(),this.unsubscribe(),e.abrupt("return",n);case 11:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}],[{key:"parseToken",value:function(e,t){return e===v.kHU.BITABLE_BLOCK?_.V.parseToken(e,t):{token:t}}}]),e}(),ie=re},vsh_14071:function(e,t,n){"use strict";var r=n("vsh_1139"),i=n("vsh_45617"),o=n("vsh_37224");t.Z={throwError:function(e){console.error("".concat(o.Z.LOG.PREFIX).concat(e))},throwWarning:function(e){console.warn("".concat(o.Z.LOG.PREFIX).concat(e))},checkValid:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return!e&&(t&&this.throwError(t),!0)},createBlockId:function(){return(0,i.v4)()},processToken:function(e){var t="",n="";if("string"==typeof e){var i=e.split(/_/,2),o=(0,r.Z)(i,2);t=o[0],n=o[1]}return{token:t,id:n}},createMountStatusManager:function(){return{mountNode:undefined,isMounted:!1,instanceBlock:undefined}},createLifeHook:function(e){return e()}}},vsh_11042:function(e,t,n){"use strict";n.d(t,{uE:function(){return T},k$:function(){return C},GF:function(){return w},dp:function(){return M},Sb:function(){return D}});var r=n("vsh_67017"),i=n.n(r),o=n("vsh_35067"),a=n("vsh_13867"),s=n("vsh_93301"),u=n("vsh_12484"),l=n("vsh_32841"),c=n("vsh_24627"),h=n("vsh_34539"),d=n.n(h),f=n("vsh_89992"),p=n("vsh_72834"),v=n("vsh_63738"),g=n("vsh_18043"),_=n("vsh_18801"),y=n("vsh_45003"),m=n("vsh_63888"),E=n("vsh_46544"),b=n("vsh_73043");function T(e,t){return(0,c.hdC)(t)+(e+1)}function C(e,t,n,r,i,o){return S.apply(this,arguments)}function S(){return(S=(0,o.Z)(i().mark((function e(t,n,r,o,a,s){var c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.request.get(u.GET_SHEET_CELL_HISTORIES,{params:{token:t,sheet_id:n,row:r,col:o,max_revision:a,page_size:s||10}});case 2:if(c=e.sent,0!==c.code){e.next=8;break}return e.abrupt("return",c);case 8:throw c;case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e,t,n){var r=null,i=e.inject(E.Cy);if(i.hasPivotTableAtCell(t,n)){var o=i.getPivotTableNameByCell(t,n),a=i.getPositionCell(o);!a||a.row===t&&a.col===n||(r={editAction:b("LarkCCM_Sheets_CellHistory_ChangesComeFromPivotTable")})}if(e.isProxyArrayFormula(t,n)){var s=e.getVar(t,n),u=T(t-s.offsetRow,n-s.offsetCol);r={editAction:b("LarkCCM_Sheets_CellHistory_ChangesComeFromCells",{cellNum:u})}}return r?[r]:null}function R(e,t,n){var r=t.rev,i=t.user_id,o=t.action,a=t.value,s=t.edit_time;return{rev:r,name:(0,m.vW)(n[i]),content:P(e,r,o,a,s),userId:i,avatarUrl:n[i].avatar_url,action:o}}function A(e){return e.format(b("sheet.history.time"))}function O(e,t,n){return t?b("history.date.yesterday"):n?e.format(b("sheet.history.date")):e.format(b("sheet.history.date_year"))}function M(e){return d()(e).format("YYYY/M/D H:mm")}function k(e){return!!(Object.prototype.hasOwnProperty.call(e,"formula")||Object.prototype.hasOwnProperty.call(e,"multipleValues")||Object.prototype.hasOwnProperty.call(e,"value")||Object.prototype.hasOwnProperty.call(e,"style")||Object.prototype.hasOwnProperty.call(e,"formulaData"))}function I(e){return Array.isArray(e)?e.length>0:(0,a.Z)(e.text)||(0,s.default)(e.text)}function x(e){return N.apply(this,arguments)}function N(){return(N=(0,o.Z)(i().mark((function e(t){var n,r,o,a,s,u,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.action,r=t.value,n===f.g0.EDIT){e.next=3;break}return e.abrupt("return",!1);case 3:if(!(o=r&&JSON.parse(r)).value||!Array.isArray(o.value)){e.next=15;break}if(a=o.value,s=a.filter((function(e){return e.type===c.K6s.URL})),0!==(u=(0,y.L3)(s)).length){e.next=10;break}return e.abrupt("return",!1);case 10:return e.next=12,(0,g.getMetas)(u,_.ioRequestClient);case 12:if(!(l=e.sent)||0===Object.keys(l).length){e.next=15;break}return e.abrupt("return",!0);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e,t,n,r,i){var o,s=function(e){var t=d()(1e3*e),n=d()(),r=d()().subtract(1,"day");if(n.diff(t,"seconds")<60)return b("Record_TimeSlotSeconds_Text");if(n.diff(t,"minutes")<60){var i=n.diff(t,"minutes"),o=b(i>1?"Record_TimeSlotPluralMinutes_Text":"Record_TimeSlotSingularMinute_Text");return n.diff(t,"minutes")+" "+o}return n.isSame(t,"day")?A(t):r.isSame(t,"day")?"".concat(O(t,!0,!1)," ").concat(A(t)):n.isSame(t,"year")?"".concat(O(t,!1,!0)," ").concat(A(t)):"".concat(O(t,!1,!1)," ").concat(A(t))}(parseInt(i,10)),u=r&&JSON.parse(r);switch(n){case f.g0.SORT:return{editAction:b("LarkCCM_Sheets_CellHistory_Sorted"),editTime:s,sourceEditTime:i};case f.g0.SET_EMBEDDED_BLOCK:return{editAction:b("LarkCCM_Sheets_CellHistory_InsertedPivotTable"),editTime:s,sourceEditTime:i};case f.g0.CLEAR:return{editAction:b("LarkCCM_Sheets_CellHistory_ClearedCell"),editTime:s,sourceEditTime:i};case f.g0.DATA_CONNECTOR_EDIT:return{editAction:b("LarkCCM_Sheets_DataConnect_EditHistory_SyncedData_Description"),editTime:s,sourceEditTime:i,editContent:{type:"text",text:u.value}};case f.g0.SET_REMINDER:var l;if(k(u)){var c,h,g;if(u.style)c=(null===(h=u.style.formatter)||void 0===h?void 0:h.formatCached)||(null===(g=u.style.autoFormatter)||void 0===g?void 0:g.formatCached);l=c?(0,v.createFormatter)(e.parent.formatterService,c).format(u.value):M(u.reminder.expireTime)}else{l=M(u.reminder?u.reminder.expireTime:u.expireTime)}return o={type:"text",text:l},{editAction:b("LarkCCM_Sheets_CellHistory_EditedDateReminder"),editTime:s,editContent:o,sourceEditTime:i};case f.g0.RECOVER:var _=u;if(Array.isArray(_))o=_;else if(_.reminder)o={type:"text",text:M(_.reminder.expireTime)};else{if((0,a.Z)(_)&&!_)return{editAction:b("LarkCCM_Sheets_CellHistory_RecoveredEditHistory_NoColon"),editTime:s,sourceEditTime:i};o={type:"text",text:_}}return I(o)||(console.error("Rev ".concat(t," CellHistoryItem editcontent is invalid")),o={type:"text",text:""}),{editAction:b("LarkCCM_Sheets_CellHistory_RecoveredEditHistory"),editTime:s,editContent:o,sourceEditTime:i};case f.g0.EDIT:var y=b("LarkCCM_Sheets_CellHistory_EditedCell");if(k(u))if(u.formula)o={type:"text",text:u.formula.startsWith("=")?u.formula:"="+u.formula};else if(u.formulaData)o={type:"text",text:"="+L(u.formulaData,e)};else if(u.multipleValues)o=Array.isArray(u.value)?u.value:{type:"text",text:u.value};else if(Array.isArray(u.value))o=u.value;else{var m=u.value;if(!(u.dataValidation&&(0,p.NgA)(u.dataValidation))&&u.style){var E,T,C=Array.isArray(u.style)?p.OBY.deserialize([u.style])[0]:u.style,S=(null===(E=C.formatter)||void 0===E?void 0:E.formatCached)||(null===(T=C.autoFormatter)||void 0===T?void 0:T.formatCached);if(S){var w=e.parent.formatterService;m=(0,v.createFormatter)(w,S).format(u.value)}}o={type:"text",text:m}}else o=Array.isArray(u)?u:{type:"text",text:u};return I(o)||(console.error("Rev ".concat(t," CellHistoryItem editcontent is invalid")),o={type:"text",text:""}),{editAction:y,editTime:s,editContent:o,sourceEditTime:i};case f.g0.ADD_SPARKLINE:return{editAction:b("LarkCCM_Sheets_CellHistory_AddSparkline"),editTime:s,sourceEditTime:i};case f.g0.DEL_SPARKLINE:return{editAction:b("LarkCCM_Sheets_CellHistory_UpdateSparkline"),editTime:s,sourceEditTime:i};case f.g0.DLP_DELETE_SENSITIVE_FILE:return{editAction:b("LarkCCM_Docs_DLP_SensitiveInfoDeleted_Title"),editTime:s,sourceEditTime:i}}}function L(e,t){var n=t.getActiveRowIndex(),r=t.getActiveColumnIndex(),i={ref:new p.e6w(n,r,1,1,t)};if(null==e.refs)return(0,p.iQ0)(e,null,i);for(var o=Object.keys(e.refs),a={},s=0;s<o.length;s++){var u=o[s],l=e.refs[u],c=(0,p._CE)(l,t,(function(e){return t.getParent().getSheetFromId(e)}),i);a[u]=c}return(0,p.iQ0)(e,a,i)}function D(e,t,n,r){return F.apply(this,arguments)}function F(){return(F=(0,o.Z)(i().mark((function e(t,n,r,o){var a,s,u,l,c,h,d,p,v,g,_,y,m,E,T;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.users,s=t.cell_histories,u=0,0!==s.length){e.next=4;break}return e.abrupt("return",{hasMoreCellHistory:!1,needExtraFetchPageSize:u,lastRev:void 0});case 4:l=parseInt(s.slice(-1)[0].rev,10),c=o?s.length===o:10===s.length,h=[c,l].every(Boolean),d=0,p=s.length;case 8:if(!(d<p)){e.next=29;break}return e.next=11,x(s[d]);case 11:if(!e.sent){e.next=21;break}if(v=!1,g=!1,_=!1,0!==d?(y=s[d-1].value&&JSON.parse(s[d-1].value),v=y&&Array.isArray(y.value),g=parseInt(s[d-1].edit_time,10)-parseInt(s[d].edit_time,10)<2,_=s[d-1].action===f.g0.EDIT):n.slice(-1)[0]&&(m=n.slice(-1)[0].cellHistoryList.slice(-1)[0],v=Array.isArray(m.editContent),g=!!m.sourceEditTime&&parseInt(s[d].edit_time,10)-parseInt(m.sourceEditTime,10)<2,_=m.editAction===b("LarkCCM_Sheets_CellHistory_EditedCell")),![v,g,_].every(Boolean)){e.next=21;break}return u++,e.abrupt("continue",26);case 21:if(E=R(r,s[d],a),T=n.slice(-1)[0],E.content){e.next=25;break}throw new Error("Rev ".concat(s[d].rev," CellHistoryItem editcontent is undefined"));case 25:T&&T.userId===E.userId?T.cellHistoryList.push(E.content):n.push({rev:E.rev,userId:E.userId,avatarUrl:E.avatarUrl,userName:E.name,cellHistoryList:[E.content],action:E.action});case 26:d++,e.next=8;break;case 29:return e.abrupt("return",{hasMoreCellHistory:h,lastRev:l,needExtraFetchPageSize:u});case 30:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},vsh_89992:function(e,t,n){"use strict";var r,i,o,a,s,u;n.d(t,{Zs:function(){return r},M:function(){return o},g0:function(){return a},xf:function(){return s},Jn:function(){return u}}),function(e){e.STATE="state",e.ACTION="action"}(r||(r={})),function(e){e.LINK="link",e.EMBED_IMAGE="embed-image",e.ATTACHMENT="attachment",e.TEXT="text"}(i||(i={})),function(e){e.LOADING="loading",e.SUCCESS="success",e.FAILED="failed"}(o||(o={})),function(e){e.EDIT="edit",e.CLEAR="clear",e.SORT="sort",e.RECOVER="recover",e.SET_EMBEDDED_BLOCK="setEmbeddedBlock",e.SET_REMINDER="setReminder",e.DATA_CONNECTOR_EDIT="dataConnectorEdit",e.ADD_SPARKLINE="addSparkline",e.DEL_SPARKLINE="delSparkline",e.DLP_DELETE_SENSITIVE_FILE="dlpDeleteSensitiveFile"}(a||(a={})),function(e){e.TEXT="text/plain",e.HTML="text/html"}(s||(s={})),function(e){e.UNKNOWN="UNKNOWN",e.EXPENDED="EXPENDED",e.COLLAPSE="COLLAPSE"}(u||(u={}))},vsh_56371:function(e,t,n){"use strict";n.d(t,{U:function(){return d}});var r=n("vsh_4561"),i=n("vsh_98125"),o=n.n(i),a=n("vsh_20881"),s=n("vsh_22488"),u=n("vsh_22233"),l=n("vsh_75986"),c=n("vsh_73043"),h=null;function d(e){var t=e.focusOnSheet,n=void 0===t?r.default:t,i=e.notSupportContent,d=e.supportNavigatorClipboard,f=(0,l._D$)("paste"),p=(0,s.getHelpCenterUrl)(c("LarkCCM_Sheets_PasteExtension_Disable_HelpCenter_Feishu"),c("LarkCCM_Sheets_PasteExtension_Disable_HelpCenter_Lark")),v=function(){h&&h.close()},g={onCancel:n,onConfirm:n};return h=(0,u.K4)(Object.assign({title:c("LarkCCM_Sheets_PasteExtensionDisable_PasteFail_Toast"),className:"paste-modal",body:o().createElement(o().Fragment,null,o().createElement("div",{className:"paste-hint"},d?!0===i?c("LarkCCM_Sheets_PasteExtensionDisable_RightClickFail_Toast",{shortcut:f}):o().createElement(a.oc,{name:c("LarkCCM_Sheets_PasteExtensionDisable_PasteFail_NoPerm_Toast")},o().createElement("span",null,f),o().createElement("a",{target:"_blank",rel:"noreferrer",href:p,onClick:v},c("LarkCCM_Sheets_Formula_LearnMore_Button"))):c("LarkCCM_Sheets_PasteExtensionDisable_BrowserOutdated_Toast",{shortcut:f}))),closable:!0,hasCancel:!1,confirmText:c("sheet.shortcut_modal.paste_hint_confirm")},g))}},vsh_61372:function(e,t,n){"use strict";n.d(t,{n:function(){return o}});var r=n("vsh_24627"),i=n("vsh_72834"),o={MinValue:r.WS3.MinValue,MaxValue:r.WS3.MaxValue,Num:r.WS3.Num,Percentile:r.WS3.Percentile,Percent:r.WS3.Percent,Formula:r.WS3.Formula,Auto:r.WS3.Auto,None:i.Nnc.None}},vsh_33272:function(e,t,n){"use strict";n.d(t,{J:function(){return i},x:function(){return o}});var r=n("vsh_78400"),i=r.G100,o="text-title"},vsh_73264:function(e,t,n){"use strict";n.d(t,{Uu:function(){return c},nX:function(){return d},oE:function(){return p}});var r,i=n("vsh_74561"),o=n("vsh_1139"),a=n("vsh_93301"),s=n("vsh_61372"),u=n("vsh_24627"),l=n("vsh_72834");function c(e){var t=(0,l.Bym)(e.getBaseRanges());switch(e.ruleType){case u.eFJ.DATA_BAR:var n=e.attrs,r=n[0],o=n[1],a=r.value,c=r.valueType,v=r.hideValue,g=o.value,_=o.valueType,y=d(e);return{ranges:t,condition:{type:l.f5z.DataBar,hideValue:!!v,minValue:a,minType:c,maxValue:g,maxType:_},format:y};case u.eFJ.COLOR_SCALE:var m=e.attrs,E=m[0],b=m[2]?m[1]:null,T=m[2]?m[2]:m[1];return{ranges:t,condition:{type:l.f5z.ColorScales,minValue:{valueType:E.valueType,value:E.value},midValue:{valueType:b?b.valueType:s.n.None,value:null==b?void 0:b.value},maxValue:{valueType:T.valueType,value:T.value}},format:{valueFormats:b?[{backColor:E.color},{backColor:b.color},{backColor:T.color}]:[{backColor:E.color},{backColor:T.color}]}};case u.eFJ.RANK:var C=e.attrs[0],S=C.isBottom,w=C.valueType,R=C.value;return{ranges:t,condition:{type:l.f5z.ValueGroup,ruleType:S?u.yC8.IsBottom:u.yC8.IsTop,value:R,valueType:w},format:h(e.style)};case u.eFJ.AVERAGE:var A=e.attrs[0].operator;return{ranges:t,condition:{type:l.f5z.ValueGroup,ruleType:u.S7R.Greater===A?u.yC8.AboveAverage:u.yC8.BelowAverage},format:h(e.style)};case u.eFJ.EXPRESSION:var O=e.attrs[0].formula;return{ranges:t,condition:{type:l.f5z.Formula,formula:O[0]},format:h(e.style)};case u.eFJ.ICON_SET:var M=e.attrs,k=d(e);return{ranges:t,condition:{type:l.f5z.IconGroup,iconRules:M.map((function(e){return{valueType:e.valueType,value:e.value,operator:e.operator}}))},format:k};default:var I=e.style,x=function(e){switch(e.ruleType){case u.eFJ.CELL_IS:return u.CPf.Number;case u.eFJ.DUPLICATE_VALUES:case u.eFJ.UNIQUE_VALUES:case u.eFJ.CONTAINS_TEXT:case u.eFJ.CONTAINS_BLANKS:case u.eFJ.NOT_CONTAINS_BLANKS:return u.CPf.Content;case u.eFJ.TIME_PERIOD:return u.CPf.Date;default:return u.CPf.Number}}(e),N=function(e){var t,n,r=e.ruleType,o=e.attrs,a=o&&o[0];switch(r){case u.eFJ.CELL_IS:return n=a.operator,f[n];case u.eFJ.DUPLICATE_VALUES:return u.MO8.IsDuplicate;case u.eFJ.UNIQUE_VALUES:return u.MO8.IsUnique;case u.eFJ.CONTAINS_BLANKS:return u.MO8.IsEmpty;case u.eFJ.NOT_CONTAINS_BLANKS:return u.MO8.IsNotEmpty;case u.eFJ.CONTAINS_TEXT:return n=a.operator,f[n];case u.eFJ.TIME_PERIOD:return(t={},(0,i.Z)(t,u.rrR.Today,u.m5l.IsToday),(0,i.Z)(t,u.rrR.Yesterday,u.m5l.IsYesterday),(0,i.Z)(t,u.rrR.Tomorrow,u.m5l.IsTomorrow),(0,i.Z)(t,u.rrR.Last7Days,u.m5l.IsTheLastSevenDays),t)[a.timePeriod]}}(e),P=function(e){var t=e.ruleType,n=e.attrs,r=n&&n[0];switch(t){case u.eFJ.CELL_IS:return r.plaintext||p(r.formula)||[];case u.eFJ.CONTAINS_TEXT:return[r.text]||0;default:return[]}}(e);return{ranges:t,condition:{type:x,operator:N,values:P},format:h(I)}}}function h(e){var t=e.backColor,n=e.foreColor,r=e.textDecoration,i=e.font,o=void 0===i?"":i,a=e.negativeColor,s=e.positiveColor,u=e.isGradient,l={},c=o.split(" ");c.includes("bold")&&(l.bold=!0),c.includes("italic")&&(l.italic=!0);var h={1:{underLine:!0},2:{lineThrough:!0},3:{lineThrough:!0,underLine:!0}};return t&&(l.backColor=t),n&&(l.foreColor=n),r&&h[r]&&(l=Object.assign(l,h[r])),a&&s&&(l={negativeColor:a,positiveColor:s,isGradient:u}),l}function d(e){switch(e.ruleType){case u.eFJ.COLOR_SCALE:return{valueFormats:e.attrs.map((function(e){return{backColor:e.color}}))};case u.eFJ.DATA_BAR:var t=(0,o.Z)(e.attrs,2),n=t[0].color,r=t[1];return{negativeColor:n,positiveColor:r.color,isGradient:r.gradient};case u.eFJ.ICON_SET:var i=e.attrs[0];return{iconType:i.iconType,hideValue:i.hideValue,reverseIcons:i.reverseIcons};default:return h(e.style)}}var f=(r={},(0,i.Z)(r,u.gAB.Equal,u.KGF.IsEqualTo),(0,i.Z)(r,u.gAB.NotEqual,u.KGF.IsNotEqualTo),(0,i.Z)(r,u.gAB.Greater,u.KGF.GreaterThan),(0,i.Z)(r,u.gAB.GreaterOrEqual,u.KGF.GreaterThanOrEqualTo),(0,i.Z)(r,u.gAB.Less,u.KGF.LessThan),(0,i.Z)(r,u.gAB.LessOrEqual,u.KGF.LessThanOrEqualTo),(0,i.Z)(r,u.gAB.Between,u.KGF.IsBetween),(0,i.Z)(r,u.gAB.NotBetween,u.KGF.IsNotBetween),(0,i.Z)(r,u.CyK.Is,u.MO8.Is),(0,i.Z)(r,u.CyK.BeginsWith,u.MO8.StartsWith),(0,i.Z)(r,u.CyK.EndsWith,u.MO8.EndsWith),(0,i.Z)(r,u.CyK.Contains,u.MO8.Contains),(0,i.Z)(r,u.CyK.DoesNotContain,u.MO8.DoesNotContain),r);function p(e){return e.map((function(e){return(0,a.default)(e)?e:"".concat(e.replace(/\"\"/g,'"').replace(/^"/,"").replace(/"$/,""))}))}},vsh_87322:function(e,t,n){"use strict";n.d(t,{W:function(){return r},B:function(){return i}});var r="sheet_context_menu",i="sheet_opration"},vsh_75977:function(e,t,n){"use strict";var r,i,o,a,s,u,l,c,h,d;n.d(t,{Qk:function(){return r},oE:function(){return o},VO:function(){return u},IQ:function(){return l},lI:function(){return c},$M:function(){return h},DK:function(){return d}}),function(e){e.Single="single",e.Multiple="multiple",e.Number="number",e.Date="date",e.TextLength="textLength",e.Checkbox="checkbox",e.Custom="custom"}(r||(r={})),function(e){e.Between="between",e.NotBetween="notBetween",e.EqualTo="equalTo",e.NotEqualTo="notEqualTo",e.GreaterThan="greaterThan",e.LessThan="lessThan",e.GreaterThanOrEqualTo="greaterThanOrEqualTo",e.LessThanOrEqualTo="lessThanOrEqualTo"}(i||(i={})),function(e){e[e.ShowWarning=1]="ShowWarning",e[e.RejectInput=2]="RejectInput"}(o||(o={})),function(e){e.Range="range",e.Items="items"}(a||(a={})),function(e){e[e.Integer=1]="Integer",e[e.Decimal=2]="Decimal"}(s||(s={})),function(e){e.IsAValidNumber="isAValidNumber",e.Between="between",e.NotBetween="notBetween",e.EqualTo="equalTo",e.NotEqualTo="notEqualTo",e.GreaterThan="greaterThan",e.LessThan="lessThan",e.GreaterThanOrEqualTo="greaterThanOrEqualTo",e.LessThanOrEqualTo="lessThanOrEqualTo"}(u||(u={})),function(e){e.IsAValidDate="isAValidDate",e.Between="between",e.NotBetween="notBetween",e.EqualTo="equalTo",e.NotEqualTo="notEqualTo",e.GreaterThan="greaterThan",e.LessThan="lessThan",e.GreaterThanOrEqualTo="greaterThanOrEqualTo",e.LessThanOrEqualTo="lessThanOrEqualTo"}(l||(l={})),function(e){e.Between="between",e.NotBetween="notBetween",e.EqualTo="equalTo",e.NotEqualTo="notEqualTo",e.GreaterThan="greaterThan",e.LessThan="lessThan",e.GreaterThanOrEqualTo="greaterThanOrEqualTo",e.LessThanOrEqualTo="lessThanOrEqualTo"}(c||(c={})),function(e){e.IsAValidNumber="isAValidNumber",e.IsValidDate="isValidDate",e.Between="between",e.NotBetween="notBetween",e.EqualTo="equalTo",e.NotEqualTo="notEqualTo",e.GreaterThan="greaterThan",e.LessThan="lessThan",e.GreaterThanOrEqualTo="greaterThanOrEqualTo",e.LessThanOrEqualTo="lessThanOrEqualTo"}(h||(h={})),function(e){e.RANGE="range",e.CUSTOM="custom"}(d||(d={}))},vsh_63888:function(e,t,n){"use strict";n.d(t,{Rv:function(){return w},WM:function(){return y},nS:function(){return v},tf:function(){return b},Zl:function(){return M},vW:function(){return E},iw:function(){return m},ic:function(){return R},wt:function(){return _}});var r,i=n("vsh_98652"),o=n("vsh_1139"),a=n("vsh_46782"),s=n("vsh_69691"),u=n("vsh_9452"),l=n("vsh_50013"),c=n("vsh_24627"),h=n("vsh_72834"),d=n("vsh_74561");r={},(0,d.Z)(r,c.aOo.DEL_ROW,(function(e,t){if(t.row>e.row+e.row_count-1)return[e];if(t.row+t.row_count-1<e.row)return[Object.assign({},e,{row:e.row-t.row_count})];var n=[],r=t.row-e.row;return r>0&&n.push(Object.assign({},e,{row_count:r})),(r=e.row+e.row_count-t.row-t.row_count)>0&&n.push(Object.assign({},e,{row:t.row,row_count:r})),n})),(0,d.Z)(r,c.aOo.DEL_COL,(function(e,t){if(t.col>e.col+e.col_count-1)return[e];if(t.col+t.col_count-1<e.col)return[Object.assign({},e,{col:e.col-t.col_count})];var n=[],r=t.col-e.col;return r>0&&n.push(Object.assign({},e,{col_count:r})),(r=e.col+e.col_count-t.col-t.col_count)>0&&n.push(Object.assign({},e,{col:t.col,col_count:r})),n})),(0,d.Z)(r,c.aOo.ADD_ROW,(function(e,t){if(t.row>e.row+e.row_count-1)return[e];if(t.row<=e.row)return[Object.assign({},e,{row:e.row+t.row_count})];var n=[];return n.push(Object.assign({},e,{row_count:t.row-e.row})),n.push(Object.assign({},e,{row:t.row+t.row_count,row_count:e.row_count-(t.row-e.row)})),n})),(0,d.Z)(r,c.aOo.ADD_COL,(function(e,t){if(t.col>e.col+e.col_count-1)return[e];if(t.col<=e.col)return[Object.assign({},e,{col:e.col+t.col_count})];var n=[];return n.push(Object.assign({},e,{col_count:t.col-e.col})),n.push(Object.assign({},e,{col:t.col+t.col_count,col_count:e.col_count-(t.col-e.col)})),n})),n("vsh_84523"),n("vsh_73043");function f(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function v(e,t,n){if((0,l.bR)(e))return e;if((0,l.u9)(e))return Object.assign({},e,{row_count:1,col_count:1});var r=e.row,i=e.col,o=e.row_count,a=e.col_count,s={row:r||0,col:i||0,row_count:o&&o>0?o:t,col_count:a&&a>0?a:n};return void 0!==e.type&&(s.type=e.type),s}function g(e,t){return e.sheetId===t.sheetId&&e.userId===t.userId&&(r=t,(n=e).row===r.row&&1===Math.abs(n.col-r.col)||n.col===r.col&&1===Math.abs(n.row-r.row));var n,r}function _(e){for(var t=Object.create(null),n=0;n<e.length;n++){var r=e[n],i=r.sheetId,o=r.row,a=r.col;t[i]||(t[i]=Object.create(null)),t[i][o]||(t[i][o]=Object.create(null)),t[i][o][a]=r}return t}function y(e,t,n,r){var i=function(e,t,n,r){var i=e[t],o=[];if(!i||!i[n]||!i[n][r])return o;var a=[i[n][r]],s=new Map;for(s.set("".concat(n,":").concat(r),!0);a.length>0;){var u=a.pop();o.push(u);var l=u.row,c=u.col,h="".concat(l-1,":").concat(c);if(!s.has(h)){s.set(h,!0);var d=i[l-1]&&i[l-1][c];d&&g(d,u)&&a.push(d)}var f="".concat(l+1,":").concat(c);if(!s.has(f)){s.set(f,!0);var p=i[l+1]&&i[l+1][c];p&&g(p,u)&&a.push(p)}var v="".concat(l,":").concat(c-1);if(!s.has(v)){s.set(v,!0);var _=i[l]&&i[l][c-1];_&&g(_,u)&&a.push(_)}var y="".concat(l,":").concat(c+1);if(!s.has(y)){s.set(y,!0);var m=i[l]&&i[l][c+1];m&&g(m,u)&&a.push(m)}}return o}(e,t,n,r);return 0===i.length?null:function(e){for(var t=e[0],n=t,r=n.row,i=n.col,o=1;o<e.length;o++){var a=e[o];(a.col>i||a.col===i&&a.row<r)&&(r=a.row,i=a.col,t=a)}return t}(i)}function m(e){for(var t=e[0],n=t,r=n.row,i=n.col,o=1;o<e.length;o++){var a=e[o];(a.col<i||a.col===i&&a.row<r)&&(r=a.row,i=a.col,t=a)}return t}function E(e){return e&&("en"===(0,s.getLanguage)()&&e.en_name?e.en_name:e.name)||"-"}function b(e){var t={};return Object.keys(e).forEach((function(n){t[n]={lastRev:e[n]}})),t}function T(e,t){for(var n=e.row,r=e.col,i=e.row_count||e.rowCount||0,o=e.col_count||e.colCount||0,a=n;a<n+i;a++)for(var s=r;s<r+o;s++)t(a,s)}function C(e,t,n,r,o){var a=r.action,s=r.value;if(a===c.aOo.SET_RANGE_PROTECTION&&s.ranges.forEach((function(r){T(function(e,t){return t.type===c.xj7.NORMAL?t:t.type===c.xj7.ROW?Object.assign({},t,{col:0,col_count:e.getColumnCount()}):Object.assign({},t,{row:0,row_count:e.getRowCount()})}(e,r),(function(e,r){t.set(e,r,n)}))})),a===c.aOo.DEL_RANGE_PROTECTION){var u,l=null==o||null===(u=o.sheets[e.name()])||void 0===u?void 0:u.protections,h=null==l?void 0:l[s.id];if(!h)return;[].concat((0,i.Z)((h.rows||[]).map((function(t){return{row:t[0],rowCount:t[1],col:0,colCount:e.getColumnCount()}}))),(0,i.Z)((h.cols||[]).map((function(t){return{col:t[0],colCount:t[1],row:0,rowCount:e.getRowCount()}}))),(0,i.Z)((h.cells||[]).map((function(e){return{row:e[0],rowCount:e[1],col:e[2],colCount:e[3]}})))).forEach((function(e){T(e,(function(e,r){t.set(e,r,n)}))}))}}var S=new Set([c.aOo.ADD_OUTLINE,c.aOo.DEL_OUTLINE,c.aOo.UPDATE_OUTLINE]);function w(e,t,n){var r,i={},s=f(t);try{var u=function(){for(var t=r.value,a=t.content,s=t.user_id,u=function(t){var r=a[t],u=r.action,l=r.target,d=r.sheet_id,p=r.value;if(S.has(u))return"continue";!function(e,t,n,r,i,o){var a=e.getSheetFromId(r);if(a&&t===c.aOo.SET_FORM_DATA){r in o||(o[r]=new h.yJh);for(var s=o[r],u=0,l=Object.keys(n);u<l.length;u++)for(var d=l[u],f=n[d],p=0,v=Object.keys(f);p<v.length;p++){var g=v[p],_=a.getRowByFId(d),y=a.getColByFId(g);null!=_&&null!=y&&T({row:_,row_count:1,col:y,col_count:1},(function(e,t){return s.set(e,t,i)}))}}}(e,u,p,d,s,i);var v=e.getSheetFromId(d);if(!v)return"continue";d in i||(i[d]=new h.yJh,i[d].setSize(Math.ceil(v.getRowCount()/h.yJh.rowSize)));var g=i[d];if((0,c.i55)(r))return T(p.target,(function(e,t){return g.set(e,t,s)})),"continue";if(u===c.aOo.MOVE_RANGE)return T(p.source,(function(e,t){return g.set(e,t,s)})),T(p.target,(function(e,t){return g.set(e,t,s)})),"continue";if(function(e,t,n,r,i){var a,s=r.action,u=r.value,l=null==i||null===(a=i.sheets[e])||void 0===a?void 0:a.sparklineGroup;if(s===c.aOo.ADD_SPARKLINE_GROUP)for(var h=0,d=Object.values(u);h<d.length;h++)for(var p=d[h],v=0,g=Object.values(p.sparklines);v<g.length;v++){var _=g[v].position;t.set(_.row,_.col,n)}else if(s===c.aOo.UPDATE_SPARKLINE_GROUP)for(var y=0,m=Object.entries(u);y<m.length;y++){var E,b=(0,o.Z)(m[y],2),T=b[0],C=b[1];if(C.sparklines)for(var S=0,w=Object.entries(C.sparklines);S<w.length;S++){var R=(0,o.Z)(w[S],2),A=R[0],O=R[1];if(null!=O&&O.position)t.set(O.position.row,O.position.col,n);else{var M,k=null==l||null===(M=l[T])||void 0===M?void 0:M.sparklines[A];k&&t.set(k.position.row,k.position.col,n)}}else Object.values((null==l||null===(E=l[T])||void 0===E?void 0:E.sparklines)||{}).forEach((function(e){t.set(e.position.row,e.position.col,n)}))}else if(s===c.aOo.DELETE_SPARKLINE_GROUP){var I,x=f(u);try{for(x.s();!(I=x.n()).done;){var N,P=I.value;Object.values((null==l||null===(N=l[P])||void 0===N?void 0:N.sparklines)||{}).forEach((function(e){t.set(e.position.row,e.position.col,n)}))}}catch(e){x.e(e)}finally{x.f()}}}(v.name(),g,s,r,n),C(v,g,s,r,n),!l)return"continue";switch(u){case c.aOo.ADD_ROW:g.addRow(l.row,l.row_count,g.getSize()*h.yJh.rowSize+l.row_count),T(Object.assign({col:0,col_count:v.getColumnCount()},l),(function(e,t){return g.set(e,t,s)}));break;case c.aOo.ADD_COL:g.addCol(l.col,l.col_count),T(Object.assign({row:0,row_count:v.getRowCount()},l),(function(e,t){return g.set(e,t,s)}));break;case c.aOo.DEL_ROW:g.delRow(l.row,l.row_count,g.getSize()*h.yJh.rowSize-l.row_count);break;case c.aOo.DEL_COL:g.delCol(l.col,l.col_count);break;case c.aOo.SET_FLOAT_IMAGE:case c.aOo.DEL_FLOAT_IMAGE:break;default:T(l,(function(e,t){return g.set(e,t,s)}))}},l=0;l<a.length;l++)u(l)};for(s.s();!(r=s.n()).done;)u()}catch(e){s.e(e)}finally{s.f()}var l={};for(var d in i){var p=i[d],v=e.getSheetFromId(d);if(v)for(var g=p.iter(0,0,v.getRowCount(),v.getColumnCount()),_=g.next();null!==_;){var y=_,m=g.position(),E=m.row,b=m.col,w={userId:y,sheetId:d,row:E,col:b,row_count:1,col_count:1};(0,a.Z)(l,[d,E,b],w,Object),_=g.next()}}return l}function R(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;return e?"string"!=typeof e?"":e.slice(0,t):""}var A,O,M=(A=new Map,O=0,function(e){var t=A.get(e);return t||(t=u.n2[O],O=(O+1)%u.n2.length,A.set(e,t),t)})},vsh_65420:function(e,t,n){"use strict";n.d(t,{$y:function(){return T},$A:function(){return C},n8:function(){return S},Em:function(){return R},SC:function(){return A},ef:function(){return O},dg:function(){return M},tb:function(){return k},Uv:function(){return F},E:function(){return B},a4:function(){return V},AK:function(){return H},hM:function(){return U},eE:function(){return Z}});var r,i,o=n("vsh_65498"),a=n("vsh_74561"),s=n("vsh_98652"),u=n("vsh_4561"),l=n("vsh_69691"),c=n("vsh_60505"),h=n("vsh_25285"),d=n("vsh_96579"),f=n("vsh_22488"),p=n("vsh_3789"),v=n("vsh_24627"),g=n("vsh_72834"),_=n("vsh_65981"),y=n("vsh_13449"),m=n("vsh_46162"),E=n("vsh_15657"),b=n("vsh_75986");function T(e,t,n){var r=(0,g.Bym)([t]),i=(0,h.ew)(r).replace(/=*$/,""),o=Object.assign({sheet:e,range:i},n()),a=(0,c.stringify)(o);return"".concat(location.origin).concat(location.pathname,"?").concat(a)}function C(e,t,n,r){var i=e.getPlugin(b.WAT);if(i){var o=i.getRangeIdForSelectionLink(n);if(o){var a=Object.assign({sheet:t,rangeId:o},r());a.rangeVer=b.xae;var s=(0,c.stringify)(a);return"".concat(location.origin).concat(location.pathname,"?").concat(s)}}}function S(e){var t=e.spread,n=e.normalHyperlinkRg,r=e.formulaHyperlinkRg,i=e.flag,o=e.source,a=e.setFocus,l=void 0===a?u.default:a,c=t.getActiveSheet();if("clear"===i){for(var h=[],f=0;f<n.length&&4!==h.length;f++)for(var p=n[f],y=p&&p.colFrom(),m=p&&p.rowFrom(),E=c.getSegmentArray(m,y)||[],b=0;b<E.length;b++){var T=E[b];if(T&&"url"===T.type){var C=T.link,S=T.cellPosition,R=U(H(t,C||S||null),S||null);h.includes(R)||h.push(R)}}h.forEach((function(e){(0,d.collectSuiteEvent)("sheet_opration",{action:"hyperlink",source:o,op_item:"remove link",eventType:"click",object_id:c&&c.id(),sheet_link_type:e})}))}else(0,d.collectSuiteEvent)("sheet_opration",{action:"hyperlink",source:o,op_item:"convert to link",eventType:"click",object_id:c&&c.id()});"clear"===i?c.setRangeValue([].concat((0,s.Z)(n),(0,s.Z)(r)),(function(e,t){if(c.getFormulaHyperLink(e,t)){return{formula:c.getFormula(e,t),style:{hideLink:!0}}}var n=c.getSegmentArray(e,t),r=c.getText(e,t),i=n||r;if(Array.isArray(i))if(1===i.length)i=i[0].text;else{for(var o=[],a=0;a<i.length;a++){var s=i[a];"url"!==s.type?o.push(s):(0,v.hTd)(o,w(s))}i=o}return{value:i}})):"convert"===i&&(0,_.setRangeStyle)({spread:t,prop:g.fVw.HideLink,value:!1,selections:r}),c&&l(c)}function w(e){var t=[];if(Array.isArray(e.texts))t=e.texts;else{var n={type:v.K6s.TEXT,text:e.text};e.style&&(n.style=e.style),t.push(n)}return t}function R(e,t,n,r,i){var o=e.getActiveSheet(),a=(0,g.vw_)(o,t,n),s=o.getText(t,n),u=i&&i.seg,l=a||s;if(l&&Array.isArray(l))if(1===l.length)l=l[0].text;else{for(var c=[],h=0;h<l.length;h++){var f=l[h];"url"===f.type&&u&&u.idx===h?(0,v.hTd)(c,w(f)):c.push(f)}l=c}(0,_.setHyperlink)(e,{row:t,col:n,newValue:l}),(0,d.collectSuiteEvent)("sheet_opration",{action:"hyperlink",source:"body",op_item:"remove link",eventType:"click",object_id:o&&o.id(),sheet_link_type:r})}function A(e){for(var t,n=(0,m.getSheetContextMenuPerfIterMaxCellNum)(),i=e.getSelections(),o=(t={},(0,a.Z)(t,r.NORMAL_HYPERLINK,[]),(0,a.Z)(t,r.FORMULA_HYPERLINK_UNHIDE,[]),(0,a.Z)(t,r.FORMULA_HYPERLINK_HIDE,[]),t),s=!1,u=0,l=0,c=function(){var t=i[l],a=t.sheet(),c=t.rowFrom(),h=t.colFrom(),d=t.rowCount(),f=t.colCount();e.iterContentWithPos(c,h,d,f).exitWhen((function(){return s})).forEach((function(t){var i=t[1],l=i.row,c=i.col,h=function(e,t,n){if(!n)return r.NULL;var i=r.NULL;return P(e,t,n)?i=r.NORMAL_HYPERLINK:L(e,t,n)?i=r.FORMULA_HYPERLINK_UNHIDE:D(e,t,n)&&(i=r.FORMULA_HYPERLINK_HIDE),i}(l,c,a);h!==r.NULL&&o[h].push(new g.e6w(l,c,1,1,e)),u++,s=u>n})),l++};l<i.length&&!s;)c();return o}function O(e){var t,n=e.getSelections(),i=(t={},(0,a.Z)(t,r.NORMAL_HYPERLINK,[]),(0,a.Z)(t,r.FORMULA_HYPERLINK_UNHIDE,[]),(0,a.Z)(t,r.FORMULA_HYPERLINK_HIDE,[]),t);return n.map((function(t){for(var n=function(n){for(var o=t.colFrom(),a=r.NULL,s=function(t,s){a!==s&&(a!==r.NULL&&i[a].push(new g.e6w(n,o,1,t-o,e)),o=t,a=s)},u=t.colFrom();u<=t.colTo();u++){var l=t.sheet();P(n,u,l)?s(u,r.NORMAL_HYPERLINK):L(n,u,l)?s(u,r.FORMULA_HYPERLINK_UNHIDE):D(n,u,l)?s(u,r.FORMULA_HYPERLINK_HIDE):(a!==r.NULL&&i[a].push(new g.e6w(n,o,1,u-o,l)),o=u,a=r.NULL)}a!==r.NULL&&i[a].push(new g.e6w(n,o,1,t.colTo()-o+1,e))},o=t.rowFrom();o<=t.rowTo();o++)n(o)})),i}function M(e,t,n,r){var i;((0,l.isDataURL)(n)&&(n=""),t)||(t=r&&"'".concat((null===(i=e.getSheetFromId(r.sheetId))||void 0===i?void 0:i.name())||"","'").concat(r.rangeId?"!".concat((0,h.oc)(r.rangeId)):"")||n);return n&&!(0,l.hasUrlProtocol)(n)&&(n=(0,l.completeURLProtocol)(n)),{text:t,link:n}}function k(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"seg",a=arguments.length>6?arguments[6]:void 0,s=arguments.length>7?arguments[7]:void 0,u=M(e,i,r,s);i=u.text,r=u.link;var l,c,h=e.getActiveSheet(),f=h.getFormulaHyperLink(t,n);f?(l=I(r,i,f),c="edit_hyperlink_link"):(l=x(h,t,n,r,i,o,a,s),c="edit_normal_link"),h.setCellValue(t,n,l),(0,d.collectSuiteEvent)("sheet_opration",{action:"hyperlink",source:"body",op_item:c,eventType:"click",object_id:h&&h.id()})}function I(e,t,n){t=t.replace(/\"/g,'""');var r='"'.concat(t,'"');n&&("number"==typeof n[0].text&&(r="".concat(function(e){var t=/^[0-9]*\.?[0-9]*$/.test(e.toString()),n=e;t&&(n=parseFloat(e));return n}(t))));return'=HYPERLINK("'.concat(e,'", ').concat(r,")")}function x(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"seg",a=arguments.length>6?arguments[6]:void 0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,u=(0,f.getCommentCopyLinkEnableV2)()&&/comment_id=\d+/.test(r)&&/comment_anchor=true/.test(r);(0,l.isSameFileToken)(window.location.href,r,"sheet")&&!u&&(r=(s=(0,v.XwI)(r))?"":r);var c=e.getSegmentArray(t,n);if(Array.isArray(c)&&"seg"===o){for(var h=a&&a.seg,d=[],p=0;p<c.length;p++){var g=c[p];if(h&&h.idx===p)if(r||s){var _={type:v.K6s.URL,text:i,link:r};s&&(_.cellPosition=s),g.text===i?(Array.isArray(g.texts)&&(_.texts=g.texts),g.style&&(_.style=g.style)):0===p?(g.style&&(_.style=g.style),Array.isArray(g.texts)&&g.texts[0].style&&(_.style=g.texts[0].style)):c[p-1].style&&(_.style=c[p-1].style),d.push(_)}else d.push({type:v.K6s.TEXT,text:i});else d.push(Object.assign({},g))}return d}if(!r&&!s)return i;if(Array.isArray(c)&&c.some((function(e){return!!e.style||!!e.texts}))){var y=[];return c.forEach((function(e){e.texts?e.texts.forEach((function(e){return y.push(N(e))})):e.text&&y.push(N(e))})),[{type:v.K6s.URL,texts:y,link:r,text:i,cellPosition:s}]}return[{type:"url",text:i,link:r,cellPosition:s}]}function N(e){var t={type:v.K6s.TEXT,text:e.text};return e.style&&(t.style=e.style),t}function P(e,t,n){if(!n)return!1;var r=n.getSegmentArray(e,t);return!!r&&r.some((function(e){return"url"===e.type}))}function L(e,t,n){if(!n)return!1;var r=n.getStyle(e,t);return(!r||!r.hideLink)&&!!n.getFormulaHyperLink(e,t)}function D(e,t,n){if(!n)return!1;var r=n.getStyle(e,t);return!(!r||!r.hideLink)&&!!n.getFormulaHyperLink(e,t)}function F(e,t){var n=t.sheetId,r=e.getSheetFromId(n);if(!r)return!1;if(r&&!t.rangeId)return!0;var i,o=(0,E.O$)(t),a=o.rangeId,s=o.rangeToken;if(a)return!0;var u=(0,h.oc)(s||"");return!!(i=r.rangeStringToRange(u))&&!(0,p.h_)(r,i)}function B(e,t,n){if(!t)return"";if(v.G9b.lastIndex=0,v.G9b.test(t))return t;if("object"===(0,o.Z)(t))return t;var r="",i="",a=t.split("!"),s=a.shift();if(!s)return"";s=s.replace(/\'/g,"");var u=e.getSheetFromName(s);if(u){if(r=u.id(),a.length){var l=a.shift();if(!(0,p.w0)(l))return t;l=l.toUpperCase().replace(/\：/g,":"),i=(0,h.ew)(l).replace(/=*$/,"")}else if(!n)return t}else{if(!(0,p.w0)(s))return s;s=s.replace(/\：/g,":");var c=e.getActiveSheet();s=s.toUpperCase(),i=(0,h.ew)(s).replace(/=*$/,""),r=c.id()}return{sheetId:r,rangeId:i}}function V(e,t){if(!t)return"";var n=e.getSheetFromId(t.sheetId),r=n&&n.name();if(!n||!r)return"";if(t.rangeId){var i=(0,E.O$)(t),o=i.rangeId,a=i.rangeToken;if(o){var s=n.rangeModel.getRangeFromId(o),u="";if(s){var l=(0,g.jJ3)(s,e);u=(0,g.Bym)([l])}return"'".concat(r,"'!").concat(u)}var c=(0,h.oc)(a),d=n.rangeStringToRange(c);if((0,p.h_)(n,d)&&d){var f=(0,p.H5)(n,d);c=(0,g.Ywm)(f)}return"'".concat(r,"'!").concat(c)}return"".concat(r)}function H(e,t){if(t){if("string"==typeof(t=B(e,t)))return y.k.NORMAL_URL;var n=t,r=e.getSheetFromId(n.sheetId);if(!r)return y.k.SHEET_DELETED;var i=(0,E.O$)(n),o=i.rangeId,a=i.rangeToken,s=null;if(o){var u=r.rangeModel.getRangeFromId(o);u&&(s=(0,g.jJ3)(u,e))}else{var l=(0,h.oc)(a);if(!l)return y.k.SHEET_EXIST;s=r.rangeStringToRange(l)}return s?(0,p.h_)(r,s)?(0,p.H5)(r,s)?y.k.RANGE_PART:y.k.RANGE_OVERFLOW:y.k.RANGE_Full:y.k.RANGE_OVERFLOW}}function U(e,t){if(!t||!e)return i.NORMAL_HYPERLINK;switch(e){case y.k.NORMAL_URL:return i.NORMAL_HYPERLINK;case y.k.RANGE_Full:case y.k.RANGE_OVERFLOW:case y.k.RANGE_PART:var n=t.rangeId;return(n?(0,h.oc)(n):"").includes(":")?i.CELL_SELECTION:i.SINGLE_CELL;case y.k.SHEET_EXIST:case y.k.SHEET_DELETED:return i.SHEET;default:return i.NORMAL_HYPERLINK}}function Z(e){return{link:(0,l.completeURLProtocol)((0,E.If)(e)),extraInfo:{hyperlink_cellPosition:JSON.stringify(e)}}}!function(e){e.NORMAL_HYPERLINK="normalHyperlink",e.FORMULA_HYPERLINK_UNHIDE="formulaHyperlinkUnhide",e.FORMULA_HYPERLINK_HIDE="formulaHyperlinkHide",e.NULL="null"}(r||(r={})),function(e){e.NORMAL_HYPERLINK="normal_hyperlink",e.SHEET="sheet",e.CELL_SELECTION="cell_selection",e.SINGLE_CELL="single_cell"}(i||(i={}))},vsh_13449:function(e,t,n){"use strict";var r;n.d(t,{k:function(){return r}}),function(e){e.NORMAL_URL="NORMAL_URL",e.PANO_URL="PANO",e.RANGE_Full="RANGE_Full",e.RANGE_PART="RANGE_PART",e.RANGE_OVERFLOW="RANGE_OVERFLOW",e.SHEET_EXIST="SHEET_EXIST",e.SHEET_DELETED="SHEET_DELETED"}(r||(r={}))},vsh_9852:function(e,t,n){"use strict";n.d(t,{ag:function(){return r},r3:function(){return i},_$:function(){return o},Ll:function(){return a},Ol:function(){return s},wA:function(){return u},qw:function(){return l},rV:function(){return c},mz:function(){return h},U_:function(){return d}});var r="app/i18n",i="app/collectEvent",o="app/CCMEventTracking",a="app/showToast",s="app/showError",u="app/reduxStore",l="app/showToastInfo",c="app/showModal",h="app/onboarding/addSteps",d="app/onboarding/STEP_TYPES"},vsh_23640:function(e,t,n){"use strict";n.d(t,{T:function(){return E}});var r=n("vsh_8282"),i=n("vsh_9852"),o=n("vsh_79915"),a=n("vsh_72586"),s=n("vsh_11790"),u=n("vsh_60140"),l=n("vsh_42907"),c=n("vsh_96579"),h=n("vsh_24627"),d=n("vsh_60591"),f=n("vsh_18801"),p=n("vsh_23585"),v=n("vsh_12484"),g=n("vsh_82905"),_=n("vsh_17724"),y=n("vsh_4644"),m=n("vsh_73043"),E=function(){var e=d.Toast.show.bind(d.Toast),t=d.Toast.info.bind(d.Toast),n=p.Modal.show.bind(p.Modal),E=function(e){var t=new r.W;return t.bind(i.ag).toDynamicValue(e.getI18n).inSingletonScope(),t.bind(i.r3).toDynamicValue(e.getCollectEvent).inSingletonScope(),t.bind(i._$).toDynamicValue(e.getCCMEventTracking).inSingletonScope(),t.bind(i.Ll).toDynamicValue(e.getShowToast).inSingletonScope(),t.bind(i.Ol).toDynamicValue(e.getShowError).inSingletonScope(),t.bind(i.wA).toDynamicValue(e.getReduxStore).inSingletonScope(),t.bind(i.qw).toDynamicValue(e.getShowToastInfo).inSingletonScope(),t.bind(o.F).toSelf().inSingletonScope(),t.bind(a.E).toSelf().inSingletonScope(),t.bind(s.n).toSelf().inSingletonScope(),t.bind(u.B).toSelf().inSingletonScope(),t.bind(l.y).toSelf().inSingletonScope(),t.bind(i.rV).toDynamicValue(e.getShowModal).inSingletonScope(),t.bind(i.mz).toDynamicValue(e.getAddSteps).inSingletonScope(),t.bind(i.U_).toDynamicValue(e.getSTEP_TYPES).inSingletonScope(),t}({getI18n:function(){return m},getCCMEventTracking:function(){return function(e,t){return(0,c.ccmEventTracking)(e,Object.assign({},(0,h.dK5)(),{},t))}},getCollectEvent:function(){return c.collectSuiteEvent},getShowToast:function(){return e},getReduxStore:function(){return f.store},getShowError:function(){return y.o0},getShowModal:function(){return n},getShowToastInfo:function(){return t},getAddSteps:function(){return f.addSteps},getSTEP_TYPES:function(){return v.STEP_TYPES}});return E.bind(g.Qh).to(_.S).inSingletonScope(),E}},vsh_60140:function(e,t,n){"use strict";n.d(t,{B:function(){return _}});var r=n("vsh_19264"),i=n("vsh_4175"),o=n("vsh_65498"),a=n("vsh_22392"),s=n("vsh_99520"),u=n("vsh_47531"),l=n("vsh_64299"),c=n("vsh_9852"),h=function(e,t,n,r){var i,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":(0,o.Z)(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(i=e[u])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},d=function(e,t){return function(n,r){t(n,r,e)}},f=function(){return{}},p=function(){return{}},v={SHEET:3},g=n("vsh_18856");f=g.selectCurrentSuiteByObjToken,p=n("vsh_66242").F,v=n("vsh_12484").NUM_FILE_TYPE;var _=function(){function e(t){var n=this;(0,r.Z)(this,e),this.store=t,this._documentInfo$=new l.X(void 0),this.unsubscribeStore=t.subscribe((function(){if(!n.suiteToken){var e=t.getState(),r=f(e);r!==n.immutableJsDocumentInfo&&(n._documentInfo$.next(null==r?void 0:r.toJS()),n.immutableJsDocumentInfo=r)}})),this.documentInfo$=this._documentInfo$.asObservable()}return(0,i.Z)(e,[{key:"setSuiteToken",value:function(e){var t=this;if(this.suiteToken=e,!this.suiteToken){var n=this.store.getState(),r=f(n);return this._documentInfo$.next(null==r?void 0:r.toJS()),void(this.immutableJsDocumentInfo=r)}this._documentInfo$.next(void 0),this.immutableJsDocumentInfo=void 0,p(v.SHEET,this.suiteToken).then((function(n){if(t.suiteToken&&e===t.suiteToken){if(!n)throw new Error("接口返回空：".concat(n));t._documentInfo$.next(Object.assign({},n,{obj_token:t.suiteToken}))}})).catch((function(e){console.log("获取 meta 失败, error:",e)}))}},{key:"destroy",value:function(){this.unsubscribeStore(),this._documentInfo$.complete(),this.immutableJsDocumentInfo=void 0}},{key:"documentInfo",get:function(){return this._documentInfo$.getValue()}},{key:"ownerId",get:function(){var e;return null===(e=this._documentInfo$.getValue())||void 0===e?void 0:e.owner_id}}]),e}();h([(0,a.P)()],_.prototype,"destroy",null),_=h([(0,s.b)(),d(0,(0,u.f)(c.wA))],_)},vsh_42907:function(e,t,n){"use strict";n.d(t,{y:function(){return m}});var r=n("vsh_19264"),i=n("vsh_4175"),o=n("vsh_65498"),a=n("vsh_99520"),s=n("vsh_47531"),u=n("vsh_4285"),l=n("vsh_57181"),c=n("vsh_56489"),h=n("vsh_82905"),d=n("vsh_9852"),f=n("vsh_60140"),p=n("vsh_11790"),v=function(e,t,n,r){var i,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":(0,o.Z)(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(i=e[u])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},g=function(e,t){return function(n,r){t(n,r,e)}},_=function(){return{}},y=n("vsh_18856");_=y.selectCurrentSuiteOtherPermissions;var m=function(){function e(t,n,i,o){var a=this;(0,r.Z)(this,e),this.document=n,this.user=i,this.conditionalAccessControlService=o;var s=new u.y((function(e){var n=function(){var n=t.getState(),r=_(n);e.next(r)};return n(),t.subscribe(n)})).pipe((0,l.d)(1));this.copyable$=s.pipe((0,c.map)((function(e){return a.conditionalAccessControlService.preCheck(h.Vw.FILECONTENTCOPY)&&e.copyable}))),this.createCopyAble$=s.pipe((0,c.map)((function(e){return a.conditionalAccessControlService.preCheck(h.Vw.FILECREATECOPY)&&e.createCopyAble}))),this.saveGlobalTemplateAble$=s.pipe((0,c.map)((function(e){return a.conditionalAccessControlService.preCheck(h.Vw.FILECREATECOPY)&&e.saveGlobalTemplateAble}))),this.exportable$=s.pipe((0,c.map)((function(e){return a.conditionalAccessControlService.preCheck(h.Vw.DOCEXPORT)&&e.exportable}))),this.printable$=s.pipe((0,c.map)((function(e){return a.conditionalAccessControlService.preCheck(h.Vw.DOCPRINT)&&e.printable})))}return(0,i.Z)(e,[{key:"getIsOnwer",value:function(){var e=this.document.ownerId;return this.user.userInfo.suid===e}}]),e}();m=v([(0,a.b)(),g(0,(0,s.f)(d.wA)),g(1,(0,s.f)(f.B)),g(2,(0,s.f)(p.n)),g(3,(0,s.f)(h.Qh))],m)},vsh_79915:function(e,t,n){"use strict";n.d(t,{F:function(){return h}});var r=n("vsh_19264"),i=n("vsh_4175"),o=n("vsh_65498"),a=n("vsh_99520"),s=n("vsh_47531"),u=n("vsh_9852"),l=function(e,t,n,r){var i,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":(0,o.Z)(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(i=e[u])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},c=function(e,t){return function(n,r){t(n,r,e)}},h=function(){function e(t,n,i,o){(0,r.Z)(this,e),this.showToast=t,this.showModalMethod=n,this._showToastInfo=i,this._showError=o}return(0,i.Z)(e,[{key:"showInfo",value:function(e){return this.showToast(Object.assign({type:"info"},e))}},{key:"showToastInfo",value:function(){return this._showToastInfo.apply(this,arguments)}},{key:"showModal",value:function(){return this.showModalMethod.apply(this,arguments)}},{key:"showError",value:function(){return this._showError.apply(this,arguments)}}]),e}();h=l([(0,a.b)(),c(0,(0,s.f)(u.Ll)),c(1,(0,s.f)(u.rV)),c(2,(0,s.f)(u.qw)),c(3,(0,s.f)(u.Ol))],h)},vsh_72586:function(e,t,n){"use strict";n.d(t,{E:function(){return E}});var r=n("vsh_19264"),i=n("vsh_4175"),o=n("vsh_65498"),a=n("vsh_99520"),s=n("vsh_47531"),u=n("vsh_4285"),l=n("vsh_71561"),c=n("vsh_56489"),h=n("vsh_57181"),d=n("vsh_9852"),f=function(e,t,n,r){var i,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":(0,o.Z)(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(i=e[u])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},p=function(e,t){return function(n,r){t(n,r,e)}},v=function(){return{}},g=function(){return{}},_=function(){return{}},y=n("vsh_14801");_=y.closeUserGuide;var m=n("vsh_18856");v=m.selectFetchStatus,g=m.selectUserGuide;var E=function(){function e(t,n,i){var o=this;(0,r.Z)(this,e),this.store=t,this.innerAddSteps=n,this.stepTypes=i,this.addSteps=function(){return o.innerAddSteps.apply(o,arguments)},this.userGuide$=new u.y((function(e){return t.subscribe((function(){var n=t.getState(),r=g(n);e.next(r)}))})).pipe((0,l.distinctUntilChanged)(),(0,c.map)((function(e){return e.toJS()})),(0,h.d)(1)),this.moduleReady$=new u.y((function(e){return t.subscribe((function(){var n=t.getState(),r="loaded"===v("userGuide")(n);e.next(r)}))})).pipe((0,l.distinctUntilChanged)(),(0,h.d)(1))}return(0,i.Z)(e,[{key:"getUserGuideStateByKey",value:function(e){var t=this.store.getState().gpe_common_user_guide.get("guides").get(e).toJS();return t||{}}},{key:"getIsDoneByKey",value:function(e){var t=this.getUserGuideStateByKey(e);return Boolean(t.is_done)}},{key:"tryCloseUserGuideIfNessecary",value:function(e){this.getIsDoneByKey(e)&&this.store.dispatch(_(e))}}]),e}();E=f([(0,a.b)(),p(0,(0,s.f)(d.wA)),p(1,(0,s.f)(d.mz)),p(2,(0,s.f)(d.U_))],E)},vsh_11790:function(e,t,n){"use strict";n.d(t,{n:function(){return v}});var r=n("vsh_19264"),i=n("vsh_4175"),o=n("vsh_65498"),a=n("vsh_99520"),s=n("vsh_47531"),u=n("vsh_4285"),l=n("vsh_57181"),c=n("vsh_9852"),h=function(e,t,n,r){var i,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":(0,o.Z)(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(i=e[u])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},d=function(e,t){return function(n,r){t(n,r,e)}},f=function(){return{}},p=n("vsh_18856");f=p.selectCurrentUser;var v=function(){function e(t){(0,r.Z)(this,e),this.user$=new u.y((function(e){return t.subscribe((function(){var n=t.getState(),r=f(n);e.next(r)}))})).pipe((0,l.d)(1)),this.user$.getValue=function(){var e=t.getState();return f(e)}}return(0,i.Z)(e,[{key:"userInfo",get:function(){return this.user$.getValue}}]),e}();v=h([(0,a.b)(),d(0,(0,s.f)(c.wA))],v)},vsh_95418:function(e,t,n){"use strict";n.d(t,{$:function(){return E}});n("vsh_1278");var r=n("vsh_72834"),i=n("vsh_7959"),o=n("vsh_46544"),a=n("vsh_91331"),s=n("vsh_19264"),u=n("vsh_4175"),l=n("vsh_65498"),c=n("vsh_99520"),h=n("vsh_47531"),d=n("vsh_24627"),f=n("vsh_9852"),p=n("vsh_79915"),v=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":(0,l.Z)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},g=function(e,t){return function(n,r){t(n,r,e)}},_=function(){function e(t,n){(0,s.Z)(this,e),this.toast=t,this.t=n}return(0,u.Z)(e,[{key:"showSplitCellsModal",value:function(e,t){var n=this,r=e.toJSON(),i=r.row,o=r.col,a=r.rowCount,s=r.colCount,u="".concat((0,d.hdC)(o)).concat(i+1),l="".concat((0,d.hdC)(o+s-1)).concat(i+a),c="".concat(u," : ").concat(l),h="",f=t.size;return h=1===f?this.t("LarkCCM_Sheets_InsertOrDeleteCell_ThisActionWillSplitCell_Description",{cellRange:c}):this.t("LarkCCM_Sheets_InsertOrDeleteCell_ThisActionWillMultipleCell_Description",{cellRange:c,num:f}),new Promise((function(e){n.toast.showModal({title:n.t("LarkCCM_Sheets_InsertOrDeleteCell_ThisActionWillSplitCell_Title"),body:h,confirmText:n.t("common.confirm"),cancelText:n.t("common.cancel"),onConfirm:function(){e({result:!0})},onCancel:function(){e({result:!1}),console.info("存在相交的合并单元格，需要拆分，但用户不同意拆分，因此终止整个流程")}})}))}},{key:"showDeniedProtectionModal",value:function(){this.toast.showError(d.ZB9.ERROR_EDIT_PROTECTED_RANGE,void 0,"add-or-delete-cell")}}]),e}();_=v([(0,c.b)(),g(0,(0,h.f)(p.F)),g(1,(0,h.f)(f.ag))],_);var y=n("vsh_73618"),m=n("vsh_29098"),E=function(e){return function(e){return e.bind(m.G).toSelf().inSingletonScope(),e.bind(y.y).toSelf().inSingletonScope(),e.bind(a.g).toSelf().inSingletonScope(),e.bind(o.Xg).to(_).inSingletonScope(),e.bind(r.bA2).toSelf().inSingletonScope(),e.bind(i.WPM).toSelf().inSingletonScope(),(0,o.Hw)(e),e}(e)}},vsh_91331:function(e,t,n){"use strict";n.d(t,{g:function(){return c}});var r=n("vsh_19264"),i=n("vsh_4175"),o=n("vsh_65498"),a=n("vsh_47531"),s=n("vsh_99520"),u=n("vsh_72834"),l=function(e,t,n,r){var i,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":(0,o.Z)(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(i=e[u])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},c=function(){function e(){(0,r.Z)(this,e)}return(0,i.Z)(e,[{key:"contents2ValueList",value:function(e){return(0,u.wZO)(this.sheetFacade,this.viewsModel.getCurrentFilterModel(),e)}}]),e}();l([(0,a.f)(u.jTu)],c.prototype,"sheetFacade",void 0),l([(0,a.f)(u.SdI)],c.prototype,"viewsModel",void 0),c=l([(0,s.b)()],c)},vsh_73618:function(e,t,n){"use strict";n.d(t,{y:function(){return _}});var r=n("vsh_19264"),i=n("vsh_65498"),o=n("vsh_99520"),a=n("vsh_47531"),s=n("vsh_9852"),u=n("vsh_4285"),l=n("vsh_71561"),c=n("vsh_57181"),h=n("vsh_62536"),d=function(e,t,n,r){var o,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":(0,i.Z)(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(s=(a<3?o(s):a>3?o(t,n,s):o(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},f=function(e,t){return function(n,r){t(n,r,e)}},p=function(){return{}},v=function(){return{}},g=n("vsh_13885");p=g.commentableSelector,v=g.editablePermissionSelector;var _=function e(t){(0,r.Z)(this,e),this.commentable$=new u.y((function(e){return t.subscribe((function(){var n=t.getState(),r=!!n.sheet&&p(n);e.next(r)}))})).pipe((0,l.distinctUntilChanged)(),(0,c.d)(1)),this.editable$=new u.y((function(e){return t.subscribe((function(){var n=t.getState(),r=v(n);e.next(r)}))})).pipe((0,l.distinctUntilChanged)(),(0,c.d)(1),(0,h.O)(v(t.getState())))};_=d([(0,o.b)(),f(0,(0,a.f)(s.wA))],_)},vsh_29098:function(e,t,n){"use strict";n.d(t,{G:function(){return y}});var r=n("vsh_19264"),i=n("vsh_4175"),o=n("vsh_65498"),a=n("vsh_86982"),s=n("vsh_99520"),u=n("vsh_47531"),l=n("vsh_72834"),c=n("vsh_79915"),h=n("vsh_9852"),d=n("vsh_75071"),f=n("vsh_56489"),p=n("vsh_22052"),v=n("vsh_24627"),g=function(e,t,n,r){var i,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":(0,o.Z)(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(i=e[u])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},_=function(e,t){return function(n,r){t(n,r,e)}},y=function(){function e(t,n,i,o,a,s,u,c,h,v,g,_){var y=this;(0,r.Z)(this,e),this.viewsModel=t,this.rangeFactory=n,this.toast=i,this.t=o,this.collectSuiteEvent=a,this.ccmEventTracking=s,this.command=u,this.commandManager=c,this.sheetInfo=h,this.spread=v,this.sheet=g,this.selection=_,this.filterThreshold=1048576,this.activeViewModelRange$=this.viewsModel.activeView$.pipe((0,d.w)((function(e){return e?e.filterModel.currentRange$:(0,p.of)(void 0)}))).pipe((0,d.w)((function(e){return e?e.$:(0,p.of)(void 0)}))),this.activeViewModelRangeString$=this.activeViewModelRange$.pipe((0,f.map)((function(e){return e?y.rangeFactory.selectionsToString([e]):""}))),this.activeViewModelName$=this.viewsModel.activeView$.pipe((0,d.w)((function(e){return e?e.name$:(0,p.of)("")}))),this.modifyCurrentActiveViewName=function(e){var t=y.viewsModel.activeView;if(!t)return!1;if(y.collectSuiteEvent("sheet_opration",{action:"filter_view_rename",filterview_status:"collaborative"}),y.ccmEventTracking("ccm_sheet_filter_page_click",{click:"rename_filter_view",target:"none",view_id:t.getId()}),y.checkNameInvalid(e))return!1;(y.commandManager.execute({cmd:"set_view",sheetId:y.sheetInfo.id,isLocal:y.viewsModel.isTempView(t),value:{viewId:t.getId(),type:"name",name:e,originName:t.getName()}}),y.viewsModel.isTempView(t))&&(y.handleAddFilterView(!0,!0,void 0,void 0,e,{viewName:t.getName(),viewId:t.getId()},"rename")&&y.toast.showInfo({content:y.t("CreationDoc_Sheets_View_RenameToast"),duration:2500,type:"success"}));return!0},this.modifyCurrentActiveViewRange=function(e,t){var n=y.viewsModel.activeView;if(!n)return!1;var r=y.viewsModel.isTempView(n);y.collectSuiteEvent("sheet_opration",{action:"filter_view_update_range",filterview_status:r?"local":"collaborative"}),y.ccmEventTracking("ccm_sheet_filter_page_click",{click:"change_filter_area",sub_click:"direct_change",target:"none",view_id:n.getId(),view_type:r?"local":"collaborative",sheet_user_permission:t?"edit":"read_only"});var i=y.rangeFactory.rangeStringToRange(e);return!i||y.rangeFactory.isOverflowRange(i)?(y.toast.showInfo({content:y.t("sheets.filter_view.filter_range_wrong"),duration:2500}),!1):((0,l.zFf)(y.sheet,i),y.command.setViewRange(n.getId(),i.toJSON()),!0)},this.createPersonalViewId=function(){return y.viewsModel.assignPersonalViewId()}}return(0,i.Z)(e,[{key:"getSetFilterValueForAddView",value:function(e){var t=this.viewsModel.getCurrentFilterModel().getFilterRange(),n=this.viewsModel.getAllColFilterInfo().map((function(e){return(0,a.Z)(e,["col","type","compare","expected","contents","dateGroups"])}));if(!e)return{range:t,filterItemList:n};var r=e.col,i=n.findIndex((function(e){return e.col===r}));return i>-1&&n.splice(i,1),(0,l.$4z)(e)||n.push(e),{range:t,filterItemList:n}}},{key:"handleAddFilterView",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"save_button",s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=this.viewsModel.getViewList();if(!s&&u.length>150&&!o)return this.collectSuiteEvent("sheet_opration",{action:"filter_view_ceiling",source:"amount"}),this.toast.showModal({title:this.t("sheets.filter_view.filter_quantity_limit_title"),body:this.t("sheets.filter_view.filter_quantity_limit_copy"),confirmText:this.t("sheets.filter_view.permission_got_it"),cancelText:""}),!1;var l=!e;if(!l){var c=this.spread.sheets.reduce((function(e,t){return JSON.stringify(t.viewsModel.toJSON()).length+e}),0);l=c>this.filterThreshold}var h=this.viewsModel.assignViewId(!l),d=t?this.getSetFilterValueForAddView(n):{range:this.selection.getResponsableFilterRange().toJSON(),filterItemList:void 0},f=d.range,p=d.filterItemList;if(r&&r.shouldClear&&p&&(p=p.filter((function(e){return e.col!==r.col}))),e&&l)return this.collectSuiteEvent("sheet_opration",{action:"filter_view_ceiling",source:"threshold"}),this.toast.showToastInfo({closable:!0,actionText:this.t("CreationDoc_Sheets_BeAwared"),content:this.t("CreationDoc_TooMuchFiltering_Toast")}),!1;e&&this.ccmEventTracking("ccm_sheet_filter_page_click",{click:"create_cooperation_filter_view",target:"none",create_method:a});var v={range:f,filterItemList:p,viewId:h,viewName:i};return o?this.sheet.transFilterView(o.viewId,o.viewName,v):this.sheet.addFilterView(l,v),this.viewsModel.tryEntryViewById(h),t||this.selection.setSelection(this.rangeFactory.createRange(f.row,f.col,1,1)),!0}},{key:"handleAddPersonalView",value:function(e){var t=this.viewsModel.assignPersonalViewId(),n=this.getSetFilterValueForAddView(e),r=n.range,i=n.filterItemList;this.sheet.addFilterView(!0,{range:r,filterItemList:i,viewId:t}),this.viewsModel.tryEntryViewById(t)}},{key:"handleExitPersonalView",value:function(e){var t=this.viewsModel.activeView;if(t&&(0,v.y_b)(t.getId())){var n=t.getId(),r=t.getName(),i=t.filterModel.filterRange;if(i){var o=e.col;this.syncViewFilterResultToSheet(n,{excludeCols:[o]});var a=(0,l.$4z)(e)?null:e;this.sheet.setFilter(i,o,a),this.sheet.delFilterView(n,r)}}}},{key:"syncViewFilterResultToSheet",value:function(e,t){var n=t.excludeCols,r=void 0===n?[]:n,i=this.viewsModel.getViewById(e),o=null==i?void 0:i.filterModel,a=null==o?void 0:o.filterRange;if(a)for(var s=this.sheet.sheetFilterModel.getValidFilterRules(),u=new Set(s.keys()),l=a.colCount(),c=a.colFrom(),h=c;h<c+l;h++)if(!r.includes(h)){var d=o.getFilterInfo(h);d||!u.has(h)?d&&this.sheet.setFilter(a,d.col,d):this.sheet.setFilter(a,h,null)}}},{key:"checkNameInvalid",value:function(e){var t=this,n=function(e){return t.toast.showInfo({content:e,duration:2500})};return""===e.trim()?(n(this.t("sheets.filter_view.filter_name_cant_empty")),!0):e.length>1e3?(n(this.t("sheets.filter_view.filter_name_toolong")),!0):!!this.viewsModel.isNameExit(e)&&(n(this.t("sheets.filter_view.filter_name_exist")),!0)}},{key:"tryEnterViewById",value:function(e){this.viewsModel.tryEntryViewById(e)}}]),e}();y=g([(0,s.b)(),_(0,(0,u.f)(l.SdI)),_(1,(0,u.f)(l.QWZ)),_(2,(0,u.f)(c.F)),_(3,(0,u.f)(h.ag)),_(4,(0,u.f)(h.r3)),_(5,(0,u.f)(h._$)),_(6,(0,u.f)(l.ZJ7)),_(7,(0,u.f)(l.DsI)),_(8,(0,u.f)(l.bRw)),_(9,(0,u.f)(l.Wje)),_(10,(0,u.f)(l.SJM)),_(11,(0,u.f)(l.Y19))],y)},vsh_25534:function(e,t,n){"use strict";n.d(t,{e:function(){return b}});var r=n("vsh_74561"),i=n("vsh_19264"),o=n("vsh_4175"),a=n("vsh_65498"),s=n("vsh_96636"),u=n("vsh_22392"),l=n("vsh_99520"),c=n("vsh_47531"),h=n("vsh_72834"),d=n("vsh_18801"),f=n("vsh_60591"),p=n("vsh_83190"),v=n("vsh_76197"),g=n("vsh_11042"),_=n("vsh_24627"),y=n("vsh_73043"),m=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":(0,a.Z)(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(i=e[u])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},E=function(e,t){return function(n,r){t(n,r,e)}},b=function(){function e(t){var n=this;(0,i.Z)(this,e),this.spread=t,this.sdk=null,this.beforeEditingCellContent=null,this.endingEditingText=null,this.eCell=null,this.subscriber=null,this.onEditingCellChanged=function(e){if(e){var t=e.row,r=e.col;n.eCell=e,n.beforeEditingCellContent=n.getCellFormulaOrText(t,r)}else{if(null!==n.endingEditingText&&n.beforeEditingCellContent!==n.endingEditingText){var i=n.eCell,o=i.row,a=i.col,s=n.getCellFormulaOrText(o,a);n.endingEditingText!==s&&n.showToastAndCellHistory(o,a,n.endingEditingText)}n.eCell=null,n.endingEditingText=null,n.beforeEditingCellContent=null}},this.showToastAndCellHistory=(0,s.default)((function(e,t,r){f.Toast.show({key:"warn-collab-edit",type:"warning",content:y("LarkCCM_Sheets_EditCell_ReplacedEdit_Toast"),duration:5e3,closable:!0}),(0,v.le)("ccm_sheet_multi_editing_toast_view"),n.spread.getActiveSheet().setActiveCell(e,t),d.store.dispatch((0,p.showCellHistory)(r))}),500),this.handleBeforeEditorIdle=function(){if(n.eCell){var e=n.getCellFormulaOrText(n.eCell.row,n.eCell.col);n.endingEditingText=e}}}return(0,o.Z)(e,[{key:"init",value:function(e){this.sdk=e,this.bindEvents()}},{key:"getCellFormulaOrText",value:function(e,t){var n=this.spread.getActiveSheet(),r=n.getFormula(e,t),i="";if(r)i=("="===r[0]?"":"=")+r;else{var o=n.getReminderJSON(e,t);if(o)i=(0,g.dp)(o.expireTime);else i=this.getEmbedImageLink(n,e,t)||n.getText(e,t)}return i}},{key:"getEmbedImageLink",value:function(e,t,n){var r=e.getSegmentArray(t,n);return r&&r[0].type===_.K6s.EMBED_IMAGE?r[0].link:""}},{key:"getDepends",value:function(){return(0,r.Z)({},_.U_F.BeforeEditorIdle,this.handleBeforeEditorIdle)}},{key:"bindEvents",value:function(){var e,t;this.spread&&(this.subscriber=null===(e=this.sdk)||void 0===e?void 0:e.spread.subscribe(this.getDepends()),null===(t=this.sdk)||void 0===t||t.watchPluginState("CellEditorStore/editingCell",this.onEditingCellChanged))}},{key:"unbindEvents",value:function(){var e,t;null===(e=this.sdk)||void 0===e||e.unwatchPluginState("CellEditorStore/editingCell",this.onEditingCellChanged),null===(t=this.subscriber)||void 0===t||t.unsubscribe()}},{key:"destroy",value:function(){this.unbindEvents(),this.sdk=null,this.subscriber=null}}]),e}();m([(0,u.P)()],b.prototype,"destroy",null),b=m([(0,l.b)(),E(0,(0,c.f)(h.Wje))],b)},vsh_68635:function(e,t,n){"use strict";n.d(t,{f:function(){return S}});var r,i=n("vsh_85502"),o=n("vsh_46544"),a=n("vsh_82905"),s=n("vsh_25534"),u=n("vsh_19264"),l=n("vsh_4175"),c=n("vsh_12064"),h=n("vsh_56589"),d=n("vsh_22462"),f=n("vsh_73455"),p=n("vsh_65498"),v=n("vsh_27185"),g=n.n(v),_=n("vsh_22392"),y=n("vsh_99520"),m=n("vsh_47531"),E=n("vsh_86217"),b=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":(0,p.Z)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},T=function(e,t){return function(n,r){t(n,r,e)}},C=r=function(e){function t(e){var n;return(0,u.Z)(this,t),(n=(0,c.Z)(this,(0,d.Z)(t).call(this))).reporterService=e,n.instanceId=(1e3*Math.random()).toFixed(0),n.contentList=[],n.flushTimer=0,n.flush=function(){window.clearTimeout(n.flushTimer),n.flushTimer=0,n.contentList.length&&(n.reporterService.eventReportWithTemplate(E.n.SheetPathTracker,{info:n.contentList.join("|")}),n.contentList.length=0)},a.mQ.logger=n.initDebug(),window.addEventListener("beforeunload",n.flush),n}return(0,f.Z)(t,e),(0,l.Z)(t,[{key:"initDebug",value:function(){var e=g()(a.mQ.mainScope),t=g()("".concat(a.mQ.mainScope,":error"));return{log:e,info:g()("".concat(a.mQ.mainScope,":info")),error:t,enable:function(e){g().enable(e)},enabled:function(){return g().enabled(a.mQ.mainScope)},disable:function(){return g().enable("-".concat(a.mQ.mainScope))}}}},{key:"log",value:function(e,n,i,o){var a,s=this;(0,h.Z)((0,d.Z)(t.prototype),"log",this).call(this,e,n,i,o),this.contentList.push("".concat((a=new Date,"".concat(a.getFullYear(),"-").concat(a.getMonth()+1,"-").concat(a.getDate()," ").concat(a.getHours(),":").concat(a.getMinutes(),":").concat(a.getSeconds(),".").concat(a.getMilliseconds()))," ").concat(this.instanceId," [").concat(e,"] ").concat(n)),this.contentList.length>=r.MAX_LOG_LENGTH?this.flush():this.flushTimer||(this.flushTimer=window.setTimeout((function(){s.flush()}),r.MAX_FLUSH_INTERVAL))}},{key:"error",value:function(e,n,r,i){(0,h.Z)((0,d.Z)(t.prototype),"error",this).call(this,e,n,r,i),this.log(e,n)}},{key:"destroy",value:function(){this.flush(),window.removeEventListener("beforeunload",this.flush)}}]),t}(a.mQ);C.MAX_LOG_LENGTH=50,C.MAX_FLUSH_INTERVAL=1e4,b([(0,_.P)()],C.prototype,"destroy",null),C=r=b([(0,y.b)(),T(0,(0,m.f)(a.zv))],C);var S=function(e){return function(t){return t.parent=e,function(e){return e.rebind(a.QX).to(C).inSingletonScope(),e.bind(a.f3).to(i.$).inSingletonScope(),e.bind(o.LZ).to(o.WY).inSingletonScope(),e.bind(o.J6).toSelf().inSingletonScope(),e.bind(o.N6).to(o.HE).inSingletonScope(),e.bind(s.e).toSelf().inSingletonScope(),e.bind(o._n).toSelf().inSingletonScope(),e.bind(o.zA).toSelf().inSingletonScope(),e.bind(o.PQ).toSelf().inSingletonScope(),e.bind(o.GY).toSelf().inSingletonScope(),e.bind(o.lQ).to(o.wG).inSingletonScope(),e.bind(o.tc).to(o.hr).inSingletonScope(),e}(t)}}},vsh_4644:function(e,t,n){"use strict";n.d(t,{o2:function(){return u},o0:function(){return l},IP:function(){return c}});var r=n("vsh_24627"),i=n("vsh_18801"),o=n("vsh_83190"),a=n("vsh_50662"),s=n("vsh_73043");function u(e,t){(0,a.x2)(r.ZB9.ERROR_EDIT_PROTECTED_RANGE,{confirmText:s("LarkCCM_Sheets_CantEdit_ViewProtectedRange_Button"),cancelText:s("LarkCCM_Sheets_CantEdit_GotIt_Button"),onConfirm:function(){var t;i.store.dispatch((0,o.showSheetPermissionPanel)(null==e?void 0:e.permId)),null==e||null===(t=e.onConfirm)||void 0===t||t.call(e)},onCancel:function(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];null==e||null===(t=e.onCancel)||void 0===t||t.call.apply(t,[null].concat(r))}},t)}function l(){(arguments.length<=0?void 0:arguments[0])!==r.ZB9.ERROR_EDIT_PROTECTED_RANGE?a.x2.apply(void 0,arguments):u(arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}function c(){(0,a.x2)(r.ZB9.ERROR_EDIT_CONNECTOR_SHEET)}},vsh_50662:function(e,t,n){"use strict";n.d(t,{x2:function(){return R},Ft:function(){return x},$y:function(){return P},ip:function(){return L},eE:function(){return D},Ti:function(){return F},Bu:function(){return B},SW:function(){return V}});var r,i,o=n("vsh_67017"),a=n.n(o),s=n("vsh_35067"),u=n("vsh_74561"),l=n("vsh_60591"),c=n("vsh_98125"),h=n.n(c),d=n("vsh_18801"),f=n("vsh_23585"),p=n("vsh_12484"),v=n("vsh_22488"),g=n("vsh_96579"),_=n("vsh_24627"),y=n("vsh_82905"),m=n("vsh_89537"),E=n("vsh_46162"),b=n("vsh_73043"),T=(0,d.isUseExcel)(),C="__SPREAD_TOAST__",S=b("common.oops"),w=(r={},(0,u.Z)(r,_.ZB9.ERROR_CLIENT_VARS,{title:S,body:b("sheet.data_type_error"),confirmText:b("common.confirm"),cancelText:"",maskClosable:!1,onConfirm:function(){location.reload()}}),(0,u.Z)(r,_.ZB9.ERROR_SORT_INCLUDE_MERGE,{title:S,body:b("sheet.merge_no_sort"),confirmText:b("common.confirm"),closable:!0,cancelText:"",maskClosable:!0}),(0,u.Z)(r,_.ZB9.ERROR_SORT_INCLUDE_ARRAYFORMULA,{title:S,body:b("sheet.sort.contain_array_formula"),confirmText:b("common.confirm"),closable:!0,cancelText:"",maskClosable:!0}),(0,u.Z)(r,_.ZB9.ERROR_SORT_LOGICAL_ERROR,{title:S,body:b("common.copy_doc_failure"),confirmText:b("common.confirm"),closable:!0,cancelText:"",maskClosable:!0}),(0,u.Z)(r,_.ZB9.ERROR_SORT_COLLABORATIVE_ERROR,{title:S,body:b("CreationDoc_Sheets_Sort_ErrorPleaseTryAgain_Notice"),confirmText:b("common.confirm"),closable:!0,cancelText:"",maskClosable:!0}),(0,u.Z)(r,_.ZB9.ERROR_MERGE_CONTAIN_VALUE,{title:b("common.prompt"),body:b("sheet.confirm_merge"),confirmText:b("common.confirm"),closable:!0,cancelText:b("common.cancel"),maskClosable:!0,shouldListenKeyDown:!0}),(0,u.Z)(r,_.ZB9.ERROR_MERGE_CONTAIN_MERGE,{title:S,body:b("sheet.split_before_do"),confirmText:b("common.confirm"),closable:!0,cancelText:"",maskClosable:!0}),(0,u.Z)(r,_.ZB9.ERROR_ADD_REMINDER_CONTAIN_VALUE,{title:b("common.prompt"),body:b("CreationDoc_Sheets_Reminder_ContentConflict"),maskClosable:!0}),(0,u.Z)(r,_.ZB9.ERROR_INVALID_SHEET_NAME,{title:S,confirmText:b("common.confirm"),closable:!0,cancelText:"",maskClosable:!1}),(0,u.Z)(r,_.ZB9.ERROR_CELL_NOT_EXIST,{title:S,confirmText:b("common.confirm"),closable:!0,cancelText:"",maskClosable:!0}),(0,u.Z)(r,_.ZB9.ERROR_SHEET_NOT_EXIST,{title:S,body:b("sheet.worksheet_deleted"),confirmText:b("common.confirm"),closable:!0,cancelText:"",maskClosable:!1}),(0,u.Z)(r,_.ZB9.ERROR_SHEET_HID,{title:S,body:b("sheet.had.been.hidden"),confirmText:b("common.confirm"),closable:!0,cancelText:"",maskClosable:!1}),(0,u.Z)(r,_.ZB9.ERROR_EDIT_PROTECTED_RANGE,{title:b("LarkCCM_Sheets_CantEdit_Title"),body:b("LarkCCM_Sheets_CantEdit_Protected_Desc"),confirmText:b("common.confirm"),cancelText:"",closable:!0}),(0,u.Z)(r,_.ZB9.ERROR_ACTION_CONFLICT,{title:S,body:b("common.action_conflict"),confirmText:b("common.refresh"),cancelText:"",closable:!1,maskClosable:!1,onConfirm:function(){location.reload()}}),(0,u.Z)(r,_.ZB9.ERROR_RECEIVE_RECOVER,{title:b("common.prompt"),body:b("sheet.history.receive_recover"),confirmText:b("common.refresh"),cancelText:"",closable:!1,maskClosable:!1,onConfirm:function(){location.reload()}}),(0,u.Z)(r,_.ZB9.ERROR_RECOVER,{title:b("common.prompt"),body:b("sheet.history.recover_success"),confirmText:b("common.confirm"),cancelText:"",closable:!1,maskClosable:!1}),(0,u.Z)(r,_.ZB9.ERROR_ERROR,{title:S,confirmText:b("common.refresh"),closable:!0,cancelText:"",maskClosable:!1,extraButtons:!T&&h().createElement(f.ContactUsButton,null),onConfirm:function(){(0,g.collectSuiteEvent)("sheet_operation_dialog",{action:"click_refresh",dialog_type:"dialog",mode:"default"}),location.reload()}}),(0,u.Z)(r,_.ZB9.ERROR_CANVAS,{title:S,body:b("sheet.canvas_ios12_error"),confirmText:b("common.confirm"),cancelText:"",maskClosable:!0}),(0,u.Z)(r,_.ZB9.ERROR_CONDITIONAL_FORMATTING_NUM_LIMIT,{title:S,body:b("sheet.conditional_formatting.num_limit"),confirmText:b("common.confirm"),cancelText:"",maskClosable:!0}),(0,u.Z)(r,_.ZB9.ERROR_ILLEGAL_COLLASPREAD_OP,{title:S,body:b("undefined"),confirmText:b("common.refresh"),cancelText:"",maskClosable:!1,extraButtons:h().createElement(f.ContactUsButton,null),onConfirm:function(){location.reload()}}),(0,u.Z)(r,_.ZB9.ERROR_ADD_OUTLINE_ON_PROTECTED_RANGE,{title:S,body:b("LarkCCM_Sheets_Group_GroupContainsProtectionRanges_Description"),confirmText:b("common.confirm"),cancelText:"",closable:!1}),(0,u.Z)(r,_.ZB9.ERROR_EDIT_CONNECTOR_SHEET,{title:b("LarkCCM_Sheets_CantEdit_Title"),body:b("LarkCCM_Sheets_CantEdit_Synced_Desc"),confirmText:b("LarkCCM_Sheets_CantEdit_ViewGuide_Button"),cancelText:b("LarkCCM_Sheets_CantEdit_GotIt_Button"),closable:!1,onConfirm:function(){window.open("".concat(d.RAW_HELP_DOC_FAQ_URL,"/articles/316600803019"),"_blank")}}),r);function R(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;if(!window.__OFFLINE__){(0,m.K4)(Object.assign({},w[e],{},t));var r=[_.ZB9.ERROR_ERROR,_.ZB9.ERROR_MERGE_CONTAIN_VALUE,_.ZB9.ERROR_RECOVER,_.ZB9.ERROR_RECEIVE_RECOVER,_.ZB9.ERROR_SHEET_NOT_EXIST];r.includes(e)||A(e,n)}}function A(e,t){g.moirae.teaLog({key:"show_error_modal",error_code:e}),console.log("reportModalError: ",e,t),g.moirae.ravenCatch(new Error("SHOW_ERROR_MODAL"),{tags:{key:"SHOW_ERROR_MODAL"}})}var O=new Set,M=(i={},(0,u.Z)(i,p.STATUS_CODE.CONNECT_ABORT,!0),(0,u.Z)(i,p.STATUS_CODE.CONNECT_ERROR,!0),(0,u.Z)(i,p.STATUS_CODE.TIMEOUT,!0),(0,u.Z)(i,p.STATUS_CODE.REQUEST_BIZ_ERROR,!0),i),k=(0,u.Z)({},p.STATUS_CODE.FORBIDDEN,!0);function I(){return(I=(0,s.Z)(a().mark((function e(t,n,r,i,o,s){var l,c,h,d;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!O.has(t)){e.next=2;break}return e.abrupt("return");case 2:O.add(t),l={},(0,u.Z)(l,_.D1r.ERR_BUNDLE_FETCH_BLOCKS,"BUNDLE_FETCH_BLOCKS_ASSETS_FAIL"),(0,u.Z)(l,_.D1r.ERR_FETCH_BLOCKS,"FETCH_BLOCKS_ASSETS_FAIL"),(0,u.Z)(l,_.D1r.ERR_FETCH_CLIENTVARS,"FETCH_CLIENTVARS_ASSETS_FAIL"),(c=l)[t]&&o&&(M[o.code]||k[o.code])?g.moirae.teaLog({key:"client_sheet_assets_fail",assets_value:c[t],error_code:o.code,log_id:s}):g.moirae.teaLog({key:"show_server_error_modal",status_code:t,error_code:N(t),module:n,progress:r,version:null===(h=window.scm)||void 0===h?void 0:h.version,scmsheet:null===(d=window.scmsheet)||void 0===d?void 0:d.version,log_id:s}),console.error(i),r&&console.log(JSON.stringify(r)),g.moirae.ravenCatch(new Error("SLAError:".concat(t," Module:").concat(n)),{tags:{key:"SLA_".concat(t)}});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e,t){var n={},r=e.code,i=e.reason,o=e.raw,a=e.logId;switch("".concat(r)){case _.D1r.ERR_NO_WRITE_PERMISSION:Object.assign(n,{body:b("sheet.no_write_permission"),closable:!1});break;case _.D1r.ERR_NO_COMMENT_PERMISSION:Object.assign(n,{body:b("sheet.no_comment_permission")});break;case _.D1r.ERR_NOT_IN_SESSION:Object.assign(n,{body:b("sheet.please_login"),onConfirm:function(){location.href="/"}});break;case _.D1r.ERR_NOTE_DELETED:Object.assign(n,{body:b("sheet.workbook_deleted"),closable:!1});break;case _.D1r.ERR_OBJECT_DELETED:case _.D1r.ERR_NOT_FOUND:case _.D1r.ERR_NOTE_NOT_EXISTS:case _.D1r.ERR_GET_EXACT_NOTE:Object.assign(n,{body:b("sheet.workbook_deleted")});break;case _.D1r.ERR_NOT_IN_ROOM:Object.assign(n,{body:b("sheet.lost_connect")});break;case _.D1r.ERR_RCE_LIVE_SYNC:Object.assign(n,{body:b("sheet.data_save_fail")});break;case _.D1r.ERROR_MAX_CELL_LIMIT:g.moirae.teaLog({key:"show_exceed_max_line_tip"}),Object.assign(n,{title:b("sheet.cell_limit_exceed"),body:b("sheet.error_cell_limit_exceed",(0,_.ytD)()),closable:!1});break;case _.D1r.ERROR_APPLY_ACTION_EX:case _.D1r.ERROR_APPLY_ACTION_CORE_EX:g.moirae.teaLog({key:"show_apply_action_ex"}),Object.assign(n,{title:S,body:b("sheet.apply_action_error")});break;case _.D1r.ERROR_MAX_CELL_LIMIT_OPERATION:g.moirae.teaLog({key:"show_exceed_max_line_tip"}),Object.assign(n,{title:b("sheet.cell_limit_exceed"),body:b("sheet.error_cell_limit_exceed",(0,_.ytD)()),confirmText:b("common.confirm"),onConfirm:function(){}});break;case _.D1r.ERR_CHANGESET_EXCEED_LIMIT:Object.assign(n,{title:b("sheet.error.exceed_limit_title"),body:h().createElement(h().Fragment,null,b("sheet.error.exceed_limit").split("\\n").map((function(e){return h().createElement("div",{key:e},e)}))),closable:!1});break;case _.D1r.ERROR_WORKER_SEND_USER_CHANGE:Object.assign(n,{title:S,body:b("sheet.worker_error_onsend")});break;case _.D1r.ERROR_SEND_HIGH_PRORITY_MESSAGE:Object.assign(n,{title:S,body:b("sheet.error_send_high_prority")});break;case _.D1r.ERROR_CMD_EX:Object.assign(n,{body:"".concat(b("sheet.cmd_execute_fail")," (code: ").concat(r,")"),closable:!1});break;case _.D1r.ERROR_PERM_LOCK:Object.assign(n,{body:b("sheet.error_perm_lock"),onConfirm:function(){location.reload()},closable:!1,confirmText:b("common.refresh")});break;case _.D1r.ERROR_PROTECTION_COUNT_LIMIT:Object.assign(n,{body:b("LarkCCM_Sheets_ProtectCell_FailLimitReached_Toast"),onConfirm:function(){location.reload()},closable:!1,confirmText:b("common.refresh")});break;case _.D1r.ERROR_CREATE_LIMITATION:Object.assign(n,{title:b("common.prompt"),body:b("common.please_pay"),confirmText:b("common.confirm"),onConfirm:function(){}});break;case _.D1r.ERROR_CLIENT_VARS_RCE_MISMATCH:Object.assign(n,{body:b("sheet.clientvars_rce_missmatch")});break;case _.D1r.ERROR_CLIENT_VARS_RCE_READONLY:Object.assign(n,{body:b("sheet.clientvars_rce_readonly"),closable:!0,confirmText:b("common.confirm"),onConfirm:function(){}});break;case _.D1r.ERROR_ADD_ROW_COL_COUNT_OUT:Object.assign(n,{body:b("sheet.row_col.single_maximum_limit"),closable:!1,onConfirm:function(){location.reload()},confirmText:b("common.refresh")});break;case _.D1r.ERROR_CELL_STR_LEN_OUT:Object.assign(n,{body:b("LarkCCM_Sheets_CellCharLimit_Desc",{num:(0,E.getSheetCellCharLimitNum)()}),closable:!1,onConfirm:function(){location.reload()},confirmText:b("common.refresh")});break;case _.D1r.ERROR_SUB_SHEET_COUNT_OUT:Object.assign(n,{body:b("sheet.sub_sheet.maximum_limit"),closable:!1,onConfirm:function(){location.reload()},confirmText:b("common.refresh")});break;case _.D1r.ERROR_SHEET_COL_COUNT_OUT:Object.assign(n,{body:b("sheet.col.maximum_limit"),closable:!1,onConfirm:function(){location.reload()},confirmText:b("common.refresh")});break;case _.D1r.ERROR_CELL_COUNT_OUT:Object.assign(n,{body:b("sheet.error_cell_limit_exceed",(0,_.ytD)()),closable:!1,onConfirm:function(){location.reload()},confirmText:b("common.refresh")});break;case _.D1r.ERROR_BITTABLE_COUNT_OUT:Object.assign(n,{body:b("sheet.bittable.maximum_limit"),closable:!1,onConfirm:function(){location.reload()},confirmText:b("common.refresh")});break;case _.D1r.ERR_OLD_VERSION:Object.assign(n,{body:b("server.error_code_1010"),closable:!1,onConfirm:function(){location.reload()},cancelText:"",confirmText:b("common.refresh")});break;case _.D1r.ERROR_BITABLE_EXCEED_LIMIT:case _.D1r.ERROR_BITABLE_SHEET_POP_UP:Object.assign(n,{title:b("Bitable_Sheet_UnableToCopyPopupTitle"),body:b("Bitable_Sheet_UnableToCopyPopupDesc"),closable:!1,onConfirm:function(){location.reload()},cancelText:"",confirmText:b("common.refresh")});break;case _.D1r.ERROR_DOCX_SHEET_COUNT_OUT:Object.assign(n,{body:b("server.error_code_1217_desc"),closable:!1,onConfirm:function(){location.reload()},cancelText:"",confirmText:b("common.refresh")});break;case _.D1r.ERR_CLIENTVARS_INVALID_HAS_RECOVER:if(window.__OFFLINE__)return;P(b("sheet.server_error_onedit")),Object.assign(n,{closable:!1,body:"".concat(b("LarkCCM_Sheets_RestoringTimeout_Description")," (code: ").concat(r,")")});break;case _.D1r.ErrGanttViewQuotaLimit:Object.assign(n,{title:b("Bitable_Billing_ErrorNeedToRefresh_Title"),body:b("Bitable_Billing_GanttView_ErrorNeedToRefresh_Description"),closable:!1,onConfirm:function(){location.reload()},cancelText:"",confirmText:b("common.refresh")});break;case _.D1r.ERROR_DOC_SHEET_FORBID_EDITING:Object.assign(n,{closable:!1,body:b("LarkCCM_Docs_UpgradeToDocX_RefreshToEnterNewVersion_Toast"),onConfirm:function(){location.reload()},cancelText:"",confirmText:b("common.refresh")});break;case _.D1r.ERR_LOGIN_REQUIRE:case _.D1r.ERR_FORBIDDEN:case _.D1r.ERROR_WATCH_DOG:return;case _.D1r.ERR_FETCH_CLIENTVARS:case _.D1r.ERR_REQUEST_FAIL:case _.D1r.ERR_INVALID_PARAM:case _.D1r.ERR_DATA_EXCEED_LIMIT:case _.D1r.ERR_UNCHANGE:case _.D1r.ERR_CHAGESET_VALID_FAIL:case _.D1r.ERR_500:case _.D1r.ERR_FETCH_BLOCKS:case _.D1r.ERR_CLIENTVARS_INVALID:case _.D1r.ERR_MESSAGE_INVALID:case _.D1r.ERR_SYNC_ALGO_FAIL:case _.D1r.ERR_USER_LIST_SYNC:case _.D1r.ERROR_RETRY_EXCEED:case _.D1r.ERROR_BITABLE_COPY_FAILED:case _.D1r.ERROR_BITABLE_ON_COPYING:case _.D1r.ERROR_BITABLE_ACTION_UNEXCEPTION:case _.D1r.ERROR_BITABLE_INVOKE_RPC_FAILED:default:if(window.__OFFLINE__)return;var s=b("sheet.server_error_retry"),u="";o&&o.code&&(u="_".concat(o.code),M[o.code]&&(s=b("sheet.network_error_retry"))),Object.assign(n,{closable:!1,body:"".concat(s," (code: ").concat(r).concat(u,")")}),P(b("sheet.server_error_onedit"))}R(_.ZB9.ERROR_ERROR,n,i),function(e,t,n,r,i,o){I.apply(this,arguments)}(r,t,void 0,i,o,a)}function N(e){return null!=e&&e.toString?e.toString():"unknown"}function P(e){l.Toast.show({key:C,type:"error",content:e,duration:0,closable:!1})}function L(e){l.Toast.show({key:C,type:"loading",content:e,duration:0,closable:!1})}function D(e){l.Toast.show({key:"__TOOLBAR_TOAST__",type:"loading",content:e,duration:1e3,closable:!1})}function F(){l.Toast.remove(C)}var B=function(){var e=(0,s.Z)(a().mark((function e(t,r){var i,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.getService(y.Qh).checkAttachment(r._context.token).exportable){e.next=5;break}return l.Toast.show({type:"error",content:b("CreationDoc_export_failed_NoPermission"),duration:2500,closable:!1,style:{top:"200px"}}),(0,g.collectSuiteEvent)("ccm_sheet_cs_blocked_export_dev",{stage:"err",message:"no permission export csv"}),e.abrupt("return");case 5:return e.next=7,n.e("vsh_3561").then(n.bind(n,"vsh_43561"));case 7:if(i=e.sent){e.next=10;break}throw new Error("load csv exporter error");case 10:return(0,g.collectSuiteEvent)("ccm_sheet_cs_blocked_export_dev",{stage:"start"}),e.prev=11,o=t.getLocalActionSheetIds(),e.next=15,Promise.all(o.map((function(e){return i.exportCSV(e,r)})));case 15:e.next=21;break;case 17:return e.prev=17,e.t0=e.catch(11),(0,g.collectSuiteEvent)("ccm_sheet_cs_blocked_export_dev",{stage:"err",message:null!==e.t0&&void 0!==e.t0&&e.t0.stack?String(e.t0.stack):String(e.t0)}),e.abrupt("return");case 21:(0,g.collectSuiteEvent)("ccm_sheet_cs_blocked_export_dev",{stage:"done"});case 22:case"end":return e.stop()}}),e,null,[[11,17]])})));return function(t,n){return e.apply(this,arguments)}}();function V(e,t){return function(n){var r=n.code,i=n.data;if((!(0,_.YF0)(r)||(0,_.c1y)(r))&&!(0,_.s9v)(r)){if((0,_.DGn)(r)){var o=String(i.code);if((0,_.nS0)(o))return;if(o===y.jK.STOP_WRITE_FOR_MIGRATE)return;if(o===y.jK.ERROR_PASSPORT_DELETED)return;if(o===y.jK.ERR_LOCK_FAILED_FOR_CACHE_CALC)return;if(function(e){var t=e===_.D1r.TENANT_QUOTA_EXCEEDED||e===_.D1r.FILE_USER_QUOTA_EXCEEDED||e===_.D1r.FILE_DEPT_QUOTA_EXCEEDED,n=e===_.D1r.FILE_SUPER_DOCS_EXCEEDED,r=(0,E.isCcmStorageEditLimitPopup)();return t&&r||n}(o)){var a,s=t.engine,l=t.spread,c=l._context.token,h=(a={},(0,u.Z)(a,_.D1r.TENANT_QUOTA_EXCEEDED,v.PicLimitType.STORAGE_SPACE),(0,u.Z)(a,_.D1r.FILE_USER_QUOTA_EXCEEDED,v.PicLimitType.STORAGE_USER),(0,u.Z)(a,_.D1r.FILE_DEPT_QUOTA_EXCEEDED,v.PicLimitType.STORAGE_DEPARTMENT),(0,u.Z)(a,_.D1r.FILE_SUPER_DOCS_EXCEEDED,v.PicLimitType.STORAGE_SPACE),a);return void(0,v.showPicLimitDialog)(h[o],{type:v.StorageSpaceType.EDIT_FILE,mountNodeToken:c,mountPoint:p.MountPointType.SHEET_FILE,limitedType:o===_.D1r.TENANT_QUOTA_EXCEEDED?v.LimitedCheckpointType.UNIVERSAL_STORAGE:o===_.D1r.FILE_SUPER_DOCS_EXCEEDED?v.LimitedCheckpointType.DOCS_STORAGE_LIMIT:void 0},{useCTA:!1,scene:v.Scene.USER_CHANGE,extraTips:b("LarkCCM_StorageMgmt_ExportAsCSV_Desc"),customButtons:[{text:b("LarkCCM_Sheets_ExportCSV_Button"),onClick:function(){B(s,l)}}],onActionClick:function(e,t){"confirm"!==t&&"close"!==t||s.clearBackup()}})}if(o===y.jK.BLOCK_BY_LACK_OF_BENEFIT)return t.engine.clearBackup(),void v.benefitManager.showExpiredDialog()}x(Object.assign({code:r},i,e))}}}},vsh_22233:function(e,t,n){"use strict";n.d(t,{gU:function(){return r.gU},K4:function(){return r.K4},h2:function(){return r.h2},Ti:function(){return i.Ti},x2:function(){return i.x2},Ft:function(){return i.Ft},ip:function(){return i.ip}});var r=n("vsh_89537"),i=n("vsh_50662")},vsh_89537:function(e,t,n){"use strict";n.d(t,{gU:function(){return s},K4:function(){return u},h2:function(){return l}});var r=n("vsh_82898"),i=n("vsh_69691"),o=n("vsh_23585"),a=n("vsh_75986");function s(){return o.Modal.isVisible()}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!(0,i.isSupportNativeAlert)())return o.Modal.show((0,r.Z)({wrapClassName:a.wPC},e));try{c(e)}catch(t){console.log("native alert error----",e,t),o.Modal.show(e)}}function l(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=new Promise((function(n){e=u(Object.assign({},t,{onConfirm:function(){return n(!0)},onCancel:function(){return n(!1)}})).close}));return{closeFn:e,promise:n}}function c(e){if(e){var t=e.title,n=e.cancelText,r=e.confirmText,i=e.onConfirm,o=e.onCancel,a=e.body,s=[];n&&s.push({id:"cancel",text:n,is_highlight:!1}),r&&s.push({id:"sure",text:r,is_highlight:!0});var u={title:t,message:h(a),buttons:s,onSuccess:function(e){e&&("cancel"===e.id?o&&o():"sure"===e.id&&i&&i())}};window.lark.biz.util.showAlert(u)}}function h(e){var t="";return function e(n){if(n)if("string"!=typeof n){if(n.props&&n.props.children){var r=n.props.children;"string"==typeof r?t="".concat(t+r,"\n"):Array.isArray(r)?r.forEach(e):e(r)}}else t="".concat(t+n,"\n")}(e),t}},vsh_70345:function(e,t,n){"use strict";n.d(t,{l:function(){return f}});var r,i=n("vsh_5159"),o=n("vsh_74016"),a=n("vsh_98125"),s=n.n(a),u=n("vsh_69540"),l=n.n(u),c=n("vsh_22233"),h=n("vsh_73043"),d=l().div(r||(r=(0,i.Z)(["\n  display: flex;\n  margin-top: 24px;\n\n  p {\n    font-weight: 500;\n    font-size: 16px;\n    color: var(--text-title);\n    margin-left: 16px;\n  }\n"])));function f(){return(0,c.h2)({body:s().createElement(d,null,s().createElement(o.Z,{style:{fontSize:22}}),s().createElement("p",null,h("CreationDoc_Sheets_PivotTable_AlreadyHaveData"))),confirmText:h("CreationDoc_Sheets_PivotTable_Continue"),cancelText:h("common.cancel"),closable:!1,maskClosable:!1})}},vsh_18088:function(e,t,n){"use strict";n.d(t,{d:function(){return i}});var r=n("vsh_24627");var i={key:"jsHeap",collect:function(){return function(e){var t=e.memory;return{jsHeapSizeLimit:(null==t?void 0:t.jsHeapSizeLimit)||0,totalJSHeapSize:(0,r.SSR)((null==t?void 0:t.totalJSHeapSize)||0),usedJSHeapSize:(0,r.SSR)((null==t?void 0:t.usedJSHeapSize)||0)}}(window.performance)},defaultOn:!1,whitelist:new Set,blacklist:new Set}},vsh_58243:function(e,t,n){"use strict";n.d(t,{F:function(){return h}});var r=n("vsh_98125"),i=n.n(r),o=n("vsh_96579"),a=n("vsh_24627"),s=n("vsh_52856"),u=n.n(s)()({loader:function(){return Promise.all([n.e("vsh_4670"),n.e("vsh_2509"),n.e("vsh_2172"),n.e("vsh_7554"),n.e("vsh_4546"),n.e("vsh_1701"),n.e("vsh_7659"),n.e("vsh_5390"),n.e("vsh_1898"),n.e("vsh_4817"),n.e("vsh_4563"),n.e("vsh_9414"),n.e("vsh_6543"),n.e("vsh_7949"),n.e("vsh_9193"),n.e("vsh_1099"),n.e("vsh_5385"),n.e("vsh_3928"),n.e("vsh_1921")]).then(n.bind(n,"vsh_21091"))},loading:function(){return null}}),l=n("vsh_22233"),c=n("vsh_73043");function h(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"common",s=function(s){var h=e;if(n){var d=n.sortSource,f=n.sortType;(0,o.ccmEventTracking)("ccm_sheet_content_page_click",{click:"show_sort_setting_view",target:"none",action_type:d,sort_type:f})}(0,l.K4)({title:c("sheet.tips.sort_warning"),body:i().createElement(u,{onChange:function(e){return h=e},shouldExpand:h,hasGuide:t,fromWhere:r}),disableAnimation:!0,maskStyle:{backgroundColor:"transparent"},className:"expand-sort-range-modal",wrapClassName:"expand-sort-range-modal-wrapper",closable:!0,maskClosable:!1,cancelText:c("common.cancel"),confirmText:c("common.determine"),onConfirm:function(){s({continueSort:!0,shouldExpand:h})},onCancel:function(){s({continueSort:!1,shouldExpand:h}),(0,o.ccmEventTracking)("ccm_sheet_content_page_click",Object.assign({},(0,a.dK5)(),{click:"filter_sort_area_close",target:"none",sheet_user_permission:"edit"}))}})},h=function(e){var t=1;(0,l.K4)({title:c("sheet.tips.sort_warning"),body:i().createElement(u,{onChange:function(e){return t=e},fromWhere:r}),disableAnimation:!0,maskStyle:{backgroundColor:"transparent"},className:"expand-sort-range-modal",wrapClassName:"expand-sort-range-modal-wrapper",closable:!0,maskClosable:!1,cancelText:c("common.cancel"),confirmText:c("common.determine"),onConfirm:function(){e({continueSort:!0,radioValue:t})},onCancel:function(){(0,o.ccmEventTracking)("ccm_sheet_content_page_click",{click:"show_sort_setting_view_cancel",target:"none"}),e({continueSort:!1,radioValue:t})}})},d=function(e){"common"===r?s(e):"filterMenu"===r&&h(e)};return new Promise(d)}},vsh_68718:function(e,t,n){"use strict";n.d(t,{Ob:function(){return C},Rb:function(){return w},JC:function(){return x},Jn:function(){return N},Oj:function(){return V}});var r,i=n("vsh_47361"),o=n("vsh_33916"),a=n("vsh_22485"),s=n("vsh_69691"),u=n("vsh_60591"),l=n("vsh_18801"),c=n("vsh_22488"),h=n("vsh_96579"),d=n("vsh_3789"),f=n("vsh_25285"),p=n("vsh_24627"),v=n("vsh_75986"),g=n("vsh_15657"),_=n("vsh_72834"),y=n("vsh_65420"),m=n("vsh_13449"),E=n("vsh_25625"),b=n("vsh_73043");!function(e){e[e.None=0]="None",e[e.Jumping=1]="Jumping",e[e.Jumped=2]="Jumped"}(r||(r={}));var T={isJump:!1,linkJumped:!1,toastType:r.None,toastPollingCount:0};function C(e,t){if(!t||!e||(0,E.UQ)())return!1;var n=function(e,t){if(!e||!t)return;for(var n=0;n<e.sheets.length;n++){var r=e.sheets[n];if(r.floatBlocksModel.getBlock(t))return r}return}(e,t);if(!n)return u.Toast.show({type:"error",content:b("LarkCCM_Docs_CopySheetGraph_GraphDeleted_Description")}),!1;if(n.getHiddenStatus())return I(e,n),!1;e.setActiveSheet(n.name(),!0);var r=n.floatBlocksModel.getBlock(t);if(!r)return u.Toast.show({type:"error",content:b("LarkCCM_Docs_CopySheetGraph_GraphDeleted_Description")}),!1;var i=r.blockSetting,o=i.row,a=i.col,s=i.x,l=i.y;return setTimeout((function(){if(!T.isJump){var e=n.getCellRect(o,a),t=e.x,r=e.y,i=n.getCellRect(0,0),u=i.x,c=i.y;n.scrollTo(t+s-u,r+l-c),T.isJump=!0}}),100),!0}function S(e){var t=e.sheetView().brTable(),n=t.width,r=t.height;return 0===n&&0===r&&"visible"!==document.visibilityState}function w(e,t,n,r){var i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=arguments.length>5?arguments[5]:void 0,a=arguments.length>6?arguments[6]:void 0,s=arguments.length>7?arguments[7]:void 0;if(T.linkJumped=!0,!e||(0,E.UQ)())return!1;if(!t)return k(e),R(n),!1;var l="",c=e.getSheetFromId(t);if(c){if(c.getHiddenStatus())return I(e,c),R(n),!1;e.setActiveSheet(c.name(),!0);var p=c.viewsModel.getViewList().length;if((0,h.collectSuiteEvent)("sheet_opration",{sheet_id:c.id(),filterview_number:p}),!n&&!r)return R(n),!1;var v=null;if(n){var g=c.rangeModel.getRangeFromId(n);g&&(v=(0,_.jJ3)(g,e),(0,h.collectSuiteEvent)("sheet_cell_position_hyperlink_clicked",{type:"rangeid",source:s})),l=b("LarkCCM_Sheets_RangeNoExist_Toast")}else if(r){var y=!1,m=(0,f.oc)(r);m&&((0,h.collectSuiteEvent)("sheet_cell_position_hyperlink_clicked",{type:"range",source:s}),y=/:/.test(m),v=c.rangeStringToRange(m)),l=b(y?"CreationDoc_Sheets_Hyperlink_ShareAreaLinkDeleted":"CreationDoc_Sheets_Hyperlink_ShareCellLinkDeleted")}v&&v.isValidRefInSheet()&&(0,d.H5)(c,v)?A(i,a,(function(){M(c,v,o,a)})):(A(i,a,(function(){O(c,0,0)})),u.Toast.show({type:"error",content:l}),(0,h.collectSuiteEvent)("ccm_sheets_range_not_exist_toast_view",{error_type:n?"range_id_not_exist":"range_not_exist"})),R(n)}else{var C=k(e);l=b("CreationDoc_Sheets_HyperlinkSheetDeleted"),u.Toast.show({type:"error",content:l}),(0,h.collectSuiteEvent)("ccm_sheet_delete_toast_view",{source:n?"rangeid":"range"}),R(n,C)}return!0}function R(e,t){setTimeout((function(){if(e||t){var n=(0,s.parseQuery)(location.search||"")||{};delete n.rangeId,delete n.rangeVer,t&&(n.sheet=t),c.history.replace({search:(0,c.formatQuery)(n)})}}))}function A(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;if(e)if(t&&S(t)){var r=function e(r){var i=r.changes,a=i.width,s=i.height;return 0===a.before&&0===s.before&&a.current>0&&s.current>0&&(setTimeout((function(){n&&n()})),t.sheetView().brTable().removeListener(o.FEventType.AfterChange,e)),!1};t.sheetView().brTable().addListener(o.FEventType.AfterChange,r)}else setTimeout((function(){n&&n()}));else n&&n()}function O(e,t,n){e.showCell(t,n,0,0,!0),e.setActiveCell(t,n,{source:"init"})}function M(e,t,n,r){if(r){var i=r.sheetView(),o=i.scrollRangeToCenter(t,e);o&&i.adjustScrollToRange(t,o,e,r)}else if(t.rgType!==p.xj7.ALL){var a=3;t.rgType===p.xj7.ROW?a=2:t.rgType===p.xj7.COL&&(a=1),e.showCell(t.rowFrom()+Math.floor(t.rowCount()/2),t.colFrom()+Math.floor(t.colCount()/2),0,0,!0,a)}e.setSelection(t,void 0,"init"),n&&n.collect(p.FHD.SCROLL_TO_LINK_RANGE,{status:p.G2P.END}),e.isHiddenRange({row:t.rowFrom(),rowCount:t.rowCount(),col:t.colFrom(),colCount:t.colCount()})&&(u.Toast.show({type:"info",content:b("CreationDoc_Sheets_HyperlinkSourceSheetHiden")}),(0,h.collectSuiteEvent)("ccm_sheets_range_invisable_toast_view"))}function k(e){var t=e.pickUnhiddenSheetIndex(0),n=e.sheets[t].id();return function(e,t){var n=e.getSheetFromId(t);n?function(e,t){t.getHiddenStatus()?I(e,t):(e.setActiveSheet(t.name(),!0),0===t.getSelections().length&&t.setSelection(new _.e6w(0,0,1,1,t),void 0,"init"))}(e,n):k(e)}(e,n),n}function I(e,t){u.Toast.show({type:"info",key:"CreationDoc_Sheets_HyperlinkSheetHidden",content:b("CreationDoc_Sheets_HyperlinkSheetHidden"),duration:3e3});var n=e.pickUnhiddenSheetIndex(0),r=e.sheets[n];e.setActiveSheet(r.name(),!0),0===r.getSelections().length&&r.setSelection(new _.e6w(0,0,1,1,r),void 0,"init")}var x=function(e){if(!e)return{text:"",link:"",cellPosition:null};var t=e.link,n=e.text,r=e.cellPosition;return{text:t||r?n:"",link:t||(r?"":n),cellPosition:r}},N=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t.getActiveSheet(),o=e.info.seg;if(o&&[p.K6s.URL,p.K6s.PANO].includes(o.type())){var a=x(o.seg),d=a.link,v=a.cellPosition;if(o.type()===p.K6s.PANO)return!(0,f.dq)(d)&&r._raiseInvalidOperation(1,b("sheet.invalid_link")),void(0,h.collectSuiteEvent)("pano_ccm",{module:"sheet",action:"click_pano_sheet_url",tag_id:o.seg.entityId});var E="",T="",C="",S=(0,y.AK)(t,d||v),R=(0,y.hM)(S,v),A="link_clicked";switch((0,h.collectSuiteEvent)(A,{scene:i.SECURE_LINK_SCENE.CCM,location:i.SECURE_LINK_LOG.CCM_SHEET,type:R}),S){case m.k.NORMAL_URL:var O=(0,s.parseUrl)(d),M=O.search,k=(0,s.parseQuery)(M)||{};if(k.sheet&&(E=k.sheet),k.rangeId?T=k.rangeId:k.range&&(C=k.range),(0,s.isSameFileToken)(window.location.href,d,"sheet")&&k.comment_id&&"true"===k.comment_anchor&&!n&&(0,c.getCommentCopyLinkEnableV2)())return void l.eventEmitter.emit("commentAnchorJumpToActiveComment",{commentId:k.comment_id});if((0,s.isSameFileToken)(window.location.href,d,"sheet")&&E)return void w(t,E,T,C,!0,void 0,void 0,"link");if((0,f.vk)(e.info.fEvent)){var I=(0,f.B)(d),N=c.mpLinkHelper.isMpWhitelistLink,P=c.mpLinkHelper.showMPLinkDialog;if(!N(d))return void P(d);!(0,f.dq)(I)&&r._raiseInvalidOperation(1,b("sheet.invalid_link"))}return;case m.k.SHEET_EXIST:case m.k.RANGE_Full:case m.k.RANGE_PART:if(v){E=v.sheetId;var L=(0,g.O$)(v);T=L.rangeId||T,C=L.rangeToken||C}break;case m.k.RANGE_OVERFLOW:if(v){var D=(0,g.O$)(v);T=D.rangeId||T,C=D.rangeToken||C;var F="";if(T)F=b("LarkCCM_Sheets_RangeNoExist_Toast");else{var B=!1,V=(0,f.oc)(C);V&&(B=/:/.test(V)),F=b(B?"CreationDoc_Sheets_Hyperlink_RangeDeletedToast":"CreationDoc_Sheets_Hyperlink_CellDeletedToast")}return void u.Toast.show({type:"error",content:F})}break;case m.k.SHEET_DELETED:return void u.Toast.show({type:"error",content:b("CreationDoc_Sheets_Hyperlink_SheetDeletedCantOpen")})}var H=t.getSheetFromId(E);if(H){if(H.getHiddenStatus())return void u.Toast.show({type:"info",key:"CreationDoc_Sheets_HyperlinkSheetHidden",content:b("CreationDoc_Sheets_HyperlinkSheetHidden"),duration:3e3});var U=t.getActiveSheet().id();if(U!==E){var Z=E;t.setActiveSheetById(Z,!0),e.info&&e.info.fEvent&&e.info.fEvent.target.updateByCfg({cursor:"default"})}if(!T&&!C)return;var W=null;if(T){var j=H.rangeModel.getRangeFromId(T);j&&(W=(0,_.jJ3)(j,t))}else if(C){var G=(0,f.oc)(C);G&&(W=H.rangeStringToRange(G))}if(W&&W.isValidRefInSheet()){var z=H.isHiddenRange({row:W.rowFrom(),rowCount:W.rowCount(),col:W.colFrom(),colCount:W.colCount()});z?(u.Toast.show({type:"info",content:b("CreationDoc_Sheets_HyperlinkSourceSheetHiden")}),(0,h.collectSuiteEvent)("ccm_sheets_range_invisable_toast_view")):setTimeout((function(){W=W,H.showCell(W.rowFrom()+Math.floor(W.rowCount()/2),W.colFrom()+Math.floor(W.colCount()/2),0,0,!0),H.setSelection(W)}))}}else;}},P="jumping_to_selection",L="loading_toast_for_calculate",D=function(e){var t=e.sheet(),n=t.parent,r=Object.keys(t.getEmbeddedBlocksMap()).length,i=Object.keys(n.importRangeManager.getImportRangeIDs(t.id())),o=function(e,t){var n,r=e.sheet(),i=e.rowFrom(),o=e.colFrom();if(r.isProxyArrayFormula(i,o))return!0;var s,u=null===(n=r.getPivotTableManager().getPivotTableByCell(i,o))||void 0===n?void 0:n.getName();if(u)return null===(s=r.getPivotTableManager().getPivotInfoByName(u))||void 0===s?void 0:s.loaded;var l=r.getVar(i,o);return null!=l&&l.isFormula()?(0,_.sMb)(l)?l.getVar()!==a.WAIT_ASYNC_ERR_VAR:!!l.getState().cache:!t||null!==l.getValue()}(e,!(!r&&!i.length));if(o)return!0;var s=0===n.calcEngine.formulaSpace.dirtyFormulas.size,u=i.every((function(e){return n.importRangeManager.getDataFromId(e)})),l=Array.from(t.getPivotTableManager().getPivotInfoMap().values()),c=0===r||l.length===r&&l.every((function(e){return e.loaded}));return s&&u&&c},F=function(e,t){var n=e.sdk.getPlugin(v.IEf),i=function(e,t){var n=e.getActiveSheet().rangeModel.getRangeFromId(t);if(n)return(0,_.jJ3)(n,e.spread)}(e,t),o=!0===T.linkJumped;if(!i||!n)return!1;var a=function(e){for(var t=e.sheet(),n=e.clone(),r=!0,i=0;i<e.rowCount();i++){var o=e.rowFrom()+i;if(!t.isRowOrColHidden(o,!0)){r=!1,n.setRowFrom(o);break}}if(r)return null;r=!0;for(var a=0;a<e.colCount();a++){var s=e.colFrom()+a;if(!t.isRowOrColHidden(s,!1)){r=!1,n.setColFrom(s);break}}return r?null:n}(i);if(!a)return!1;if(D(a)&&o)return!1;var s=T.toastType===r.Jumping&&T.toastPollingCount<2;return o&&!s?T.toastType!==r.Jumped&&(T.toastType=r.Jumped,p.Ps3.Toast.remove(P),p.Ps3.Toast.show({key:L,content:b("LarkCCM_Sheets_DataLoading_Toast"),type:"loading",duration:2e4})):T.toastType!==r.Jumping&&(T.toastType=r.Jumping,p.Ps3.Toast.show({key:P,content:b("LarkCCM_Sheets_NavigatingToSelect_Toast"),type:"loading",duration:2e4})),T.toastPollingCount++,(0,h.collectSuiteEvent)("ccm_sheet_data_loading_start_toast_view"),!0},B=function(e,t){var n=(0,p.eYO)("interval_time")?Number((0,p.eYO)("interval_time")):500,i=performance.now();(0,_.YFY)((function(){return!F(e,t)}),(function(){return function(e,t,n){var i=e.spread.getActiveSheet(),o=!Object.keys((null==i?void 0:i.getEmbeddedBlocksMap())||{}).length&&T.toastPollingCount>1?0:500;setTimeout((function(){p.Ps3.Toast.remove(L),p.Ps3.Toast.remove(P),T.toastType=r.None,(0,h.collectSuiteEvent)("ccm_sheet_data_loading_finish_toast_view",{loading_time:performance.now()-n})}),(0,p.eYO)("delay_time")?Number((0,p.eYO)("delay_time")):o)}(e,0,i)}),n)},V=function(e,t){t&&setTimeout((function(){var n,r;F(e,null!==(n=t)&&void 0!==n?n:"")&&B(e,null!==(r=t)&&void 0!==r?r:"")}),1e3)}},vsh_26215:function(e,t,n){"use strict";n.d(t,{mv:function(){return r},Tt:function(){return i},WQ:function(){return o}});var r="SHEET_TAB",i="spread-contextmenu",o="".concat(i,"-item");"".concat(i,"-divider"),"".concat(i,"-trigger")},vsh_4167:function(e,t,n){"use strict";var r;n.d(t,{_:function(){return r}}),function(e){e.delete="delete",e.copy="copy",e.rename="rename",e.insert="insert",e.hide="hide",e.protection="protection",e.cancel_protect="cancel_protection",e.copy_block="copy_block",e.delete_block="delete_block",e.unlink_isv="unlink_isv",e.export="export",e.color="color"}(r||(r={}))},vsh_93766:function(e,t,n){"use strict";n.d(t,{C:function(){return i},q:function(){return r}});var r,i="sheet_head_toolbar";!function(e){e.PROTECT_ROWS="protect_row",e.PROTECT_COLS="protect_col",e.SHOW_ALL="show_all",e.SHOW_PROTECTED_RANGE="show_protected_range"}(r||(r={}))},vsh_86921:function(e,t,n){"use strict";n.r(t),n.d(t,{showSpansPromptModalWhileSort:function(){return v},isValueNumber:function(){return _},sort:function(){return m},customSort:function(){return E}});var r=n("vsh_67017"),i=n.n(r),o=n("vsh_35067"),a=n("vsh_63738"),s=n("vsh_56450"),u=n("vsh_96579"),l=n("vsh_24627"),c=n("vsh_72834"),h=n("vsh_4623"),d=n("vsh_22233"),f=n("vsh_58243"),p=n("vsh_73043");function v(e,t){for(var n,r,i=e[0],o=1;o<e.length;o++)n=i,r=e[o],n.rowFrom()<r.rowFrom()||!(n.rowFrom()>r.rowFrom())&&n.colFrom()<r.colFrom()||(i=e[o]);(0,u.ccmEventTracking)("ccm_sheet_content_page_click",{click:"sort_popup",target:"none",sort_type:t});var a=(0,c.Ywm)(i),s=1===e.length?p("CreationDoc_Sheets_MergedCellsCanNotSort",a):p("CreationDoc_Sheets_MergedCellsCanNotSortPlural",a,e.length);(0,d.x2)(l.ZB9.ERROR_SORT_INCLUDE_MERGE,{body:s})}function g(e,t,n){var r=e.getSpans(t);return r.length>0?(v(r,n),!1):(0,c.cUY)(e,t)?((0,d.x2)(l.ZB9.ERROR_SORT_INCLUDE_ARRAYFORMULA),!1):!(0,c.MUL)(e,t.rowFrom(),t.colFrom(),t.rowCount(),t.colCount())||((0,h.Ae)(),!1)}function _(e,t,n){var r=e.getValue(t,n);if(null===r)return!0;if("number"!=typeof r)return!1;var i=e.getActualFormatter(t,n);return!i||!(0,a.isDateTimeFormatter)(i)}function y(e,t,n,r){for(var i=t;i<t+n;i++){var o=_(e,i,r);if(i===t){if(o)return!0}else if(!o)return!0}return!1}var m=function(){var e=(0,o.Z)(i().mark((function e(t){var n,r,o,a,d,v,_,m,E,b,T,C,S,w,R,A,O,M,k,I,x,N,P,L,D,F,B,V,H;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.spread,r=t.ascending,o=void 0===r||r,a=t.selectionRange,d=t.selectIndex,v=t.forceNotExpend,_=void 0!==v&&v,m=t.selectExpendOption,E=void 0===m||m,b=t.expendDirection,T=t.isFromFilterMenu,C=void 0!==T&&T,S=t.sortSource,w=t.suspendEdit,R=t.resumeEdit,A=t.suspendChangeset,O=t.resumeChangeset,M=n.getActiveSheet(),k=o?"asc":"desc",S&&(0,u.ccmEventTracking)("ccm_sheet_content_page_click",{click:"sort_type",target:"none",sort_type:k,action_type:S}),a?I=a:(x=M.getSelections(),I=x[0]),g(M,I,k)){e.next=7;break}return e.abrupt("return");case 7:if(N=void 0===d?I.colFrom():d,P=1===I.colCount()&&!_,L=!0,!P){e.next=33;break}return D=!1,D=M.getHasFormulaByRange(I),e.next=15,(0,f.F)(E,D,S?{sortType:k,sortSource:S}:void 0);case 15:if(F=e.sent,B=F.continueSort,V=F.shouldExpand,B){e.next=20;break}return e.abrupt("return");case 20:if(!V){e.next=32;break}if(L=!1,H=(0,c.qpA)(M,I,b,{isExcludePivotTable:!0}),0===M.getPermissionDeniedRangeList(H).length){e.next=27;break}return s.toast.warning(p("LarkCCM_Sheets_Sorting_RangeWithProtection_Toast")),e.abrupt("return");case 27:if(I.equal(H)){e.next=32;break}if(M.setSelection(H),I=M.getSelections()[0],g(M,I,k)){e.next=32;break}return e.abrupt("return");case 32:(0,u.collectSuiteEvent)("sheet_opration",{action:"sort",source:"popup",has_formula:D,should_expand:V,object_id:M.id()});case 33:A&&A(),w&&w(),(0,h.sp)(),Promise.all([(0,l.QFC)(),(0,c.RTy)(M,I.rowFrom(),I.rowCount(),I.colFrom(),1).then((function(){return(0,h.rB)()}))]).then((function(){var e=I.rowFrom(),t=I.rowCount();S&&(0,u.ccmEventTracking)("ccm_sheet_content_page_click",{click:"finish_sort",target:"none",sort_method:P?"confirm_button":"direct",sort_type:k,action_type:S,sort_area:L?"current_area":"extend_area"}),C||y(M,e,t,N)||(I=new c.e6w(e+1,I.colFrom(),t-1,I.colCount(),I.sheet())),R&&R(),M.sortRange(I,[{index:N,ascending:o}],k)})).finally((function(){O&&O()}));case 37:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function E(e,t,n){return b.apply(this,arguments)}function b(){return(b=(0,o.Z)(i().mark((function e(t,n,r){var o,a,l,d,v,g,_,y,m;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.spread,a=o.getActiveSheet(),l=a.getSelections(),r&&(0,u.ccmEventTracking)("ccm_sheet_content_page_click",{click:"sort_type",target:"ccm_sheet_custom_sort_view",sort_type:"customize",action_type:r}),0!==l.length){e.next=6;break}return e.abrupt("return");case 6:if(d=l[0],!(0,c.MUL)(a,d.rowFrom(),d.colFrom(),d.rowCount(),d.colCount())){e.next=10;break}return(0,h.Ae)(),e.abrupt("return");case 10:if(1!==d.colCount()){e.next=27;break}return!1,v=a.getHasFormulaByRange(d),e.next=15,(0,f.F)(!0,v,r?{sortType:"customize",sortSource:r}:void 0);case 15:if(g=e.sent,_=g.continueSort,y=g.shouldExpand,_){e.next=20;break}return e.abrupt("return");case 20:if(!y){e.next=27;break}if(m=(0,c.qpA)(a,d,void 0,{isExcludePivotTable:!0}),0===a.getPermissionDeniedRangeList(m).length){e.next=26;break}return s.toast.warning(p("LarkCCM_Sheets_Sorting_RangeWithProtection_Toast")),e.abrupt("return");case 26:d.equal(m)||a.setSelection(m);case 27:setTimeout(n,100);case 28:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},vsh_22955:function(e,t,n){"use strict";var r;n.d(t,{B:function(){return r},e:function(){return i}}),function(e){e.UNDO="undo",e.REDO="redo",e.CLEAR="clear",e.FORMATTER="formatter",e.DECREASEDECIMALPLACE="decreaseDecimalPlace",e.INCREASEDECIMALPLACE="increaseDecimalPlace",e.FONTSIZE="fontSize",e.BOLD="bold",e.HYPERLINK="hyperlink",e.IMG="img",e.ITALIC="italic",e.UNDERLINE="underline",e.LINETHROUGH="lineThrough",e.FORECOLOR="foreColor",e.BACKCOLOR="backColor",e.FRAME="frame",e.MERGE="merge",e.HALIGN="hAlign",e.VALIGN="vAlign",e.WORDWRAP="wordWrap",e.SORT="sort",e.FORMULA="formula",e.FILTER="filter",e.CONDITIONFORMAT="conditionformat",e.FIND="find",e.COMMENT="comment",e.DROPDOWNMENU="dropdownMenu",e.PROTECTION="protection",e.CHART="chart",e.GROUP="group",e.ATTACHMENT="attachment"}(r||(r={}));var i=[r.BOLD,r.ITALIC,r.UNDERLINE,r.LINETHROUGH,r.FORECOLOR,r.FONTSIZE]},vsh_80202:function(e,t,n){"use strict";n.d(t,{uT:function(){return i},QG:function(){return o},iX:function(){return a},JE:function(){return r},cK:function(){return u},kn:function(){return l},Hf:function(){return s},Vm:function(){return c},j7:function(){return h},U9:function(){return d},pM:function(){return f},n6:function(){return p}});var r,i=1,o="IForceUpdateEvent",a="IForceFasterModuleReapplyEvent";!function(e){e.PC="pc",e.mobild="mobile"}(r||(r={}));var s,u="VCEnterFullScreenMode",l="VCExitFullScreenMode";!function(e){e.SEND_ACTION="SEND_ACTION",e.RECEIVE_ACTION="RECEIVE_ACTION",e.APPLYING="APPLYING",e.APPLY_CHECK_SAME="APPLY_CHECK_SAME",e.REPORT_APPLY_STATUS="REPORT_APPLY_STATUS",e.CONSISTENCY_CHECK_SAME="CONSISTENCY_CHECK_SAME"}(s||(s={}));var c="sheet_vc_follow",h="sheet_vc_follow_error",d="[sheet_vc]",f="[new_scale]",p={NEW_ACTION_APPLY:"new action apply",FOLLOWER_NO_PERMISSION_TO_VIEW_IMG:"follower no permission to view img"}},vsh_87326:function(e,t,n){"use strict";n.d(t,{UQ:function(){return i},oz:function(){return o},HV:function(){return a}});var r=function(){var e,t;return(null===(e=window.vcSdk)||void 0===e?void 0:e.getStatus)&&(null===(t=window.vcSdk)||void 0===t?void 0:t.getStatus())};function i(){return"Follow"===r()}function o(){return"Record"===r()}var a=function(e){return e.id()}},vsh_25625:function(e,t,n){"use strict";n.d(t,{VY:function(){return Ee},kK:function(){return we},iX:function(){return o.iX},DS:function(){return C},yz:function(){return i.yz},eu:function(){return i.eu},AA:function(){return i.AA},Hf:function(){return o.Hf},n6:function(){return o.n6},cK:function(){return o.cK},kn:function(){return o.kn},JE:function(){return o.JE},T$:function(){return h},HV:function(){return g.HV},UQ:function(){return g.UQ},p8:function(){return v},YB:function(){return d},$z:function(){return p},Wf:function(){return c},GT:function(){return f},AN:function(){return l.A}});var r=n("vsh_73390"),i=n("vsh_70483"),o=n("vsh_80202"),a=n("vsh_18801"),s=n("vsh_22488"),u=n("vsh_31053"),l=n("vsh_56802");function c(e,t){l.A.shouldSendVCFollowAction()&&a.eventEmitter.emit("".concat(e,".").concat(i.cp.SEND_ACTION),t)}var h=function(e){s.browser.isInVC&&Object.keys(e).forEach((function(t){var n="".concat(t,".").concat(i.cp.APPLY);a.eventEmitter.removeListener(n,e[t]),0===a.eventEmitter.getListeners(n).length&&a.eventEmitter.emit("".concat(t,".").concat(i.cp.CLOSE))}))},d=function(e){s.browser.isInVC&&Object.keys(e).forEach((function(t){var n="".concat(t,".").concat(i.cp.APPLY);0===a.eventEmitter.getListeners(n).length&&a.eventEmitter.emit("".concat(t,".").concat(i.cp.OPEN)),a.eventEmitter.on(n,e[t])}))};function f(e,t){l.A.shouldSendVCFollowAction()&&a.eventEmitter.emit("".concat(e,".").concat(i.cp.SEND_STATE),t)}function p(e){a.eventEmitter.emit(u.FOLLOW_ACTION,{module:"DocComment",actionType:"CommentActive",data:{commentId:e}})}function v(e){a.eventEmitter.emit("".concat(e,".").concat(i.cp.CLOSE)),a.eventEmitter.emit("".concat(e,".").concat(i.cp.OPEN))}var g=n("vsh_87326"),_=n("vsh_19264"),y=n("vsh_4175"),m=n("vsh_96636"),E=n("vsh_22023"),b=n("vsh_82108"),T=function(){function e(t){var n=this;(0,_.Z)(this,e),this.moduleName=i.eu.DocComment,this.actionType="CommentToggle",this.pendingReporter=null,this.unregister=null,this.isOpen=!1,this.statSuccess=function(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];null===(e=n.pendingReporter)||void 0===e||e.statSuccess.apply(e,r),n.pendingReporter=null},this.statFail=function(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];null===(e=n.pendingReporter)||void 0===e||e.statFail.apply(e,r),n.pendingReporter=null},this.statFailNewScale=function(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];null===(e=n.pendingReporter)||void 0===e||e.statFailNewScale.apply(e,r),n.pendingReporter=null},this.statIgnore=function(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];null===(e=n.pendingReporter)||void 0===e||e.statIgnore.apply(e,r),n.pendingReporter=null},this.register(t.replayHandler);this.onUpdateDebounced=(0,m.default)(this.onUpdate.bind(this),300),window.addEventListener("resize",this.onUpdateDebounced)}return(0,y.Z)(e,[{key:"onUpdate",value:function(){this.isOpen&&a.eventEmitter.emit("".concat(u.FOLLOW_EVENT,":").concat(u.FOLLOW_CLICK_THROUGH_AREA_SIZE),{id:"comment-container",top:33,left:window.innerWidth-302,width:302,height:window.innerHeight-33-33})}},{key:"updateState",value:function(e){this.isOpen=e.isOpen,this.onUpdate(),a.eventEmitter.emit(u.FOLLOW_ACTION,{module:this.moduleName,actionType:this.actionType,data:e})}},{key:"statReplayResult",value:function(e){if(this.pendingReporter){var t=this.pendingReporter.actionData.isOpen,n=e.isOpen;(0,E.default)(t,n)?this.statSuccess():this.statFailNewScale("local checkSame fail, toggle expect(".concat(t,") result(").concat(n,")"))}}},{key:"destroy",value:function(){var e;window.removeEventListener("resize",this.onUpdateDebounced),this.onUpdateDebounced.cancel(),null===(e=this.unregister)||void 0===e||e.call(this)}},{key:"_isDataValid",value:function(e){return!(!e||!(0,b.Z)(e.isOpen))}},{key:"register",value:function(e){var t,n=this;null===(t=this.unregister)||void 0===t||t.call(this);var r="".concat(u.FOLLOW_REPLAY,":").concat(this.moduleName,":").concat(this.actionType),i=this.replayEventListenerCreator(e);a.eventEmitter.on(r,i),a.eventEmitter.emit("".concat(u.FOLLOW_EVENT,":").concat(u.FOLLOW_REGISTER),this.registerInfo),this.unregister=function(){a.eventEmitter.removeListener(r,i),a.eventEmitter.emit("".concat(u.FOLLOW_EVENT,":").concat(u.FOLLOW_UNREGISTER),{moduleName:n.moduleName}),n.unregister=null}}},{key:"replayEventListenerCreator",value:function(e){var t=this;return function(n){var i=n.module,a=n.actionType,s=n.data,u=n.uuid,l=n.isRetry;if(t.pendingReporter&&(t.pendingReporter.statIgnore(o.n6.NEW_ACTION_APPLY),t.pendingReporter=null),t.pendingReporter=new r.Z(i,a,u,s),t.pendingReporter.teaLog(o.Hf.RECEIVE_ACTION,"isRetry: ".concat(l,", data: ").concat(JSON.stringify(s))),t.pendingReporter.localLog(o.Hf.RECEIVE_ACTION,"isRetry: ".concat(l,", data: ").concat(JSON.stringify(s))),!t._isDataValid(s))return t.pendingReporter.statFail("invalid data ".concat(JSON.stringify(s))),void(t.pendingReporter=null);e(s)}}},{key:"registerInfo",get:function(){return{moduleName:this.moduleName,retryOptions:{retryTimes:5,retryIntervalMs:500}}}}]),e}(),C=T,S=n("vsh_74561"),w=n("vsh_12064"),R=n("vsh_22462"),A=n("vsh_73455"),O=n("vsh_65498"),M=n("vsh_86982"),k=n("vsh_79170"),I=n("vsh_93301"),x=n("vsh_92292"),N=n("vsh_96579"),P=n("vsh_24627"),L=n("vsh_72834"),D=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":(0,O.Z)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},F=function(){function e(t,n){(0,_.Z)(this,e),this.sheetVCFollow=t,this.methods=n,this.hasRegistered=!1}return(0,y.Z)(e,[{key:"onTimeToUsage",value:function(){}},{key:"getSheetById",value:function(e){return this.methods.getSheetById(e)}},{key:"isActiveSheet",value:function(e){return this.methods.isActiveSheet(e)}},{key:"isSheetLoaded",value:function(e){return this.methods.isSheetLoaded(e)}},{key:"updateState",value:function(e){this.sheetVCFollow.updateState(this.moduleKey,e)}},{key:"updateStateChange",value:function(e){this.sheetVCFollow.updateStateChange(this.moduleKey,e)}},{key:"handleRegister",value:function(){this.hasRegistered=!0,this.sheetVCFollow.bindChange(this.moduleKey,this.apply,this.registerInfo)}},{key:"handleUnRegister",value:function(){this.sheetVCFollow.unbindChange(this.moduleKey),this.hasRegistered=!1}},{key:"init",value:function(){this.on("".concat(this.moduleKey,".").concat(i.cp.OPEN),this.handleRegister),this.on("".concat(this.moduleKey,".").concat(i.cp.CLOSE),this.handleUnRegister),this.on("".concat(this.moduleKey,".").concat(i.cp.SEND_ACTION),this.updateState),this.on("".concat(this.moduleKey,".").concat(i.cp.SEND_STATE),this.updateStateChange)}},{key:"destroy",value:function(){this.handleUnRegister(),this.off("".concat(this.moduleKey,".").concat(i.cp.OPEN)),this.off("".concat(this.moduleKey,".").concat(i.cp.CLOSE)),this.off("".concat(this.moduleKey,".").concat(i.cp.SEND_ACTION)),this.off("".concat(this.moduleKey,".").concat(i.cp.SEND_STATE)),delete this.sheetVCFollow}},{key:"collectApplyError",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(0,N.collectEvent)("sheet_vc_follow_error",{followTrack:"Empower_module_vc_follow_apply:".concat(this.moduleKey,"_error"),followModule:this.moduleKey,followResult:e})}},{key:"on",value:function(e,t){return a.eventEmitter.on(e,t),function(){a.eventEmitter.off(e,t)}}},{key:"off",value:function(e){a.eventEmitter.removeAllListeners(e)}},{key:"emit",value:function(e,t,n){a.eventEmitter.emit(e,t,n)}},{key:"registerInfo",get:function(){return{moduleName:this.moduleKey}}}]),e}();D([(0,x.Bind)()],F.prototype,"getSheetById",null),D([(0,x.Bind)()],F.prototype,"isActiveSheet",null),D([(0,x.Bind)()],F.prototype,"isSheetLoaded",null),D([(0,x.Bind)()],F.prototype,"updateState",null),D([(0,x.Bind)()],F.prototype,"updateStateChange",null),D([(0,x.Bind)()],F.prototype,"handleRegister",null),D([(0,x.Bind)()],F.prototype,"handleUnRegister",null),D([(0,x.Bind)()],F.prototype,"collectApplyError",null);var B=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":(0,O.Z)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},V=function(e){function t(){var e;return(0,_.Z)(this,t),(e=(0,w.Z)(this,(0,R.Z)(t).apply(this,arguments))).moduleKey=i.eu.SheetSearch,e}return(0,A.Z)(t,e),(0,y.Z)(t,[{key:"apply",value:function(e,t){return this.hasRegistered&&e?this.emit("".concat(this.moduleKey,".").concat(i.cp.APPLY),e,t):this.collectApplyError("hasRegistered:".concat(this.hasRegistered," data:").concat(JSON.stringify(e))),!1}},{key:"registerInfo",get:function(){return{moduleName:this.moduleKey,checkSame:function(e,t,n){var r=t.visible,i=t.source,a=n.visible,s=["content"];if(o.JE.PC===i){if(r!==a)return!1;if(!1===r)return!0;s.push("findScope")}return(0,E.default)((0,M.Z)(t,s),(0,M.Z)(n,s))},retryOptions:{retryTimes:5,retryIntervalMs:500}}}}]),t}(F);B([(0,x.Bind)()],V.prototype,"apply",null);var H=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":(0,O.Z)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},U=function(e){function t(){var e;return(0,_.Z)(this,t),(e=(0,w.Z)(this,(0,R.Z)(t).apply(this,arguments))).moduleKey=i.eu.SheetImage,e}return(0,A.Z)(t,e),(0,y.Z)(t,[{key:"checkIsValid",value:function(e){return!!(e&&e.actionType&&e.sheetId)&&!!this.getSheetById(e.sheetId)}},{key:"isSegCell",value:function(e,t){if(!t)return!1;var n=t.row,r=t.col;return!!(0,L.Pq3)(e,n,r)}},{key:"apply",value:function(e,t){var n=this.hasRegistered,r=this.checkIsValid(e);if(!n||!r){var o="hasRegistered:".concat(n," isValid:").concat(r," data:").concat(JSON.stringify(e));return t.statFail(o),this.collectApplyError(o),!1}var a=e.actionType,s=e.cell,u=e.sheetId,l=this.getSheetById(u);if(!l||!this.isSheetLoaded(u))return t.statFail("sheet not ready"),!1;var c=i.AA.OpenImage===a;return c&&!this.isActiveSheet(l)?{needReapply:!0,type:i.uW.ActiveSheetChange}:c&&this.isActiveSheet(l)&&!this.isSegCell(l,s)?{needReapply:!0,type:i.uW.RevisionChange}:(this.emit("".concat(this.moduleKey,".").concat(i.cp.APPLY),e,t),!1)}},{key:"registerInfo",get:function(){return{moduleName:this.moduleKey,checkSame:function(e,t,n){var r=t.actionType;if(r!==n.actionType)return!1;if(r===i.AA.CloseImage)return!0;var o=["cell","sheetId"];return(0,E.default)((0,M.Z)(t,o),(0,M.Z)(n,o))},retryOptions:{retryTimes:12,retryIntervalMs:888}}}}]),t}(F);H([(0,x.Bind)()],U.prototype,"apply",null);var Z=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":(0,O.Z)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},W=function(e){function t(){var e;return(0,_.Z)(this,t),(e=(0,w.Z)(this,(0,R.Z)(t).apply(this,arguments))).moduleKey=i.eu.SheetSwitch,e}return(0,A.Z)(t,e),(0,y.Z)(t,[{key:"apply",value:function(e,t){if(this.hasRegistered&&e){var n=e.sheetId,r=e.deleteSheetId,o=this.getSheetById(n),a=r?this.getSheetById(r):null;return!(!!a&&this.isActiveSheet(a))&&(o&&o.visible()?(this.emit("".concat(this.moduleKey,".").concat(i.cp.APPLY),e,t),!1):{mustReapply:!0,needReapply:!0,type:i.uW.RevisionChange})}return this.collectApplyError("hasRegistered:".concat(this.hasRegistered," data:").concat(JSON.stringify(e))),!1}},{key:"registerInfo",get:function(){return{moduleName:this.moduleKey,checkSame:function(e,t,n){return t.sheetId===n.sheetId},retryOptions:{retryTimes:5,retryIntervalMs:500}}}}]),t}(F);Z([(0,x.Bind)()],W.prototype,"apply",null);var j=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":(0,O.Z)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},G=function(e){function t(){var e;return(0,_.Z)(this,t),(e=(0,w.Z)(this,(0,R.Z)(t).apply(this,arguments))).moduleKey=i.eu.SheetCommentPanel,e}return(0,A.Z)(t,e),(0,y.Z)(t,[{key:"apply",value:function(e,t){return this.hasRegistered&&e?this.emit("".concat(this.moduleKey,".").concat(i.cp.APPLY),e,t):this.collectApplyError("hasRegistered:".concat(this.hasRegistered," data:").concat(JSON.stringify(e))),!1}}]),t}(F);j([(0,x.Bind)()],G.prototype,"apply",null);var z=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":(0,O.Z)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Y=function(e){function t(){var e;return(0,_.Z)(this,t),(e=(0,w.Z)(this,(0,R.Z)(t).apply(this,arguments))).moduleKey=i.eu.SheetZoom,e}return(0,A.Z)(t,e),(0,y.Z)(t,[{key:"apply",value:function(e,t){return this.hasRegistered&&e?this.emit("".concat(this.moduleKey,".").concat(i.cp.APPLY),e,t):this.collectApplyError("hasRegistered:".concat(this.hasRegistered," data:").concat(JSON.stringify(e))),!1}},{key:"registerInfo",get:function(){return{moduleName:this.moduleKey,checkSame:function(e,t,n){var r=t.sheetId,i=t.value,o=n.sheetId,a=n.value;return r!==o||Number(i)===Number(a)},retryOptions:{retryTimes:8,retryIntervalMs:800}}}}]),t}(F);z([(0,x.Bind)()],Y.prototype,"apply",null);var X=n("vsh_13867"),K=n("vsh_22796");var q=function(e){return"number"==typeof e&&e==(0,K.Z)(e)},$=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":(0,O.Z)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},J=function(e){function t(){var e;return(0,_.Z)(this,t),(e=(0,w.Z)(this,(0,R.Z)(t).apply(this,arguments))).moduleKey=i.eu.SheetAttachment,e}return(0,A.Z)(t,e),(0,y.Z)(t,[{key:"_isOpenAction",value:function(e){return"FullScreenAttachment"===e}},{key:"_isValidData",value:function(e){if(!e)return!1;if(!this._isOpenAction(e.actionType))return!0;var t=e.data;if(t){var n=t.row,r=t.col,i=t.fileToken;if(q(n)&&q(r)&&(0,X.Z)(i))return!0}return!1}},{key:"apply",value:function(e,t){if(this.hasRegistered&&e&&this._isValidData(e)){if(this._isOpenAction(e.actionType)){var n=this.getSheetById(e.sheetId);if(!n)return{needReapply:!0,mustReapply:!0,type:i.uW.RevisionChange};if(!this.isActiveSheet(n))return{needReapply:!0,mustReapply:!0,type:i.uW.ActiveSheetChange};var r=e.data,o=r.row,a=r.col,s=r.fileToken;if(!(n.getSegmentArray(o,a)||[]).find((function(e){return(0,P.S3_)(e)&&e.fileToken===s})))return{needReapply:!0,mustReapply:!0,type:i.uW.RevisionChange}}this.emit("".concat(this.moduleKey,".").concat(i.cp.APPLY),e,t)}else this.collectApplyError("hasRegistered:".concat(this.hasRegistered," data:").concat(JSON.stringify(e)));return!1}},{key:"registerInfo",get:function(){return{moduleName:this.moduleKey,checkSame:function(e,t,n){var r=t.actionType;if(r!==n.actionType)return!1;if("CloseFullscreenAttachment"===r)return!0;var i=["data","sheetId"];return(0,E.default)((0,M.Z)(t,i),(0,M.Z)(n,i))},retryOptions:{retryTimes:5,retryIntervalMs:500}}}}]),t}(F);$([(0,x.Bind)()],J.prototype,"apply",null);var Q=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":(0,O.Z)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},ee=function(e){function t(){var e;return(0,_.Z)(this,t),(e=(0,w.Z)(this,(0,R.Z)(t).apply(this,arguments))).moduleKey=i.eu.SheetDocFullScreen,e}return(0,A.Z)(t,e),(0,y.Z)(t,[{key:"apply",value:function(e,t){return this.hasRegistered&&e?this.emit("".concat(this.moduleKey,".").concat(i.cp.APPLY),e,t):this.collectApplyError("hasRegistered:".concat(this.hasRegistered," data:").concat(JSON.stringify(e))),!1}},{key:"registerInfo",get:function(){return{moduleName:this.moduleKey,checkSame:function(e,t,n){return t.actionType===n.actionType},retryOptions:{retryTimes:5,retryIntervalMs:500},defaultState:(0,S.Z)({},this.moduleKey,{source:o.JE.PC,actionType:i.yz.ExitFullScreen})}}}]),t}(F);Q([(0,x.Bind)()],ee.prototype,"apply",null);var te=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":(0,O.Z)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},ne=function(e){function t(){var e;return(0,_.Z)(this,t),(e=(0,w.Z)(this,(0,R.Z)(t).apply(this,arguments))).moduleKey=i.eu.SheetImageZoom,e}return(0,A.Z)(t,e),(0,y.Z)(t,[{key:"apply",value:function(e,t){return this.hasRegistered&&e?this.emit("".concat(this.moduleKey,".").concat(i.cp.APPLY),e,t):this.collectApplyError("hasRegistered:".concat(this.hasRegistered," data:").concat(JSON.stringify(e))),!1}},{key:"registerInfo",get:function(){return{moduleName:this.moduleKey,checkSame:function(e,t,n){var r=["ratio","sheetId"];return(0,E.default)((0,M.Z)(t,r),(0,M.Z)(n,r))},retryOptions:{retryTimes:8,retryIntervalMs:800}}}}]),t}(F);te([(0,x.Bind)()],ne.prototype,"apply",null);var re=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":(0,O.Z)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},ie=function(e){function t(){var e;return(0,_.Z)(this,t),(e=(0,w.Z)(this,(0,R.Z)(t).apply(this,arguments))).moduleKey=i.eu.SheetFloatImage,e}return(0,A.Z)(t,e),(0,y.Z)(t,[{key:"apply",value:function(e,t){if(this.hasRegistered&&e){var n=e.actionType,r=e.sheetId,o=this.getSheetById(r);if(!o)return!1;if(i.AA.OpenImage===n&&!this.isActiveSheet(o))return{needReapply:!0,type:i.uW.ActiveSheetChange};this.emit("".concat(this.moduleKey,".").concat(i.cp.APPLY),e,t)}else this.collectApplyError("hasRegistered:".concat(this.hasRegistered," data:").concat(JSON.stringify(e)));return!1}},{key:"registerInfo",get:function(){return{moduleName:this.moduleKey,checkSame:function(e,t,n){var r=t.actionType;if(r!==n.actionType)return!1;if(r===i.AA.CloseImage)return!0;var o=["sheetId","floatImageId"];return(0,E.default)((0,M.Z)(t,o),(0,M.Z)(n,o))}}}}]),t}(F);re([(0,x.Bind)()],ie.prototype,"apply",null);var oe=n("vsh_56589"),ae=n("vsh_6127"),se=n.n(ae),ue=".viewer-container",le=".viewer-canvas>img",ce=function(e){function t(){var e;return(0,_.Z)(this,t),(e=(0,w.Z)(this,(0,R.Z)(t).apply(this,arguments))).moduleKey=i.eu.SheetMouseHover,e.isCursorSyncEnabledOnPresenter=se().isIPad?(0,s.getMinaBooleanConfig)("byteview.meeting.ms_cursor_sync_ipad",!1):(0,s.getMinaBooleanConfig)("byteview.meeting.ms_cursor_sync",!1),e.disposables=[],e.screenCoordHoverOffset=[0,0],e.mouseIndicator=null,e.isHoverFollowEnabled=se().isFeishuRooms?(0,s.getMinaBooleanConfig)("byteview.vc.magicshare.follow.mouse.rooms",!1):(0,s.getMinaBooleanConfig)("byteview.vc.magicshare.follow.mouse.sheet",!1),e.apply=function(t,n){if(!e.isSheetLoaded(t.sheetId))return n.statFail("sheet not loaded"),{type:i.uW.ActiveSheetChange,mustReapply:!1,needReapply:!0};var r=e.getSheetById(t.sheetId);if(!r||!e.isActiveSheet(r))return n.statFail("sheet not active"),{type:i.uW.ActiveSheetChange,mustReapply:!1,needReapply:!0};if("sheet"===t.type){var o=r.getCanvasBoundingClientRect(),a=e.getPageCoordPoint(o,t.shtCrd);if(a){if(e.isHoverFollowEnabled&&e.updateHoverOffset(o,[r.getRowHeaderColWidth(),r.getRowHeaderHeight()],a)&&e.methods.replayLastScroll){e.methods.replayLastScroll();var s=e.getPageCoordPoint(o,t.shtCrd);s&&(a=s)}return e.drawMouseIconAt(a[0],a[1]),void n.statSuccess()}}else if("image"===t.type){var u=document.querySelector("".concat(ue,">").concat(le));if(u){var l=u.getBoundingClientRect();return e.drawMouseIconAt(l.left+l.width*t.x,l.top+l.height*t.y),void n.statSuccess()}}e.hideMouseIcon(),n.statSuccess()},e.getHoverOffset=function(){return e.screenCoordHoverOffset},e.lastMouseSyncType="none",e.hideRemoteMouseIndicator=function(){var t,n;if("none"!==e.lastMouseSyncType){var r=null===(t=(n=e.methods).getActiveSheetId)||void 0===t?void 0:t.call(n);r&&(c(i.eu.SheetMouseHover,{sheetId:r,source:o.JE.PC,type:"none"}),e.lastMouseSyncType="none")}},e.hideMouseIcon=function(){e.mouseIndicator&&(e.mouseIndicator.style.opacity="0")},e.onImageViewerMouseMove=function(t,n){var r,a;if(n){if(l.A.shouldSendVCFollowAction()){var s=null===(r=(a=e.methods).getActiveSheetId)||void 0===r?void 0:r.call(a);if(s){var u=n.getBoundingClientRect(),h=(t.pageX-u.left)/u.width,d=(t.pageY-u.top)/u.height;h<0||h>1||d<0||d>1?e.hideRemoteMouseIndicator():(c(i.eu.SheetMouseHover,{sheetId:s,source:o.JE.PC,type:"image",x:h,y:d}),e.lastMouseSyncType="image")}}}else e.lastMouseSyncType="none"},e.onSheetCanvasMouseMove=function(t){var n,r,a,s;if(l.A.shouldSendVCFollowAction()){var u=null===(n=(r=e.methods).getActiveSheetId)||void 0===n?void 0:n.call(r);if(u){var h=null===(a=(s=e.methods).getSheetPointByGlobal)||void 0===a?void 0:a.call(s,t.offsetX,t.offsetY);h?(c(i.eu.SheetMouseHover,{sheetId:u,source:o.JE.PC,type:"sheet",shtCrd:h}),e.lastMouseSyncType="sheet"):e.hideRemoteMouseIndicator()}}},e}return(0,A.Z)(t,e),(0,y.Z)(t,[{key:"getPageCoordPoint",value:function(e,t){var n,r,i=null===(n=(r=this.methods).getGlobalPointBySheet)||void 0===n?void 0:n.call(r,t);return i?[e.x+i[0],e.y+i[1]]:null}},{key:"updateHoverOffset",value:function(e,t,n){var r=e.height/5,i=e.width/5,o=!1,a=e.left+t[0],s=e.right,u=e.top+t[1],l=e.bottom;return n[0]<a?(o=!0,this.screenCoordHoverOffset[0]+=n[0]-a-i):n[0]>s&&(o=!0,this.screenCoordHoverOffset[0]+=n[0]-s+i),n[1]<u?(o=!0,this.screenCoordHoverOffset[1]+=n[1]-u-r):n[1]>l&&(o=!0,this.screenCoordHoverOffset[1]+=n[1]-l+r),o}},{key:"drawMouseIconAt",value:function(e,t){if(!this.mouseIndicator){var n=document.createElement("div");n.attachShadow({mode:"open"}).innerHTML=(r=String(Math.random()),'<svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<g filter="url(#filter0_'.concat(r,')">\n<mask id="mask0_').concat(r,'" style="mask-type:luminance" maskUnits="userSpaceOnUse" x="2" y="1" width="19" height="20">\n<path d="M21 1H2V21H21V1Z" fill="white"/>\n</mask>\n<g mask="url(#mask0_').concat(r,')">\n<path d="M4.82605 1.96865L19.378 8.87917C20.5431 9.43247 20.2996 11.1632 19.0094 11.4993L11.8482 12.3269C11.8193 12.3344 11.7948 12.3549 11.7825 12.3822L9.72374 19.2909C9.16882 20.503 7.4221 20.4423 7.07954 19.1987L2.80091 3.66794C2.48034 2.5043 3.73575 1.45088 4.82605 1.96865Z" fill="#DF58A5"/>\n<path d="M4.82605 1.96865L19.378 8.87917C20.5431 9.43247 20.2996 11.1632 19.0094 11.4993L11.8482 12.3269C11.8193 12.3344 11.7948 12.3549 11.7825 12.3822L9.72374 19.2909C9.16882 20.503 7.4221 20.4423 7.07954 19.1987L2.80091 3.66794C2.48034 2.5043 3.73575 1.45088 4.82605 1.96865Z" fill="#DF58A5"/>\n<path d="M4.82605 1.96865L19.378 8.87917C20.5431 9.43247 20.2996 11.1632 19.0094 11.4993L11.8482 12.3269C11.8193 12.3344 11.7948 12.3549 11.7825 12.3822L9.72374 19.2909C9.16882 20.503 7.4221 20.4423 7.07954 19.1987L2.80091 3.66794C2.48034 2.5043 3.73575 1.45088 4.82605 1.96865Z" stroke="white" stroke-width="1.30429"/>\n</g>\n</g>\n<defs>\n<filter id="filter0_').concat(r,'" x="0.399048" y="0.398499" width="23.1897" height="24.0688" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n<feDropShadow dx="0" dy="1" stdDeviation="1.5" flood-color="#555555"></feDropShadow>\n</filter>\n<linearGradient id="paint0_').concat(r,'" x1="9.04591" y1="20.13" x2="10.1849" y2="2.33407" gradientUnits="userSpaceOnUse">\n<stop stop-color="#D136D1"/>\n<stop offset="0.595997" stop-color="#F76964"/>\n<stop offset="1" stop-color="#FFC60A"/>\n</linearGradient>\n</defs>\n</svg>\n')),n.className="vc-hover-mouse",n.style.willChange="transform",n.style.transition="transform 0.2s ease-out",document.body.appendChild(n),this.mouseIndicator=n,this.mouseIndicator.style.position="fixed",this.mouseIndicator.style.zIndex="999"}var r;this.mouseIndicator.style.opacity="1",this.mouseIndicator.style.transform="translate(".concat(e,"px, ").concat(t,"px)")}},{key:"onTimeToUsage",value:function(){var e,t,n=this;if(this.isCursorSyncEnabledOnPresenter){if(this.isCursorSyncEnabledOnPresenter){var r,o,a,s,l=null===(e=(t=this.methods).getShellHost)||void 0===e?void 0:e.call(t);l?(console.log("SheetMouseHoverVCFollow startListenMouseMove"),r=l,o=0,a=0,s=function e(t){var i=Date.now();if(i-o<200)return a&&clearTimeout(a),void(a=window.setTimeout((function(){a=0,e(t)}),200-(i-o)));o=i;var s=t.target;s instanceof HTMLElement&&(s===r?n.onSheetCanvasMouseMove(t):"IMG"===s.tagName&&s.matches(le)?n.onImageViewerMouseMove(t,s):"DIV"===s.tagName&&s.parentElement&&s.parentElement.matches(ue)?n.onImageViewerMouseMove(t,s.parentElement.querySelector(le)):n.hideRemoteMouseIndicator())},document.body.addEventListener("mousemove",s),d((0,S.Z)({},i.eu.SheetMouseHover,n.apply)),n.disposables.push((function(){document.body.removeEventListener("mousemove",s)}))):console.error("No dom for SheetMouseHoverVcFollow"),this.disposables.push(this.on("".concat(u.STOP_FOLLOW),this.hideMouseIcon)),this.disposables.push(this.on("".concat(u.START_RECORD),this.hideMouseIcon))}}}},{key:"destroy",value:function(){var e,n;(0,oe.Z)((0,R.Z)(t.prototype),"destroy",this).call(this),(null===(e=(n=this.methods).getShellHost)||void 0===e?void 0:e.call(n))?(this.lastMouseSyncType="none",this.disposables.forEach((function(e){return e()})),this.disposables.length=0,this.mouseIndicator&&(this.mouseIndicator.remove(),this.mouseIndicator=null)):console.error("[VcFollow] not loaded")}},{key:"registerInfo",get:function(){return{moduleName:this.moduleKey,checkSame:function(e,t,n){return!0},retryOptions:{retryTimes:8,retryIntervalMs:800}}}}]),t}(F),he=n("vsh_57616"),de=n("vsh_67017"),fe=n.n(de),pe=n("vsh_35067"),ve=function(){function e(t){var n=this;(0,_.Z)(this,e),this.vcFollow=t,this.destroySheetVCFollow=function(){n.vcFollow.destroySheetVCFollow(),n.bindOrUnbindPresenterStateChange(!1)},this.registerVCModule=function(){var e=(0,pe.Z)(fe().mark((function e(t,r){return fe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.vcFollow.registerVCModule(t,r);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.updateStateChange=function(e,t){n.vcFollow.updateStateChange(e),n.updatePresenterPosition(e,i.uU.Follower,t)},this.updateState=function(e,t){n.vcFollow.updateState(e,t),n.updatePresenterPosition(e,i.uU.Follower,t)},this.sendPositionToVC=function(e){n.vcFollow.sendPositionToVC(e)},this.bindOrUnbindPresenterStateChange=function(e){var t=e?"bindPresenterChange":"unbindPresenterChange";[i.eu.SheetImage,i.eu.SheetSwitch,i.eu.SheetScroll,i.eu.SheetFloatImage].forEach((function(e){n[t](e,(function(t){return n.updatePresenterPosition(e,i.uU.Prosenter,t)}))}))},this.updatePresenterPosition=function(e,t,r){var i=r&&n.moduleDataToVCPostionData(e,r,t);i&&n.vcFollow.sendPositionToVC(n.packageVcPositionData(i,t))},this.moduleDataToVCPostionData=function(e,t,r){return e===i.eu.SheetImage?n.mergeImageDataToVCPostionData(t,r):e===i.eu.SheetSwitch?n.mergeSheetDataToVCPostionData(t,r):e===i.eu.SheetScroll?n.mergeScrollDataToVCPostionData(t):e===i.eu.SheetFloatImage?n.mergeFloatImageDataToVCPostionData(t):void 0},this.mergeImageDataToVCPostionData=function(e,t){var n=i.AA.CloseImage;return{imageState:e.actionType===n?n:"".concat(t,":").concat(i.AA.OpenImage)}},this.mergeSheetDataToVCPostionData=function(e,t){var n=e.isBlock,r=e.sheetId;return{sheetId:n?"".concat(t,":").concat(r):r}},this.mergeScrollDataToVCPostionData=function(e){return{x:e.posX,y:e.posY,sheetId:e.sheetId}},this.mergeFloatImageDataToVCPostionData=function(e){return{floatImageState:e.actionType}},this.packageVcPositionData=function(e,t){var r=n.mergePosition(e,t),i=r.follower,o=r.presenter;return n.savePosition(i,o),n.transformPosition(i,o)},this.mergePosition=function(e,t){var r=n.followerModulePos,o=n.presenterModulePos;function a(e,t){return Object.assign({},e,{},t)}return t===i.uU.Follower?r=a(r,e):t===i.uU.Prosenter&&(o=a(o,e)),{follower:r,presenter:o}},this.savePosition=function(e,t){n.followerModulePos=e,n.presenterModulePos=t},this.transformPosition=function(e,t){function n(e){return{x:e.x,y:e.y,space:"".concat(e.sheetId,":").concat(e.imageState)}}return{presenter:n(t),follower:n(e)}},this.bindOrUnbindPresenterStateChange(!0);var r={x:0,y:0,sheetId:"",imageState:i.AA.CloseImage,floatImageState:i.AA.CloseImage};this.followerModulePos=r,this.presenterModulePos=r}return(0,y.Z)(e,[{key:"bindChange",value:function(e,t,n){this.vcFollow.bindChange(e,t,n)}},{key:"unbindChange",value:function(e){this.vcFollow.unbindChange(e)}},{key:"bindPresenterChange",value:function(e,t){this.vcFollow.bindPresenterChange(e,t)}},{key:"unbindPresenterChange",value:function(e){this.vcFollow.unbindPresenterChange(e)}}]),e}(),ge=n("vsh_33916"),_e=n("vsh_75986");var ye=function(){function e(t){var n=this;(0,_.Z)(this,e),this.collaSpread=t,this.subscriber=null,this.shellSubscriber=null,this.pluginSubscription=null,this.shell=null,this._disposed=!1,this.getSheetById=function(e){return function(e,t){try{return e.spread.getSheetFromId(t)}catch(e){console.error(e)}}(n.collaSpread,e)},this.isActiveSheet=function(e){return!!e&&function(e,t){try{return t&&e.spread.getActiveSheet().id()===t.id()}catch(e){console.error(e)}}(n.collaSpread,e)},this.checkSheetLoaded=function(e){var t;return!(null===(t=n.collaSpread.sdk.getPlugin(_e.IEf))||void 0===t||!t.isSheetLoaded(e))},this.getCommonParams=function(e){return{source:o.JE.PC,sheetId:e.id()}},this.onTimeToUsage=function(){n.forceUpdate(),n.bindApplyList(),n.pluginList.forEach((function(e){return e.onTimeToUsage()}))},this.bindOrUnbindFasterApplyList=function(e){var t;null!==(t=n.context)&&void 0!==t&&t.isEmbed()&&n.collaSpread.spreadLoaded&&n.bindApplyList(),"unbind"===e&&n.getApplyBindList().forEach((function(e){var t;return null===(t=n.sheetVCFollowMediator)||void 0===t?void 0:t.unbindChange(e.key)}))},this._hadBindApplyList=!1,this.bindApplyList=function(){n._hadBindApplyList||(n.getApplyBindList().forEach((function(e){var t,r=e.handler,i=e.key,o=e.registerInfo;null===(t=n.sheetVCFollowMediator)||void 0===t||t.bindChange(i,r,o)})),n._hadBindApplyList=!0,a.eventEmitter.emit("".concat(u.FOLLOW_EVENT,":").concat(u.FOLLOW_REGISTER),{moduleName:i.eu.SheetScroll}))},this.handleEnterBrowserVCMode=function(){l.A.shouldSendVCFollowAction()&&n.forceUpdate()},this.forceFasterModuleReapply=function(e){if((0,g.UQ)()){var t=n.getApplyBindList().find((function(t){return t.key===e}));if(null!=t&&t.handler){var r,i,o=t.handler,a=t.registerInfo;null===(r=n.sheetVCFollowMediator)||void 0===r||r.unbindChange(e),null===(i=n.sheetVCFollowMediator)||void 0===i||i.bindChange(e,o,a)}}},this.updateState=function(e,t){n.sheetVCFollowMediator.updateState(e,t)},this.updateStateChange=function(e,t){n.sheetVCFollowMediator.updateStateChange(e)},this.bindChange=function(e,t,r){n.sheetVCFollowMediator.bindChange(e,t,r)},this.unbindChange=function(e){n.sheetVCFollowMediator.unbindChange(e)},this.sendPositionToVC=function(e){n.sheetVCFollowMediator.sendPositionToVC(e)},this.bindPresenterChange=function(e,t){n.sheetVCFollowMediator.bindPresenterChange(e,t)},this.unbindPresenterChange=function(e){n.sheetVCFollowMediator.unbindPresenterChange(e)},this.getSheetPointByGlobal=function(e,t){if(!n.shell)return null;var r=n.shell.sheetView().tableContainer(),i=n.shell.sheetView().contentDoc(),o=r.mapFromGlobal(new ge.FPoint(e,t));return{x:o.x+i.posX,y:o.y+i.posY}},this.getGlobalPointBySheet=function(e){if(!n.shell)return null;var t=e.x,r=e.y,i=n.shell.sheetView().tableContainer().mapToGlobal(new ge.FPoint(t,r)),o=n.shell.sheetView().contentDoc();return[i.x-o.posX,i.y-o.posY]}}return(0,y.Z)(e,[{key:"getShell",value:function(){return this.collaSpread.lazyBindShell()}},{key:"init",value:function(){var e=this;this.subscriber=this.spread.subscribe(this.getDepends()),this.getShell().then((function(t){e.shell=t,e.shellSubscriber=t.subscribe(e.getShellDepends())})),this.getUpdateBindList().forEach((function(t){return e.spread.bind(t.key,t.handler)})),this.pluginList=this.getPluginsList(),this.pluginList.forEach((function(e){return e.init()}));var t=this.collaSpread.sdk.getPlugin(_e.IEf);null!=t&&t.isSheetToUsage()?this.onTimeToUsage():this.pluginSubscription=this.collaSpread.sdk.subscribePluginEventMap((0,S.Z)({},"LoadStatusStore/SheetToUsage",this.onTimeToUsage)),this.bindOrUnbindFasterApplyList("bind"),a.eventEmitter.on(o.iX,this.forceFasterModuleReapply),this.afterInit&&this.afterInit(),P.roj&&l.A.registerOnEnterBrowserVCMode(this.handleEnterBrowserVCMode)}},{key:"dispose",value:function(){var e=this;this._disposed||(P.roj&&l.A.unregisterOnEnterBrowserVCMode(this.handleEnterBrowserVCMode),this.subscriber&&this.subscriber.unsubscribe(),this.shellSubscriber&&this.shellSubscriber.unsubscribe(),this.getUpdateBindList().forEach((function(t){e.spread&&e.spread.unbind(t.key,t.handler)})),this.pluginList.forEach((function(e){return e.destroy()})),this.pluginSubscription&&this.pluginSubscription.unsubscribe(),this.pluginSubscription=null,this.bindOrUnbindFasterApplyList("unbind"),a.eventEmitter.off(o.iX,this.forceFasterModuleReapply),this.afterDispose&&this.afterDispose(),delete this.collaSpread,this._disposed=!0)}},{key:"spread",get:function(){return this.collaSpread.spread}},{key:"context",get:function(){return this.collaSpread.context}}]),e}(),me=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":(0,O.Z)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Ee=function(e){function t(e){var n,r,a,u,l;return(0,_.Z)(this,t),(l=(0,w.Z)(this,(0,R.Z)(t).call(this,e))).activeCellReporter=null,l._lockApplyScroll=!1,l.lastSheetScrollAction=null,l.forceUpdate=function(){var e=l.collaSpread.getActiveSheet();e&&!e.blockType&&(l.updateActiveCell({sheetId:e.id()}),l.updateSheetScroll({sheetId:e.id()}))},l.getHoverOffset=null,l.handleActiveCellChanged=function(e){var t=e.sheetId,n=e.row,r=e.col,i=l.activeCellReporter;if(i){var o=(0,M.Z)(i.actionData,["sheetId","row","col"]),a={sheetId:t,row:n,col:r};(0,E.default)(o,a)?i.statSuccess():i.statFailNewScale("local checkSame fail expect(".concat(JSON.stringify(o),") result(").concat(JSON.stringify(a),")")),l.activeCellReporter=null}l.updateActiveCell({sheetId:t})},l.applyActiveCell=function(e,t){var n,r=e.sheetId,a=e.row,s=e.col;null===(n=l.activeCellReporter)||void 0===n||n.statIgnore(o.n6.NEW_ACTION_APPLY),l.activeCellReporter=t;var u=l.getSheetById(r);if(u&&[a,s].every(I.default)){var c=u.getActiveCellIndex(),h=c.row,d=c.column,f=h!==a||s!==d;return f&&u.setActiveCell(a,s),void(f||(l.updateState(i.eu.SheetActiveCell,Object.assign({},l.getCommonParams(u),{row:a,col:s})),t.statSuccess(),l.activeCellReporter=null))}t.statFail("hasSheet: ".concat(!!u,", row: ").concat(a,", col: ").concat(s)),l.activeCellReporter=null},l.lockApplyScroll=(0,m.default)((function(){var e=l.spread.getActiveSheet();null!=e&&e.getActiveCommentId()&&(l._lockApplyScroll=!0,clearTimeout(l._lockApplyScrollTimeoutID),l._lockApplyScrollTimeoutID=setTimeout((function(){return l._lockApplyScroll=!1}),2e3))}),200),l.applySheetScroll=function(e,t){var n=e.sheetId,r=e.posX,a=e.posY,u=l.getSheetById(n),c=!u||[r,a].every((0,k.Z)(I.default));l.lastSheetScrollAction=e;var h=l.isActiveSheet(u);if(l._lockApplyScroll)return l._lockApplyScroll=!1,clearTimeout(l._lockApplyScrollTimeoutID),void(null==t||t.statSuccess());if(l.shell&&u)if(c)null==t||t.statFail("return early: data invalid posX: ".concat(r,", posY: ").concat(a));else{var d=l.shell.sheetView(),f=d.getViewModel();if((0,s.getMinaBooleanConfig)("ccm.sheet.vc_scroll_apply_after_fit_rows")&&f&&f.fitRowCalc.hasDirty())return null==t||t.localLog(o.Hf.APPLYING,"reapply: fitRow hasDirty"),null==t||t.teaLog(o.Hf.APPLYING,"pending: fitRow hasDirty"),{needReapply:!0,mustReapply:!0,type:i.uW.FitRowsSuccess};var p=d.getDocOffset();if(h&&p){var v=p.offsetX,g=p.offsetY;if(l.getHoverOffset){var _=l.getHoverOffset();_&&(r+=_[0],a+=_[1])}return(v!==r||g!==a)&&u.notifyShell(L._16.SetScrollPos,{posX:r,posY:a}),void(null==t||t.statSuccess())}null==t||t.statFail("isSheetActive: ".concat(h,", docOffsetData: ").concat(JSON.stringify(p)))}else null==t||t.statFail("return early: hasShell: ".concat(!!l.shell,", hasSheet: ").concat(!!u))},l.scrollCheckSame=function(e,t){var n,r,i,o;if(!l.shell)return!0;var a=l.shell.sheetView().getDocMaxPosition(),s=a.maxX,u=a.maxY,c=e.sheetId,h=e.posX,d=e.posY,f=t.sheetId,p=t.posX,v=t.posY;if(c!==f)return!0;var g=null===(n=(r=l).getHoverOffset)||void 0===n?void 0:n.call(r),_=null!==(i=null==g?void 0:g[0])&&void 0!==i?i:0,y=null!==(o=null==g?void 0:g[1])&&void 0!==o?o:0,m=!1,E=!1;return(Math.abs(p-_-h)<=30||p===s)&&(m=!0),(Math.abs(v-y-d)<=30||v===u)&&(E=!0),m&&E},l.sheetVCFollowMediator=new ve(new he.I(e,i.jy.Alone)),(0,N.collectEvent)("sheet_vc_follow",{followTrack:"INIT",followResult:"scmVersion(".concat(null===(n=window)||void 0===n||null===(r=n.scm)||void 0===r?void 0:r.version,") scmSheetVersion(").concat(null===(a=window)||void 0===a||null===(u=a.scmsheet)||void 0===u?void 0:u.version,")")}),l.init(),l}return(0,A.Z)(t,e),(0,y.Z)(t,[{key:"afterDispose",value:function(){this.sheetVCFollowMediator.destroySheetVCFollow(),delete this.sheetVCFollowMediator,clearTimeout(this._lockApplyScrollTimeoutID)}},{key:"getUpdateBindList",value:function(){return[]}},{key:"getDepends",value:function(){var e;return e={},(0,S.Z)(e,P.U_F.ActiveCellChanged,this.handleActiveCellChanged),(0,S.Z)(e,P.U_F.CommentChanged,this.lockApplyScroll),(0,S.Z)(e,P.HaZ.ActiveSheetChanged,this.forceUpdate),e}},{key:"getShellDepends",value:function(){return(0,S.Z)({},P.jy$.LeftTopPosChanged,this.updateSheetScroll)}},{key:"getApplyBindList",value:function(){var e=this;return[{key:i.eu.SheetScroll,handler:this.applySheetScroll,registerInfo:{moduleName:i.eu.SheetScroll,checkSame:function(t,n,r){return e.scrollCheckSame((0,M.Z)(n,"posX","posY","sheetId"),(0,M.Z)(r,"posX","posY","sheetId"))},retryOptions:{retryTimes:5,retryIntervalMs:500}}},{key:i.eu.SheetActiveCell,handler:this.applyActiveCell,registerInfo:{moduleName:i.eu.SheetActiveCell,checkSame:function(t,n,r){if(n.sheetId!==r.sheetId){var i=e.getSheetById(n.sheetId);return!(i&&e.checkSheetLoaded(i.id())&&e.isActiveSheet(i))}var o=["row","col"];return(0,E.default)((0,M.Z)(n,o),(0,M.Z)(r,o))},retryOptions:{retryTimes:5,retryIntervalMs:800}}}]}},{key:"getPluginsList",value:function(){var e=this,t={getSheetById:this.getSheetById,isActiveSheet:this.isActiveSheet,isSheetLoaded:this.checkSheetLoaded,getGlobalPointBySheet:this.getGlobalPointBySheet,getSheetPointByGlobal:this.getSheetPointByGlobal,getShellHost:function(){var t,n,r;return null!==(t=null===(n=e.collaSpread.shell.sheetView())||void 0===n||null===(r=n.getFaster())||void 0===r?void 0:r.canvas().element())&&void 0!==t?t:null},getActiveSheetId:function(){var t,n;return null!==(t=null===(n=e.spread.getActiveSheet())||void 0===n?void 0:n.id())&&void 0!==t?t:null},replayLastScroll:function(){e.lastSheetScrollAction&&e.applySheetScroll(e.lastSheetScrollAction)}},n=new ce(this.sheetVCFollowMediator,t);return n.isHoverFollowEnabled&&(this.getHoverOffset=function(){return n.getHoverOffset()}),[new V(this.sheetVCFollowMediator,t),new U(this.sheetVCFollowMediator,t),new W(this.sheetVCFollowMediator,t),new Y(this.sheetVCFollowMediator,t),new J(this.sheetVCFollowMediator,t),new ie(this.sheetVCFollowMediator,t),new ne(this.sheetVCFollowMediator,t),n]}},{key:"updateActiveCell",value:function(e){var t=i.eu.SheetActiveCell,n=this.getSheetById(e.sheetId),r=!1;if(n&&n.getActiveCellIndex()){var o=n.getActiveCellIndex(),a=o.row,s=o.column,u=Object.assign({},this.getCommonParams(n),{row:a,col:s});this.updateState(t,u),r=!0}!r&&this.collectUpdateFail(t,{existSheet:!!n,activeCellIndex:null==n?void 0:n.getActiveCellIndex()})}},{key:"updateSheetScroll",value:function(e){var t,n=this.getSheetById(e.sheetId);if(null!==(t=this.shell)&&void 0!==t&&t.sheetView()&&n){var r=!1,a=this.shell.sheetView().getDocOffset();if(a){var s=a.offsetX,u=a.offsetY,l=Object.assign({},this.getCommonParams(n),{posX:s,posY:u,zoom:o.uT});this.updateState(i.eu.SheetScroll,l),r=!0}!r&&this.collectUpdateFail(i.eu.SheetScroll,{existSheet:!!n,docOffset:a})}}},{key:"collectUpdateFail",value:function(e,t){return(0,N.collectEvent)("sheet_vc_follow_error",{followTrack:"update:error",followModule:e,followResult:t})}}]),t}(ye);me([(0,x.Bind)(),(0,x.Debounce)(200)],Ee.prototype,"updateActiveCell",null),me([(0,x.Bind)(),(0,x.Debounce)(200)],Ee.prototype,"updateSheetScroll",null);var be=n("vsh_59980"),Te=n("vsh_83190"),Ce=n("vsh_74340"),Se=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":(0,O.Z)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},we=function(e){function t(e){var n,r,u,l,h,d;return(0,_.Z)(this,t),(d=(0,w.Z)(this,(0,R.Z)(t).call(this,e))).shellMap={},d.getShellBySheetId=function(e){return d.shellMap[e]},d.sheetActiveCellVCReporterMap=new Map,d.sheetDocViewOffsetVCReporterMap=new Map,d.sheetDocscrollReporterMap=new Map,d.setSheetShell=function(e,t){d.shellMap[e]||(d.shellMap[e]=t,d.forceFasterModuleReapply(i.eu.SheetDocViewOffset),d.forceFasterModuleReapply(i.eu.SheetDocScroll),d.forceFasterModuleReapply(i.eu.SheetActiveCell))},d.removeSheetShell=function(e){d.shellMap[e]&&delete d.shellMap[e]},d.handleEnterFullScreenMode=function(){var e;d._updateSheetDocScroll({sheetId:null===(e=d.collaSpread.getActiveSheet())||void 0===e?void 0:e.id()})},d.forceUpdate=function(){var e=d.collaSpread.getActiveSheet();e&&(d.updateActiveCell({sheetId:e.id()}),d.updateSheetDocScroll({sheetId:e.id()}),c(i.eu.SheetDocFullScreen,{sheetId:e.id(),source:o.JE.PC,actionType:i.yz.ExitFullScreen}))},d.applySheetDocScroll=function(e,t){var n=e.sheetId,r=e.posX,a=e.posY,u=d.getSheetById(n),l=d.getShellBySheetId(n);if((0,s.getIsDocx)()&&u&&!u.parent._context.isFullScreenMode())t.statSuccess();else{if(d.sheetDocscrollReporterMap.has(n)){var c=d.sheetDocscrollReporterMap.get(n);null==c||c.statIgnore(o.n6.NEW_ACTION_APPLY),d.sheetDocscrollReporterMap.delete(n)}if(d.sheetDocscrollReporterMap.set(n,t),!l)return d.sheetDocscrollReporterMap.delete(n),t.statIgnore("shell no register, regsiter will replay");var h=i.eu.SheetDocScroll,f=d.isActiveSheet(u);if((0,N.collectEvent)("sheet_vc_follow",{followTrack:"updateSheetDocScroll:".concat(h),followModule:h,followResult:JSON.stringify({sheetId:n,posX:r,posY:a}),followError:!f}),u&&(0,I.default)(r)&&l){var p=u.parent._context.isFullScreenMode(),v=l.sheetView().getDocOffset();if(!v)return d.sheetDocscrollReporterMap.delete(n),void t.statFail("no scrollPosData: ".concat(v));var g=v.offsetX,_=v.offsetY;return!p||g===r&&_===a?g!==r?l.sheetView().setScrollPos({x:r}):d.updateSheetDocScroll({sheetId:n}):l.sheetView().setScrollPos({x:r,y:a}),d.sheetDocscrollReporterMap.delete(n),t.statSuccess()}d.sheetDocscrollReporterMap.delete(n),t.statFail("hasSheet: ".concat(!!u,", hasShell: ").concat(!!l,", posX: ").concat(r))}},d.handleEmbedSheetOffsetLeftChanged=function(e,t){var n=t.sheetId,r=d.sheetDocViewOffsetVCReporterMap.get(n);if(r){var i=(0,M.Z)(r.actionData,["x","offsetX"]),o=(0,M.Z)(t,["x","offsetX"]),a=d.getShellBySheetId(n),s=null==a?void 0:a.sheetView(),u=s&&s.getMinSheetViewX()===o.x;d.isSameSheetDocViewOffset(i,o)||u?r.statSuccess():r.statFailNewScale("local checkSame fail x/offsetX expect(".concat(JSON.stringify(i),") result(").concat(JSON.stringify(o),")")),d.sheetDocViewOffsetVCReporterMap.delete(n)}d.updateSheetViewOffset(e,t)},d.isSameSheetDocViewOffset=function(e,t){var n=e.x,r=e.offsetX,i=t.x,o=t.offsetX,a=(0===r?1:n/r).toFixed(2),s=0===o,u=(s?1:i/o).toFixed(2),l=Math.abs(Number(a)-Number(u))*o<=30;return s||l},d.applySheetDocViewOffset=function(e,t){var n=e.sheetId,r=e.x,a=e.offsetX;if(d.sheetDocViewOffsetVCReporterMap.has(n)){var u=d.sheetDocViewOffsetVCReporterMap.get(n);null==u||u.statIgnore(o.n6.NEW_ACTION_APPLY),d.sheetDocViewOffsetVCReporterMap.delete(n)}d.sheetDocViewOffsetVCReporterMap.set(n,t);var l=d.getSheetById(n),c=d.getShellBySheetId(n);if(!c)return t.statIgnore("shell no register, register will replay"),void d.sheetDocViewOffsetVCReporterMap.delete(n);if((0,s.getIsDocx)())return t.statSuccess(),void d.sheetDocViewOffsetVCReporterMap.delete(n);var h=i.eu.SheetDocViewOffset,f=d.isActiveSheet(l);if((0,N.collectEvent)("sheet_vc_follow",{followTrack:"updateSheetDocViewOffset:".concat(h),followModule:h,followResult:JSON.stringify({sheetId:n,presenterX:r,presenterOffsetX:a}),followError:!f}),l&&c&&[r,a].every(I.default)){var p=c.sheetView(),v=p.getSheetViewOffset();if(!v)return t.statFail("no viewPosData: ".concat(v)),void d.sheetDocViewOffsetVCReporterMap.delete(n);var g=v.offsetX,_=v.x,y=(0===a?1:r/a)*g;(y=Math.max(p.getMinSheetViewX(),y))!==_?p.setSheetOffset({x:y}):(t.statSuccess(),d.sheetDocViewOffsetVCReporterMap.delete(n),d.updateSheetViewOffset(o.QG,{x:_,offsetX:g,sheetId:n}))}else t.statFail("hasSheet: ".concat(!!l,", hasShell: ").concat(!!c,", presenterX: ").concat(r,", presenterOffsetX: ").concat(a)),d.sheetDocViewOffsetVCReporterMap.delete(n)},d.handleActiveCellChanged=function(e){var t,n,r,i=e.sheetId,o=e.row,a=e.col,s=d.sheetActiveCellVCReporterMap.get(i);if(s){var u=(0,M.Z)(s.actionData,["sheetId","row","col"]),l={sheetId:i,row:o,col:a};(0,E.default)(u,l)||(n=-1===u.row,r=0===(null==(t=d.collaSpread.spread.getSheetFromId(l.sheetId))?void 0:t.getSelections().length),u.sheetId===l.sheetId&&n&&r)?s.statSuccess():s.statFailNewScale("local checkSame fail expect(".concat(JSON.stringify(u),") result(").concat(JSON.stringify(l),")")),d.sheetActiveCellVCReporterMap.delete(i)}d.updateActiveCell({sheetId:i})},d.applyActiveCell=function(e,t){var n=e.sheetId,r=e.row,s=e.col,u=e.source;if(d.sheetActiveCellVCReporterMap.has(n)){var l=d.sheetActiveCellVCReporterMap.get(n);null==l||l.statIgnore(o.n6.NEW_ACTION_APPLY),d.sheetActiveCellVCReporterMap.delete(n)}d.sheetActiveCellVCReporterMap.set(n,t);var c=d.collaSpread.getActiveSheet(),h=d.collaSpread.spread._context.isFullScreenMode();[u===o.JE.mobild,h].every(Boolean)&&(a.eventEmitter.emit(o.kn),h=!1);var f=d.getSheetById(n);h||(c.id()!==n&&(c.clearSelection(),d.collaSpread.spread.setActiveSheetId(n,!0)),c.id()===n&&(0,be.default)(a.store.getState(),"sheet.embedToolbar.activeSheetId")||a.store.dispatch((0,Te.setActiveSheetId)(n)));var p=[-1===r,!h].every(Boolean);if(f&&p){var v=f.getActiveCellIndex(),g=v.row,_=v.column;return f.clearSelection(),void(0===g&&0===_&&(d.updateState(i.eu.SheetActiveCell,Object.assign({},d.getCommonParams(f),{row:r,col:s})),t.statSuccess(),d.sheetActiveCellVCReporterMap.delete(n)))}if(f&&[r,s].every(I.default)){var y=f.getActiveCellIndex(),m=y.row,E=y.column,b=!f.getSelections().length,T=m!==r||s!==E;return(b||T)&&f.setActiveCell(r,s),void((b&&0===r&&0===s||!T)&&(d.updateState(i.eu.SheetActiveCell,Object.assign({},d.getCommonParams(f),{row:r,col:s})),t.statSuccess(),d.sheetActiveCellVCReporterMap.delete(n)))}t.statFail("hasSheet: ".concat(!!f,", row: ").concat(r,", col: ").concat(s)),d.sheetActiveCellVCReporterMap.delete(n)},null===(n=d.context)||void 0===n||n.bind(Ce.YVA.ENTER_FULL_SCREEN_MODE,d.handleEnterFullScreenMode),d.sheetVCFollowMediator=new ve(new he.I(e,i.jy.Embedded)),d.init(),(0,N.collectEvent)("sheet_vc_follow",{followTrack:"EmbedVCManager",followResult:"scmVersion(".concat(null===(r=window)||void 0===r||null===(u=r.scm)||void 0===u?void 0:u.version,") scmSheetVersion(").concat(null===(l=window)||void 0===l||null===(h=l.scmsheet)||void 0===h?void 0:h.version,")")}),d}return(0,A.Z)(t,e),(0,y.Z)(t,[{key:"afterDispose",value:function(){var e;this.sheetVCFollowMediator.destroySheetVCFollow(),delete this.sheetVCFollowMediator,t.instance=null,null===(e=this.context)||void 0===e||e.unbind(Ce.YVA.ENTER_FULL_SCREEN_MODE,this.handleEnterFullScreenMode)}},{key:"getUpdateBindList",value:function(){return[{key:P.zW2.EmbedSheetOffsetLeftChanged,handler:this.handleEmbedSheetOffsetLeftChanged}]}},{key:"getDepends",value:function(){var e;return e={},(0,S.Z)(e,P.U_F.ActiveCellChanged,this.handleActiveCellChanged),(0,S.Z)(e,P.HaZ.ActiveSheetChanged,this.updateActiveCellSheetChanged),e}},{key:"getShellDepends",value:function(){return{}}},{key:"getApplyBindList",value:function(){var e=this;return[{key:i.eu.SheetDocScroll,handler:this.applySheetDocScroll,registerInfo:{moduleName:i.eu.SheetDocScroll,checkSame:function(t,n,r){var i=n.posX,o=n.sheetId,a=r.posX,s=r.sheetId;if(!e.shellMap[s]||o!==s)return!0;var u=e.getShellBySheetId(s).sheetView().getDocMaxPosition().maxX;return u<=0||a===u||i===a},retryOptions:{retryTimes:5,retryIntervalMs:800}}},{key:i.eu.SheetDocViewOffset,handler:this.applySheetDocViewOffset,registerInfo:{moduleName:i.eu.SheetDocViewOffset,checkSame:function(t,n,r){var i=n.offsetX,o=n.x,a=n.sheetId,s=r.offsetX,u=r.x,l=r.sheetId;return!e.shellMap[l]||a!==l||(!![i,s].some((function(e){return 0===e}))||e.isSameSheetDocViewOffset({x:o,offsetX:i},{x:u,offsetX:s}))},retryOptions:{retryTimes:8,retryIntervalMs:800}}},{key:i.eu.SheetActiveCell,handler:this.applyActiveCell,registerInfo:{moduleName:i.eu.SheetActiveCell,checkSame:function(t,n,r){var i=r.sheetId;if(!e.shellMap[i])return!0;var o=["sheetId","row","col"];return(0,E.default)((0,M.Z)(n,o),(0,M.Z)(r,o))},retryOptions:{retryTimes:8,retryIntervalMs:800}}}]}},{key:"getPluginsList",value:function(){var e={getSheetById:this.getSheetById,isActiveSheet:this.isActiveSheet,isSheetLoaded:this.checkSheetLoaded};return[new V(this.sheetVCFollowMediator,e),new U(this.sheetVCFollowMediator,e),new W(this.sheetVCFollowMediator,e),new J(this.sheetVCFollowMediator,e),new ee(this.sheetVCFollowMediator,e),new ne(this.sheetVCFollowMediator,e)]}},{key:"updateSheetDocScroll",value:function(e){var t=e.sheetId,n=this.sheetDocscrollReporterMap.get(t);if(n){var r=this.getShellBySheetId(e.sheetId),i=(null==r?void 0:r.sheetView().getDocOffset())||{},o=i.offsetX,a=i.offsetY,s=(0,M.Z)(n.actionData,["sheetId","posX","posY"]),u={sheetId:t,posX:o,posY:a};(0,E.default)(s,u)?n.statSuccess():n.statFailNewScale("local checkSame fail expect(".concat(JSON.stringify(s),") result(").concat(JSON.stringify(u),")")),this.sheetDocscrollReporterMap.delete(t)}this._updateSheetDocScroll(e)}},{key:"_updateSheetDocScroll",value:function(e){if(!(0,s.getIsDocx)()||this.context.isFullScreenMode()){var t=this.getSheetById(e.sheetId),n=this.getShellBySheetId(e.sheetId),r=!1,o=i.eu.SheetDocScroll;if(t&&n){var a=t.parent._context.isFullScreenMode(),u=n.sheetView().getDocOffset(),l=u.offsetX,c=u.offsetY,h=Object.assign({},this.getCommonParams(t),{posX:l});a&&(h.posY=c),this.updateState(o,h),r=!0}!r&&this.collectUpdateFail(o,{existSheet:!!t,activeCellIndex:n.sheetView().getDocOffset()})}}},{key:"updateSheetViewOffset",value:function(e,t){var n=t.sheetId,r=this.getSheetById(n),o=this.getShellBySheetId(n);if(!(0,s.getIsDocx)()){var a=i.eu.SheetDocViewOffset,u=!1;if(r&&null!=o&&o.sheetView()){var l=o.sheetView().getSheetViewOffset(),c=l.offsetX,h=l.x,d=Object.assign({},this.getCommonParams(r),{x:h,offsetX:c});this.updateState(a,d),u=!0}!u&&this.collectUpdateFail(a,{existSheet:!!r,sheetViewOffset:{x:t.x,offsetX:t.offsetX}})}}},{key:"updateActiveCellState",value:function(e){var t=i.eu.SheetActiveCell,n=!1;if(e&&e.getActiveCellIndex()){var r=e.getActiveCellIndex(),o=r.row,a=r.column,s=Object.assign({},this.getCommonParams(e),{row:o,col:a});this.updateState(t,s),n=!0}!n&&this.collectUpdateFail(t,{existSheet:!!e,activeCellIndex:e.getActiveCellIndex()})}},{key:"updateActiveCell",value:function(e){if(this.collaSpread.getActiveSheet().id()===e.sheetId){var t=this.getSheetById(e.sheetId);if(t)if(t.getSelections().length||this.collaSpread.spread._context.isFullScreenMode())this.updateActiveCellState(t);else{var n=t.getActiveCellIndex().column;this.updateState(i.eu.SheetActiveCell,Object.assign({},this.getCommonParams(t),{row:-1,col:n}))}}}},{key:"updateActiveCellSheetChanged",value:function(e){var t=e.newSheet;this.updateActiveCell({sheetId:t.id()})}},{key:"collectUpdateFail",value:function(e,t){return(0,N.collectEvent)("sheet_vc_follow_error",{followTrack:"update:error",followModule:e,followResult:t})}}],[{key:"getInstance",value:function(e){return t.instance||(t.instance=new t(e)),t.instance}}]),t}(ye);we.instance=null,Se([(0,x.Bind)()],we.prototype,"updateSheetDocScroll",null),Se([(0,x.Bind)(),(0,x.Debounce)(200)],we.prototype,"_updateSheetDocScroll",null),Se([(0,x.Bind)(),(0,x.Debounce)(200)],we.prototype,"updateSheetViewOffset",null),Se([(0,x.Bind)(),(0,x.Debounce)(200)],we.prototype,"updateActiveCell",null),Se([(0,x.Bind)(),(0,x.Debounce)(200)],we.prototype,"updateActiveCellSheetChanged",null)},vsh_56802:function(e,t,n){"use strict";n.d(t,{A:function(){return s}});var r=n("vsh_19264"),i=n("vsh_4175"),o=n("vsh_22488"),a=n("vsh_24627"),s=new(function(){function e(){var t=this;if((0,r.Z)(this,e),this.isPresenterInPcWeb=!1,this.isActiveTab=!0,this.onEnterVCModeCbs=[],this.onExitVCModeCbs=[],this.handleExitBrowserVCMode=function(){t.isActiveTab=!0,t.isPresenterInPcWeb=!1,t.onExitVCModeCbs.forEach((function(e){return e()}))},this.handleEnterBrowserVCMode=function(){t.isActiveTab=!0,t.isPresenterInPcWeb=!0,t.onEnterVCModeCbs.forEach((function(e){return e()}))},this.handlePageActive=function(){t.isActiveTab=!0},this.handlePageDeactive=function(){t.isActiveTab=!1},a.roj){var n={onEnter:this.handleEnterBrowserVCMode,onExit:this.handleExitBrowserVCMode,onPageActive:this.handlePageActive,onPageDeactivate:this.handlePageDeactive};o.VcShareScreenHelper.getInstance().register(n)}}return(0,i.Z)(e,[{key:"shouldSendVCFollowAction",value:function(){return o.browser.isInVC||a.roj&&this.isPresenterInPcWeb&&this.isActiveTab}},{key:"registerOnEnterBrowserVCMode",value:function(e){this.onEnterVCModeCbs.push(e),this.isPresenterInPcWeb&&e()}},{key:"unregisterOnEnterBrowserVCMode",value:function(e){this.onEnterVCModeCbs=this.onEnterVCModeCbs.filter((function(t){return t!==e}))}},{key:"registerOnExitBrowserVCMode",value:function(e){this.onExitVCModeCbs.push(e)}},{key:"unregisterOnExitBrowserVCMode",value:function(e){this.onExitVCModeCbs=this.onExitVCModeCbs.filter((function(t){return t!==e}))}}]),e}())},vsh_57616:function(e,t,n){"use strict";n.d(t,{I:function(){return y}});var r=n("vsh_74561"),i=n("vsh_67017"),o=n.n(i),a=n("vsh_35067"),s=n("vsh_19264"),u=n("vsh_4175"),l=n("vsh_31053"),c=n("vsh_33916"),h=n("vsh_18801"),d=n("vsh_96579"),f=n("vsh_24627"),p=n("vsh_74340"),v=n("vsh_80202"),g=n("vsh_70483"),_=n("vsh_73390");e=n.hmd(e);var y=function(){function t(e,n){var r=this;(0,s.Z)(this,t),this.collaSpread=e,this.type=n,this.needReapplyModuleMap={},this.needReapplyModuleMapActive={},this.needReapplyModuleMapFitRows={},this.registerVCModuleMap={},this.subscriber=null,this.serviceSubscription=null,this.destroySheetVCFollow=function(){r.destroy(),r.unbindVersionChange(r.emitSuiteVersionChange)},this.emitSuiteVersionChange=function(){try{r.type===g.jy.Embedded?h.eventEmitter.emit("BLOCK_COLLAB_VERSION_CHANGE",{type:"sheet",rev:Number(r.getVersion())}):h.eventEmitter.emit("".concat(l.FOLLOW_EVENT,":").concat(l.SUITE_VERSION_CHANGE),r.getVersion())}catch(e){console.error(e)}},this.handleVersionLag=function(e){var t,n;if(null!==(t=r.collaSpread)&&void 0!==t&&t.engine&&null!==(n=r.collaSpread)&&void 0!==n&&n.sync){var i=r.collaSpread.engine.getBaseRev();e.nextVersion!==i&&r.collaSpread.sync.forceHeartbeatSync((function(){}),(function(){}))}},this.handleReapplyWhenVersionChange=function(){r.reapply(r.needReapplyModuleMap)},this.bindVersionChange=function(e){r.collaSpread&&r.collaSpread.sdk&&(r.serviceSubscription=r.collaSpread.sdk.getService(p.AHm).subscribeClientRev(e))},this.unbindVersionChange=function(e){r.serviceSubscription&&r.serviceSubscription.unsubscribe()},this.mount=function(){r.bindVersionChange(r.handleReapplyWhenVersionChange),r.subscriber=r.collaSpread.spread.subscribe(r.getDepends())},this.handleReapplyWhenSheetChange=function(){r.removeIdleListener(),r._idleListener=c.FApp.addIdleListener((function(){r.reapply(r.needReapplyModuleMapActive),r.removeIdleListener()}))},this.handleReapplyWhenFitRowsSuccess=function(){r.reapply(r.needReapplyModuleMapFitRows)},this.removeIdleListener=function(){r._idleListener&&(c.FApp.removeIdleListener(r._idleListener),r._idleListener=0)},this.destroy=function(){r.subscriber&&r.subscriber.unsubscribe(),r.subscriber=null,r.unbindVersionChange(r.handleReapplyWhenVersionChange),Object.keys(r.moduleApplyStateCallbackMap).forEach((function(e){return r.unbindChange(e)})),h.eventEmitter.off("".concat(l.FOLLOW_EVENT,":").concat(l.SUITE_VERSION_LAG),r.handleVersionLag),delete r.collaSpread,delete window.sheetVCEventEmitter,delete window.sheetVCFollow},this.reapply=function(e){var t=Object.keys(e);try{t.forEach((function(t){var n=e[t];if(n){var r=n.callback,i=n.executeTime,o=r(),a=o&&o.mustReapply;!a||i>=10?e[t]=void 0:a&&n.executeTime++,t!==g.eu.SheetScroll&&(0,d.collectEvent)("sheet_vc_follow",{followTrack:"reapply:".concat(t),followModule:t,followResult:o})}}))}catch(e){console.error(e),(0,d.collectEvent)("sheet_vc_follow_error",{followTrack:"reapply:error",followResult:e&&e.message})}},this.registerVCModule=function(){var e=(0,a.Z)(o().mark((function e(t,n){var i,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=function(){return(s=(0,a.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=4;break}return e.next=3,n();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)},i=function(){return s.apply(this,arguments)},r.registerVCModuleMap[t]||((0,l.registerVCModule)({moduleName:t,getCurrentModuleState:i}),r.registerVCModuleMap[t]=n);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.sendPositionToVC=function(e){console.log("sendPositionToVC",e),h.eventEmitter.emit("".concat(l.FOLLOW_EVENT,":").concat("PRESENTER_FOLLOWER_LOCATION"),e)},this.bindReplayEvent=function(e,t,n){console.log("[sheet vc]: bind replay",e),(0,d.collectEvent)("sheet_vc_follow",{followTrack:"".concat(l.FOLLOW_REGISTER),followModule:e}),r.moduleReplayEventListenerMap[e]&&r.unbindReplayEvent(e);var i=function(e){var n=e.module,i=e.actionType,o=e.data,a=e.uuid,s=e.isRetry,u=new _.Z(n,i||n,a,o);u.teaLog(v.Hf.RECEIVE_ACTION,"isRetry: ".concat(s,", data: ").concat(JSON.stringify(o))),u.localLog(v.Hf.RECEIVE_ACTION,"isRetry: ".concat(s,", data: ").concat(JSON.stringify(o)));try{var c;o&&(c=t(o,u,i),r.addReapply({module:n,callback:t,data:o,result:c,actionType:i,vcReporter:u}))}catch(e){(0,d.collectEvent)("sheet_vc_follow_error",{followTrack:"".concat(l.FOLLOW_REPLAY,":").concat(n,"_error"),followModule:n,followResult:e&&e.message,followError:JSON.stringify(e)}),u.statFail("".concat(n,"_error:").concat(JSON.stringify(e)))}};h.eventEmitter.on("".concat(l.FOLLOW_REPLAY,":").concat(e),i),r.moduleReplayEventListenerMap[e]=i,h.eventEmitter.emit("".concat(l.FOLLOW_EVENT,":").concat(l.FOLLOW_REGISTER),n)},this.addReapply=function(e){var t=e.module,n=e.callback,i=e.data,o=e.result,a=e.actionType,s=e.vcReporter;if(o&&o.needReapply)switch(o.type){case g.uW.ActiveSheetChange:r.needReapplyModuleMapActive[t]={callback:function(){return n(i,s,a)},executeTime:0};break;case g.uW.RevisionChange:r.needReapplyModuleMap[t]={callback:function(){return n(i,s,a)},executeTime:0};break;case g.uW.FitRowsSuccess:r.needReapplyModuleMapFitRows[t]={callback:function(){return n(i,s,a)},executeTime:0}}},this.unbindReplayEvent=function(e){h.eventEmitter.removeListener("".concat(l.FOLLOW_REPLAY,":").concat(e),r.moduleReplayEventListenerMap[e]),r.moduleReplayEventListenerMap[e]=void 0,h.eventEmitter.emit("".concat(l.FOLLOW_EVENT,":").concat(l.FOLLOW_UNREGISTER),{moduleName:e})},this.getVersion=function(){return String(r.collaSpread.engine.getBaseRev())},this.mockEmitReplay=function(e,t){h.eventEmitter.emit("".concat(l.FOLLOW_REPLAY,":").concat(e),{data:t})},this.moduleApplyStateCallbackMap={},this.modulePresenterStateCallbackMap={},this.moduleReplayEventListenerMap={},this.mount(),this.bindVersionChange(this.emitSuiteVersionChange),this.emitSuiteVersionChange(),h.eventEmitter.on("".concat(l.FOLLOW_EVENT,":").concat(l.SUITE_VERSION_LAG),this.handleVersionLag),window.sheetVCEventEmitter=h.eventEmitter,window.sheetVCFollow=this}return(0,u.Z)(t,[{key:"getDepends",value:function(){var e;return e={},(0,r.Z)(e,f.HaZ.ActiveSheetChanged,this.handleReapplyWhenSheetChange),(0,r.Z)(e,f.U_F.InvalidateRowHeight,this.handleReapplyWhenFitRowsSuccess),e}},{key:"updateStateChange",value:function(e){h.eventEmitter.emit(l.FOLLOW_STATE_CHANGE,e)}},{key:"updateState",value:function(t,n){(0,d.collectEvent)("sheet_vc_follow",{followTrack:"SEND_ACTION",followModule:e,followResult:"data: ".concat(JSON.stringify(n))}),this.emitFollowAction(t,n)}},{key:"emitFollowAction",value:function(e,t){h.eventEmitter.emit(l.FOLLOW_ACTION,{module:e,actionType:e,data:t})}},{key:"bindPresenterChange",value:function(e,t){this.modulePresenterStateCallbackMap[e]&&this.unbindPresenterChange(e),this.modulePresenterStateCallbackMap[e]=t,h.eventEmitter.on("".concat(l.PRESENTER_STATE,":").concat(e),(function(e){var n=e.module,r=e.actionType,i=e.data,o=e.uuid,a=new _.Z(n,r||n,o,i);try{i&&t(i,a,r)}catch(e){(0,d.collectEvent)("sheet_vc_follow_error",{followTrack:"".concat(l.PRESENTER_STATE,":").concat(n,"_error"),followModule:n,followResult:e&&e.message,followError:JSON.stringify(e)})}}))}},{key:"unbindPresenterChange",value:function(e){h.eventEmitter.removeAllListeners("".concat(l.PRESENTER_STATE,":").concat(e)),this.modulePresenterStateCallbackMap[e]=void 0}},{key:"bindChange",value:function(e,t,n){this.moduleApplyStateCallbackMap[e]&&this.unbindChange(e),this.moduleApplyStateCallbackMap[e]=t,this.bindReplayEvent(e,t,n)}},{key:"unbindChange",value:function(e){this.moduleApplyStateCallbackMap[e]&&(this.unbindReplayEvent(e),this.moduleApplyStateCallbackMap[e]=void 0)}}]),t}()},vsh_70483:function(e,t,n){"use strict";var r,i,o,a,s,u,l,c;n.d(t,{uW:function(){return u},uU:function(){return l},yz:function(){return a},eu:function(){return r},AA:function(){return o},jy:function(){return c},cp:function(){return s}}),function(e){e.SheetSwitch="SheetSwitch",e.SheetScroll="SheetScroll",e.SheetSearch="SheetSearch",e.SheetCommentPanel="SheetCommentPanel",e.SheetImage="SheetImage",e.SheetActiveCell="SheetActiveCell",e.SheetZoom="SheetZoom",e.SheetAttachment="SheetAttachment",e.SheetImageZoom="SheetImageZoom",e.SheetFloatImage="SheetFloatImage",e.SheetMouseHover="SheetMouseHover",e.SheetDocScroll="SheetDocScroll",e.SheetDocViewOffset="SheetDocViewOffset",e.SheetDocFullScreen="SheetDocFullScreen",e.DocComment="DocComment"}(r||(r={})),function(e){e.OpenComment="OpenComment",e.CloseComment="CloseComment"}(i||(i={})),function(e){e.OpenImage="OpenImage",e.CloseImage="CloseImage",e.SwitchImage="SwitchImage"}(o||(o={})),function(e){e.EnterFullScreen="EnterFullScreen",e.ExitFullScreen="ExitFullScreen"}(a||(a={})),function(e){e.CLOSE="CLOSE",e.OPEN="OPEN",e.SEND_ACTION="SEND_ACTION",e.SEND_STATE="SEND_STATE",e.APPLY="APPLY"}(s||(s={})),function(e){e.ActiveSheetChange="ActiveSheetChange",e.RevisionChange="RevisionChange",e.FitRowsSuccess="FitRowsSuccess"}(u||(u={})),function(e){e.Prosenter="P",e.Follower="F"}(l||(l={})),function(e){e.Embedded="Embedded",e.Alone="Alone"}(c||(c={}))},vsh_73390:function(e,t,n){"use strict";n.d(t,{Z:function(){return m}});var r=n("vsh_19264"),i=n("vsh_4175"),o=n("vsh_80202"),a=n("vsh_96579"),s=n("vsh_22488"),u=function(e,t){return"".concat(t).concat(e).concat("[0m")},l=["[97;41m","[97;42m","[97;43m","[97;44m","[97;45m","[97;46m","[30;41m","[30;42m","[30;43m","[30;45m","[30;46m","[97;101m","[97;102m","[97;104m","[97;106m","[30;101m","[30;102m","[30;103m","[30;104m","[30;106m"],c="[92;100m",h="[91;100m",d="[33;100m",f=function(e){return"string"!=typeof e?"":e.substring(0,8)},p=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3?arguments[3]:void 0,i=function(){if(!n)return"";var e=f(n);return null!=r&&r.uuidBashStyle?"".concat(u(e,r.uuidBashStyle),"."):"".concat(e,".")}();return"".concat(i).concat(t,".").concat(e)},v="success",g="fail",_="ignore",y=function(){function e(t,n,i,o){(0,r.Z)(this,e),this.moduleName=t,this.actionType=n,this.uuid=i,this.actionData=o,this._uuidBashStyle=l[Math.floor(Math.random()*(l.length-1))]}return(0,i.Z)(e,[{key:"statSuccess",value:function(e){(0,s.statSuccess)(this.uuid,e);var t=v;this.localLog(o.Hf.REPORT_APPLY_STATUS,t),this.teaLog(o.Hf.REPORT_APPLY_STATUS,t)}},{key:"statFail",value:function(e,t){(0,s.statFail)(this.uuid,e,t);var n="".concat(g,"-").concat(e);this.localLog(o.Hf.REPORT_APPLY_STATUS,n),this.teaLog(o.Hf.REPORT_APPLY_STATUS,n,!0)}},{key:"statFailNewScale",value:function(e,t){this.statFail("".concat(o.pM).concat(e),t)}},{key:"statIgnore",value:function(e,t){(0,s.statIgnore)(this.uuid,e,t);var n="".concat(_,"-").concat(e);this.localLog(o.Hf.REPORT_APPLY_STATUS,n),this.teaLog(o.Hf.REPORT_APPLY_STATUS,n)}},{key:"localLog",value:function(e,t){var n=this._uuidBashStyle,r=function(){if(e===o.Hf.REPORT_APPLY_STATUS)switch(!0){case t.startsWith(v):return c;case t.startsWith(g):return h;case t.startsWith(_):return d;default:return}}();console.log("".concat(o.U9," ").concat(p(this.moduleName,this.actionType,this.uuid,{uuidBashStyle:n})," ").concat(function(e,t,n){var r=null!=n&&n.stageBashStyle?u(e,n.stageBashStyle):e;return"".concat(r,"-").concat(t)}(e,t,{stageBashStyle:r})))}},{key:"teaLog",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={followModule:p(this.moduleName,this.actionType,this.uuid),followTrack:e,followResult:t};(0,a.collectEvent)(n?o.j7:o.Vm,r)}}]),e}(),m=y},vsh_57533:function(e,t,n){"use strict";n.d(t,{Xw2:function(){return r},jvJ:function(){return i},LFI:function(){return o},vLQ:function(){return a},afz:function(){return s},vFM:function(){return u},cOv:function(){return l},iu$:function(){return c},ns_:function(){return h},YBK:function(){return d},NMh:function(){return f},h9Q:function(){return p},ID$:function(){return v},wTB:function(){return g},sdT:function(){return _},wA6:function(){return y},_uJ:function(){return m},ZsF:function(){return E},i5y:function(){return b},i_1:function(){return T},Uj0:function(){return C},O_q:function(){return S},H4k:function(){return w},O0T:function(){return R},DzQ:function(){return A},_ZG:function(){return O},u1e:function(){return M},MSh:function(){return k},oTc:function(){return I},ZVY:function(){return x},u_d:function(){return N},NhJ:function(){return P},tbK:function(){return L},tPq:function(){return D},eT1:function(){return F},g$6:function(){return B},a5u:function(){return V},Oh0:function(){return H},$xN:function(){return U},v1U:function(){return Z},ctD:function(){return W},Jxf:function(){return j},t52:function(){return G},uIe:function(){return z},rG6:function(){return Y},_yc:function(){return X},Bcr:function(){return K},IJh:function(){return q},VSo:function(){return $},MCh:function(){return J},JEM:function(){return Q},DFf:function(){return ee},ctH:function(){return te},Xx5:function(){return ne},aEw:function(){return re},keb:function(){return ie},p10:function(){return oe},VE1:function(){return ae},e8e:function(){return se},zqo:function(){return ue},HB4:function(){return le},bR0:function(){return ce},ba_:function(){return he},ZcN:function(){return de},MHc:function(){return fe},$7N:function(){return pe},k6K:function(){return ve},auN:function(){return ge},nb0:function(){return _e},HeF:function(){return ye},TUd:function(){return me},Dru:function(){return Ee},ROS:function(){return be},kyn:function(){return Te},iWz:function(){return Ce},_Bu:function(){return Se},s0S:function(){return we},jH1:function(){return Re},J3x:function(){return Ae},UZ6:function(){return Oe},vzX:function(){return Me},blX:function(){return ke},V7q:function(){return Ie},$A8:function(){return xe},$zA:function(){return Ne},TxO:function(){return Pe},N4b:function(){return Le},V4y:function(){return De},B2d:function(){return Fe},ouc:function(){return Be},q70:function(){return Ve},sVc:function(){return He},ApP:function(){return Ue},Tpb:function(){return Ze},W2w:function(){return We},SRA:function(){return je},GIr:function(){return Ge},Qdz:function(){return ze},ymz:function(){return Ye},$4G:function(){return Xe},DJW:function(){return Ke},$HW:function(){return qe},r0V:function(){return $e},FfF:function(){return Je},XJC:function(){return Qe},HwT:function(){return et},dpx:function(){return tt},KGd:function(){return nt},JMH:function(){return rt},G3m:function(){return it},ZYJ:function(){return ot},ZlJ:function(){return at},ZN6:function(){return st},FHw:function(){return ut},XlT:function(){return lt},znk:function(){return ct},mvv:function(){return ht},FQF:function(){return dt},XWj:function(){return ft},ZYf:function(){return pt},$J9:function(){return vt},Cc_:function(){return gt},hyG:function(){return _t},P51:function(){return yt},q9u:function(){return mt},FyK:function(){return Et},Cm9:function(){return bt},XDO:function(){return Tt},vcF:function(){return Ct},BqQ:function(){return St},BW_:function(){return wt},fnA:function(){return Rt},SDW:function(){return At},I5V:function(){return Ot},n5M:function(){return Mt},R_z:function(){return kt},H$_:function(){return It},Lf5:function(){return xt},_xz:function(){return Nt},B$M:function(){return Pt},L90:function(){return Lt},CPq:function(){return Dt},prn:function(){return Ft},$nT:function(){return Bt},oTl:function(){return Vt},nAR:function(){return Ht},xAd:function(){return Ut},Cp3:function(){return Zt},nMv:function(){return Wt},gG_:function(){return jt},IY4:function(){return Gt},pKd:function(){return zt},UWP:function(){return Yt},QVu:function(){return Xt},Xk_:function(){return Kt},xKo:function(){return qt},GWW:function(){return $t},bOi:function(){return Jt},BLN:function(){return Qt},GQ:function(){return en},tz7:function(){return tn},Cg0:function(){return nn},IsC:function(){return rn},Qzi:function(){return on},c2S:function(){return an},XV9:function(){return sn},rTl:function(){return un},n8_:function(){return ln},dAE:function(){return cn},d_t:function(){return hn},$nw:function(){return dn},zUc:function(){return fn},Bkd:function(){return pn},UjP:function(){return vn},rLI:function(){return gn},nmk:function(){return _n},rNi:function(){return yn},bp9:function(){return mn},y65:function(){return En},Fw5:function(){return bn},rfn:function(){return Tn},acr:function(){return Cn},Cbh:function(){return Sn},O_r:function(){return wn},U89:function(){return Rn},ifA:function(){return An},sHL:function(){return On},pQV:function(){return Mn}});var r="SHOW_FORMULA_LIST",i="HIDE_FORMULA_LIST",o="TOGGLE_FORMULA_LIST",a="SHOW_FINDBAR",s="FOCUS_FINDBAR",u="UPDATE_SHEET_STATUS",l="UPDATE_RANGE_CALC_STATUS",c="SET_ACTIVE_SHEETID",h="SHOW_HYPER_LINK_EDITOR",d="FORMAT_PAINTER_TOGGLE",f="TOGGLE_COMMENT_PANEL",p="ADD_SHEET_COMMENT",v="PULL_SHEET_COMMENT",g="PULL_SHEET_COMMENT_SUCCESS",_="PULL_SHEET_COMMENT_FAIL",y="ADD_SHEET_COMMENT_REPLY",m="RESOLVE_SHEET_COMMENT",E="DELETE_SHEET_REPLY_COMMENT",b="DELETE_SHEET_COMMENT",T="UPDATE_SHEET_REPLY_COMMENT",C="FAKE_UPDATE_SHEET_REPLY_COMMENT",S="UPDATE_SHEET_REPLY_COMMENT_SUCCESS",w="UPDATE_COMMENT_DATA",R="TOGGLE_COMMENT_MASK",A="CLEAN_COMMENT",O="SHOW_HISTORY",M="HIDE_HISTORY",k="SHOW_DROPDOWN_MENU",I="SHOW_DROPDOWN_MENU_MODAL_FROM_SELECTOR",x="HIDE_DROPDOWN_MENU_TO_SELECTOR",N="SET_DROPDOWN_MENU_DRAG_LIST",P="SET_DROPDOWN_MENU_OPTIONS_BEFORE_MODIFIED",L="SET_DROPDOWN_MENU_IS_ENABLE_OPTION_COLOR",D="SET_DROPDOWN_MENU_COLOR_INDEX",F="SET_DROPDOWN_MENU_CONTENT_TYPE",B="SET_DROPDOWN_MENU_ACTIVE_KEY",V="SET_DROPDOWN_MENU_CONFIG",H="CHANNEL_ONLINE",U="CHANNEL_OFFLINE",Z="SHOW_FILTER_MENU",W="TOGGLE_FILTER_PERSONAL_CHECKED",j="SET_EMBED_SHEET_COMMENT_FUNC",G="SET_EMBED_TOOLBAR_VISIBLE",z="TOGGLE_NAV_BAR",Y="TOGGLE_TEMPLATE_MODE",X="TOGGLE_READONLY_MODE",K="UPDATE_TOOLBAR_LOADED",q="UPDATE_RANGE_CONDITION_FORMAT_RULES",$="SET_SHEET_CLIENT_VARS",J="RESET_SHEET_CLIENT_VARS",Q="EMBED_SHEET_MOUNT",ee="EMBED_SHEET_RESET",te="EMBED_SHEET_UNMOUNT",ne="EMBED_SHEET_IS_DOCX_EDITABLE",re="CHANGE_SHEET_PERMISSION",ie="SHOW_PROTECTION_DIALOG",oe="CLOSE_PROTECTION_DIALOG",ae="SHOW_PROTECTION_PANEL",se="CLOSE_PROTECTION_PANEL",ue="UPDATE_PROTECTION_PANEL_HIGHLIGHT_PERMID",le="INIT_SHEET_CHART",ce="SET_SHEET_CHART",he="DEL_SHEET_CHART",de="SET_ACTIVE_CHART",fe="CLEAR_ACTIVE_CHART",pe="HIDE_CHART_PANEL",ve="SHOW_CHART_PANEL",ge="HIDE_CHART_SELECTOR_MODAL",_e="SHOW_CHART_SELECTOR_MODAL",ye="CHANGE_CHART_PREVIEW_COLOR_STYLE",me="SET_CHART_SETTING_PALNEL_OPTIONS",Ee="SHOW_CONDITION_FORMAT_PANEL",be="HIDE_CONDITION_FORMAT_PANEL",Te="SHOW_DATA_CLEAN_PANEL",Ce="HIDE_DATA_CLEAN_PANEL",Se="SET_CONDITION_FORMAT_PANEL_INJECT_CONFIG",we="HIDE_CONDITION_FORMAT_SELECTOR_MODAL",Re="SHOW_CONDITION_FORMAT_SELECTOR_MODAL",Ae="SET_EMBED_COMMENT_DATA",Oe="SET_COMMENT_OLD_SDK_INIT_STATUS",Me="UPDATE_SHEET_FEATURE_TIPS",ke="SET_HIGHLIGHT_BAR_VISIBLE",Ie="SET_SHEET_PERMISSIONS",xe="SET_SHEET_HALT",Ne="RESET_SHEET_STATUS",Pe="UPDATE_SHEET_ZOOM",Le="RESET_SHEET_ZOOM",De="UPDATE_SHEET_MODULE",Fe="UPDATE_SHEET_GRIDLINEHIDDEN",Be="GET_FORMULA_CORRECT",Ve="GET_FORMULA_CORRECT_SUCCESS",He="GET_FORMULA_CORRECT_FAIL",Ue="GET_COMPLEMENT_FORMULAS",Ze="GET_COMPLEMENT_FORMULAS_SUCCESS",We="GET_COMPLEMENT_FORMULAS_FAIL",je="SET_TRANSLATE_MODE",Ge="SET_SMARTABLE_TRANSFORM_STATE",ze="INIT_FLOAT_BLOCKS",Ye="SET_FLOAT_BLOCK",Xe="DEL_FLOAT_BLOCK",Ke="SET_ACTIVE_FLOAT_BLOCK",qe="CLEAR_ACTIVE_FLOAT_BLOCK",$e="SHOW_SHEET_RANGE_SELECTOR",Je="HIDE_SHEET_RANGE_SELECTOR",Qe="TOGGLE_CONTEXTMENU",et="SHOW_DATA_VALIDATION_MODAL",tt="HIDE_DATA_VALIDATION_MODAL",nt="SET_DATA_VALIDATION_SHEET_ID",rt="SET_DATA_VALIDATION_TARGET_SELECTION",it="SET_DATA_VALIDATION_TYPE",ot="SET_DATA_VALIDATION_OPERATOR",at="SET_DATA_VALIDATION_FORMULAS",st="SET_DATA_VALIDATION_OPTIONS",ut="UPDATE_CONDITION_TYPE_VALUES_CACHE",lt="SET_DATA_VALIDATION_NEED_APPLY_ALL",ct="SET_DATA_VALIDATION_NO_APPLY_FIRST_ROW",ht="SET_DROPDOWN_STATUS",dt="SET_SHOULD_HIGHLIGHT_VALID_DATA",ft="SET_ALLOW_DECIMAL_CHECKED",pt="SET_SHOW_DATE_BTN_CHECKED",vt="SET_HELP_TEXT",gt="SET_WAY_ON_INVALID_DATA",_t="SET_VALIDATOR_STATUS",yt="SET_REFERENCE_RANGE_STRING",mt="UPDATE_CURR_RANGE_STRING",Et="SET_LIST_SOURCE_TYPE",bt="SET_SHOW_HELP_TEXT_STATUS",Tt="SET_LIST_OPTIONS",Ct="TRIGGER_CHECK_STATUS",St="INIT_DATA",wt="SET_TRIGGER_CHECK",Rt="SET_RANGE_INPUT_FOCUS",At="SET_DATA_VALIDATION_MODAL_CONFIG",Ot="SET_DATA_VALIDATION_MODAL_POSITION",Mt="SET_RANGE_SELECTOR_POSITION",kt="SET_TEXT_AREA_MAX_ROW",It="SET_TAB_ACTIVE_KEY",xt="SET_MODAL_READY",Nt="SET_DV_HELP_TEXT_IS_DEFAULT",Pt="SET_ACTIVE_CELL",Lt="UPDATE_FUNC_HELPER_HIDDEN_STEPS",Dt="UPDATE_FUNC_HELPER_AI_FOCUS",Ft="EXIT_FULL_SCREEN_MODE",Bt="SHOW_DATA_SPLIT_PREVIEW",Vt="SUSPEND_PLUGINS",Ht="SHOW_CUSTOM_SORT_MODAL",Ut="HIDE_CUSTOM_SORT_MODAL",Zt="SET_IS_ASYNC_COPY_SHEET_STATUS",Wt="SHOW_PIVOT_TABLE_SETTING_PANEL",jt="HIDE_PIVOT_TABLE_SETTING_PANEL",Gt="SHOW_DATA_PIVOT_TABLE_MODEL",zt="ADD_PIVOT_TABLE_CREATE_SHEET_NAME",Yt="SHOW_NUMBER_GROUP_SETTING_DIALOG",Xt="HIDE_NUMBER_GROUP_SETTING_DIALOG",Kt="SHOW_PIVOT_CALC_FIELD_MODEL",qt="HIDE_PIVOT_CALC_FIELD_MODEL",$t="TOGGLE_SHEET_TABS_SWITCHING_ENABLED",Jt="SET_SHOULD_UPDATE_SELECTION",Qt="SHOW_EXPORT_PREVIEW",en="HIDE_EXPORT_PREVIEW",tn="SHOW_AI_INLINE",nn="HIDE_AI_INLINE",rn="CHANGE_AI_INLINE_UPDATED_STATUS",on="SET_AI_TENANT_MODEL",an="SET_AI_PROMPT_TYPE",sn="OPEN_AI_RANGE_SELECTOR",un="SET_AI_RANGE_SELECT_STR",ln="CLOSE_AI_RANGE_SELECTOR",cn="SHOW_CELL_HISTORY",hn="HIDE_CELL_HISTORY",dn="SHOW_PRINT_PREVIEW",fn="HIDE_PRINT_PREVIEW",pn="SHOW_DATA_CONNECTOR_PANEL",vn="HIDE_DATA_CONNECTOR_PANEL",gn="SET_DATA_CONNECTOR_SHEET_IDS",_n="SET_DATA_CONNECTOR_MODAL_CONFIG",yn="SHOW_SPARKLINE_PANEL",mn="HIDE_SPARKLINE_PANEL",En="SHOW_SPARKLINE_CREATE_PANEL",bn="HIDE_SPARKLINE_CREATE_PANEL",Tn="SHOW_SPARKLINE_EDIT_COMBINATION_PANEL",Cn="HIDE_SPARKLINE_EDIT_COMBINATION_PANEL",Sn="SHOW_HEADER_NOTICE",wn="HIDE_HEADER_NOTICE",Rn="FRONT_SHEET_AI_DISCUSS",An="END_SHEET_AI_DISCUSS",On="COLLABORATOR_PERMISSION_CHANGED",Mn="PROTECT_MEMBERS_LIST_INFO"},vsh_83190:function(e,t,n){"use strict";n.r(t),n.d(t,{showFormulaList:function(){return l},hideFormulaList:function(){return c},toggleFormulaList:function(){return h},setSheetRendered:function(){return d},setSheetPermissions:function(){return f},updateSheetStatus:function(){return p},updateRangeCalcStatus:function(){return v},setActiveSheetId:function(){return g},showHyperlinkEditor:function(){return _},hideHyperlinkEditor:function(){return y},toggleNavBar:function(){return m},updateToolbarLoaded:function(){return E},updateConditionFormatRules:function(){return b},setConditionFormatPanelInjectConfig:function(){return T},toggleTemplateMode:function(){return C},formatPainterToggle:function(){return S},freezeSheetToggle:function(){return w},channelOnline:function(){return R},channelOffline:function(){return A},showFindbar:function(){return O},hideFindbar:function(){return M},showChartSelectorModal:function(){return k},changeChartPreviewColorType:function(){return I},hideChartSelectorModal:function(){return x},hideChartSettingPanel:function(){return N},showChartSettingPanel:function(){return P},showPivotTableSettingPanel:function(){return L},hidePivotTableSettingPanel:function(){return D},showPivotTableCalcFieldModal:function(){return F},hidePivotTableCalcFieldModal:function(){return B},setEmbedAllowComment:function(){return V},showFilterMenu:function(){return H},hideFilterMenu:function(){return U},toggleFilterPersonalChecked:function(){return Z},focusFindbar:function(){return W},showDropdownMenu:function(){return j},hideDropdownMenu:function(){return G},hideDropdownMenuModalToSelector:function(){return z},setDropdownMenuDragList:function(){return Y},setDropdownMenuOptionsBeforeModified:function(){return X},setDropdownMenuIsEnableOptionColor:function(){return K},setDropdownMenuContentType:function(){return q},setDropdownMenuActiveKey:function(){return $},setDropdownMenuConfig:function(){return J},toggleCommentPanel:function(){return Q},updateCommentData:function(){return ee},addSheetComment:function(){return te},pullSheetComment:function(){return ne},addSheetCommentReply:function(){return re},resolveSheetComment:function(){return ie},updateSheetReplyComment:function(){return oe},fakeUpdateSheetReplyComment:function(){return ae},deleteReplyComment:function(){return se},deleteCommentData:function(){return ue},toggleCommentMask:function(){return le},cleanComment:function(){return ce},addSheetCommentEmbed:function(){return he},pullSheetCommentEmbed:function(){return de},addSheetCommentReplyEmbed:function(){return fe},resolveSheetCommentEmbed:function(){return pe},updateSheetReplyCommentEmbed:function(){return ve},deleteReplyCommentEmbed:function(){return ge},updateSheetZoom:function(){return _e},updateSheetGridLineHidden:function(){return ye},updateSheetModule:function(){return me},showHistory:function(){return Ee},hideHistory:function(){return be},toggleHistory:function(){return Te},exportFile:function(){return Ce},setSheetClientVars:function(){return Se},resetSheetClientVars:function(){return we},toggleTitleFocusStatus:function(){return Re},embedSheetMount:function(){return Ae},embedSheetReset:function(){return Oe},embedSheetUnMount:function(){return Me},setEmbedSheetIsDocxEditable:function(){return ke},changeSheetPermission:function(){return Ie},delChart:function(){return xe},setChartSettingOptions:function(){return Ne},showSheetProtectionDialog:function(){return Pe},getProtectMemberListInfo:function(){return Le},closeSheetPermissionDialog:function(){return De},showSheetPermissionPanel:function(){return Fe},closeSheetPermissionPanel:function(){return Be},updateSheetPermissionPanelHighlightPermId:function(){return Ve},showConditionFormatPanel:function(){return He},hideConditionFormatPanel:function(){return Ue},showConditionFormatSelectorModal:function(){return Ze},hideConditionFormatSelectorModal:function(){return We},showDataCleanPanel:function(){return je},hideDataCleanPanel:function(){return Ge},exitFullScreenMode:function(){return ze},setActiveChart:function(){return Ye},clearActiveChart:function(){return Xe},initChart:function(){return Ke},setChart:function(){return qe},initFloatBlocks:function(){return $e},setFloatBlock:function(){return Je},delFloatBlock:function(){return Qe},setActiveFloatBlock:function(){return et},clearActiveFloatBlock:function(){return tt},toggleShowSheetRangeSelector:function(){return nt},setEmbedCommentData:function(){return rt},setCommentOldSdkInitStatus:function(){return it},setHighlightBarVisible:function(){return ot},getSheetFormulaCorrectResult:function(){return at},getSheetUserFormulaList:function(){return st},setTranslateMode:function(){return ut},setSpreadSheetHalt:function(){return lt},startBitableTransform:function(){return ct},launchRangeSelector:function(){return ht},closeRangeSelector:function(){return dt},finishBitableTransform:function(){return ft},toggleDataSplitPreview:function(){return pt},toggleHistoryComment:function(){return vt},toggleContextMenu:function(){return gt},suspendPlugins:function(){return _t},updateFuncHelperHiddenSteps:function(){return yt},updateFuncHelperAiFocus:function(){return mt},openAIRangeSelector:function(){return Et},setAIRangeSelectStr:function(){return bt},closeAIRangeSelector:function(){return Tt},updateAsyncCopySheetStatus:function(){return Ct},toggleSheetTabSwitchingEnabled:function(){return St},setShouldUpdateSelection:function(){return wt},showExportPreview:function(){return Rt},hideExportPreview:function(){return At},showAiInline:function(){return Ot},hideAiInline:function(){return Mt},changeAiInlineUpdatedStatus:function(){return kt},setAiPromptType:function(){return It},setAiTenantModel:function(){return xt},showCellHistory:function(){return Nt},hideCellHistory:function(){return Pt},showPrintPreview:function(){return Lt},hidePrintPreview:function(){return Dt},showApplyPermissionDialog:function(){return Ft},showDataConnectorPanel:function(){return Bt},hideDataConnectorPanel:function(){return Vt},setDataConnectorSheetIds:function(){return Ht},setDataConnectorModalConfig:function(){return Ut},showSparklinePanel:function(){return Zt},hideSparklinePanel:function(){return Wt},showSparklineCreatePanel:function(){return jt},hideSparklineCreatePanel:function(){return Gt},showSparklineEditCombinationPanel:function(){return zt},hideSparklineEditCombinationPanel:function(){return Yt},showHeaderNotice:function(){return Xt},hideHeaderNotice:function(){return Kt},changeFrontSheetAiDiscuss:function(){return qt},changeEndSheetAiDiscuss:function(){return $t},collaboratorPermissionChanged:function(){return Jt}});var r=n("vsh_74561"),i=n("vsh_69691"),o=n("vsh_42037"),a=n("vsh_12484"),s=n("vsh_5921"),u=n("vsh_57533"),l=function(){return{type:u.Xw2}},c=function(){return{type:u.jvJ}},h=function(){return{type:u.LFI}},d=function(e){return{type:a.CONTENT_VISIBLE,payload:e}},f=function(e){return{type:u.V7q,payload:e}},p=function(e){return{type:u.vFM,payload:e}},v=function(e){return{type:u.cOv,payload:e}},g=function(e){return{type:u.iu$,payload:e}},_=function(e,t,n,r,i,o){return{type:u.ns_,payload:{row:e,col:t,sheetId:n,from:r,rangeString:o,isEditing:i}}},y=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return{type:a.HIDE_HYPER_LINK_EDITOR,payload:{isShowRangeSelectorModal:e,rangeString:t}}},m=function(e,t){return{type:u.uIe,payload:{pickup:e,isClickByUser:t}}},E=function(e){return{type:u.Bcr,payload:{loaded:e}}},b=function(e){return{type:u.IJh,payload:e}},T=function(e){return{type:u._Bu,payload:e}},C=function(e){return{type:u.rG6,payload:{isTemplate:e}}},S=function(e){return{type:u.YBK,payload:e}},w=(0,o.createAction)(a.FREEZE_SPREAD_TOGGLE),R=(0,o.createAction)(u.Oh0),A=(0,o.createAction)(u.$xN),O=function(e){return{type:u.vLQ,payload:e}},M=function(){return{type:a.HIDE_FINDBAR}},k=function(e){return{type:u.nb0,payload:e}},I=function(e){return{type:u.HeF,payload:e}},x=function(e){return{type:u.auN,payload:e}},N=function(e){return{type:u.$7N,payload:e}},P=function(e){return{type:u.k6K,payload:e}},L=function(e){return{type:u.nMv,payload:e}},D=function(e){return{type:u.gG_,payload:e}},F=function(e){return{type:u.Xk_,payload:e}},B=function(){return{type:u.xKo}},V=function(e){return{type:a.SET_EMBED_SHEET_ALLOW_COMMENT,payload:e}},H=(0,o.createAction)(u.v1U),U=(0,o.createAction)(a.HIDE_FILTER_MENU),Z=(0,o.createAction)(u.ctD,(function(e){return{isPersonalSwitchChecked:e}})),W=function(e){return{type:u.afz,payload:e}},j=(0,o.createAction)(u.MSh,(function(e,t){return{targetSelections:e,sheetId:t}})),G=(0,o.createAction)(a.HIDE_DROPDOWN_MENU),z=(0,o.createAction)(u.ZVY,(function(e){return{listSourceRangeString:e,isShowRangeSelectorModal:!0,isRangeSelectFromDataValidationModal:!1,source:s.UP.Selector}})),Y=(0,o.createAction)(u.u_d,(function(e){return{dragList:e}})),X=(0,o.createAction)(u.NhJ,(function(e){return{optionsBeforeModified:e}})),K=(0,o.createAction)(u.tbK,(function(e){return{isEnableOptionColor:e}})),q=(0,o.createAction)(u.eT1,(function(e){return{menuContentType:e}})),$=(0,o.createAction)(u.g$6,(function(e){return{activeKey:e}})),J=(0,o.createAction)(u.a5u,(function(e){return e})),Q=function(e,t){return{type:u.NMh,payload:{toggle:e,target:t}}},ee=function(e){return{type:u.H4k,payload:e}},te=function(e,t,n,i){return(0,r.Z)({type:u.h9Q},a.REQUEST,{url:a.apiUrls.POST_ADD_COMMENT,method:a.apiUrls.METHOD.POST,data:{obj_type:3,token:e,content:t,quote:n,isWhole:i}})},ne=function(e,t){return(0,r.Z)({type:u.ID$},a.REQUEST,{url:a.apiUrls.POST_GET_COMMENT_LIST,method:a.apiUrls.METHOD.POST,data:{obj_type:3,token:e,comment_id:t}})},re=function(e,t,n){return(0,r.Z)({type:u.wA6},a.REQUEST,{url:a.apiUrls.POST_REPLY_COMMENT,method:a.apiUrls.METHOD.POST,data:{obj_type:3,token:e,comment_id:t,content:n}})},ie=function(e,t){return(0,r.Z)({type:u._uJ},a.REQUEST,{url:a.apiUrls.POST_UPDATE_COMMENT,method:a.apiUrls.METHOD.POST,data:{obj_type:3,finish:1,token:e,comment_id:t}})},oe=function(e){var t=e.token,n=e.commentId,i=e.content,o=e.replyId;return(0,r.Z)({type:u.i_1,payload:{commentId:n,replyId:o}},a.REQUEST,{url:a.apiUrls.POST_UPDATE_REPLY_COMMENT,method:a.apiUrls.METHOD.POST,data:{obj_type:3,token:t,content:i,comment_id:n,reply_id:o}})},ae=function(e){var t=e.token,n=e.commentId,r=e.content,i=e.replyId;return{type:u.Uj0,payload:{token:t,content:r,commentId:n,replyId:i}}},se=function(e,t,n){return(0,r.Z)({type:u.ZsF,payload:{commentId:e,replyId:n}},a.REQUEST,{url:a.apiUrls.POST_DELETE_REPLY_COMMENT,method:a.apiUrls.METHOD.POST,data:{token:t,reply_id:n,obj_type:3}})},ue=function(e){return{type:u.i5y,payload:e}},le=function(e){return{type:u.O0T,payload:e}},ce=function(){return{type:u.DzQ}},he=function(e,t,n,i){return(0,r.Z)({type:u.h9Q},a.REQUEST,{url:a.apiUrls.POST_ADD_COMMENT,method:a.apiUrls.METHOD.POST,data:{token:e,content:t,quote:n}})},de=function(e,t){return(0,r.Z)({type:u.ID$},a.REQUEST,{url:a.apiUrls.POST_GET_COMMENT_LIST,method:a.apiUrls.METHOD.POST,data:{token:e,comment_id:t}})},fe=function(e,t,n){return(0,r.Z)({type:u.wA6},a.REQUEST,{url:a.apiUrls.POST_REPLY_COMMENT,method:a.apiUrls.METHOD.POST,data:{token:e,comment_id:t,content:n}})},pe=function(e,t){return(0,r.Z)({type:u._uJ},a.REQUEST,{url:a.apiUrls.POST_UPDATE_COMMENT,method:a.apiUrls.METHOD.POST,data:{finish:1,token:e,comment_id:t}})},ve=function(e){var t=e.token,n=e.commentId,i=e.content,o=e.replyId;return(0,r.Z)({type:u.i_1,payload:{commentId:n,replyId:o}},a.REQUEST,{url:a.apiUrls.POST_UPDATE_REPLY_COMMENT,method:a.apiUrls.METHOD.POST,data:{token:t,content:i,comment_id:n,reply_id:o}})},ge=function(e,t,n){return(0,r.Z)({type:u.ZsF,payload:{commentId:e,replyId:n}},a.REQUEST,{url:a.apiUrls.POST_DELETE_REPLY_COMMENT,method:a.apiUrls.METHOD.POST,data:{token:t,reply_id:n}})},_e=function(e){return{type:u.TxO,payload:e}},ye=function(e){return{type:u.B2d,payload:e}},me=function(e){return{type:u.V4y,payload:e}},Ee=function(e){return{type:u._ZG,payload:e}},be=function(){return{type:u.u1e}},Te=function(){return{type:a.TOGGLE_HISTORY}},Ce=function(e){var t=e.isExport,n=e.fileType;return{type:a.EXPORT_FILE,payload:{isExport:t,fileType:n}}},Se=function(e){return{type:u.VSo,payload:e}},we=function(){return{type:u.MCh}},Re=function(e){return{type:a.TOGGLE_TITLE_FOCUS_STATUS,payload:{isFocus:e}}},Ae=function(e,t){return{type:u.JEM,payload:{sheetId:e,index:t}}},Oe=function(e){return{type:u.DFf,payload:e}},Me=function(e){return{type:u.ctH,payload:{sheetId:e}}},ke=function(e){return{type:u.Xx5,payload:{isDocxEditable:e}}},Ie=function(e){return{type:u.aEw,payload:e}},xe=function(e,t){return{type:u.ba_,payload:{sheetId:e,chartId:t}}},Ne=function(e){return{type:u.TUd,payload:e}};function Pe(e,t,n,r,i,o,a,s){return function(l,c){l({type:u.keb,payload:{source:e,protectionType:t,range:n,permId:i,sheetId:r,permission:o,note:a,managerIds:s}})}}var Le=function(e){return{type:u.pQV,payload:{protectMembers:e}}},De=function(){return{type:u.p10}},Fe=function(e){return{type:u.VE1,payload:{highlightPermId:e}}},Be=function(){return{type:u.e8e}},Ve=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{type:u.zqo,payload:{highlightPermId:e}}},He=(0,o.createAction)(u.Dru),Ue=(0,o.createAction)(u.ROS),Ze=(0,o.createAction)(u.jH1),We=(0,o.createAction)(u.s0S),je=(0,o.createAction)(u.kyn),Ge=(0,o.createAction)(u.iWz),ze=(0,o.createAction)(u.prn),Ye=function(e,t){return{type:u.ZcN,payload:{sheetId:e,chartId:t}}},Xe=function(){return{type:u.MHc}},Ke=function(e){return{type:u.HB4,payload:e}},qe=function(e,t){return{type:u.bR0,payload:{chartBlock:e,forceUpdate:t}}},$e=function(e,t){return{type:u.Qdz,payload:{spreadToken:e,floatBlocks:t}}},Je=function(e,t){return{type:u.ymz,payload:{spreadToken:e,floatBlock:t}}},Qe=function(e,t,n){return{type:u.$4G,payload:{spreadToken:e,sheetId:t,blockToken:n}}},et=function(e,t,n,r){return{type:u.DJW,payload:{spreadToken:e,sheetId:t,blockToken:n,active:r}}},tt=function(e){return{type:u.$HW,payload:{spreadToken:e}}},nt=function(e){return{type:e?u.r0V:u.FfF}},rt=function(e){var t=e.comments,n={comments:(0,i.snakelize)(t)};return{type:u.J3x,payload:n}},it=function(e){return{type:u.UZ6,payload:e}},ot=function(e){return{type:u.blX,payload:{visible:e}}},at=function(e){return(0,r.Z)({type:u.ouc,payload:{}},a.REQUEST,{url:a.apiUrls.GET_FORMULA_CORRECT_RESULT,method:a.apiUrls.METHOD.GET,params:{key:e},headers:(0,r.Z)({},a.X_COMMAND,a.API_V2_SHEET_CORRECT_FORMULAS)})},st=function(){return(0,r.Z)({type:u.ApP,payload:{}},a.REQUEST,{url:a.apiUrls.GET_COMPLEMENT_FORMULAS,method:a.apiUrls.METHOD.GET,headers:(0,r.Z)({},a.X_COMMAND,a.API_V2_SHEET_COMPLEMENT_FORMULAS)})},ut=function(e){return{type:u.SRA,payload:{isActive:e}}},lt=function(){return{type:u.$A8}},ct=function(e){return{type:u.GIr,payload:{isProcessing:!0,viewType:e,isShowRangeSelector:!1}}},ht=function(){return{type:u.GIr,payload:{isShowRangeSelector:!0}}},dt=function(){return{type:u.GIr,payload:{isShowRangeSelector:!1}}},ft=function(){return{type:u.GIr,payload:{isProcessing:!1,viewType:0,isShowRangeSelector:!1}}},pt=function(e,t,n){return{type:u.$nT,payload:{showDataSplitPreview:e,range:t,ref:n}}},vt=function(e){return{type:a.TOGGLE_HISTORY_COMMENT,payload:{showHistoryComment:e}}},gt=function(e){return{type:u.XJC,payload:{visible:e}}},_t=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return{type:u.oTl,payload:{suspend:e}}},yt=function(e,t){return{type:u.L90,payload:{tipSteps:e,toHide:t}}},mt=function(e){return{type:u.CPq,payload:{isAiAutoFocus:e}}},Et=function(e,t,n){return{type:u.XV9,payload:{rangeStr:e,originRange:t,sourceSheetName:n}}},bt=function(e){return{type:u.rTl,payload:{rangeStr:e}}},Tt=function(){return{type:u.n8_,payload:{}}},Ct=function(e){return{type:u.Cp3,payload:e}},St=function(e){return{type:u.GWW,payload:e}},wt=function(e){return{type:u.bOi,payload:e}},Rt=function(){return{type:u.BLN}},At=function(){return{type:u.GQ}},Ot=function(){return{type:u.tz7}},Mt=function(){return{type:u.Cg0}},kt=function(e){return{type:u.IsC,payload:e}},It=function(e){return{type:u.c2S,payload:e}},xt=function(e){return{type:u.Qzi,payload:e}},Nt=function(e){return{type:u.dAE,scrollToContent:e}},Pt=function(){return{type:u.d_t}},Lt=function(e){return{type:u.$nw,payload:{triggerSource:e}}},Dt=function(){return{type:u.zUc}},Ft=function(){return{payload:{modalProps:{},modalType:"APPLY_EDIT_PERMISSION"},type:"@@ui/OPEN_MODAL"}},Bt=function(){return{type:u.Bkd}},Vt=function(){return{type:u.UjP}},Ht=function(e){return{type:u.rLI,payload:{sheetIds:e}}},Ut=function(e){return{type:u.nmk,payload:{modalConfig:e}}},Zt=function(){return{type:u.rNi}},Wt=function(){return{type:u.bp9}},jt=function(e){return{type:u.y65,payload:e}},Gt=function(){return{type:u.Fw5}},zt=function(e){return{type:u.rfn,payload:{dataCombination:e}}},Yt=function(){return{type:u.acr}},Xt=function(e){return{type:u.Cbh,payload:e}},Kt=function(){return{type:u.O_r}},qt=function(){return{type:u.U89}},$t=function(){return{type:u.ifA}},Jt=function(e){return{type:u.sHL,payload:e}}},vsh_72929:function(e,t,n){"use strict";n.d(t,{_:function(){return o}});var r=n("vsh_37394"),i="sheet";function o(){return{id:i,initialActions:[{type:"MARK_MODULE_ADDED",payload:{MODULE_ID:i}}],reducerMap:{sheet:r.ZP}}}},vsh_5921:function(e,t,n){"use strict";n.d(t,{UP:function(){return i},qN:function(){return c},gL:function(){return h},Bm:function(){return d},E9:function(){return f},af:function(){return p},h_:function(){return v},X3:function(){return g},n9:function(){return _},$i:function(){return y},Id:function(){return m},sB:function(){return E},YO:function(){return b},Eo:function(){return T},mi:function(){return C},ck:function(){return S},UC:function(){return w},sL:function(){return R},Ec:function(){return A},bY:function(){return O},e0:function(){return M},N$:function(){return k},G6:function(){return I},IE:function(){return x},Zi:function(){return N},vB:function(){return P},J8:function(){return L},nF:function(){return D},r7:function(){return F},vk:function(){return B},kW:function(){return V},cy:function(){return H},LJ:function(){return U},y1:function(){return Z},z5:function(){return W},pF:function(){return j},Wc:function(){return G}});var r,i,o=n("vsh_74561"),a=n("vsh_42037"),s=n("vsh_75977"),u=n("vsh_57533");!function(e){e.Entry="entry",e.Selector="selector"}(i||(i={}));var l={targetSelections:[],sheetId:"",source:null,listSourceRangeString:"",defaultListSourceRangeString:"",currListRangeString:"",isListSourceFromRangeString:!1,isShowRangeSelectorModal:!1,isRangeSelectFromDataValidationModal:!0,isRangeInputFocus:!1,isShowDataValidationModal:!1,isShowColorSettingModal:!1,type:s.Qk.Single,operator:void 0,conditionTypeValuesCache:{},needApplyToAll:!0,applyFirstRow:!1,showDropdown:!0,shouldHighlightValidData:!0,allowDecimalChecked:!0,showDateBtnChecked:!0,helpText:"",handledWayOnInvalidData:3,isValid:!0,invalidTips:"",isShowHelpText:!1,listOptionsWithColorMap:{},triggerCheck:!1,position:{x:0,y:0},rangeSelectorPosition:{x:0,y:0},textAreaMaxRow:1,tabActiveKey:"setting",modalReady:!1,dvHelpTextIsDefault:!1,activeCell:{row:-1,col:-1}},c=function(e){return{type:u.B$M,payload:{activeCell:e}}},h=function(e){return{type:u._xz,payload:{dvHelpTextIsDefault:e}}},d=function(e){return{type:u.Lf5,payload:{modalReady:e}}},f=function(e){return{type:u.H$_,payload:{tabActiveKey:e}}},p=function(e,t){return{type:u.HwT,payload:{targetSelections:e,sheetId:t,isShowDataValidationModal:!0,source:"entry"}}},v=function(e){return{type:u.HwT,payload:{source:"selector",isShowDataValidationModal:!0,isShowRangeSelectorModal:!1,listSourceRangeString:e,defaultListSourceRangeString:"",triggerCheck:!1}}},g=function(e){return{type:u.fnA,payload:{isRangeInputFocus:e}}},_=function(e){return{type:u.oTc,payload:{source:"selector",isShowRangeSelectorModal:!1,listSourceRangeString:e,defaultListSourceRangeString:""}}},y=function(){return{type:u.dpx,payload:Object.assign({},l)}},m=function(e){return{type:u.dpx,payload:{isShowRangeSelectorModal:!0,isRangeSelectFromDataValidationModal:!0,isShowDataValidationModal:!1,listSourceRangeString:e}}},E=function(){return{type:u.dpx,payload:{isShowDataValidationModal:!0,isShowColorSettingModal:!0}}},b=function(){return{type:u.HwT,payload:{isShowDataValidationModal:!0,isShowColorSettingModal:!1,triggerCheck:!1}}},T=function(e){return{type:u.G3m,payload:{type:e,triggerCheck:!1,invalidTips:"",isValid:!0}}},C=function(e){return{type:u.ZYJ,payload:{operator:e,triggerCheck:!1}}},S=function(e,t,n){return{type:u.FHw,payload:{type:e,value:t,cacheIdx:n}}},w=function(e){return{type:u.XlT,payload:{needApplyToAll:e}}},R=function(e){return{type:u.znk,payload:{applyFirstRow:e}}},A=function(e){return{type:u.mvv,payload:{showDropdown:e}}},O=function(e){return{type:u.FQF,payload:{shouldHighlightValidData:e}}},M=function(e){return{type:u.XWj,payload:{allowDecimalChecked:e}}},k=function(e){return{type:u.ZYf,payload:{showDateBtnChecked:e}}},I=function(e){return{type:u.$J9,payload:{helpText:e}}},x=function(e){return{type:u.Cc_,payload:{handledWayOnInvalidData:e}}},N=function(e){return{type:u.hyG,payload:Object.assign({},e)}},P=function(e){return{type:u.FyK,payload:{isListSourceFromRangeString:e,triggerCheck:!1}}},L=function(e){return{type:u.Cm9,payload:{isShowHelpText:e}}},D=function(e,t){return{type:u.XDO,payload:{listSource:e,optionsListWithColor:t}}},F=function(e){return{type:u.vcF,payload:{triggerCheck:e}}},B=function(e){return{type:u.BqQ,payload:Object.assign({},e,{isValid:!0,invalidTips:""})}},V=function(e){return{type:u.BW_,payload:{triggerCheck:e}}},H=function(e){return{type:u.I5V,payload:{position:e}}},U=function(e){return{type:u.n5M,payload:{rangeSelectorPosition:e}}},Z=function(e){return{type:u.q9u,payload:{currListRangeString:e}}},W=function(e){return{type:u.R_z,payload:{textAreaMaxRow:e}}},j=function(e){return{type:u.SDW,payload:e}},G=(0,a.handleActions)((r={},(0,o.Z)(r,u.HwT,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.MSh,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.oTc,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.dpx,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.ZVY,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.KGd,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.JMH,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.G3m,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.G3m,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.ZYJ,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.ZlJ,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.ZN6,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.fnA,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.SDW,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.FHw,(function(e,t){var n=t.payload,r=n.type,i=n.value,a=n.cacheIdx,u=r===s.Qk.Single||r===s.Qk.Multiple?"list":r,l=e.conditionTypeValuesCache;if(!l){var c={},h=new Array(2).fill("");return h[a]=i,c[u]=h,Object.assign({},e,{conditionTypeValuesCache:c})}var d=(l[u]||new Array(2).fill("")).slice(0);return d[a]=i,Object.assign({},e,{conditionTypeValuesCache:Object.assign({},l,(0,o.Z)({},u,d))})})),(0,o.Z)(r,u.XlT,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.znk,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.mvv,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.FQF,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.XWj,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.ZYf,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.$J9,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.Cc_,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.hyG,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.P51,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.FyK,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.Cm9,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.XDO,(function(e,t){var n=t.payload,r=n.listSource,i=n.optionsListWithColor;return Object.assign({},e,{listOptionsWithColorMap:Object.assign({},e.listOptionsWithColorMap,(0,o.Z)({},r,i.slice()))})})),(0,o.Z)(r,u.vcF,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.BqQ,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.BW_,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.I5V,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.n5M,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.q9u,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.R_z,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.H$_,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.Lf5,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u._xz,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,o.Z)(r,u.prn,(function(e,t){t.payload;return Object.assign({},e,{},l)})),(0,o.Z)(r,u.B$M,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),r),Object.assign({},l))},vsh_97435:function(e,t,n){"use strict";n.d(t,{LV:function(){return g},mc:function(){return _},qd:function(){return y},wq:function(){return m},jm:function(){return E},r7:function(){return b},$j:function(){return T},kO:function(){return C},yE:function(){return S},sL:function(){return w}});var r,i=n("vsh_74561"),o=n("vsh_42037"),a={visible:!1,formatterCode:"",activeTab:"General",positionMap:{},precision:2,currencyCode:"CNY",currencySymbol:"¥",hasTenPercentile:!1},s="FORMATTER_MODAL/FORMATTER_VISIBLE",u="FORMATTER_MODAL/SET_POSITION",l="FORMATTER_MODAL/SET_FORMATTER",c="FORMATTER_MODAL/SET_ACTIVE_TAB",h="FORMATTER_MODAL/SET_PRECISION",d="FORMATTER_MODAL/SET_CURRENCY_SYMBOL",f="FORMATTER_MODAL/SET_CURRENCY_CODE",p="FORMATTER_MODAL/SET_TEN_PERCENTILE",v="FORMATTER_MODAL/RESET",g=(0,o.handleActions)((r={},(0,i.Z)(r,s,(function(e,t){var n=t.payload;return Object.assign({},e,{visible:n})})),(0,i.Z)(r,l,(function(e,t){var n=t.payload.formatterCode;return Object.assign({},e,{formatterCode:n})})),(0,i.Z)(r,c,(function(e,t){var n=t.payload;return Object.assign({},e,{activeTab:n})})),(0,i.Z)(r,u,(function(e,t){var n=t.payload,r=n.activeTab,o=n.position;return Object.assign({},e,{positionMap:Object.assign({},e.positionMap,(0,i.Z)({},r,o))})})),(0,i.Z)(r,h,(function(e,t){var n=t.payload;return Object.assign({},e,{precision:n})})),(0,i.Z)(r,d,(function(e,t){var n=t.payload;return Object.assign({},e,{currencySymbol:n})})),(0,i.Z)(r,f,(function(e,t){var n=t.payload;return Object.assign({},e,{currencyCode:n})})),(0,i.Z)(r,p,(function(e,t){var n=t.payload;return Object.assign({},e,{hasTenPercentile:n})})),(0,i.Z)(r,v,(function(){return a})),r),a),_=function(){return{type:v}},y=function(e){return{type:s,payload:e}},m=function(e,t){return{type:u,payload:{activeTab:e,position:t}}},E=function(e){return{type:l,payload:{formatterCode:e}}},b=function(e){return{type:c,payload:e}},T=function(e){return{type:h,payload:Math.max(0,Math.min(e,30))}},C=function(e){return{type:d,payload:e}},S=function(e){return{type:f,payload:e}},w=function(e){return{type:p,payload:e}}},vsh_37394:function(e,t,n){"use strict";n.d(t,{Gv:function(){return $},FD:function(){return Q},ZP:function(){return et}});var r,i,o,a=n("vsh_98652"),s=n("vsh_74561"),u=n("vsh_22023"),l=n("vsh_4927"),c=n("vsh_42037"),h=n("vsh_12484"),d=n("vsh_57533"),f=(0,c.handleActions)((r={},(0,s.Z)(r,d.nAR,(function(e,t){var n=t.payload;return Object.assign({},e,{},n,{visible:!0})})),(0,s.Z)(r,d.xAd,(function(e){return Object.assign({},e,{sortSource:null,visible:!1})})),r),{visible:!1,sortSource:null}),p=n("vsh_5921"),v=n("vsh_97435"),g=(0,c.handleActions)((i={},(0,s.Z)(i,d.UWP,(function(e,t){var n=t.payload;return Object.assign({},e,{},n,{visible:!0})})),(0,s.Z)(i,d.QVu,(function(e){return Object.assign({},e,{visible:!1,sheetId:"",tableName:"",viewFieldName:"",groupRule:null})})),i),{visible:!1,sheetId:"",tableName:"",viewFieldName:"",groupRule:null}),_=n("vsh_22488").browser.mobile;function y(){return{frozen:!0,emptySheet:!1,online:!0,timeMachine:!1,halt:!1,readonly:!1,isMobile:_}}var m,E,b,T,C,S,w,R,A,O,M,k,I,x,N,P,L,D,F,B,V,H,U,Z,W,j,G,z,Y,X,K=(0,c.handleActions)((o={},(0,s.Z)(o,d.$A8,(function(e){return Object.assign({},e,{halt:!0})})),(0,s.Z)(o,h.CONTENT_VISIBLE,(function(e,t){var n=t.payload,r=void 0===n?!e.visible:n;return r===e.visible?e:Object.assign({},e,{visible:r})})),(0,s.Z)(o,h.FREEZE_SPREAD_TOGGLE,(function(e,t){var n=t.payload,r=void 0===n?!e.frozen:n;return r===e.frozen?e:Object.assign({},e,{frozen:r})})),(0,s.Z)(o,d.vFM,(function(e,t){var n=t.payload;return n.emptySheet===e.emptySheet?e:Object.assign({},e,{emptySheet:n.emptySheet})})),(0,s.Z)(o,d.Oh0,(function(e){return e.online?e:Object.assign({},e,{online:!0})})),(0,s.Z)(o,d.$xN,(function(e){return e.online?Object.assign({},e,{online:!1}):e})),(0,s.Z)(o,d.rG6,(function(e,t){var n=t.payload;return Object.assign({},e,{isTemplate:n.isTemplate})})),(0,s.Z)(o,d._yc,(function(e,t){var n=t.payload;return Object.assign({},e,{readonly:n.readonly})})),(0,s.Z)(o,d.$zA,(function(){return y()})),o),y()),q=n("vsh_90795");!function(e){e.CHART_SETUP="CHART_SETUP",e.CHART_CUSTOMIZE="CHART_CUSTOMIZE"}(Y||(Y={})),X="true"==={NODE_ENV:"production",CDN_URL:navigator.cdn_host+"/eesz/bear/sheet/module",FASTER_TEST:void 0}.bear_web_custom_story?function(){return!1}:n("vsh_98000").fQ;var $,J,Q,ee=(0,c.handleActions)((m={},(0,s.Z)(m,d.Xw2,(function(e){return Object.assign({},e,{visible:!0})})),(0,s.Z)(m,d.jvJ,(function(e){return Object.assign({},e,{visible:!1})})),(0,s.Z)(m,d.LFI,(function(e){return Object.assign({},e,{visible:!e.visible})})),(0,s.Z)(m,d.q70,(function(e,t){var n=t.payload;return Object.assign({},e,{correct_result:Object.assign({},n)})})),(0,s.Z)(m,d.sVc,(function(e,t){t.payload;return Object.assign({},e,{correct_result:null})})),(0,s.Z)(m,d.Tpb,(function(e,t){var n=t.payload;return Object.assign({},e,{formulaList:Object.assign({},n)})})),(0,s.Z)(m,d.W2w,(function(e,t){t.payload;return Object.assign({},e,{formulaList:null})})),m),{visible:!1}),te=K,ne=(0,c.handleActions)((0,s.Z)({},d.vFM,(function(e,t){var n=t.payload.coord;return n?n.row===e.row&&n.col===e.col?e:Object.assign({},e,{},n):e})),{row:0,col:0}),re=(0,c.handleActions)((E={},(0,s.Z)(E,d.vFM,(function(e,t){var n=t.payload,r=n.cellStatus,i=void 0===r?{}:r,o=n.rangeStatus,a=void 0===o?{}:o,s=n.isFiltered,l=void 0!==s&&s;return l===e.isFiltered&&(0,u.default)(i,e.cellStatus)&&(0,u.default)(a,e.rangeStatus)?e:Object.assign({},e,{cellStatus:i||{},rangeStatus:a||{},isFiltered:l})})),(0,s.Z)(E,d.cOv,(function(e,t){var n=t.payload,r=void 0===n?{}:n;return(0,u.default)(r,e.rangeCalcStatus)?e:Object.assign({},e,{rangeCalcStatus:r})})),(0,s.Z)(E,d.ns_,(function(e,t){var n=t.payload;return Object.assign({},e,{hyperlinkEditor:Object.assign({},e.hyperlinkEditor,{},n,{isShowRangeSelectorModal:!1})})})),(0,s.Z)(E,h.HIDE_HYPER_LINK_EDITOR,(function(e,t){var n=t.payload;if(!1===e.hyperlinkEditor)return e;if(n&&!0===n.isShowRangeSelectorModal){var r=Object.assign({},e.hyperlinkEditor,{},n);return Object.assign({},e,{hyperlinkEditor:r})}return Object.assign({},e,{hyperlinkEditor:!1})})),(0,s.Z)(E,d.uIe,(function(e,t){var n=t.payload;return Object.assign({},e,{toggleNavBar:Object.assign({},n)})})),(0,s.Z)(E,"SHIFT_SHEET_TOOLBAR_ROW",(function(e,t){var n=t.payload;return Object.assign({},e,{isSingleRow:n})})),(0,s.Z)(E,d.IJh,(function(e,t){var n=t.payload;return(0,u.default)(e.rangeConditionFormatRules,n)?e:Object.assign({},e,{rangeConditionFormatRules:n})})),(0,s.Z)(E,d.Bcr,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),E),{cellStatus:{},rangeStatus:{},rangeCalcStatus:{},isSingleRow:X(),rangeConditionFormatRules:[],loaded:!1}),ie=(0,c.handleActions)((b={},(0,s.Z)(b,d.t52,(function(e,t){var n=t.payload;return Object.assign({},e,{visible:n})})),(0,s.Z)(b,d.Jxf,(function(e,t){var n=t.payload;return Object.assign({},e,{onComment:n})})),(0,s.Z)(b,h.SET_EMBED_SHEET_ALLOW_COMMENT,(function(e,t){var n=t.payload;return Object.assign({},e,{commentable:n})})),(0,s.Z)(b,d.iu$,(function(e,t){var n=t.payload;return Object.assign({},e,{activeSheetId:n})})),b),{visible:!1,onComment:null,commentable:!1,activeSheetId:""}),oe=(0,c.handleActions)((0,s.Z)({},d.YBK,(function(e,t){var n=t.payload,r=void 0===n?null:n,i=null==r?!e.painterFormatting:r;return Object.assign({},e,{painterFormatting:i})})),{painterFormatting:!1}),ae=(0,c.handleActions)((T={},(0,s.Z)(T,d.vLQ,(function(e,t){var n=t.payload;return e.visible&&!n?Object.assign({},e,{findFocus:!0,replaceVisible:n}):Object.assign({},e,{visible:!0,replaceVisible:n,findFocus:!0})})),(0,s.Z)(T,h.HIDE_FINDBAR,(function(e){return!1===e.visible&&!1===e.replaceVisible&&!1===e.findFocus?e:Object.assign({},e,{visible:!1,replaceVisible:!1,findFocus:!1})})),(0,s.Z)(T,d.afz,(function(e,t){var n=t.payload;return Object.assign({},e,{findFocus:n})})),T),{visible:!1,replaceVisible:!1,findFocus:!1}),se=(0,c.handleActions)((C={},(0,s.Z)(C,d.NMh,(function(e,t){var n=t.payload,r=e.toggle,i=e.target,o=n.toggle,a=void 0===o?!r:o,s=n.target,u=void 0===s?i:s;return Object.assign({},e,{toggle:a,target:u||null,reopenCommentId:null,mask:!1})})),(0,s.Z)(C,d.wTB,(function(e,t){var n=t.payload;return Object.assign({},e,{data:Object.assign({},e.data,{},n),reopenCommentId:null})})),(0,s.Z)(C,d.sdT,(function(e,t){t.payload;return e})),(0,s.Z)(C,d.H4k,(function(e,t){var n=t.payload;return Object.assign({},e,{data:Object.assign({},e.data,{},n),reopenCommentId:null})})),(0,s.Z)(C,d.Uj0,(function(e,t){var n=t.payload;if(n){var r=n.commentId,i=n.replyId,o=n.content,u=e.data[r];if(!u||!u.comment_list)return e;var l=u.comment_list.findIndex((function(e){return e.reply_id===i}));if(l<0)return e;var c=(0,a.Z)(u.comment_list);return c[l]=Object.assign({},c[l],{content:o}),u.comment_list=c,Object.assign({},e,{data:Object.assign({},e.data,(0,s.Z)({},r,u))})}return e})),(0,s.Z)(C,d.O_q,(function(e,t){var n=t.payload;if(n){var r=n.commentId,i=n.replyId,o=e.data[r];if(!o||!o.comment_list)return e;var u=o.comment_list.findIndex((function(e){return e.reply_id===i}));if(u<0)return e;var l=(0,a.Z)(o.comment_list);return l[u]=Object.assign({},l[u],{},n.reply),o.comment_list=l,Object.assign({},e,{data:Object.assign({},e.data,(0,s.Z)({},r,o))})}return e})),(0,s.Z)(C,d.i5y,(function(e,t){var n=t.payload.commentId,r=Object.assign({},e);return r[n]&&delete r[n],r})),(0,s.Z)(C,h.REOPEN_SHEET_COMMENT,(function(e,t){var n=t.payload;return Object.assign({},e,{data:Object.assign({},e.data,(0,s.Z)({},n.comment_id,Object.assign({},n,{finish:0}))),reopenCommentId:n.comment_id})})),(0,s.Z)(C,d.O0T,(function(e,t){var n=t.payload;return e.mask!==n?Object.assign({},e,{target:e.mask&&n?null:e.target,mask:n}):e})),(0,s.Z)(C,d.DzQ,(function(e,t){return{toggle:!1,target:null,data:{},mask:!0}})),(0,s.Z)(C,d.J3x,(function(e,t){var n=t.payload.comments;if(!n)return e;var r={};return n.forEach((function(e){r[e.comment_id]=e})),Object.assign({},e,{data:Object.assign({},r)})})),(0,s.Z)(C,d.UZ6,(function(e,t){var n=t.payload;return Object.assign({},e,{isCommentDataInit:n})})),C),{toggle:!1,target:null,data:{},reopenCommentId:null,mask:!0,isCommentDataInit:!1}),ue=(0,c.handleActions)((S={},(0,s.Z)(S,d._ZG,(function(e,t){var n=t.payload;return Object.assign({},e,{visible:!0,localVisible:!!n})})),(0,s.Z)(S,d.u1e,(function(e){return Object.assign({},e,{visible:!1,localVisible:!1})})),(0,s.Z)(S,h.TOGGLE_HISTORY,(function(e){return Object.assign({},e,{visible:!e.visible,localVisible:!1})})),S),{visible:!1,localVisible:!1});!function(e){e[e.Default=0]="Default",e[e.MoreOptions=1]="MoreOptions"}($||($={})),function(e){e[e.Custom=0]="Custom",e[e.Refer=1]="Refer"}(J||(J={})),function(e){e.Setting="setting",e.ERROR_REPORT="error_report"}(Q||(Q={}));var le={visible:!1,dragList:[],optionsBeforeModified:{},isEnableOptionColor:!1,colors:[],menuContentType:$.Default,activeKey:Q.Setting,position:{x:0,y:0}},ce=(0,c.handleActions)((w={},(0,s.Z)(w,d.MSh,(function(e,t){var n=t.payload;return e.visible&&!n?e:Object.assign({},e,{visible:!0})})),(0,s.Z)(w,d.oTc,(function(e){return Object.assign({},e,{visible:!0})})),(0,s.Z)(w,h.HIDE_DROPDOWN_MENU,(function(e){return!1===e.visible?e:Object.assign({},le)})),(0,s.Z)(w,d.ZVY,(function(e){return Object.assign({},e,{visible:!1})})),(0,s.Z)(w,d.u_d,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,s.Z)(w,d.NhJ,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,s.Z)(w,d.tbK,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,s.Z)(w,d.tPq,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,s.Z)(w,d.eT1,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,s.Z)(w,d.g$6,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,s.Z)(w,d.a5u,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),w),le),he=(0,c.handleActions)((0,s.Z)({},h.EXPORT_FILE,(function(e,t){var n=t.payload,r=void 0===n?{}:n;return Object.assign({},e,{},r)})),{isExport:!1}),de=(0,c.handleActions)((R={},(0,s.Z)(R,d.v1U,(function(e,t){var n=t.payload,r=void 0===n?{}:n;return Object.assign({},e,{},r)})),(0,s.Z)(R,h.HIDE_FILTER_MENU,(function(e){return Object.assign({},e,{visible:!1})})),(0,s.Z)(R,d.ctD,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),R),{visible:!1,isPersonalSwitchChecked:null}),fe=(0,c.handleActions)((A={},(0,s.Z)(A,d.TxO,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,s.Z)(A,d.N4b,(function(){return{}})),A),{}),pe=(0,c.handleActions)((0,s.Z)({},d.V4y,(function(e,t){var n=t.payload;if("del"===n){var r=(0,a.Z)(e);return r.length&&r.pop(),r}return[].concat((0,a.Z)(e),[n])})),[]),ve=(0,c.handleActions)((0,s.Z)({},d.B2d,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),{}),ge=(0,c.handleActions)((O={},(0,s.Z)(O,d.MCh,(function(e,t){return null})),(0,s.Z)(O,d.VSo,(function(e,t){return t.payload?t.payload:e})),O),null),_e=(0,c.handleActions)((0,s.Z)({},h.TOGGLE_TITLE_FOCUS_STATUS,(function(e,t){var n=t.payload;return Object.assign({},n)})),{isFocus:!1}),ye=(0,c.handleActions)((0,s.Z)({},h.TOGGLE_HISTORY_COMMENT,(function(e,t){var n=t.payload;return Object.assign({},n)})),{showHistoryComment:!1}),me=(0,c.handleActions)((M={},(0,s.Z)(M,d.JEM,(function(e,t){var n=t.payload,r=(0,a.Z)(e.mountedList);return r.splice(n.index,0,n.sheetId),Object.assign({},e,{mountedList:r})})),(0,s.Z)(M,d.ctH,(function(e,t){var n=t.payload;return Object.assign({},e,{mountedList:e.mountedList.filter((function(e){return e!==n.sheetId}))})})),(0,s.Z)(M,d.DFf,(function(e,t){var n=t.payload;return Object.assign({},e,{mountedList:n})})),(0,s.Z)(M,d.Xx5,(function(e,t){var n=t.payload;return Object.assign({},e,{isDocxEditable:n.isDocxEditable})})),M),{mountedList:[],isDocxEditable:!1}),Ee=(0,c.handleActions)((0,s.Z)({},d.V7q,(function(e,t){var n=t.payload;return n||e})),[]),be=(0,c.handleActions)((0,s.Z)({},d.aEw,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),{hasPermission:!0,colPermission:!0,rowPermission:!0,sheetPermission:!0,sheetVisibilityPermission:!0}),Te={source:"",isShow:!1,protectionType:0,range:null,permission:[],permId:"",sheetId:"",note:""},Ce={isShow:!1,highlightPermId:""},Se=(0,c.handleActions)((k={},(0,s.Z)(k,d.keb,(function(e,t){var n=t.payload;return Object.assign({},e,{dialog:Object.assign({},e.dialog,{},n,{isShow:!0})})})),(0,s.Z)(k,d.p10,(function(e){return Object.assign({},e,{dialog:Object.assign({},Te)})})),(0,s.Z)(k,d.pQV,(function(e,t){var n=t.payload;return Object.assign({},e,{dialog:Object.assign({},e.dialog,{permission:n.protectMembers,isShow:!0})})})),(0,s.Z)(k,d.VE1,(function(e,t){var n=t.payload;return Object.assign({},e,{panel:Object.assign({},e.panel,{},n,{isShow:!0})})})),(0,s.Z)(k,d.e8e,(function(e){return Object.assign({},e,{panel:Object.assign({},Ce)})})),(0,s.Z)(k,d.zqo,(function(e,t){var n=t.payload;return Object.assign({},e,{panel:Object.assign({},e.panel,{highlightPermId:n.highlightPermId})})})),(0,s.Z)(k,d.aEw,(function(e,t){var n=t.payload;return Object.assign({},e,{permissions:Object.assign({},e.permissions,{},n)})})),k),{dialog:{isShow:!1,protectionType:0,range:null,permId:"",permission:[],sheetId:"",note:""},panel:{isShow:!1}}),we=(0,c.handleActions)((I={},(0,s.Z)(I,d.Dru,(function(e){return!0===e.isPanelShow?e:Object.assign({},e,{isPanelShow:!0})})),(0,s.Z)(I,d.ROS,(function(e){return!1===e.isPanelShow?e:Object.assign({},e,{isPanelShow:!1})})),(0,s.Z)(I,d.s0S,(function(e){return Object.assign({},e,{isShowSelectionModal:!1})})),(0,s.Z)(I,d.jH1,(function(e){return Object.assign({},e,{isShowSelectionModal:!0})})),(0,s.Z)(I,d._Bu,(function(e,t){var n=t.payload;return(0,u.default)(e.rangeConditionFormatRules,n)?e:Object.assign({},e,{conditionFormatPanelInjectConfig:n})})),I),{isPanelShow:!1,isShowSelectionModal:!1,conditionFormatPanelInjectConfig:null}),Re=(0,c.handleActions)((x={},(0,s.Z)(x,d.kyn,(function(e,t){var n=t.payload;return Object.assign({},e,{},n,{isPanelShow:!0})})),(0,s.Z)(x,d.iWz,(function(e){return!1===e.isPanelShow?e:Object.assign({},e,{isPanelShow:!1})})),x),{isPanelShow:!1,panelType:"remove-duplication"}),Ae=(0,c.handleActions)((0,s.Z)({},d.GIr,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),{isProcessing:!1,viewType:0,isShowRangeSelector:!1}),Oe=(0,c.handleActions)((0,s.Z)({},d.$nT,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),{showDataSplitPreview:!1,range:null,ref:null}),Me=(0,c.handleActions)((0,s.Z)({},d.TUd,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),{settingPanelType:Y.CHART_SETUP}),ke=(0,c.handleActions)((N={},(0,s.Z)(N,d.HB4,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,s.Z)(N,d.bR0,(function(e,t){var n=t.payload,r=n.chartBlock,i=n.forceUpdate,o=r.sheetId,a=r.chartId;return e[o]?Object.assign({},e,(0,s.Z)({},o,Object.assign({},e[o],(0,s.Z)({},a,Object.assign({},e[o][a],{},r,{forceUpdate:i}))))):Object.assign({},e,(0,s.Z)({},o,(0,s.Z)({},a,Object.assign({},r,{forceUpdate:i}))))})),(0,s.Z)(N,d.ba_,(function(e,t){var n=t.payload,r=n.sheetId,i=n.chartId,o=Object.assign({},e,(0,s.Z)({},r,Object.assign({},e[r])));return Reflect.deleteProperty(o[r],i),e.activeChartId===i&&(e.isShowChartSettingPanel&&(o.isShowChartSettingPanel=!1),o.activeChartId=""),o})),(0,s.Z)(N,d.ZcN,(function(e,t){var n,r=t.payload,i=r.sheetId,o=r.chartId;if(e[i][o].isActive)return e;var a=Object.assign({},e[i]);for(var u in a)a[u].isActive=!1;return Object.assign({},e,(n={},(0,s.Z)(n,i,Object.assign({},a,(0,s.Z)({},o,Object.assign({},e[i][o],{forceUpdate:!1,isActive:!0})))),(0,s.Z)(n,"activeChartId",o),n))})),(0,s.Z)(N,d.MHc,(function(e){var t=e;return Object.keys(e).forEach((function(n){e[n]&&Object.keys(e[n]).forEach((function(r){e[n][r].isActive&&(t=Object.assign({},t,(0,s.Z)({},n,Object.assign({},t[n],(0,s.Z)({},r,Object.assign({},t[n][r],{isActive:!1}))))))}))})),t.activeChartId="",t})),(0,s.Z)(N,d.$7N,(function(e){return e.isShowChartSettingPanel?Object.assign({},e,{isShowChartSettingPanel:!1}):e})),(0,s.Z)(N,d.k6K,(function(e){return e.isShowChartSettingPanel?e:Object.assign({},e,{isShowChartSettingPanel:!0})})),(0,s.Z)(N,d.auN,(function(e){return Object.assign({},e,{isShowChartSelectionModal:!1})})),(0,s.Z)(N,d.nb0,(function(e){return Object.assign({},e,{isShowChartSelectionModal:!0})})),(0,s.Z)(N,d.HeF,(function(e,t){var n=t.payload;return Object.assign({},e,{chartPreviewColorType:n})})),N),{isShowChartSettingPanel:!1,chartPreviewColorType:null,isShowChartSelectionModal:!1,activeChartId:""}),Ie=(0,c.handleActions)((0,s.Z)({},d.vzX,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),{chart:!1,protection:!1}),xe=(0,c.handleActions)((0,s.Z)({},d.blX,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),{visible:!1}),Ne=(0,c.handleActions)((0,s.Z)({},d.SRA,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),{isActive:!1}),Pe=(0,c.handleActions)((P={},(0,s.Z)(P,d.Qdz,(function(e,t){var n=t.payload,r=n.spreadToken,i=n.floatBlocks;return Object.assign({},e,(0,s.Z)({},r,Object.assign({},i,{activeBlockToken:""})))})),(0,s.Z)(P,d.ymz,(function(e,t){var n=t.payload,r=n.spreadToken,i=n.floatBlock,o=i.sheetId,a=i.blockToken;return e[r]?e[r][o]?Object.assign({},e,(0,s.Z)({},r,Object.assign({},e[r],(0,s.Z)({},o,Object.assign({},e[r][o],(0,s.Z)({},a,i)))))):Object.assign({},e,(0,s.Z)({},r,Object.assign({},e[r],(0,s.Z)({},o,(0,s.Z)({},a,i))))):Object.assign({},e,(0,s.Z)({},r,(0,s.Z)({},o,(0,s.Z)({},a,i))))})),(0,s.Z)(P,d.$4G,(function(e,t){var n=t.payload,r=n.spreadToken,i=n.sheetId,o=n.blockToken,a=Object.assign({},e,(0,s.Z)({},r,Object.assign({},e[r],(0,s.Z)({},i,Object.assign({},e[r][i])))));return Reflect.deleteProperty(a[r][i],o),e[r].activeBlockToken===o&&(a[r].activeBlockToken=""),a})),(0,s.Z)(P,d.DJW,(function(e,t){var n,r=t.payload,i=r.spreadToken,o=r.sheetId,a=r.blockToken,u=r.active,l=Object.assign({},e[i][o]),c=e[i].activeBlockToken;return u?c=a:c===a&&(c=""),Object.assign({},e,(0,s.Z)({},i,Object.assign({},e[i],(n={},(0,s.Z)(n,o,Object.assign({},l,(0,s.Z)({},a,Object.assign({},e[i][o][a],{active:u})))),(0,s.Z)(n,"activeBlockToken",c),n))))})),(0,s.Z)(P,d.$HW,(function(e,t){var n=t.payload.spreadToken,r=e;return Object.keys(r[n]).forEach((function(t){e[n][t]&&Object.keys(e[n][t]).forEach((function(i){e[n][t][i].active&&(r=Object.assign({},r,(0,s.Z)({},n,Object.assign({},r[n],(0,s.Z)({},t,Object.assign({},r[n][t],(0,s.Z)({},i,Object.assign({},r[n][t][i],{active:!1}))))))))}))})),r[n].activeBlockToken="",r})),(0,s.Z)(P,d.r0V,(function(e){return Object.assign({},e,{isShowRangeSelector:!0})})),(0,s.Z)(P,d.FfF,(function(e){return Object.assign({},e,{isShowRangeSelector:!1})})),P),{isShowRangeSelector:!1}),Le=(0,c.handleActions)((0,s.Z)({},d.XJC,(function(e,t){var n=t.payload.visible;return Object.assign({},e,{visible:n})})),{visible:!1}),De=(0,c.handleActions)((L={},(0,s.Z)(L,d.L90,(function(e,t){var n=t.payload,r=n.tipSteps,i=n.toHide,o=e.hiddenSteps,a=r.reduce((function(e,t){return i?e|t:e^t}),o);return Object.assign({},e,{hiddenSteps:a})})),(0,s.Z)(L,d.CPq,(function(e,t){var n=t.payload.isAiAutoFocus;return Object.assign({},e,{isAiAutoFocus:n})})),(0,s.Z)(L,d.XV9,(function(e,t){var n=t.payload,r=n.rangeStr,i=void 0===r?"":r,o=n.originRange,a=n.sourceSheetName;return Object.assign({},e,{rangeStr:i,showRangeSelector:!0,originRange:o,sourceSheetName:a})})),(0,s.Z)(L,d.rTl,(function(e,t){var n=t.payload.rangeStr,r=void 0===n?"":n;return Object.assign({},e,{rangeStr:r})})),(0,s.Z)(L,d.n8_,(function(e){return Object.assign({},e,{showRangeSelector:!1,originRange:null,sourceSheetName:""})})),L),{hiddenSteps:0,rangeStr:"",showRangeSelector:!1,originRange:null,sourceSheetName:""}),Fe=(0,c.handleActions)((0,s.Z)({},d.oTl,(function(e,t){var n=t.payload.suspend;return Object.assign({},e,{suspend:n})})),{suspend:!1}),Be=(0,c.handleActions)((0,s.Z)({},d.Cp3,(function(e,t){var n=t.payload;return Object.assign({},e,{status:n})})),{status:0}),Ve={isShowPivotTableSettingPanel:!1,selections:[],isShowPivotCreatePanel:!1,newSheetsName:[],clickPos:"",pivotTableCalcFieldModal:{pivotTableName:"",activeId:void 0,needAdd:!1,sheetId:"",isShowPivotTableCalcFieldModal:!1}},He=(0,c.handleActions)((D={},(0,s.Z)(D,d.nMv,(function(e,t){t.payload;return e.isShowPivotTableSettingPanel?e:Object.assign({},e,{isShowPivotTableSettingPanel:!0})})),(0,s.Z)(D,d.gG_,(function(e,t){t.payload;return e.isShowPivotTableSettingPanel?Object.assign({},e,{isShowPivotTableSettingPanel:!1}):e})),(0,s.Z)(D,d.IY4,(function(e,t){var n=t.payload;return Object.assign({},e,{},n)})),(0,s.Z)(D,d.pKd,(function(e,t){var n=t.payload.newSheetName,r=e.newSheetsName;return Object.assign({},e,{newSheetsName:[].concat((0,a.Z)(r),[n])})})),(0,s.Z)(D,d.Xk_,(function(e,t){var n=t.payload;return Object.assign({},e,{pivotTableCalcFieldModal:Object.assign({},e.pivotTableCalcFieldModal,{},n,{isShowPivotTableCalcFieldModal:!0})})})),(0,s.Z)(D,d.xKo,(function(e){return Object.assign({},e,{pivotTableCalcFieldModal:Object.assign({},Ve.pivotTableCalcFieldModal)})})),D),Ve),Ue=(0,c.handleActions)((0,s.Z)({},d.GWW,(function(e,t){var n=t.payload;return Object.assign({},e,{enableSwitching:n})})),{enableSwitching:!0}),Ze=(0,c.handleActions)((0,s.Z)({},d.bOi,(function(e,t){var n=t.payload;return Object.assign({},e,{shouldUpdateSelection:n})})),{shouldUpdateSelection:!0}),We=(0,c.handleActions)((F={},(0,s.Z)(F,d.BLN,(function(e){return Object.assign({},e,{visible:!0})})),(0,s.Z)(F,d.GQ,(function(e){return Object.assign({},e,{visible:!1})})),F),{visible:!1}),je=(0,c.handleActions)((B={},(0,s.Z)(B,d.tz7,(function(e){return Object.assign({},e,{visible:!0})})),(0,s.Z)(B,d.Cg0,(function(e){return Object.assign({},e,{visible:!1})})),(0,s.Z)(B,d.IsC,(function(e,t){var n=t.payload;return Object.assign({},e,{updated:n})})),(0,s.Z)(B,d.Qzi,(function(e,t){var n=t.payload;return Object.assign({},e,{aiTenantModel:n})})),(0,s.Z)(B,d.c2S,(function(e,t){var n=t.payload;return Object.assign({},e,{promptType:n})})),B),{visible:!1,updated:!0,aiTenantModel:!1,promptType:q.sZ.userPrompt}),Ge=(0,c.handleActions)((V={},(0,s.Z)(V,d.dAE,(function(e,t){var n=t.scrollToContent;return Object.assign({},e,{visible:!0,scrollToContent:n})})),(0,s.Z)(V,d.d_t,(function(e){return Object.assign({},e,{visible:!1,scrollToContent:void 0})})),V),{visible:!1}),ze=(0,c.handleActions)((H={},(0,s.Z)(H,d.$nw,(function(e,t){var n=t.payload.triggerSource;return Object.assign({},e,{visible:!0,triggerSource:n})})),(0,s.Z)(H,d.zUc,(function(e){return Object.assign({},e,{visible:!1})})),H),{visible:!1,triggerSource:""}),Ye=(0,c.handleActions)((U={},(0,s.Z)(U,d.rNi,(function(e){return Object.assign({},e,{sparklinePanelVisible:!0})})),(0,s.Z)(U,d.bp9,(function(e){return Object.assign({},e,{sparklinePanelVisible:!1})})),U),{sparklinePanelVisible:!1}),Xe=(0,c.handleActions)((Z={},(0,s.Z)(Z,d.y65,(function(e,t){var n=t.payload;return Object.assign({},e,{sparklineCreatePanelVisible:!0,spraklineDemoDataCombination:null==n?void 0:n.spraklineDemoDataCombination,hideSpraklineDemoTip:null==n?void 0:n.hideSpraklineDemoTip})})),(0,s.Z)(Z,d.Fw5,(function(e){return Object.assign({},e,{sparklineCreatePanelVisible:!1})})),Z),{sparklineCreatePanelVisible:!1,spraklineDemoDataCombination:null,hideSpraklineDemoTip:!1}),Ke=(0,c.handleActions)((W={},(0,s.Z)(W,d.rfn,(function(e){return Object.assign({},e,{sparklineEditCombinationPanelVisible:!0})})),(0,s.Z)(W,d.acr,(function(e){return Object.assign({},e,{sparklineEditCombinationPanelVisible:!1})})),W),{sparklineEditCombinationPanelVisible:!1}),qe=(0,c.handleActions)((j={},(0,s.Z)(j,d.Bkd,(function(e){return Object.assign({},e,{isPanelShow:!0})})),(0,s.Z)(j,d.UjP,(function(e){return Object.assign({},e,{isPanelShow:!1})})),(0,s.Z)(j,d.rLI,(function(e,t){var n=t.payload.sheetIds;return Object.assign({},e,{sheetIds:n})})),(0,s.Z)(j,d.nmk,(function(e,t){var n=t.payload.modalConfig;return!1===n.visible?Object.assign({},e,{modalConfig:{visible:!1}}):Object.assign({},e,{modalConfig:Object.assign({},e.modalConfig,{},n)})})),j),{isPanelShow:!1,sheetIds:[],modalConfig:{visible:!1},isCreateEnable:!0}),$e=(0,c.handleActions)((G={},(0,s.Z)(G,d.Cbh,(function(e,t){var n=t.payload.mode;return Object.assign({},e,{visible:!0,mode:n})})),(0,s.Z)(G,d.O_r,(function(e){return Object.assign({},e,{visible:!1,mode:null})})),G),{visible:!1,mode:null}),Je=(0,c.handleActions)((z={},(0,s.Z)(z,d.U89,(function(e){return Object.assign({},e,{helpCenterSheetAiDiscussZIndex:200})})),(0,s.Z)(z,d.ifA,(function(e){return Object.assign({},e,{helpCenterSheetAiDiscussZIndex:100})})),z),{helpCenterSheetAiDiscussVisible:!1,helpCenterSheetAiDiscussZIndex:200}),Qe=(0,c.handleActions)((0,s.Z)({},d.sHL,(function(e,t){return t.payload})),!0),et=(0,l.combineReducers)({chart:ke,chartSettingPanelOptions:Me,clientVars:ge,comment:se,conditionFormat:we,contextMenu:Le,coord:ne,customSortModal:f,numberGroupSettingDialog:g,dataClean:Re,dataSplitVisible:Oe,dataValidationModal:p.Wc,dropdownMenu:ce,embedSheet:me,embedToolbar:ie,featureTips:Ie,fileExport:he,fileMenu:ye,filter:de,findbar:ae,floatBlocks:Pe,formatPainter:oe,formatterModal:v.LV,formula:ee,functionHelper:De,asyncCopySheet:Be,pivotTable:He,gridLineHidden:ve,highlightBar:xe,history:ue,permission:be,permissions:Ee,plugins:Fe,protection:Se,sheetMode:pe,smartableTransformState:Ae,status:te,tabs:Ue,titleInput:_e,toolbar:re,translateMode:Ne,zoom:fe,addRowOptions:Ze,exportPreview:We,aiInline:je,cellHistory:Ge,printPreview:ze,dataConnector:qe,sparklinePanel:Ye,sparklineCreatePanel:Xe,sparklineEditCombinationPanel:Ke,headerNotice:$e,sheetDiscuss:Je,collaboratorPermissionChanged:Qe})},vsh_13885:function(e,t,n){"use strict";n.r(t),n.d(t,{zoomValSelector:function(){return y},gridLineHiddenSelector:function(){return m},moduleSelector:function(){return E},titleSelector:function(){return b},isTemplateSelector:function(){return T},selectIsSheetRendered:function(){return C},isTranslateModeSelector:function(){return S},permissionLoadedSelector:function(){return w},historyVisible:function(){return R},editablePermissionSelector:function(){return O},editableSelector:function(){return M},editableSelectorDetail:function(){return k},hasPermissionSelector:function(){return I},hasSheetPermSelector:function(){return x},permissionSelector:function(){return N},editableWithSheetPermissionSelector:function(){return P},visibleWithSheetPermissionSelector:function(){return L},rolePermissionSelector:function(){return D},fxCompatibilityTipSelector:function(){return F},fxCompatibilityTipRowSelector:function(){return B},fxCompatibilityTipColSelector:function(){return V},commentableSelector:function(){return H},toolbarEnableSelector:function(){return U},coordSelector:function(){return Z},hyperlinkEditorSelector:function(){return W},dataValidationModalSelector:function(){return j},isShowDataValidationModalSelector:function(){return G},isShowDataValidationRangeSelector:function(){return z},toggleNavBarSelector:function(){return Y},cellStatusSelector:function(){return X},rangeStatusSelector:function(){return K},formatPainterSelector:function(){return q},isFilteredSelector:function(){return $},isFilterPersonalCheckedSelector:function(){return J},findbarSelector:function(){return Q},conditionFormatPanelInjectConfig:function(){return ee},conditionFormatPanelSelector:function(){return te},conditionFormatPanelSelectorModal:function(){return ne},rangeConditionFormatRulesSelector:function(){return re},dataCleanPanelVisibleSelector:function(){return ie},dataCleanPanelTypeSelector:function(){return oe},isShowChartSettingPanelSelector:function(){return ae},isShowPivotTableSettingPanelSelector:function(){return se},isShowPivotCreatePanelSelector:function(){return ue},isShowSparkLineCreatePanelSelector:function(){return le},isShowChartSelectionModalSelector:function(){return ce},chartSettingPanelOptinsSelector:function(){return he},chartPreviewColorTypeSelector:function(){return de},commentToggleSelector:function(){return fe},mentionToggleSelector:function(){return pe},commentDataSelector:function(){return ve},oldCommentSDKInitStatusSelector:function(){return ge},commentTargetSelector:function(){return _e},reopentCommentSelector:function(){return ye},historyLocalVisible:function(){return me},dropdownMenuSelector:function(){return Ee},selectSheetClientVars:function(){return be},titleFocusStatusSelector:function(){return Te},embedSheetMountListSelector:function(){return Ce},embedSheetIsDocxEditableSelector:function(){return Se},chartSelector:function(){return we},activeChartIdSelector:function(){return Re},floatBlocksSelector:function(){return Ae},currSheetFloatBlocksSelector:function(){return Oe},floatBlocksEditable:function(){return Me},onlineStatusSelector:function(){return ke},activeFloatBlockTokenSelector:function(){return Ie},isSheetRangeSelectorShow:function(){return xe},featureTipsSelector:function(){return Ne},formulaCorrectResultSelector:function(){return Pe},userFormulasListSelector:function(){return Le},dataValidationModalRangeSelector:function(){return De},functionHelperSelector:function(){return Fe},isShowTipsSelector:function(){return Ve},selectCurrentSuiteCreateSource:function(){return He},isShowTutorialSelector:function(){return Ze},isShowConditionalFormattingTutorial:function(){return We},isShowDropdownV2FromCellTutorial:function(){return je},shouldShowOptionalPasteBadgeSelector:function(){return Ge},shouldShowResizeRowGuideSelector:function(){return ze},shouldShowResizeColGuideSelector:function(){return Ye},shouldShowAutofitRowGuideSelector:function(){return Xe},shouldShowAutofitColGuideSelector:function(){return Ke},shouldShowCellPositionGuideSelector:function(){return qe},shouldShowOptionPasteDialogToSheet:function(){return $e},shouldShowOptionPasteDialogToEmbedSheet:function(){return Je},shouldShowContextMenuDataValidation:function(){return Qe},shouldShowDataSplitRedDotSelector:function(){return et},shouldShowDataSplitInIconRedDotSelector:function(){return tt},shouldShowTransposeSplitInIconRedDotSelector:function(){return nt},selectAnonymousEditable:function(){return rt},selectAnonymousReadonly:function(){return it},selectSmartableTransformState:function(){return ot},selectSmartableTransformProcessing:function(){return at},selectSmartableTransformViewType:function(){return st},selectSmartableTransformRangeInput:function(){return ut},selectSheetTransformToolbarOnboardingIsDone:function(){return lt},selectSheetDropdownV2MultipleOnboardingIsDone:function(){return ct},selectorContextMenu:function(){return ht},dataSplitToggleSelector:function(){return dt},dataSplitRefSelector:function(){return ft},dataSplitRangeSelector:function(){return pt},selectIsSheetPluginsSuspended:function(){return vt},selectAsyncCopySheetStatus:function(){return gt},selectIsSheetTabSwitchingenabled:function(){return _t},selectShouldUpdateSelection:function(){return yt},exportPreviewVisibleSelector:function(){return mt},aiInlineVisibleSelector:function(){return Et},aiInlineUpdatedStatusSelector:function(){return bt},aiTenantModelSelector:function(){return Tt},aiInlinePromptTypeSelector:function(){return Ct},cellHistorySelector:function(){return St},printPreviewVisibleSelector:function(){return wt},printPreviewTriggerSourceSelector:function(){return Rt},dataConnectorPanelVisibleSelector:function(){return At},dataConnectorSheetIdsSelector:function(){return Ot},dataConnectorModalConfigSelector:function(){return Mt},sparklinePanelVisibleSelector:function(){return kt},sparklineCreatePanelVisibleSelector:function(){return It},spraklineDemoDataCombinationSelector:function(){return xt},hideSpraklineDemoTipSelector:function(){return Nt},sparklineEditCombinationPanelVisibleSelector:function(){return Pt},headerNoticeVisibleSelector:function(){return Lt},headerNoticeModeSelector:function(){return Dt},helpCenterSheetAiDiscussZIndexSelector:function(){return Ft},collaboratorPermissionChangedSelector:function(){return Bt}});var r=n("vsh_29033"),i=n("vsh_22023"),o=n("vsh_4468"),a=n("vsh_59980"),s=n("vsh_6127"),u=n.n(s),l=n("vsh_69691"),c=n("vsh_23232"),h=n("vsh_18801"),d=n("vsh_12484"),f=n("vsh_22488"),p=n("vsh_18856"),v=n("vsh_24627"),g=n("vsh_97237"),_=(0,c.wN)(c.PW,i.default),y=function(e){return(0,a.default)(e,"sheet.zoom",{})},m=function(e){return(0,a.default)(e,"sheet.gridLineHidden",{})},E=function(e){var t=(0,a.default)(e,"sheet.sheetMode",[]);return t&&t.length?t[t.length-1]:"normal"},b=function(e){var t=(0,p.selectCurrentSuiteByObjToken)(e);return t?t.get("title"):""},T=function(e){return e.sheet.status.isTemplate},C=function(e){return(0,a.default)(e,"sheet.status.visible",!1)},S=function(e){return(0,a.default)(e,"sheet.translateMode.isActive",!1)},w=function(e){var t=(0,p.selectCurrentSuitePermissionInfo)(e),n=t&&void 0!==t.get("permissions")?t.get("permissions"):(0,a.default)(e,"sheet.permissions",!1);return n&&0!==n.length},R=function(e){return(0,a.default)(e,"sheet.history.visible",!1)},A=(0,c.P1)((function(e){return!!e.sheet&&e.sheet.status.halt}),(function(e){return!!e.sheet&&e.sheet.status.frozen}),(function(e){return!!e.sheet&&(e.sheet.status.isHistory||R(e))}),(function(e){return!e.sheet||e.sheet.status.online}),S,(function(e){return(0,a.default)(e,"sheet.permissions",!1)}),p.selectIsDocLockedByPlugin,(function(e){return!!e.sheet&&e.sheet.dataValidationModal.isShowRangeSelectorModal}),(function(e){return!!e.sheet&&e.sheet.status.readonly}),(function(e){return(0,p.selectCurrentUser)(e)}),(function(e){return(0,p.selectIsForceSetSecurityLabel)(e)}),(function(e,t,n,r,i,o,a,s,l,c,p){var v;return!e&&(!t&&(!n&&(!(!o||a)&&(!i&&(!(!r&&(0,h.getIsAnonymousAccess)())&&(!l&&(!s&&((!u().isOpendoc||null===(v=(0,f.getOpendocContentConfig)())||void 0===v||!v.readonly)&&(String(c.get("user_type"))!==d.USER_TYPE.APPUSER&&!p)))))))))})),O=function(e){var t=(0,p.selectCurrentSuitePermissionInfo)(e),n=t&&void 0!==t.get("permissions")?t.get("permissions"):(0,a.default)(e,"sheet.permissions",!1);return(0,f.getIsEditable)(n)},M=(0,c.P1)((function(e){return A(e)}),(function(e){return O(e)}),p.selectIsOwner,p.selectIsInEditMode,(function(e,t,n,r){return!!e&&(t&&(n||r))})),k=(0,c.P1)((function(e){return e}),(function(e){return e.sheet.status.halt}),(function(e){return e.sheet.status.frozen}),(function(e){return e.entities.permissions}),(function(e){return p.selectCanEditInvolvingEditMode}),(function(e,t,n,r,i){return{halt:t,frozen:n,permissionInfo:r,canEdit:i(e)}})),I=function(e){return(0,a.default)(e,"sheet.permission.hasPermission",!1)&&(0,a.default)(e,"sheet.permission.sheetPermission",!1)},x=function(e){return e.sheet.permission.sheetPermission},N=_((function(e){return(0,a.default)(e,"sheet.permission",{})}),(function(e){return e})),P=(0,c.P1)((function(e){return(0,a.default)(e,"sheet.permission.hasPermission",!1)}),(function(e){return(0,a.default)(e,"sheet.permission.sheetPermission",!1)}),M,(function(e,t,n){return n&&e&&t})),L=function(e){return(0,a.default)(e,"sheet.permission.sheetVisibilityPermission",!0)},D=(0,c.P1)((function(e){return e.entities.permissions}),p.selectCurrentSuiteToken,(function(e,t){return e.toJS()[t]})),F=function(e){return(0,a.default)(e,"sheet.fxCompatibilityTip.visible",!1)},B=function(e){return(0,a.default)(e,"sheet.fxCompatibilityTip.row",0)},V=function(e){return(0,a.default)(e,"sheet.fxCompatibilityTip.col",0)},H=function(e){if((0,f.isAnnouncement)())return!1;if((0,f.getShouldHideCommentBtn)())return!1;if((0,g.XU)())return!1;if(e.sheet.status.isTemplate)return!0;if(e.sheet.status.isHistory)return!1;if(u().isOpendoc){var t,n=(0,f.getOpendocCommentConfig)();return!(null!=n&&null!==(t=n.partial)&&void 0!==t&&t.disable)}return(!(0,f.getIsDocx)()||!(0,f.getDocComponentConfig)("extensions.comment.partial.disable"))&&(0,p.ifhaveCommentPermission)(e)},U=function(e){return!!e.sheet.status.emptySheet||P(e)},Z=_((function(e){return e.sheet.coord}),(function(e){return e})),W=_((function(e){return e.sheet.toolbar.hyperlinkEditor}),(function(e){return e})),j=function(e){return e.sheet.dataValidationModal},G=function(e){return e.sheet.dataValidationModal.isShowDataValidationModal},z=function(e){return e.sheet.dataValidationModal.isShowRangeSelectorModal},Y=function(e){if(!(0,r.default)(e.sheet))return e.sheet.toolbar&&e.sheet.toolbar.toggleNavBar},X=_((function(e){return e.sheet.toolbar.cellStatus}),(function(e){var t=e.textDecoration,n=void 0===t?v.aBM.none:t,r=e.formatter,i=e.hAlign,a=void 0===i?v.KqL.Left:i,s=e.vAlign,u=void 0===s?v.g$I.Bottom:s,c=e.wordWrap,h=e.cellType,d=e.fontStyle,f=e.fontWeight,p=e.isEmbedImageCell,g=e.isImageCell,_=e.showDateEditIcon,y=e.fontSize||v.OSP;return(0,o.Z)(y,"pt")||(y=(0,l.px2pt)(y)),{formatter:r||"General",fontSize:parseInt(y,10),bold:(0,l.isBold)(String(f)),italic:"italic"===d,underline:!!(n&&n&v.aBM.underline),lineThrough:!!(n&&n&v.aBM.lineThrough),hAlign:a,vAlign:u,wordWrap:c,cellType:h,hyperlink:h&&"8"===h.typeName,isEmbedImageCell:p,isImageCell:g,showDateEditIcon:_}})),K=_((function(e){return e.sheet.toolbar.rangeStatus}),(function(e){var t=e.mergable,n=void 0!==t&&t,r=e.splitable,i=void 0!==r&&r,o=e.sortable,a=void 0!==o&&o,s=e.painterFormatable,u=void 0!==s&&s,l=e.decimalPlaceDecreasable,c=void 0!==l&&l,h=e.decimalPlaceIncreasable,d=void 0!==h&&h,f=e.isSingleCell;return{mergable:n,splitable:i,sortable:a,painterFormatable:u,decimalPlaceDecreasable:c,decimalPlaceIncreasable:d,isSingleCell:void 0!==f&&f}})),q=_((function(e){return e.sheet.formatPainter}),(function(e){return{painterFormatting:e.painterFormatting}})),$=_((function(e){return e.sheet.toolbar.isFiltered}),(function(e){return e})),J=function(e){return(0,a.default)(e,"sheet.filter.isPersonalSwitchChecked",null)},Q=function(e){return e.sheet.findbar},ee=function(e){return e.sheet.conditionFormat.conditionFormatPanelInjectConfig},te=function(e){return e.sheet.conditionFormat.isPanelShow},ne=function(e){return e.sheet.conditionFormat.isShowSelectionModal},re=function(e){return e.sheet.toolbar.rangeConditionFormatRules},ie=function(e){return!!e.sheet.dataClean.isPanelShow},oe=function(e){return e.sheet.dataClean.panelType},ae=function(e){return e.sheet.chart.isShowChartSettingPanel},se=function(e){return e.sheet.pivotTable.isShowPivotTableSettingPanel},ue=function(e){return e.sheet.pivotTable.isShowPivotCreatePanel},le=function(e){return e.sheet.pivotTable.isShowPivotCreatePanel},ce=function(e){return e.sheet.chart.isShowChartSelectionModal},he=function(e){return e.sheet.chartSettingPanelOptions},de=function(e){return e.sheet.chart.chartPreviewColorType||null},fe=function(e){return e.sheet.comment.toggle},pe=function(e){return e.sheet.mention.toggle},ve=function(e){return e.sheet.comment.data},ge=function(e){return e.sheet.comment.isCommentDataInit},_e=function(e){return e.sheet.comment.target},ye=function(e){return e.sheet.comment.reopenCommentId},me=function(e){return e.sheet.history.localVisible},Ee=function(e){return e.sheet.dropdownMenu},be=function(e){return e.sheet.clientVars},Te=function(e){return e.sheet.titleInput.isFocus},Ce=function(e){return e.sheet.embedSheet.mountedList},Se=function(e){return e.sheet.embedSheet.isDocxEditable},we=function(e){return e.sheet.chart},Re=function(e){return e.sheet.chart.activeChartId},Ae=function(e){return e.sheet.floatBlocks},Oe=function(e,t,n){return e.sheet.floatBlocks[t]&&e.sheet.floatBlocks[t][n]||{}},Me=function(e,t){return t.editable&&e.sheet.status.online&&x(e)},ke=function(e){return e.sheet.status.online},Ie=function(e,t){return e.sheet.floatBlocks[t]&&e.sheet.floatBlocks[t].activeBlockToken||""},xe=function(e){return e.sheet.floatBlocks.isShowRangeSelector},Ne=function(e){return e.sheet.featureTips},Pe=function(e){return e.sheet.formula.correct_result},Le=function(e){return e.sheet.formula.formulaList},De=function(e){return e.sheet.dataValidationModal.isShowRangeSelectorModal},Fe=function(e){return e.sheet.functionHelper},Be=["chart","protection"],Ve=function(e){return(0,c.P1)((function(e){return e.sheet.featureTips}),(function(t){var n=!1;return Be.some((function(r){return r===e?(n=t[r],!0):!0===t[r]&&(n=!1,!0)})),n}))},He=(0,c.P1)(p.selectCurrentSuiteByObjToken,(function(e){return e?e.get("create_source"):-1})),Ue=function(){return!1},Ze=Ue,We=Ue,je=Ue,Ge=Ue,ze=Ue,Ye=Ue,Xe=Ue,Ke=Ue,qe=Ue,$e=Ue,Je=Ue,Qe=Ue,et=Ue,tt=Ue,nt=Ue,rt=function(e){var t=I(e);return(0,h.getIsAnonymousAccess)()&&t},it=function(e){var t=I(e);return(0,h.getIsAnonymousAccess)()&&!t},ot=function(e){return e.sheet.smartableTransformState},at=function(e){return e.sheet.smartableTransformState.isProcessing},st=function(e){return e.sheet.smartableTransformState.viewType},ut=function(e){return e.sheet.smartableTransformState.isShowRangeSelector},lt=Ue,ct=Ue,ht=function(e){return e.sheet.contextMenu.visible},dt=function(e){return e.sheet.dataSplitVisible.showDataSplitPreview},ft=function(e){return e.sheet.dataSplitVisible.ref},pt=function(e){return e.sheet.dataSplitVisible.range},vt=function(e){return e.sheet.plugins.suspend},gt=function(e){return e.sheet.asyncCopySheet.status},_t=function(e){return e.sheet.tabs.enableSwitching},yt=function(e){return e.sheet.addRowOptions.shouldUpdateSelection},mt=function(e){return e.sheet.exportPreview.visible},Et=function(e){return e.sheet.aiInline.visible},bt=function(e){return e.sheet.aiInline.updated},Tt=function(e){return e.sheet.aiInline.aiTenantModel},Ct=function(e){return e.sheet.aiInline.promptType},St=function(e){return e.sheet.cellHistory},wt=function(e){return e.sheet.printPreview.visible},Rt=function(e){return e.sheet.printPreview.triggerSource},At=function(e){return e.sheet.dataConnector.isPanelShow},Ot=function(e){return e.sheet.dataConnector.sheetIds},Mt=function(e){return e.sheet.dataConnector.modalConfig},kt=function(e){return e.sheet.sparklinePanel.sparklinePanelVisible},It=function(e){return e.sheet.sparklineCreatePanel.sparklineCreatePanelVisible},xt=function(e){return e.sheet.sparklineCreatePanel.spraklineDemoDataCombination},Nt=function(e){return e.sheet.sparklineCreatePanel.hideSpraklineDemoTip},Pt=function(e){return e.sheet.sparklineEditCombinationPanel.sparklineEditCombinationPanelVisible},Lt=function(e){return e.sheet.headerNotice.visible},Dt=function(e){return e.sheet.headerNotice.mode},Ft=function(e){return e.sheet.sheetDiscuss.helpCenterSheetAiDiscussZIndex},Bt=function(e){return e.sheet.collaboratorPermissionChanged}},vsh_17724:function(e,t,n){"use strict";n.d(t,{v:function(){return T},S:function(){return C}});var r,i=n("vsh_67017"),o=n.n(i),a=n("vsh_35067"),s=n("vsh_19264"),u=n("vsh_4175"),l=n("vsh_65498"),c=n("vsh_18801"),h=n("vsh_12484"),d=n("vsh_22488"),f=n("vsh_18856"),p=n("vsh_22392"),v=n("vsh_99520"),g=n("vsh_47531"),_=n("vsh_82905"),y=n("vsh_60140"),m=n("vsh_205"),E=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":(0,l.Z)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},b=function(e,t){return function(n,r){t(n,r,e)}},T={print:void 0,printable:void 0,previewable:void 0,copyable:void 0,export:void 0,exportable:void 0,copy:void 0,previewResultCode:void 0};!function(e){e[e.SUCCESS=200]="SUCCESS",e[e.FORBIDDEN=403]="FORBIDDEN",e[e.NOT_FOUND=404]="NOT_FOUND"}(r||(r={}));var C=function(){function e(t){var n=this;(0,s.Z)(this,e),this.document=t,this.attachmentPreviewResultCodeMap=new Map,this.setAttachmentPreviewResultCode=function(e,t){n.attachmentPreviewResultCodeMap.set(e,t)}}var t,n,i;return(0,u.Z)(e,[{key:"preCheck",value:function(e){var t,n=m.nB[e];return n?!(null===(t=(0,f.selectCurrentActionManagerSecurity)(c.store.getState()))||void 0===t||!t[n]):(console.error("[ConditionalAccessControlService.preCheck] Action ".concat(e," No key")),!1)}},{key:"check",value:function(e,t,n){return e===_.Vw.ATTACHMENTDOWNLOAD?this.checkAttachmentDownload(t,n):m.M9[e]?d.actionManager.checkAction(m.M9[e],n):(console.error("[ConditionalAccessControlService.check] No action: ".concat(e)),!1)}},{key:"checkAttachment",value:function(e,t){var n=this,r=this.document.documentInfo;if(!r)return T;var i=this.getAttachmentPermissions(e,r.obj_token);if(d.authRequestManager.checkHasAuthed(r.obj_token,e).then((function(i){i?t&&n.processDLPCheck(e,t):d.authRequestManager.fetchAuth({parentObj:{token:r.obj_token,type:r.type},authObj:{token:e},callback:function(){var e;return null==t||null===(e=t.onPermissionFetched)||void 0===e?void 0:e.call(t)}})})),this.attachmentPreviewResultCodeMap.has(e)&&void 0===i.previewResultCode){var o=this.attachmentPreviewResultCodeMap.get(e);i.previewResultCode=o,i.previewable=i.previewResultCode===_.j6.NORMAL,o===_.j6.CHECKING&&t&&this.processDLPCheck(e,t)}return i}},{key:"getAttachmentPermissionControlStatus",value:function(e,t){var n;return(0,f.selectAttachmentPermissionsControlStatus)(c.store.getState(),t,e,null===(n=this.document.documentInfo)||void 0===n?void 0:n.obj_token)}},{key:"checkAttachmentDownload",value:(i=(0,a.Z)(o().mark((function e(t,n){var r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",!1);case 2:if(r=this.document.documentInfo){e.next=5;break}return e.abrupt("return",!1);case 5:return i=(0,d.createActionManager)({file:Object.assign({token:t,type:h.NUM_SUITE_TYPE.FILE,ownerId:r.owner_id,tenantId:r.tenant_id,business:{store:c.store,select:f.selectAttachmentPermissions}},n&&{sourceInfo:n}),source:d.SourceEnum.SHEET}),e.abrupt("return",i.checkAction(d.IActions.ATTACHMENTDOWNLOAD));case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"getAttachmentCheckResult",value:function(e){var t=this;return new Promise((function(n){var r=t.document.documentInfo;r?d.authRequestManager.checkHasAuthed(r.obj_token,e).then(function(){var i=(0,a.Z)(o().mark((function i(s){var u;return o().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!s){i.next=6;break}return u=t.getAttachmentPermissions(e,r.obj_token),i.next=4,t.changePermission(u,e);case 4:return n(u),i.abrupt("return");case 6:d.authRequestManager.fetchAuth({parentObj:{token:r.obj_token,type:r.type},authObj:{token:e},callback:function(){var i=(0,a.Z)(o().mark((function i(){var a;return o().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return a=t.getAttachmentPermissions(e,r.obj_token),i.next=3,t.changePermission(a,e);case 3:return n(a),i.abrupt("return");case 5:case"end":return i.stop()}}),i)})));return function(){return i.apply(this,arguments)}}()});case 7:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}()):n(T)}))}},{key:"changePermission",value:(n=(0,a.Z)(o().mark((function e(t,n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,d.getAttachmentAuthEnable)()||!(0,d.getDLPUploadEnable)()){e.next=14;break}if(!this.attachmentPreviewResultCodeMap.has(n)){e.next=7;break}return t.previewResultCode=this.attachmentPreviewResultCodeMap.get(n),t.previewable=t.previewResultCode===_.j6.NORMAL,e.abrupt("return");case 7:return e.next=9,this.fetchAttachmentPreviewResultCode(n);case 9:return r=e.sent,this.setAttachmentPreviewResultCode(n,r),t.previewResultCode=r,t.previewable=t.previewResultCode===_.j6.NORMAL,e.abrupt("return");case 14:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"processDLPCheck",value:function(e,t){var n=this,r=this.document.documentInfo;if((0,d.getDLPUploadEnable)()&&r){var i=t.onPermissionFetched,s=t.onDlpCheckFinished;if((this.getAttachmentPermissions(e,r.obj_token).previewResultCode||this.attachmentPreviewResultCodeMap.get(e))===_.j6.CHECKING){var u=function(){var t=(0,a.Z)(o().mark((function t(r){var a,l;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.document.documentInfo,l=r.result,!a){t.next=5;break}return t.next=5,d.authRequestManager.fetchAuth({parentObj:{token:a.obj_token,type:a.type},authObj:{token:e},callback:function(){null==i||i()}});case 5:null==s||s(r),[d.DLP_ATTACHMENT_RESULT.DELETED,d.DLP_ATTACHMENT_RESULT.SENSITIVE].includes(l)?n.attachmentPreviewResultCodeMap.set(e,_.j6.DELETED):r.result===d.DLP_ATTACHMENT_RESULT.NOT_SENSITIVE&&n.attachmentPreviewResultCodeMap.set(e,_.j6.NORMAL),d.attachmentPermissionManager.deleteFetchCallback(e,u);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();d.attachmentPermissionManager.setFetchCallback(e,u)}}}},{key:"getAttachmentPermissions",value:function(e,t){return(0,f.selectAttachmentPermissions)(c.store.getState(),e,t)}},{key:"fetchAttachmentPreviewResultCode",value:(t=(0,a.Z)(o().mark((function e(t){var n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch((0,d.getPreviewUrl)({fileToken:t}),{method:"GET",credentials:"include"});case 3:if((n=e.sent).status!==r.SUCCESS){e.next=6;break}return e.abrupt("return",_.j6.NORMAL);case 6:if(n.status!==r.NOT_FOUND&&n.status!==r.FORBIDDEN){e.next=14;break}if((i=(0,d.checkDLPAttachmentError)(n))!==d.DLP_ATTACHMENT_RESULT.DELETED){e.next=12;break}return e.abrupt("return",_.j6.DELETED);case 12:if(i!==d.DLP_ATTACHMENT_RESULT.CHECKING){e.next=14;break}return e.abrupt("return",_.j6.CHECKING);case 14:return e.abrupt("return",void 0);case 17:return e.prev=17,e.t0=e.catch(0),console.info("[ConditionalAccessControlService.fetchAttachmentPreviewResultCode] error",e.t0),e.abrupt("return",void 0);case 21:case"end":return e.stop()}}),e,null,[[0,17]])}))),function(e){return t.apply(this,arguments)})},{key:"destroy",value:function(){this.attachmentPreviewResultCodeMap.clear()}}]),e}();E([(0,p.P)()],C.prototype,"destroy",null),C=E([(0,v.b)(),b(0,(0,g.f)(y.B))],C)},vsh_205:function(e,t,n){"use strict";n.d(t,{M9:function(){return p},nB:function(){return v},nv:function(){return g},cC:function(){return _},JC:function(){return y}});var r,i,o=n("vsh_67017"),a=n.n(o),s=n("vsh_35067"),u=n("vsh_74561"),l=n("vsh_12484"),c=n("vsh_22488"),h=n("vsh_98125"),d=n("vsh_82905"),f=n("vsh_36557"),p=(r={},(0,u.Z)(r,d.Vw.DOCCREATECOPY,c.IActions.DOCCREATECOPY),(0,u.Z)(r,d.Vw.DOCDOWNLOAD,c.IActions.DOCDOWNLOAD),(0,u.Z)(r,d.Vw.DOCEXPORT,c.IActions.DOCEXPORT),(0,u.Z)(r,d.Vw.EXTERNALACCESS,c.IActions.EXTERNALACCESS),(0,u.Z)(r,d.Vw.FILECREATECOPY,c.IActions.FILECREATECOPY),(0,u.Z)(r,d.Vw.FILEDOWNLOAD,c.IActions.FILEDOWNLOAD),(0,u.Z)(r,d.Vw.FILEEXPORT,c.IActions.FILEEXPORT),(0,u.Z)(r,d.Vw.UPLOAD,c.IActions.UPLOAD),(0,u.Z)(r,d.Vw.ATTACHMENTDOWNLOAD,c.IActions.ATTACHMENTDOWNLOAD),(0,u.Z)(r,d.Vw.DOCCONTENTCOPY,c.IActions.DOCCONTENTCOPY),(0,u.Z)(r,d.Vw.DOCPRINT,c.IActions.DOCPRINT),(0,u.Z)(r,d.Vw.FILECONTENTCOPY,c.IActions.FILECONTENTCOPY),(0,u.Z)(r,d.Vw.FILEPRINT,c.IActions.FILEPRINT),r),v=(i={},(0,u.Z)(i,d.Vw.CONTENTCOPY,"contentCopy"),(0,u.Z)(i,d.Vw.CREATECOPY,"createCopy"),(0,u.Z)(i,d.Vw.EXPORT,"export"),(0,u.Z)(i,d.Vw.PRINT,"print"),(0,u.Z)(i,d.Vw.DOWNLOAD,"download"),(0,u.Z)(i,d.Vw.DOCCONTENTCOPY,"docContentCopy"),(0,u.Z)(i,d.Vw.DOCCREATECOPY,"docCreateCopy"),(0,u.Z)(i,d.Vw.DOCEXPORT,"docExport"),(0,u.Z)(i,d.Vw.DOCPRINT,"docPrint"),(0,u.Z)(i,d.Vw.DOCDOWNLOAD,"docDownload"),(0,u.Z)(i,d.Vw.FILECONTENTCOPY,"fileContentCopy"),(0,u.Z)(i,d.Vw.FILECREATECOPY,"fileCreateCopy"),(0,u.Z)(i,d.Vw.FILEEXPORT,"fileExport"),(0,u.Z)(i,d.Vw.FILEPRINT,"filePrint"),(0,u.Z)(i,d.Vw.FILEDOWNLOAD,"fileDownload"),(0,u.Z)(i,d.Vw.ATTACHMENTDOWNLOAD,"attachmentDownload"),(0,u.Z)(i,d.Vw.UPLOAD,"upload"),(0,u.Z)(i,d.Vw.EXTERNALACCESS,"externalAccess"),i),g=function(e){return function(t){("function"==typeof e?e():e).getService(d.Qh).check(d.Vw.DOCCONTENTCOPY)||(t.preventDefault(),t.stopPropagation())}},_=function(){var e=(0,f.U)();return(0,h.useMemo)((function(){return g(e)}),[e])},y=function(){var e=(0,s.Z)(a().mark((function e(t,n,r){var i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,c.createActionManager)({file:{token:t,type:l.NUM_SUITE_TYPE.DOCX,ownerId:n,tenantId:r},source:c.SourceEnum.SHEET}),e.abrupt("return",i.checkAction(c.IActions.DOCCREATECOPY));case 2:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},vsh_85502:function(e,t,n){"use strict";n.d(t,{$:function(){return m},q:function(){return E}});var r=n("vsh_19264"),i=n("vsh_4175"),o=n("vsh_65498"),a=n("vsh_22023"),s=n("vsh_22392"),u=n("vsh_99520"),l=n("vsh_47531"),c=n("vsh_64299"),h=n("vsh_67295"),d=n("vsh_75071"),f=n("vsh_72834"),p=n("vsh_82905"),v=n("vsh_9852"),g=n("vsh_13885"),_=function(e,t,n,r){var i,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":(0,o.Z)(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(i=e[u])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},y=function(e,t){return function(n,r){t(n,r,e)}},m=function(){function e(t,n){var i=this;(0,r.Z)(this,e),this.store=t,this.spread=n,this._activeSheet$=new c.X(void 0),this._suiteEditable$=new c.X(!1),this._sheetBusinessEditable$=new c.X(!1),this._protectionPermission$=new c.X(p.yd),this._curRangeEditable$=new c.X(!1),this.suiteEditable$=this._suiteEditable$.asObservable(),this.sheetBusinessEditable$=this._sheetBusinessEditable$.asObservable(),this.protectionPermission$=this._protectionPermission$.asObservable(),this.curRangeEditable$=this._curRangeEditable$.asObservable(),this.updateSuiteEditable=function(){var e=i.store.getState(),t=(0,g.editablePermissionSelector)(e);t!==i.suiteEditable&&i._suiteEditable$.next(t)},this.updateSheetBusinessEditable=function(){var e=i.store.getState(),t=(0,g.editableSelector)(e);t!==i.sheetBusinessEditable&&i._sheetBusinessEditable$.next(t)},this.updateProtectionPermission=function(){var e=i.spread,t=e.options.embed,n=e.getActiveSheet(),r=null==n?void 0:n.protectionModel.curRowColRangeProtectionPermission,o={curRowEditable:Boolean(null==r?void 0:r.curRowEditable),curColEditable:Boolean(null==r?void 0:r.curColEditable),curRangeEditable:Boolean(null==r?void 0:r.curRangeEditable),curSheetEditable:!!t||e.permissionManager.curSheetEditable,curSheetVisiblePerm:!!t||e.permissionManager.curSheetVisiblePerm};(0,a.default)(i.protectionPermission,o)||i._protectionPermission$.next(o)},this.updateCurRangeEditable=function(){var e=i.suiteEditable&&i.sheetBusinessEditable&&i.protectionPermission.curSheetEditable&&i.protectionPermission.curRangeEditable;i.curRangeEditable!==e&&i._curRangeEditable$.next(e)};var o=this.spread.activeSheet$.subscribe((function(e){return i._activeSheet$.next(e)})),s=this.store.subscribe((function(){i.updateSuiteEditable(),i.updateSheetBusinessEditable()}));this.updateSuiteEditable(),this.updateSheetBusinessEditable();var u=this._activeSheet$.pipe((0,d.w)((function(e){return(null==e?void 0:e.protectionModel.curRowColRangeProtectionPermission$)||[f.J5L]}))),l=(0,h.T)(u,this.spread.permissionManager.curSheetEditable$,this.spread.permissionManager.curSheetVisiblePerm$).subscribe(this.updateProtectionPermission),v=(0,h.T)(this._suiteEditable$,this._sheetBusinessEditable$,this._protectionPermission$).subscribe(this.updateCurRangeEditable);this.unsubscribe=function(){s(),o.unsubscribe(),l.unsubscribe(),v.unsubscribe()}}return(0,i.Z)(e,[{key:"refreshActiveSheet",value:function(){var e=this.spread.getActiveSheet();e&&e!==this._activeSheet$.getValue()&&this._activeSheet$.next(e)}},{key:"destroy",value:function(){this.unsubscribe(),this._curRangeEditable$.complete(),this._protectionPermission$.complete(),this._sheetBusinessEditable$.complete(),this._suiteEditable$.complete()}},{key:"suiteEditable",get:function(){return this._suiteEditable$.getValue()}},{key:"sheetBusinessEditable",get:function(){return this._sheetBusinessEditable$.getValue()}},{key:"protectionPermission",get:function(){return this._protectionPermission$.getValue()}},{key:"curRangeEditable",get:function(){return this._curRangeEditable$.getValue()}}]),e}();_([(0,s.P)()],m.prototype,"destroy",null),m=_([(0,u.b)(),y(0,(0,l.f)(v.wA)),y(1,(0,l.f)(f.Wje))],m);var E=function(e){return e.getService(p.f3)}},vsh_45495:function(e,t,n){"use strict";n.d(t,{Hb:function(){return Ne},Ur:function(){return Pe}});var r=n("vsh_98652"),i=n("vsh_74561"),o=n("vsh_67017"),a=n.n(o),s=n("vsh_35067"),u=n("vsh_19264"),l=n("vsh_4175"),c=n("vsh_27679"),h=n("vsh_4561"),d=n("vsh_29033"),f=n("vsh_33916"),p=n("vsh_71453"),v=n("vsh_69691"),g=n("vsh_52690"),_=n("vsh_18801"),y=n("vsh_12484"),m=n("vsh_22488"),E=n("vsh_18856"),b=n("vsh_14801"),T=n("vsh_89454"),C=n("vsh_24627"),S=n("vsh_75986");function w(){try{var e=window.performance.getEntries(),t=e.filter((function(e){return["script","link"].includes(e.initiatorType)&&e.name.endsWith(".js")})),n=e.filter((function(e){return["link"].includes(e.initiatorType)&&e.name.endsWith(".css")})),r=function(e){return Math.round(e.reduce((function(e,t){return e+(t.decodedBodySize||0)}),0)/1024)};return{ttuTotalSize:r(e),ttuJsLoadSize:r(t),ttuCssLoadSize:r(n)}}catch(e){return{}}}function R(){try{var e=new RegExp(/sheet_app.[a-zA-Z0-9]{1,}.js/);return(window.performance.getEntries()||[]).some((function(t){return!!e.test(t.name)&&0!==t.duration}))}catch(e){return!1}}function A(e){try{var t=e.getPlugin(S.IEf),n=e.spread.getActiveSheet().id();return t?{forwardRefBlockslen:t.dataApplyCounter.getAllDepRelationsBySheetId(n).forwardRef.reduce((function(e,n){var r=t.dataApplyCounter.getBlocksBySheetId(n);return e+Object.keys(r).length}),0),blocksLen:Object.keys(t.dataApplyCounter.getBlocksBySheetId(n)).length}:{}}catch(e){return{}}}var O=n("vsh_56371"),M=n("vsh_80049"),k=n("vsh_46110"),I=n("vsh_72834"),x=n("vsh_74340"),N=n("vsh_82905"),P=n("vsh_7959"),L=n("vsh_46544"),D=n("vsh_69847"),F=n("vsh_97237"),B=n("vsh_23640"),V=n("vsh_95418"),H=n("vsh_68635"),U=n("vsh_50662"),Z=n("vsh_68718"),W=n("vsh_13885"),j=n("vsh_6769"),G=n("vsh_67353"),z=n("vsh_142"),Y=n("vsh_75033"),X=n("vsh_25285"),K=n("vsh_72429"),q=n("vsh_56450"),$=n("vsh_98125"),J=n.n($),Q=n("vsh_23585"),ee=n("vsh_96579"),te=n("vsh_46162"),ne=n("vsh_22233"),re=n("vsh_1139"),ie=n("vsh_73043");function oe(e,t){return ae.apply(this,arguments)}function ae(){return(ae=(0,s.Z)(a().mark((function e(t,n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le(t,n,he);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function se(e,t){return ue.apply(this,arguments)}function ue(){return(ue=(0,s.Z)(a().mark((function e(t,n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le(t,n,fe);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function le(e,t,n){return ce.apply(this,arguments)}function ce(){return(ce=(0,s.Z)(a().mark((function e(t,n,r){var i,o,s,u,l,c,h,d,f,p,v,g,_,y;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i={},o=n.blockManager,t&&t.sheets&&o){e.next=4;break}return e.abrupt("return",i);case 4:s=Object.entries(t.sheets).map((function(e){var t=(0,re.Z)(e,2);return{name:t[0],id:t[1].id}})),(u=(0,te.getCreateUseNewSnapshot)())&&(l=n.serialize()),c=0;case 8:if(!(c<s.length)){e.next=21;break}if(h=s[c].name,d=s[c].id,!(f=t.sheets[h]).externalResource||!f.externalResource.blockToken){e.next=18;break}return p=f.externalResource.blockToken,e.next=16,r(o,p);case 16:(v=e.sent)?u?(g=o.createBlockId(),i[g]=v,ge(g,d,l)):(_=ve(f,o.createBlockId()),i[_]=v):(y=ve(f,o.createBlockId()),i[y]=he(o,p));case 18:c++,e.next=8;break;case 21:return e.abrupt("return",{blockInfos:i,mutationMap:l});case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function he(e,t){return de.apply(this,arguments)}function de(){return(de=(0,s.Z)(a().mark((function e(t,n){var r,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.parseBlockToken(C.kHU.BITABLE_BLOCK,n),i=r.props.tableId,e.abrupt("return",{data:"",src_table_id:i,table_id:""});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fe(e,t){return pe.apply(this,arguments)}function pe(){return(pe=(0,s.Z)(a().mark((function e(t,n){var r,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.parseBlockToken(C.kHU.BITABLE_BLOCK,n),i=r.props.tableId,e.next=3,t.invokeCustomMethod("getTableDataForServerCopy",i);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ve(e,t){return e.externalResource.blockToken="",e.externalResource.blockId=t,t}function ge(e,t,n){var r,i,o,a,s,u=null==n?void 0:n[C.B2l.CommandType.CommandType_TOP_SNAPSHOT],l=null==u||null===(r=u.commands)||void 0===r?void 0:r.find((function(e){return e.sheetId===t})),c=null==l||null===(i=l.mutations)||void 0===i?void 0:i.find((function(e){return e.type===C.B2l.MutationType.MutationType_InsertSheet}));null!=c&&null!==(o=c.insertSheet)&&void 0!==o&&null!==(a=o.worksheetProperties)&&void 0!==a&&null!==(s=a.externalBlock)&&void 0!==s&&s.blockId&&(c.insertSheet.worksheetProperties.externalBlock.blockId=e)}function _e(e,t){var n;null===(n=e.blockManager)||void 0===n||n.invokeCustomMethod("removeBitableLocalConflictRecord",t)}function ye(e,t,n){return me.apply(this,arguments)}function me(){return(me=(0,s.Z)(a().mark((function e(t,n,r){var i,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.sheetTimeStamp,o=r.blockTimeStamp,!i){e.next=4;break}return e.next=4,n.removeLocalRecord(i);case 4:o&&_e(t,o);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ee(e,t){return(0,ne.K4)({body:e,title:ie("sheet.conflict.edit"),closable:!1,maskClosable:!1,confirmText:ie("common.refresh"),cancelText:"",onConfirm:(n=(0,s.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t();case 1:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})});var n}function be(e){return Te.apply(this,arguments)}function Te(){return(Te=(0,s.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,ne.h2)({body:t,title:ie("common.prompt"),confirmText:ie("sheet.conflict.tips_yes"),closable:!1,maskClosable:!1,cancelText:""}).promise;case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ce,Se=n("vsh_73043");!function(e){e.Block="block",e.Sheet="sheet"}(Ce||(Ce={}));var we=function(){function e(t,n){var r=this;(0,u.Z)(this,e),this.sheetSdk=t,this.dataHandlers=n,this.processingConflict=!1,this.conflictResolveQueue=[],this.onConflict=function(){var e=(0,s.Z)(a().mark((function e(t){var n,i,o,s,u,l,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.waitConflictResolve();case 2:return r.onConflictResolve(),n=!1,i=r.sheetSdk.getService(x.AKO),o=r.sheetSdk.getService(x.AHm),e.next=8,i.getBaseRev();case 8:if(e.t0=e.sent,e.t0){e.next=11;break}e.t0=o.getBaseRev();case 11:return s=e.t0,u=Date.now(),e.next=15,i.getBackupActions();case 15:if(l=e.sent,r.onConflictBackupState(l,t),l&&!(l.length<=0)){e.next=23;break}return e.next=20,r.clearAndRefetchData();case 20:return r.sheetSdk.getService(x.qif).pushNewState({type:x.pb3.CLEAR}),r.releaseConflictResolve(),e.abrupt("return");case 23:return c={timestamp:u,baseRev:s,actions:(0,C.ivc)(JSON.stringify(l)),version:C.Da0.V1},h={sheetTimeStamp:u},e.prev=25,e.next=28,i.addLocalRecord(c);case 28:n=!0,e.next=37;break;case 31:return e.prev=31,e.t1=e.catch(25),r.reporterService.captureException(e.t1,{key:"CONFLICT_ADD_LOCAL_RECORD"}),r.saveConflictFailed(e.t1,Ce.Sheet,h,t),r.releaseConflictResolve(),e.abrupt("return");case 37:r.showConflictImp(h,t),r.releaseConflictResolve(),(0,ee.collectSuiteEvent)("client_edit_conflict",{store_status:Number(n)});case 40:case"end":return e.stop()}}),e,null,[[25,31]])})));return function(t){return e.apply(this,arguments)}}(),this.onConflictFromBlock=function(){var e=(0,s.Z)(a().mark((function e(t,n){var i,o,s,u,l,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.waitConflictResolve();case 2:return i={isOldVersion:!1,rejectType:C.KNj.FOLLOW_REJECT},o=r.sheetSdk.getService(x.AKO),s=r.sheetSdk.getService(x.AHm),e.next=7,o.getBaseRev();case 7:if(e.t0=e.sent,e.t0){e.next=10;break}e.t0=s.getBaseRev();case 10:return u=e.t0,l=!1,c={blockTimeStamp:n.timestamp},n.baseRev=u,n.version=C.Da0.V1,e.prev=15,e.next=18,o.addLocalRecord(n);case 18:l=!0,e.next=27;break;case 21:return e.prev=21,e.t1=e.catch(15),r.reporterService.captureException(e.t1,{key:"CONFLICT_BLOCK_ADD_LOCAL_RECORD"}),r.saveConflictFailed(e.t1,Ce.Block,c,i),r.releaseConflictResolve(),e.abrupt("return");case 27:r.showConflictImp(c,i,n),r.releaseConflictResolve(),(0,ee.collectSuiteEvent)("client_edit_conflict",{store_status:Number(l)});case 30:case"end":return e.stop()}}),e,null,[[15,21]])})));return function(t,n){return e.apply(this,arguments)}}(),this.clearAndRefetchData=(0,s.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.sheetSdk.getService(x.AHm),r.sheetSdk.getService(N.QX).log("conflict manager","clearAndRefetchData"),e.next=4,n.clearBackup();case 4:null===(t=r.sheetSdk.getPlugin(S.IEf))||void 0===t||t.reload(C.Hg0.genSpecTid(C.$UQ.CONFLICT));case 5:case"end":return e.stop()}}),e)}))),this.prepareConflict=function(e,t,n){(0,ee.collectSuiteEvent)("show_edit_conflict_tip",{is_old_version:Number(Boolean(e&&e.isOldVersion)),conflict_source:n?Ce.Block:Ce.Sheet,reject_type:e.rejectType,source:t})},this.saveConflictFailed=function(e,t,n,i){r.showConflictModal(n,i),(0,ee.collectSuiteEvent)("sheet_conflict_save_failed",{conflict_source:t,message:e.message,stack:e.stack,reject_type:i.rejectType})},this.saveConflictSuccess=function(e,t){var n="__SHOW_CONFLIT_TO__";r.uiNotifier.Toast.show({key:n,type:"error",content:J().createElement("div",{className:"sheet-conflict-open-local-history"},J().createElement("div",{className:"sheet-conflict-open-local-history-msg"},Se("CreationDoc_Sheets_LocalHistory.trigger.toast")),J().createElement(q.Button,{type:"text",color:"primary",className:"sheet-conflict-open-local-history-button",onClick:function(){r.dataHandlers.showHistory(!0),r.uiNotifier.Toast.remove(n),(0,ee.collectSuiteEvent)("enter_sheets_local_record",{source:"conflict_tip"})}},Se("CreationDoc_Sheets_LocalHistory.view.button"))),closable:!0,keepAlive:!0}),(0,ee.collectSuiteEvent)("sheet_conflict_save_success",{conflict_source:t?Ce.Block:Ce.Sheet,reject_type:e.rejectType}),r.sheetSdk.getService(x.qif).pushNewState({type:x.pb3.CLEAR})},this.reloadPage=function(e,t){return(0,s.Z)(a().mark((function n(){var i;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.clearBackup();case 2:if(!t){n.next=6;break}return i=r.sheetSdk.spread,n.next=6,ye(i,e,t);case 6:location.reload();case 7:case"end":return n.stop()}}),n)})))},this.showConflictImp=function(){var e=(0,s.Z)(a().mark((function e(t,n,i){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m.browser.isLark?(r.prepareConflict(n,"modal",i),r.showConflictModal(t,n)):(r.prepareConflict(n,"toast",i),r.showConflictToast(n,i));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),this.showConflictToast=function(){var e=(0,s.Z)(a().mark((function e(t,n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=3;break}return e.next=3,r.clearAndRefetchData();case 3:r.saveConflictSuccess(t,n);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.showConflictModal=function(){var e=(0,s.Z)(a().mark((function e(t,n){var i,o,u,l,c,h,d,f;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=null,u=r.sheetSdk.getService(x.AKO),e.prev=2,l=r.dataHandlers.getAnonymousEditable(),c=Re(l,n),!l){e.next=7;break}return e.abrupt("return",Ee(c,(0,s.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.clearBackup();case 2:location.reload();case 3:case"end":return e.stop()}}),e)})))));case 7:return e.next=9,be(c);case 9:if(!e.sent){e.next=19;break}return e.next=13,r.copySpreadSheet(t);case 13:h=e.sent,d=h.url,f=h.err,(0,ee.collectSuiteEvent)("click_create_sheet_copy",{source:"pop_tip",status_code:f?f.code:0}),i=d,o=f;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(2),console.error(e.t0),r.handleConflictCreateCopy(u,"",e.t0);case 25:r.handleConflictCreateCopy(u,i,o,t);case 26:case"end":return e.stop()}}),e,null,[[2,21]])})));return function(t,n){return e.apply(this,arguments)}}(),this.waitConflictResolve=(0,s.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.onWaitForConflictResolve(),!r.processingConflict){e.next=5;break}return e.abrupt("return",new Promise(function(){var e=(0,s.Z)(a().mark((function e(t,n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.conflictResolveQueue&&r.conflictResolveQueue.push(t);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 5:return r.processingConflict=!0,e.abrupt("return");case 7:case"end":return e.stop()}}),e)}))),this.releaseConflictResolve=function(){if(r.conflictResolveQueue&&r.conflictResolveQueue.length>0){var e=r.conflictResolveQueue.shift();e&&e()}r.processingConflict=!1},this.onWaitForConflictResolve=function(){r.sheetSdk.getService(N.zv).eventReport({key:"client_sheet_wait_conflict_resolve",processingConflict:Number(Boolean(r.processingConflict)),conflictResolveQueue:r.conflictResolveQueue&&r.conflictResolveQueue.length||0})},this.onConflictResolve=function(){r.sheetSdk.getService(N.zv).eventReport({key:"client_sheet_wait_conflict_resolve_fin",conflictResolveQueue:r.conflictResolveQueue&&r.conflictResolveQueue.length||0})},this.onConflictBackupState=function(e,t){r.sheetSdk.getService(N.zv).eventReport({key:"client_sheet_conflict_backup_state",backup_action_length:e&&e.length||0,is_old_version:Number(Boolean(t.isOldVersion)),reject_type:t&&t.rejectType||""})}}var t;return(0,l.Z)(e,[{key:"destroy",value:function(){this.conflictResolveQueue.length=0,this.sheetSdk={},this.dataHandlers={}}},{key:"handleConflictCreateCopy",value:function(e,t,n,r){t?(0,ne.K4)({body:this.renderCopyCreatedContent(t),title:Se("sheet.copy_created"),confirmText:Se("common.refresh"),onConfirm:this.reloadPage(e,r),closable:!1,maskClosable:!1,cancelText:""}):n&&this.createCopyFail(e,n)}},{key:"createCopyFail",value:function(e,t){var n=Se("sheet.conflict.copy_fail");String(t.code)===C.D1r.ERROR_CREATE_COPY_EXCEED_IMAGE_LIMIT&&(n=Se("sheet.create_copy.exceed_image_limit")),(0,ne.K4)({body:n,title:Se("common.prompt"),confirmText:Se("common.refresh"),onConfirm:this.reloadPage(e),closable:!1,maskClosable:!1,cancelText:"",extraButtons:J().createElement(Q.ContactUsButton,null)}),(0,ee.collectSuiteEvent)("sheet_create_copy_fail",{message:t.message,stack:t.stack,code:t.code})}},{key:"renderCopyCreatedContent",value:function(e){return J().createElement("div",null,"".concat(Se("sheet.copy_created_desc")," "),J().createElement("a",{style:{color:(0,v.getThemeColorByToken)("text-link-hover")},onClick:function(e){return function(){return(0,X.nG)(e)}}(e)},Se("sheet.copy_created_link"))," ".concat(Se("sheet.commom. period")))}},{key:"copySpreadSheet",value:(t=(0,s.Z)(a().mark((function e(t){var n,r,i,o,s,u,l,c,h,d,f,p,v,g,_,y,m,E,b,T,w,R,A,O,M,k,P,L;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.dataHandlers.getTitle(),r=this.sheetSdk.spread,i=this.sheetSdk.getService(x.AKO),o=(0,I.NVf)(r),s=Se("sheet.conflict.copy_name",n),u=(0,te.getCreateUseNewSnapshot)(),console.log("[SHEET LOG]: fetchSnapshotV3",u),e.prev=7,!u){e.next=36;break}return d=(0,I.tN4)(r.toJSON()),f=t.blockTimeStamp?se:oe,e.next=13,f(d,r);case 13:if(e.t0=e.sent,e.t0){e.next=16;break}e.t0={};case 16:return p=e.t0,v=p.blockInfos,g=p.mutationMap,_=(0,C.ivc)(JSON.stringify(v)),y=r.encodeCommandsMap(g),m=g[C.B2l.CommandType.CommandType_TABLE_SNAPSHOT],E=null===(c=m.commands)||void 0===c?void 0:c.map((function(e){var t;if(null!==(t=e.mutations)&&void 0!==t&&t.length)return e.sheetId})).filter((function(e){return e})),b={},r.sheets.forEach((function(e){-1!==(null==E?void 0:E.indexOf(e.id()))?b[e.id()]={cellBlockMetas:[{range:{rowStart:0,rowEnd:e.getRowCount(),colStart:0,colEnd:e.getColumnCount()},blockId:"".concat(e.id(),"_").concat((0,C.zsn)(10))}]}:b[e.id()]={cellBlockMetas:[]}})),T="",(0,K.default)(b)||(T=(0,C.ivc)(JSON.stringify(b))),w={},null==(R=null===(h=m.commands)||void 0===h?void 0:h.map((function(e){return{commands:[e]}})))||R.forEach((function(e){var t,n,i=((null===(t=b[e.commands[0].sheetId])||void 0===t||null===(n=t.cellBlockMetas)||void 0===n?void 0:n[0])||{}).blockId;w[i]=r.encodeCommands(e)})),A=JSON.stringify({gzipTopSnapshot:y[C.B2l.CommandType.CommandType_TOP_SNAPSHOT],gzipResource:y[C.B2l.CommandType.CommandType_RESOURCE_SNAPSHOT],gzipBlockMeta:T,blockInfos:_,blocks:w}),e.next=33,this.dataHandlers.createSheetWithSnapshotV3(s,A,o);case 33:l=e.sent,e.next=48;break;case 36:return O=(0,I.tN4)(r.toJSON()),M=t.blockTimeStamp?se:oe,e.next=40,M(O,r);case 40:if(e.t1=e.sent,e.t1){e.next=43;break}e.t1={};case 43:return k=e.t1,P=k.blockInfos,e.next=47,this.dataHandlers.createSpreadsheet(s,O,P,o);case 47:l=e.sent;case 48:return(0,ee.collectSuiteEvent)("create_new_objs",{create_file_type:"sheet",create_source:"offline_conflict",create_file_id:l}),e.next=51,i.clearBackup();case 51:return e.next=53,ye(r,i,t);case 53:return e.abrupt("return",{url:(0,I.zi$)(l),err:null});case 56:return e.prev=56,e.t2=e.catch(7),console.error(e.t2),String(e.t2.code)===C.D1r.ERROR_CREATE_LIMITATION&&(null===(L=this.sheetSdk.getPlugin(S.IEf))||void 0===L||L.reload(C.Hg0.genSpecTid(C.$UQ.CONFLICT)),this.sheetSdk.getService(x.qif).pushNewState({type:x.pb3.CLEAR}),this.sheetSdk.getService(N.Tl).record(N.FP.Module,N.NI.ServerError,N.jK.ERROR_CREATE_LIMITATION,null)),e.next=62,i.clearBackup();case 62:return(0,ee.collectSuiteEvent)("show_create_copy_fail_tip"),e.abrupt("return",{url:"",err:e.t2});case 64:case"end":return e.stop()}}),e,this,[[7,56]])}))),function(e){return t.apply(this,arguments)})},{key:"uiNotifier",get:function(){return this.sheetSdk.getService(S.OGo)}},{key:"reporterService",get:function(){return this.sheetSdk.getService(N.zv)}}]),e}();function Re(e,t){var n=Se("sheet.sync_conflict_tip_content");return e&&(n=Se("sheet.anonyconflict.tips")),t&&t.isOldVersion&&(n=Se("sheet.version_too_old")),n}var Ae,Oe=n("vsh_4005"),Me=n("vsh_18653"),ke=n("vsh_65593"),Ie=n("vsh_73043");function xe(){(0,Y.ex)(),(0,U.Ti)()}!function(e){e.PluginEvent="PluginEvent",e.SpreadEvent="SpreadEvent",e.ContextEvent="ContextEvent",e.ServiceEvent="ServiceEvent"}(Ae||(Ae={}));var Ne=function(){function e(t,n){var r=this;(0,u.Z)(this,e),this.token=t,this.options=n,this.serviceSubscription=new g.w,this.pluginSubscription=new g.w,this.spreadSubscription=new g.w,this.contextSubscription=new g.w,this.fakeToolbarClickCount=0,this.onHybridResourceDataInit=(0,c.Z)((function(){r.collaborativeSpread.sdk.getService(S.OGo).Toast.show({key:"clientVars_from_hybrid_deploy",type:"loading",content:Ie("CreationDoc_Operation_ReloadfromThirdParty"),duration:2e3})})),this.spreadSheetObservableVars=(0,D.eE)(),this.dataLoaderObservableVars=(0,D.ZD)(),this.hasRunning=!1,this.windowOnloadEvent=function(e){e.isTrusted&&(r.collectLoadTime(),window.removeEventListener("load",r.windowOnloadEvent))},this.checkDocumentKeyDeleted=function(e){var t;String(e.code)!==C.D1r.ERROR_PASSPORT_DELETED&&String(null===(t=e.data)||void 0===t?void 0:t.code)!==C.D1r.ERROR_PASSPORT_DELETED||(0,m.handleCommonKeyInvalid)()},this.freezeSpread=function(){(0,Me.JA)(_.store,!0),(0,U.$y)(Ie("sheet.forzen_refresh")),(0,Me.Fr)(_.store,!1)},this.updateSheetState=function(){var e=r.collaborativeSpread,t=e.spread,n=e.sdk,i=e.shell,o=t.getActiveSheet(),a=Boolean(o&&o.blockId),s=n.getPlugin(S.IEf);t.blockManager&&t.blockManager.fasterManager.switchBlockType(a?o.blockType:C.kHU.SHEET_BLOCK),r.refreshPermission(!1),o&&!a&&(null!=s&&s.isSpreadLoaded()||null!=s&&s.isSheetLoaded(o.id())||r.options.defaultRangeId||(0,U.ip)(Ie("sheet.still_loading_tips")),i.sheet!==o&&(n.mountSheet(o,i,r.appHost),i.sheetView().addFPSLog(C.EEh.SWITCHTAB)),r.options.defaultRangeId||0!==o.getSelections().length||o.setSelection(new I.e6w(0,0,1,1,o),void 0,"init"))},this.onReceiveRecover=function(){r.collaborativeSpread&&r.collaborativeSpread.destroy(!0)},this.refreshPermission=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];xe(),r.refreshFrozenStatus();var t=(0,W.editableWithSheetPermissionSelector)(_.store.getState());r.collaborativeSpread.setEditable(t),r.collaborativeSpread.shell.setEditable(t),e&&setTimeout((function(){var e;r.collaborativeSpread.sdk&&((0,T.o_)(r.collaborativeSpread.sdk),null===(e=r.collaborativeSpread.sdk.getPlugin("CellEditorPlugin"))||void 0===e||e.focus())}))},this.refreshFrozenStatus=function(){var e=r.collaborativeSpread,t=e.spread,n=e.sdk,i=n.getPlugin(S.IEf),o=n.getService(x.AKO),a=(0,v.isShortCut)()?null==i?void 0:i.isContentMetaDataApplied():(null==i?void 0:i.isSheetLoaded(t.getActiveSheet().id()))||(null==i?void 0:i.isSpreadLoaded()),s=o.isBackingUp||r.localSaveManager.disableOfflineEdit||r.localSaveManager.freezeByWatchdog||!o.isConsistency||!a;return(0,Me.JA)(_.store,s),s},this.onWorksheetLoaded=function(e,t){t&&r.refreshPermission(),r.updatePermissionPlugin()},this.onReloadStart=function(e,t){r.dataLoaderObservableVars.stateMaps$["LoadStatusStore/ReloadStart"].next([e,t])},this.handleClientVarsReady=function(e,t){r.dataLoaderObservableVars.stateMaps$["LoadStatusStore/ClientVarsMessageValid"].next([e,t]),r.removeHybridResourceTip()},this.handleClientVarsError=function(e,t){r.dataLoaderObservableVars.stateMaps$["LoadStatusStore/ClientVarsMessageInvalid"].next([e,t]),r.checkDocumentKeyDeleted(e),r.removeHybridResourceTip(),r.spreadSheetObservableVars.spreadLoading.next(!1)},this.handleSubBlockStillLoading=function(){xe(),(0,U.ip)(Ie("sheet.subblock_still_loading"))},this.removeHybridResourceTip=function(){r.collaborativeSpread.sdk.getService(S.OGo).Toast.remove("clientVars_from_hybrid_deploy")},this.handleVersionCreateFailed=function(e){var t,n=r.collaborativeSpread.sdk.getService(S.OGo);t=_.COPY_ERROR_CODE_MAP[e]?_.COPY_ERROR_CODE_MAP[e].description:Ie("LarkCCM_Sheets_VersionMgmt_SaveFail_CurrentCopyNA_Toast"),n.Modal.show({title:Ie("LarkCCM_Sheets_VersionMgmt_SaveFailed_Toast"),body:t,confirmText:Ie("CreationDoc_Sheets_BeAwared"),cancelText:!1,closable:!1,maskClosable:!1,onConfirm:function(){_.store.dispatch({type:y.actionTypes.version.REMOTE_DELETE_VERSION,payload:{versionToken:r.token,objType:y.NUM_SUITE_TYPE.SHEET}})}})},this.handleAsyncCopyInfo=function(e){var t=r.collaborativeSpread.sdk.getService(S.OGo),n=(0,F.XU)();switch(e.status){case C.brm.fail:t.Toast.remove("CreationDocs_Sheets_MakeCopyingWait_Toast"),_.noticeMsgHandler.deregister();var i=e.errorCode||"";if(n){r.handleVersionCreateFailed(i);break}var o,a=_.COPY_ERROR_CODE_MAP;o=a[i]?a[i].description:Ie("CreationDocs_Sheets_MakeCopyFailedWillDelete_Text"),t.Modal.show({title:Ie("CreationDocs_Sheets_MakeCopyFailed_Tittle"),body:o,confirmText:Ie("CreationDoc_Sheets_BeAwared"),cancelText:!1,closable:!1,maskClosable:!1,onConfirm:function(){window.close()}}),n&&_.store.dispatch((0,b.updateProcessStatus)(!1));break;case C.brm.wait:n&&_.store.dispatch((0,b.updateProcessStatus)(!0)),t.Toast.show({key:"CreationDocs_Sheets_MakeCopyingWait_Toast",type:"loading",content:Ie(n?"LarkCCM_Sheets_VersionMgmt_SavingVersion_Toast":"CreationDocs_Sheets_MakeCopyingWait_Toast"),duration:0,closable:!1});break;case C.brm.success:t.Toast.remove("CreationDocs_Sheets_MakeCopyingWait_Toast"),n&&_.store.dispatch((0,b.updateProcessStatus)(!1));break;default:console.error("AsyncCopySheet Error"),n&&_.store.dispatch((0,b.updateProcessStatus)(!1))}},this.showClipboardPermissionModal=function(e){var t;(0,O.U)(Object.assign({focusOnSheet:null===(t=r.collaborativeSpread.sdk.getPlugin(S.$LI))||void 0===t?void 0:t.setFocus},e))},this.handleErrorRecordServiceException=function(){var e=(0,s.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.code,i=t.data,e.t0=n,e.next=e.t0===N.jK.ERR_OLD_VERSION?4:e.t0===N.jK.ERR_CLIENT_FOLLOW_REJECT||e.t0===N.jK.ERR_SERVER_REJECT_COMMIT||e.t0===N.jK.ERR_SERVER_RECOVER?5:e.t0===N.jK.ERR_SERVER_RETRY_FAILED?7:e.t0===N.jK.ERR_SERVER_CONTENT_RESPONSE_ERROR?10:13;break;case 4:return e.abrupt("return",r.onLocalVersionTooOldConflict(t));case 5:return r.onReceiveConflict(i),e.abrupt("return");case 7:return String(i.code)===N.jK.ERR_LOCK_FAILED_FOR_CACHE_CALC&&r.onReceiveConflict({rejectType:C.KNj.FOLLOW_CALC_PENDING}),e.abrupt("return");case 10:return String(i.code)===N.jK.ERR_OLD_VERSION&&r.onReceiveConflict({rejectType:C.KNj.TOO_OLD_REV}),e.abrupt("return");case 13:return e.abrupt("break",14);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.onReceiveConflict=function(e){r.conflictManager.onConflict({isOldVersion:e.rejectType===C.KNj.TOO_OLD_REV,rejectType:e.rejectType})},this.onLocalVersionTooOldConflict=function(){var e=(0,s.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.collaborativeSpread.backup.checkBackupRev();case 2:if(!(e.sent>=0)){e.next=7;break}return e.next=6,r.conflictManager.onConflict({isOldVersion:!0,rejectType:C.KNj.TOO_OLD_REV});case 6:return e.abrupt("return");case 7:null===(n=r.collaborativeSpread.sdk.getPlugin(S.TVz))||void 0===n||n.noticeError(t),r.collaborativeSpread.destroy(!0);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.onFirstActiveSheetLoaded=function(e,t){var n,i;r.dataLoaderObservableVars.stateMaps$["LoadStatusStore/FirstActiveSheetLoaded"].next([e,t]),r.rebuildSelections(),r.refreshPermission(),null===(n=(i=r.collaborativeSpread.spread.getService(N.f3)).refreshActiveSheet)||void 0===n||n.call(i)},this.rebuildSelections=function(){var e=r.collaborativeSpread.getActiveSheet();e._raiseSelectionChanged(e.getSelections(),"init")},this.preCheckPermission=function(){var e=r.collaborativeSpread.spread,t=e.permissionManager,n=!!t.getAllPermissionList().size;return n||(t.userPerm.setReady(!0),t.refreshPermission(),e.dispatch(C.HaZ.PermissionReady)),n},this.onContentMetaApply=function(e){r.updateSheetState(),r.dataLoaderObservableVars.stateMaps$["LoadStatusStore/ContentMetaApply"].next([e]);var t=r.preCheckPermission();r.shell.onAfterTick((function(){if(!t){var e=document.getElementById("J-no-ssr-loading");null==e||e.remove();var n=document.getElementById("miniapp-faster");n&&(n.style.visibility="visible"),r.fakeToolbarClickCount=0;var i=document.getElementById("fake-sheet-toolbar");i&&(i.onclick=function(){r.fakeToolbarClickCount++,(0,U.eE)(Ie("LarkCCM_Common_LoadingWait_Toast"))})}})),(0,Z.Oj)(r.collaborativeSpread,r.options.defaultRangeId)},this.updatePermissionPlugin=function(){var e=r.collaborativeSpread.sdk.getPlugin("PermissionPlugin"),t=(0,Me.zH)(_.store),n=(0,Me.kE)(_.store),i=(0,Me.Vf)(_.store);e.setEditable(n),e.setSuiteEditable(t),e.setCommentable(i)},this.onSheetToUsage=function(e,t){var n=r.collaborativeSpread.sdk,i=n.getService(N.kM),o=n.getPlugin(S.IEf);i.collect(y.SHEET_LOAD_MAIN_STAGE_DURATION_LIST_KEY.RENDER_FILE_ALLOW_EDIT),i.collect(C.FHD.STAGE_PENDING,{status:C.G2P.END,start_stage:C.FHD.FETCH_SUB_BLOCK,next_stage:C.FHD.TIME_TO_USAGE}),i.collect(C.FHD.TIME_TO_USAGE,{status:C.G2P.START}),i.collect(C.FHD.TIME_TO_USAGE,Object.assign({status:C.G2P.END},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=w(),r=n.ttuTotalSize,i=n.ttuJsLoadSize,o=n.ttuCssLoadSize,a=A(e),s=a.forwardRefBlockslen,u=a.blocksLen;return Object.assign({blocks_len:u,forward_ref_blocks_len:s,is_parallel:1,validation_ref_count:(0,C.Pho)(e.spread),ttu_total_size:r,ttu_js_load_size:i,ttu_css_load_size:o,ttu_is_sheet_cache_disable:String(R()),slardar:(0,m.getCurrentSlardarType)(),afterSend:function(e){e.total_time_cost&&(0,m.slardarSendCustomPerfMetric)({name:"sheet.ttu",value:e.total_time_cost})}},t)}(n,{schema_version:null==o?void 0:o.clientVarsDataVersion}))),(0,C.vRF)(C.FHD.ALONE_HISTORY_BACK_T0_MAIN,C.G2P.END),i.collect(C.FHD.SCROLL_TO_LINK_RANGE,{status:C.G2P.START}),r.collaborativeSpread.registerEditor(),r.dataLoaderObservableVars.stateMaps$["LoadStatusStore/SheetToUsage"].next([e,t]),r.spreadSheetObservableVars.spreadLoading.next(!1),r.spreadSheetObservableVars.afterTTU$.next(!0),(0,Me.JA)(_.store,!1),r.shell._doResize()},this.onChannelStateChange=function(e){var t;if(null===(t=r.collaborativeSpread.spread.blockManager)||void 0===t||t.onChannelStateChange(e.netState),e.netState===x.Giu.online)r.refreshFrozenStatus()},this.onSpreadLoaded=function(e){r.collaborativeSpread.sdk.getService(N.kM).collect(C.FHD.LOAD_SHEET_PAGE,{status:C.G2P.END,is_parallel:1}),r.dataLoaderObservableVars.stateMaps$["LoadStatusStore/SpreadLoaded"].next([e]),r.refreshPermission()},this.setAppHostDomToSheetHost=function(e){var t;e&&(null===(t=r.collaborativeSpread.sdk.getPlugin(S.$LI))||void 0===t||t.setHost(e.id(),r.appHost||null))},this.init()}return(0,l.Z)(e,[{key:"getFakeToolbarClickCount",value:function(){return this.fakeToolbarClickCount}},{key:"bindEvents",value:function(){this.bindCollaborativeContextEvents(this.collaborativeSpread.context);var e=this.collaborativeSpread.sdk;this.bindSpreadEvent(e),this.bindPluginEvents(e),this.bindServiceEvents(e),this.localSaveManager.bindEvents()}},{key:"collectLoadTime",value:function(){var e=performance.timing,t=e.loadEventStart,n=e.navigationStart;this.collaborativeSpread.sdk.getService(N.kM).collect(C.FHD.WINDOW_LOADED,{status:C.G2P.END,costTime:t-n})}},{key:"getContextEvents",value:function(){return{context:[{key:x.YVA.FREEZE_SPREAD,handler:this.freezeSpread},{key:x.YVA.SOFT_DEL_SHEET,handler:this.updateSheetState},{key:x.YVA.RECEIVE_RECOVER,handler:this.onReceiveRecover},{key:x.YVA.RECEIVE_BLOCK_RECOVER,handler:this.onReceiveRecover}]}}},{key:"getPluginEvents",value:function(){var e;return e={},(0,i.Z)(e,"LoadStatusStore/ContentMetaApply",this.onContentMetaApply),(0,i.Z)(e,"LoadStatusStore/FirstActiveSheetLoaded",this.onFirstActiveSheetLoaded),(0,i.Z)(e,"LoadStatusStore/SheetToUsage",this.onSheetToUsage),(0,i.Z)(e,"LoadStatusStore/SpreadLoaded",this.onSpreadLoaded),(0,i.Z)(e,"LoadStatusStore/WorksheetLoaded",this.onWorksheetLoaded),(0,i.Z)(e,"LoadStatusStore/ReloadStart",this.onReloadStart),(0,i.Z)(e,"LoadStatusStore/ClientVarsSubBlockLoading",this.handleSubBlockStillLoading),(0,i.Z)(e,"LoadStatusStore/ClientVarsMessageValid",this.handleClientVarsReady),(0,i.Z)(e,"LoadStatusStore/ClientVarsMessageInvalid",this.handleClientVarsError),(0,i.Z)(e,"LoadStatusStore/HybridResourceDataInit",this.onHybridResourceDataInit),(0,i.Z)(e,"LoadStatusStore/AsyncCopySheet",this.handleAsyncCopyInfo),(0,i.Z)(e,"PasteStore/ShowClipboardPermissionModal",this.showClipboardPermissionModal),e}},{key:"bindCollaborativeContextEvents",value:function(e){var t,n=this.getContextEvents();n.context.forEach((function(t){e.bind(t.key,t.handler)})),this.contextSubscription||(this.contextSubscription=new g.w),null===(t=this.contextSubscription)||void 0===t||t.add((function(){n.context.forEach((function(t){e.unbind(t.key,t.handler)}))}))}},{key:"bindSpreadEvent",value:function(e){var t,n,r=this;e.spread.bind(C.zW2.BitableBlockRejectCommit,this.conflictManager.onConflictFromBlock),this.spreadSubscription||(this.serviceSubscription=new g.w),null===(t=this.spreadSubscription)||void 0===t||t.add(new g.w((function(){e.spread.unbind(C.zW2.BitableBlockRejectCommit,r.conflictManager.onConflictFromBlock)}))),null===(n=this.spreadSubscription)||void 0===n||n.add(e.spread.subscribe(C.HaZ.ActiveSheetChanged,this.updateSheetState))}},{key:"bindPluginEvents",value:function(e){var t=this.getPluginEvents();this.pluginSubscription=e.subscribePluginEventMap(t)}},{key:"bindServiceEvents",value:function(e){var t=this,n=e.getService(N.Tl),r=e.getService(x.ClJ);[n.subscribeError(this.handleErrorRecordServiceException),r.subscribeChannelState(this.onChannelStateChange)].forEach((function(e){var n;t.serviceSubscription||(t.serviceSubscription=new g.w),null===(n=t.serviceSubscription)||void 0===n||n.add(e)}))}},{key:"unbindEvent",value:function(){var e,t,n,r;null===(e=this.spreadSubscription)||void 0===e||e.unsubscribe(),this.spreadSubscription=null,null===(t=this.contextSubscription)||void 0===t||t.unsubscribe(),this.contextSubscription=null,null===(n=this.pluginSubscription)||void 0===n||n.unsubscribe(),this.pluginSubscription=null,null===(r=this.serviceSubscription)||void 0===r||r.unsubscribe(),this.serviceSubscription=null,this.localSaveManager.unbindEvents(),window.removeEventListener("load",this.windowOnloadEvent)}},{key:"resetStageTracker",value:function(){(0,C.WHH)(),(0,S.nWK)()}},{key:"initStageTracker",value:function(){var e=this.collaborativeSpread.sdk.getService(N.kM);e.collect(y.SHEET_LOAD_MAIN_STAGE_DURATION_LIST_KEY.GARR_INDEX_EXEC_START),e.collect(C.FHD.LOAD_SHEET_PAGE,{status:C.G2P.START}),e.collect(C.FHD.RENDER_SHEET_PAGE,{status:C.G2P.START}),e.collect(C.FHD.DOWNLOAD_RESOURCE,{status:C.G2P.START}),e.collect(C.FHD.DOWNLOAD_RESOURCE,{status:C.G2P.END}),e.collect(C.FHD.STAGE_PENDING,{status:C.G2P.START,start_stage:C.FHD.DOWNLOAD_RESOURCE,next_stage:C.FHD.FETCH_CLIENT_VARS}),e.collect(C.FHD.WINDOW_LOADED,{status:C.G2P.START}),performance.timing.loadEventStart?this.collectLoadTime():window.addEventListener("load",this.windowOnloadEvent)}},{key:"registerEffectShortcuts",value:function(){var e=this,t=this.collaborativeSpread.sdk.getPlugin(S.B_B);[S.hMM.CLEAR,S.hMM.PASTE,S.hMM.PASTE_FORMATS_ONLY,S.hMM.PASTE_VALUES_ONLY].forEach((function(n){null==t||t.addEffectFunction(n,e.showProtectionDisableTips,!0)}))}},{key:"showProtectionDisableTips",value:function(e,t){var n=t.getSelections();!t.protectionModel.getRangePermissions(n).hasPermission&&t._raiseInvalidOperation(C.TiA.editProtectedRange,"shortcut")}},{key:"resetProcessStatus",value:function(){(0,E.selectProcessStatus)(_.store.getState())&&_.store.dispatch((0,b.updateProcessStatus)(!1))}},{key:"destroy",value:function(){this.unbindEvent(),this.webAppIOC.unbindAll(),this.localSaveManager.destroy(),this.conflictManager.destroy(),this.dataLoaderObservableVars.reset(),this.resetProcessStatus(),this.collaborativeSpread.destroy(!1),this.appHost=void 0,this.shellHost=void 0,e.SpreadAppInstance=null,window.spreadApp=null}},{key:"createShell",value:function(e){var t;e.style.backgroundColor="var(--N00)",this.shellHost=e,this.appHost=e,this.canvasReuseSwitcher=new f.CanvasReuseSwitcher("faster-single-canvas");var n=this.collaborativeSpread.sdk,r=n.getPlugin(S.c3h).manager;return this.shell=new P.ilW(this.shellHost,r,{canvasReuseSwitcher:this.canvasReuseSwitcher,isFeed:m.browser.isFeed}),n.registerShell(this.shell),null===(t=n.getPlugin("SheetRendererPlugin"))||void 0===t||t.setActiveHostShell(this.shell),this.collaborativeSpread.shell=this.shell,this.shell}},{key:"subscribeDataLoaderPluginEvents",value:function(e){var t=this;Object.keys(e).forEach((function(n){var i=t.dataLoaderObservableVars.stateMaps$[n];if(i){var o=e[n];i.value?o.apply(void 0,(0,r.Z)(i.value)):i.subscribe((function(e){e&&o.apply(void 0,(0,r.Z)(e))})),delete e[n]}}))}},{key:"init",value:function(){var e,t,n,i,o,a;this.webAppIOC=(0,B.T)(),this.collaborativeSpread=(e=this.token,t=this.webAppIOC,n=this.options.defaultSheetId,i=this.options.preventSync,o=this.options.getClientVarsRequestExtraParams,a={preventSync:i,defaultSheetId:n,getClientVarsRequestExtraParams:o},new j.X(e,!1,{IOCConfig:{configWorksheetIOCService:V.$,configWorkbookIOCService:(0,H.f)(t)}},a)),this.collaborativeSpread.spread.getService(L.zA);var s=this.collaborativeSpread.sdk;!function(e,t){var n=(0,k.Pt)();e.registerPlugin([new S.VnT({canCopy:X.hJ,getCopyable:X.Sr}),new S.FKO,new S.jmN,new S.ieN({initFormulaOnDemand:!(0,v.isShortCut)()})].concat((0,r.Z)((0,v.isShortCut)()?[new S.AM3]:[]),[new S.dRy({requestProvider:ke.K}),new S.uzX,new S.KD,new S.qau(n),(0,G.R1)((function(){var t,n=(0,F.eN)(window.location),r=e.spread,i=r.getSheetFromId(n);return n&&i&&!i.getHiddenStatus()?n:null===(t=r.pickUnhiddenSheet(0))||void 0===t?void 0:t.id()}),m.browser.isLark&&!m.browser.isFromSuperApp()?C.AXv.runInBackground:C.AXv.onDemand),(0,G.HY)(),new M.C({readonly:!1}),new S.YM0,new S.fS9({showCollaborators:z.w,shouldTickAfterContentMeta:!0}),new S.WcQ,new S.MCw,Le(t),new S.Dvk,new S.U2$,new S.JzW,new S.sv1,new S.z7Q,C.P_e?new S.GgZ:new S.iDx])),n&&e.registerPlugin([new k.Dv,new k.HA]);e.registerPlugin(new S.Fmx({disableGridLayout:(0,v.isShortCut)(),disableShowGroup:(0,v.isShortCut)()}))}(s,this),this.conflictManager=new we(s,{getAnonymousEditable:function(){return(0,Me.Mr)(_.store)},getTitle:function(){return(0,Me.YQ)(_.store)},showHistory:function(e){return(0,Me.$$)(_.store,e)},createSpreadsheet:this.collaborativeSpread.createSpreadsheet.bind(this.collaborativeSpread),createSheetWithSnapshotV3:this.collaborativeSpread.createSheetWithSnapshotV3.bind(this.collaborativeSpread)}),this.localSaveManager=(0,Oe.G)(s,this.refreshFrozenStatus),this.spreadSheetObservableVars.collaborativeSpread.next(this.collaborativeSpread),this.bindEvents(),C.UIE.init(this.token)}},{key:"run",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.hasRunning=!0,this.spreadSheetObservableVars.spreadLoading.next(!0),e.sheetId||(e.sheetId=(0,F.eN)(window.location)),(0,d.default)(e.openType)&&(e.openType=De()),this.collaborativeSpread.switch(e,t),this.initStageTracker(),this.registerEffectShortcuts()}},{key:"checkClientVarsErrorOccurred",value:function(){var e;return!(null===(e=this.dataLoaderObservableVars)||void 0===e||!e.stateMaps$["LoadStatusStore/ClientVarsMessageInvalid"].value)}},{key:"getShell",value:function(){return this.shell}},{key:"getCanvasReuseSwitcher",value:function(){return this.canvasReuseSwitcher}},{key:"getShellHost",value:function(){return this.shellHost}},{key:"updateAppHost",value:function(e){this.appHost=e,this.setAppHostDomToSheetHost(this.collaborativeSpread.sdk.spread.getActiveSheet())}},{key:"getCollaborativeSpread",value:function(){return this.collaborativeSpread}},{key:"getWebAppIOC",value:function(){return this.webAppIOC}}]),e}();function Pe(e){var t=document.createElement("div");t.setAttribute("id","miniapp-faster");var n=document.getElementById("J-faster-single-canvas");if(n){t.style.position="fixed",t.style.visibility="hidden",t.style.width="".concat(n.clientWidth,"px"),t.style.height="".concat(n.clientHeight-33,"px"),t.style.bottom="".concat(33,"px"),t.style.zIndex="98",n.appendChild(t)}else t.style.width="100%",t.style.height="100%";var r=new Ne(e,{defaultSheetId:(0,F.eN)(window.location),defaultRangeId:(0,F.Wc)(window.location)});return r.createShell(t),r.run(),window.spreadApp=r,Ne.SpreadAppInstance=r,r}function Le(e){var t;return new S.C4Z((t={},(0,i.Z)(t,N.jK.ERR_LOCK_FAILED,(function(e,t,n){t.Toast.show({key:"__CS_SAVE_TIMEOUT__",type:"error",content:Ie("sheet.send_cs_retry_timeout"),duration:0,closable:!1})})),(0,i.Z)(t,N.jK.ERR_BACKUP_SAVE_LOCAL_FAILED,h.default),(0,i.Z)(t,N.jK.ERR_BACKUP_INCONSISTENT,h.default),(0,i.Z)(t,N.jK.ERR_BACKUP_INIT_VALIDATE_FAILED,h.default),(0,i.Z)(t,"defaultHandler",(0,U.SW)("spreadsheet",e.getCollaborativeSpread())),t),(function(){(0,Me.a7)(_.store,!0)}))}function De(e){var t=e||(0,v.getAllUrlParams)(p.Z.href);return parseInt(t.open_type||"0",10)}Ne.SpreadAppInstance=null},vsh_4005:function(e,t,n){"use strict";n.d(t,{G:function(){return R}});var r=n("vsh_98652"),i=n("vsh_67017"),o=n.n(i),a=n("vsh_35067"),s=n("vsh_19264"),u=n("vsh_4175"),l=n("vsh_69691"),c=n("vsh_18801"),h=n("vsh_98125"),d=n.n(h),f=n("vsh_52690"),p=n("vsh_24627"),v=n("vsh_75986"),g=n("vsh_74340"),_=n("vsh_82905"),y=n("vsh_18653"),m=n("vsh_50662"),E=n("vsh_73043"),b="__OFFLINE_TOAST__",T="__ONLINE_TOAST__",C="__INCONSISTENCY_TOAST__",S="__WATCHDOG_TOAST__",w=function(){function e(t,n,i,u,l,c){var h=this;(0,s.Z)(this,e),this.backupService=t,this.syncService=n,this.errorRecorderService=i,this.uiNotifierService=u,this.metaDataService=l,this.localSaveHandlers=c,this.subscription=new f.w,this._disableOfflineEdit=!1,this._freezeByWatchDog=!1,this._enableLocalErrorTip=!0,this.onChannelStateChange=function(e){var t=[],n=!1;function i(){if(t.length>0){n=!0;var o=t.shift();e.apply(void 0,(0,r.Z)(o)).finally(i)}else n=!1}return function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];t.push(r),n||i()}}(function(){var e=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h.localSaveHandlers.getOfflineTipsEnable()){e.next=2;break}return e.abrupt("return");case 2:e.t0=t.netState,e.next=e.t0===g.Giu.online?5:e.t0===g.Giu.offline?14:17;break;case 5:return h._disableOfflineEdit&&(h._disableOfflineEdit=!1),e.next=8,h.backupService.checkBackupRev();case 8:if(e.t1=e.sent,e.t1){e.next=11;break}e.t1=-1;case 11:return e.t1>=0?h.uiNotifierService.Toast.show({key:b,type:"success",content:E("common.reconnected_tips"),duration:3e3}):h.uiNotifierService.Toast.remove(b),e.abrupt("break",17);case 14:return h.uiNotifierService.Toast.remove(b),h.uiNotifierService.Toast.show({key:b,type:"info",content:E("LarkCCM_Docs_EditOfflineTurnOffIncognito_Toast"),duration:0,closable:!0}),e.abrupt("break",17);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.handleMsgFromBackupChannel=function(e){if(e.type===g.ZL1.CompletingBackup)h.backupService.completingBackup();else if(h.syncService.getConnectState().netState===g.Giu.offline&&!h._disableOfflineEdit){var t=h.metaDataService,n=t.token,r=t.memberId,i=e.data,o=i.memberId;i.token===n&&h.localSaveHandlers.getEditable()&&o!==r&&(h._disableOfflineEdit=!0,h.localSaveHandlers.onSaveStateChange({isConsistency:h.backupService.isConsistency,isBackingUp:h.backupService.isBackingUp,isBackupError:h.backupService.isBackupError,isOfflineMultiEdit:!0}),h.uiNotifierService.Toast.show({key:b,type:"error",content:E("common.offline.disable_multi_edit"),duration:0,closable:!0}))}},this.handleBackingUpStatusChanged=function(e){h.localSaveHandlers.onSaveStateChange({isConsistency:h.backupService.isConsistency,isBackingUp:e,isBackupError:h.backupService.isBackupError,isOfflineMultiEdit:!1})},this.handleInconsistency=function(e){e.isConsistency||(h.localSaveHandlers.onSaveStateChange({isConsistency:!1,isBackingUp:h.backupService.isBackingUp,isBackupError:h.backupService.isBackupError,isOfflineMultiEdit:!1}),h.uiNotifierService.Toast.show({key:C,type:"error",content:E("common.offline.not_consistency"),duration:0,closable:!1}))},this.onOnlineSaveLocalErrorResume=function(){h.uiNotifierService.Toast.remove(T)},this.onSaveLocalEnableChanged=function(e){e&&h.onOnlineSaveLocalErrorResume()},this.handleErrorRecordServiceException=function(e){var t=e.code,n=e.data;if(t!==_.jK.ERR_BACKUP_SAVE_LOCAL_FAILED)if(t!==_.jK.ERR_BACKUP_INCONSISTENT){if((0,p.YF0)(t))h.onConflict();else if(h.localSaveHandlers.needHandleWatchdog()){if(t===_.jK.ERROR_WATCH_DOG_ALERT)return void h.handleWatchDogAlert();if(t===_.jK.ERROR_WATCH_DOG_DONE)return void h.handleWatchDogDone()}}else h.handleInconsistency(n);else n.isOnline?h.onOnlineSaveLocalError(n.isQuotaExceeded):h.onOfflineSaveLocalError()},this.onConflict=function(){h.uiNotifierService.Toast.remove(b),h.uiNotifierService.Toast.remove(T)},this.onOfflineSaveLocalError=function(){h.uiNotifierService.Toast.show({key:b,type:"error",content:E("common.save_local_error"),duration:0,closable:!1}),h.localSaveHandlers.onSaveError()},this.onOnlineSaveLocalError=function(e){if(h._enableLocalErrorTip){var t=E(e?"common.online_save_local_exceeded_error":"LarkCCM_Sheets_CacheErrorDetected_Toast"),n=d().createElement("div",{className:"toast-operation"},t);h.uiNotifierService.Toast.show({key:T,type:"info",content:n,duration:0,closable:!0})}}}return(0,u.Z)(e,[{key:"bindEvents",value:function(){var e=this;this.backupService.getBackupChannelInstance().addEventListener("message",this.handleMsgFromBackupChannel),[this.backupService.subscribeBackingUp(this.handleBackingUpStatusChanged),this.backupService.subscribeBackupSaveLocalEnable(this.onSaveLocalEnableChanged),this.errorRecorderService.subscribeError(this.handleErrorRecordServiceException),this.syncService.subscribeChannelState(this.onChannelStateChange)].forEach((function(t){var n;e.subscription||(e.subscription=new f.w),null===(n=e.subscription)||void 0===n||n.add(t)}))}},{key:"unbindEvents",value:function(){var e;this.backupService.getBackupChannelInstance().removeEventListener("message",this.handleMsgFromBackupChannel),null===(e=this.subscription)||void 0===e||e.unsubscribe(),this.subscription=null}},{key:"handleWatchDogAlert",value:function(){this._freezeByWatchDog=!0,this.localSaveHandlers.onWatchdogEvent(),this.uiNotifierService.Toast.show({key:S,type:"warning",content:d().createElement("div",null,d().createElement("span",null,E("LarkCCM_Sheets_SaveError_Over5min_Toast")),d().createElement("div",{className:"toast-operation"},d().createElement("span",{className:"tips-link",style:{display:"inline-block"},onClick:this.localSaveHandlers.onExportCSV},E("LarkCCM_Sheets_ExportCSV_Button")))),duration:0,closable:!0})}},{key:"handleWatchDogDone",value:function(){this._freezeByWatchDog=!1,this.localSaveHandlers.onWatchdogEvent(),this.uiNotifierService.Toast.remove(S)}},{key:"destroy",value:function(){var e=this;this.unbindEvents(),[b,T,C].forEach((function(t){e.uiNotifierService.Toast.remove(t)})),this.uiNotifierService={},this.backupService={},this.errorRecorderService={},this.metaDataService={},this.localSaveHandlers={},this.syncService={}}},{key:"freezeByWatchdog",get:function(){return this._freezeByWatchDog}},{key:"disableOfflineEdit",get:function(){return this._disableOfflineEdit}}]),e}();function R(e,t){var n=e.getService(g.AKO),r=e.getService(g.AHm),i=e.getService(g.ClJ),o=e.getService(_.Tl),a=e.getService(v.OGo),s=e.getService(_.UU);return new w(n,i,o,a,s,{onSaveError:function(){return(0,y.JA)(c.store,!0)},onSaveStateChange:function(e){t(),console.error("local save error: ",JSON.stringify(e))},getEditable:function(){return(0,y.kE)(c.store)},getOfflineTipsEnable:function(){var t=e.spread._context.isEmbed();return!(0,l.isShortCut)()&&!t},needHandleWatchdog:function(){return!e.spread._context.isEmbed()},onWatchdogEvent:function(){return t()},onExportCSV:function(){(0,m.Bu)(r,e.spread)}})}},vsh_18653:function(e,t,n){"use strict";n.d(t,{Mr:function(){return o},YQ:function(){return a},kE:function(){return s},zH:function(){return u},Vf:function(){return l},$$:function(){return c},a7:function(){return h},JA:function(){return d},Fr:function(){return f}});var r=n("vsh_83190"),i=n("vsh_13885");function o(e){return(0,i.selectAnonymousEditable)(e.getState())}function a(e){return(0,i.titleSelector)(e.getState())}function s(e){return(0,i.editableWithSheetPermissionSelector)(e.getState())}function u(e){return(0,i.editablePermissionSelector)(e.getState())}function l(e){return(0,i.commentableSelector)(e.getState())}function c(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return e.dispatch(r.showHistory.apply(void 0,n))}function h(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return e.dispatch(r.setSheetRendered.apply(void 0,n))}function d(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return e.dispatch(r.freezeSheetToggle.apply(void 0,n))}function f(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return e.dispatch(r.toggleSheetTabSwitchingEnabled.apply(void 0,n))}},vsh_6769:function(e,t,n){"use strict";n.d(t,{X:function(){return Be}});var r=n("vsh_98652"),i=n("vsh_67017"),o=n.n(i),a=n("vsh_35067"),s=n("vsh_19264"),u=n("vsh_4175"),l=n("vsh_12064"),c=n("vsh_93035"),h=n("vsh_56589"),d=n("vsh_22462"),f=n("vsh_73455"),p=n("vsh_65498"),v=n("vsh_22485"),g=n("vsh_69691"),_=n("vsh_60591"),y=n("vsh_92292"),m=n("vsh_52690"),E=n("vsh_18801"),b=n("vsh_12484"),T=n("vsh_22488"),C=n("vsh_96579"),S=n("vsh_38105"),w=n("vsh_45003"),R=n("vsh_65593"),A=n("vsh_70231"),O=n("vsh_18088"),M=n("vsh_74561"),k=n("vsh_65981"),I=n("vsh_24627"),x=n("vsh_30964"),N=n("vsh_22233"),P=n("vsh_73043"),L=function(e){function t(e){return(0,s.Z)(this,t),(0,l.Z)(this,(0,d.Z)(t).call(this,e))}return(0,f.Z)(t,e),(0,u.Z)(t,[{key:"getHookCreator",value:function(){var e;return e={},(0,M.Z)(e,"".concat(I.Jfb,"_").concat(I.rvF.ADD_ROW_AND_COL),this.getAddRowAndColHook),(0,M.Z)(e,"".concat(I.Jfb,"_").concat(I.rvF.SET_ROW_COL_CHANGE),this.getSetRowColChangeHook),e}},{key:"getAddRowAndColHook",value:function(){return{beforeExecute:function(e,t){var n=t.sheetId,r=t.addRowCount,i=t.addColCount;if(null==n)return!1;var o=e.getSheetFromId(n);return null!=o&&!((o.getRowCount()+r)*(o.getColumnCount()+i)>(0,I.$$w)())},beforeExecuteFailCallback:function(e,t){var n=t.sheetId;null!=n&&(null!=e.getSheetFromId(n)&&(0,N.K4)({title:P("CreationDoc_Sheets_Tittle_ReferencFailed"),body:P("CreationDoc_Sheets_Text_AddRowsAndColumnsFailedCauzLimit",(0,I.ytD)()),confirmText:P("CreationDoc_Sheets_Button_ConfirmReferencFailed"),cancelText:!1}))}}}},{key:"getSetRowColChangeHook",value:function(){return{beforeExecute:function(e,t){var n=t.ranges,r=t.method,i=e.getActiveSheet();return"add"!==r||(0,k.rowColChangeLimit)(i,n)},beforeExecuteFailCallback:function(e,t){var n=t.ranges,r=(t.direction,e.getActiveSheet());(0,k.setRowColChangeLimitExc)(r,n)}}}}]),t}(x.TB),D=n("vsh_72834"),F=n("vsh_87322"),B=n("vsh_26215"),V=n("vsh_4167"),H=n("vsh_93766"),U=n("vsh_22955");function Z(e){_.Toast.error({content:e,duration:5e3,closable:!0})}var W,j=n("vsh_73043"),G=function(e){function t(){return(0,s.Z)(this,t),(0,l.Z)(this,(0,d.Z)(t).apply(this,arguments))}return(0,f.Z)(t,e),(0,u.Z)(t,[{key:"getHookCreator",value:function(){var e;return Object.assign({},(0,h.Z)((0,d.Z)(t.prototype),"getHookCreator",this).call(this),(e={},(0,M.Z)(e,"".concat(H.C,"_").concat(U.B.MERGE),this.createUIMergeCellOperationHook),(0,M.Z)(e,"".concat(F.W,"_").concat(I.rvF.MERGE_CELLS),this.createUIMergeCellOperationHook),(0,M.Z)(e,"".concat(B.mv,"_").concat(V._.delete),this.createDeleteSheetHook),(0,M.Z)(e,"".concat(I.Jfb,"_").concat(I.rvF.SORT_RANGE),this.createSortHook),(0,M.Z)(e,"".concat(I.Jfb,"_").concat(I.rvF.MOVE_RANGE),this.createDragDropRangeHook),e))}},{key:"createDeleteRowOrColumnHook",value:function(){return Object.assign({},(0,h.Z)((0,d.Z)(t.prototype),"createDeleteRowOrColumnHook",this).call(this),{beforeExecuteFailCallback:function(e,t){Z(t.type===D.NHZ.ROW?j("CreationDoc_Sheets_form.cannotdeleterow"):j("CreationDoc_Sheets_form.cannotdeletecolumn"))}})}},{key:"createMergeCellHook",value:function(){return Object.assign({},(0,h.Z)((0,d.Z)(t.prototype),"createMergeCellHook",this).call(this),{beforeExecuteFailCallback:function(){Z(j("CreationDoc_Sheets_form.CombineFailed"))}})}},{key:"createUIMergeCellOperationHook",value:function(){return{beforeExecute:function(e,t){return!t.data||!t.data.isMergable||!(0,x.IL)(e)},beforeExecuteFailCallback:function(){Z(j("CreationDoc_Sheets_form.CombineFailed"))}}}},{key:"createPasteHook",value:function(){return Object.assign({},(0,h.Z)((0,d.Z)(t.prototype),"createPasteHook",this).call(this),{beforeExecuteFailCallback:function(){Z(j("CreationDoc_Sheets_form.CutFailed"))}})}},{key:"createDeleteSheetHook",value:function(){return Object.assign({},(0,h.Z)((0,d.Z)(t.prototype),"createDeleteSheetHook",this).call(this),{beforeExecuteFailCallback:function(){Z(j("CreationDoc_Sheets_form.cannotdelete"))}})}},{key:"createSortHook",value:function(){return{beforeExecute:function(e,t){return!(0,D.l7q)(t.target,e)},beforeExecuteFailCallback:function(){Z(j("CreationDoc_Sheets_form.SortFailed"))}}}},{key:"createDragDropRangeHook",value:function(){return{beforeExecute:function(e,t){var n=t.fromColumn,r=t.fromRow,i=t.columnCount,o=t.rowCount;return!(0,D.l7q)({rowFrom:function(){return r},rowCount:function(){return o},colFrom:function(){return n},colCount:function(){return i}},e)},beforeExecuteFailCallback:function(){Z(j("CreationDoc_Sheets_form.CutFailed"))}}}}]),t}(x.yv),z=n("vsh_75986"),Y=n("vsh_73043"),X=function(e){function t(e,n){var r;return(0,s.Z)(this,t),(r=(0,l.Z)(this,(0,d.Z)(t).call(this,e))).sdk=n,r}return(0,f.Z)(t,e),(0,u.Z)(t,[{key:"getHookCreator",value:function(){var e;return Object.assign({},(0,h.Z)((0,d.Z)(t.prototype),"getHookCreator",this).call(this),(e={},(0,M.Z)(e,"".concat(H.C,"_").concat(U.B.HYPERLINK),this.createHyperLinkHook),(0,M.Z)(e,"".concat(I.Jfb,"_").concat(I.rvF.ADD_REMINDER),this.createAddReminderHook),e))}},{key:"createAddReminderHook",value:function(){var e=this;return{onExecuteSuccess:function(t,n){(0,D.Xy9)({action:I.Fh1.ADD_REMINDER,source:n.source});var r=n.selections,i=n.sheetId;if(i&&0!==r.length&&!(r.length>1)){var o=r[0],a=t.getSheetFromId(i);if(a){var s=1===o.size(),u=a.isSingleSpan(o,a.getSpans(o));if(a&&(u||s)){var l=e.sdk.getPlugin("CellEditorPlugin");null==l||l.startEdit({sheet:a})}}}}}}},{key:"createHyperLinkHook",value:function(){return{beforeExecute:function(e,t){var n=t.data,r=n.row,i=n.col,o=t.sheetId;if(!o)return!0;var a=e.getSheetFromId(o);return!a||!a.getReminder(r,i)},beforeExecuteFailCallback:function(){Z(Y("CreationDoc_Sheets_Toast_ReminderNoHyperlink"))}}}}]),t}(z.npV),K=n("vsh_73043"),q=function(e){function t(e){return(0,s.Z)(this,t),(0,l.Z)(this,(0,d.Z)(t).call(this,e))}return(0,f.Z)(t,e),(0,u.Z)(t,[{key:"getHookCreator",value:function(){return(0,M.Z)({},"".concat(I.Jfb,"_").concat(I.rvF.SET_ROW_COL_VISIBLE),this.getSetRowColVisibleHook)}},{key:"getSetRowColVisibleHook",value:function(){return{beforeExecute:function(e,t){var n=t.sheetId,r=t.action,i=t.ranges;if("unhideCol"===r||"unhideRow"===r)return!0;if(!n)return!1;var o=e.getSheetFromId(n);if(!o)return!1;var a="hideRow"===r?D.XzD.Row:D.XzD.Col;return!(0,D.gfB)(o,i,a)},beforeExecuteFailCallback:function(e,t){var n=t.action;"unhideCol"!==n&&"unhideRow"!==n&&Z(K("hideRow"===n?"LarkCCM_Sheets_InDocs_HideRowError_Text":"LarkCCM_Sheets_InDocs_HideColumnError_Text"))}}}}]),t}(x.TB),$=n("vsh_73043"),J=function(e){function t(){return(0,s.Z)(this,t),(0,l.Z)(this,(0,d.Z)(t).apply(this,arguments))}return(0,f.Z)(t,e),(0,u.Z)(t,[{key:"getHookCreator",value:function(){var e;return Object.assign({},(0,h.Z)((0,d.Z)(t.prototype),"getHookCreator",this).call(this),(e={},(0,M.Z)(e,"".concat(H.C,"_").concat(U.B.MERGE),this.createUIMergeCellOperationHook),(0,M.Z)(e,"".concat(F.W,"_").concat(I.rvF.MERGE_CELLS),this.createUIMergeCellOperationHook),(0,M.Z)(e,"".concat(I.Jfb,"_").concat(I.rvF.SORT_RANGE),this.createSortHook),(0,M.Z)(e,"".concat(I.Jfb,"_").concat(I.rvF.MOVE_RANGE),this.createDragDropRangeHook),(0,M.Z)(e,"".concat(I.Jfb,"_").concat(I.rvF.MOVE_ROW_COL),this.createMoveRowOrColHook),(0,M.Z)(e,"".concat(I.Jfb,"_").concat(I.rvF.ADD_OR_DELETE_CELL),this.createAddOrDeleteCellHook),e))}},{key:"createAddOrDeleteRowOrColumnHook",value:function(){return Object.assign({},(0,h.Z)((0,d.Z)(t.prototype),"createAddOrDeleteRowOrColumnHook",this).call(this),{beforeExecuteFailCallback:function(e,t){var n=t.method,r=t.type;Z(n===D.Dx_.DEL?r===D.NHZ.ROW?$("LarkCCM_Sheets_DataConnect_Error_DeleteHeaderRow_Toast"):$("LarkCCM_Sheets_DataConnect_Error_DeleteSyncedColumn_Toast"):r===D.NHZ.ROW?$("LarkCCM_Sheets_DataConnect_Error_InsertRowAbove_Toast"):$("LarkCCM_Sheets_DataConnect_Error_InsertColumnInside_Toast"))}})}},{key:"createMergeCellHook",value:function(){return Object.assign({},(0,h.Z)((0,d.Z)(t.prototype),"createMergeCellHook",this).call(this),{beforeExecuteFailCallback:function(){Z($("LarkCCM_Sheets_DataConnect_Error_MergeSyncedCell_Toast"))}})}},{key:"createUIMergeCellOperationHook",value:function(){return{beforeExecute:function(e,t){var n=t.sheetId;return!!n&&(!(t.data&&t.data.isMergable&&(0,z.Qhw)(e,n))||!(0,z.stD)(e))},beforeExecuteFailCallback:function(){Z($("LarkCCM_Sheets_DataConnect_Error_MergeSyncedCell_Toast"))}}}},{key:"createSortHook",value:function(){return{beforeExecute:function(e,t){var n=t.sheetId;return!!n&&(!(0,z.Qhw)(e,n)||!(0,z.YGW)(e,t.target,n))},beforeExecuteFailCallback:function(){Z($("LarkCCM_Sheets_DataConnect_Error_SortHeaders_Toast"))}}}},{key:"createDragDropRangeHook",value:function(){return{beforeExecute:function(e,t){var n=t.sheetId,r=t.fromRow,i=t.fromCol,o=t.rowCount,a=t.colCount,s=t.toRow,u=t.toCol;if(!n)return!1;if(!(0,z.Qhw)(e,n))return!0;var l=e.getSheetFromId(n);if(!l)return!1;var c,h=l.getRowCount();c=l.getColumnCount()===a?new D.lq$(r,o,l):h===o?new D.rvb(i,a,l):new D.e6w(r,i,o,a,l);var d=(0,z.QpK)(e,s,u,n);return!(0,z.YGW)(e,c,n)&&!d},beforeExecuteFailCallback:function(e,t){var n=t.rowCount,r=t.colCount,i=t.sheetId,o=t.toRow,a=t.toCol,s=e.getSheetFromId(i);if(s){var u=s.getRowCount(),l=s.getColumnCount(),c=(0,z.QpK)(e,o,a,i);Z($(c?"LarkCCM_Sheets_DataConnect_Error_MoveHere_Toast":l===r?"LarkCCM_Sheets_DataConnect_Error_MoveSyncedRow_Toast":u===n?"LarkCCM_Sheets_DataConnect_Error_MoveSyncedColumn_Toast":"LarkCCM_Sheets_DataConnect_Error_MoveHere_Toast"))}}}}},{key:"createMoveRowOrColHook",value:function(){return{beforeExecute:function(e,t){var n=t.sheetId,r=t.sourceRg,i=t.targetRg;return!!n&&(!(0,z.Qhw)(e,n)||!(0,z.YGW)(e,r,n)&&!(0,z.YGW)(e,i,n))},beforeExecuteFailCallback:function(e,t){var n=t.sourceRg,r=t.sheetId;return(0,z.YGW)(e,n,r)?n.rgType===I.xj7.ROW?Z($("LarkCCM_Sheets_DataConnect_Error_MoveSyncedRow_Toast")):Z($("LarkCCM_Sheets_DataConnect_Error_MoveSyncedColumn_Toast")):Z($("LarkCCM_Sheets_DataConnect_Error_MoveHere_Toast"))}}}},{key:"createAddOrDeleteCellHook",value:function(){return{beforeExecute:function(e,t){var n=t.sheetId,r=t.sourceRange,i=t.targetRange,o=t.type;if(!n)return!1;if(!(0,z.Qhw)(e,n))return!0;var a="add"===o?r:i;return!(0,z.YGW)(e,a,n)},beforeExecuteFailCallback:function(e,t){var n=t.type;return Z($("add"===n?"LarkCCM_Sheets_DataConnect_Error_InsertCellInside_Toast":"LarkCCM_Sheets_DataConnect_Error_DeleteSyncedCell_Toast"))}}}}]),t}(z.yOL),Q=n("vsh_83190"),ee=n("vsh_25285"),te=n("vsh_94920"),ne=n("vsh_46110"),re=n("vsh_17444"),ie=n("vsh_74340"),oe=n("vsh_82905"),ae=n("vsh_33058"),se=n("vsh_76197"),ue=n("vsh_46162"),le=n("vsh_38588"),ce=n("vsh_97237"),he=n("vsh_4644"),de=(W={},(0,M.Z)(W,I.xj7.ROW,"row"),(0,M.Z)(W,I.xj7.COL,"col"),(0,M.Z)(W,"both","all"),(0,M.Z)(W,"null",null),W),fe=function(e){return Math.max.apply(Math,[0].concat((0,r.Z)(e.map((function(e){return e.level})))))},pe=function(e,t,n){var r=e.type===I.xj7.ROW?e.rowCount:e.colCount;I.Ps3.collectSheetEvent("ccm_sheet_content_page_click",{click:"create_group",group_type:de[e.type],include_num:r,include_max_row_layers:fe(t.rowOutlineTree),include_max_col_layers:fe(t.colOutlineTree),action_type:n,target:""})},ve=function(e,t,n){I.Ps3.collectSheetEvent("ccm_sheet_content_page_click",{click:"delete_single_group",action_type:t,group_type:de[e],include_max_row_layers:fe(n.rowOutlineTree),include_max_col_layers:fe(n.colOutlineTree),target:""})},ge=function(e,t,n){I.Ps3.collectSheetEvent("ccm_sheet_content_page_click",{click:"delete_multi_group",action_type:t,group_type:de[e],include_max_row_layers:fe(n.rowOutlineTree),include_max_col_layers:fe(n.colOutlineTree),target:""})},_e=function(e,t,n){var r=n.getEntireMatchOutlines(e);if(0!==r.length){var i=fe(r),o=e.type===I.xj7.ROW?e.rowCount:e.colCount;I.Ps3.collectSheetEvent("ccm_sheet_content_page_click",{click:"collapse_single_group",action_type:t,group_type:de[e.type],include_num:o,group_layer:i,include_max_row_layers:fe(n.rowOutlineTree),include_max_col_layers:fe(n.colOutlineTree)})}},ye=function(e,t,n){I.Ps3.collectSheetEvent("ccm_sheet_content_page_click",{click:"collapse_multi_group",action_type:t,group_type:de[e],include_max_row_layers:fe(n.rowOutlineTree),include_max_col_layers:fe(n.colOutlineTree)})},me=function(e,t,n){var r=n.getEntireMatchOutlines(e);if(0!==r.length){var i=fe(r),o=e.type===I.xj7.ROW?e.rowCount:e.colCount;I.Ps3.collectSheetEvent("ccm_sheet_content_page_click",{click:"expand_single_group",action_type:t,group_type:de[e.type],include_num:o,group_layer:i,include_max_row_layers:fe(n.rowOutlineTree),include_max_col_layers:fe(n.colOutlineTree)})}},Ee=function(e,t,n){I.Ps3.collectSheetEvent("ccm_sheet_content_page_click",{click:"expand_multi_group",action_type:t,group_type:de[e],include_max_row_layers:fe(n.rowOutlineTree),include_max_col_layers:fe(n.colOutlineTree)})},be=function(e,t){I.Ps3.collectSheetEvent("ccm_sheet_group_menu_view",{view_type:t,multi_group_menu_type:de[e]})},Te=function(e){if(3===e.obj_type)return"201"===e.status?E.multiGeoTipManager.start(e.token):"203"===e.status?E.multiGeoTipManager.end(e.token):void 0},Ce=n("vsh_59980"),Se=n("vsh_96636"),we=function(){function e(t){var n=this;(0,s.Z)(this,e),this._store=t,this._status=null,this._isSuspend=!1,this.subscriber=null,this.suspend=function(){return n._isSuspend=!0,!0},this.resume=function(){n._isSuspend=!1,n.updateStatus()},this.onWorksheetLoaded=function(e,t){var r=n._spread;if(r){var i=r.getActiveSheet();i&&e===i.id()&&n.updateStatus()}},this.updateStatus=(0,Se.default)((0,a.Z)(o().mark((function e(){var t,r,i,a,s,u,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n._spread){e.next=3;break}return e.abrupt("return");case 3:if(!n.checkEmptySheet(t)&&!n._isSuspend){e.next=5;break}return e.abrupt("return");case 5:if(r=t.getActiveSheet(),i=r.getActiveColumnIndex(),a=r.getActiveRowIndex(),s=(0,k.hasFilter)(t),u=(0,k.cellStatus)(t),l=(0,k.rangeStatus)(t),(0,D.A8G)(r)){e.next=14;break}return n.updateSheetStatus({emptySheet:!1}),e.abrupt("return");case 14:n.updateSheetStatus({cellStatus:u,coord:{row:a,col:i},emptySheet:!1,isFiltered:s,rangeStatus:l}),n.updateSelectionVar(t);case 16:case"end":return e.stop()}}),e)}))),0),this.updateSelectionVar=(0,Se.default)(function(){var e=(0,a.Z)(o().mark((function e(t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,k.rangeCalcStatus)(t);case 2:(r=e.sent)&&n.updateRangeCalcStatus(r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),100),this._unsubscribe=this._store.subscribe((function(){n._status=(0,Ce.default)(t.getState(),"sheet.status",null)}))}return(0,u.Z)(e,[{key:"setSdk",value:function(e){e!==this.sdk&&(this.sdk=e,this.setSpread(e.spread))}},{key:"setSpread",value:function(e){e!==this._spread&&(this.unbindEvents(this._spread),this._spread=e,this.bindEvents(e),this.setCommandHooks(e))}},{key:"destroy",value:function(){this._unsubscribe(),this.unbindEvents(this._spread),this.removeCommandHooks(this._spread)}},{key:"getDepends",value:function(){var e;return e={},(0,M.Z)(e,I.U_F.SelectionChanged,this.updateStatus),(0,M.Z)(e,I.HaZ.ActiveSheetChanged,this.updateStatus),(0,M.Z)(e,I.HaZ.CommandExecuted,this.updateStatus),(0,M.Z)(e,I.U_F.FilterChanged,this.updateStatus),(0,M.Z)(e,I.U_F.PermissionChanged,this.updateStatus),e}},{key:"bindEvents",value:function(e){null!=e&&(this.subscriber=e.subscribe(this.getDepends()),this.sdk.subscribePluginEvent("LoadStatusStore/WorksheetLoaded",this.onWorksheetLoaded),this.subscriber=e.subscribe(this.getDepends()))}},{key:"unbindEvents",value:function(e){this.subscriber&&this.subscriber.unsubscribe(),this.subscriber=null,null!=e&&this.sdk.unsubscribePluginEvent("LoadStatusStore/WorksheetLoaded",this.onWorksheetLoaded)}},{key:"setCommandHooks",value:function(e){null!=e&&e.setHook((0,I.Ulc)(I.rvF.CLIPBOARD_PASTE),{beforeExecute:this.suspend,afterExecute:this.resume,beforeExecuteFailCallback:this.resume})}},{key:"removeCommandHooks",value:function(e){null!=e&&e.removeHook((0,I.Ulc)(I.rvF.CLIPBOARD_PASTE),{beforeExecute:this.suspend,afterExecute:this.resume,beforeExecuteFailCallback:this.resume})}},{key:"updateSheetStatus",value:function(e){this._store.dispatch((0,Q.updateSheetStatus)(e))}},{key:"updateRangeCalcStatus",value:function(e){this._store.dispatch((0,Q.updateRangeCalcStatus)(e))}},{key:"checkEmptySheet",value:function(e){if(!this._status)return!0;var t=!e||!e.getActiveSheet();return t&&this._status.emptySheet!==t&&this.updateSheetStatus({emptySheet:!0}),t}}]),e}(),Re=n("vsh_99520"),Ae=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":(0,p.Z)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Oe=function(e){function t(){return(0,s.Z)(this,t),(0,l.Z)(this,(0,d.Z)(t).apply(this,arguments))}return(0,f.Z)(t,e),(0,u.Z)(t,[{key:"getPermissionHBOption",value:function(){return(0,E.getHeartbeatsOption)()}},{key:"getEntityToken",value:function(){return(0,ce.XU)()?(0,E.getVersionParentToken)():(0,h.Z)((0,d.Z)(t.prototype),"getEntityToken",this).call(this)}},{key:"getCollaborativeMessageFilter",value:function(e){return(0,ce.XU)()?function(){return!1}:(0,h.Z)((0,d.Z)(t.prototype),"getCollaborativeMessageFilter",this).call(this,e)}}]),t}(ie._Ui);Oe=Ae([(0,Re.b)()],Oe);var Me=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":(0,p.Z)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},ke=function(e){function t(){var e;return(0,s.Z)(this,t),(e=(0,l.Z)(this,(0,d.Z)(t).apply(this,arguments))).localActionsExist=!1,e.localSubmitExist=!1,e}return(0,f.Z)(t,e),(0,u.Z)(t,[{key:"beforeSaveStore",value:function(e,n,r){if(e===ie.ysr.Actions&&(this.localActionsExist=Array.isArray(n)&&!!n.length),e===ie.ysr.Submit&&(this.localSubmitExist=null!==n),e===ie.ysr.Submit||e===ie.ysr.Actions)try{var i=this.clientMetaService,o=function(e,t){return"__sheet_need_recover_".concat(e,"_").concat(t,"__")}(i.token,i.userId);this.localActionsExist||this.localSubmitExist?window.localStorage.setItem(o,"1"):window.localStorage.setItem(o,"0")}catch(e){this.logMessage("error","set need recover flag failed ".concat(r," ").concat(null==e?void 0:e.message)),this.reporterService.captureException(e,{key:"ENGINE_SET_NEED_RECOVER_FLAG_FAILED"})}(0,h.Z)((0,d.Z)(t.prototype),"beforeSaveStore",this).call(this,e,n,r)}}]),t}(ie.Smh);ke=Me([(0,Re.b)()],ke);var Ie=n("vsh_142"),xe=n("vsh_73043"),Ne=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":(0,p.Z)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Pe=(0,z.cTx)(),Le=(0,z.IGk)(),De=E.preloadData.IOInstance;(0,Ie.t)(),(0,I.ln8)(n.e("vsh_8065").then(n.bind(n,"vsh_6257"))),"true"===(0,I.eYO)("sheet_perf_test")&&(window.SheetDep=I.Ps3),I.uXx.beginTracker(),(0,I.dgo)(),(0,z.Lxd)();var Fe=!1,Be=function(e){function t(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=arguments.length>3?arguments[3]:void 0,h=arguments.length>4?arguments[4]:void 0;(0,s.Z)(this,t),(r=(0,l.Z)(this,(0,d.Z)(t).call(this,e,n,Object.assign({canUseWorker:(0,ne.Pt)()},i),R.K,new we(E.store),{preventSync:u.preventSync},h))).jumpedReminder=!1,r.hookPlugins=[],r.openedHiddenSheetId="",r.initialized=!1,r.collaborativeSubscription=new m.w,r.onMessageRetryExceeded=function(e){r.handleSendMessageRetryExceeded(e,r.sdk.getService(ie.AKO).isBackupError,e===ie.VeS.None)},r.handleSendMessageRetryExceeded=function(e,t,n){t&&!n&&E.store.dispatch((0,Q.freezeSheetToggle)(!0))},r.init=function(){var e;if(!r.initialized){r.initialized=!0;var t=r._spread.isvRelationshipManager;t&&t.getSpreadIsExistRelationship()&&r.hookPlugins.push(new G(r._spread)),r.handleNotify(),r.openedHiddenSheetId="",(0,se.J6)((0,c.Z)(r)),null===(e=r.sdk.getPlugin(z.Fmx.pluginName))||void 0===e||e.setCollector({collectEventOnCreateGroup:pe,collectEventOnDeleteSingleGroup:ve,collectEventOnDeleteMultiGroup:ge,collectEventOnCollapseSingleGroup:_e,collectEventOnCollapseMultiGroup:ye,collectEventOnExpandSingleGroup:me,collectEventOnExpandMultiGroup:Ee,collectEventOnViewMenu:be})}},r.asyncCellNotePlugin=(0,a.Z)(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r.sdk.getPlugin("CellNoteEditorPlugin")){e.next=7;break}return e.next=5,(0,z.D00)();case 5:t=e.sent,r.sdk.registerPlugin(new t.CellNoteEditorPlugin({classSuffix:"alone-normal"}));case 7:r.initCellNoteEditorPlugin(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("[SHEET LOG]: register cell note plugin fail",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])}))),Fe&&((0,I.dgo)(),(0,z.Lxd)()),Fe=!0;var f=new A.Z(r._spread,{undoDispatcher:r._spread.undoDispatcher,onBlockDataChanged:function(e){return r.context.trigger(ie.YVA.BLOCK_DATA_CHANGED,e)},onViewChange:function(){return r.context.trigger(ie.YVA.VIEW_CHANGE)},onFieldLocalValueChange:function(){return r.context.trigger(ie.YVA.FIELD_LOCAL_VALUE_CHANGE)},onRecover:function(e,t){return r.context.trigger(ie.YVA.RECEIVE_BLOCK_RECOVER,e,t)},onTableLoaded:function(){var e;null===(e=r._spread)||void 0===e||e.trigger(I.zW2.onTableLoaded)},reduxStore:E.store});return r._spread.blockManager=f,r._spread.proxyChangeset(new S.N(r.context,r.sdk)),r.hookPlugins.push(new X(r._spread,r.sdk)),r.hookPlugins.push(new L(r._spread)),r.hookPlugins.push(new q(r._spread)),(0,ue.getDataConnectorEnable)()&&r.hookPlugins.push(new J(r._spread)),He(),r.bindCollaborativeEvents(),n&&r.registerEditor(),r}var i,p,v;return(0,f.Z)(t,e),(0,u.Z)(t,[{key:"bindCollaborativeEvents",value:function(){var e=this,t=this.sdk.getService(ie.ClJ),n=this.sdk.getPlugin("CollaborationPlugin");[t.subscribeRetryExceededMessage(this.onMessageRetryExceeded),null==n?void 0:n.subscribeDataMigrateChanged(Te)].forEach((function(t){var n;e.collaborativeSubscription||(e.collaborativeSubscription=new m.w),t&&(null===(n=e.collaborativeSubscription)||void 0===n||n.add(t))}))}},{key:"getStore",value:function(){return this.store||E.store}},{key:"initPluginService",value:function(e,t){this.sdk.injectServices((function(n){n.get(oe.Jv).setTFunc(xe),n.bind(z.OGo).to(z.OAE).inSingletonScope().onActivation((function(e,t){return t.setNotifier({Toast:_.Toast,Modal:{show:N.K4}}),t})),n.bind(oe.kM).to(oe.Oc).inSingletonScope(),n.get(oe.kM).addTrackRules([].concat((0,r.Z)(z.HHS),(0,r.Z)(z.LK9),[z.CfE,z.jEU],(0,r.Z)((0,re.n_)(T.performanceStageCollector)),(0,r.Z)((0,z.CH4)(T.performanceStageCollector)))),n.bind(ie.GbX).to(ie.xV3).inSingletonScope(),(0,ie.fq_)(n),n.bind(ie.AKO).to(ie.v7i).inSingletonScope();var i=t.preventSync?new ie.M9m:De;n.bind(ie.cAU).toConstantValue(i);var o=n.get(oe.QX);n.bind(ie.FIP).toConstantValue(ie.Q50).onActivation((function(e,t){return t.setLogger(o.log.bind(o)),t.setThreshold((0,ue.getWatchdogEventThreshold)()),t})),n.bind(ie.ClJ).to(Oe).inSingletonScope().onActivation((function(t,n){return n.setToken(e),n.setSyncOptions({apiUrls:{POST_RCE_MESSAGE:R.K.apiUrls.POST_RCE_MESSAGE,POST_USER_CHANGES:R.K.apiUrls.POST_USER_CHANGES,POST_FETCH_MISS:R.K.apiUrls.POST_FETCH_MISS},requestProvider:R.K,retryProvider:I.RdR}),n})),n.bind(ie.e2Q).to(ie.NYU).inSingletonScope().onActivation((function(e,t){return t.setMemberHelper(Object.assign({},T.memberHelper)),t})),n.bind(ie.qif).to(ie._Gk).inSingletonScope(),n.bind(ie.P_V).to(ie.Nn_).inSingletonScope(),n.bind(ie.AHm).to(ke).inSingletonScope().onActivation((function(e,t){return t.setFollowImplementation(D.cI7),t}))})),this.initClientMetaService(),this.initConfigService(t),this.sdk.getService(oe.kM).addCommonParamsCollector(O.d)}},{key:"initConfigService",value:function(e){var t=this;this.sdk.spread.calcEngine.markDirtyCacheOptimize=(0,ue.getSheetDirtyRangeCacheOptimize)(),this.sdk.getService(oe.tb).register({engineMaxChangesetActionCount:function(){return(0,ue.getChangesetPayloadLimit)()},engineMaxRangeActionCount:function(){return(0,ue.getSheetRangeActionCount)()},engineSendUserChangeDebounceTime:function(){return(0,ue.getSheetSendUserChangeDebounce)()},engineMissVersionThreshold:function(){var e=(0,ue.getMissVersionThreshold)();try{if(window.location.href){var t=(0,g.parseQuery)(window.location.href),n=parseInt(t.sheet_rev_miss_gap,10);e=Number.isNaN(n)?e:Math.max(n,0)}}finally{}return e},backupGzipContentEnable:function(){return!0},syncShowCollaboratorUserInfo:function(){return(0,T.getShowCollaboratorInfoPerm)()},syncContentBufferEnable:function(){var n;return!e.preventSync&&!I.Ps3.browser.isInVC&&(I.Ps3.syncbufferEnable&&!I.Ps3.browser.isMobile&&!(null!==(n=t.engine)&&void 0!==n&&n.getUserChangesExisted()))},syncMemberBufferEnable:function(){return I.Ps3.syncbufferEnable&&t.isSheetRoute()&&!I.Ps3.browser.isMobile&&!I.Ps3.browser.isInVC},syncNetworkRecoverSendHBEnable:function(){return!I.Ps3.browser.isMobile},syncMemberChannelEnable:function(){return Ve(t.context.isEmbed())},syncEngineChannelEnable:function(){return!(0,ce.XU)()},syncRequestLockFailCacheCalcRetryTime:function(){return(0,ue.getFollowRetryIntervalTime)()},syncProtobufTimeout:function(){return(0,T.getSyncProtobufTimeout)()},convertTableBlockEnable:function(){return!1},scmInfo:function(){return window.scm},dataloaderShouldFixActiveSheedId:function(){return!I.Ps3.browser.isInVC},dataLoaderSubBlocksTimeout:function(){return(0,T.getSubBlocksTimeout)()},dataLoaderParallelNum:function(){return(0,ue.getBlockParallelTaskCount)()},dataLoaderLimitPerSecond:function(){return(0,T.getSheetRequestBlockLimit)()},dataLoaderPreventFetchSplitData:function(){return(0,g.isShortCut)()&&!(0,I.LV8)()},dataLoaderUsePreloadHttp:function(){return!(0,g.isShortCut)()},searchAllEnable:function(){return Ve(t.context.isEmbed())},showActionSuspendedTips:function(){return!t.context.isEmbed()},dataLoaderRefetchIfRecoverActionFound:function(){return!t.context.isEmbed()||t.context.getHistoryType()===I.Z3k.DOC_MIXED},dataLoaderUseClientVarsInTemplate:function(){return!t.context.isEmbed()},dataLoaderFetchClientVarsTimeout:function(){return(0,T.getSheetClientvarsTimeout)()},fetchMissMaxRevCount:function(){return 200},useTTUOptimizationQ2:function(){return!0},polyphoneSortEnable:function(){return!(0,g.isLark)()},outlineGroupMaxCount:function(){return(0,ue.getMinaNumberConfig)("ccm_sheet_outline_group_max_count",1e3)},indexDBOverTimeLimit:function(){return(0,ue.getIndexDBOverTimeLimit)()},colDataAnalysisConfig:function(){return(0,ue.getSheetColDataAnalysisConfig)()}})}},{key:"initClientMetaService",value:function(){var e=this.sdk.getService(ie.cAU);this.context.setMemberId(e.getMemberId()),this.sdk.spread.getService(oe.UU).setMeta({token:this.context.getToken(),userId:this.context.userId,memberId:this.context.getMemberId()})}},{key:"onClientVarsMessageInValid",value:function(e){(0,h.Z)((0,d.Z)(t.prototype),"onClientVarsMessageInValid",this).call(this,e),this.getStore().dispatch((0,Q.setSheetRendered)(!0))}},{key:"onClientVarsFetchFailed",value:function(e,n,r,i){(0,h.Z)((0,d.Z)(t.prototype),"onClientVarsFetchFailed",this).call(this,e,n,r,i);try{(0,T.transformPerformanceData)({url:R.K.apiUrls.POST_RCE_MESSAGE,data:{code:n,data:{type:"CLIENT_VARS"},request_id:r,log_id:i}})}catch(e){C.moirae.ravenCatch(e)}}},{key:"onClientVarsLoaded",value:function(e,n){(0,h.Z)((0,d.Z)(t.prototype),"onClientVarsLoaded",this).call(this,e,n),this.getStore().dispatch((0,Q.setSheetPermissions)(e.permissions))}},{key:"onSpreadLoaded",value:function(e){(0,g.isShortCut)()&&this.sdk.spread.getCalcEngine().formulaService.suspend(),(0,h.Z)((0,d.Z)(t.prototype),"onSpreadLoaded",this).call(this,e)}},{key:"onSplitDataFetchStart",value:function(){(0,g.isShortCut)()&&this.sdk.spread.getCalcEngine().formulaService.suspend(),(0,h.Z)((0,d.Z)(t.prototype),"onSplitDataFetchStart",this).call(this)}},{key:"loadedInitialized",value:function(e){I.PxA.setIsUsingWorker((0,ne.Pt)()),(0,h.Z)((0,d.Z)(t.prototype),"loadedInitialized",this).call(this,e),this.init()}},{key:"handleNotify",value:function(){var e=(0,g.parseQuery)(window.location.href);if(e&&"reminder"===e.type){var t=e.reminderId,n=this.openedHiddenSheetId||e.sheet;if(history.replaceState({},document.title,"".concat(window.location.pathname,"?sheet=").concat(e.sheet)),!this.context.isEmbed()&&n&&t){(0,C.collectSuiteEvent)("sheet_reminder_file_open");var r=this.findReminder(n,t)||{},i=r.targetSheet,o=void 0===i?null:i,a=r.pos,s=void 0===a?null:a;o&&s&&(this.handleReminderNotify(o,s),this.jumpedReminder=!0)}}}},{key:"findReminder",value:function(e,t){var n=this._spread.getSheetFromId(e);if(!n)return null;if(n&&n.getHiddenStatus())return null;var r=null;return n&&(r=n.getReminderPosById(t)),r?n.getRowVisible(r.row)&&n.getColumnVisible(r.col)?{targetSheet:n,pos:r}:(_.Toast.remove("CreationDoc_Sheets_Toast_ReminderFilteredHided"),_.Toast.info({closable:!0,key:"CreationDoc_Sheets_Toast_ReminderFilteredHided",content:xe("CreationDoc_Sheets_Toast_ReminderFilteredHided"),duration:8e3}),null):(_.Toast.remove("CreationDoc_Sheets_Toast_ReminderDeleted"),_.Toast.error({closable:!0,key:"CreationDoc_Sheets_Toast_ReminderDeleted",content:xe("CreationDoc_Sheets_Toast_ReminderDeleted"),duration:8e3}),null)}},{key:"handleReminderNotify",value:function(e,t){var n=this._spread,r=t.row,i=t.col,o=e.id();n.getActiveSheet().id()!==o&&(n.setActiveSheetById(o,!0),this.context.trigger(ie.YVA.WAKEUP,o)),e.setActiveCell(r,i),e.showCell(r,i)}},{key:"destroy",value:function(){var e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.destroyed){var r;if(!n)null===(r=this._spread.blockManager)||void 0===r||r.destroy(),this.hookPlugins.forEach((function(e){return e.destroy()})),this._spread.blockManager=void 0,this.hookPlugins=[],this._spread.sheetBlocksManager&&this._spread.sheetBlocksManager.destroy(),this._spread.sheetBlocksManager=null;(0,se.UC)(),this.sdk.getService(oe.QX).flush(),null===(e=this.collaborativeSubscription)||void 0===e||e.unsubscribe(),this.collaborativeSubscription=null;var i=this.sdk.getPlugin("CellEditorPlugin");i&&E.resourceGuard.removeCanLeavePageHandler(i.canLeavePage),(0,h.Z)((0,d.Z)(t.prototype),"destroy",this).call(this,n)}}},{key:"registerEditor",value:(v=(0,a.Z)(o().mark((function e(){var t,n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.sdk.getService(oe.kM),n=this.sdk.getPlugin(z.IEf),t.collect(b.SHEET_LOAD_MAIN_STAGE_DURATION_LIST_KEY.EDITOR_START_LOAD),t.collect(I.FHD.EDITOR_TIME_TO_USAGE,{status:I.G2P.START}),e.prev=4,r=(0,ae.getEditorOptions)(this.sdk),e.next=8,this.asyncRegisterEditorPlugin(r);case 8:if(I.Ps3.performanceStageCollector.updateStage(I.Ps3.sheetRenderStage.SHEET_PLUGIN_LOAD_SUCCESS,I.Ck$),this.sdk){e.next=11;break}return e.abrupt("return");case 11:this.initCellEditorPlugin(r),this.initFormulaBarPlugin(r),t.collect(b.SHEET_LOAD_MAIN_STAGE_DURATION_LIST_KEY.EDITOR_INIT,{schema_version:null==n?void 0:n.clientVarsDataVersion}),t.collect(I.FHD.EDITOR_TIME_TO_USAGE,{status:I.G2P.END,schema_version:null==n?void 0:n.clientVarsDataVersion}),this.asyncCellNotePlugin(),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(4),console.error("init editor error",e.t0),(0,C.collectSuiteEvent)("ccm_sheet_plugin_load_fail_dev",{reason:"onAfterFirstScreenLoadSource",message:e.t0&&e.t0.stack?String(e.t0.stack):String(e.t0)});case 22:case"end":return e.stop()}}),e,this,[[4,18]])}))),function(){return v.apply(this,arguments)})},{key:"asyncRegisterEditorPlugin",value:(p=(0,a.Z)(o().mark((function e(t){var n,r,i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=this.sdk.getPlugin("CellEditorPlugin"),r=this.sdk.getPlugin("FormulaBarPlugin"),n){e.next=8;break}return e.next=6,Pe;case 6:i=e.sent,this.sdk.registerPlugin([new i.CellEditorPlugin(Object.assign({},t))]);case 8:if(r){e.next=13;break}return e.next=11,Le;case 11:a=e.sent,this.sdk.registerPlugin(new a.FormulaBar(Object.assign({},t)));case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.error("[SHEET LOG]: register cell editor plugin fail",e.t0);case 18:case"end":return e.stop()}}),e,this,[[0,15]])}))),function(e){return p.apply(this,arguments)})},{key:"asyncRegisterPivotPlugin",value:(i=(0,a.Z)(o().mark((function e(t){var r,i,a=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.length>1&&void 0!==a[1]?a[1]:this.sdk,e.prev=1,r.getPlugin(z.Wcw)){e.next=8;break}return e.next=6,Promise.all([n.e("vsh_4670"),n.e("vsh_2509"),n.e("vsh_2172"),n.e("vsh_7554"),n.e("vsh_4546"),n.e("vsh_5628")]).then(n.bind(n,"vsh_42922"));case 6:i=e.sent,r.registerPlugin([new z.PJ7(Object.assign({initSheetBlocksManager:i.initSheetBlocksManager},t)),new z.HyL,new z.XKZ]);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.error("[SHEET LOG]: register pivot data loader plugin fail",e.t0);case 13:case"end":return e.stop()}}),e,this,[[1,10]])}))),function(e){return i.apply(this,arguments)})},{key:"initCellEditorPlugin",value:function(e){var t=this.sdk.getPlugin("CellEditorPlugin");null==t||t.createEditor(e)}},{key:"initCellNoteEditorPlugin",value:function(){var e=this.sdk.getPlugin("CellNoteEditorPlugin");null==e||e.createEditor()}},{key:"initFormulaBarPlugin",value:function(e){var t=this.sdk.getPlugin("FormulaBarPlugin");null==t||t.createEditor(e)}},{key:"showError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;(0,he.o0)(e,t,n)}},{key:"isSheetRoute",value:function(){return(0,T.locateRoute)().isSheet}},{key:"getLocale",value:function(){return(0,g.getLocaleV1)()}},{key:"setSpreadSheetHalt",value:function(){this.getStore().dispatch((0,Q.setSpreadSheetHalt)())}},{key:"showModal",value:function(e){(0,N.K4)(e)}},{key:"showServerErrorModal",value:function(e,t){(0,N.Ft)(e,t)}},{key:"setSpreadEdit",value:function(e,t){(0,ee.rV)(e,t)}},{key:"convertLink",value:function(e,t,n){(0,le.ir)()&&(0,w.ml)(e,t,n)}}]),t}(te.X);function Ve(e){return(0,T.locateRoute)().isSheet||(0,T.locateRoute)().isWikiIndex&&!e}function He(){(0,g.isShortCut)()&&!(0,I.LV8)()&&(v.WAIT_ASYNC_ERR_VAR.desc="")}Ne([(0,y.Bind)()],Be.prototype,"initConfigService",null)},vsh_67353:function(e,t,n){"use strict";n.d(t,{HY:function(){return N},R1:function(){return P},Qt:function(){return L}});var r=n("vsh_24627"),i=n("vsh_69691"),o=n("vsh_45003"),a=n("vsh_38588"),s=n("vsh_65593"),u=n("vsh_19264"),l=n("vsh_4175"),c=n("vsh_12064"),h=n("vsh_56589"),d=n("vsh_22462"),f=n("vsh_73455"),p=n("vsh_12484"),v=n("vsh_22488"),g=n("vsh_68706"),_=n("vsh_83190"),y=n("vsh_13885"),m=n("vsh_75986"),E=n("vsh_86217"),b=n("vsh_74340"),T=n("vsh_82905"),C=n("vsh_22233"),S=n("vsh_18088");function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.ungzip;return function(n){var r=Date.now(),i=t(n);return e.time+=Date.now()-r,e.length+=n.length,e.count++,i}}function R(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.convertBase64StrToBuffer,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.ungzipBuffer;return function(r){var i=Date.now(),o=t(r),a=n(o);return e.time+=Date.now()-i,e.length+=r.length,e.count++,{buffer:o,result:a}}}var A=[r.Y6H.ungzipSnapshot,r.Y6H.ungzipChangeset,r.Y6H.ungzipBlock,r.Y6H.ungzipFormulaCache],O=function(){function e(t){var n=this;(0,u.Z)(this,e),this.dataAdaptInfo={},this.dataAdaptMethod={},A.forEach((function(e){var r={length:0,time:0,count:0};n.dataAdaptInfo[e]=r,n.dataAdaptMethod[e]={bufferInflationMethod:R(r,t.baseToBufferMethod,t.bufferToContentMethod),inflationMethod:w(r,t.inflationMethod)}}))}return(0,l.Z)(e,[{key:"resetDataAdaptInfo",value:function(e){this.dataAdaptInfo[e].length=0,this.dataAdaptInfo[e].time=0,this.dataAdaptInfo[e].count=0}},{key:"destroy",value:function(){this.dataAdaptInfo={},this.dataAdaptMethod={}}}]),e}(),M=n("vsh_73043");m.MCu.forEach((function(e){S.d.whitelist.add(e)}));var k=function(e){function t(e){var n;return(0,u.Z)(this,t),(n=(0,c.Z)(this,(0,d.Z)(t).call(this,e))).inflationAdaptor=null,n.reduxStore=e.reduxStore,e.inflationUtils&&(n.inflationAdaptor=new O(e.inflationUtils)),n}return(0,f.Z)(t,e),(0,l.Z)(t,[{key:"findSheetById",value:function(e,t){return Object.values(e.sheets).find((function(e){return e.id===t}))}},{key:"onHandleClientVarsStart",value:function(e,n){(0,h.Z)((0,d.Z)(t.prototype),"onHandleClientVarsStart",this).call(this,e,n),(0,g.y)(p.SHEET_LOAD_MAIN_STAGE_DURATION_LIST_KEY.UNZIP_FILE_CLIENTVARS_START),this.reduxStore.dispatch((0,_.setSheetPermissions)(e.data.permissions))}},{key:"onFetchClientVarsFailed",value:function(e,n,r){(0,h.Z)((0,d.Z)(t.prototype),"onFetchClientVarsFailed",this).call(this,e,n,r),this.reduxStore.dispatch((0,_.setSheetRendered)(!0))}},{key:"validateClientVarsInTemplate",value:function(e){if(!(0,h.Z)((0,d.Z)(t.prototype),"validateClientVarsInTemplate",this).call(this,e))return!1;if((0,b.EQE)(e.data)||(0,b.M0m)(e.data))return!0;var n=this.getClientVars(e);if(!n||!n.extra_data||!n.gzip_snapshot)return!1;if(!location.hash||location.hash==="#".concat(n.extra_data.sheet_id))return!0;n.snapshot||(n.snapshot=(0,r.ecX)(n.gzip_snapshot));var i=n.snapshot,o=this.findSheetById(i,n.extra_data.sheet_id);return!(!o||!o.hidden)}},{key:"hasEditablePermission",value:function(e){if(e)return(0,v.getIsEditable)(e);var t=this.reduxStore.getState();return!(!t||!(0,y.editablePermissionSelector)(t))}},{key:"onUseClientVarsInTemplate",value:function(e){var n;(0,h.Z)((0,d.Z)(t.prototype),"onUseClientVarsInTemplate",this).call(this,e);var i=null===(n=this.preloadData)||void 0===n?void 0:n.getSnapshotBuffer(),o=this.sharedBufferService;if(i&&o){var a,s,u,l,c,f;if((0,b.qo4)(e)){var p,v;u="snapshot_".concat(e.data.clientvars.revision),l=null===(p=e.data.clientvars.extra_data)||void 0===p?void 0:p.blocks,f=null===(v=e.data.clientvars.extra_data)||void 0===v?void 0:v.sheet_id}else{var g,_,y=e;u="snapshot_".concat(e.data.revision),l=null===(g=y.data.extra_data)||void 0===g?void 0:g.blocks,f=null===(_=y.data.extra_data)||void 0===_?void 0:_.sheet_id}if(1===(null===(a=l)||void 0===a?void 0:a.length)&&!l[0].dataTable&&f){this.store.dispatchEvent("LoadStatusStore/SnapshotHasExtraData",f);var m=(this.inflationAdaptor?this.inflationAdaptor.dataAdaptMethod[r.Y6H.ungzipBlock].bufferInflationMethod:r.yGW)(l[0].gzip_datatable);c=m.buffer,l[0].dataTable=m.result,delete l[0].gzip_datatable,o.setItem("snapshot_extra_data",{buffer:c,startRowIndex:l[0].row})}o.setItem(u,i),null===(s=this.preloadData)||void 0===s||s.clearSnapshotBuffer()}}},{key:"mergeAndReportDataAdaptInfo",value:function(){var e,t;if(this.inflationAdaptor){var n,i,o,a,s=null===(e=this.preloadData)||void 0===e||null===(t=e.getDataAdaptInfo)||void 0===t?void 0:t.call(e),u=this.inflationAdaptor.dataAdaptInfo[r.Y6H.ungzipSnapshot];if(s&&u)a=s,(o=u).length+=a.length,o.time+=a.time,o.count+=a.count,null===(n=this.preloadData)||void 0===n||null===(i=n.resetDataAdaptInfo)||void 0===i||i.call(n);this.reportDataAdaptInfo(this.inflationAdaptor.dataAdaptInfo)}}},{key:"getAdaptorContext",value:function(){return this.inflationAdaptor?{dataAdaptMethod:this.inflationAdaptor.dataAdaptMethod}:void 0}},{key:"reportDataAdaptInfo",value:function(e){var t=this;this.inflationAdaptor&&Object.keys(e).forEach((function(n){var r,i,o=e[n];o&&o.length&&o.time&&o.count&&(null===(r=t.reporterService)||void 0===r||r.eventReportWithTemplate(E.n.SheetPathTracker,{trace_code:n,length:o.length,time:o.time,count:o.count,avg_length:o.length/o.count,avg_time:o.time/o.count,ratio:o.length/o.time}),null===(i=t.inflationAdaptor)||void 0===i||i.resetDataAdaptInfo(n))}))}},{key:"onSubBlockLoaded",value:function(e){var n=this.sharedBufferService;e.data&&e.data.blockDataBuffer&&n&&(n.setItem(e.data.block_token,e.data.blockDataBuffer),delete e.data.blockDataBuffer),(0,h.Z)((0,d.Z)(t.prototype),"onSubBlockLoaded",this).call(this,e)}},{key:"onFormulaBlockLoaded",value:function(e){var n=this;this.sharedBufferService&&e.data.forEach((function(e){e.blockDataBuffer&&(n.sharedBufferService.setItem(e.block_token,e.blockDataBuffer),delete e.blockDataBuffer)})),(0,h.Z)((0,d.Z)(t.prototype),"onFormulaBlockLoaded",this).call(this,e),this.inflationAdaptor&&e.isLastBlock&&this.reportDataAdaptInfo(this.inflationAdaptor.dataAdaptInfo)}},{key:"onSubBlockExpire",value:function(e,n){var i;(0,C.x2)(r.ZB9.ERROR_ERROR,{body:M("sheet.clientvars_rce_missmatch")}),null===(i=this.reporterService)||void 0===i||i.eventReportWithTemplate(E.n.SheetPathTracker,{info:"SubBlockExpire, baseTime: ".concat(n)}),(0,h.Z)((0,d.Z)(t.prototype),"onSubBlockExpire",this).call(this,e,n)}},{key:"onClientVarsFetchStart",value:function(e){(0,h.Z)((0,d.Z)(t.prototype),"onClientVarsFetchStart",this).call(this,e),(0,g.y)(p.SHEET_LOAD_MAIN_STAGE_DURATION_LIST_KEY.FETCH_FILE_CLIENTVARS_START)}},{key:"onBeforeApplySnapshot",value:function(e){(0,h.Z)((0,d.Z)(t.prototype),"onBeforeApplySnapshot",this).call(this,e),(0,g.y)(p.SHEET_LOAD_MAIN_STAGE_DURATION_LIST_KEY.APPLY_FILE_CLIENTVARS_START)}},{key:"onAfterApplySnapshot",value:function(){(0,h.Z)((0,d.Z)(t.prototype),"onAfterApplySnapshot",this).call(this),(0,g.y)(p.SHEET_LOAD_MAIN_STAGE_DURATION_LIST_KEY.APPLY_FILE_CLIENTVARS_SUCCESS)}},{key:"onHandleClientVarsEnd",value:function(e,n){(0,h.Z)((0,d.Z)(t.prototype),"onHandleClientVarsEnd",this).call(this,e,n),(0,g.y)(p.SHEET_LOAD_MAIN_STAGE_DURATION_LIST_KEY.UNZIP_FILE_CLIENTVARS_SUCCESS)}},{key:"onFetchClientVarsSuccess",value:function(e){(0,h.Z)((0,d.Z)(t.prototype),"onFetchClientVarsSuccess",this).call(this,e),(0,g.y)(p.SHEET_LOAD_MAIN_STAGE_DURATION_LIST_KEY.FETCH_FILE_CLIENTVARS_SUCCESS)}},{key:"onSubBlockFetchStart",value:function(e){(0,h.Z)((0,d.Z)(t.prototype),"onSubBlockFetchStart",this).call(this,e),(0,g.y)(p.SHEET_LOAD_MAIN_STAGE_DURATION_LIST_KEY.FETCH_SUB_BLOCK_START)}},{key:"onSubBlockFetchEnd",value:function(e){(0,h.Z)((0,d.Z)(t.prototype),"onSubBlockFetchEnd",this).call(this,e),(0,g.y)(p.SHEET_LOAD_MAIN_STAGE_DURATION_LIST_KEY.FETCH_SUB_BLOCK_SUCCESS)}},{key:"destroy",value:function(){(0,h.Z)((0,d.Z)(t.prototype),"destroy",this).call(this),this.inflationAdaptor&&this.inflationAdaptor.destroy(),this.inflationAdaptor=null}},{key:"getClientVars",value:function(e){return(0,b.yyw)(e.data)?e.data.clientvars:e.data}},{key:"sharedBufferService",get:function(){return this._sharedBufferService||(this._sharedBufferService=this.sdk.getService(T.B2)),this._sharedBufferService}}]),t}(m.l$w),I=function(e){function t(e){var n;return(0,u.Z)(this,t),(n=(0,c.Z)(this,(0,d.Z)(t).call(this,{convertLink:e.convertLink}))).deps=e,n.handleBeforeUnload=function(e){if(!n.canLeavePage()){var t=n.engineService.getStatus();n.logMessage("BeforeUnload: ".concat(t.network,", ").concat(t.localActions.length,", ").concat(!!t.submittingChangeset));return e.returnValue="o/",n.onBeforePageUnload(t),"o/"}},n.handleUnload=function(){n.engineService.completeBackup()},n}return(0,f.Z)(t,e),(0,l.Z)(t,[{key:"init",value:function(e){(0,h.Z)((0,d.Z)(t.prototype),"init",this).call(this,e),this.initResourceGuard(),window.addEventListener("beforeunload",this.handleBeforeUnload),window.addEventListener("unload",this.handleUnload)}},{key:"destroy",value:function(){this.resetResourceGuard(),window.removeEventListener("beforeunload",this.handleBeforeUnload),window.removeEventListener("unload",this.handleUnload),(0,h.Z)((0,d.Z)(t.prototype),"destroy",this).call(this)}},{key:"initResourceGuard",value:function(){this.deps.resourceGuard.addCanLeavePageHandler(this.canLeavePage)}},{key:"resetResourceGuard",value:function(){this.deps.resourceGuard.removeCanLeavePageHandler(this.canLeavePage)}},{key:"onBeforePageUnload",value:function(e){this.reporterService.eventReport({key:"client_sheet_eng_before_unload",network:e.network,localAction:e.localActions.length,submittingCS:!!e.submittingChangeset})}},{key:"onChannelOnline",value:function(){(0,h.Z)((0,d.Z)(t.prototype),"onChannelOnline",this).call(this),this.deps.reduxStore.dispatch((0,_.channelOnline)())}},{key:"onChannelOffline",value:function(){(0,h.Z)((0,d.Z)(t.prototype),"onChannelOffline",this).call(this),this.deps.reduxStore.dispatch((0,_.channelOffline)())}}]),t}(m.Fw5),x=n("vsh_18801");function N(){return new I({convertLink:function(e,t,n){(0,a.ir)()&&(0,o.ml)(e,t,n)},resourceGuard:x.resourceGuard,reduxStore:x.store})}function P(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.AXv.onDemand;return new k({requestProvider:s.K,retryProvider:r.RdR,taskMode:t,getActiveSheetId:e,sheetIdsToFetch:[],preloadHttp:r.Ps3.preloadHttp,preloadData:r.Ps3.preloadData,reduxStore:x.store,inflationUtils:{inflationMethod:i.ungzip,bufferToContentMethod:i.ungzipBuffer,baseToBufferMethod:i.convertBase64StrToBuffer}})}function L(e,t,n){return new k({requestProvider:s.K,retryProvider:r.RdR,taskMode:r.AXv.runInBackground,sheetIdsToFetch:t,dataAdapter:n,getActiveSheetId:function(){var n;return e||(null!==(n=t[0])&&void 0!==n?n:"")},preloadHttp:r.Ps3.preloadHttp,reduxStore:x.store})}},vsh_142:function(e,t,n){"use strict";n.d(t,{t:function(){return _e},w:function(){return ye}});var r=n("vsh_67017"),i=n.n(r),o=n("vsh_35067"),a=n("vsh_47253"),s=n("vsh_21469"),u=n("vsh_6127"),l=n.n(u),c=n("vsh_69691"),h=n("vsh_18043"),d=n("vsh_60591"),f=n("vsh_56450"),p=n("vsh_18801"),v=n("vsh_12484"),g=n("vsh_45552"),_=n("vsh_22488"),y=n("vsh_96579"),m=n("vsh_18993"),E=n("vsh_89454"),b=n("vsh_51504"),T=n("vsh_76197"),C=n("vsh_46162"),S=n("vsh_87464"),w=n("vsh_1139"),R=n("vsh_32841"),A=n("vsh_24627"),O=n("vsh_6539");function M(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function I(e){var t,n,r={},i=[],o=M(e);try{for(o.s();!(t=o.n()).done;){var a=t.value,s=a.typeNum,u=a.token;(0,_.isWikiToken)(u)?i.push((n=u,(0,O.c)(n).then((function(e){if(null!=e&&e.obj_type===A.CSR.SHEET)return e})).catch((function(){})))):r[s]?r[s].push(u):r[s]=[u]}}catch(e){o.e(e)}finally{o.f()}var l=Promise.all(i).then((function(e){return e.reduce((function(e,t){return t&&(e[t.wiki_token]=t),e}),{})})),c=R.ioRequestClient.post(v.apiUrls.POST_BATCH_META,{tokens:r}).then((function(e){return e.data})).catch((function(){return null}));return Promise.all([l,c]).then((function(e){var t=(0,w.Z)(e,2),n=t[0],r=t[1];return Object.assign(n,r)}))}var x=n("vsh_65593"),N=n("vsh_76309");function P(e){var t=(0,_.generateRequestId)();return{headers:{"Content-Type":"application/json","Request-Id":t,"x-request-id":t,"x-tt-trace-id":t},baseURL:e.prependAPI("/"),timeout:3e4}}function L(e){return{requestImportRangeMetas:function(t){var n=t.version===A.waj.V3?e.apiUrls.POST_SHEET_IMPORT_RANGE_METAS_V3:e.apiUrls.POST_SHEET_IMPORT_RANGE_METAS,r=t.version===A.waj.V3?{token:t.token,ir_params:t.importrange_ids}:{token:t.token,importrange_ids:t.importrange_ids};return e.postRequest(n,r,P(e)).promise.then((function(e){if(!e||0!==e.code)throw console.error("request importrange meta error"),A.DZv[A.O6N.REQUEST_FAIL];return e.data.importrangeMetas}))},requestSubBlock:function(t){var n=t.version===A.waj.V3?e.apiUrls.POST_SHEET_IMPORT_RANGE_BLOCK_V3:e.apiUrls.POST_SHEET_IMPORT_RANGE_BLOCK;return e.postRequest(n,t,P(e)).promise.then((function(e){if(!e)throw A.DZv[A.O6N.REQUEST_FAIL];switch(e.code){case 0:return e.data.gzipBlockData;case 4850:throw console.error("importrange accesskey expired"),A.DZv[A.O6N.ACCESSKEY_EXPIRED];default:throw console.error("request importrange block error"),A.DZv[A.O6N.REQUEST_FAIL]}}))},requestHeartBeat:function(t){var n=e.apiUrls.POST_SHEET_IMPORT_RANGE_HEARBEAT;return e.postRequest(n,t,P(e)).promise.then((function(e){if(!e||0!==e.code)throw A.DZv[A.O6N.REQUEST_FAIL];return e.data.dataHash}))},requestAddImportRange:function(t){var n=e.apiUrls.POST_SHEET_IMPORT_RANGE_ADD;return e.postRequest(n,t,P(e)).promise.then((function(e){if(!e||0!==e.code)throw console.error("request importrange add error"),A.DZv[A.O6N.REQUEST_FAIL];return!0}))}}}function D(e){var t=(0,_.generateRequestId)();return{headers:{"Content-Type":"application/json","Request-Id":t,"x-request-id":t,"x-tt-trace-id":t},baseURL:e.prependAPI("/"),timeout:3e4}}function F(e){return{requestImportFormulaMeta:(r=(0,o.Z)(i().mark((function t(n){var r,o;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.apiUrls.POST_SHEET_IMPORT_FORMULA_META,t.next=3,e.postRequest(r,n,D(e)).promise;case 3:if((o=t.sent)&&0===o.code){t.next=6;break}throw(0,A.i4Q)(A.O6N.REQUEST_FAIL,"meta request fail");case 6:return t.abrupt("return",o.data.importFormulas);case 7:case"end":return t.stop()}}),t)}))),function(e){return r.apply(this,arguments)}),requestImportFormulaBlock:(n=(0,o.Z)(i().mark((function t(n){var r,o;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.apiUrls.POST_SHEET_IMPORT_FORMULA_BLOCK,t.next=3,e.postRequest(r,n,D(e)).promise;case 3:if((o=t.sent)&&0===o.code){t.next=6;break}throw A.rur[A.O6N.REQUEST_FAIL];case 6:return t.abrupt("return",o.data.formulaBlocks);case 7:case"end":return t.stop()}}),t)}))),function(e){return n.apply(this,arguments)}),requestImportFormulaRefresh:function(t){var n=e.apiUrls.POST_SHEET_IMPORT_FORMULA_REFRESH;e.postRequest(n,t,D(e))},requestAuthorized:(t=(0,o.Z)(i().mark((function t(n){var r,o;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.apiUrls.POST_SHEET_AUTHORIZED,t.next=3,e.postRequest(r,n,D(e)).promise;case 3:if((o=t.sent)&&0===o.code){t.next=6;break}return t.abrupt("return",0);case 6:return t.abrupt("return",o.data.authorized);case 7:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})};var t,n,r}var B=n("vsh_98652"),V=n("vsh_60505");function H(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Z="api.suite.permission.zone.filter";function W(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=(0,_.generateRequestId)();return{headers:{"Content-Type":"application/x-www-form-urlencoded;charset=utf-8;","x-command":t},baseURL:e.prependAPI("/"),"Request-Id":n,"x-tt-trace-id":n}}function j(e){function t(e,t){return n.apply(this,arguments)}function n(){return(n=(0,o.Z)(i().mark((function t(n,r){var o;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.postRequest(e.apiUrls.POST_SUITE_PERMISSION_ZONE_FILTER,(0,V.stringify)({type:3,token:n,zone_ids:JSON.stringify(r)}),W(e,Z)).promise;case 2:if((o=t.sent).code){t.next=7;break}return t.abrupt("return",o.data);case 7:throw console.error("batchPermFilter fail",o),o;case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return{createZone:(u=(0,o.Z)(i().mark((function t(n,r){var o;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.postRequest(e.apiUrls.CREATE_SUITE_PERMISSION_ZONE,(0,V.stringify)({type:3,token:n,members:JSON.stringify(r.map((function(e){return{owner_id:e.ownerId,owner_type:e.ownerType,permission:4}})))}),W(e,"api.suite.permission.zone.create")).promise;case 2:if((o=t.sent).code){t.next=7;break}return t.abrupt("return",o.data.zone_id);case 7:throw o;case 8:case"end":return t.stop()}}),t)}))),function(e,t){return u.apply(this,arguments)}),batchPermFilter:t,bufferBatchPermFilter:function(){var e=[];function n(){var n=e;e=[];var r,i=H(function(e){var t=new Map,n=function(e){var n=t.get(e);return n||(n=new Set,t.set(e,n)),n};return e.forEach((function(e){var t=e.sheetToken,r=e.permIdList,i=n(t);r.forEach((function(e){return i.add(e)}))})),t}(n));try{var o=function(){var e=(0,w.Z)(r.value,2),i=e[0],o=e[1],a=(0,B.Z)(o),s=function(e){n=n.filter((function(t){return t.sheetToken!==i||(e(t),!1)}))};t(i,a).then((function(e){var t=new Set(e);s((function(e){var n=e.permIdList.filter((function(e){return t.has(e)}));e.resolve(n)}))}),(function(e){return s((function(t){return t.reject(e)}))}))};for(i.s();!(r=i.n()).done;)o()}catch(e){i.e(e)}finally{i.f()}}var r=!1;function i(){r||0===e.length||(r=!0,n(),setTimeout((function(){r=!1,i()}),200))}return function(t,n){var r,o,a,s=(a=new Promise((function(e,t){r=e,o=t})),{resolve:r,reject:o,promise:a});return e.push({sheetToken:t,permIdList:n,resolve:s.resolve,reject:s.reject}),i(),s.promise}}(),queryPermUser:(s=(0,o.Z)(i().mark((function t(n,r){var o;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getRequest(e.apiUrls.GET_SUITE_PERMISSION_MEMBER,{params:{type:3,token:n,zone_id:r},key:e.apiUrls.GET_SUITE_PERMISSION_MEMBER,baseURL:e.prependAPI("/"),headers:{"x-command":"api.suite.permission.zone.members"}}).promise;case 2:if((o=t.sent).code){t.next=7;break}return t.abrupt("return",o.data);case 7:return t.abrupt("return",null);case 8:case"end":return t.stop()}}),t)}))),function(e,t){return s.apply(this,arguments)}),addUserToPerm:(a=(0,o.Z)(i().mark((function t(n,r,o){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.postRequest(e.apiUrls.CREATE_SUITE_PERMISSION_MEMBER,(0,V.stringify)({type:3,token:n,zone_id:r,members:JSON.stringify(o.map((function(e){return{owner_id:e.ownerId,owner_type:e.ownerType,permission:4}})))}),W(e,"api.suite.permssion.zone.members.create")).promise;case 2:if(t.sent.code){t.next=7;break}return t.abrupt("return",!0);case 7:return t.abrupt("return",!1);case 8:case"end":return t.stop()}}),t)}))),function(e,t,n){return a.apply(this,arguments)}),removeUserFromPerm:(r=(0,o.Z)(i().mark((function t(n,r,o){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.postRequest(e.apiUrls.DELETE_SUITE_PERMISSION_MEMBER,(0,V.stringify)({type:3,token:n,zone_id:r,members:JSON.stringify(o.map((function(e){return{owner_id:e.ownerId,owner_type:e.ownerType,permission:4}})))}),W(e,"api.suite.permission.zone.members.delete")).promise;case 2:if(t.sent.code){t.next=7;break}return t.abrupt("return",!0);case 7:return t.abrupt("return",!1);case 8:case"end":return t.stop()}}),t)}))),function(e,t,n){return r.apply(this,arguments)})};var r,a,s,u}function G(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return z(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Y="api.suite.permission.",X=Y+"zone.filter",K={notify_lark:0,notify_lark_v2:!1,send_lark_im:!1,lark_im_text:"",canRevokeNotify:!0};function q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=(0,_.generateRequestId)();return{headers:{"Content-Type":n?"application/json":"application/x-www-form-urlencoded;charset=utf-8;","x-command":t},baseURL:e.prependAPI("/"),"Request-Id":r,"x-tt-trace-id":r}}function $(e){function t(e){return e.reduce((function(e,t){var n,r=1===(n=t.action_auth_res).edit.auth_data_code?A.BX.EDITABLE:1===n.view.auth_data_code?A.BX.VISIBLE:A.BX.INVISIBLE;return e.set(t.object.entity_token,{permissionType:r,extraInfo:t.extra_info}),e}),new Map)}function r(e,t){return a.apply(this,arguments)}function a(){return(a=(0,o.Z)(i().mark((function n(r,o){var a,s;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=o.map((function(e){return{subject:{entity_token:e.userId,entity_type:e.userType},object:{entity_token:e.permId,entity_type:48},relation:{relation_type:1,entity_type:3,entity_token:r},actions:e.actionType}})),n.next=3,e.postRequest(e.apiUrls.GET_MULTIPLE_USER_READABLE_PERMISSION_ON_SUITE,{scene:"sheet_zone",auth_pairs:a},q(e,X,!0)).promise;case 3:if((s=n.sent).code){n.next=8;break}return n.abrupt("return",t(s.data.auth_res));case 8:throw console.error("batchPermFilter fail",s),s;case 10:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return{batchPermFilter:r,bufferBatchPermFilter:function(){var e=[];function t(){return(t=(0,o.Z)(i().mark((function t(){var o,a,s,u,l,c;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=e,e=[],a=n(o),s=new Map,u=G(a),t.prev=5,c=i().mark((function e(){var t,n,a,u,c,h,d,f;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,w.Z)(l.value,2),n=t[0],a=t[1],u=(0,B.Z)(a),c=Math.min(Number((0,A.eYO)("batch_get_count"))||50,50),h=function(e){o=o.filter((function(t){return t.sheetToken!==n||(e(t),!1)}))},e.prev=4,d=0;case 6:if(!(d<u.length)){e.next=15;break}return f=u.slice(d,d+c),e.next=10,r(n,f);case 10:e.sent.forEach((function(e,t){s.set(t,e)}));case 12:d+=c,e.next=6;break;case 15:h((function(e){var t=new Map;e.permIdList.forEach((function(e){s.has(e.permId)&&t.set(e.permId,s.get(e.permId))})),e.resolve(t)})),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(4),h((function(t){return t.reject(e.t0)}));case 21:case"end":return e.stop()}}),e,null,[[4,18]])})),u.s();case 8:if((l=u.n()).done){t.next=12;break}return t.delegateYield(c(),"t0",10);case 10:t.next=8;break;case 12:t.next=17;break;case 14:t.prev=14,t.t1=t.catch(5),u.e(t.t1);case 17:return t.prev=17,u.f(),t.finish(17);case 20:case"end":return t.stop()}}),t,null,[[5,14,17,20]])})))).apply(this,arguments)}function n(e){var t=new Map;return e.forEach((function(e){var n=e.sheetToken,r=e.permIdList,i=function(e){var n=t.get(e);return n||(n=new Set,t.set(e,n)),n}(n);r.forEach((function(e){return i.add(e)}))})),t}var a=!1;function s(){a||0===e.length||(a=!0,function(){t.apply(this,arguments)}(),setTimeout((function(){a=!1,s()}),200))}return function(t,n){var r,i,o,a=(o=new Promise((function(e,t){r=e,i=t})),{resolve:r,reject:i,promise:o});return e.push({sheetToken:t,permIdList:n,resolve:a.resolve,reject:a.reject}),s(),a.promise}}(),queryPermUser:(d=(0,o.Z)(i().mark((function t(n,r,o){var a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getRequest(e.apiUrls.GET_TEMPLATE_OWNER_I18NNAME,{params:Object.assign({type:3,token:n},r&&{block_id:r,block_type:48},{},o||{}),key:e.apiUrls.GET_TEMPLATE_OWNER_I18NNAME,baseURL:e.prependAPI("/"),headers:{"x-command":"api.suite.permission.members.v2"}}).promise;case 2:if((a=t.sent).code){t.next=7;break}return t.abrupt("return",a.data);case 7:return t.abrupt("return",null);case 8:case"end":return t.stop()}}),t)}))),function(e,t,n){return d.apply(this,arguments)}),replacePermUser:(h=(0,o.Z)(i().mark((function t(n,r,o,a,s){var u;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.postRequest(e.apiUrls.REPLACE_SUITE_PERMISSION_MEMBER,(0,V.stringify)({type:3,token:n,block_type:48,block_id:r,add_members:JSON.stringify(o.map((function(e){return{owner_id:e.ownerId,owner_type:e.ownerType,permission:e.permission}}))),del_members:JSON.stringify(a.map((function(e){return{owner_id:e.ownerId,owner_type:e.ownerType}}))),clear:s}),q(e,"api.suite.permission.zone.members.replace")).promise;case 2:if((u=t.sent).code){t.next=7;break}return t.abrupt("return",u.data);case 7:throw console.error("replacePermUser fail",u),u;case 9:case"end":return t.stop()}}),t)}))),function(e,t,n,r,i){return h.apply(this,arguments)}),fetchMemberCandidates:(c=(0,o.Z)(i().mark((function e(t,r,o){var a,s,u,l,c,h;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("vsh_8986"),n.e("vsh_6919"),n.e("vsh_2881")]).then(n.bind(n,"vsh_90881"));case 2:return a=e.sent,s=a.searchBySdkWithOldData,e.prev=4,e.next=7,s(t,Object.assign({count:10,department_type:Number(v.DEPARTMENT_TYPE_NUM.DEPARTMENT)},r||{}),o);case 7:return u=e.sent,l=u.entities,c=u.has_more,h=(h=u.candidates).map((function(e){return l&&l.users&&l.users[e.owner_id]?Object.assign({avatar:e.avatar_url},e,{},l.users[e.owner_id]):Object.assign({},e,{id:e.owner_id,name:e.owner_name,avatar:e.avatar_url||"",avatar_url:e.avatar_url||""})})),e.abrupt("return",{candidates:h,hasMore:c});case 14:return e.prev=14,e.t0=e.catch(4),e.abrupt("return",{candidates:[],hasMore:!1});case 17:case"end":return e.stop()}}),e,null,[[4,14]])}))),function(e,t,n){return c.apply(this,arguments)}),createMembers:(l=(0,o.Z)(i().mark((function t(n,r,o){var a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.postRequest(e.apiUrls.POST_ADD_MEMBERS,(0,V.stringify)(Object.assign({},K,{token:n,type:v.NUM_FILE_TYPE.SHEET,owners:JSON.stringify(r)},o||{})),q(e,"api.suite.permission.post_add_members")).promise;case 3:if((a=t.sent).code!==v.STATUS_CODE.SUCCESS){t.next=6;break}return t.abrupt("return",a.data);case 6:t.next=11;break;case 8:throw t.prev=8,t.t0=t.catch(0),t.t0;case 11:case"end":return t.stop()}}),t,null,[[0,8]])}))),function(e,t,n){return l.apply(this,arguments)}),updateMemberPermission:(u=(0,o.Z)(i().mark((function t(n){var r,o,a,s,u,l,c,h,d;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.token,o=n.type,a=n.ownerId,s=n.ownerType,u=n.permission,l=n.otherOptions,t.next=3,e.postRequest(e.apiUrls.POST_UPDATE_MEMBER_PERMISSION_V2,(0,V.stringify)(Object.assign({token:r,type:o,owner_id:a,owner_type:s,permission:u},l||{}))).promise;case 3:if(c=t.sent,h=c.code,d=c.data,h!==v.STATUS_CODE.SUCCESS){t.next=10;break}return t.abrupt("return",d);case 10:throw new Error;case 11:case"end":return t.stop()}}),t)}))),function(e){return u.apply(this,arguments)}),existMembers:(s=(0,o.Z)(i().mark((function t(n,r,o){var a,s,u,l,c;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={token:n,type:r,members:o},t.next=3,e.postRequest(e.apiUrls.POST_EXIST_MEMBER_PERMISSION_V2,JSON.stringify(a),q(e,"api.suite.permission.post_exist_member_permission_v2")).promise;case 3:if(s=t.sent,u=s.code,l=s.data,c=s.msg,u!==v.STATUS_CODE.SUCCESS){t.next=11;break}return t.abrupt("return",l);case 11:throw new Error(c);case 12:case"end":return t.stop()}}),t)}))),function(e,t,n){return s.apply(this,arguments)})};var s,u,l,c,h,d}n("vsh_97910");var J=n("vsh_22233"),Q=n("vsh_73043");function ee(e){var t={row:Q("LarkCCM_Sheets_CellLimitClearRow_Desc",(0,A.ytD)()),col:Q("LarkCCM_Sheets_CellLimitClearCol_Desc",(0,A.ytD)())};return(0,J.h2)({title:Q("sheet.fail_to_paste"),body:t[e],confirmText:Q("sheet.auto_clear_and_retry"),cancelText:Q("common.cancel"),closable:!1,maskClosable:!1}).promise}var te,ne=n("vsh_73043");function re(){(0,y.collectSuiteEvent)("sheet_paste_version_outdated_tips",{outdatedType:te.CopyData}),(0,J.K4)({title:ne("sheet.fail_to_paste"),body:ne("sheet.fail_to_paste_refresh_copy_again"),confirmText:ne("common.confirm"),cancelText:!1})}function ie(){(0,y.collectSuiteEvent)("sheet_paste_version_outdated_tips",{outdatedType:te.PastePage}),(0,J.K4)({title:ne("sheet.fail_to_paste"),body:ne("sheet.fail_to_paste_refresh_page"),confirmText:ne("common.confirm"),cancelText:!1})}!function(e){e.CopyData="copyData",e.PastePage="pastePage"}(te||(te={}));var oe=n("vsh_86921"),ae=n("vsh_87326"),se=n("vsh_25285"),ue=n("vsh_83190"),le=n("vsh_3789"),ce=n("vsh_97237"),he=n("vsh_70345"),de=n("vsh_7959"),fe=n("vsh_44397");function pe(e){var t=e.iconInfo,n=e.mentionType,r={type:A.$qQ.Base64,resource:(0,h.getSuiteUrlConfig)().icons[n]||""};if(!t)return r;var i=function(e){try{var t=JSON.parse(e),n=t.type,r=t.key,i=t.obj_type;return void 0===fe.NUM_ICON_TYPE[n]?null:{type:n,key:r,objType:i}}catch(e){console.error("[sheet mention icon-info parse]",e)}return null}(t);if(!i)return r;var o=i.type,a=i.key,s=i.objType,u=(0,fe.getIconSource)({iconType:o,iconKey:a,scene:fe.IconSourceScene.SHEET,fileType:s,iconUri:(0,fe.getCustomIconUri)(),isBaseCustomIconEnabled:_.isBaseCustomIconEnabled}).key;return u?(o===fe.NUM_ICON_TYPE.EMOJI?(r.type=A.$qQ.Base64,r.resource=(0,fe.transformEmojiToPng)(u)):(r.type=A.$qQ.Url,r.resource=u),r):r}var ve=n("vsh_32323"),ge=n("vsh_46544");function _e(){var e=(0,a.default)(y.moirae.ravenCatch,8e3);A.Ps3.moirae=y.moirae,A.Ps3.getMentionIconSource=pe,A.Ps3.browser=l(),A.Ps3.collectSuiteEvent=y.collectSuiteEvent,A.Ps3.collectEvent=y.collectEvent,A.Ps3.encryptTea=c.encryptTea,A.Ps3.transformPerformanceData=_.transformPerformanceData,A.Ps3.prependSpace=_.prependSpace,A.Ps3.syncbufferEnable=(0,C.getSheetSyncBufferEnable)(),A.Ps3.replaceImageDataSrc=_.replaceImageDataSrc,A.Ps3.getSuiteUrlConfig=(0,s.Z)(h.getSuiteUrlConfig),A.Ps3.freezeSheetToggle=function(e){p.store.dispatch((0,p.freezeSheetToggle)(e))},A.Ps3.serverApi=function(e){return{importRange:L(e),importFormula:F(e),protectionRange:j(e),protectionRangeV2:$(e),aiRequest:(0,N.R)(e)}}(x.K),A.Ps3.Toast=d.Toast,A.Ps3.Dialog={confirm:f.Dialog.confirm},A.Ps3.modalHelper={askUserShouldDelEmptyCellsAndContinuePaste:ee,showCopyDataOutdatedModal:re,showPastePageOutdatedModal:ie,showSpansPromptModalWhileSort:oe.showSpansPromptModalWhileSort,showCoverSheetContentConfirmModel:he.l,showError:J.x2},A.Ps3.chartDataTransformerHelper=null,A.Ps3.imageHelper={getDriveImageUrl:S.Jd,getDriveOriginalImageUrl:S.N,getDriveImageToken:_.getDriveImageToken,decodeInfo:_.decodeInfo,encodeInfo:_.encodeInfo,copyDriveImages:S.VF,generatePublicUrl:_.generatePublicUrl,makePulicUrlEffective:_.makePulicUrlEffective,ImageWorker:S.Lw,collectImageError:e,copyDriveTokenForSheet:S.nN,copyDriveImagesForRef:S.NU},A.Ps3.mpLinkHelper=_.mpLinkHelper,A.Ps3.canCopy=se.hJ,A.Ps3.collectLoadPerformance=_.collectLoadPerformance,A.Ps3.performanceStageCollector=_.performanceStageCollector,A.Ps3.sheetRenderStage=v.SHEET_RENDER_STAGE,A.Ps3.sheetLoadMainStageDurationListKey=v.SHEET_LOAD_MAIN_STAGE_DURATION_LIST_KEY,A.Ps3.permission=v.PERMISSION,A.Ps3.getLanguage=c.getLanguageV1,A.Ps3.preloadHttp=p.preloadHttp,A.Ps3.preloadData=p.preloadData,A.Ps3.getColorByUserId=c.getColorByUserId,A.Ps3.getSheetCellLimitNum=C.getSheetCellLimitNum,A.Ps3.generateMentionId=g.generateMentionId,A.Ps3.batchFetchDocsTitles=I,A.Ps3.ccmEventTracking=T.le,A.Ps3.collectSheetEvent=T.le,A.Ps3.getIsDocx=_.getIsAccurateDocx,A.Ps3.getUrlToken=function(e){return(0,ce.XU)()?(0,_.getToken)(e):(0,p.getUrlToken)(e)},A.Ps3.opendoc={getBlobImageUrl:function(e){return l().isOpendoc?(0,_.getBlobUrl)(e):new Promise((function(t){return t(e)}))},showCollaborators:ye},A.Ps3.shouldTipRender=function(e){if(l().isOpendoc){var t,n=(0,_.getOpendocCommentConfig)()||{partial:{disable:!1}};if(null!=n&&null!==(t=n.partial)&&void 0!==t&&t.disable)return e!==de.X2l.CommentIcon}if((0,c.isShortCut)()){var r=[];return(0,A.ixe)()||r.push(de.X2l.CommentIcon),!r.includes(e)}return!0},A.Ps3.sheetCfMaxCount=b.sX,A.Ps3.eventHelper={preventMouseDown:!1},A.Ps3.shortcutPluginDep={logShortcutExecuteError:function(e,t){e&&"Formula_Parse_Error"===e.message||(y.moirae.ravenCatch(e,{tags:{scm:JSON.stringify(window.scm),key:"SHEET_SHORTCUT_ERROR"}}),y.moirae.teaLog({key:"client_sheet_command_execute_fail",command:"shortkey",action:t,err_msg:e&&e.stack?String(e.stack):String(e)}))},logShortcutExecuted:function(e,t,n,r){var i=r._context.getHistoryType();(0,y.collectSuiteEvent)("sheet_opration",{action:e,source:"shortkey",eventType:"keydown",targetId:"",targetClass:"",object_id:n,mode:i||"default"}),function(e,t){return me.apply(this,arguments)}(t,r).then((function(e){null!=e&&e.click&&(0,T.le)("ccm_sheet_content_page_click",e)})).catch((function(e){console.warn("handleShortcutAction catch info",e)}))},logShortcutExcutedBefore:function(e,t){(function(e,t){return Ee.apply(this,arguments)})(e,t).then((function(e){null!=e&&e.click&&(0,T.le)("ccm_sheet_content_page_click",e)})).catch((function(e){console.warn("handleShortcutExcutedBefore catch info",e)}))}},A.Ps3.getSheetImportRangeCountLimit=_.getSheetImportRangeCountLimit,A.Ps3.getSheetCfCopyEnabled=C.getSheetCfCopyEnabled,A.Ps3.vcHelpers={isVCFollower:ae.UQ,isVCPresenter:ae.oz},A.Ps3.openSafeLink=se.dq,A.Ps3.isSheetWorkerEnabled=function(){return!!(0,_.getIsSheet)()&&(0,C.getSheetWorkerEnable)()},A.Ps3.baseURL=(0,p.getAPIPrefix)(),A.Ps3.apiURLs=v.apiUrls,A.Ps3.clipboardManager=m.p4,A.Ps3.SheetClipboardDataType=m.dt,A.Ps3.getSheetFilterDateAggregationEnabled=C.getSheetFilterDateAggregationEnabled,A.Ps3.getSheetFontDataCleanEnable=C.getSheetFontDataCleanEnable,A.Ps3.getImageRectByEqualEnable=C.getImageRectByEqualEnable,A.Ps3.getSheetDefaultFontFamily=_.getFontFamilyV2,A.Ps3.getNoPermissionPlaceHolderImgUrl=ve._,A.Ps3.getSheetImportRangeHostWhitelist=_.getSheetImportRangeHostWhitelist,A.Ps3.getIsSheetCustomIconEnabled=C.getIsSheetCustomIconEnabled,A.Ps3.getHelpCenterUrl=function(){return(0,v.getSheetsHelpCenterURL)()},A.Ps3.showAiInline=ue.showAiInline,A.Ps3.showExportPreview=ue.showExportPreview,A.Ps3.getAddNoteEnabled=C.getAddNoteEnabled,A.Ps3.getAddDiagonalEnabled=C.getAddDiagonalEnabled,A.Ps3.getSheetInvisibleProtectionPortEnabled=C.getSheetInvisibleProtectionPortEnabled,A.Ps3.getImportFormulaEnable=C.getImportFormulaEnable,A.Ps3.getImportRangeV3Enable=C.getImportRangeV3Enable,A.Ps3.getImportRangeV2Enable=C.getImportRangeV2Enable,A.Ps3.getAiProgressBarEnabled=C.getAiProgressBarEnabled,A.Ps3.getMentionOptimizeEnabled=C.getMentionOptimizeEnabled,A.Ps3.pivotTableHelper={movePivotTable:Te,getFilterSort:Se,getCollapse:we,renderPivotTableWithPosition:Re},A.Ps3.shortcutLog=y.shortcutLog,A.Ps3.shouldRuntimeAllowPrint=_.shouldRuntimeAllowPrint,A.Ps3.reportSheetRenderStageDuration=y.reportSheetRenderStageDuration,A.Ps3.translateHelper={toAILabTypeData:p.toAILabTypeData,toLineTexts:p.toLineTexts,translate:p.translate,getDocxTranslationLLMEnabled:C.getDocxTranslationLLMEnabled,getSheetTranslateTextCount:C.getSheetTranslateTextCount,blurOnSheet:E.st}}function ye(){var e;if((0,ce.XU)())return!1;if(!l().isOpendoc)return!0;var t=(0,_.getOpendocCollaboratorConfig)();return null===(e=null==t?void 0:t.enable)||void 0===e||e}function me(){return(me=(0,o.Z)(i().mark((function e(t,n){var r,o,a,s,u,l,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(be(["copy","cut","paste","delRowOrCol","addRowOrColAhead","addRowOrColBehind","unhideCol","unhideRow"],t)){e.next=2;break}return e.abrupt("return");case 2:r={target:"none",action_type:"hot_key",click:""},o={},a=(0,le.ub)(n),s=a.isRow,u=a.isCol,l=a.rowCount,c=a.colCount,e.t0=t,e.next="copy"===e.t0||"cut"===e.t0?8:"delRowOrCol"===e.t0?11:"addRowOrColAhead"===e.t0?17:"addRowOrColBehind"===e.t0?24:"unhideCol"===e.t0||"unhideRow"===e.t0?31:36;break;case 8:return o.click=t,o.cell_num=(0,le.Nw)(n),e.abrupt("break",37);case 11:if(s||u){e.next=13;break}return e.abrupt("break",37);case 13:return o.click="delete_row_column",o.type=u?"col":"row",o.number=u?c:l,e.abrupt("break",37);case 17:if(s||u){e.next=19;break}return e.abrupt("break",37);case 19:return o.click="insert_row_column",o.toward=u?"left":"up",o.type=u?"col":"row",o.number=1,e.abrupt("break",37);case 24:if(s||u){e.next=26;break}return e.abrupt("break",37);case 26:return o.click="insert_row_column",o.toward=u?"right":"down",o.type=u?"col":"row",o.number=1,e.abrupt("break",37);case 31:if(s||u){e.next=33;break}return e.abrupt("break",37);case 33:return o.click="unhide_row_column",o.type=u?"col":"row",e.abrupt("break",37);case 36:return e.abrupt("break",37);case 37:return Object.assign(r,o),e.abrupt("return",r);case 39:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ee(){return(Ee=(0,o.Z)(i().mark((function e(t,n){var r,o,a,s,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(be(["hideCol","hideRow"],t)){e.next=2;break}return e.abrupt("return");case 2:r={target:"none",action_type:"hot_key",click:""},o={},a=(0,le.ub)(n),s=a.rowCount,u=a.colCount,e.t0=t,e.next="hideCol"===e.t0?8:"hideRow"===e.t0?12:16;break;case 8:return o.click="hide_row_column",o.type="col",o.number=u,e.abrupt("break",17);case 12:return o.click="hide_row_column",o.type="row",o.number=s,e.abrupt("break",17);case 16:return e.abrupt("break",17);case 17:return Object.assign(r,o),e.abrupt("return",r);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function be(e,t){return e.includes(t)}function Te(e,t,n,r,i){return Ce.apply(this,arguments)}function Ce(){return Ce=(0,o.Z)(i().mark((function e(t,n,r,o,a){var s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.inject(ge.Cy),e.next=3,s.movePivotTable(n,r,o,a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),Ce.apply(this,arguments)}function Se(e,t,n){return e.inject(ge.Cy).getFilterSort(t,n)}function we(e,t,n){return e.inject(ge.Cy).getCollapse(t,n)}function Re(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},a=e.inject(ge.gJ);return a.renderPivotTableWithPosition(t,n,r,i,o)}},vsh_75033:function(e,t,n){"use strict";n.d(t,{XN:function(){return u},vb:function(){return l},ZC:function(){return c},ex:function(){return h},KV:function(){return f},kv:function(){return p}});var r,i=n("vsh_6127"),o=n.n(i),a=n("vsh_22488"),s=function(){!function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(!e)return;if(e.classList)return void n.forEach((function(t){return e.classList.remove(t)}));if(!e.getAttribute)return;var i=(e.getAttribute("class")||"").split(" ").filter((function(e){return!n.includes(e)})).join(" ");e.setAttribute("class",i)}(document.getElementsByTagName("html")[0],"SSR"),g(document.querySelector("#SSRStyle")),g(document.querySelector("#wikiSSRStyle"))};function u(){var e;(e=document.getElementById("miniapp-faster"))&&(e.style.display="flex",e.style.visibility="",e.style.position="relative",e.style.bottom="",e.style.zIndex="",e.style.width="100%",e.style.height="100%",e.classList.add("flex"),e.classList.add("layout-column")),function(){try{s();var e=document.querySelector("#ssrBox");if(e){window.isWikiSSR||function(){try{var e=document.querySelector("#ssrBox");if(e){var t=e.querySelector(".navigation-bar-wrapper");t&&(t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.width="100%",e.prepend?e.prepend(t):e.appendChild(t))}}catch(e){console.error("ssrBox",e)}}();var t=e.querySelector("#mainContainer");t&&v(t),window.sheet_fvg=null}}catch(e){console.error("ssrBox",e)}}()}function l(){try{if(window.isWikiSSR)return void(0,a.removeWikiSSR)("sheet");var e=document.querySelector("#ssrBox");e&&v(e)}catch(e){console.error("ssrBox",window.isWikiSSR,e)}}function c(){if(void 0!==r)return r;try{r=!!(window.sheet_fvg||document.getElementById("ssrBox")||document.getElementById("sheet-header-ssr"))}catch(e){console.error("ssrBox",e),r=!1}return r}function h(){if(c()){var e=document.querySelector("#ssr_loading_box");e&&document.getElementsByTagName("body")[0].removeChild(e)}}var d=!1;function f(){return!!d||(d=!!document.getElementById("ssr-svg"))}function p(){d=!1}function v(e){g(e)}function g(e){e&&(o().isIE&&e.parentNode?e.parentNode.removeChild(e):e.remove())}},vsh_22758:function(e,t,n){"use strict";n.d(t,{h:function(){return u},S:function(){return l}});var r=n("vsh_22488"),i=n("vsh_14801"),o=n("vsh_18801"),a=n("vsh_18856");function s(){var e=(0,(0,o.getSyncHelpers)().getReduxState)(),t=(0,a.selectCurrentSuiteOtherPermissions)(e);return t&&!t.copyable}function u(e){return r.actionManager.checkAction(r.IActions.DOCCONTENTCOPY)?!s()||(e&&e.preventDefault(),o.store.dispatch((0,i.copyTextWithoutPermission)()),!1):(null==e||e.preventDefault(),!1)}function l(){var e;return!(null===(e=(0,a.selectCurrentActionManagerSecurity)(o.store.getState()))||void 0===e||!e.docContentCopy)&&!s()}},vsh_32323:function(e,t,n){"use strict";n.d(t,{N:function(){return v},_:function(){return _}});var r=n("vsh_67017"),i=n.n(r),o=n("vsh_35067"),a=n("vsh_6127"),s=n.n(a),u=n("vsh_69691"),l=n("vsh_18801"),c=n("vsh_22488"),h=n("vsh_82905"),d=n("vsh_91781"),f=function(e,t){if(e){var n=e.viewer.image;n.setAttribute("data-printable","".concat(t.print)),n.setAttribute("data-exportable","".concat(t.export)),n.setAttribute("data-copyable","".concat(t.copy))}},p=function(e,t,n,r){return function(){var i;if(t){var o=n.getService(h.Qh).checkAttachment(t,{onPermissionFetched:function(){var r=n.getService(h.Qh).checkAttachment(t);f(e,r)}});f(e,o),null==r||null===(i=r.viewed)||void 0===i||i.call(r)}}};function v(e,t,n,r){return g.apply(this,arguments)}function g(){return(g=(0,o.Z)(i().mark((function e(t,n,r,o){var a,u,f,v,g,_,y,m,E,b;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=document.createElement("img"),!s().isOpendoc){e.next=7;break}return e.next=4,(0,c.getBlobUrl)(t);case 4:e.t0=e.sent,e.next=8;break;case 7:e.t0=t;case 8:return t=e.t0,a.setAttribute("data-src",t),u=r.getService(h.Qh).checkAttachment(n||""),f=u.exportable,e.next=13,(0,l.importUtilsViewer)();case 13:return v=e.sent,g=v.createViewer,_=v.MODULE_TYPE,y=v.TOOLBAR_TYPE,m={DEFAULT:[[y.ZOOM_OUT,!0],[y.ZOOM_IN,!0],[y.ROTATE_LEFT,!0],[y.ONE_TO_ONE,!0],[y.DOWNLOAD,!!f]],BLACK:[[y.PREV,!0],[y.PAGE_NUM,!0],[y.NEXT,!0],[y.SEPARATOR_LINE,!0],[y.ZOOM_OUT,!0],[y.RATIO,!0],[y.ZOOM_IN,!0],[y.ONE_TO_ONE,!0],[y.SEPARATOR_LINE,!0],[y.ROTATE_LEFT,!0],[y.DOWNLOAD,!!f]]},E=(0,c.getMinaConfig)("image_viewer_theme","DEFAULT"),(b=g(a,{container:"#editorcontainerbox",toolbar:m[E],theme:E,hidden:function(){var e;b.destroy(),b=null,null==o||null===(e=o.hidden)||void 0===e||e.call(o)},report:null==o?void 0:o.report,viewed:p(a,n,r,o),onDownload:function(){(0,d.GN)(r,[n])}},_.SHEET)).show(),e.abrupt("return",b);case 23:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e,t){var n;if(t===h.j6.CHECKING)n=(0,c.getResourceUrl)("sheet.dlp_attachment_checking");else if(t===h.j6.DELETED)n=(0,c.getResourceUrl)("sheet.dlp_attachment_deleted");else{var r="zh"===(0,u.getLanguageV1)()?{preview:"sheet.file_cannot_preview_placeHolder_zh",export:"sheet.file_cannot_download_placeHolder_zh",print:"sheet.file_cannot_print_placeHolder_zh"}[e]:{preview:"sheet.file_cannot_preview_placeHolder_en",export:"sheet.file_cannot_download_placeHolder_en",print:"sheet.file_cannot_print_placeHolder_en"}[e];n=(0,c.getResourceUrl)(r)}return n}},vsh_25285:function(e,t,n){"use strict";n.d(t,{hJ:function(){return l.h},Sr:function(){return l.S},vk:function(){return c},B:function(){return h},nG:function(){return p},dq:function(){return v},Rp:function(){return g},zC:function(){return _},yH:function(){return y},rV:function(){return m},qv:function(){return E},kM:function(){return b},Pc:function(){return T},oc:function(){return C},ew:function(){return S}});var r=n("vsh_96636"),i=n("vsh_47361"),o=n("vsh_69691"),a=n("vsh_12484"),s=n("vsh_22488"),u=n("vsh_96579"),l=n("vsh_22758");n("vsh_73043");function c(e){var t=s.browser.isMac;return!(t&&e&&e.metaKey)&&!(!t&&e.ctrlKey)}function h(e){var t={logParams:{location:i.SECURE_LINK_LOG.CCM_SHEET}};return(0,o.hasUrlProtocol)(e)||(e="http://".concat(e)),(0,i.getSecureLink)(e,t)}function d(e,t,n){try{var r=new URL(e);return r.searchParams.set(t,n),r.href}catch(t){return e}}function f(){var e=(0,s.locateRoute)();return e.isDoc||e.isWikiIndex?a.FROM_SOURCE_TYPE.PARENT_DOC:e.isSheet?a.FROM_SOURCE_TYPE.PARENT_SHEET:e.isBitable?a.FROM_SOURCE_TYPE.PARENT_BITABLE:""}function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("string"!=typeof e)return!1;if(""===(e=e.trim()))return!1;if((0,o.getFileToken)(e)&&(e=d(e,"from",f())),(0,o.hasUrlProtocol)(e)||(e="http://".concat(e)),e){try{if(s.browser.isMobile)return location.href=e,!0;if(e.startsWith(location.origin)){var t=(0,s.protectedOpenLink)(e,"_blank");t&&(t.opener=null)}else(0,s.protectedOpenLink)(e,"_blank","noopener")}catch(e){return u.moirae.ravenCatch(e),!1}return!0}return!1}function v(e){return p(h(e))}function g(e){switch(String(e)){case"0":default:return"overflow";case"1":return"autowrap";case"2":return"clip"}}function _(e){switch(Number(e)){case 0:default:return"left";case 1:return"center";case 2:return"right"}}function y(e){switch(Number(e)){case 0:return"up";case 1:return"center";default:return"down"}}function m(e,t){if("boolean"==typeof t){var n=e.spread;if(n.updatePermissionVersion(),n.sheets.forEach((function(e){return e.options.isProtected=!t})),!t){var r=n.getActiveSheet(),i=e.getPlugin("CellEditorPlugin");r&&i&&i.endEdit({sheet:r,ignoreValueChange:!0})}}else console.error("param has to be a boolean")}function E(e,t){"boolean"==typeof t?e.options.isProtected=!t:console.error("param has to be a boolean")}var b=function(e){return(0,r.default)(e,200)};function T(){var e=(0,s.getCurrentUser)();return s.browser.isOpendoc&&String(e.get("user_type"))===a.USER_TYPE.APPUSER}var C=function(e){var t;try{t=window.atob(e)}catch(e){t=""}return t},S=function(e){var t;try{t=window.btoa(e)}catch(e){t=""}return t}},vsh_89722:function(e,t,n){"use strict";var r;n.d(t,{n:function(){return r}}),function(e){e[e.OLD=3]="OLD",e[e.NEW_SPLIT_CODE=4]="NEW_SPLIT_CODE",e[e.CS_GZIP=5]="CS_GZIP",e[e.NODE=6]="NODE",e[e.REF=7]="REF",e[e.BACKWARD=8]="BACKWARD",e[e.MUTATION=9]="MUTATION"}(r||(r={}))},vsh_40338:function(e,t,n){"use strict";var r;!function(e){e.SET_VALUE="setValue",e.SET_FORMULA="setFormula",e.SET_STYLE="setStyle",e.ADD_SHEET="addSheet",e.CREATE="create",e.SORT="sort",e.SET_CELL="setCell",e.SET_SPANS="setSpans",e.SET_COLUMN_WIDTH="setColumnWidth",e.SET_ROW_HEIGHT="setRowHeight",e.SET_SHEET="setSheet",e.COPY_SHEET="copySheet",e.DEL_SHEET="delSheet",e.SOFT_DEL_SHEET="softDelSheet",e.RESTORE_SHEET="restoreSheet",e.MOVE_SHEET="moveSheet",e.ADD_ROW="addRow",e.ADD_COL="addCol",e.DEL_ROW="delRow",e.DEL_COL="delCol",e.HIDE_ROW="hideRow",e.UNHIDE_ROW="unhideRow",e.HIDE_COL="hideCol",e.UNHIDE_COL="unhideCol",e.DEL_FILTER="delFilter",e.SET_FILTER="setFilter",e.FREEZE_SHEET="freezeSheet",e.ADD_COMMENTS="addComments",e.RECOVER="recover",e.LOCK_ROW="lockRow",e.UNLOCK_ROW="unlockRow",e.LOCK_COL="lockCol",e.UNLOCK_COL="unlockCol",e.LOCK_SHEET="lockSheet",e.UNLOCK_SHEET="unlockSheet",e.SET_CHART="setChart",e.DEL_CHART="delChart",e.SET_FLOAT_IMAGE="setFloatImage",e.DEL_FLOAT_IMAGE="delFloatImage",e.SET_FLOAT_BLOCK="setFloatBlock",e.DEL_FLOAT_BLOCK="delFloatBlock",e.ADD_CONDITIONAL_FORMAT="addConditionalFormat",e.SET_CONDITIONAL_FORMAT="setConditionalFormat",e.DEL_CONDITIONAL_FORMAT="delConditionalFormat",e.MOVE_CONDITIONAL_FORMAT="moveConditionalFormat",e.COVER_SNAPSHOT="coverSnapshot",e.ADD_BLOCK="addBlock",e.DEL_BLOCK="delBlock",e.RESTORE_BLOCK="restoreBlock",e.MOVE_RANGE="moveRange",e.COVER_SHEET="coverSheet",e.TID_SPLIT="tidSplit",e.SET_RANGE="setRange",e.UPDATE_RANGE="updateRange",e.SET_RANGE_VALUES="setRangeValues",e.SET_FORM_DATA="setFormData",e.SET_COL_PROPERTY="setColProperty",e.SET_ROW_PROPERTY="setRowProperty",e.ADD_VIEW="addView",e.SET_VIEW="setView",e.DEL_VIEW="delView",e.SET_FILTER_VIEW="setFilterView",e.LOCAL_ACTIVE_VIEW="localActiveView",e.LOCAL_DEACTIVE_VIEW="localDeactiveView",e.UPDATE_REFERENCE="updateReference",e.MIX_RELOAD="mixReload",e.SET_DATA_RANGE="setDataRange",e.DEL_DATA_RANGE="delDataRange",e.EDIT_CHART="editChart",e.SET_EMBEDDED_BLOCK="setEmbeddedBlock",e.DEL_EMBEDDED_BLOCK="delEmbeddedBlock",e.EDIT_PIVOT_TABLE="editPivotTable",e.ADD_OUTLINE="addOutline",e.UPDATE_OUTLINE="updateOutline",e.DEL_OUTLINE="delOutline",e.ADD_SPARKLINE_GROUP="addSparklineGroup",e.UPDATE_SPARKLINE_GROUP="updateSparklineGroup",e.DELETE_SPARKLINE_GROUP="delSparklineGroup",e.SET_RANGE_PROTECTION="setRangeProtection",e.DEL_RANGE_PROTECTION="delRangeProtection"}(r||(r={}))},vsh_38165:function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={};if(e.rows&&e.rows.length)for(var r=0,i=e.rows.length;r<i;r++){var o=e.rows[r];if(o&&o.columns&&o.columns.length){n[t+r]={};for(var a=0,s=o.columns.length;a<s;a++){var u=o.columns[a];u&&(n[t+r][a]=u)}}}return n}n.d(t,{B:function(){return r}})},vsh_65780:function(e,t,n){"use strict";n.d(t,{iv:function(){return r.gzip},ec:function(){return r.ungzip}});var r=n("vsh_69691")},vsh_73129:function(e,t,n){"use strict";n.r(t),n.d(t,{getAppNameFromConfig:function(){return f}});var r,i,o,a,s,u=n("vsh_13867"),l=n("vsh_59980"),c=null,h="undefined"==typeof window?n.g:window,d=(r={zh:"zh-CN",en:"en-US",ja:"ja-JP",fr:"fr-FR",hi:"hi-IN",id:"id-ID",it:"it-IT",ko:"ko-KR",pt:"pt-BR",ru:"ru-RU",th:"th-TH",vi:"vi-VN",de:"de-DE",es:"es-ES","zh-TW":"zh-TW","zh-HK":"zh-HK",ms:"ms-MY"},i=(0,l.default)(h,"User.language"),o=(0,l.default)(h,"navigator.language"),s=(a=i||o||"").split("-")[0],r[a]||r[s]||"en-US");function f(){if(null!==c)return c;var e="Lark";try{var t=h.globalConfig?h.globalConfig.common:h.backupDomain.ext,n="common.".concat((0,l.default)(t,"brand.app_name","").toLowerCase()),r=h.TTI18N[n];r&&(e=r)}catch(e){}return c=function(){var e=h.globalKaConfig;if(e){var t=(0,l.default)(e,"i18n.IDS_LARK_PRODUCT_NAME");return(0,u.Z)(t)?t:""}}()||function(){var e=h.globalKaConfig;if(e){var t=(0,l.default)(e,"i18n.app_name.$base","");return(0,l.default)(e,"i18n.app_name[".concat(d,"]"),t)}}()||function(){if(h.materialConfig)return h.materialConfig.brand_app_name}()||e}},vsh_40220:function(e,t,n){var r=n("vsh_73129").getAppNameFromConfig;e.exports=function(e){var t=r();return e.replace(/\{\{APP_DISPLAY_NAME\}\}/g,t)}},vsh_25936:function(e){var t={zh:"zh-CN",en:"en-US",ja:"ja-JP",fr:"fr-FR",hi:"hi-IN",id:"id-ID",it:"it-IT",ko:"ko-KR",pt:"pt-BR",ru:"ru-RU",th:"th-TH",vi:"vi-VN",de:"de-DE",es:"es-ES","zh-TW":"zh-TW","zh-HK":"zh-HK"};e.exports=function(){if("undefined"!=typeof window){var e=function(){if("undefined"!=typeof window)return window.User&&window.User.language}()||function(e){if("undefined"!=typeof document){var t=document.cookie.match(new RegExp("(?:^|;)\\s*"+e+"=([^;]+)"));return decodeURIComponent(t?t[1]:"")}}("lang")||window.navigator.language;return t[e]||"en-US"}}},vsh_73043:function(e,t,n){var r=n("vsh_80420"),i=n("vsh_40220"),o=n("vsh_25936"),a=r.t;a.locales=o();var s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:void 0;e.exports=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=a.apply(null,t);return!r&&null!=s&&s.TTI18N?i(a.apply(null,t)):i("function"==typeof r?r(t):r)}},vsh_24627:function(e,t,n){"use strict";n.d(t,{aOo:function(){return re},nbU:function(){return no},pen:function(){return Ga},Fsj:function(){return Eo},iZz:function(){return rr},Usq:function(){return wo},crM:function(){return xc},PnZ:function(){return Rl},t$k:function(){return $r},brm:function(){return Jn},WS3:function(){return Xt},Qd5:function(){return Lr},S7R:function(){return qt},JXV:function(){return Qt},j_i:function(){return nn},U1p:function(){return en},BCb:function(){return tn},nFA:function(){return Hr},vgr:function(){return xt},NVo:function(){return Ih},X71:function(){return At},kHU:function(){return wt},BNj:function(){return Zh},IuI:function(){return la},w8i:function(){return sn},vYI:function(){return fo},oTS:function(){return br},Jfb:function(){return ea},eFJ:function(){return rn},LN0:function(){return Dc},QlZ:function(){return ha},VzB:function(){return Sr},gAB:function(){return jt},I1b:function(){return Lt},DqO:function(){return Ht},RWb:function(){return Mo},BxA:function(){return pn},XFC:function(){return vl},Ve9:function(){return Po},mwS:function(){return _t},rvF:function(){return Zn},qaf:function(){return Et},CPf:function(){return bc},Da0:function(){return _a},CyK:function(){return Gt},MO8:function(){return Tc},b66:function(){return Do},n0b:function(){return an},B$J:function(){return Cr},VVE:function(){return Fc},SS6:function(){return Tn},m2A:function(){return un},h2P:function(){return ln},m5l:function(){return Cc},fmI:function(){return ye},OSP:function(){return $o},OvR:function(){return Jo},Nmp:function(){return jo},JTr:function(){return zc},ps3:function(){return ql},x5e:function(){return Yo},kFS:function(){return ma},cvC:function(){return Co},Psm:function(){return co},f9g:function(){return vn},ZB9:function(){return dn},D1r:function(){return fn},vpe:function(){return Kl},QOl:function(){return ua},zW2:function(){return Vo},yre:function(){return xr},DGv:function(){return pa},u9N:function(){return Uo},Dcv:function(){return Zo},TTY:function(){return zn},G9j:function(){return mt},ubj:function(){return xo},NxK:function(){return Io},xOW:function(){return va},NfN:function(){return Nn},Qbo:function(){return xn},O6N:function(){return Cn},KUy:function(){return Dt},Uhd:function(){return Rt},oEi:function(){return cn},Z3k:function(){return ga},KqL:function(){return Ro},PoN:function(){return go},u1j:function(){return cs},e0M:function(){return Er},pCG:function(){return Ea},roj:function(){return Gc},P_e:function(){return Hc},FKW:function(){return $t},i$H:function(){return Jt},AXu:function(){return Zr},rur:function(){return Wr},K$W:function(){return Vr},R7l:function(){return Fr},njA:function(){return $n},rBk:function(){return qn},DZv:function(){return or},waj:function(){return Yn},TiA:function(){return Bo},VDZ:function(){return Kr},G9b:function(){return La},z6B:function(){return ks},X2l:function(){return Qn},tV8:function(){return Vt},Px:function(){return kt},FHD:function(){return th},G2P:function(){return nh},HA_:function(){return Ko},UkI:function(){return Xo},$qQ:function(){return pr},c84:function(){return yt},Nfu:function(){return Ho},OJq:function(){return rs},FJE:function(){return ir},vmn:function(){return gr},B81:function(){return gt},KGF:function(){return Sc},sws:function(){return hn},w2y:function(){return tr},BX:function(){return di},KXM:function(){return pi},Bge:function(){return Ol},G2r:function(){return Ml},fkS:function(){return Xn},MSA:function(){return Go},TfY:function(){return Sa},whE:function(){return Ut},Lu8:function(){return fa},HwA:function(){return hi},A7c:function(){return aa},W9G:function(){return Mh},ULn:function(){return Rr},Cl4:function(){return $l},xj7:function(){return nr},nn5:function(){return po},r16:function(){return ko},cPJ:function(){return Kt},KNj:function(){return gn},gHA:function(){return cr},Fh1:function(){return lr},qO2:function(){return Nc},K6s:function(){return hr},ZL2:function(){return na},Ck$:function(){return ya},U1D:function(){return ia},Oc7:function(){return ca},iv7:function(){return ra},jVu:function(){return Dr},MUh:function(){return _n},CSR:function(){return qo},RTf:function(){return oa},TcH:function(){return vr},A_Y:function(){return So},$wA:function(){return jc},Ps3:function(){return io},U_F:function(){return yo},EEh:function(){return Kn},Jm9:function(){return ba},dxy:function(){return Wc},B2l:function(){return St},rWX:function(){return lc},Ec3:function(){return Ur},jy$:function(){return mo},ned:function(){return Wt},hFH:function(){return pu},is3:function(){return Tr},WjP:function(){return wr},NNx:function(){return Ct},v5m:function(){return Pr},fW_:function(){return Ir},bPy:function(){return kr},$UQ:function(){return Pt},HaZ:function(){return _o},Wa0:function(){return mr},Gvu:function(){return Pn},dux:function(){return Al},HjE:function(){return Ia},AXv:function(){return Or},hYU:function(){return Ar},mcK:function(){return vt},aBM:function(){return Oo},Hg0:function(){return fl},rrR:function(){return Yt},hrX:function(){return Lc},iPD:function(){return da},Y6H:function(){return To},Q5A:function(){return bo},hWC:function(){return Pc},$AG:function(){return fi},EsU:function(){return es},$om:function(){return Mt},G0H:function(){return Mr},yC8:function(){return wc},g$I:function(){return Ao},cOW:function(){return Ot},ze4:function(){return Eu},CPL:function(){return Gh},UIE:function(){return Bl},tVG:function(){return Yr},h$Q:function(){return zr},Bep:function(){return gu},QAv:function(){return ho},yGW:function(){return vu},nVX:function(){return zl},fs4:function(){return Ul},xEd:function(){return Vh},Y_J:function(){return vo},RHc:function(){return Ah},rx6:function(){return mc},gw3:function(){return ns},Pho:function(){return _h},VCn:function(){return xl},t35:function(){return Ls},YY8:function(){return Fl},h_E:function(){return Nl},NN_:function(){return Gr},LCc:function(){return ur},i4Q:function(){return sr},fdi:function(){return Dl},eRv:function(){return Ll},OU8:function(){return Pl},Z6r:function(){return Kh},tlI:function(){return ul},j5Q:function(){return Sh},OCe:function(){return wh},FPR:function(){return Lh},J1c:function(){return Xh},dNX:function(){return ts},d$b:function(){return jn},$H$:function(){return Vs},gAR:function(){return yl},lYS:function(){return gc},zsn:function(){return Ca},$$w:function(){return gl},ytD:function(){return _l},XwI:function(){return ll},wCg:function(){return Rc},Ulc:function(){return ta},Gkz:function(){return cc},sBS:function(){return hc},MAs:function(){return Oc},MFi:function(){return Ic},w9Z:function(){return Mc},M10:function(){return Qo},UFo:function(){return Rh},N$c:function(){return xs},BNt:function(){return oo},L0c:function(){return Gn},XvZ:function(){return Ps},US_:function(){return kl},xK_:function(){return Jc},g6u:function(){return hu},B8N:function(){return dc},egz:function(){return El},D5c:function(){return ml},dK5:function(){return Xl},zC6:function(){return pc},jLg:function(){return Ac},$1K:function(){return uc},czp:function(){return fc},eYO:function(){return al},TvB:function(){return _u},ivc:function(){return Ke.gzip},pvT:function(){return Bs},ixe:function(){return dl},dgo:function(){return Eh},hdC:function(){return ja},qTe:function(){return Qr},bSc:function(){return us},S3_:function(){return ou},Lod:function(){return Cs},qdm:function(){return _c},i55:function(){return pl},YF0:function(){return Rn},mzR:function(){return As},MKc:function(){return Jr},FqT:function(){return ys},q8:function(){return oi},wTg:function(){return ei},mcV:function(){return ti},_Wm:function(){return au},PzA:function(){return ps},MgP:function(){return su},r$6:function(){return ai},klN:function(){return ii},_DH:function(){return ws},TFt:function(){return ui},ROv:function(){return li},A$_:function(){return gs},ZxY:function(){return nu},Wmn:function(){return tu},ZR1:function(){return Es},mYQ:function(){return si},qBp:function(){return vc},jzH:function(){return mn},epN:function(){return cu},TZl:function(){return ru},j6Y:function(){return Ms},LV8:function(){return hl},nS0:function(){return En},y_b:function(){return Il},n5s:function(){return rc},AED:function(){return bn},SkF:function(){return ri},IXt:function(){return uu},e$B:function(){return wn},CHx:function(){return ds},RkF:function(){return Ke.isSameFileToken},DGn:function(){return On},vO:function(){return bs},It9:function(){return ls},ali:function(){return Xr},pPK:function(){return cl},X_h:function(){return os},qlZ:function(){return ni},CBv:function(){return Ba},tMY:function(){return iu},c1y:function(){return Mn},s9v:function(){return An},QFC:function(){return oc},ji5:function(){return Ks},uXx:function(){return ah},chq:function(){return Js},W43:function(){return qs},XP5:function(){return Qa},lIT:function(){return mh},Tcw:function(){return Ha},QYs:function(){return jh},Wng:function(){return Ds},$ES:function(){return Wa},WHH:function(){return yh},RdR:function(){return eu},hTd:function(){return Gs},VB2:function(){return zs},b$t:function(){return Hs},TMS:function(){return sl},ln8:function(){return ic},sus:function(){return sc},i$c:function(){return Hl},PxA:function(){return Xc},fI5:function(){return Ec},s$B:function(){return Jl},vRF:function(){return bh},SSR:function(){return rh},rR3:function(){return ar},ATv:function(){return Ua},R5d:function(){return jr},ecX:function(){return Ke.ungzip},YQF:function(){return Fs},Nsj:function(){return du},zOj:function(){return mu},LC$:function(){return yu},Dc1:function(){return yc}});var r=n("vsh_65498"),i=n("vsh_1139"),o=n("vsh_98652"),a=n("vsh_4175"),s=n("vsh_67017"),u=n.n(s),l=n("vsh_35067"),c=n("vsh_19264"),h=n("vsh_12064"),d=n("vsh_22462"),f=n("vsh_93035"),p=n("vsh_73455"),v=n("vsh_13431"),g=n("vsh_74561"),_=n("vsh_26171"),y=n("vsh_96636"),m=n("vsh_27679"),E=n("vsh_96206"),b=n("vsh_61906"),T=n("vsh_13599"),C=n("vsh_22796"),S=Math.max,w=Math.min;var R=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r-1;return void 0!==n&&(i=(0,C.Z)(n),i=n<0?S(r+i,0):w(i,r-1)),(0,b.Z)(e,(0,T.Z)(t,3),i,!0)},A=(0,E.Z)(R),O=n("vsh_94760"),M=n("vsh_59980"),k=n("vsh_37930"),I=n("vsh_89443"),x=n("vsh_85001"),N=n("vsh_93301"),P=n("vsh_47246"),L=n("vsh_29033"),D=n("vsh_24357");var F=function(e,t){return(null==e?0:e.length)?(t=void 0===t?1:(0,C.Z)(t),(0,D.Z)(e,t)):[]},B=n("vsh_46775"),V=n("vsh_13867"),H=n("vsh_21469"),U=n("vsh_63738"),Z=n("vsh_22485"),W=(n("vsh_63603"),n("vsh_77034")),j=n.n(W);var G,z,Y,X,K,q,$,J,Q,ee,te,ne,re,ie,oe,ae,se,ue,le,ce,he,de,fe,pe,ve,ge,_e,ye,me,Ee,be,Te,Ce,Se,we,Re,Ae,Oe,Me,ke,Ie,xe,Ne,Pe,Le,De,Fe,Be,Ve,He,Ue,Ze,We,je,Ge,ze,Ye,Xe,Ke=n("vsh_69691"),qe=n("vsh_61496"),$e=n("vsh_6127"),Je=n.n($e),Qe=n("vsh_33476"),et=n.n(Qe),tt=n("vsh_73565"),nt=n.n(tt),rt=n("vsh_93631"),it=n("vsh_64299"),ot=n("vsh_52690"),at=n("vsh_71561"),st=n("vsh_38383"),ut=n("vsh_56228"),lt=n("vsh_66988").Buffer,ct=n("vsh_73043");function ht(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return dt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function dt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}(Xe=re||(re={})).SET_VALUE="setValue",Xe.SET_FORMULA="setFormula",Xe.SET_STYLE="setStyle",Xe.ADD_SHEET="addSheet",Xe.CREATE="create",Xe.SORT="sort",Xe.SET_CELL="setCell",Xe.SET_SPANS="setSpans",Xe.SET_COLUMN_WIDTH="setColumnWidth",Xe.SET_ROW_HEIGHT="setRowHeight",Xe.SET_SHEET="setSheet",Xe.COPY_SHEET="copySheet",Xe.DEL_SHEET="delSheet",Xe.SOFT_DEL_SHEET="softDelSheet",Xe.RESTORE_SHEET="restoreSheet",Xe.MOVE_SHEET="moveSheet",Xe.ADD_ROW="addRow",Xe.ADD_COL="addCol",Xe.DEL_ROW="delRow",Xe.DEL_COL="delCol",Xe.HIDE_ROW="hideRow",Xe.UNHIDE_ROW="unhideRow",Xe.HIDE_COL="hideCol",Xe.UNHIDE_COL="unhideCol",Xe.DEL_FILTER="delFilter",Xe.SET_FILTER="setFilter",Xe.FREEZE_SHEET="freezeSheet",Xe.ADD_COMMENTS="addComments",Xe.RECOVER="recover",Xe.LOCK_ROW="lockRow",Xe.UNLOCK_ROW="unlockRow",Xe.LOCK_COL="lockCol",Xe.UNLOCK_COL="unlockCol",Xe.LOCK_SHEET="lockSheet",Xe.UNLOCK_SHEET="unlockSheet",Xe.SET_CHART="setChart",Xe.DEL_CHART="delChart",Xe.SET_FLOAT_IMAGE="setFloatImage",Xe.DEL_FLOAT_IMAGE="delFloatImage",Xe.SET_FLOAT_BLOCK="setFloatBlock",Xe.DEL_FLOAT_BLOCK="delFloatBlock",Xe.ADD_CONDITIONAL_FORMAT="addConditionalFormat",Xe.SET_CONDITIONAL_FORMAT="setConditionalFormat",Xe.DEL_CONDITIONAL_FORMAT="delConditionalFormat",Xe.MOVE_CONDITIONAL_FORMAT="moveConditionalFormat",Xe.COVER_SNAPSHOT="coverSnapshot",Xe.ADD_BLOCK="addBlock",Xe.DEL_BLOCK="delBlock",Xe.RESTORE_BLOCK="restoreBlock",Xe.MOVE_RANGE="moveRange",Xe.COVER_SHEET="coverSheet",Xe.TID_SPLIT="tidSplit",Xe.SET_RANGE="setRange",Xe.UPDATE_RANGE="updateRange",Xe.SET_RANGE_VALUES="setRangeValues",Xe.SET_FORM_DATA="setFormData",Xe.SET_COL_PROPERTY="setColProperty",Xe.SET_ROW_PROPERTY="setRowProperty",Xe.ADD_VIEW="addView",Xe.SET_VIEW="setView",Xe.DEL_VIEW="delView",Xe.SET_FILTER_VIEW="setFilterView",Xe.LOCAL_ACTIVE_VIEW="localActiveView",Xe.LOCAL_DEACTIVE_VIEW="localDeactiveView",Xe.UPDATE_REFERENCE="updateReference",Xe.MIX_RELOAD="mixReload",Xe.SET_DATA_RANGE="setDataRange",Xe.DEL_DATA_RANGE="delDataRange",Xe.EDIT_CHART="editChart",Xe.SET_EMBEDDED_BLOCK="setEmbeddedBlock",Xe.DEL_EMBEDDED_BLOCK="delEmbeddedBlock",Xe.EDIT_PIVOT_TABLE="editPivotTable",Xe.ADD_OUTLINE="addOutline",Xe.UPDATE_OUTLINE="updateOutline",Xe.DEL_OUTLINE="delOutline",Xe.ADD_SPARKLINE_GROUP="addSparklineGroup",Xe.UPDATE_SPARKLINE_GROUP="updateSparklineGroup",Xe.DELETE_SPARKLINE_GROUP="delSparklineGroup",Xe.SET_RANGE_PROTECTION="setRangeProtection",Xe.DEL_RANGE_PROTECTION="delRangeProtection",function(e){e[e.CommandType_UNSPEDIFIED=0]="CommandType_UNSPEDIFIED",e[e.CommandType_TOP_SNAPSHOT=1]="CommandType_TOP_SNAPSHOT",e[e.CommandType_RESOURCE_SNAPSHOT=2]="CommandType_RESOURCE_SNAPSHOT",e[e.CommandType_TABLE_SNAPSHOT=3]="CommandType_TABLE_SNAPSHOT"}(ie||(ie={})),function(e){e[e.MutationType_UNSPEDIFIED=0]="MutationType_UNSPEDIFIED",e[e.MutationType_SetWorkbookProperties=2]="MutationType_SetWorkbookProperties",e[e.MutationType_InsertSheet=3]="MutationType_InsertSheet",e[e.MutationType_DeleteSheet=4]="MutationType_DeleteSheet",e[e.MutationType_MoveSheet=5]="MutationType_MoveSheet",e[e.MutationType_SetSheetProperties=6]="MutationType_SetSheetProperties",e[e.MutationType_SetDimensionProperties=7]="MutationType_SetDimensionProperties",e[e.MutationType_InsertDimension=8]="MutationType_InsertDimension",e[e.MutationType_DeleteDimension=9]="MutationType_DeleteDimension",e[e.MutationType_MergeCells=10]="MutationType_MergeCells",e[e.MutationType_UnmergeCells=11]="MutationType_UnmergeCells",e[e.MutationType_SetRangeValues=12]="MutationType_SetRangeValues",e[e.MutationType_SetCellValues=13]="MutationType_SetCellValues",e[e.MutationType_MapRange=14]="MutationType_MapRange",e[e.MutationType_ReorderRange=15]="MutationType_ReorderRange",e[e.MutationType_AddWorkbookRange=16]="MutationType_AddWorkbookRange",e[e.MutationType_UpdateWorkbookRange=17]="MutationType_UpdateWorkbookRange",e[e.MutationType_DeleteWorkbookRange=18]="MutationType_DeleteWorkbookRange",e[e.MutationType_AddComment=19]="MutationType_AddComment",e[e.MutationType_AddReminder=20]="MutationType_AddReminder",e[e.MutationType_UpdateReminder=21]="MutationType_UpdateReminder",e[e.MutationType_DeleteReminder=22]="MutationType_DeleteReminder",e[e.MutationType_AddRangeProtection=23]="MutationType_AddRangeProtection",e[e.MutationType_UpdateRangeProtection=24]="MutationType_UpdateRangeProtection",e[e.MutationType_DeleteRangeProtection=25]="MutationType_DeleteRangeProtection",e[e.MutationType_SetSheetProtection=26]="MutationType_SetSheetProtection",e[e.MutationType_RemoveSheetProtection=27]="MutationType_RemoveSheetProtection",e[e.MutationType_AddConditionalFormatting=29]="MutationType_AddConditionalFormatting",e[e.MutationType_UpdateConditionalFormatting=30]="MutationType_UpdateConditionalFormatting",e[e.MutationType_DeleteConditionalFormatting=31]="MutationType_DeleteConditionalFormatting",e[e.MutationType_MoveConditionalFormatting=32]="MutationType_MoveConditionalFormatting",e[e.MutationType_SetAutoFilter=33]="MutationType_SetAutoFilter",e[e.MutationType_RemoveAutoFilter=34]="MutationType_RemoveAutoFilter",e[e.MutationType_AddCustomView=35]="MutationType_AddCustomView",e[e.MutationType_UpdateCustomView=36]="MutationType_UpdateCustomView",e[e.MutationType_DeleteCustomView=37]="MutationType_DeleteCustomView",e[e.MutationType_AddFloatImage=38]="MutationType_AddFloatImage",e[e.MutationType_UpdateFloatImage=39]="MutationType_UpdateFloatImage",e[e.MutationType_DeleteFloatImage=40]="MutationType_DeleteFloatImage",e[e.MutationType_AddFloatBlock=41]="MutationType_AddFloatBlock",e[e.MutationType_UpdateFloatBlock=42]="MutationType_UpdateFloatBlock",e[e.MutationType_DeleteFloatBlock=43]="MutationType_DeleteFloatBlock",e[e.MutationType_AddEmbeddedBlock=44]="MutationType_AddEmbeddedBlock",e[e.MutationType_UpdateEmbeddedBlock=45]="MutationType_UpdateEmbeddedBlock",e[e.MutationType_DeleteEmbeddedBlock=46]="MutationType_DeleteEmbeddedBlock",e[e.MutationType_AddSparklineGroup=47]="MutationType_AddSparklineGroup",e[e.MutationType_UpdateSparklineGroup=48]="MutationType_UpdateSparklineGroup",e[e.MutationType_DeleteSparklineGroup=49]="MutationType_DeleteSparklineGroup",e[e.MutationType_CopyPaste=50]="MutationType_CopyPaste",e[e.MutationType_CopySheet=51]="MutationType_CopySheet",e[e.MutationType_CoverSheet=52]="MutationType_CoverSheet",e[e.MutationType_CoverSnapshot=53]="MutationType_CoverSnapshot",e[e.MutationType_Recover=54]="MutationType_Recover",e[e.MutationType_SetChartMap=55]="MutationType_SetChartMap",e[e.MutationType_AddCalcResult=56]="MutationType_AddCalcResult"}(oe||(oe={})),function(e){e[e.PivotErrorState_None=0]="PivotErrorState_None",e[e.PivotErrorState_Shrink=1]="PivotErrorState_Shrink",e[e.PivotErrorState_Cover=2]="PivotErrorState_Cover",e[e.PivotErrorState_Circle=3]="PivotErrorState_Circle",e[e.PivotErrorState_ImportRange=4]="PivotErrorState_ImportRange",e[e.PivotErrorState_LessThanTwo=5]="PivotErrorState_LessThanTwo",e[e.PivotErrorState_CoverSource=6]="PivotErrorState_CoverSource",e[e.PivotErrorState_SourceHasPivot=7]="PivotErrorState_SourceHasPivot",e[e.PivotErrorState_ServiceCalcLoading=8]="PivotErrorState_ServiceCalcLoading",e[e.PivotErrorState_UnSupportVersion=9]="PivotErrorState_UnSupportVersion",e[e.PivotErrorState_FormulaError=10]="PivotErrorState_FormulaError",e[e.PivotErrorState_Loading=11]="PivotErrorState_Loading"}(ae||(ae={})),function(e){e[e.ConditionalFormatRuleTypes_UNSPEDIFIED=0]="ConditionalFormatRuleTypes_UNSPEDIFIED",e[e.ConditionalFormatRuleTypes_DUPLICATE_VALUES=1]="ConditionalFormatRuleTypes_DUPLICATE_VALUES",e[e.ConditionalFormatRuleTypes_UNIQUE_VALUES=2]="ConditionalFormatRuleTypes_UNIQUE_VALUES",e[e.ConditionalFormatRuleTypes_CELL_IS=3]="ConditionalFormatRuleTypes_CELL_IS",e[e.ConditionalFormatRuleTypes_CONTAINS_TEXT=4]="ConditionalFormatRuleTypes_CONTAINS_TEXT",e[e.ConditionalFormatRuleTypes_TIME_PERIOD=5]="ConditionalFormatRuleTypes_TIME_PERIOD",e[e.ConditionalFormatRuleTypes_CONTAINS_BLANKS=6]="ConditionalFormatRuleTypes_CONTAINS_BLANKS",e[e.ConditionalFormatRuleTypes_NOT_CONTAINS_BLANKS=7]="ConditionalFormatRuleTypes_NOT_CONTAINS_BLANKS",e[e.ConditionalFormatRuleTypes_DATA_BAR=8]="ConditionalFormatRuleTypes_DATA_BAR",e[e.ConditionalFormatRuleTypes_COLOR_SCALE=9]="ConditionalFormatRuleTypes_COLOR_SCALE",e[e.ConditionalFormatRuleTypes_RANK=10]="ConditionalFormatRuleTypes_RANK",e[e.ConditionalFormatRuleTypes_AVERAGE=11]="ConditionalFormatRuleTypes_AVERAGE",e[e.ConditionalFormatRuleTypes_EXPRESSION=12]="ConditionalFormatRuleTypes_EXPRESSION",e[e.ConditionalFormatRuleTypes_ICON_SET=13]="ConditionalFormatRuleTypes_ICON_SET"}(se||(se={})),function(e){e[e.CellIsRuleOperatorType_UNSPECIFIED=0]="CellIsRuleOperatorType_UNSPECIFIED",e[e.CellIsRuleOperatorType_EQUAL=1]="CellIsRuleOperatorType_EQUAL",e[e.CellIsRuleOperatorType_NOT_EQUAL=2]="CellIsRuleOperatorType_NOT_EQUAL",e[e.CellIsRuleOperatorType_GREATER=3]="CellIsRuleOperatorType_GREATER",e[e.CellIsRuleOperatorType_GREATER_OR_EQUAL=4]="CellIsRuleOperatorType_GREATER_OR_EQUAL",e[e.CellIsRuleOperatorType_LESS=5]="CellIsRuleOperatorType_LESS",e[e.CellIsRuleOperatorType_LESS_OR_EQUAL=6]="CellIsRuleOperatorType_LESS_OR_EQUAL",e[e.CellIsRuleOperatorType_BETWEEN=7]="CellIsRuleOperatorType_BETWEEN",e[e.CellIsRuleOperatorType_NOT_BETWEEN=8]="CellIsRuleOperatorType_NOT_BETWEEN"}(ue||(ue={})),function(e){e[e.ContainTextRuleOperatorType_UNSPECIFIED=0]="ContainTextRuleOperatorType_UNSPECIFIED",e[e.ContainTextRuleOperatorType_BEGINS_WITH=1]="ContainTextRuleOperatorType_BEGINS_WITH",e[e.ContainTextRuleOperatorType_ENDS_WITH=2]="ContainTextRuleOperatorType_ENDS_WITH",e[e.ContainTextRuleOperatorType_CONTAINS=3]="ContainTextRuleOperatorType_CONTAINS",e[e.ContainTextRuleOperatorType_DOES_NOT_CONTAIN=4]="ContainTextRuleOperatorType_DOES_NOT_CONTAIN",e[e.ContainTextRuleOperatorType_IS=5]="ContainTextRuleOperatorType_IS"}(le||(le={})),function(e){e[e.TimePeriodRuleOperatorType_UNSPECIFIED=0]="TimePeriodRuleOperatorType_UNSPECIFIED",e[e.TimePeriodRuleOperatorType_BEFORE=1]="TimePeriodRuleOperatorType_BEFORE",e[e.TimePeriodRuleOperatorType_IS=2]="TimePeriodRuleOperatorType_IS",e[e.TimePeriodRuleOperatorType_AFTER=3]="TimePeriodRuleOperatorType_AFTER"}(ce||(ce={})),function(e){e[e.TimePeriodType_UNSPECIFIED=0]="TimePeriodType_UNSPECIFIED",e[e.TimePeriodType_TODAY=1]="TimePeriodType_TODAY",e[e.TimePeriodType_YESTERDAY=2]="TimePeriodType_YESTERDAY",e[e.TimePeriodType_TOMORROW=3]="TimePeriodType_TOMORROW",e[e.TimePeriodType_LAST_7_DAYS=4]="TimePeriodType_LAST_7_DAYS",e[e.TimePeriodType_THIS_MONTH=5]="TimePeriodType_THIS_MONTH",e[e.TimePeriodType_LAST_MONTH=6]="TimePeriodType_LAST_MONTH",e[e.TimePeriodType_NEXT_MONTH=7]="TimePeriodType_NEXT_MONTH",e[e.TimePeriodType_THIS_WEEK=8]="TimePeriodType_THIS_WEEK",e[e.TimePeriodType_LAST_WEEK=9]="TimePeriodType_LAST_WEEK",e[e.TimePeriodType_NEXT_WEEK=10]="TimePeriodType_NEXT_WEEK"}(he||(he={})),function(e){e[e.AttrValueType_UNSPECIFIED=0]="AttrValueType_UNSPECIFIED",e[e.AttrValueType_MIN_VALUE=1]="AttrValueType_MIN_VALUE",e[e.AttrValueType_MAX_VALUE=2]="AttrValueType_MAX_VALUE",e[e.AttrValueType_NUM=3]="AttrValueType_NUM",e[e.AttrValueType_PERCENTILE=4]="AttrValueType_PERCENTILE",e[e.AttrValueType_PERCENT=5]="AttrValueType_PERCENT",e[e.AttrValueType_FORMULA=6]="AttrValueType_FORMULA",e[e.AttrValueType_AUTO=7]="AttrValueType_AUTO"}(de||(de={})),function(e){e[e.RankType_UNSPECIFIED=0]="RankType_UNSPECIFIED",e[e.RankType_PERCENT=1]="RankType_PERCENT",e[e.RankType_SORT=2]="RankType_SORT"}(fe||(fe={})),function(e){e[e.AverageType_UNSPECIFIED=0]="AverageType_UNSPECIFIED",e[e.AverageType_GREATER=1]="AverageType_GREATER",e[e.AverageType_GREATER_OR_EQUAL=2]="AverageType_GREATER_OR_EQUAL",e[e.AverageType_LESS=3]="AverageType_LESS",e[e.AverageType_LESS_OR_EQUAL=4]="AverageType_LESS_OR_EQUAL"}(pe||(pe={})),function(e){e[e.IconGroupType_UNSPECIFIED=0]="IconGroupType_UNSPECIFIED",e[e.IconGroupType_ARROWS_3=1]="IconGroupType_ARROWS_3",e[e.IconGroupType_ARROWS_GRAY_3=2]="IconGroupType_ARROWS_GRAY_3",e[e.IconGroupType_TRIANGLES_3=3]="IconGroupType_TRIANGLES_3",e[e.IconGroupType_ARROWS_GRAY_4=4]="IconGroupType_ARROWS_GRAY_4",e[e.IconGroupType_ARROWS_4=5]="IconGroupType_ARROWS_4",e[e.IconGroupType_ARROWS_GRAY_5=6]="IconGroupType_ARROWS_GRAY_5",e[e.IconGroupType_ARROWS_5=7]="IconGroupType_ARROWS_5",e[e.IconGroupType_CIRCLES_3=8]="IconGroupType_CIRCLES_3",e[e.IconGroupType_MULTI_GRAPHICS_3=9]="IconGroupType_MULTI_GRAPHICS_3",e[e.IconGroupType_CIRCLES_4=10]="IconGroupType_CIRCLES_4",e[e.IconGroupType_CIRCLES_5=11]="IconGroupType_CIRCLES_5",e[e.IconGroupType_STATUS_2=12]="IconGroupType_STATUS_2",e[e.IconGroupType_STATUS_3=13]="IconGroupType_STATUS_3",e[e.IconGroupType_COMMENT_STATUS_2=14]="IconGroupType_COMMENT_STATUS_2",e[e.IconGroupType_FLAGS_3=15]="IconGroupType_FLAGS_3",e[e.IconGroupType_STARS_3=16]="IconGroupType_STARS_3",e[e.IconGroupType_HEART_SHAPED_3=17]="IconGroupType_HEART_SHAPED_3",e[e.IconGroupType_MOOD_3=18]="IconGroupType_MOOD_3",e[e.IconGroupType_CIRCLES_RATIO_5=19]="IconGroupType_CIRCLES_RATIO_5"}(ve||(ve={})),function(e){e[e.IconsRuleOperatorType_UNSPECIFIED=0]="IconsRuleOperatorType_UNSPECIFIED",e[e.IconsRuleOperatorType_GREATER=1]="IconsRuleOperatorType_GREATER",e[e.IconsRuleOperatorType_GREATER_OR_EQUAL=2]="IconsRuleOperatorType_GREATER_OR_EQUAL",e[e.IconsRuleOperatorType_LESS=3]="IconsRuleOperatorType_LESS",e[e.IconsRuleOperatorType_LESS_OR_EQUAL=4]="IconsRuleOperatorType_LESS_OR_EQUAL"}(ge||(ge={})),function(e){e[e.EmbeddedBlockType_UNSPECIFIED=0]="EmbeddedBlockType_UNSPECIFIED",e[e.EmbeddedBlockType_PIVOT_TABLE=1]="EmbeddedBlockType_PIVOT_TABLE"}(_e||(_e={})),function(e){e[e.DateTimeGrouping_UNSPEDIFIED=0]="DateTimeGrouping_UNSPEDIFIED",e[e.DateTimeGrouping_YEAR=1]="DateTimeGrouping_YEAR",e[e.DateTimeGrouping_MONTH=2]="DateTimeGrouping_MONTH",e[e.DateTimeGrouping_DAY=3]="DateTimeGrouping_DAY",e[e.DateTimeGrouping_HOUR=4]="DateTimeGrouping_HOUR",e[e.DateTimeGrouping_MINUTE=5]="DateTimeGrouping_MINUTE",e[e.DateTimeGrouping_SECOND=6]="DateTimeGrouping_SECOND"}(ye||(ye={})),function(e){e[e.CustomFilterOperator_Equal=0]="CustomFilterOperator_Equal",e[e.CustomFilterOperator_NotEqual=1]="CustomFilterOperator_NotEqual",e[e.CustomFilterOperator_GreaterThan=2]="CustomFilterOperator_GreaterThan",e[e.CustomFilterOperator_GreaterThanOrEqual=3]="CustomFilterOperator_GreaterThanOrEqual",e[e.CustomFilterOperator_LessThan=4]="CustomFilterOperator_LessThan",e[e.CustomFilterOperator_LessThanOrEqual=5]="CustomFilterOperator_LessThanOrEqual",e[e.CustomFilterOperator_BeginsWith=6]="CustomFilterOperator_BeginsWith",e[e.CustomFilterOperator_DoesNotBeginWith=7]="CustomFilterOperator_DoesNotBeginWith",e[e.CustomFilterOperator_EndsWith=8]="CustomFilterOperator_EndsWith",e[e.CustomFilterOperator_DoesNotEndWith=9]="CustomFilterOperator_DoesNotEndWith",e[e.CustomFilterOperator_Contains=10]="CustomFilterOperator_Contains",e[e.CustomFilterOperator_DoesNotContain=11]="CustomFilterOperator_DoesNotContain"}(me||(me={})),function(e){e[e.FloatBlockType_UNSPECIFIED=0]="FloatBlockType_UNSPECIFIED",e[e.FloatBlockType_CHART=1]="FloatBlockType_CHART"}(Ee||(Ee={})),function(e){e[e.NotifyStrategyTypes_UNSPEDIFIED=0]="NotifyStrategyTypes_UNSPEDIFIED",e[e.NotifyStrategyTypes_AT_TIME_OF_EVENT=1]="NotifyStrategyTypes_AT_TIME_OF_EVENT",e[e.NotifyStrategyTypes_BEFORE_5_MINUTES=2]="NotifyStrategyTypes_BEFORE_5_MINUTES",e[e.NotifyStrategyTypes_BEFORE_15_MINUTES=3]="NotifyStrategyTypes_BEFORE_15_MINUTES",e[e.NotifyStrategyTypes_BEFORE_30_MINUTES=4]="NotifyStrategyTypes_BEFORE_30_MINUTES",e[e.NotifyStrategyTypes_BEFORE_1_HOUR=5]="NotifyStrategyTypes_BEFORE_1_HOUR",e[e.NotifyStrategyTypes_BEFORE_2_HOURS=6]="NotifyStrategyTypes_BEFORE_2_HOURS",e[e.NotifyStrategyTypes_AT_DAY_OF_EVENT=7]="NotifyStrategyTypes_AT_DAY_OF_EVENT",e[e.NotifyStrategyTypes_BEFORE_1_DAY=8]="NotifyStrategyTypes_BEFORE_1_DAY",e[e.NotifyStrategyTypes_BEFORE_2_DAYS=9]="NotifyStrategyTypes_BEFORE_2_DAYS",e[e.NotifyStrategyTypes_BEFORE_1_WEEK=10]="NotifyStrategyTypes_BEFORE_1_WEEK",e[e.NotifyStrategyTypes_AT_TIME_BEFORE_1_DAY=11]="NotifyStrategyTypes_AT_TIME_BEFORE_1_DAY",e[e.NotifyStrategyTypes_AT_TIME_BEFORE_2_DAYS=12]="NotifyStrategyTypes_AT_TIME_BEFORE_2_DAYS",e[e.NotifyStrategyTypes_AT_TIME_BEFORE_1_WEEK=13]="NotifyStrategyTypes_AT_TIME_BEFORE_1_WEEK"}(be||(be={})),function(e){e[e.CellValueType_UNSPEDIFIED=0]="CellValueType_UNSPEDIFIED",e[e.CellValueType_Bool=1]="CellValueType_Bool",e[e.CellValueType_Number=2]="CellValueType_Number",e[e.CellValueType_String=3]="CellValueType_String",e[e.CellValueType_Formula=4]="CellValueType_Formula",e[e.CellValueType_FormulaString=5]="CellValueType_FormulaString",e[e.CellValueType_RichString=6]="CellValueType_RichString",e[e.CellValueType_EmbedImage=7]="CellValueType_EmbedImage",e[e.CellValueType_Error=8]="CellValueType_Error"}(Te||(Te={})),function(e){e[e.CellExtendType_UNSPEDIFIED=0]="CellExtendType_UNSPEDIFIED",e[e.CellExtendType_Select=1]="CellExtendType_Select"}(Ce||(Ce={})),function(e){e[e.CellRunType_UNSPEDIFIED=0]="CellRunType_UNSPEDIFIED",e[e.CellRunType_Text=1]="CellRunType_Text",e[e.CellRunType_Mention=2]="CellRunType_Mention",e[e.CellRunType_Attachment=3]="CellRunType_Attachment",e[e.CellRunType_Hyperlink=4]="CellRunType_Hyperlink"}(Se||(Se={})),function(e){e[e.ErrorTipsType_None=0]="ErrorTipsType_None",e[e.ErrorTipsType_FormulaError=1]="ErrorTipsType_FormulaError",e[e.ErrorTipsType_TextualNumber=2]="ErrorTipsType_TextualNumber",e[e.ErrorTipsType_PivotNormalTableError=3]="ErrorTipsType_PivotNormalTableError",e[e.ErrorTipsType_Info=4]="ErrorTipsType_Info",e[e.ErrorTipsType_PivotServiceCalcLoading=5]="ErrorTipsType_PivotServiceCalcLoading"}(we||(we={})),function(e){e[e.HyperlinkType_UNSPEDIFIED=0]="HyperlinkType_UNSPEDIFIED",e[e.HyperlinkType_Normal=1]="HyperlinkType_Normal",e[e.HyperlinkType_Worksheet=2]="HyperlinkType_Worksheet",e[e.HyperlinkType_Range=3]="HyperlinkType_Range"}(Re||(Re={})),function(e){e[e.NoteValueType_UNSPEDIFIED=0]="NoteValueType_UNSPEDIFIED",e[e.NoteValueType_String=1]="NoteValueType_String",e[e.NoteValueType_RichString=2]="NoteValueType_RichString"}(Ae||(Ae={})),function(e){e[e.DataValidationConditionType_UNSPEDIFIED=0]="DataValidationConditionType_UNSPEDIFIED",e[e.DataValidationConditionType_List=1]="DataValidationConditionType_List",e[e.DataValidationConditionType_Number=2]="DataValidationConditionType_Number",e[e.DataValidationConditionType_Date=3]="DataValidationConditionType_Date",e[e.DataValidationConditionType_TextLength=4]="DataValidationConditionType_TextLength",e[e.DataValidationConditionType_Checkbox=5]="DataValidationConditionType_Checkbox"}(Oe||(Oe={})),function(e){e[e.ListSourceType_UNSPEDIFIED=0]="ListSourceType_UNSPEDIFIED",e[e.ListSourceType_Range=1]="ListSourceType_Range",e[e.ListSourceType_Items=2]="ListSourceType_Items"}(Me||(Me={})),function(e){e[e.NumberDataValidationOperator_UNSPEDIFIED=0]="NumberDataValidationOperator_UNSPEDIFIED",e[e.NumberDataValidationOperator_IsValid=1]="NumberDataValidationOperator_IsValid",e[e.NumberDataValidationOperator_Between=2]="NumberDataValidationOperator_Between",e[e.NumberDataValidationOperator_NotBetween=3]="NumberDataValidationOperator_NotBetween",e[e.NumberDataValidationOperator_EqualTo=4]="NumberDataValidationOperator_EqualTo",e[e.NumberDataValidationOperator_NotEqualTo=5]="NumberDataValidationOperator_NotEqualTo",e[e.NumberDataValidationOperator_GreaterThan=6]="NumberDataValidationOperator_GreaterThan",e[e.NumberDataValidationOperator_LessThan=7]="NumberDataValidationOperator_LessThan",e[e.NumberDataValidationOperator_GreaterThanOrEqualTo=8]="NumberDataValidationOperator_GreaterThanOrEqualTo",e[e.NumberDataValidationOperator_LessThanOrEqualTo=9]="NumberDataValidationOperator_LessThanOrEqualTo"}(ke||(ke={})),function(e){e[e.NumberType_UNSPEDIFIED=0]="NumberType_UNSPEDIFIED",e[e.NumberType_Integer=1]="NumberType_Integer",e[e.NumberType_Decimal=2]="NumberType_Decimal"}(Ie||(Ie={})),function(e){e[e.HandledWayOnInvalidData_UNSPEDIFIED=0]="HandledWayOnInvalidData_UNSPEDIFIED",e[e.HandledWayOnInvalidData_ShowWarning=1]="HandledWayOnInvalidData_ShowWarning",e[e.HandledWayOnInvalidData_RejectInput=2]="HandledWayOnInvalidData_RejectInput"}(xe||(xe={})),function(e){e[e.MENTION_TYPE_UNSPEDIFIED=0]="MENTION_TYPE_UNSPEDIFIED",e[e.MENTION_TYPE_USER=1]="MENTION_TYPE_USER",e[e.MENTION_TYPE_FILE=2]="MENTION_TYPE_FILE"}(Ne||(Ne={})),function(e){e[e.FILE_TYPE_UNSPEDIFIED=0]="FILE_TYPE_UNSPEDIFIED",e[e.FILE_TYPE_DOC=1]="FILE_TYPE_DOC",e[e.FILE_TYPE_FOLDER=2]="FILE_TYPE_FOLDER",e[e.FILE_TYPE_SHEET=3]="FILE_TYPE_SHEET",e[e.FILE_TYPE_SHEET_DOC=4]="FILE_TYPE_SHEET_DOC",e[e.FILE_TYPE_CHAT=5]="FILE_TYPE_CHAT",e[e.FILE_TYPE_BITABLE=8]="FILE_TYPE_BITABLE",e[e.FILE_TYPE_MINDNOTE=11]="FILE_TYPE_MINDNOTE",e[e.FILE_TYPE_FILE=12]="FILE_TYPE_FILE",e[e.FILE_TYPE_SLIDE=15]="FILE_TYPE_SLIDE",e[e.FILE_TYPE_WIKI=16]="FILE_TYPE_WIKI",e[e.FILE_TYPE_DOCX=22]="FILE_TYPE_DOCX",e[e.FILE_TYPE_SLIDES=30]="FILE_TYPE_SLIDES",e[e.FILE_TYPE_WHITE_BOARD=38]="FILE_TYPE_WHITE_BOARD"}(Pe||(Pe={})),function(e){e[e.DimensionType_UNSPEDIFIED=0]="DimensionType_UNSPEDIFIED",e[e.DimensionType_ROW=1]="DimensionType_ROW",e[e.DimensionType_COL=2]="DimensionType_COL"}(Le||(Le={})),function(e){e[e.BorderStyle_UNSPEDIFIED=0]="BorderStyle_UNSPEDIFIED",e[e.BorderStyle_none=1]="BorderStyle_none",e[e.BorderStyle_thin=2]="BorderStyle_thin",e[e.BorderStyle_medium=3]="BorderStyle_medium",e[e.BorderStyle_thick=4]="BorderStyle_thick",e[e.BorderStyle_dotted=5]="BorderStyle_dotted",e[e.BorderStyle_dashed=6]="BorderStyle_dashed",e[e.BorderStyle_double=7]="BorderStyle_double",e[e.BorderStyle_hair=8]="BorderStyle_hair",e[e.BorderStyle_dashDot=9]="BorderStyle_dashDot",e[e.BorderStyle_dashDotDot=10]="BorderStyle_dashDotDot",e[e.BorderStyle_slantDashDot=11]="BorderStyle_slantDashDot",e[e.BorderStyle_mediumDashed=12]="BorderStyle_mediumDashed",e[e.BorderStyle_mediumDashDot=13]="BorderStyle_mediumDashDot",e[e.BorderStyle_mediumDashDotDot=14]="BorderStyle_mediumDashDotDot"}(De||(De={})),function(e){e[e.HorizontalAlignment_UNSPEDIFIED=0]="HorizontalAlignment_UNSPEDIFIED",e[e.HorizontalAlignment_left=1]="HorizontalAlignment_left",e[e.HorizontalAlignment_center=2]="HorizontalAlignment_center",e[e.HorizontalAlignment_right=3]="HorizontalAlignment_right"}(Fe||(Fe={})),function(e){e[e.VerticalAlignment_UNSPEDIFIED=0]="VerticalAlignment_UNSPEDIFIED",e[e.VerticalAlignment_top=1]="VerticalAlignment_top",e[e.VerticalAlignment_center=2]="VerticalAlignment_center",e[e.VerticalAlignment_bottom=3]="VerticalAlignment_bottom"}(Be||(Be={})),function(e){e[e.WrapTextType_UNSPEDIFIED=0]="WrapTextType_UNSPEDIFIED",e[e.WrapTextType_OVERFLOW=1]="WrapTextType_OVERFLOW",e[e.WrapTextType_AUTOWRAP=2]="WrapTextType_AUTOWRAP",e[e.WrapTextType_WORDCLIP=3]="WrapTextType_WORDCLIP"}(Ve||(Ve={})),function(e){e[e.SparklineThemeType_UNSPECIFIED=0]="SparklineThemeType_UNSPECIFIED",e[e.SparklineThemeType_LIGHT=1]="SparklineThemeType_LIGHT",e[e.SparklineThemeType_SOFT=2]="SparklineThemeType_SOFT",e[e.SparklineThemeType_BRAND=3]="SparklineThemeType_BRAND",e[e.SparklineThemeType_FRESH=4]="SparklineThemeType_FRESH",e[e.SparklineThemeType_PRO=5]="SparklineThemeType_PRO"}(He||(He={})),function(e){e[e.SparklineNaNShowAs_UNSPECIFIED=0]="SparklineNaNShowAs_UNSPECIFIED",e[e.SparklineNaNShowAs_ZERO=1]="SparklineNaNShowAs_ZERO",e[e.SparklineNaNShowAs_SPACE=2]="SparklineNaNShowAs_SPACE",e[e.SparklineNaNShowAs_LINK=3]="SparklineNaNShowAs_LINK"}(Ue||(Ue={})),function(e){e[e.SparklineType_UNSPECIFIED=0]="SparklineType_UNSPECIFIED",e[e.SparklineType_LINE=1]="SparklineType_LINE",e[e.SparklineType_COLUMN=2]="SparklineType_COLUMN",e[e.SparklineType_WINLOSS=3]="SparklineType_WINLOSS"}(Ze||(Ze={})),function(e){e[e.ExtremumType_UNSPECIFIED=0]="ExtremumType_UNSPECIFIED",e[e.ExtremumType_AUTO=1]="ExtremumType_AUTO",e[e.ExtremumType_GROUP=2]="ExtremumType_GROUP",e[e.ExtremumType_CUSTOM=3]="ExtremumType_CUSTOM"}(We||(We={})),function(e){e[e.WorkbookRangeType_UNSPEDIFIED=0]="WorkbookRangeType_UNSPEDIFIED",e[e.WorkbookRangeType_ChartOrPivotTable=1]="WorkbookRangeType_ChartOrPivotTable",e[e.WorkbookRangeType_Chart=2]="WorkbookRangeType_Chart",e[e.WorkbookRangeType_PivotTable=3]="WorkbookRangeType_PivotTable",e[e.WorkbookRangeType_Link=4]="WorkbookRangeType_Link"}(je||(je={})),function(e){e[e.SheetState_UNSPECIFIED=0]="SheetState_UNSPECIFIED",e[e.SheetState_VISIBlE=1]="SheetState_VISIBlE",e[e.SheetState_HIDDEN=2]="SheetState_HIDDEN"}(Ge||(Ge={})),function(e){e[e.ExternalBlockType_UNSPECIFIED=0]="ExternalBlockType_UNSPECIFIED",e[e.ExternalBlockType_BITABLE_BLOCK=1]="ExternalBlockType_BITABLE_BLOCK",e[e.ExternalBlockType_DOCX_BLOCK=2]="ExternalBlockType_DOCX_BLOCK"}(ze||(ze={})),function(e){e[e.SheetTabType_UNSPECIFIED=0]="SheetTabType_UNSPECIFIED",e[e.SheetTabType_CONNECTOR=1]="SheetTabType_CONNECTOR"}(Ye||(Ye={}));var ft,pt,vt,gt,_t,yt,mt,Et,bt,Tt,Ct,St=Object.freeze({__proto__:null,get CommandType(){return ie},get MutationType(){return oe},get PivotErrorState(){return ae},get ConditionalFormatRuleTypes(){return se},get CellIsRuleOperatorType(){return ue},get ContainTextRuleOperatorType(){return le},get TimePeriodRuleOperatorType(){return ce},get TimePeriodType(){return he},get AttrValueType(){return de},get RankType(){return fe},get AverageType(){return pe},get IconGroupType(){return ve},get IconsRuleOperatorType(){return ge},get EmbeddedBlockType(){return _e},get DateTimeGrouping(){return ye},get CustomFilterOperator(){return me},get FloatBlockType(){return Ee},get NotifyStrategyType(){return be},get CellValueType(){return Te},get CellExtendType(){return Ce},get CellRunType(){return Se},get ErrorTipsType(){return we},get HyperlinkType(){return Re},get NoteValueType(){return Ae},get DataValidationConditionType(){return Oe},get ListSourceType(){return Me},get DataValidationOperator(){return ke},get NumberType(){return Ie},get HandledWayOnInvalidData(){return xe},get MENTION_TYPE(){return Ne},get MENTION_FILE_TYPE(){return Pe},get DimensionType(){return Le},get BorderStyle(){return De},get HorizontalAlignment(){return Fe},get VerticalAlignment(){return Be},get WrapTextType(){return Ve},get SparklineThemeType(){return He},get SparklineNaNShowAs(){return Ue},get SparklineType(){return Ze},get ExtremumType(){return We},get WorkbookRangeType(){return je},get SheetState(){return Ge},get ExternalBlockType(){return ze},get SheetTabType(){return Ye}});!function(e){e[e.IMPORTRANGE=1]="IMPORTRANGE",e[e.ATTACHMENT_AUTHENTICATE=2]="ATTACHMENT_AUTHENTICATE",e[e.IMAGE_AUTHENTICATE=4]="IMAGE_AUTHENTICATE",e[e.NOTE=8]="NOTE"}(ft||(ft={})),function(e){e[e.IMPORTRANGE=7]="IMPORTRANGE",e[e.ATTACHMENT_AUTHENTICATE=8]="ATTACHMENT_AUTHENTICATE",e[e.IMAGE_AUTHENTICATE=9]="IMAGE_AUTHENTICATE"}(pt||(pt={})),function(e){e[e.BeginsWith=2]="BeginsWith",e[e.DoesNotBeginWith=3]="DoesNotBeginWith",e[e.EndsWith=4]="EndsWith",e[e.DoesNotEndWith=5]="DoesNotEndWith",e[e.Contains=6]="Contains",e[e.DoesNotContain=7]="DoesNotContain"}(vt||(vt={})),function(e){e[e.Equal=0]="Equal",e[e.NotEqual=1]="NotEqual",e[e.Greater=2]="Greater",e[e.GreaterOrEqual=3]="GreaterOrEqual",e[e.Less=4]="Less",e[e.LessOrEqual=5]="LessOrEqual",e[e.Between=6]="Between",e[e.NotBetween=7]="NotBetween"}(gt||(gt={})),function(e){e[e.BackgroundColor=0]="BackgroundColor",e[e.ForegroundColor=1]="ForegroundColor"}(_t||(_t={})),function(e){e[e.Equal=0]="Equal",e[e.NotEqual=1]="NotEqual"}(yt||(yt={})),function(e){e[e.MultiValueCondition=0]="MultiValueCondition",e[e.NumberCondition=1]="NumberCondition",e[e.TextCondition=2]="TextCondition",e[e.ColorCondition=3]="ColorCondition"}(mt||(mt={})),function(e){e.NONE="none",e.CELL_COLOR="cellColor",e.FONT_COLOR="fontColor",e.EQUAL="equal",e.NOT_EQUAL="notEqual",e.GREATER="greater",e.GREATER_OR_EQUAL="greater_or_equal",e.LESS="less",e.LESS_OR_EQUAL="less_or_equal",e.BETWEEN="between",e.NOT_BETWEEN="not_between",e.START="start",e.NOT_START="notStart",e.END="end",e.NOT_END="notEnd",e.CONTAIN="contain",e.NOT_CONTAIN="notContain"}(Et||(Et={})),function(e){e.DataValidation="dataValidation"}(bt||(bt={})),function(e){e[e.Name=0]="Name"}(Tt||(Tt={})),function(e){e.addSparkline="addSparkline",e.updateSparkline="updateSparkline",e.delSparkline="delSparkline"}(Ct||(Ct={}));var wt,Rt,At,Ot,Mt,kt,It,xt,Nt,Pt,Lt,Dt,Ft,Bt,Vt,Ht,Ut,Zt,Wt,jt,Gt,zt,Yt,Xt,Kt,qt,$t,Jt,Qt="j-block-container",en="block-placeholder",tn="block-autonomous-region",nn="block-paste-placeholder";!function(e){e.IFRAME_BLOCK="IFRAME_BLOCK",e.REACTION_BLOCK="REACTION_BLOCK",e.SHEET_BLOCK="SHEET_BLOCK",e.BITABLE_BLOCK="BITABLE_BLOCK",e.DOCX_BLOCK="DOCX_BLOCK",e.POLL_BLOCK="POLL_BLOCK",e.REMINDER_BLOCK="REMINDER_BLOCK",e.PLACEHOLDER_BLOCK="PLACEHOLDER_BLOCK",e.JIRA_ISSUE_BLOCK="JIRA_ISSUE_BLOCK",e.JIRA_FILTER_BLOCK="JIRA_FILTER_BLOCK",e.MINDNOTE_BLOCK="MINDNOTE_BLOCK",e.MENTION_BLOCK="mentionBlock",e.JEST_BLOCK="JEST_BLOCK",e.AT_USER_BLOCK="AT_USER_BLOCK",e.FILE_CARD_BLOCK="FILE_CARD_BLOCK",e.HTML_BLOCK="HTML_BLOCK",e.CHAT_CARD_BLOCK="CHAT_CARD_BLOCK",e.READ_PROCESS_BLOCK="READ_PROCESS_BLOCK",e.APPLICATION_CONTROL_BLOCK="APPLICATION_CONTROL_BLOCK",e.DIAGRAM_BLOCK="DIAGRAM_BLOCK",e.EQUATION_BLOCK="EQUATION_BLOCK",e.ISV_BLOCK="ISV_BLOCK",e.LINK_BLOCK="LINK_BLOCK",e.OKR_BLOCK="OKR_BLOCK",e.WIKI_RECENT_UPDATE_BLOCK="WIKI_RECENT_UPDATE_BLOCK",e.WIKI_CATALOG_BLOCK="WIKI_CATALOG_BLOCK"}(wt||(wt={})),function(e){e.PLACEHOLDER="PLACEHOLDER",e.PLACEHOLDER_NEW="PLACEHOLDER_NEW",e.CONTENT="CONTENT"}(Rt||(Rt={})),function(e){e.BLOCK="block",e.INLINE="inline"}(At||(At={})),function(e){e.INLINE="inline",e.CARD="card",e.PREVIEW="preview"}(Ot||(Ot={})),function(e){e.context="context",e.attribute="attribute",e.dataset="dataset",e.record="record"}(Mt||(Mt={})),function(e){e[e.UNLOADED=0]="UNLOADED",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED"}(kt||(kt={})),function(e){e.ApplyCS="ApplyCS",e.Normal="Normal"}(It||(It={})),function(e){e.HANDLE_SHEET_COMPLETE="handleSheetComplete",e.HANDLE_SPREAD_COMPLETE="handleSpreadComplete",e.HANDLE_BLOCK_DATA="handleBlockData",e.INVALID_BLOCK_DATA="INVALID_BLOCK_DATA",e.APPLY_BLOCK_DATA="APPLY_BLOCK_DATA",e.APPLY_ROW_DATA="APPLY_ROW_DATA",e.INVALID_BLOCK_TOKEN="INVALID_BLOCK_TOKEN"}(xt||(xt={})),function(e){e.Height="height",e.Width="width",e.Visible="visible",e.FId="fId",e.AutoFitSize="autoFitSize",e.FixedSize="fixedSize",e.Excluded="excluded"}(Nt||(Nt={})),function(e){e[e.SEND_COMMENT_CHANGE=-100]="SEND_COMMENT_CHANGE",e[e.FETCH_MISS_VERSION_CORE=-300]="FETCH_MISS_VERSION_CORE",e[e.REFETCH_ROOM_MEMBER=-400]="REFETCH_ROOM_MEMBER",e[e.TRIGGER_CHANGESET=-500]="TRIGGER_CHANGESET",e[e.ONLINE_STATE_CHANGE=-800]="ONLINE_STATE_CHANGE",e[e.HANDLE_BACKUP_LOCAL_ACTION=-900]="HANDLE_BACKUP_LOCAL_ACTION",e[e.BEFORE_UNLOAD=-1e3]="BEFORE_UNLOAD",e[e.EMBED_HOST_SEND_NEXT_CHANGESET=-1100]="EMBED_HOST_SEND_NEXT_CHANGESET",e[e.FORWARD_CHANGESET_CORE=-1200]="FORWARD_CHANGESET_CORE",e[e.HANDLE_BACKUP_SUBMITTING_FOLLOW=-1300]="HANDLE_BACKUP_SUBMITTING_FOLLOW",e[e.ERROR_PERM_LOCK=-1400]="ERROR_PERM_LOCK",e[e.FOLLOW_ACTIONS=-1500]="FOLLOW_ACTIONS",e[e.FOLLOW_ACTIONS_2=-1600]="FOLLOW_ACTIONS_2",e[e.SUSPEND_READY=-1700]="SUSPEND_READY",e[e.HB=-1800]="HB",e[e.REQUIRE_RESYNC=-1900]="REQUIRE_RESYNC",e[e.CONFLICT=-2e3]="CONFLICT",e[e.RECOVER=-2100]="RECOVER",e[e.ACK=-2200]="ACK",e[e.MOBILE_NETWORK_CHANGE=-2300]="MOBILE_NETWORK_CHANGE",e[e.SPREAD_LOADED=-2400]="SPREAD_LOADED",e[e.NEW_CHANGES=-2500]="NEW_CHANGES",e[e.SYNC_MAX_REV=-2600]="SYNC_MAX_REV",e[e.RESUME_ACTION=-2700]="RESUME_ACTION",e[e.CLEAR_BACKUP=-2800]="CLEAR_BACKUP",e[e.COPY=-2900]="COPY",e[e.RESET_AND_STOP=-3e3]="RESET_AND_STOP",e[e.RECOVER_AND_START=-3100]="RECOVER_AND_START",e[e.SHEET_TO_USAGE=-3200]="SHEET_TO_USAGE",e[e.REMOTE_DATA_OVER_SIZE=-3300]="REMOTE_DATA_OVER_SIZE",e[e.EMBED_SEND_COPY_SHEET=-3400]="EMBED_SEND_COPY_SHEET",e[e.ASYNC_COPY_SHEET=-3500]="ASYNC_COPY_SHEET",e[e.ACK_BLOCK_IN_SHEET=-3600]="ACK_BLOCK_IN_SHEET",e[e.APPLY_TEMPLATE=-3700]="APPLY_TEMPLATE",e[e.ASYNC_DEV_TOOL=-3800]="ASYNC_DEV_TOOL",e[e.APPLY_RECOVER_ACTION_AND_REFETCH=-3900]="APPLY_RECOVER_ACTION_AND_REFETCH",e[e.COLLABORATION_DESTROY=-4e3]="COLLABORATION_DESTROY",e[e.SUBBLOCK_DOWN_GRADE=-4100]="SUBBLOCK_DOWN_GRADE"}(Pt||(Pt={})),function(e){e[e.NONE=0]="NONE",e[e.NOT_GENERATE_HISTORY=1]="NOT_GENERATE_HISTORY",e[e.NOT_UPDATE_EDIT_TIME=2]="NOT_UPDATE_EDIT_TIME"}(Lt||(Lt={})),function(e){e.Line="line",e.Bar="bar",e.Pie="pie"}(Dt||(Dt={})),function(e){e.Row="row",e.Col="col"}(Ft||(Ft={})),function(e){e.Vertical="vertical",e.Horizontal="horizontal"}(Bt||(Bt={})),function(e){e[e.Bottom=0]="Bottom",e[e.Right=1]="Right",e[e.Top=2]="Top",e[e.Left=3]="Left",e[e.None=4]="None"}(Vt||(Vt={})),function(e){e.ColorA="ColorA",e.ColorB="ColorB",e.ColorC="ColorC",e.ColorD="ColorD",e.ColorE="ColorE",e.ColorF="ColorF"}(Ht||(Ht={})),function(e){e.CHART_SETUP="CHART_SETUP",e.CHART_CUSTOMIZE="CHART_CUSTOMIZE"}(Ut||(Ut={})),function(e){e.Row="row",e.Col="col"}(Zt||(Zt={})),function(e){e.ONLY_CEEL="ONLY_CEEL",e.COMMENT_ICON="COMMENT_ICON",e.ATTACHMENT="ATTACHMENT"}(Wt||(Wt={})),function(e){e.Equal="equal",e.NotEqual="notEqual",e.Greater="greaterThan",e.GreaterOrEqual="greaterThanOrEqual",e.Less="lessThan",e.LessOrEqual="lessThanOrEqual",e.Between="between",e.NotBetween="notBetween"}(jt||(jt={})),function(e){e.BeginsWith="beginsWith",e.EndsWith="endsWith",e.Contains="containsText",e.DoesNotContain="notContains",e.Is="is"}(Gt||(Gt={})),function(e){e.Before="before",e.Is="is",e.After="after"}(zt||(zt={})),function(e){e.Today="today",e.Yesterday="yesterday",e.Tomorrow="tomorrow",e.Last7Days="last7Days",e.ThisMonth="thisMonth",e.LastMonth="lastMonth",e.NextMonth="nextMonth",e.ThisWeek="thisWeek",e.LastWeek="lastWeek",e.NextWeek="nextWeek"}(Yt||(Yt={})),function(e){e.MinValue="minValue",e.MaxValue="maxValue",e.Num="num",e.Percentile="percentile",e.Percent="percent",e.Formula="formula",e.Auto="auto"}(Xt||(Xt={})),function(e){e.Percent="percent",e.Sort="sort"}(Kt||(Kt={})),function(e){e.Greater="greaterThan",e.GreaterOrEqual="greaterThanOrEqual",e.Less="lessThan",e.LessOrEqual="lessThanOrEqual"}(qt||(qt={})),function(e){e.Arrows3="3Arrows",e.ArrowsGray3="3ArrowsGray",e.Triangles3="3Triangles",e.ArrowsGray4="4ArrowsGray",e.Arrows4="4Arrows",e.ArrowsGray5="5ArrowsGray",e.Arrows5="5Arrows",e.Circles3="3Circles",e.MultiGraphics3="3MultiGraphics",e.Circles4="4Circles",e.Circles5="5Circles",e.Status2="2Status",e.Status3="3Status",e.CommentStatus2="2CommentStatus",e.Flags3="3Flags",e.Stars3="3Stars",e.HeartShaped3="3HeartShaped",e.Mood3="3Mood",e.CirclesRatio5="5CirclesRatio"}($t||($t={})),function(e){e.Greater="greaterThan",e.GreaterOrEqual="greaterThanOrEqual",e.Less="lessThan",e.LessOrEqual="lessThanOrEqual"}(Jt||(Jt={}));var rn,on,an,sn=10;!function(e){e.DUPLICATE_VALUES="duplicateValues",e.UNIQUE_VALUES="uniqueValues",e.CELL_IS="cellIs",e.CONTAINS_TEXT="containsText",e.TIME_PERIOD="timePeriod",e.CONTAINS_BLANKS="containsBlanks",e.NOT_CONTAINS_BLANKS="notContainsBlanks",e.DATA_BAR="dataBar",e.COLOR_SCALE="colorScale",e.RANK="rank",e.AVERAGE="aboveAverage",e.EXPRESSION="expression",e.ICON_SET="iconSet"}(rn||(rn={})),function(e){e[e.NONE=0]="NONE",e[e.UNDERLINE=1]="UNDERLINE",e[e.LINETHROUGH=2]="LINETHROUGH",e[e.BOTH=3]="BOTH"}(on||(on={})),function(e){e[e.OLD=3]="OLD",e[e.NEW_SPLIT_CODE=4]="NEW_SPLIT_CODE",e[e.CS_GZIP=5]="CS_GZIP",e[e.NODE=6]="NODE",e[e.REF=7]="REF",e[e.BACKWARD=8]="BACKWARD",e[e.MUTATION=9]="MUTATION"}(an||(an={}));var un,ln,cn,hn,dn,fn,pn="v0.0.1";!function(e){e[e.UNSPEDIFIED=0]="UNSPEDIFIED",e[e.CHART_OR_PIVOT_TABLE=1]="CHART_OR_PIVOT_TABLE",e[e.CHART=2]="CHART",e[e.PIVOT_TABLE=3]="PIVOT_TABLE",e[e.COPY_LINK=4]="COPY_LINK"}(un||(un={})),function(e){e.List="list",e.ListFromRange="listFromRange",e.Number="number",e.Date="date",e.TextLength="textLength",e.Checkbox="checkbox"}(ln||(ln={})),function(e){e[e.ShowWarning=1]="ShowWarning",e[e.RejectInput=2]="RejectInput"}(cn||(cn={})),function(e){e[e.Integer=1]="Integer",e[e.Decimal=2]="Decimal"}(hn||(hn={})),function(e){e[e.ERROR_CLIENT_VARS=0]="ERROR_CLIENT_VARS",e[e.ERROR_SORT_INCLUDE_MERGE=1]="ERROR_SORT_INCLUDE_MERGE",e[e.ERROR_MERGE_CONTAIN_VALUE=2]="ERROR_MERGE_CONTAIN_VALUE",e[e.ERROR_MERGE_CONTAIN_MERGE=3]="ERROR_MERGE_CONTAIN_MERGE",e[e.ERROR_INVALID_SHEET_NAME=4]="ERROR_INVALID_SHEET_NAME",e[e.ERROR_CELL_NOT_EXIST=5]="ERROR_CELL_NOT_EXIST",e[e.ERROR_SHEET_NOT_EXIST=6]="ERROR_SHEET_NOT_EXIST",e[e.ERROR_SHEET_HID=7]="ERROR_SHEET_HID",e[e.ERROR_ACTION_CONFLICT=8]="ERROR_ACTION_CONFLICT",e[e.ERROR_RECEIVE_RECOVER=9]="ERROR_RECEIVE_RECOVER",e[e.ERROR_UPGRADE_SNAPSHOT=10]="ERROR_UPGRADE_SNAPSHOT",e[e.ERROR_OLD_CALC_REFRESH=11]="ERROR_OLD_CALC_REFRESH",e[e.ERROR_EDIT_PROTECTED_RANGE=12]="ERROR_EDIT_PROTECTED_RANGE",e[e.ERROR_ERROR=13]="ERROR_ERROR",e[e.ERROR_CANVAS=14]="ERROR_CANVAS",e[e.ERROR_CONDITIONAL_FORMATTING_NUM_LIMIT=15]="ERROR_CONDITIONAL_FORMATTING_NUM_LIMIT",e[e.ERROR_SYNC_UPGRADE_SNAPSHOT=16]="ERROR_SYNC_UPGRADE_SNAPSHOT",e[e.ERROR_SORT_LOGICAL_ERROR=17]="ERROR_SORT_LOGICAL_ERROR",e[e.ERROR_RECOVER=18]="ERROR_RECOVER",e[e.ERROR_ILLEGAL_COLLASPREAD_OP=19]="ERROR_ILLEGAL_COLLASPREAD_OP",e[e.ERROR_ADD_REMINDER_CONTAIN_VALUE=20]="ERROR_ADD_REMINDER_CONTAIN_VALUE",e[e.ERROR_SORT_INCLUDE_ARRAYFORMULA=21]="ERROR_SORT_INCLUDE_ARRAYFORMULA",e[e.ERROR_PASSPORT_DELETED=900021001]="ERROR_PASSPORT_DELETED",e[e.ERROR_SORT_COLLABORATIVE_ERROR=22]="ERROR_SORT_COLLABORATIVE_ERROR",e[e.ERROR_ADD_OUTLINE_ON_PROTECTED_RANGE=23]="ERROR_ADD_OUTLINE_ON_PROTECTED_RANGE",e[e.ERROR_EDIT_CONNECTOR_SHEET=24]="ERROR_EDIT_CONNECTOR_SHEET"}(dn||(dn={})),function(e){e.ERR_REQUEST_FAIL="1",e.ERR_INVALID_PARAM="2",e.ERR_NOT_FOUND="3",e.ERR_FORBIDDEN="4",e.ERR_LOGIN_REQUIRE="5",e.ERR_DATA_EXCEED_LIMIT="6",e.ERR_OBJECT_DELETED="7",e.ERR_NOT_IN_ROOM="8",e.ERR_UNCHANGE="9",e.ERR_NEED_UPDATE_CLIENT="1000",e.ERR_CHANGESET_EXCEED_LIMIT="1001",e.ERR_NOTE_DELETED="1002",e.ERR_NOT_IN_SESSION="1003",e.ERR_NOTE_NOT_EXISTS="1004",e.ERR_CHAGESET_VALID_FAIL="1005",e.ERR_500="1006",e.ERR_MESSAGE_INVALID="1007",e.ERR_SYNC_ALGO_FAIL="1008",e.ERR_RCE_LIVE_SYNC="1009",e.ERR_OLD_VERSION="1010",e.ERR_USER_LIST_SYNC="1011",e.ERR_NO_WRITE_PERMISSION="1012",e.ERR_NO_COMMENT_PERMISSION="1013",e.ERR_LOCK_FAILED="1015",e.ERR_LOCK_FAILED_FOR_CACHE_CALC="1016",e.ERR_DOWN_GRADE="1018",e.ERR_GET_EXACT_NOTE="2001",e.ERROR_PERM_LOCK="1201",e.ERROR_CLIENT_VARS_RCE_MISMATCH="1202",e.ERROR_CLIENT_VARS_RCE_READONLY="1203",e.ERROR_CREATE_LIMITATION="11001",e.ERROR_CREATE_COPY_EXCEED_IMAGE_LIMIT="130001",e.ERROR_HYBRID_RESOURCE="600",e.ERR_FETCH_CLIENTVARS="100",e.ERR_FETCH_BLOCKS="101",e.ERR_BUNDLE_FETCH_BLOCKS="102",e.ERR_HANDLE_BLOCK_DATA="103",e.ERR_SERVER_REJECT_COMMIT="200",e.ERR_SERVER_CONTENT_RESPONSE_ERROR="201",e.ERR_SERVER_RETRY_FAILED="202",e.ERR_CLIENT_FOLLOW_REJECT="203",e.ERR_SERVER_RECOVER="204",e.ERR_BACKUP_INCONSISTENT="220",e.ERR_BACKUP_INIT_VALIDATE_FAILED="221",e.ERR_BACKUP_SAVE_LOCAL_FAILED="222",e.ERROR_MAX_CELL_LIMIT="5001",e.ERROR_MAX_CELL_LIMIT_OPERATION="5002",e.ERROR_WORKER_SEND_USER_CHANGE="5003",e.ERROR_SEND_HIGH_PRORITY_MESSAGE="5004",e.ERR_CLIENTVARS_INVALID="5005",e.ERR_CLIENTVARS_INVALID_HAS_RECOVER="5005_1",e.ERROR_APPLY_ACTION_EX="5006",e.ERROR_APPLY_ACTION_CORE_EX="5006_1",e.ERROR_CMD_EX="5007",e.ERROR_WATCH_DOG="5008",e.ERROR_WATCH_DOG_WARNING="5008_1",e.ERROR_WATCH_DOG_ALERT="5008_2",e.ERROR_WATCH_DOG_DONE="5008_3",e.ERROR_ILLEGAL_OP="5009",e.ERROR_RETRY_EXCEED="50010",e.SILENT_ERROR="51000",e.ERROR_ASYNC_COPY_SHEET="50011",e.ERROR_ADD_ROW_COL_COUNT_OUT="1211",e.ERROR_SHEET_COL_COUNT_OUT="1212",e.ERROR_CELL_COUNT_OUT="1213",e.ERROR_SUB_SHEET_COUNT_OUT="1214",e.ERROR_BITTABLE_COUNT_OUT="1215",e.ERROR_CELL_STR_LEN_OUT="1216",e.ERROR_DOCX_SHEET_COUNT_OUT="1217",e.ERROR_BITABLE_SHEET_POP_UP="1218",e.ERROR_PROTECTION_COUNT_LIMIT="1219",e.ERROR_BITABLE_EXCEED_LIMIT="800004012",e.ERROR_BITABLE_COPY_FAILED="800004047",e.ERROR_BITABLE_ON_COPYING="800004046",e.ERROR_BITABLE_ACTION_UNEXCEPTION="800004009",e.ERROR_BITABLE_INVOKE_RPC_FAILED="800004014",e.ERROR_PASSPORT_DELETED="900021001",e.STOP_WRITE_FOR_MIGRATE="900004230",e.ILLEGAL_CROSS_TENANT="900004510",e.ILLEGAL_CROSS_BRAND="900004511",e.ErrGanttViewQuotaLimit="800004119",e.TENANT_QUOTA_EXCEEDED="90003081",e.FILE_USER_QUOTA_EXCEEDED="90003082",e.FILE_DEPT_QUOTA_EXCEEDED="90003083",e.FILE_SUPER_DOCS_EXCEEDED="90003085",e.ERROR_DOC_SHEET_UPGRADING="8140300",e.ERROR_DOC_SHEET_FORBID_EDITING="601124369",e.NO_PERM_BY_LACK_OF_BENEFIT="2501",e.BLOCK_BY_LACK_OF_BENEFIT="90003088"}(fn||(fn={}));var vn,gn,_n={TIMEOUT:"ECONNABORTED",SUCCESS:0,FAILED:1,INVALID_PARAMETERS:2,NOT_FOUND:3,FORBIDDEN:4,LOGIN_REQUIRED:5,DATA_EXCEED_LIMIT:6,OBJCT_DELETED:7,CONNECT_ERROR:"-8",NOTE_DELETED:1002};!function(e){e[e.OTHER=0]="OTHER",e[e.SEND_USER_CS=1]="SEND_USER_CS",e[e.IO_MESSAGE=2]="IO_MESSAGE"}(vn||(vn={})),function(e){e.FOLLOW_REJECT="follow_reject",e.FOLLOW_CALC_PENDING="follow_calc_pending",e.RECOVER_CONFLICT="recover_conflict",e.SEND_RECOVER="send_recover",e.SEND_USER_CS="send_user_cs",e.TOO_OLD_REV="too_old_rev"}(gn||(gn={}));var yn=new Set(["1001","5001","1007","1219","1216","1215","1214","1212","1211","1213","1218","1217","800004012","800004047","800004009"]);function mn(e){return yn.has(e)}function En(e){return"4"===e||"5"===e||"8"===e}function bn(e){return"1201"===e}var Tn,Cn,Sn=new Set(["5008_2","5008_3","5008_1","220","221","222","900004230","90003081","90003082","90003083","90003085","90003088"]);function wn(e){return Sn.has(e)}function Rn(e){return"1010"===e||"203"===e||"200"===e||"204"===e}function An(e){return"5008_1"===e||"5008_2"===e||"5008_3"===e}function On(e){return"201"===e||"202"===e}function Mn(e){return"1010"===e}function kn(e,t,n){return new Z.ErrorVar(Z.ErrorType.REF,Z.ErrorConstant.REF,e,{message:t,args:n})}!function(e){e[e.SHEET_IS_DELETED=601164903]="SHEET_IS_DELETED",e[e.SPREAD_DATA_CONNECTOR_NUM_OVER=601164909]="SPREAD_DATA_CONNECTOR_NUM_OVER",e[e.CREDENTIAL_EXPIRY_FAILED=601164912]="CREDENTIAL_EXPIRY_FAILED"}(Tn||(Tn={})),function(e){e[e.ARRAYFORMULA_CAN_NOT_EXPAND=20110010]="ARRAYFORMULA_CAN_NOT_EXPAND",e[e.ARRAYFORMULA_EXPAND_LACK_ROW_COL=20110020]="ARRAYFORMULA_EXPAND_LACK_ROW_COL",e[e.ARRAYFORMULA_EXPAND_LACK_ROW_COL_EXCEED_LIMIT=20110021]="ARRAYFORMULA_EXPAND_LACK_ROW_COL_EXCEED_LIMIT",e[e.ARRAYFORMULA_EXPAND_LACK_ROW_COL_NOT_EXCEED_LIMIT=20110022]="ARRAYFORMULA_EXPAND_LACK_ROW_COL_NOT_EXCEED_LIMIT",e[e.RANGE_CAN_ONLY_REFERENCE_ONE_SHEET=20110030]="RANGE_CAN_ONLY_REFERENCE_ONE_SHEET",e[e.INVALID_ROMAN_NUMERAL=20110040]="INVALID_ROMAN_NUMERAL",e[e.INVALID_CELL_REFERENCE=20110050]="INVALID_CELL_REFERENCE",e[e.INVALID_SINGLE_CELL_REFERENCE=20110051]="INVALID_SINGLE_CELL_REFERENCE",e[e.ARG_MUST_BE_RANGE=20110060]="ARG_MUST_BE_RANGE",e[e.VALUE_ARRAY_SIZES_NOT_EQUAL=20110070]="VALUE_ARRAY_SIZES_NOT_EQUAL",e[e.SETTLEMENT_DATE_NOT_BEFORE_MATURITY_DATE=20110080]="SETTLEMENT_DATE_NOT_BEFORE_MATURITY_DATE",e[e.CANNOT_PARSE_TEXT_TO_DATE=20110090]="CANNOT_PARSE_TEXT_TO_DATE",e[e.RANGE_MUST_BE_SINGLE_ROW_OR_COLUMN=20110100]="RANGE_MUST_BE_SINGLE_ROW_OR_COLUMN",e[e.RANGE_SIZES_NOT_EQUAL=20110110]="RANGE_SIZES_NOT_EQUAL",e[e.MATCH_NOT_AVAILABLE=20110120]="MATCH_NOT_AVAILABLE",e[e.INCOMPATIBLE_MATRIX_SIZES=20110130]="INCOMPATIBLE_MATRIX_SIZES",e[e.NO_MODE=20110140]="NO_MODE",e[e.INVALID_WEEKEND_NUMBER=20110150]="INVALID_WEEKEND_NUMBER",e[e.PARAMETER_SHOULD_BE_NON_BLANK=20110160]="PARAMETER_SHOULD_BE_NON_BLANK",e[e.UNKNOWN_SUBTOTAL_FUNCTION=20110170]="UNKNOWN_SUBTOTAL_FUNCTION",e[e.UNKNOWN_AGGREGATE_FUNCTION=20110171]="UNKNOWN_AGGREGATE_FUNCTION",e[e.INVALID_FORMAT_PATTERN=20110180]="INVALID_FORMAT_PATTERN",e[e.VALUE_PARAMETER_SHOULD_BE_LESS_THAN_OR_EQUAL_TO=20210031]="VALUE_PARAMETER_SHOULD_BE_LESS_THAN_OR_EQUAL_TO",e[e.CONDITION_ROW_MORE_THEN_TO=20210302]="CONDITION_ROW_MORE_THEN_TO",e[e.AVERAGE_WEIGHTED_NEGATIVE_ERROR=20220615]="AVERAGE_WEIGHTED_NEGATIVE_ERROR",e[e.VALUE_RANDARRAY_ERROR_CALC_LARGE=20220732]="VALUE_RANDARRAY_ERROR_CALC_LARGE",e[e.DELIMITER_INVALID=20110241]="DELIMITER_INVALID",e[e.UNRESOLVED_SHEET_NAME=20110190]="UNRESOLVED_SHEET_NAME",e[e.DELETED_REFERENCE=20110200]="DELETED_REFERENCE",e[e.REF_ARG_MUST_BE_RANGE=20110210]="REF_ARG_MUST_BE_RANGE",e[e.REF_INVALID_CELL_REFERENCE=20110220]="REF_INVALID_CELL_REFERENCE",e[e.REFERENCE_OUT_OF_BOUNDS=20110230]="REFERENCE_OUT_OF_BOUNDS",e[e.REF_PARAMETER_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO=20110231]="REF_PARAMETER_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO",e[e.REF_PARAMETER_SHOULD_BE_LESS_THAN_OR_EQUAL_TO=20110240]="REF_PARAMETER_SHOULD_BE_LESS_THAN_OR_EQUAL_TO",e[e.REF_OUT_OF_RANGE_PARAMETER=20110250]="REF_OUT_OF_RANGE_PARAMETER",e[e.REF_RANGE_MUST_BE_SINGLE_ROW_OR_COLUMN=20110260]="REF_RANGE_MUST_BE_SINGLE_ROW_OR_COLUMN",e[e.REF_RANDARRAY_ERROR_EXPAND=20210711]="REF_RANDARRAY_ERROR_EXPAND",e[e.REF_ARRAY_ROW_ROW_NO_MATCH=20210720]="REF_ARRAY_ROW_ROW_NO_MATCH",e[e.REF_ARRAY_LITERAL_COL_NO_MATCH=20210730]="REF_ARRAY_LITERAL_COL_NO_MATCH",e[e.DATE_PARAMETER_SHOULD_BE_ON_OR_BEFORE_OTHER_DATE_PARAMETER=20110270]="DATE_PARAMETER_SHOULD_BE_ON_OR_BEFORE_OTHER_DATE_PARAMETER",e[e.NUM_SETTLEMENT_DATE_NOT_BEFORE_MATURITY_DATE=20110280]="NUM_SETTLEMENT_DATE_NOT_BEFORE_MATURITY_DATE",e[e.NUM_MATURITY_DATE_NOT_THAN_SETTLEMENT_DATE_ONE_YEAR=20210470]="NUM_MATURITY_DATE_NOT_THAN_SETTLEMENT_DATE_ONE_YEAR",e[e.FUNCTION_RESULT_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO=20110290]="FUNCTION_RESULT_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO",e[e.FUNCTION_RESULT_SHOULD_BE_LESS_THAN_OR_EQUAL_TO=20210731]="FUNCTION_RESULT_SHOULD_BE_LESS_THAN_OR_EQUAL_TO",e[e.MORE_THEN_ONE_MATCH_FOUND=20210301]="MORE_THEN_ONE_MATCH_FOUND",e[e.NUM_NOT_BE_BETWEEN_INCLUSIVE_PARAMETER=20210560]="NUM_NOT_BE_BETWEEN_INCLUSIVE_PARAMETER",e[e.NUM_NOT_BE_NEGATIVE_INTEGER_OR_ZERO=20210580]="NUM_NOT_BE_NEGATIVE_INTEGER_OR_ZERO",e[e.NUM_NOT_BE_NEGATIVE_NUMBER_OR_ZERO=20210590]="NUM_NOT_BE_NEGATIVE_NUMBER_OR_ZERO",e[e.NUM_PARAMETER_SUM_EXCEED_LIMIT=20220606]="NUM_PARAMETER_SUM_EXCEED_LIMIT",e[e.NUM_PARAMETER_SHOULD_BE_INTEGER=20210713]="NUM_PARAMETER_SHOULD_BE_INTEGER",e[e.NA_MATCH_NOT_AVAILABLE=20110300]="NA_MATCH_NOT_AVAILABLE",e[e.INVALID_FORMULA_PARSED_RESULT=20110310]="INVALID_FORMULA_PARSED_RESULT",e[e.LOOKUP_VALUE_NOT_FOUND=20110320]="LOOKUP_VALUE_NOT_FOUND",e[e.NA_INVALID_CELL_REFERENCE=20110330]="NA_INVALID_CELL_REFERENCE",e[e.OUT_OF_RANGE_FUNCTION=20110340]="OUT_OF_RANGE_FUNCTION",e[e.NA_RANGE_MUST_BE_SINGLE_ROW_OR_COLUMN=20110350]="NA_RANGE_MUST_BE_SINGLE_ROW_OR_COLUMN",e[e.NA_NO_MODE=20110360]="NA_NO_MODE",e[e.NA_DELETED_REFERENCE=20110370]="NA_DELETED_REFERENCE",e[e.NA_ARRAY_SIZES_NOT_EQUAL=20110380]="NA_ARRAY_SIZES_NOT_EQUAL",e[e.NA_REQUIRED_ARGUMENT_SIZES_NOT_EQUAL=20210460]="NA_REQUIRED_ARGUMENT_SIZES_NOT_EQUAL",e[e.NA_PARAMETER_SHOULD_BE_NON_BLANK=20210570]="NA_PARAMETER_SHOULD_BE_NON_BLANK",e[e.CALC_PARAMETER_SHOULD_BE_NON_BLANK=20110390]="CALC_PARAMETER_SHOULD_BE_NON_BLANK",e[e.IMPORT_RANGE_PARSE_ERROR=20120400]="IMPORT_RANGE_PARSE_ERROR",e[e.REF_INVALID_REGULAR_EXPRESSION=20210410]="REF_INVALID_REGULAR_EXPRESSION",e[e.REF_UNSAFE_REGULAR_EXPRESSION=20210420]="REF_UNSAFE_REGULAR_EXPRESSION",e[e.NA_REGULAR_EXPRESSION_NO_MATCH=20210430]="NA_REGULAR_EXPRESSION_NO_MATCH",e[e.INVALID_CELL_INFO_TYPE=20210440]="INVALID_CELL_INFO_TYPE",e[e.CELL_FORMAT_NO_MATCH=20210450]="CELL_FORMAT_NO_MATCH",e[e.TREND_ROW_NO_MATCH=20210480]="TREND_ROW_NO_MATCH",e[e.TREND_COL_NO_MATCH=20210490]="TREND_COL_NO_MATCH",e[e.TREND_ROW_COL_NO_MATCH=20210500]="TREND_ROW_COL_NO_MATCH",e[e.TREND_ARGUMENT_NOT_STIRNG=20210510]="TREND_ARGUMENT_NOT_STIRNG",e[e.TREND_ARGUMENT_NOT_BOOLEAN=20210520]="TREND_ARGUMENT_NOT_BOOLEAN",e[e.TREND_ARGUMENT_NOT_NULL=20210530]="TREND_ARGUMENT_NOT_NULL",e[e.TREND_POINT_NUM_UNENOUGHT=20210540]="TREND_POINT_NUM_UNENOUGHT",e[e.DIV_TREND_POINT_NUM_UNENOUGHT=20210550]="DIV_TREND_POINT_NUM_UNENOUGHT",e[e.LINEST_NO_STATISTICAL_INFO=20210551]="LINEST_NO_STATISTICAL_INFO",e[e.CIRCULAR_REFERENCE=20210010]="CIRCULAR_REFERENCE",e[e.REFERENCE_NOT_EXIST=20210020]="REFERENCE_NOT_EXIST",e[e.PERMISSION_DENY=20210030]="PERMISSION_DENY",e[e.INVALID_TOKEN=20210040]="INVALID_TOKEN",e[e.INVALID_SHEET=20210050]="INVALID_SHEET",e[e.SERVER_ERROR=20210060]="SERVER_ERROR",e[e.MAX_LAYER_ERROR=20210070]="MAX_LAYER_ERROR",e[e.DATA_NOT_READY=20210100]="DATA_NOT_READY",e[e.REQUEST_FAIL=20210110]="REQUEST_FAIL",e[e.EXIST_FML_LIMIT=20210120]="EXIST_FML_LIMIT",e[e.EXIST_REF_LIMIT=20210130]="EXIST_REF_LIMIT",e[e.ACCESSKEY_EXPIRED=20210140]="ACCESSKEY_EXPIRED",e[e.DATA_SOURCE_NOT_EXIST_V3=20210021]="DATA_SOURCE_NOT_EXIST_V3",e[e.FORMULA_SOURCE_NOT_EXIST_V3=20210022]="FORMULA_SOURCE_NOT_EXIST_V3",e[e.PERMISSION_DENY_V3=20210023]="PERMISSION_DENY_V3",e[e.DATA_SOURCE_IN_TRASH=20210024]="DATA_SOURCE_IN_TRASH",e[e.REFERENCE_NOT_EXIST_V3=20210025]="REFERENCE_NOT_EXIST_V3",e[e.IMPORT_ERR_UNKNOWN=20220150]="IMPORT_ERR_UNKNOWN",e[e.IMPORT_ERR_PEDDING=20220151]="IMPORT_ERR_PEDDING",e[e.IMPORT_ERR_CRAW_RUNNING=20220152]="IMPORT_ERR_CRAW_RUNNING",e[e.IMPORT_ERR_CRAW_FAIL=20220153]="IMPORT_ERR_CRAW_FAIL",e[e.IMPORT_ERR_CRAWL_WAITING=20220154]="IMPORT_ERR_CRAWL_WAITING",e[e.IMPORT_ERR_INVAILD_PARAM=20220155]="IMPORT_ERR_INVAILD_PARAM",e[e.IMPORT_ERR_DATA_SIZE_OVER_LIMIT=20220156]="IMPORT_ERR_DATA_SIZE_OVER_LIMIT",e[e.IMPORT_ERR_DOMAIN_IN_BLACK_LIST=20220157]="IMPORT_ERR_DOMAIN_IN_BLACK_LIST",e[e.IMPORT_ERR_ROBOTS_DENY=20220158]="IMPORT_ERR_ROBOTS_DENY",e[e.IMPORT_ERR_NO_PREM_UPLOAD=20220159]="IMPORT_ERR_NO_PREM_UPLOAD",e[e.IMPORT_ERR_NO_AUTHORIZED=20220160]="IMPORT_ERR_NO_AUTHORIZED",e[e.IMPORT_ERR_INVAILD_URL=20210151]="IMPORT_ERR_INVAILD_URL",e[e.IMPORT_ERR_CAN_NOT_USE_BLACK_LIST_FUNCTION=20210152]="IMPORT_ERR_CAN_NOT_USE_BLACK_LIST_FUNCTION",e[e.IMPORT_ERR_INVAILD_DELIMITER=20210153]="IMPORT_ERR_INVAILD_DELIMITER",e[e.CAN_NOT_PERFORM_THE_FUNCTION_YEAR_ON_A_COLUMN_THAT_ARE_NOT_DATE_OR_DATETIME_COLUMN=20210143]="CAN_NOT_PERFORM_THE_FUNCTION_YEAR_ON_A_COLUMN_THAT_ARE_NOT_DATE_OR_DATETIME_COLUMN",e[e.CAN_NOT_PERFORM_THE_FUNCTION_MONTH_ON_A_COLUMN_THAT_ARE_NOT_DATE_OR_DATETIME_COLUMN=20210141]="CAN_NOT_PERFORM_THE_FUNCTION_MONTH_ON_A_COLUMN_THAT_ARE_NOT_DATE_OR_DATETIME_COLUMN",e[e.CAN_NOT_PERFORM_THE_FUNCTION_DAY_ON_A_COLUMN_THAT_ARE_NOT_DATE_OR_DATETIME_COLUMN=20210142]="CAN_NOT_PERFORM_THE_FUNCTION_DAY_ON_A_COLUMN_THAT_ARE_NOT_DATE_OR_DATETIME_COLUMN",e[e.PARSE_ERROR=20210150]="PARSE_ERROR",e[e.NO_QUERY_OUTPUT=20210160]="NO_QUERY_OUTPUT",e[e.DATE_LITERAL_FORMATTER_ERROR=20210170]="DATE_LITERAL_FORMATTER_ERROR",e[e.DATETIME_LITERAL_FORMATTER_ERROR=20210171]="DATETIME_LITERAL_FORMATTER_ERROR",e[e.TIMEOFDAY_LITERAL_FORMATTER_ERROR=20210172]="TIMEOFDAY_LITERAL_FORMATTER_ERROR",e[e.FUNCTION_NO_SUPPORT=20210180]="FUNCTION_NO_SUPPORT",e[e.AGG_CAN_ONLY_TAKE_A_COLUMN_AS_AN_ARGUMENT=20210190]="AGG_CAN_ONLY_TAKE_A_COLUMN_AS_AN_ARGUMENT",e[e.THE_LOGICAL_OPERATOR_AND_USING_TO_JOIN_MULTIPLE_CONDITION=20210200]="THE_LOGICAL_OPERATOR_AND_USING_TO_JOIN_MULTIPLE_CONDITION",e[e.THE_LOGICAL_OPERATOR_OR_USING_TO_JOIN_MULTIPLE_CONDITION=20210201]="THE_LOGICAL_OPERATOR_OR_USING_TO_JOIN_MULTIPLE_CONDITION",e[e.LOGICAL_OPERATOR_ONLY_IN_WHERE=20210210]="LOGICAL_OPERATOR_ONLY_IN_WHERE",e[e.AGG_ARE_INCALCULABLE=20210220]="AGG_ARE_INCALCULABLE",e[e.COLUMN_ONLY_ONCE=20210230]="COLUMN_ONLY_ONCE",e[e.CANNOT_BE_IN_GROUP_BY=20210240]="CANNOT_BE_IN_GROUP_BY",e[e.CANNOT_BE_IN_PIVOT=20210241]="CANNOT_BE_IN_PIVOT",e[e.CANNOT_BE_IN_WHERE=20210242]="CANNOT_BE_IN_WHERE",e[e.ADD_COL_TO_GROUP_BY_OR_AGG=20210250]="ADD_COL_TO_GROUP_BY_OR_AGG",e[e.CANNOT_GROUP_WITHOUT_AGG=20210260]="CANNOT_GROUP_WITHOUT_AGG",e[e.CANNOT_PIVOT_WITHOUT_AGG=20210261]="CANNOT_PIVOT_WITHOUT_AGG",e[e.COL_IN_ORDER_MUST_BE_IN_SELECT=20210270]="COL_IN_ORDER_MUST_BE_IN_SELECT",e[e.COL_IN_LABEL_MUST_BE_IN_SELECT=20210271]="COL_IN_LABEL_MUST_BE_IN_SELECT",e[e.AGG_IN_SELECT_NO_PIVOT=20210280]="AGG_IN_SELECT_NO_PIVOT",e[e.NO_AGG_IN_ORDER_WHEN_PIVOT=20210290]="NO_AGG_IN_ORDER_WHEN_PIVOT",e[e.NO_COLUM=20210300]="NO_COLUM",e[e.AVG_SUM_ONLY_NUMERIC=20210310]="AVG_SUM_ONLY_NUMERIC",e[e.NUMBER_OF_PARAMETERS_FOR_YEAR_IS_WRONG=20210320]="NUMBER_OF_PARAMETERS_FOR_YEAR_IS_WRONG",e[e.NUMBER_OF_PARAMETERS_FOR_MONTH_IS_WRONG=20210321]="NUMBER_OF_PARAMETERS_FOR_MONTH_IS_WRONG",e[e.NUMBER_OF_PARAMETERS_FOR_DAY_IS_WRONG=20210322]="NUMBER_OF_PARAMETERS_FOR_DAY_IS_WRONG",e[e.BINARY_OPERATOR_REQUIRES_2_PARAMETERS=20210330]="BINARY_OPERATOR_REQUIRES_2_PARAMETERS",e[e.CAN_NOT_PERFORM_THE_FUNCTION_SUM_ON_VALUES_THAT_ARE_NOT_NUMBERS=20210340]="CAN_NOT_PERFORM_THE_FUNCTION_SUM_ON_VALUES_THAT_ARE_NOT_NUMBERS",e[e.CAN_NOT_PERFORM_THE_FUNCTION_DIFFERENCE_ON_VALUES_THAT_ARE_NOT_NUMBERS=20210341]="CAN_NOT_PERFORM_THE_FUNCTION_DIFFERENCE_ON_VALUES_THAT_ARE_NOT_NUMBERS",e[e.CAN_NOT_PERFORM_THE_FUNCTION_PRODUCT_ON_VALUES_THAT_ARE_NOT_NUMBERS=20210342]="CAN_NOT_PERFORM_THE_FUNCTION_PRODUCT_ON_VALUES_THAT_ARE_NOT_NUMBERS",e[e.CAN_NOT_PERFORM_THE_FUNCTION_QUOTIENT_ON_VALUES_THAT_ARE_NOT_NUMBERS=20210343]="CAN_NOT_PERFORM_THE_FUNCTION_QUOTIENT_ON_VALUES_THAT_ARE_NOT_NUMBERS",e[e.CAN_NOT_PERFORM_THE_FUNCTION_MODULO_ON_VALUES_THAT_ARE_NOT_NUMBERS=20210344]="CAN_NOT_PERFORM_THE_FUNCTION_MODULO_ON_VALUES_THAT_ARE_NOT_NUMBERS",e[e.GETPIVOTDATA_NO_MATCHING_FIELD_ITEM_PAIR=20210350]="GETPIVOTDATA_NO_MATCHING_FIELD_ITEM_PAIR",e[e.DESERIALIZE_FORMULA_ERROR=20120550]="DESERIALIZE_FORMULA_ERROR",e[e.TOTAL_VALUE_SHOULD_BE_EQUAL_TO=20120560]="TOTAL_VALUE_SHOULD_BE_EQUAL_TO",e[e.SHEET_AI_NO_PERMISSION_FG=20220360]="SHEET_AI_NO_PERMISSION_FG",e[e.SHEET_AI_NO_PERMISSION_ADMIN=20220361]="SHEET_AI_NO_PERMISSION_ADMIN",e[e.SHEET_AI_FORBIDDEN_RANGE=20220362]="SHEET_AI_FORBIDDEN_RANGE",e[e.SHEET_AI_TAG_DATABASE_ERROR=20220363]="SHEET_AI_TAG_DATABASE_ERROR",e[e.SHEET_AI_TAG_DATABASE_LOADING=20220364]="SHEET_AI_TAG_DATABASE_LOADING",e[e.SHEET_AI_TAG_DATABASE_RANGE_COL_LIMIT=20220365]="SHEET_AI_TAG_DATABASE_RANGE_COL_LIMIT",e[e.SHEET_AI_TAG_DATABASE_RANGE_ROW_LIMIT=20220366]="SHEET_AI_TAG_DATABASE_RANGE_ROW_LIMIT",e[e.SHEET_AI_CONTEXT_TOO_LONG=20220367]="SHEET_AI_CONTEXT_TOO_LONG",e[e.NEGATIVE_OVERFLOW=20220061]="NEGATIVE_OVERFLOW",e[e.NA_NON_PAIR_ARGUMENTS=20220300]="NA_NON_PAIR_ARGUMENTS",e[e.PARAMETER_RANGE_SIZES_NOT_EQUAL=20220200]="PARAMETER_RANGE_SIZES_NOT_EQUAL",e[e.FORMULA_WITH_SAME_NAME_PARAMETER=20210600]="FORMULA_WITH_SAME_NAME_PARAMETER",e[e.FORMULA_WITH_INVALID_PARAM=20210601]="FORMULA_WITH_INVALID_PARAM",e[e.FORMULA_SHOULD_BE_FOLLOWED_BY_A_CALL=20210603]="FORMULA_SHOULD_BE_FOLLOWED_BY_A_CALL",e[e.WRONG_NUMBER_OF_ARGUMENTS_TO_CALL_FOLLOWING_LAMBDA_FUNCTION=20210604]="WRONG_NUMBER_OF_ARGUMENTS_TO_CALL_FOLLOWING_LAMBDA_FUNCTION",e[e.INVALID_CALL_TO_NON_FUNCTION=20210610]="INVALID_CALL_TO_NON_FUNCTION",e[e.REACHED_CALC_LIMIT=20230620]="REACHED_CALC_LIMIT",e[e.MATRIX_ROWS_SHOULD_BE_EQUAL_COLS=20220031]="MATRIX_ROWS_SHOULD_BE_EQUAL_COLS",e[e.MATRIX_WAS_NOT_INVERTIBLE=20220062]="MATRIX_WAS_NOT_INVERTIBLE",e[e.NO_VALUE_FOR_THIS_CELL_FUNCTION=20210174]="NO_VALUE_FOR_THIS_CELL_FUNCTION",e[e.NO_VALUE_FOR_THIS_CELL_PARAMETER=20210175]="NO_VALUE_FOR_THIS_CELL_PARAMETER",e[e.VALUE_BY_ZERO_FROM_PARAMETER_BEING_ZERO=20210011]="VALUE_BY_ZERO_FROM_PARAMETER_BEING_ZERO",e[e.PARAMETER_SHOULD_BE_LAMBDA=20210370]="PARAMETER_SHOULD_BE_LAMBDA",e[e.RESULT_SHOULD_BE_SINGLE_COL=20210371]="RESULT_SHOULD_BE_SINGLE_COL",e[e.RESULT_SHOULD_BE_SINGLE_ROW=20210372]="RESULT_SHOULD_BE_SINGLE_ROW",e[e.RESULT_SHOULD_BE_SINGLE=20210373]="RESULT_SHOULD_BE_SINGLE",e[e.THE_NUMBER_OF_PARAMETERS_OF_A_FUNCTION_MUST_BE_ODD=20210620]="THE_NUMBER_OF_PARAMETERS_OF_A_FUNCTION_MUST_BE_ODD"}(Cn||(Cn={}));var In,xn,Nn,Pn,Ln,Dn,Fn,Bn,Vn,Hn,Un,Zn,Wn,jn=(G={},(0,g.Z)(G,Cn.ARRAYFORMULA_CAN_NOT_EXPAND,(function(e,t){return function(e,t,n){return new Z.ErrorVar(Z.ErrorType.REF,Z.ErrorConstant.REF,e,{message:t,args:n})}(Cn.ARRAYFORMULA_CAN_NOT_EXPAND,t,e)})),(0,g.Z)(G,Cn.ARRAYFORMULA_EXPAND_LACK_ROW_COL,(function(e){return kn(Cn.ARRAYFORMULA_EXPAND_LACK_ROW_COL,e)})),(0,g.Z)(G,Cn.ARRAYFORMULA_EXPAND_LACK_ROW_COL_EXCEED_LIMIT,(function(e){return kn(Cn.ARRAYFORMULA_EXPAND_LACK_ROW_COL_EXCEED_LIMIT,e)})),(0,g.Z)(G,Cn.ARRAYFORMULA_EXPAND_LACK_ROW_COL_NOT_EXCEED_LIMIT,(function(e){return kn(Cn.ARRAYFORMULA_EXPAND_LACK_ROW_COL_NOT_EXCEED_LIMIT,e)})),(0,g.Z)(G,Cn.RANGE_CAN_ONLY_REFERENCE_ONE_SHEET,(function(e,t){return new Z.ErrorVar(Z.ErrorType.NULL,Z.ErrorConstant.NULL,Cn.RANGE_CAN_ONLY_REFERENCE_ONE_SHEET,{message:t,args:e})})),(0,g.Z)(G,Cn.INVALID_ROMAN_NUMERAL,(function(e,t){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.INVALID_ROMAN_NUMERAL,{message:t,args:e})})),(0,g.Z)(G,Cn.INVALID_CELL_REFERENCE,(function(e,t){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.INVALID_CELL_REFERENCE,{message:t,args:e})})),(0,g.Z)(G,Cn.INVALID_SINGLE_CELL_REFERENCE,(function(e,t){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.INVALID_SINGLE_CELL_REFERENCE,{message:t,args:e})})),(0,g.Z)(G,Cn.ARG_MUST_BE_RANGE,(function(e,t){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.ARG_MUST_BE_RANGE,{message:t,args:e})})),(0,g.Z)(G,Cn.AVERAGE_WEIGHTED_NEGATIVE_ERROR,(function(e){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.AVERAGE_WEIGHTED_NEGATIVE_ERROR,{message:e})})),(0,g.Z)(G,Cn.VALUE_ARRAY_SIZES_NOT_EQUAL,(function(e,t){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.VALUE_ARRAY_SIZES_NOT_EQUAL,{message:t,args:e})})),(0,g.Z)(G,Cn.SETTLEMENT_DATE_NOT_BEFORE_MATURITY_DATE,(function(e,t){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.SETTLEMENT_DATE_NOT_BEFORE_MATURITY_DATE,{message:t,args:e})})),(0,g.Z)(G,Cn.CANNOT_PARSE_TEXT_TO_DATE,(function(e,t){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.CANNOT_PARSE_TEXT_TO_DATE,{message:t,args:e})})),(0,g.Z)(G,Cn.RANGE_MUST_BE_SINGLE_ROW_OR_COLUMN,(function(e,t){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.RANGE_MUST_BE_SINGLE_ROW_OR_COLUMN,{message:t,args:e})})),(0,g.Z)(G,Cn.RANGE_SIZES_NOT_EQUAL,(function(e,t){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.RANGE_SIZES_NOT_EQUAL,{message:t,args:e})})),(0,g.Z)(G,Cn.MATCH_NOT_AVAILABLE,(function(e,t){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.MATCH_NOT_AVAILABLE,{message:t,args:e})})),(0,g.Z)(G,Cn.INCOMPATIBLE_MATRIX_SIZES,(function(e,t){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.INCOMPATIBLE_MATRIX_SIZES,{message:t,args:e})})),(0,g.Z)(G,Cn.NO_MODE,(function(e,t){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.NO_MODE,{message:t,args:e})})),(0,g.Z)(G,Cn.INVALID_WEEKEND_NUMBER,(function(e,t){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.INVALID_WEEKEND_NUMBER,{message:t,args:e})})),(0,g.Z)(G,Cn.PARAMETER_SHOULD_BE_NON_BLANK,(function(e,t){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.PARAMETER_SHOULD_BE_NON_BLANK,{message:t,args:e})})),(0,g.Z)(G,Cn.UNKNOWN_SUBTOTAL_FUNCTION,(function(e,t){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.UNKNOWN_SUBTOTAL_FUNCTION,{message:t,args:e})})),(0,g.Z)(G,Cn.UNKNOWN_AGGREGATE_FUNCTION,(function(e,t){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.UNKNOWN_AGGREGATE_FUNCTION,{message:t,args:e})})),(0,g.Z)(G,Cn.INVALID_FORMAT_PATTERN,(function(e,t){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.INVALID_FORMAT_PATTERN,{message:t,args:e})})),(0,g.Z)(G,Cn.INVALID_CELL_INFO_TYPE,(function(e,t){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.INVALID_CELL_INFO_TYPE,{message:t,args:e})})),(0,g.Z)(G,Cn.CELL_FORMAT_NO_MATCH,(function(e){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.CELL_FORMAT_NO_MATCH,{message:e})})),(0,g.Z)(G,Cn.VALUE_PARAMETER_SHOULD_BE_LESS_THAN_OR_EQUAL_TO,(function(e,t){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.VALUE_PARAMETER_SHOULD_BE_LESS_THAN_OR_EQUAL_TO,{message:t,args:e})})),(0,g.Z)(G,Cn.CONDITION_ROW_MORE_THEN_TO,(function(e,t){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.CONDITION_ROW_MORE_THEN_TO,{message:t,args:e})})),(0,g.Z)(G,Cn.VALUE_RANDARRAY_ERROR_CALC_LARGE,(function(){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.VALUE_RANDARRAY_ERROR_CALC_LARGE)})),(0,g.Z)(G,Cn.TREND_ARGUMENT_NOT_STIRNG,(function(e){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.TREND_ARGUMENT_NOT_STIRNG,{args:e})})),(0,g.Z)(G,Cn.TREND_ARGUMENT_NOT_BOOLEAN,(function(e){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.TREND_ARGUMENT_NOT_BOOLEAN,{args:e})})),(0,g.Z)(G,Cn.TREND_ARGUMENT_NOT_NULL,(function(e){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.TREND_ARGUMENT_NOT_NULL,{args:e})})),(0,g.Z)(G,Cn.REF_ARRAY_LITERAL_COL_NO_MATCH,(function(e){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.REF_ARRAY_LITERAL_COL_NO_MATCH,{args:e})})),(0,g.Z)(G,Cn.UNRESOLVED_SHEET_NAME,(function(e,t){return new Z.ErrorVar(Z.ErrorType.REF,Z.ErrorConstant.REF,Cn.UNRESOLVED_SHEET_NAME,{message:t,args:e})})),(0,g.Z)(G,Cn.DELETED_REFERENCE,(function(e){return new Z.ErrorVar(Z.ErrorType.REF,Z.ErrorConstant.REF,Cn.DELETED_REFERENCE,{message:e})})),(0,g.Z)(G,Cn.REF_ARG_MUST_BE_RANGE,(function(e,t){return new Z.ErrorVar(Z.ErrorType.REF,Z.ErrorConstant.REF,Cn.REF_ARG_MUST_BE_RANGE,{message:t,args:e})})),(0,g.Z)(G,Cn.REF_INVALID_CELL_REFERENCE,(function(e,t){return new Z.ErrorVar(Z.ErrorType.REF,Z.ErrorConstant.REF,Cn.REF_INVALID_CELL_REFERENCE,{message:t,args:e})})),(0,g.Z)(G,Cn.REFERENCE_OUT_OF_BOUNDS,(function(e,t){return new Z.ErrorVar(Z.ErrorType.REF,Z.ErrorConstant.REF,Cn.REFERENCE_OUT_OF_BOUNDS,{message:t,args:e})})),(0,g.Z)(G,Cn.REF_PARAMETER_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO,(function(e,t){return new Z.ErrorVar(Z.ErrorType.REF,Z.ErrorConstant.REF,Cn.REF_PARAMETER_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO,{message:t,args:e})})),(0,g.Z)(G,Cn.REF_PARAMETER_SHOULD_BE_LESS_THAN_OR_EQUAL_TO,(function(e,t){return new Z.ErrorVar(Z.ErrorType.REF,Z.ErrorConstant.REF,Cn.REF_PARAMETER_SHOULD_BE_LESS_THAN_OR_EQUAL_TO,{message:t,args:e})})),(0,g.Z)(G,Cn.REF_OUT_OF_RANGE_PARAMETER,(function(e,t){return new Z.ErrorVar(Z.ErrorType.REF,Z.ErrorConstant.REF,Cn.REF_OUT_OF_RANGE_PARAMETER,{message:t,args:e})})),(0,g.Z)(G,Cn.REF_RANGE_MUST_BE_SINGLE_ROW_OR_COLUMN,(function(e,t){return new Z.ErrorVar(Z.ErrorType.REF,Z.ErrorConstant.REF,Cn.REF_RANGE_MUST_BE_SINGLE_ROW_OR_COLUMN,{message:t,args:e})})),(0,g.Z)(G,Cn.REF_RANDARRAY_ERROR_EXPAND,(function(e,t){return new Z.ErrorVar(Z.ErrorType.REF,Z.ErrorConstant.REF,Cn.REF_RANDARRAY_ERROR_EXPAND,{message:t,args:e})})),(0,g.Z)(G,Cn.REF_INVALID_REGULAR_EXPRESSION,(function(e){return new Z.ErrorVar(Z.ErrorType.REF,Z.ErrorConstant.REF,Cn.REF_INVALID_REGULAR_EXPRESSION,{message:e})})),(0,g.Z)(G,Cn.REF_UNSAFE_REGULAR_EXPRESSION,(function(e){return new Z.ErrorVar(Z.ErrorType.REF,Z.ErrorConstant.REF,Cn.REF_UNSAFE_REGULAR_EXPRESSION,{message:e})})),(0,g.Z)(G,Cn.TREND_ROW_NO_MATCH,(function(e){return new Z.ErrorVar(Z.ErrorType.REF,Z.ErrorConstant.REF,Cn.TREND_ROW_NO_MATCH,{args:e})})),(0,g.Z)(G,Cn.TREND_COL_NO_MATCH,(function(e){return new Z.ErrorVar(Z.ErrorType.REF,Z.ErrorConstant.REF,Cn.TREND_COL_NO_MATCH,{args:e})})),(0,g.Z)(G,Cn.TREND_ROW_COL_NO_MATCH,(function(e){return new Z.ErrorVar(Z.ErrorType.REF,Z.ErrorConstant.REF,Cn.TREND_ROW_COL_NO_MATCH,{args:e})})),(0,g.Z)(G,Cn.REF_ARRAY_ROW_ROW_NO_MATCH,(function(e){return new Z.ErrorVar(Z.ErrorType.REF,Z.ErrorConstant.REF,Cn.REF_ARRAY_ROW_ROW_NO_MATCH,{args:e})})),(0,g.Z)(G,Cn.DATE_PARAMETER_SHOULD_BE_ON_OR_BEFORE_OTHER_DATE_PARAMETER,(function(e,t){return new Z.ErrorVar(Z.ErrorType.NUM,Z.ErrorConstant.NUM,Cn.DATE_PARAMETER_SHOULD_BE_ON_OR_BEFORE_OTHER_DATE_PARAMETER,{message:t,args:e})})),(0,g.Z)(G,Cn.NUM_PARAMETER_SHOULD_BE_INTEGER,(function(e,t){return new Z.ErrorVar(Z.ErrorType.NUM,Z.ErrorConstant.NUM,Cn.NUM_PARAMETER_SHOULD_BE_INTEGER,{message:t,args:e})})),(0,g.Z)(G,Cn.NUM_SETTLEMENT_DATE_NOT_BEFORE_MATURITY_DATE,(function(e,t){return new Z.ErrorVar(Z.ErrorType.NUM,Z.ErrorConstant.NUM,Cn.NUM_SETTLEMENT_DATE_NOT_BEFORE_MATURITY_DATE,{message:t,args:e})})),(0,g.Z)(G,Cn.NUM_MATURITY_DATE_NOT_THAN_SETTLEMENT_DATE_ONE_YEAR,(function(e,t){return new Z.ErrorVar(Z.ErrorType.NUM,Z.ErrorConstant.NUM,Cn.NUM_MATURITY_DATE_NOT_THAN_SETTLEMENT_DATE_ONE_YEAR,{message:t,args:e})})),(0,g.Z)(G,Cn.FUNCTION_RESULT_SHOULD_BE_LESS_THAN_OR_EQUAL_TO,(function(e,t){return new Z.ErrorVar(Z.ErrorType.NUM,Z.ErrorConstant.NUM,Cn.FUNCTION_RESULT_SHOULD_BE_LESS_THAN_OR_EQUAL_TO,{message:t,args:e})})),(0,g.Z)(G,Cn.FUNCTION_RESULT_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO,(function(e,t){return new Z.ErrorVar(Z.ErrorType.NUM,Z.ErrorConstant.NUM,Cn.FUNCTION_RESULT_SHOULD_BE_GREATER_THAN_OR_EQUAL_TO,{message:t,args:e})})),(0,g.Z)(G,Cn.NUM_NOT_BE_BETWEEN_INCLUSIVE_PARAMETER,(function(e,t){return new Z.ErrorVar(Z.ErrorType.NUM,Z.ErrorConstant.NUM,Cn.NUM_NOT_BE_BETWEEN_INCLUSIVE_PARAMETER)})),(0,g.Z)(G,Cn.NUM_PARAMETER_SUM_EXCEED_LIMIT,(function(e,t){return new Z.ErrorVar(Z.ErrorType.NUM,Z.ErrorConstant.NUM,Cn.NUM_PARAMETER_SUM_EXCEED_LIMIT,{message:t,args:e})})),(0,g.Z)(G,Cn.MORE_THEN_ONE_MATCH_FOUND,(function(e,t){return new Z.ErrorVar(Z.ErrorType.NUM,Z.ErrorConstant.NUM,Cn.MORE_THEN_ONE_MATCH_FOUND,{message:t,args:e})})),(0,g.Z)(G,Cn.NUM_NOT_BE_NEGATIVE_INTEGER_OR_ZERO,(function(e,t){return new Z.ErrorVar(Z.ErrorType.NUM,Z.ErrorConstant.NUM,Cn.NUM_NOT_BE_NEGATIVE_INTEGER_OR_ZERO,{message:t,args:e})})),(0,g.Z)(G,Cn.NUM_NOT_BE_NEGATIVE_NUMBER_OR_ZERO,(function(e,t){return new Z.ErrorVar(Z.ErrorType.NUM,Z.ErrorConstant.NUM,Cn.NUM_NOT_BE_NEGATIVE_NUMBER_OR_ZERO,{message:t,args:e})})),(0,g.Z)(G,Cn.NA_MATCH_NOT_AVAILABLE,(function(e,t){return new Z.ErrorVar(Z.ErrorType.NA,Z.ErrorConstant.NA,Cn.NA_MATCH_NOT_AVAILABLE,{message:t,args:e})})),(0,g.Z)(G,Cn.INVALID_FORMULA_PARSED_RESULT,(function(e){return new Z.ErrorVar(Z.ErrorType.NA,Z.ErrorConstant.NA,Cn.INVALID_FORMULA_PARSED_RESULT,{message:e})})),(0,g.Z)(G,Cn.LOOKUP_VALUE_NOT_FOUND,(function(e,t){return new Z.ErrorVar(Z.ErrorType.NA,Z.ErrorConstant.NA,Cn.LOOKUP_VALUE_NOT_FOUND,{message:t,args:e})})),(0,g.Z)(G,Cn.NA_INVALID_CELL_REFERENCE,(function(e,t){return new Z.ErrorVar(Z.ErrorType.NA,Z.ErrorConstant.NA,Cn.NA_INVALID_CELL_REFERENCE,{message:t,args:e})})),(0,g.Z)(G,Cn.OUT_OF_RANGE_FUNCTION,(function(e,t){return new Z.ErrorVar(Z.ErrorType.NA,Z.ErrorConstant.NA,Cn.OUT_OF_RANGE_FUNCTION,{message:t,args:e})})),(0,g.Z)(G,Cn.NA_RANGE_MUST_BE_SINGLE_ROW_OR_COLUMN,(function(e,t){return new Z.ErrorVar(Z.ErrorType.NA,Z.ErrorConstant.NA,Cn.NA_RANGE_MUST_BE_SINGLE_ROW_OR_COLUMN,{message:t,args:e})})),(0,g.Z)(G,Cn.NA_NO_MODE,(function(e,t){return new Z.ErrorVar(Z.ErrorType.NA,Z.ErrorConstant.NA,Cn.NA_NO_MODE,{message:t,args:e})})),(0,g.Z)(G,Cn.NA_DELETED_REFERENCE,(function(e){return new Z.ErrorVar(Z.ErrorType.NA,Z.ErrorConstant.NA,Cn.NA_DELETED_REFERENCE,{message:e})})),(0,g.Z)(G,Cn.NA_ARRAY_SIZES_NOT_EQUAL,(function(e,t){return new Z.ErrorVar(Z.ErrorType.NA,Z.ErrorConstant.NA,Cn.NA_ARRAY_SIZES_NOT_EQUAL,{message:t,args:e})})),(0,g.Z)(G,Cn.NA_REGULAR_EXPRESSION_NO_MATCH,(function(e){return new Z.ErrorVar(Z.ErrorType.NA,Z.ErrorConstant.NA,Cn.NA_REGULAR_EXPRESSION_NO_MATCH,{message:e})})),(0,g.Z)(G,Cn.NA_REQUIRED_ARGUMENT_SIZES_NOT_EQUAL,(function(e,t){return new Z.ErrorVar(Z.ErrorType.NA,Z.ErrorConstant.NA,Cn.NA_REQUIRED_ARGUMENT_SIZES_NOT_EQUAL,{message:t,args:e})})),(0,g.Z)(G,Cn.TREND_POINT_NUM_UNENOUGHT,(function(e,t){return new Z.ErrorVar(Z.ErrorType.NA,Z.ErrorConstant.NA,Cn.TREND_POINT_NUM_UNENOUGHT,{message:t,args:e})})),(0,g.Z)(G,Cn.NA_PARAMETER_SHOULD_BE_NON_BLANK,(function(e,t){return new Z.ErrorVar(Z.ErrorType.NA,Z.ErrorConstant.NA,Cn.NA_PARAMETER_SHOULD_BE_NON_BLANK,{message:t,args:e})})),(0,g.Z)(G,Cn.DIV_TREND_POINT_NUM_UNENOUGHT,(function(e,t){return new Z.ErrorVar(Z.ErrorType.DIV0,Z.ErrorConstant.DIV0,Cn.DIV_TREND_POINT_NUM_UNENOUGHT,{message:t,args:e})})),(0,g.Z)(G,Cn.CALC_PARAMETER_SHOULD_BE_NON_BLANK,(function(e,t){return new Z.ErrorVar(Z.ErrorType.CALC,Z.ErrorConstant.CALC,Cn.CALC_PARAMETER_SHOULD_BE_NON_BLANK,{message:t,args:e})})),(0,g.Z)(G,Cn.IMPORT_RANGE_PARSE_ERROR,(function(e){return new Z.ErrorVar(Z.ErrorType.RUNTIME_ERROR,Z.ErrorConstant.RUNTIME_ERROR,Cn.IMPORT_RANGE_PARSE_ERROR,{message:e})})),(0,g.Z)(G,Cn.GETPIVOTDATA_NO_MATCHING_FIELD_ITEM_PAIR,(function(e){return new Z.ErrorVar(Z.ErrorType.REF,Z.ErrorConstant.REF,Cn.GETPIVOTDATA_NO_MATCHING_FIELD_ITEM_PAIR,{message:e})})),(0,g.Z)(G,Cn.TOTAL_VALUE_SHOULD_BE_EQUAL_TO,(function(e,t){return new Z.ErrorVar(Z.ErrorType.NUM,Z.ErrorConstant.NUM,Cn.TOTAL_VALUE_SHOULD_BE_EQUAL_TO,{message:t,args:e})})),(0,g.Z)(G,Cn.NEGATIVE_OVERFLOW,(function(e,t){return new Z.ErrorVar(Z.ErrorType.NUM,Z.ErrorConstant.NUM,Cn.NEGATIVE_OVERFLOW)})),(0,g.Z)(G,Cn.NA_NON_PAIR_ARGUMENTS,(function(e,t){return new Z.ErrorVar(Z.ErrorType.NA,Z.ErrorConstant.NA,Cn.NA_NON_PAIR_ARGUMENTS,{message:t,args:e})})),(0,g.Z)(G,Cn.PARAMETER_RANGE_SIZES_NOT_EQUAL,(function(e,t){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.PARAMETER_RANGE_SIZES_NOT_EQUAL,{message:t,args:e})})),(0,g.Z)(G,Cn.FORMULA_WITH_SAME_NAME_PARAMETER,(function(e){return new Z.ErrorVar(Z.ErrorType.NAME,Z.ErrorConstant.NAME,Cn.FORMULA_WITH_SAME_NAME_PARAMETER,{args:e})})),(0,g.Z)(G,Cn.FORMULA_WITH_INVALID_PARAM,(function(e){return new Z.ErrorVar(Z.ErrorType.NAME,Z.ErrorConstant.NAME,Cn.FORMULA_WITH_INVALID_PARAM,{args:e})})),(0,g.Z)(G,Cn.FORMULA_SHOULD_BE_FOLLOWED_BY_A_CALL,(function(e){return new Z.ErrorVar(Z.ErrorType.NA,Z.ErrorConstant.NA,Cn.FORMULA_SHOULD_BE_FOLLOWED_BY_A_CALL,{args:e})})),(0,g.Z)(G,Cn.WRONG_NUMBER_OF_ARGUMENTS_TO_CALL_FOLLOWING_LAMBDA_FUNCTION,(function(e){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.WRONG_NUMBER_OF_ARGUMENTS_TO_CALL_FOLLOWING_LAMBDA_FUNCTION,{args:e})})),(0,g.Z)(G,Cn.MATRIX_ROWS_SHOULD_BE_EQUAL_COLS,(function(e,t){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.MATRIX_ROWS_SHOULD_BE_EQUAL_COLS,{message:t,args:e})})),(0,g.Z)(G,Cn.MATRIX_WAS_NOT_INVERTIBLE,(function(e,t){return new Z.ErrorVar(Z.ErrorType.NUM,Z.ErrorConstant.NUM,Cn.MATRIX_WAS_NOT_INVERTIBLE,{message:t,args:e})})),(0,g.Z)(G,Cn.NO_VALUE_FOR_THIS_CELL_FUNCTION,(function(e,t){return new Z.ErrorVar(Z.ErrorType.NA,Z.ErrorConstant.NA,Cn.NO_VALUE_FOR_THIS_CELL_FUNCTION,{message:t,args:e})})),(0,g.Z)(G,Cn.NO_VALUE_FOR_THIS_CELL_PARAMETER,(function(e,t){return new Z.ErrorVar(Z.ErrorType.NA,Z.ErrorConstant.NA,Cn.NO_VALUE_FOR_THIS_CELL_PARAMETER,{message:t,args:e})})),(0,g.Z)(G,Cn.VALUE_BY_ZERO_FROM_PARAMETER_BEING_ZERO,(function(e,t){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.VALUE_BY_ZERO_FROM_PARAMETER_BEING_ZERO,{message:t,args:e})})),(0,g.Z)(G,Cn.LINEST_NO_STATISTICAL_INFO,(function(e){return new Z.ErrorVar(Z.ErrorType.NA,Z.ErrorConstant.NA,Cn.LINEST_NO_STATISTICAL_INFO,{message:e})})),(0,g.Z)(G,Cn.PARAMETER_SHOULD_BE_LAMBDA,(function(){return new Z.ErrorVar(Z.ErrorType.NA,Z.ErrorConstant.NA,Cn.PARAMETER_SHOULD_BE_LAMBDA)})),(0,g.Z)(G,Cn.RESULT_SHOULD_BE_SINGLE_ROW,(function(){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.RESULT_SHOULD_BE_SINGLE_ROW)})),(0,g.Z)(G,Cn.RESULT_SHOULD_BE_SINGLE_COL,(function(){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.RESULT_SHOULD_BE_SINGLE_COL)})),(0,g.Z)(G,Cn.RESULT_SHOULD_BE_SINGLE,(function(){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.RESULT_SHOULD_BE_SINGLE)})),(0,g.Z)(G,Cn.THE_NUMBER_OF_PARAMETERS_OF_A_FUNCTION_MUST_BE_ODD,(function(e){return new Z.ErrorVar(Z.ErrorType.NA,Z.ErrorConstant.NA,Cn.THE_NUMBER_OF_PARAMETERS_OF_A_FUNCTION_MUST_BE_ODD,{args:e})})),(0,g.Z)(G,Cn.IMPORT_ERR_CAN_NOT_USE_BLACK_LIST_FUNCTION,(function(){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.IMPORT_ERR_CAN_NOT_USE_BLACK_LIST_FUNCTION)})),(0,g.Z)(G,Cn.IMPORT_ERR_INVAILD_DELIMITER,(function(e){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.IMPORT_ERR_INVAILD_DELIMITER,{args:e})})),(0,g.Z)(G,Cn.NO_QUERY_OUTPUT,(function(){return new Z.ErrorVar(Z.ErrorType.NA,Z.ErrorConstant.NA,Cn.NO_QUERY_OUTPUT)})),(0,g.Z)(G,Cn.IMPORT_ERR_INVAILD_PARAM,(function(){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.IMPORT_ERR_INVAILD_PARAM)})),(0,g.Z)(G,Cn.IMPORT_ERR_INVAILD_URL,(function(e){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.IMPORT_ERR_INVAILD_URL,{args:e})})),(0,g.Z)(G,Cn.IMPORT_ERR_NO_AUTHORIZED,(function(){return new Z.ErrorVar(Z.ErrorType.VALUE,Z.ErrorConstant.VALUE,Cn.IMPORT_ERR_NO_AUTHORIZED)})),(0,g.Z)(G,Cn.IMPORT_ERR_DATA_SIZE_OVER_LIMIT,(function(e){return new Z.ErrorVar(Z.ErrorType.RUNTIME_ERROR,Z.ErrorConstant.RUNTIME_ERROR,Cn.IMPORT_ERR_DATA_SIZE_OVER_LIMIT,{args:e})})),(0,g.Z)(G,Cn.IMPORT_ERR_PEDDING,(function(){return new Z.ErrorVar(Z.ErrorType.WAIT_ASYNC,Z.ErrorConstant.WAIT_ASYNC,Cn.IMPORT_ERR_PEDDING)})),(0,g.Z)(G,Cn.IMPORT_ERR_CRAWL_WAITING,(function(){return new Z.ErrorVar(Z.ErrorType.WAIT_ASYNC,Z.ErrorConstant.WAIT_ASYNC,Cn.IMPORT_ERR_CRAWL_WAITING)})),(0,g.Z)(G,Cn.IMPORT_ERR_CRAW_RUNNING,(function(){return new Z.ErrorVar(Z.ErrorType.WAIT_ASYNC,Z.ErrorConstant.WAIT_ASYNC,Cn.IMPORT_ERR_CRAW_RUNNING)})),G);function Gn(e,t){return t<0?t.toString():(0,U.createFormatter)(e,"MM/DD/YYYY").format(t)}!function(e){e.CELL_IS="cellIs",e.CONTAINS_TEXT="containsText",e.COLOR="color",e.MULTI_VALUES="multiValues"}(In||(In={})),function(e){e[e.General=0]="General",e[e.Text=1]="Text",e[e.Number=2]="Number",e[e.Percentage=3]="Percentage",e[e.Currency=4]="Currency",e[e.DateTime=5]="DateTime"}(xn||(xn={})),function(e){e.GENERAL="general",e.PLAIN_TEXT="plain_text",e.DIGITAL_WITHOUT_SEPARATOR="digital_without_separator",e.DIGITAL="digital",e.DIGITAL_ROUNDED="digital_round",e.PERCENTAGE_ROUNDED="percentage_rounded",e.PERCENTAGE="percentage",e.SCIENTIFIC="scientific",e.CYN_ROUNDED="cyn_rounded",e.CYN="cyn",e.DOLLAR_ROUNDED="dollar_rounded",e.DOLLAR="dollar",e.DATE_WITH_SLASH="date_with_slash",e.DATE_WITH_HYPHEN="date_with_hyphen",e.TIME="time",e.DATE_TIME="date_time"}(Nn||(Nn={})),function(e){e[e.prefix=0]="prefix",e[e.suffix=1]="suffix"}(Pn||(Pn={})),function(e){e.position="p"}(Ln||(Ln={})),function(e){e.arrayRef="r"}(Dn||(Dn={})),function(e){e.arrayInfo="a",e.errorInfo="e"}(Fn||(Fn={})),function(e){e.sheetId="s",e.row="r",e.col="c"}(Bn||(Bn={})),function(e){e.canArrayExpand="e",e.matrix="m",e.rowCount="r",e.colCount="c",e.specialInfo="s"}(Vn||(Vn={})),function(e){e.userId="u",e.position="p"}(Hn||(Hn={})),function(e){e.aiInfo="ai"}(Un||(Un={})),function(e){e.BOLD="bold",e.UNDERLINE="underline",e.LINE_THROUGH="lineThrough",e.ITALIC="italic",e.HORIZONTAL_FILL="horizontalFill",e.VERTICAL_FILL="verticalFill",e.PASTE_VALUES_ONLY="pasteValuesOnly",e.PASTE_FORMATS_ONLY="pasteFormatsOnly",e.PASTE_FORMULAS_ONLY="pasteFormulasOnly",e.PASTE_VALIDATIONS_ONLY="pasteValidationsOnly",e.PASTE_WITH_TRANSPOSE="pasteWithTranspose",e.PASTE_CONDITiON_FORMAT_MERGE="pasteConditionFormatMerge",e.NAVIGATION_DOWN="navigationDown",e.MOVE_TO_NEXT_CELL="moveToNextCell",e.PASTE="paste",e.SET_COMMENTS="setComments",e.SET_RANGE_STYLE="setRangeStyle",e.SET_STYLE_FONT="setStyleFont",e.SET_FORMATTER="setFormatter",e.SET_TEXT_DECORATION="setTextDecoration",e.MERGE_CELLS="mergeCells",e.SET_ROW_COL_CHANGE="setRowColChange",e.SET_ROW_COL_VISIBLE="setRowColVisible",e.DO_CLEAR="doClear",e.CLEAR_VALUES_STYLE="clearValuesAndStyles",e.CLEAR_DATA_VALIDATION="CLEAR_DATA_VALIDATION",e.SORT_RANGE="sortRange",e.AUTO_FIT_ROW="autoFitRow",e.AUTO_FIT_COLUMN="autoFitColumn",e.ADD_SHEET="addSheet",e.MOVE_SHEET="moveSheet",e.DELETE_SHEET="deleteSheet",e.SET_SHEET_PROPERTY="setSheetProperty",e.COPY_SHEET="copySheet",e.RESIZE_ROW="resizeRow",e.RESIZE_COLUMN="resizeColumn",e.EDIT_CELL="editCell",e.CLIPBOARD_PASTE="clipboardPaste",e.CLEAR_VALUES="clearValues",e.SET_FILTER="setFilter",e.FREEZE_SHEET="freezeSheet",e.FORMAT_PAINTER="formatPainter",e.REPLACE="replace",e.SET_DROPDOWN_VALID="setDropdownValid",e.CONVERT_LINK="convertLink",e.LOCK_ROW="lockRow",e.UNLOCK_ROW="unlockRow",e.LOCK_COL="lockCol",e.UNLOCK_COL="unlockCol",e.LOCK_SHEET="lockSheet",e.UNLOCK_SHEET="unlockSheet",e.MODIFY_VALUES="modifyValues",e.SET_CONDITIONAL_FORMAT="setConditionalFormat",e.INCREASE_FONT_SIZE="increaseFontSize",e.DECREASE_FONT_SIZE="decreaseFontSize",e.SET_CHART="setChart",e.SET_FLOAT_IMAGE="setFloatImage",e.SET_FLOAT_BLOCK="setFloatBlock",e.CONVERT_IMAGE="convertImage",e.CLICK_COPY="clickCopy",e.CLICK_CUT="clickCut",e.COPY_CELL_POSITION="copyCellPosition",e.ADD_BLOCK="addBlock",e.DEL_BLOCK="delBlock",e.COPY_BLOCK="copyBlock",e.MOVE_ROW_COL="moveRowCol",e.MOVE_RANGE="moveRange",e.SET_REMINDER="setReminder",e.ADD_REMINDER="addReminder",e.SET_VALUE_BY_DATA_VALIDATION="setValueByDataValidation",e.SET_MULTIPLE_VALUES_BY_RANGE="setMultipleValuesByRange",e.CLEAR="clear",e.ADD_ROW_AND_COL="addRowAndCol",e.ADD_VIEW="add_view",e.DEL_VIEW="del_view",e.SET_VIEW="set_view",e.ENTER_VIEW="enter_view",e.EXIT_VIEW="exit_view",e.SET_FILTER_VIEW="set_filter_view",e.ADD_VIEW_NOT_UNDO="add_view_not_undo",e.DEL_VIEW_NOT_UNDO="del_view_not_undo",e.SET_DATA_VALIDATION="setDataValidation",e.SET_DATA_RANGE="setDataRange",e.SET_LIST_DATA_VALIDATION="setListValidation",e.SET_CHECKBOX_VALIDATION="setCheckboxValidation",e.SET_DATE_TIME_VALIDATION="setDateTimeValidation",e.DATA_SPLIT="dataSplit",e.REMOVE_DUPLICATION="removeDuplication",e.FORMAT_PIVOT_TABLE_RANGE="formatPivotTableRange",e.SET_EMBEDDED_BLOCK="setEmbeddedBlock",e.SEARCH="search",e.FILL="fill",e.FILL_RANGE="fillRange",e.SET_RANGE_VALUES="setRangeValues",e.ADD_OR_DELETE_CELL="addOrDeleteCell",e.FILL_HORIZONTAL="fillHorizontal",e.FILL_VERTICAL="fillVertical",e.ADD_OUTLINE="addOutline",e.UPDATE_OUTLINE="updateOutline",e.DEL_OUTLINE="delOutline",e.ADD_SPARKLINE_GROUP="addSparklineGroup",e.DEL_SPARKLINE_GROUP="delSparklineGroup",e.UPDATE_SPARKLINE_GROUP="updateSparklineGroup",e.GROUP_SPARKLINE="groupSparkline",e.UNGROUP_SPARKLINE="ungroupSparkline",e.SPARKLINE_ROW_COL_CHANGE="sparklineRowColChange",e.SET_CELL_NOTE="setCellNote",e.CLEAR_NOTES="clearNotes",e.SET_RANGE_PROTECTION="setRangeProtection",e.DEL_RANGE_PROTECTION="delRangeProtection"}(Zn||(Zn={})),function(e){e.TICK="tick",e.END="end",e.SCROLL="scroll",e.LOAD_ALONE="load_alone_sheet",e.LOAD_EMBED="load_embed_sheet",e.SWITCHTAB="switch_tab",e.HIDE_FREEZE_SHADOW="hide_freeze_shadow",e.UNKNOWN="unknown"}(Wn||(Wn={}));var zn,Yn,Xn="PIVOT_EVENT",Kn=Object.assign({},Wn,{},Zn);!function(e){e.NORMAL="normal",e.TRANSLATE="translate"}(zn||(zn={}));var qn=function(e){function t(e){var n;return(0,c.Z)(this,t),(n=(0,h.Z)(this,(0,d.Z)(t).call(this,"ImportRange error code: ".concat(e)))).code=e,Object.setPrototypeOf((0,f.Z)(n),t.prototype),n}return(0,p.Z)(t,e),t}((0,v.Z)(Error));!function(e){e[e.V2=2]="V2",e[e.V3=3]="V3"}(Yn||(Yn={}));var $n,Jn,Qn,er,tr,nr,rr,ir,or=(z={},(0,g.Z)(z,Cn.CIRCULAR_REFERENCE,new qn(Cn.CIRCULAR_REFERENCE)),(0,g.Z)(z,Cn.REFERENCE_NOT_EXIST,new qn(Cn.REFERENCE_NOT_EXIST)),(0,g.Z)(z,Cn.PERMISSION_DENY,new qn(Cn.PERMISSION_DENY)),(0,g.Z)(z,Cn.INVALID_TOKEN,new qn(Cn.INVALID_TOKEN)),(0,g.Z)(z,Cn.INVALID_SHEET,new qn(Cn.INVALID_SHEET)),(0,g.Z)(z,Cn.SERVER_ERROR,new qn(Cn.SERVER_ERROR)),(0,g.Z)(z,Cn.MAX_LAYER_ERROR,new qn(Cn.MAX_LAYER_ERROR)),(0,g.Z)(z,Cn.DATA_NOT_READY,new qn(Cn.DATA_NOT_READY)),(0,g.Z)(z,Cn.REQUEST_FAIL,new qn(Cn.REQUEST_FAIL)),(0,g.Z)(z,Cn.EXIST_FML_LIMIT,new qn(Cn.EXIST_FML_LIMIT)),(0,g.Z)(z,Cn.EXIST_REF_LIMIT,new qn(Cn.EXIST_REF_LIMIT)),(0,g.Z)(z,Cn.ACCESSKEY_EXPIRED,new qn(Cn.ACCESSKEY_EXPIRED)),(0,g.Z)(z,Cn.DATA_SOURCE_NOT_EXIST_V3,new qn(Cn.DATA_SOURCE_NOT_EXIST_V3)),(0,g.Z)(z,Cn.FORMULA_SOURCE_NOT_EXIST_V3,new qn(Cn.FORMULA_SOURCE_NOT_EXIST_V3)),(0,g.Z)(z,Cn.REFERENCE_NOT_EXIST_V3,new qn(Cn.REFERENCE_NOT_EXIST_V3)),(0,g.Z)(z,Cn.PERMISSION_DENY_V3,new qn(Cn.PERMISSION_DENY_V3)),(0,g.Z)(z,Cn.DATA_SOURCE_IN_TRASH,new qn(Cn.DATA_SOURCE_IN_TRASH)),z);function ar(e){switch(e){case 1:return or[Cn.CIRCULAR_REFERENCE];case 2:return or[Cn.REFERENCE_NOT_EXIST];case 10:return or[Cn.DATA_NOT_READY];case 3:return or[Cn.PERMISSION_DENY];case 4:return or[Cn.INVALID_TOKEN];case 5:return or[Cn.INVALID_SHEET];case 6:return or[Cn.SERVER_ERROR];case 7:return or[Cn.MAX_LAYER_ERROR];case 11:return or[Cn.EXIST_FML_LIMIT];case 12:return or[Cn.EXIST_REF_LIMIT];case 14:return or[Cn.DATA_SOURCE_NOT_EXIST_V3];case 15:return or[Cn.FORMULA_SOURCE_NOT_EXIST_V3];case 16:return or[Cn.PERMISSION_DENY_V3];case 17:return or[Cn.DATA_SOURCE_IN_TRASH];default:return null}}function sr(e,t,n){return new Z.ErrorVar(Z.ErrorType.RUNTIME_ERROR,Z.ErrorConstant.RUNTIME_ERROR,e,{message:t,args:n})}function ur(e,t,n){return new Z.ErrorVar(Z.ErrorType.WAIT_ASYNC,Z.ErrorConstant.WAIT_ASYNC,e,{message:t,args:n})}!function(e){e[e.IRDataTypeNormal=0]="IRDataTypeNormal",e[e.IRDataTypeCircuit=1]="IRDataTypeCircuit",e[e.IRDataTypeNotExist=2]="IRDataTypeNotExist",e[e.IRDataTypePermDeny=3]="IRDataTypePermDeny",e[e.IRDataTypeInvalidToken=4]="IRDataTypeInvalidToken",e[e.IRDataTypeInvalidSheet=5]="IRDataTypeInvalidSheet",e[e.IRDataTypeServerError=6]="IRDataTypeServerError",e[e.IRDataTypeMaxLayerError=7]="IRDataTypeMaxLayerError",e[e.IRDataTypeNoChange=8]="IRDataTypeNoChange",e[e.IRDataTypeNotReady=10]="IRDataTypeNotReady",e[e.IRDataTypeExistFmlLimit=11]="IRDataTypeExistFmlLimit",e[e.IRDataTypeExistRefLimit=12]="IRDataTypeExistRefLimit",e[e.IRDataTypeReferenceExist=13]="IRDataTypeReferenceExist",e[e.IRDataTypeDataSourceSSIDNotExist=14]="IRDataTypeDataSourceSSIDNotExist",e[e.IRDataTypeFormulaSourceSSIDNotExist=15]="IRDataTypeFormulaSourceSSIDNotExist",e[e.IRDataTypeAuthChangePermDeny=16]="IRDataTypeAuthChangePermDeny",e[e.IRDataTypeDataSourceInTRASH=17]="IRDataTypeDataSourceInTRASH",e[e.IRDataTypeLimitUpdated=18]="IRDataTypeLimitUpdated"}($n||($n={})),function(e){e[e.wait=99]="wait",e[e.success=0]="success",e[e.fail=2]="fail"}(Jn||(Jn={})),function(e){e.Background="background_layer",e.DataCleanBackground="data_clean_background",e.Highlight="highlight_layer",e.Comment="comment_layer",e.ProtectedEditCell="protected_edit_cell_layer",e.ProtectedCell="protected_cell_layer",e.Image="image_layer",e.CellBorder="cell_border_layer",e.ConditionalFormat="conditional_format_layer",e.DataBar="data_bar",e.Typography="typography_layer",e.Invalidate="invalidate_layer",e.HeaderText="header_text_layer",e.IconSet="icon_set_layer",e.CompatibilityDocument="compatibility_document_layer",e.Stroke="stroke_layer",e.HeaderBorder="header_border_layer",e.UnhideIcon="unhide_icon_layer",e.FilterIcon="filter_icon_layer",e.FilterSortIcon="filter_sort_icon_layer",e.CollapseIcon="collapse_cion_layer",e.DropdownIcon="dropdown_icon_layer",e.CommentIcon="comment_icon_layer",e.TipIcon="tip_icon_layer",e.InsetIcon="inset_icon_layer",e.CardBorder="card_border_layer",e.ReadMore="read_more_layer",e.List="list_layer",e.FloatImage="float_image",e.ReminderIcon="reminder_icon_layer",e.WaterMark="watermark_layer",e.ColorScale="color_scale_layer",e.Content="content",e.FloatBlockImage="float_block_image",e.InvalidateIcon="invalidate_icon",e.GroupHideLine="group_hide_line",e.Sparkline="sparkline_layer",e.CellNoteIcon="cell_note_icon",e.Invisible="invisible_layer"}(Qn||(Qn={})),function(e){e[e.UNSET=0]="UNSET",e[e.EMOJI=1]="EMOJI",e[e.IMAGE=2]="IMAGE",e[e.USER_UPLOAD_IMAGE=3]="USER_UPLOAD_IMAGE"}(er||(er={})),function(e){e[e.Expand=0]="Expand",e[e.Fold=1]="Fold"}(tr||(tr={})),function(e){e[e.NORMAL=0]="NORMAL",e[e.ROW=1]="ROW",e[e.COL=2]="COL",e[e.ALL=3]="ALL",e[e.CELL=4]="CELL",e[e.INVALID=5]="INVALID"}(nr||(nr={})),function(e){e[e.Normal=0]="Normal",e[e.Row=1]="Row",e[e.Col=2]="Col",e[e.All=3]="All"}(rr||(rr={})),function(e){e[e.NONE=-1]="NONE",e[e.AT_TIME_OF_EVENT=0]="AT_TIME_OF_EVENT",e[e.BEFORE_5_MINUTES=1]="BEFORE_5_MINUTES",e[e.BEFORE_15_MINUTES=2]="BEFORE_15_MINUTES",e[e.BEFORE_30_MINUTES=3]="BEFORE_30_MINUTES",e[e.BEFORE_1_HOUR=4]="BEFORE_1_HOUR",e[e.BEFORE_2_HOURS=5]="BEFORE_2_HOURS",e[e.AT_DAY_OF_EVENT=6]="AT_DAY_OF_EVENT",e[e.BEFORE_1_DAY=7]="BEFORE_1_DAY",e[e.BEFORE_2_DAYS=8]="BEFORE_2_DAYS",e[e.BEFORE_1_WEEK=9]="BEFORE_1_WEEK",e[e.AT_TIME_BEFORE_1_DAY=10]="AT_TIME_BEFORE_1_DAY",e[e.AT_TIME_BEFORE_2_DAYS=11]="AT_TIME_BEFORE_2_DAYS",e[e.AT_TIME_BEFORE_1_WEEK=12]="AT_TIME_BEFORE_1_WEEK"}(ir||(ir={}));var lr,cr,hr,dr,fr,pr,vr,gr={0:"at_time_of_event",1:"before_5_minutes",2:"before_15_minutes",3:"before_30_minutes",4:"before_1_hour",5:"before_2_hours",6:"at_day_of_event",7:"before_1_day",8:"before_2_days",9:"before_1_week",10:"at_time_before_1_day",11:"at_time_before_2_day",12:"at_time_before_1_week"};!function(e){e.ADD_REMINDER="add_reminder",e.SWITCH_REMINDER="switch_reminder",e.SET_REMINDER_TIME="set_reminder_time",e.EDIT_REMINDER_PERSON="edit_reminder_person",e.EDIT_REMINDER_TEXT="edit_reminder_text",e.HOVER_CLOCK_ICON="hover_clock_icon",e.SHOW_REMINDER_LIMIT_TOAST="show_reminder_limit_toast"}(lr||(lr={})),function(e){e.ON="on",e.OFF="off"}(cr||(cr={})),function(e){e.TEXT="text",e.MENTION="mention",e.URL="url",e.EMBED_IMAGE="embed-image",e.REMINDER="reminder",e.PANO="pano",e.ATTACHMENT="attachment"}(hr||(hr={})),function(e){e[e.UNSET=0]="UNSET",e[e.EMOJI=1]="EMOJI",e[e.IMAGE=2]="IMAGE",e[e.USER_UPLOAD_IMAGE=3]="USER_UPLOAD_IMAGE"}(dr||(dr={})),function(e){e[e.UNSET=0]="UNSET",e[e.EMOJI=1]="EMOJI",e[e.IMAGE=2]="IMAGE",e[e.USER_UPLOAD_IMAGE=3]="USER_UPLOAD_IMAGE"}(fr||(fr={})),function(e){e.Url="Url",e.Base64="Base64"}(pr||(pr={})),function(e){e[e.CHANGED_FLAG=0]="CHANGED_FLAG",e[e.CELL_VALUE=1]="CELL_VALUE",e[e.STYLE_INDEX=2]="STYLE_INDEX",e[e.FORMULADATA_INDEX=3]="FORMULADATA_INDEX",e[e.DATAVALIDATION_INDEX=4]="DATAVALIDATION_INDEX",e[e.MULTIPLE_VALUE_INDEX=5]="MULTIPLE_VALUE_INDEX",e[e.REMINDER=6]="REMINDER",e[e.NOTE=10]="NOTE"}(vr||(vr={}));var _r,yr,mr={0:"font",1:"vAlign",2:"hAlign",3:"textDecoration",4:"wordWrap",5:"backColor",6:"foreColor",7:"formatter",8:"borderLeft",9:"borderTop",10:"borderRight",11:"borderBottom",12:"autoFormatter",13:"hideLink",14:"diagonal",15:"diagonalUp",16:"diagonalDown",17:"textRotation",font:0,vAlign:1,hAlign:2,textDecoration:3,wordWrap:4,backColor:5,foreColor:6,formatter:7,borderLeft:8,borderTop:9,borderRight:10,borderBottom:11,autoFormatter:12,hideLink:13,diagonal:14,diagonalUp:15,diagonalDown:16,textRotation:17};!function(e){e[e.BeginsWith=0]="BeginsWith",e[e.EndsWith=1]="EndsWith",e[e.Contains=2]="Contains",e[e.DoesNotContain=3]="DoesNotContain",e[e.Equal=4]="Equal",e[e.DoesNotBeginWith=5]="DoesNotBeginWith",e[e.DoesNotEndWith=6]="DoesNotEndWith"}(_r||(_r={})),function(e){e[e.Center=0]="Center",e[e.EqualWidth=1]="EqualWidth",e[e.Fill=2]="Fill",e[e.None=3]="None",e[e.Custom=4]="Custom"}(yr||(yr={}));var Er,br,Tr,Cr=500;!function(e){e[e.RELATED=0]="RELATED",e[e.UNRELATED=1]="UNRELATED"}(Er||(Er={})),function(e){e[e.DEFAULT=0]="DEFAULT",e[e.TEMPLATE=1]="TEMPLATE"}(br||(br={})),function(e){e[e.Normal=0]="Normal",e[e.Copying=1]="Copying",e[e.CopyFailed=2]="CopyFailed"}(Tr||(Tr={}));var Sr,wr,Rr,Ar,Or,Mr,kr,Ir,xr,Nr,Pr,Lr,Dr=1;!function(e){e[e.NORMA=0]="NORMA",e[e.GROUP_ANNOUNCEMENT=1]="GROUP_ANNOUNCEMENT",e[e.MEETING_MINUTES=2]="MEETING_MINUTES",e[e.SUB_DOC=3]="SUB_DOC",e[e.VERSION=4]="VERSION",e[e.DOC_IN_SHEET=5]="DOC_IN_SHEET",e[e.FILE_EDITING=6]="FILE_EDITING",e[e.ADVANCED_BASE=80]="ADVANCED_BASE",e[e.LINK_ISV=99]="LINK_ISV",e[e.WIKI=100]="WIKI",e[e.WIKI_HOME=101]="WIKI_HOME",e[e.UGC_TEMPLATE=110]="UGC_TEMPLATE",e[e.EGC_TEMPLATE=115]="EGC_TEMPLATE",e[e.PGC_TEMPLATE=120]="PGC_TEMPLATE"}(Sr||(Sr={})),function(e){e.HeadToolbar="head_toolbar",e.ContextMenu="context_menu",e.FileMenu="file_menu",e.FilterPanel="filter_panel",e.HotKey="hot_key"}(wr||(wr={})),function(e){e[e.Normal=1]="Normal",e[e.High=2]="High"}(Rr||(Rr={})),function(e){e.Idle="idle",e.Pending="pending",e.Done="done"}(Ar||(Ar={})),function(e){e.onDemand="onDemand",e.runInBackground="runInBackground"}(Or||(Or={})),function(e){e.READABLE="readable",e.COMMENTABLE="commentable",e.EDITABLE="editable",e.SHAREABLE="shareable"}(Mr||(Mr={})),function(e){e[e.Line=1]="Line",e[e.Column=2]="Column",e[e.WinLoss=3]="WinLoss"}(kr||(kr={})),function(e){e[e.pro=0]="pro",e[e.light=1]="light",e[e.soft=2]="soft",e[e.brand=3]="brand",e[e.fresh=4]="fresh"}(Ir||(Ir={})),function(e){e[e.auto=1]="auto",e[e.group=2]="group",e[e.custom=3]="custom"}(xr||(xr={})),function(e){e[e.none=0]="none",e[e.relative=1]="relative",e[e.absolute=2]="absolute"}(Nr||(Nr={})),function(e){e[e.Zero=1]="Zero",e[e.Space=2]="Space",e[e.Link=3]="Link"}(Pr||(Pr={})),function(e){e[e.Network=0]="Network"}(Lr||(Lr={}));var Fr,Br,Vr=[].concat(["IMPORTHTML","IMPORTXML","IMPORTDATA","IMPORTFEED"],["IMAGE"]),Hr=["RAND","RANDARRAY","RANDBETWEEN","NOW"];!function(e){e[e.Unknown=0]="Unknown",e[e.Pending=1]="Pending",e[e.Running=2]="Running",e[e.Success=3]="Success",e[e.CrawlFail=4]="CrawlFail",e[e.Invaild=5]="Invaild",e[e.DataSizeOverLimit=6]="DataSizeOverLimit",e[e.DomainInBlackList=7]="DomainInBlackList",e[e.RobotsDeny=8]="RobotsDeny",e[e.UploadPermDeny=9]="UploadPermDeny",e[e.NetworkAuthorizedDeny=10]="NetworkAuthorizedDeny"}(Fr||(Fr={})),function(e){e.IMAGE="IMAGE",e.IMPORTXML="IMPORTXML",e.IMPORTHTML="IMPORTHTML",e.IMPORTDATA="IMPORTDATA",e.IMPORTFEED="IMPORTFEED"}(Br||(Br={}));var Ur,Zr=function(e){function t(e){var n;return(0,c.Z)(this,t),(n=(0,h.Z)(this,(0,d.Z)(t).call(this,"ImportFormula error code: ".concat(e)))).code=e,Object.setPrototypeOf((0,f.Z)(n),t.prototype),n}return(0,p.Z)(t,e),t}((0,v.Z)(Error)),Wr=(Y={},(0,g.Z)(Y,Cn.IMPORT_ERR_UNKNOWN,new Zr(Cn.IMPORT_ERR_UNKNOWN)),(0,g.Z)(Y,Cn.IMPORT_ERR_PEDDING,new Zr(Cn.IMPORT_ERR_PEDDING)),(0,g.Z)(Y,Cn.IMPORT_ERR_CRAW_RUNNING,new Zr(Cn.IMPORT_ERR_CRAW_RUNNING)),(0,g.Z)(Y,Cn.IMPORT_ERR_CRAW_FAIL,new Zr(Cn.IMPORT_ERR_CRAW_FAIL)),(0,g.Z)(Y,Cn.IMPORT_ERR_CRAWL_WAITING,new Zr(Cn.IMPORT_ERR_CRAWL_WAITING)),(0,g.Z)(Y,Cn.IMPORT_ERR_INVAILD_PARAM,new Zr(Cn.IMPORT_ERR_INVAILD_PARAM)),(0,g.Z)(Y,Cn.IMPORT_ERR_DATA_SIZE_OVER_LIMIT,new Zr(Cn.IMPORT_ERR_DATA_SIZE_OVER_LIMIT)),(0,g.Z)(Y,Cn.IMPORT_ERR_DOMAIN_IN_BLACK_LIST,new Zr(Cn.IMPORT_ERR_DOMAIN_IN_BLACK_LIST)),(0,g.Z)(Y,Cn.IMPORT_ERR_ROBOTS_DENY,new Zr(Cn.IMPORT_ERR_ROBOTS_DENY)),(0,g.Z)(Y,Cn.IMPORT_ERR_NO_PREM_UPLOAD,new Zr(Cn.IMPORT_ERR_NO_PREM_UPLOAD)),(0,g.Z)(Y,Cn.IMPORT_ERR_NO_AUTHORIZED,new Zr(Cn.IMPORT_ERR_NO_AUTHORIZED)),(0,g.Z)(Y,Cn.REQUEST_FAIL,new Zr(Cn.REQUEST_FAIL)),(0,g.Z)(Y,Cn.NO_QUERY_OUTPUT,new Zr(Cn.NO_QUERY_OUTPUT)),Y);function jr(e){switch(e){case 0:return Wr[Cn.IMPORT_ERR_UNKNOWN];case 1:return Wr[Cn.IMPORT_ERR_PEDDING];case 2:return Wr[Cn.IMPORT_ERR_CRAW_RUNNING];case 4:return Wr[Cn.IMPORT_ERR_CRAW_FAIL];case 5:return Wr[Cn.IMPORT_ERR_INVAILD_PARAM];case 8:return Wr[Cn.IMPORT_ERR_ROBOTS_DENY];case 7:return Wr[Cn.IMPORT_ERR_DOMAIN_IN_BLACK_LIST];case 6:return Wr[Cn.IMPORT_ERR_DATA_SIZE_OVER_LIMIT];case 9:return Wr[Cn.IMPORT_ERR_NO_PREM_UPLOAD];case 10:return Wr[Cn.IMPORT_ERR_NO_AUTHORIZED]}return null}function Gr(e,t,n){return new Z.ErrorVar(Z.ErrorType.RUNTIME_ERROR,Z.ErrorConstant.RUNTIME_ERROR,e,{message:t,args:n})}function zr(e){return lt.from(e,"binary").toString("base64")}function Yr(e){return lt.from(e,"base64").toString("binary")}function Xr(e){return!(!e||void 0===e.height||void 0===e.width||!e.fileToken&&!e.link)}!function(e){e[e.SheetTabType_UNSPECIFIED=0]="SheetTabType_UNSPECIFIED",e[e.SheetTabType_CONNECTOR=1]="SheetTabType_CONNECTOR"}(Ur||(Ur={}));var Kr,qr=j().mac;!function(e){e[e.BackSpace=8]="BackSpace",e[e.Tab=9]="Tab",e[e.Clear=12]="Clear",e[e.Enter=13]="Enter",e[e.Shift=16]="Shift",e[e.Ctrl=17]="Ctrl",e[e.Alt=18]="Alt",e[e.Caps=20]="Caps",e[e.Esc=27]="Esc",e[e.Space=32]="Space",e[e.PageUp=33]="PageUp",e[e.PageDown=34]="PageDown",e[e.End=35]="End",e[e.Home=36]="Home",e[e.Left=37]="Left",e[e.Up=38]="Up",e[e.Right=39]="Right",e[e.Down=40]="Down",e[e.Delete=46]="Delete",e[e.Digit0=48]="Digit0",e[e.Digit1=49]="Digit1",e[e.Digit2=50]="Digit2",e[e.Digit3=51]="Digit3",e[e.Digit4=52]="Digit4",e[e.Digit5=53]="Digit5",e[e.Digit6=54]="Digit6",e[e.Digit9=57]="Digit9",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.Meta=91]="Meta",e[e.RightMeta=92]="RightMeta",e[e.Caret=94]="Caret",e[e.Numpad0=96]="Numpad0",e[e.Numpad9=105]="Numpad9",e[e.Asterisk=106]="Asterisk",e[e.NumpadDot=110]="NumpadDot",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F11=122]="F11",e[e.Semicolon=186]="Semicolon",e[e.Equal=187]="Equal",e[e.Plus=187]="Plus",e[e.Comma=188]="Comma",e[e.Minus=189]="Minus",e[e.Dot=190]="Dot",e[e.Grave=192]="Grave",e[e.Bracket=219]="Bracket",e[e.Quot=222]="Quot",e[e.Slash=111]="Slash",e[e["/"]=191]="/",e[e.Backquote=192]="Backquote",e[e["\\"]=220]="\\",e[e.BracketRight=221]="BracketRight",e[e.Ime=229]="Ime",e[e.FirefoxMinus=173]="FirefoxMinus",e[e.FirefoxEquals=61]="FirefoxEquals"}(Kr||(Kr={}));var $r=[Kr.Up,Kr.Down,Kr.Left,Kr.Right];Kr.C,Kr.V,Kr.X;function Jr(e){return Qr(e)&&e.keyCode===Kr.C}function Qr(e){return qr?e.metaKey&&!e.altKey:e.ctrlKey&&!e.altKey}function ei(e){return Qr(e)&&e.keyCode===Kr.X}function ti(e){var t=e.keyCode,n=e.altKey,r=e.ctrlKey,i=e.shiftKey,o=e.metaKey;return!(n||r||i||o||t!==Kr.BackSpace&&t!==Kr.Delete)}function ni(e){return Qr(e)&&e.keyCode===Kr.Z}function ri(e){var t=ni(e)&&!!e.shiftKey,n=Qr(e)&&e.keyCode===Kr.Y;return t||n}function ii(e){return e.keyCode===Kr.Esc}function oi(e){return e.keyCode===Kr.A&&Qr(e)}function ai(e){return"Enter"===e.key||e.keyCode===Kr.Enter}function si(e){return"k"===e.key||"K"===e.key||e.keyCode===Kr.K}function ui(e){return"f"===e.key||"F"===e.key||e.keyCode===Kr.F}function li(e){return"h"===e.key||"H"===e.key||e.keyCode===Kr.H}var ci,hi,di,fi,pi,vi=function(){},gi=function(){},_i=function(e){},yi={teaLog:gi,teaLogNew:gi,ravenCatch:gi,suspend:gi,resume:gi},mi={show:_i,info:_i,success:_i,error:_i,remove:_i,removeAll:_i,warning:_i,destroy:_i},Ei={confirm:function(){return{update:vi,destroy:vi}}},bi=function(){return""},Ti={askUserShouldDelEmptyCellsAndContinuePaste:(ci=(0,l.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(console.error("No askUserShouldDelEmptyCellsAndContinuePaste Instance"),!1));case 1:case"end":return e.stop()}}),e)}))),function(){return ci.apply(this,arguments)}),showCopyDataOutdatedModal:function(){console.error("No showCopyDataOutdatedModal Instance")},showPastePageOutdatedModal:function(){console.error("No showPastePageOutdatedModal Instance")},showSpansPromptModalWhileSort:function(){console.error("No showPastePageOutdatedModal Instance")},showCoverSheetContentConfirmModel:function(){return console.error("No mockShowCoverSheetContentConfirmModel Instance"),{closeFn:function(){return{}},promise:new Promise((function(){return!1}))}},showError:function(){console.error("No mockShowError Instance")}},Ci=function(){},Si=function(){},wi=function(){},Ri=function(){console.error("No TransformPerformanceData Instance")},Ai=function(){return""},Oi=function(){return console.error("No PrependSpace Instance"),""},Mi=function(){return console.error("No CanCopy Instance"),!1},ki=function(e){return e},Ii=function(){return console.error("No GetSegmentArray Instance"),{}},xi=function(){return console.error("No GetSuiteUrlConfig Instance"),{color:"",icons:{},noPermissionIcons:{}}},Ni=function(){console.error("No GenerateEditorValue Instance")},Pi=function(){console.error("No GenerateEditorValue Instance")},Li={setIsSsd:function(){console.log("No CollectLoadPerformance Instance")},setLoadStartTime:function(){console.log("No CollectLoadPerformance Instance")},getLoadStartTime:function(){console.log("No CollectLoadPerformance Instance")},setBlockCount:function(e){console.log("No CollectLoadPerformance Instance")},collectData:function(e,t){console.log("No CollectLoadPerformance Instance")}},Di={updateStage:function(){console.error("No PerformanceStageCollector Instance")},renderFail:function(){console.error("No PerformanceStageCollector Instance")}},Fi=function(){return console.error("no getCellLimit instance"),0},Bi=function(){var e=(0,l.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(console.info("no batchFetchDocsTitles instance"),0));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Vi=function(){return!1},Hi=function(){return console.error("no mockGetUrlToken instance"),!1},Ui={getBlobImageUrl:function(e){return new Promise((function(t){return t(e)}))},showCollaborators:function(){return!0}},Zi=function(e){return!0},Wi={logShortcutExecuteError:function(){console.error("no mockShortcutPluginDep instance")},logShortcutExecuted:function(){console.error("no mockShortcutPluginDep instance")}},ji=function(){return console.info("no mockGetSheetImportRangeCountLimit instance"),100},Gi={importRange:{requestImportRangeMetas:function(){return Promise.resolve({})},requestSubBlock:function(){return Promise.resolve({})},requestHeartBeat:function(){return Promise.resolve({})},requestAddImportRange:function(){return Promise.resolve({})}},protectionRange:{},aiRequest:{}},zi={isVCFollower:function(){return console.error("no mockVCHelpers instance"),!1},isVCPresenter:function(){return console.error("no mockVCHelpers instance"),!1}},Yi=function(e){return window.open(e),!0},Xi=function(){return console.info("no mockGetSheetImportRangeHostWhitelist instance"),[]},Ki=function(){return"en"},qi={name:"Safari",safari:!0,blink:!0,linux:!0,osname:"Linux",x:!0,isFeishu:!1,isLark:!1,isLarkPcTab:!1,isLarkWindow:!1,isLKP:!1,isDocs:!1,isDocsSDK:!1,isFeed:!1,isOpenDoc:!1,isIPhoneX:!1,isIPad:!1,isMobile:void 0,isMac:void 0,isWindows:!1,isSafari:!0,isIE:void 0,isIECompatibleMode:!1,isSougou:!1,isIOS:!1,isAndroid:!1,isQQ:!1,isWechat:!1,isWeibo:!1,isToutiao:!1,isX5:!1,is360:!1,is360Fast:!1,isUc:!1,isBaiDu:!1,isLB:!1,oldIE:!1,modernIE:!1,kernel:"blink",isLarkTab:!1,isOldLarkTab:!1,isEdge:!1,isFF:!1,isChrome:!1,isWebKit:!0,isBytedanceApp:!1,isIPhoneSeries:function(){return!1},isPrimaryChrome:!1,isOpera:!1,is2345:!1,isMaxthon:!1,isTheWorld:!1,isLarkPhone:!1,isInVC:!1,isFeishuRooms:!1,isFeishuRoomsServer:!1,isOpendoc:!1,isWxMp:!1,isDocApp:!1,isH5:void 0,isPcWeb:!0,isVulcan:!1,isLarkWebPage:!1},$i={movePivotTable:function(){return!1},getFilterSort:function(){},getCollapse:function(){},renderPivotTableWithPosition:function(){return!0}},Ji={toAILabTypeData:function(){return console.error("no toAILabTypeData instance")},toLineTexts:function(){return console.error("no toLineTexts instance")},translate:function(){return console.error("no translate instance")},getDocxTranslationLLMEnabled:function(){return console.error("no getDocxTranslationLLMEnabled instance")},getSheetTranslateTextCount:function(){return console.error("no getSheetTranslateTextCount instance")},blurOnSheetTranslate:function(){return console.error("no blurOnSheetTranslate instance")}};!function(e){e[e.USER=0]="USER",e[e.GROUP=2]="GROUP",e[e.OTHER=107]="OTHER"}(hi||(hi={})),function(e){e[e.EDITABLE=4]="EDITABLE",e[e.VISIBLE=1]="VISIBLE",e[e.INVISIBLE=0]="INVISIBLE"}(di||(di={})),function(e){e[e.user=0]="user",e[e.group=2]="group",e[e.department=18]="department",e[e.other=107]="other"}(fi||(fi={})),function(e){e.edit="edit",e.view="view"}(pi||(pi={}));var Qi,eo,to,no="__REFRESH",ro=function(){function e(){(0,c.Z)(this,e),this._chartDataTransformerHelper=null,this._cpuPerformance={timeCost:0,estimatedSpeed:0},this._sheetCfMaxCount=80}return(0,a.Z)(e,[{key:"setCpuPerformance",value:function(e){return!!e&&(this._cpuPerformance=e,!0)}},{key:"getCpuPerformance",value:function(){return this._cpuPerformance}},{key:"eventHelper",get:function(){return this._eventHelper?this._eventHelper:{preventMouseDown:!1}},set:function(e){this._eventHelper=e}},{key:"moirae",get:function(){return this._moirae?this._moirae:yi},set:function(e){this._moirae=e}},{key:"collectSuiteEvent",get:function(){return this._collectSuiteEvent?this._collectSuiteEvent:Ci},set:function(e){this._collectSuiteEvent=e}},{key:"collectEvent",get:function(){return this._collectEvent||Si},set:function(e){this._collectEvent=e}},{key:"transformPerformanceData",get:function(){return this._transformPerformanceData?this._transformPerformanceData:Ri},set:function(e){this._transformPerformanceData=e}},{key:"encryptTea",get:function(){return this._encryptTea?this._encryptTea:Ai},set:function(e){this._encryptTea=e}},{key:"prependSpace",get:function(){return this._prependSpace?this._prependSpace:Oi},set:function(e){this._prependSpace=e}},{key:"canCopy",get:function(){return this._canCopy?this._canCopy:Mi},set:function(e){this._canCopy=e}},{key:"syncbufferEnable",get:function(){return!!this._syncbufferEnable&&this._syncbufferEnable},set:function(e){this._syncbufferEnable=e}},{key:"replaceImageDataSrc",get:function(){return this._replaceImageDataSrc?this._replaceImageDataSrc:ki},set:function(e){this._replaceImageDataSrc=e}},{key:"getSegmentArrayAndFileTokenSuiteMap",get:function(){return this._getSegmentArrayAndFileTokenSuiteMap?this._getSegmentArrayAndFileTokenSuiteMap:Ii},set:function(e){this._getSegmentArrayAndFileTokenSuiteMap=e}},{key:"getSuiteUrlConfig",get:function(){return this._getSuiteUrlConfig?this._getSuiteUrlConfig:xi},set:function(e){this._getSuiteUrlConfig=e}},{key:"generateEditorValue",get:function(){return this._generateEditorValue?this._generateEditorValue:Ni},set:function(e){this._generateEditorValue=e}},{key:"replaceEditorValue",get:function(){return this._replaceEditorValue?this._replaceEditorValue:Pi},set:function(e){this._replaceEditorValue=e}},{key:"Toast",get:function(){return this._Toast?this._Toast:mi},set:function(e){this._Toast=e}},{key:"Dialog",get:function(){return this._Dialog||Ei},set:function(e){this._Dialog=e}},{key:"modalHelper",get:function(){return this._modalHelper?this._modalHelper:Ti},set:function(e){this._modalHelper=e}},{key:"serverApi",get:function(){var e;return null!==(e=this._serverApi)&&void 0!==e?e:Gi},set:function(e){this._serverApi=e}},{key:"imageHelper",get:function(){return this._imageHelper?this._imageHelper:{getDriveImageUrl:function(){return console.error("No imageHelper Instance"),""},getDriveOriginalImageUrl:function(){return console.error("No imageHelper Instance"),""},getDriveImageToken:function(){return console.error("No imageHelper Instance"),""},decodeInfo:function(){console.error("No imageHelper Instance")},encodeInfo:function(){return console.error("No imageHelper Instance"),""},copyDriveImages:function(){return new Promise((function(e){console.error("No imageHelper Instance"),e([])}))},collectImageError:function(){console.error("No collectImageError Instance")},copyDriveTokenForSheet:function(){return new Promise((function(e){console.error("No imageHelper Instance"),e({})}))},copyDriveImagesForRef:function(){return new Promise((function(e){console.error("No imageHelper Instance"),e(null)}))}}},set:function(e){this._imageHelper=e}},{key:"mpLinkHelper",get:function(){return this._mpLinkHelper},set:function(e){this._mpLinkHelper=e}},{key:"chartDataTransformerHelper",get:function(){return this._chartDataTransformerHelper||null},set:function(e){this._chartDataTransformerHelper=e}},{key:"freezeSheetToggle",get:function(){return this._freezeSheetToggle},set:function(e){this._freezeSheetToggle=e}},{key:"getMentionIconSource",get:function(){return this._getMentionIconSource||bi},set:function(e){this._getMentionIconSource=e}},{key:"getSheetFontDataCleanEnable",get:function(){return this._getSheetFontDataCleanEnable},set:function(e){this._getSheetFontDataCleanEnable=e}},{key:"getSheetFilterDateAggregationEnabled",set:function(e){this._getSheetFilterDateAggregationEnabled=e},get:function(){return this._getSheetFilterDateAggregationEnabled||function(){return!1}}},{key:"getSheetDefaultFontFamily",get:function(){return this._getSheetDefaultFontFamily},set:function(e){this._getSheetDefaultFontFamily=e}},{key:"generateMentionId",get:function(){return this._generateMentionId},set:function(e){this._generateMentionId=e}},{key:"collectLoadPerformance",get:function(){return this._collectLoadPerformance?this._collectLoadPerformance:Li},set:function(e){this._collectLoadPerformance=e}},{key:"performanceStageCollector",get:function(){return this._performanceStageCollector||Di},set:function(e){this._performanceStageCollector=e}},{key:"sheetRenderStage",get:function(){return this._sheetRenderStage||{}},set:function(e){this._sheetRenderStage=e}},{key:"sheetLoadMainStageDurationListKey",get:function(){return this._sheetLoadMainStageDurationListKey||{}},set:function(e){this._sheetLoadMainStageDurationListKey=e}},{key:"permission",get:function(){return this._permission||{}},set:function(e){this._permission=e}},{key:"getLanguage",get:function(){return this._getLanguage||Ki},set:function(e){this._getLanguage=e}},{key:"getSheetCellLimitNum",get:function(){return this._getSheetCellLimitNum?this._getSheetCellLimitNum:Fi},set:function(e){this._getSheetCellLimitNum=e}},{key:"batchFetchDocsTitles",get:function(){return this._batchFetchDocsTitles?this._batchFetchDocsTitles:Bi},set:function(e){this._batchFetchDocsTitles=e}},{key:"openSafeLink",get:function(){return this._openSafeLink?this._openSafeLink:Yi},set:function(e){this._openSafeLink=e}},{key:"browser",set:function(e){this._browser=e},get:function(){return this._browser||qi}},{key:"getIsDocx",set:function(e){this._getIsDocx=e},get:function(){return this._getIsDocx?this._getIsDocx:function(){return!1}}},{key:"getSheetPivotServiceCalcEnable",get:function(){return this._getSheetPivotServiceCalcEnable||Vi},set:function(e){this._getSheetPivotServiceCalcEnable=e}},{key:"getImageRectByEqualEnable",set:function(e){this._getImageRectByEqualEnable=e},get:function(){return this._getImageRectByEqualEnable||function(){return!0}}},{key:"ccmEventTracking",set:function(e){this._ccmEventTracking=e},get:function(){return this._ccmEventTracking?this._ccmEventTracking:wi}},{key:"collectSheetEvent",set:function(e){this._collectSheetEvent=e},get:function(){return this._collectSheetEvent?this._collectSheetEvent:wi}},{key:"getUrlToken",get:function(){return this._getUrlToken||Hi},set:function(e){this._getUrlToken=e}},{key:"getClientVarsDefaultRows",get:function(){return this._getClientVarsDefaultRows?this._getClientVarsDefaultRows:function(){return 50}},set:function(e){this._getClientVarsDefaultRows=e}},{key:"getClientVarsDefaultCols",get:function(){return this._getClientVarsDefaultCols?this._getClientVarsDefaultCols:function(){return 7}},set:function(e){this._getClientVarsDefaultCols=e}},{key:"opendoc",get:function(){return this._opendoc||Ui},set:function(e){this._opendoc=e}},{key:"shouldTipRender",get:function(){return this._shouldTipRender||Zi},set:function(e){this._shouldTipRender=e}},{key:"sheetCfMaxCount",get:function(){return this._sheetCfMaxCount},set:function(e){this._sheetCfMaxCount=e}},{key:"shortcutPluginDep",set:function(e){this._shortcutPluginDep=e},get:function(){return this._shortcutPluginDep||Wi}},{key:"getSheetImportRangeCountLimit",set:function(e){this._getSheetImportRangeCountLimit=e},get:function(){return this._getSheetImportRangeCountLimit||ji}},{key:"getSheetCfCopyEnabled",set:function(e){this._getSheetCfCopyEnabled=e},get:function(){return this._getSheetCfCopyEnabled||function(){return!1}}},{key:"vcHelpers",set:function(e){this._vcHelpers=e},get:function(){return this._vcHelpers||zi}},{key:"getSheetImportRangeHostWhitelist",set:function(e){this._getSheetImportRangeHostWhitelist=e},get:function(){return this._getSheetImportRangeHostWhitelist||Xi}},{key:"getIsSheetCustomIconEnabled",get:function(){return this._getIsSheetCustomIconEnabled||function(){return!1}},set:function(e){this._getIsSheetCustomIconEnabled=e}},{key:"isSheetWorkerEnabled",get:function(){return this._isSheetWorkerEnabled||function(){return!1}},set:function(e){this._isSheetWorkerEnabled=e}},{key:"shouldRuntimeAllowPrint",get:function(){return this._shouldRuntimeAllowPrint||function(){return!1}},set:function(e){this._shouldRuntimeAllowPrint=e}},{key:"baseURL",set:function(e){this._baseURL=e},get:function(){return this._baseURL}},{key:"apiURLs",set:function(e){this._apiURLs=e},get:function(){return this._apiURLs}},{key:"SheetCalcI18nMap",set:function(e){this._SheetCalcI18nMap=e},get:function(){return this._SheetCalcI18nMap||{}}},{key:"SheetClipboardDataType",get:function(){return this._SheetClipboardDataType},set:function(e){this._SheetClipboardDataType=e}},{key:"clipboardManager",get:function(){return this._clipboardManager},set:function(e){this._clipboardManager=e}},{key:"getNoPermissionPlaceHolderImgUrl",get:function(){return this._getNoPermissionPlaceHolderImgUrl||function(){return""}},set:function(e){this._getNoPermissionPlaceHolderImgUrl=e}},{key:"getHelpCenterUrl",get:function(){return this._getHelpCenterUrl||function(){return""}},set:function(e){this._getHelpCenterUrl=e}},{key:"showAiInline",get:function(){return this._showAiInline},set:function(e){this._showAiInline=e}},{key:"showExportPreview",get:function(){return this._showExportPreview},set:function(e){this._showExportPreview=e}},{key:"getAddNoteEnabled",get:function(){return this._getAddNoteEnabled||function(){return!1}},set:function(e){this._getAddNoteEnabled=e}},{key:"getAddDiagonalEnabled",get:function(){return this._getAddDiagonalEnabled||function(){return!1}},set:function(e){this._getAddDiagonalEnabled=e}},{key:"getSheetInvisibleProtectionPortEnabled",get:function(){return this._getSheetInvisibleProtection||function(){return!1}},set:function(e){this._getSheetInvisibleProtection=e}},{key:"getMentionOptimizeEnabled",get:function(){return this._getMentionOptimizeEnabled||function(){return!1}},set:function(e){this._getMentionOptimizeEnabled=e}},{key:"getImportFormulaEnable",get:function(){return this._getImportFormulaEnable||function(){return!1}},set:function(e){this._getImportFormulaEnable=e}},{key:"getImportRangeV3Enable",get:function(){return this._getImportRangeV3Enable||function(){return!1}},set:function(e){this._getImportRangeV3Enable=e}},{key:"getImportRangeV2Enable",get:function(){return this._getImportRangeV2Enable||function(){return!1}},set:function(e){this._getImportRangeV2Enable=e}},{key:"pivotTableHelper",get:function(){var e;return null!==(e=this._pivotTableHelper)&&void 0!==e?e:$i},set:function(e){this._pivotTableHelper=Object.assign({},$i,{},e)}},{key:"shortcutLog",get:function(){return this._shortcutLog||function(){return!1}},set:function(e){this._shortcutLog=e}},{key:"getAiProgressBarEnabled",get:function(){return this._getAiProgressBarEnabled||function(){return!1}},set:function(e){this._getAiProgressBarEnabled=e}},{key:"reportSheetRenderStageDuration",get:function(){return this._reportSheetRenderStageDuration||function(){return!1}},set:function(e){this._reportSheetRenderStageDuration=e}},{key:"translateHelper",get:function(){return this._translateHelper},set:function(e){this._translateHelper=Object.assign({},Ji,{},e)}}]),e}(),io=new ro,oo=(0,H.Z)((function(){var e;return e=io.getSheetDefaultFontFamily?io.getSheetDefaultFontFamily():"MonospacedNumber, ".concat('LarkHackSafariFont, LarkEmojiFont, LarkChineseQuote,-apple-system, BlinkMacSystemFont, "Helvetica Neue", Tahoma, "PingFang SC", "Microsoft Yahei", Arial, "Hiragino Sans GB", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"'),(0,Ke.isShortCut)()&&(e="".concat(e,', "Noto Naskh Arabic UI"')),e.replace(/\"/g,"").replace(/, /g,",")}));!function(e){e[e.BTN_SIZE=34]="BTN_SIZE"}(Qi||(Qi={})),function(e){e.ABORT="ABORT",e.COMPLETE="COMPLETE",e.TRANSFER="TRANSFER"}(eo||(eo={})),function(e){e.MOVE="MOVE",e.CLONE="CLONE",e.COPY="COPY",e.SHARE="SHARE",e.RENAME="RENAME",e.CREATE_FOLDER="CREATE_FOLDER",e.CREATE_SHARE_FOLDER="CREATE_SHARE_FOLDER",e.EDIT_SHARE_FOLDER_INFO="EDIT_SHARE_FOLDER_INFO",e.DELETE_OR_REMOVE="DELETE_OR_REMOVE",e.MOVE_TO_PERSONAL_FOLDER="MOVE_TO_PERSONAL_FOLDER",e.MOVE_TO_SHARE_FOLDER="MOVE_TO_SHARE_FOLDER",e.DELETE="DELETE"}(to||(to={}));Object.values(to);var ao,so={TOGGLE_PIN:"TOGGLE_PIN",TOGGLE_STAR:"TOGGLE_STAR"},uo=(Object.values(so),Object.assign({NEWTABOPEN:"NEWTABOPEN",OPEN_NEW_TAB:"OPEN_NEW_TAB",COPY:"COPY",SHARE:"SHARE",MOVE:"MOVE",DELETE_OR_REMOVE:"DELETE_OR_REMOVE",RESTORE:"RESTORE",DELETE:"DELETE",REMOVE:"REMOVE"},so));Object.assign({},uo,{},{CLONE:"CLONE",PRINT:"PRINT",EXPORT:"EXPORT",EXPORT_CSV:"EXPORT_CSV",HISTORY:"HISTORY",COMMENT_HISTORY:"COMMENT_HISTORY",ABOUT_US:"ABOUT_US"},{},{RENAME:"RENAME"},{},{CREATE:"CREATE",IMPORT:"IMPORT"});!function(e){e.EXPLORER_GLOBAL_CONTEXT="EXPLORER_GLOBAL_CONTEXT",e.EXPLORER_FILE_DROPDOWN="EXPLORER_FILE_DROPDOWN",e.EXPLORER_FILE_CONTEXT="EXPLORER_FILE_CONTEXT",e.EXPLORER_CREATE_DROPDOWN="EXPLORER_CREATE_DROPDOWN",e.NAVIGATION_BAR_DROPDOWN="NAVIGATION_BAR_DROPDOWN",e.MULTI_SELECT_OPERATION_PANEL="MULTI_SELECT_OPERATION_PANEL"}(ao||(ao={}));var lo;!function(e){e.FILELIST_ITEM_STAR="FILELIST_ITEM_STAR",e.SUITE_HEADER_TITLE_STAR="SUITE_HEADER_TITLE_STAR",e.SUITE_HEADER_MENU="SUITE_HEADER_MENU"}(lo||(lo={}));var co,ho=qe.hH,fo="#3370ff",po=qe.YC,vo={radius:10,minWidth:20,minHeight:20,padding:[1,6],margin:[3,2,3,2]},go="embed-image-uploading";!function(e){e.Bold="bold",e.Italic="italic",e.Underline="underline",e.Strikethrough="strikethrough",e.TextColor="textcolor",e.FontSize="fontsize",e.FontFamily="fontfamily",e.HyperlinkCellPosition="hyperlink_cellPosition",e.FormulaColor="formulacolor",e.FormulaHighlight="formulahighlight"}(co||(co={}));var _o,yo,mo,Eo,bo,To,Co=["bold","italic","underline","strikethrough","textcolor","fontsize","fontfamily"];!function(e){e.SheetAdded="SheetAdded",e.SheetRemoved="SheetRemoved",e.SheetSoftDeleted="SheetSoftDeleted",e.SheetMoved="SheetMoved",e.ActiveSheetChanged="ActiveSheetChanged",e.BeforeActiveSheetChange="BeforeActiveSheetChange",e.CoverSnapshot="CoverSnapshot",e.LoadSheet="LoadSheet",e.SpreadError="SpreadError",e.CommandExecuting="CommandExecuting",e.CommandExecuted="CommandExecuted",e.PivotTableRerender="PivotTableRerender",e.ConditionalFormulaChanged="ConditionalFormulaChanged",e.LimitDocx="LimitDocx",e.PrintPreview="PrintPreview",e.FormulaCacheApplied="FormulaCacheApplied",e.BeforeSheetTabClick="BeforeSheetTabClick",e.PivotDataSourceChanged="PivotDataSourceChanged",e.PivotServiceCalcStatusChanged="PivotServiceCalcStatusChanged",e.PermissionReady="PermissionReady"}(_o||(_o={})),function(e){e.SheetInit="SheetInit",e.SheetHidden="SheetHidden",e.SheetVisible="SheetVisible",e.SelectionChanged="SelectionChanged",e.ActiveCellChanged="ActiveCellChanged",e.MoveRange="MoveRange",e.RangeChanged="RangeChanged",e.PivotTableRangeChanged="PivotTableRangeChanged",e.DimensionPropertiesChanged="DimensionPropertiesChanged",e.RowAdded="RowAdded",e.RowDeleted="RowDeleted",e.RowVisibleChanged="RowVisible",e.RowSizeChanged="RowSizeChanged",e.AutoRowSizeChanged="AutoRowSizeChanged",e.ColumnVisibleChanged="ColumnVisibleChanged",e.ColumnSizeChanged="ColumnSizeChanged",e.ColumnAdded="ColumnAdded",e.ColumnDeleted="ColumnDeleted",e.SpanRemoved="SpanRemoved",e.SpanChanged="SpanChanged",e.CellRemoved="CellRemoved",e.Renamed="Renamed",e.StyleChanged="StyleChanged",e.FormatterChanged="FormatterChanged",e.CommentChanged="CommentChanged",e.NoteChanged="NoteChanged",e.PermissionChanged="PermissionChanged",e.InvisiblePermissionChanged="InvisiblePermissionChanged",e.ProtectedRangeChanged="ProtectedRangeChanged",e.FilterChanged="FilterChanged",e.ConditionalFormatChanged="ConditionalFormatChanged",e.ConditionalFormulaDirty="ConditionalFormulaDirty",e.DataValidationRefChanged="DataValidationRefChanged",e.DataValidationFormulaMarkDirty="DataValidationFormulaMarkDirty",e.FrozenChanged="FrozenChanged",e.GridLineChanged="GridLineChanged",e.ActiveFloatObjectChanged="ActiveFloatObjectChanged",e.TopRowChanged="TopRowChanged",e.LeftColumnChanged="LeftColumnChanged",e.EditorLinkHover="EditorLinkHover",e.EditorLinkLeave="EditorLinkLeave",e.OptionChanged="OptionChanged",e.CoverSheet="CoverSheet",e.Pasted="Pasted",e.SegmentArrayChanged="SegmentArrayChanged",e.ValueChanged="ValueChanged",e.InvalidOperation="InvalidOperation",e.Sort="Sort",e.ClearActiveComment="ClearActiveComment",e.AllEmbeddedBlockSet="AllEmbeddedBlockSet",e.SheetPivotCreated="SheetPivotCreated",e.SheetPivotBlockUpdated="SheetPivotBlockUpdated",e.SheetAllPivotTableLoaded="SheetAllPivotTableLoaded",e.SheetPivotDataSourceUpdating="SheetPivotDataSourceUpdating",e.SheetPivotDataSourceUpdated="SheetPivotDataSourceUpdated",e.SheetRenamed="SheetRenamed",e.InvalidateRowHeight="InvalidateRowHeight",e.PivotTableConfigChanged="PivotTableConfigChanged",e.ShowFillOptionsBtn="ShowFillOptionsBtn",e.BeforeEditorIdle="BeforeEditorIdle",e.AfterEndEdit="AfterEndEdit",e.OutlineStateChanged="OutlineStateChanged",e.SparklineAdd="SparklineAdd",e.SparklineDelete="SparklineDelete",e.SparklineDelRowCol="SparklineDelRowCol",e.SparklineSourceRangeChanged="SparklineSourceRangeChange",e.SparklineGroupConfigChanged="SparklineGroupConfigChanged",e.SparklineUpdateActionApply="SparklineUpdateActionApply",e.SparklineAddActionApply="SparklineAddActionApply",e.SparklineDeleteActionApply="SparklineDeleteActionApply",e.EmbeddedBlockChanged="EmbeddedBlockChanged",e.PivotFormulaCalculated="PivotFormulaCalculated",e.SheetDataRangeAdjusted="SheetDataRangeAdjusted",e.ShortcutRangeChanged="ShortcutRangeChanged",e.TranslateSheetRangeEnd="TranslateSheetRangeEnd"}(yo||(yo={})),function(e){e.HeaderScrollMouseUp="HeaderScrollMouseUp",e.MouseUp="MouseUp",e.CellClicked="CellClicked",e.CellHover="CellHover",e.CellPress="CellPress",e.SegClicked="SegClicked",e.SegHover="SegHover",e.CellDoubleClicked="CellDoubleClicked",e.TopPosChanged="TopPosChanged",e.LeftTopPosChanged="LeftTopPosChanged",e.LeftPosChanged="LeftPosChanged",e.PosChanged="PosChanged",e.ShowFloatMenu="ShowFloatMenu",e.HideFloatMenu="HideFloatMenu",e.OpenImgFullScreen="OpenImgFullScreen",e.OpenFloatImgFullScreen="OpenFloatImgFullScreen",e.FloatImageDragMove="FloatImageDragMove",e.FloatImageDragEnd="FloatImageDragEnd",e.TapFloatImage="TapFloatImage",e.DoubleTapFloatImage="DoubleTapFloatImage",e.FloatImageMultipleSelectStart="FloatImageMultipleSelect",e.FloatImageMultipleSelectEnd="FloatImageMultipleSelectEnd",e.ResizeRowCol="ResizeRowCol",e.SelectionExtendStateChanged="SelectionExtendStateChanged",e.ShowContextMenu="ShowContextMenu",e.HideCellContextMenu="HideCellContextMenu",e.ShowReminderTooltip="ShowReminderTooltip",e.HideReminderTooltip="HideReminderTooltip",e.FilterIconEnter="FilterIconEnter",e.FilterIconLeave="FilterIconLeave",e.EmbedSheetOffsetLeftChanged="EmbedSheetOffsetLeftChanged",e.EmbedSheetScrollRowTo="EmbedSheetScrollRowTo",e.ScrollDoc="ScrollDoc",e.CellClickInSelection="CellClickInSelection",e.CellClickOutSelection="CellClickOutSelection",e.HideHeaderBubble="HideHeaderBubble",e.Resize="Resize",e.NormalSelectionDragStart="NormalSelectionDragStart",e.ActiveSheetViewChange="ActiveSheetViewChange",e.ContentLeave="ContentLeave",e.CornerMouseDown="CornerMouseDown",e.CornerMouseMove="CornerMouseMove",e.CornerMouseUp="CornerMouseUp",e.CornerDbClick="CornerDbClick",e.MouseEnterTableView="MouseEnterTableView",e.RowOrColStartDrag="RowOrColStartDrag",e.RowOrColDragged="RowOrColDragged",e.HoverOutline="HoverOutline",e.ClickOutline="ClickOutline",e.ClickOutlineButton="ClickOutlineButton",e.HoverLevelButton="HoverLevelButton",e.ClickLevelButton="ClickLevelButton",e.ContextMenuOnGroupBar="ContextMenuOnGroupBar",e.ContextMenuOnOutline="ContextMenuOnOutline",e.ContextMenuGroupCorner="ContextMenuGroupCorner",e.ChangeToNormalCorner="ChangeToNormalCorner",e.ChangeToFillCorner="ChangeToFillCorner",e.MobileFillCornerDragStart="MobileFillCornerDragStart",e.MobileFillCornerDragMove="MobileFillCornerDragMove",e.MobileFillCornerDragEnd="MobileFillCornerDragEnd",e.MobileFillCornerDragCancel="MobileFillCornerDragCancel",e.MobileCornerDbTouch="MobileCornerDbTouch"}(mo||(mo={})),function(e){e.AnalyzeActionDeps="AnalyzeActionDeps",e.AfterApply="AfterApply",e.BeforeApply="BeforeApply"}(Eo||(Eo={})),function(e){e.SHEET_TAB_CHANGE="SHEET_TAB_CHANGE",e.ShowAttachmentDialog="ShowAttachmentDialog",e.PreviewAttachment="PreviewAttachment",e.ClosePreviewAttachment="ClosePreviewAttachment",e.FullscreenAttachment="FullscreenAttachment",e.CloseFullscreenAttachment="CloseFullscreenAttachment",e.ShowImageUploader="ShowImageUploader"}(bo||(bo={})),function(e){e[e.applyWithSheetDep=1]="applyWithSheetDep",e[e.applyWithToast=2]="applyWithToast",e[e.fetchClientVarsByRev=3]="fetchClientVarsByRev",e[e.isTemplateClientVarsValid=4]="isTemplateClientVarsValid",e[e.isTemplateClientVarsInvalid=5]="isTemplateClientVarsInvalid",e[e.hasNoTemplateClientVars=6]="hasNoTemplateClientVars",e[e.templateClientVarsTypeError=7]="templateClientVarsTypeError",e[e.templateClientVarsTokenError=8]="templateClientVarsTokenError",e[e.templateClientVarsExpired=9]="templateClientVarsExpired",e[e.templateClientVarsIsCopying=10]="templateClientVarsIsCopying",e[e.preloadSubBlockSuccessed=11]="preloadSubBlockSuccessed",e[e.ungzipChangeset=12]="ungzipChangeset",e[e.ungzipBlock=13]="ungzipBlock",e[e.ungzipFormulaCache=14]="ungzipFormulaCache",e[e.ungzipImportRangeData=15]="ungzipImportRangeData",e[e.ungzipSnapshot=20]="ungzipSnapshot",e[e.shellNotExisted=16]="shellNotExisted",e[e.shellTick=17]="shellTick",e[e.subBlockCountNeededForUse=18]="subBlockCountNeededForUse",e[e.operationLog=19]="operationLog",e[e.memberRefetch=21]="memberRefetch",e[e.history=22]="history",e[e.clearMemberId=23]="clearMemberId"}(To||(To={}));var So,wo,Ro,Ao,Oo,Mo,ko,Io,xo,No,Po,Lo,Do,Fo,Bo,Vo,Ho="nofml",Uo=42,Zo=-1;!function(e){e[e.corner=0]="corner",e[e.colHeader=1]="colHeader",e[e.rowHeader=2]="rowHeader",e[e.viewport=3]="viewport",e[e.groupCorner=4]="groupCorner",e[e.colGroupBar=5]="colGroupBar",e[e.rowGroupBar=6]="rowGroupBar"}(So||(So={})),function(e){e[e.execute=0]="execute",e[e.undo=1]="undo",e[e.redo=2]="redo"}(wo||(wo={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",e[e.General=3]="General"}(Ro||(Ro={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Bottom=2]="Bottom"}(Ao||(Ao={})),function(e){e[e.underline=1]="underline",e[e.lineThrough=2]="lineThrough",e[e.overline=4]="overline",e[e.none=0]="none"}(Oo||(Oo={})),function(e){e[e.Add=0]="Add",e[e.Set=1]="Set",e[e.Del=2]="Del"}(Mo||(Mo={})),function(e){e[e.Set=0]="Set",e[e.Del=1]="Del"}(ko||(ko={})),function(e){e[e.Add=0]="Add",e[e.Set=1]="Set",e[e.Del=2]="Del"}(Io||(Io={})),function(e){e[e.Add=0]="Add",e[e.Set=1]="Set",e[e.Del=2]="Del"}(xo||(xo={})),function(e){e[e.Add=0]="Add",e[e.Set=1]="Set",e[e.Del=2]="Del"}(No||(No={})),function(e){e[e.all=0]="all",e[e.values=1]="values",e[e.formatting=2]="formatting",e[e.formulas=3]="formulas",e[e.transpose=4]="transpose",e[e.validations=5]="validations",e[e.conditionFormat=6]="conditionFormat"}(Po||(Po={})),function(e){e[e.noHeaders=0]="noHeaders",e[e.rowHeaders=1]="rowHeaders",e[e.columnHeaders=2]="columnHeaders",e[e.allHeaders=3]="allHeaders"}(Lo||(Lo={})),function(e){e[e.value=1]="value",e[e.formula=2]="formula",e[e.comment=4]="comment",e[e.span=8]="span",e[e.style=16]="style",e[e.conditionalFormat=32]="conditionalFormat",e[e.rowColInfo=64]="rowColInfo",e[e.dataValidation=128]="dataValidation",e[e.sparkline=256]="sparkline",e[e.all=511]="all"}(Do||(Do={})),function(e){e[e.auto=1]="auto",e[e.active=2]="active",e[e.inactive=4]="inactive",e[e.disabled=0]="disabled"}(Fo||(Fo={})),function(e){e[e.setFormula=0]="setFormula",e[e.copyPaste=1]="copyPaste",e[e.dragFill=2]="dragFill",e[e.dragDrop=3]="dragDrop",e[e.changePartOfArrayFormula=4]="changePartOfArrayFormula",e[e.invalidSheetName=5]="invalidSheetName",e[e.cellLimitExceed=6]="cellLimitExceed",e[e.exportFile=7]="exportFile",e[e.editProtectedRange=8]="editProtectedRange",e[e.failToPasteModal=9]="failToPasteModal",e[e.coverPivot=10]="coverPivot",e[e.changeOutlineGroupOnProtectedRange=11]="changeOutlineGroupOnProtectedRange",e[e.editConnectorSheet=12]="editConnectorSheet"}(Bo||(Bo={})),function(e){e.EnterCell="EnterCell",e.LeaveCell="LeaveCell",e.RangeSorting="RangeSorting",e.ClipboardChanged="ClipboardChanged",e.NewSheetTab="NewSheetTab",e.ShowAllTabs="ShowAllTabs",e.CloseOtherPanel="CloseOtherPanel",e.GuideBarToggling="GuideBarToggling",e.HistoryPanelToggling="HistoryPanelToggling",e.CommentHotkeyPress="CommentHotkeyPress",e.OpenCommentPanel="OpenCommentPanel",e.ShowDropdown="ShowDropdown",e.ShowFilter="ShowFilter",e.CutSheet="CutSheet",e.OnRebuild="OnRebuild",e.FormulaTextBoxTextChanged="FormulaTextBoxTextChanged",e.FormulaTextBoxCaretChanged="FormulaTextBoxCaretChanged",e.FormatPainting="FormatPainting",e.ShowCellCommentBubble="ShowCellCommentBubble",e.HideCellCommentBubble="HideCellCommentBubble",e.LaunchCommentPanel="LaunchCommentPanel",e.AddComment="AddComment",e.PullSheetCommentSucc="PullSheetCommentSucc",e.UpdateActiveCommentId="UpdateActiveCommentId",e.RowDataApplied="RowDataApplied",e.SheetPageLoaded="SheetPageLoaded",e.SheetPageUnmount="SheetPageUnmount",e.HeaderMenuClick="HeaderMenuClick",e.FABLoaded="FABLoaded",e.SwitchBlockTab="SwitchBlockTab",e.EmbedSheetOffsetLeftChanged="EmbedSheetOffsetLeftChanged",e.onTableLoaded="onTableLoaded",e.onBatchUpdateBlockComment="onBatchUpdateBlockComment",e.onStartNewComment="onStartNewComment",e.onActivateBlockComment="onActivateBlockComment",e.BitableBlockRejectCommit="BitableBlockRejectCommit",e.ResizeRowOrCol="ResizeRowOrCol",e.FocusDropdownListEditor="FocusDropdownListEditor",e.ToolbarButtonStatusChange="ToolbarButtonStatusChange",e.MergeAndSplit="MergeAndSplit",e.ShowValidationTipWhenReject="ShowValidationTipWhenReject",e.ShowContextMenu="ShowContextMenu",e.ContextMenuVisibleChange="ContextMenuVisibleChange",e.conditionalFormatOverLimit="CONDITIONAL_FORMAT_OVER_LIMIT",e.ShowFilterSort="ShowFilterSort",e.CollapseClick="CollapseClick",e.RefreshPivotPanel="RefreshPivotPanel"}(Vo||(Vo={}));var Wo,jo,Go="PROPAGATION_TYPE";!function(e){e[e.dragDrop=0]="dragDrop",e[e.dragFill=1]="dragFill",e[e.clear=2]="clear",e[e.paste=3]="paste",e[e.sort=4]="sort",e[e.setArrayFormula=5]="setArrayFormula",e[e.evaluateFormula=6]="evaluateFormula"}(Wo||(Wo={})),function(e){e[e.Up=0]="Up",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.Down=3]="Down"}(jo||(jo={}));var zo,Yo,Xo,Ko,qo,$o="10pt",Jo=13,Qo=(0,H.Z)((function(){return oo().split(",").map((function(e){return e.trim()})).map((function(e){return-1!==e.indexOf(" ")?'"'+e+'"':e})).join(", ")})),ea=((0,H.Z)((function(){return"".concat($o,"/1.5 ").concat(Qo())})),"COMMAND"),ta=(0,H.Z)((function(e){return"".concat(ea,"_").concat(e)}));!function(e){e.CONTEXT_MENU="CONTEXT_MENU",e.FILE_MENU="FILE_MENU"}(zo||(zo={})),function(e){e.CSV="CSV",e.XLSX="XLSX"}(Yo||(Yo={})),function(e){e[e.USER=0]="USER",e[e.DOC=1]="DOC",e[e.FOLDER=2]="FOLDER",e[e.SHEET=3]="SHEET",e[e.SHEET_DOC=4]="SHEET_DOC",e[e.CHAT=5]="CHAT",e[e.BITABLE=8]="BITABLE",e[e.MINDNOTE=11]="MINDNOTE",e[e.FILE=12]="FILE",e[e.SLIDE=15]="SLIDE",e[e.WIKI=16]="WIKI",e[e.DOCX=22]="DOCX",e[e.SLIDES=30]="SLIDES",e[e.WHITE_BOARD=38]="WHITE_BOARD"}(Xo||(Xo={})),function(e){e[e.DOC=1]="DOC",e[e.SHEET=3]="SHEET",e[e.BITABLE=8]="BITABLE",e[e.MINDNOTE=11]="MINDNOTE",e[e.BOX=12]="BOX",e[e.SLIDE=15]="SLIDE",e[e.SLIDES=30]="SLIDES",e[e.WIKI=16]="WIKI",e[e.DOCX=22]="DOCX",e[e.WHITE_BOARD=38]="WHITE_BOARD"}(Ko||(Ko={})),function(e){e[e.DOC=2]="DOC",e[e.SHEET=3]="SHEET",e[e.BITABLE=8]="BITABLE",e[e.MINDNOTE=11]="MINDNOTE",e[e.BOX=12]="BOX",e[e.SLIDE=15]="SLIDE",e[e.WIKI=16]="WIKI",e[e.DOCX=22]="DOCX",e[e.SLIDES=30]="SLIDES",e[e.WHITE_BOARD=38]="WHITE_BOARD"}(qo||(qo={}));var na,ra,ia;X={},(0,g.Z)(X,Ko.DOC,2),(0,g.Z)(X,Ko.SHEET,3),(0,g.Z)(X,Ko.BITABLE,8),(0,g.Z)(X,Ko.MINDNOTE,11),(0,g.Z)(X,Ko.BOX,12),(0,g.Z)(X,Ko.SLIDE,15),(0,g.Z)(X,Ko.SLIDES,30),(0,g.Z)(X,Ko.WIKI,16),(0,g.Z)(X,Ko.WHITE_BOARD,38);!function(e){e.FULL_BORDER="fullborder",e.NO_BORDER="noborder",e.OUTER_BORDER="outerborder",e.INNER_BORDER="innerborder",e.LEFT_BORDER="leftborder",e.RIGHT_BORDER="rightborder",e.TOP_BORDER="topborder",e.BOTTOM_BORDER="bottomborder",e.DIAGONAL_UP="diagonalup",e.DIAGONAL_DOWN="diagonaldown"}(na||(na={})),function(e){e[e.RANGE=0]="RANGE",e[e.ROW=1]="ROW",e[e.COL=2]="COL",e[e.SHEET=3]="SHEET"}(ra||(ra={})),function(e){e[e.NORMAL=0]="NORMAL",e[e.LARK=1]="LARK",e[e.LARK_CHAT_GROUP=2]="LARK_CHAT_GROUP",e[e.PUBLIC=4]="PUBLIC",e[e.SHARE_FOLDER=5]="SHARE_FOLDER",e[e.All=6]="All"}(ia||(ia={}));var oa,aa,sa,ua,la,ca="sheet-protection-public-id";!function(e){e[e.Normal=1]="Normal",e[e.Hidden=3]="Hidden"}(oa||(oa={})),function(e){e[e.Normal=0]="Normal",e[e.Warning=1]="Warning"}(aa||(aa={})),function(e){e[e.Source=0]="Source",e[e.Group=1]="Group"}(sa||(sa={})),function(e){e.NOTICE_CLICK="NOTICE_CLICK",e.MENTION_CLICK="MENTION_CLICK",e.ACTIVE_COMMENT_CHANGED="ACTIVE_COMMENT_CHANGED",e.CHART_SET_DEFAULT_SELECTION="CHART_SET_DEFAULT_SELECTION",e.ADD_ROW="ADD_ROW",e.ADD_COL="ADD_COL",e.DEL_ROW="DEL_ROW",e.DEL_COL="DEL_COL",e.DATA_VALIDATION_TARGET_SELECTION="DATA_VALIDATION_TARGET_SELECTION",e.CUSTOM_SORT_MODAL="CUSTOM_SORT_MODAL",e.PROTECTION_RANGE_SELECT="PROTECTION_RANGE_SELECT"}(ua||(ua={})),function(e){e.SET_MENTION_ID="SET_MENTION_ID",e.NO_VERSION="NO_VERSION"}(la||(la={}));var ha,da,fa,pa=[9,10,11,12,14,18,24,30,36],va=pa.map((function(e){return Math.floor(96*e/72)+"px"}));!function(e){e[e.NORMAL=0]="NORMAL",e[e.LARK_CHAT=1]="LARK_CHAT",e[e.IMPORT=2]="IMPORT",e[e.GOOGLE_IMPORT=3]="GOOGLE_IMPORT",e[e.DRIVE_IMPORT=4]="DRIVE_IMPORT",e[e.LARK_IMPORT=5]="LARK_IMPORT",e[e.MEETING=6]="MEETING",e[e.BEAR_COPY=7]="BEAR_COPY",e[e.TEMPLATE=8]="TEMPLATE",e[e.GROUP_ANNOUNCEMENT=9]="GROUP_ANNOUNCEMENT",e[e.SHEET_OPEN_API=10]="SHEET_OPEN_API",e[e.README_DOC=11]="README_DOC",e[e.COPYLINK_CLONE=12]="COPYLINK_CLONE",e[e.COPYLINK_NEW=13]="COPYLINK_NEW",e[e.LARK_CREATEDOC=14]="LARK_CREATEDOC",e[e.LARK_CREATE_CALENDER=15]="LARK_CREATE_CALENDER",e[e.SCAN=16]="SCAN"}(ha||(ha={})),function(e){e.PASTING="pasting",e.PASTE_CANCELABLE="paste_cancelable",e.PASTE_PIVOT_TABLE="paste_pivot_table",e.CHART_LOADING="chart_loading",e.LOAD_SHEETS="load_sheets",e.FLOAT_IMAGE_PASTING="float_image_pasting"}(da||(da={})),function(e){e.ALONE_SHEET="AloneSheet",e.EMBED_SHEET="EmbedSheet",e.EXCEL="Excel",e.WORD="Word",e.GOOGLE_SHEET="GoogleSheet",e.SHIMO_SHEET="ShimoSheet",e.SHIMO_Doc="ShimoDoc",e.TIM_SHEET="TimSheet",e.TIM_DOC="TimDoc",e.OTHER="Other"}(fa||(fa={}));var ga,_a,ya="sheet";!function(e){e.REMOTE="sheets_history",e.LOCAL="local_record",e.DOC_MIXED="doc_mixed_history"}(ga||(ga={})),function(e){e[e.V1=1]="V1"}(_a||(_a={}));var ma,Ea="HEAD";!function(e){e.Formulabar="Formulabar",e.Cell="cell",e.DateButton="date_button"}(ma||(ma={}));var ba;!function(e){e.IMPORT_FORMULA="IMPORT_FORMULA"}(ba||(ba={}));var Ta="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function Ca(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,t="",n=0;n<e;n++){var r=Math.floor(Math.random()*Ta.length);t+=Ta[r]}return t}var Sa="https?|s?ftp|ftps|nfs|ssh",wa="\\b([/#?][\\-A-Z0-9@:%_+.~#?&/=;$,!\\*\\[\\]\\(\\){}^|<>]*[-A-Z0-9&@#/%=~\\(\\)_|]?)?",Ra=new RegExp("((((".concat(Sa,")://)?(").concat(/localhost(:[0-9]{2,5})?/.source,"))|(((").concat(Sa,")://)(").concat(/(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}(2[0-4][0-9]|25[0-5]|1[0-9]{2}|[1-9][0-9]|[0-9])(:[0-9]{2,5})?/.source,")))").concat(wa),"gi"),Aa="([\\-A-Z:0-9%_+~#@]{1,256}\\.){1,50}",Oa="[a-z\\-]{2,15}",Ma="com|org|net|int|edu|gov|mil|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gh|gi|gl|gm|gn|gp|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mf|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|site|top|wtf|xxx|xyz|cloud|engineering|help|one",ka="com|cn|tk|de|net|org|uk|info|nl|ru|hk|mx|br|my|co|pk|pe|sg|tr|au|nz|sa|pt|pl|id|ve|ph|in|qa|py|ar|bd|cy|sv|jo|kw|fj|vn|uy|ua|ec|bh|gt|eg|mt|ai",Ia=Ma+"|"+ka,xa=new RegExp("(((".concat(Sa,"):\\/\\/").concat(Aa).concat(Oa,")|([-A-Z0-9%_+~#@]").concat(Aa,"(").concat(ka,")))(:[0-9]{2,5})?").concat(wa),"gi"),Na="[\\w.!#$%&'*+-/=?^_\\`{|}~]{1,2000}@[A-Za-z0-9_.-]+\\.",Pa=new RegExp("^(?!data:)((mailto:".concat(Na).concat(Oa,")|(").concat(Na,"(").concat(Ma,")))\\b"),"gi"),La=new RegExp("(".concat(Ra.source,")|(").concat(xa.source,")|(").concat(Pa.source,")"),"gi"),Da=/^(https?|ftp):\/\/|mailto:/i;function Fa(e){return new RegExp(Da).test(e)}function Ba(e){return new RegExp(La).test(e)}function Va(e){return new RegExp("^".concat(Pa.source,"$"),"i").test(e)}function Ha(e){var t=[],n=0,r=new RegExp(La),i=r.exec(e);if(null==i)return e;for(;i;){var o=i.index,a=i[0];o!==n&&t.push({type:hr.TEXT,text:e.substring(n,o)}),Fa(a)?t.push({type:hr.URL,text:a}):Va(a)?t.push({type:hr.URL,link:"mailto:".concat(a),text:a}):Ba(a)&&t.push({type:hr.URL,link:"http://".concat(a),text:a}),n=r.lastIndex,i=r.exec(e)}return n<e.length&&t.push({type:hr.TEXT,text:e.substring(n)}),t}function Ua(e){return(0,V.Z)(e)?Wa(e):e}var Za=/\u00a0/g;function Wa(e){return e.replace(Za," ")}function ja(e){for(var t="";e>=0;)t=String.fromCharCode(e%26+65)+t,e=Math.floor(e/26)-1;return t}function Ga(e){for(var t=e.toUpperCase(),n=0,r=t.length-1,i=0;r>=0;r--,i++)n+=(t.charCodeAt(r)-65+1)*Math.pow(26,i);return n-1}var za="[.~`!?@#$%^&*()\\-_+=|{};:\"<>'[\\]]",Ya="[。？ ！ ， 、 ； ： “ ” ‘ （ ） 《 》 〈 〉 【 】 『 』 「 」 ﹃ ﹄ 〔 〕 … — ～ ﹏ ￥]",Xa="[\\u4e00-\\u9fa5]",Ka="[\\u0800-\\u4e00]",qa="[A-Z]",$a="[a-z]",Ja="[0-9]";function Qa(e){if("string"!=typeof e)return e;var t=new RegExp([za,Ya,Xa,Ka,qa,$a,Ja].map((function(e){return"(".concat(e,")")})).join("|")+"|.","g");return e.replace(t,(function(e,t,n,r,i,o,a,s){return void 0!==t?t:void 0!==n?n:void 0!==r?"汉":void 0!==i?"日":void 0!==o?"X":void 0!==a?"x":void 0!==s?"9":"？"}))}function es(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}function ts(e){return(0,V.Z)(e)?e.replace(/"/g,'""'):e}function ns(e){if(e.length>100)return e;var t={};return t[e]=!0,Object.keys(t)[0]}var rs=new Set(["tidSplit","localActiveView","localDeactiveView","editChart","editPivotTable"]),is=new Set(["addSheet","copySheet","restoreSheet","softDelSheet","lockSheet","unlockSheet","coverSnapshot","moveRange","addBlock","delBlock","restoreBlock"]);function os(e){return is.has(e)}var as=new Set(["addSheet","setSheet","copySheet","delSheet","moveSheet","lockSheet","unlockSheet","softDelSheet","restoreSheet","addBlock","delBlock","restoreBlock"]),ss=new Set(["addSheet","copySheet","restoreSheet","addBlock","restoreBlock"]);function us(e){return ss.has(e.action)}function ls(e){return as.has(e.action)}var cs=new Set(["delSheet","setSheet","softDelSheet","restoreSheet","moveSheet","recover"]),hs=new Set(["setFilter","delFilter","freezeSheet","moveSheet","addSheet","copySheet","delSheet","setSheet","recover","coverSnapshot","addBlock","delBlock","restoreBlock","setFloatBlock","delFloatBlock","setEmbeddedBlock","delEmbeddedBlock"]);function ds(e){return hs.has(e)}var fs=new Set(["addRow","delRow","addCol","delCol"]);function ps(e){return fs.has(e)}var vs=new Set(["setCell","copySheet","setRange","updateRange"]);function gs(e){return vs.has(e)}var _s=new Set(["setChart","moveRange"]);function ys(e){return ls(e)||_s.has(e.action)}new Set(["recover"]);var ms=new Set(["addRow","addCol","delRow","delCol","setSheet","copySheet","delSheet","delBlock","moveRange"]);function Es(e){return ms.has(e.action)}function bs(e){return"setSheet"===e.action}var Ts=new Set(["addBlock","delBlock","restoreBlock"]);function Cs(e){var t,n=(null==e||null===(t=e.value)||void 0===t?void 0:t.block_type)===wt.BITABLE_BLOCK;return"copySheet"===e.action||n&&Ts.has(e.action)}var Ss=new Set(["setEmbeddedBlock","delEmbeddedBlock","addBlock","restoreBlock"]);function ws(e){var t,n=(null==e||null===(t=e.value)||void 0===t?void 0:t.block_type)===wt.BITABLE_BLOCK;return Ss.has(e.action)&&!n}var Rs=new Set(["coverSheet","coverSnapshot"]);function As(e){if(!e||!e.content)return!1;for(var t=0;t<e.content.length;t++)if(Rs.has(e.content[t].action))return!0;return!1}new Set(["addRow","addCol","delRow","delCol","sort","setSheet","delSheet","moveRange"]);var Os=new Set(["setSheet"]);function Ms(e){return Os.has(e.action)}var ks=function(){function e(t){(0,c.Z)(this,e),this.capacity=t,this.map=new Map}return(0,a.Z)(e,[{key:"has",value:function(e){return this.map.has(e)}},{key:"get",value:function(e,t){var n=this.map.get(e);if(void 0!==n)return!1===t||(this.map.delete(e),this.map.set(e,n)),n}},{key:"set",value:function(e,t){this.map.has(e)?this.map.delete(e):this.map.size>=this.capacity&&this.map.delete(this.map.keys().next().value),this.map.set(e,t)}},{key:"remove",value:function(e){return this.map.delete(e)}},{key:"getOldest",value:function(){return[this.map.keys().next().value,this.map.values().next().value]}},{key:"removeOldest",value:function(){var e=this.map.keys().next().value;return this.map.delete(e),e}},{key:"size",value:function(){return this.map.size}},{key:"clear",value:function(){this.map.clear()}},{key:"getAllEntries",value:function(){return Array.from(this.map.entries())}}]),e}(),Is=[qe.VY,qe.f5,qe.p4,qe.cS,qe.R,qe.S5,qe.Vi,qe.M8,qe.yO,qe.X7];function xs(e){return Is[e%Is.length]}var Ns=new ks(1e4);function Ps(e){if(e&&"#"===e[0]&&7===e.length)return e.toLowerCase();var t=Ns.get(e);if(t)return t;if(e&&e.startsWith("var(--"))return e;var n=et()(e).toHexString();return Ns.set(e,n),n}function Ls(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,B.default)(CustomEvent))return new CustomEvent(e,t);var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!!t.bubbles,!!t.cancelable,t.detail),n}var Ds=function(e){if(window.requestAnimationFrame)return window.requestAnimationFrame(e);return window.setTimeout(e,16)},Fs=function(e){window.cancelAnimationFrame?window.cancelAnimationFrame(e):window.clearTimeout(e)};function Bs(e,t){return e&&e.classList&&(0,B.default)(e.classList.contains)&&e.classList.contains(t)}var Vs=Array.prototype.flat?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e.flat(t)}:F;function Hs(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(r.length<=1e4)return e.splice.apply(e,[t,n].concat((0,o.Z)(r)));var i=e.length;t<0?(t+=i)<0&&(t=0):t>i-1&&(t=i),n<0&&(n=0);var a=r.length,s=t+n>i?i-t:n,u=t+s,l=e.slice(t,u),c=a-s;if(c>0)for(var h=i-1;h>=t+s;h--)e[h+c]=e[h];else if(c<0)for(var d=Math.abs(c),f=t+a;f<i-d;f++)e[f]=e[f+d];for(var p=0;p<a;p++)e[p+t]=r[p];return e.length=i-l.length+a,l}var Us=new Array(0),Zs=32768;function Ws(e){return e?Array.isArray(e)?e:Array.from(e):Us}function js(e,t,n){var r=Ws(e),i=Ws(t),o=Ws(n),a=[];return r.length&&(a=a.concat(r)),i.length&&(a=a.concat(i)),o.length&&(a=a.concat(o)),a}function Gs(e,t,n,r){var i=js(t,n,r);if(i.length<Zs)return Array.prototype.push.apply(e,i);for(var o=0;o<i.length;){var a=i.slice(o,o+Zs);Array.prototype.push.apply(e,a),o+=Zs}}function zs(e,t,n,r){var i=js(t,n,r);if(i.length<Zs)return Array.prototype.unshift.apply(e,i);for(var o=i.length;o>0;){var a=o-Zs,s=i.slice(a<0?0:a,o);Array.prototype.unshift.apply(e,s),o-=Zs}}var Ys=!(0,L.default)(window)&&window.localStorage&&window.localStorage.getItem("sheet-log-no-mix")||!1,Xs={row:!0,row_count:!0,col:!0,col_count:!0,sheet_id:!0,action:!0},Ks=function(e,t){try{if(!Ys&&!window.sheetLogNoMix)return;console.log(e,t)}catch(e){return}},qs=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;try{return 0===n&&(t=(0,P.default)(t)),(0,N.default)(t)?parseInt("9".repeat(t.toString().length),10):(0,V.Z)(t)?"x".repeat(t.length):(0,x.Z)(t)||(0,I.Z)(t)?((0,k.Z)(t).forEach((function(r){t[r]=Xs[r]?t[r]:e(t[r],n+1)})),t):t}catch(t){return{}}};function $s(e){return JSON.stringify(qs(JSON.parse(e)))}function Js(e){try{return{message:"follow_conflict",isCover:e.info.isCover,op1:$s(e.info.op1),op2:$s(e.info.op2)}}catch(e){return{message:"follow_conflict"}}}var Qs={max:3,factor:0,interval:1e3};function eu(e,t){var n=Object.assign({},Qs,t),r=n.max,i=n.interval,o=n.factor,a=n.onRetry,s=n.shouldRetry,c=0;return function(){for(var t=arguments.length,n=new Array(t),h=0;h<t;h++)n[h]=arguments[h];return new Promise((function(t,h){var d=function(){var f=(0,l.Z)(u().mark((function l(){var f,p,v;return u().wrap((function(u){for(;;)switch(u.prev=u.next){case 0:return f=function(e){var t=Math.pow(c++,o)*i;(!s||s(e))&&setTimeout((function(){a&&a(c,e),d()}),t)},p=n&&n[2]||{},u.prev=1,u.next=4,e.apply(null,n);case 4:if(v=u.sent,!s||!s(v,c)){u.next=11;break}if(!(c<r)){u.next=8;break}return u.abrupt("return",f(v));case 8:h({code:"50010",payload:v,customErrorInfo:Object.assign(p,{retryTime:c})}),u.next=12;break;case 11:t({code:0,payload:v,retryTime:c});case 12:u.next=17;break;case 14:u.prev=14,u.t0=u.catch(1),c<r&&(!s||s(u.t0,c))?f(u.t0):h({code:"50010",payload:u.t0,customErrorInfo:Object.assign(p,{retryTime:c})});case 17:case"end":return u.stop()}}),l,null,[[1,14]])})));return function(){return f.apply(this,arguments)}}();window.__OFFLINE__&&!window.navigator.onLine?window.addEventListener("online",(function e(){window.removeEventListener("online",e),d()})):d()}))}}function tu(){return!Boolean((0,M.default)(window,"globalConfig.common.channel",""))}function nu(e){return"url"===e.type}function ru(e){return e.type===hr.MENTION}function iu(e){return ru(e)&&0===e.mentionType}function ou(e){return"attachment"===e.type}function au(e){return ru(e)&&cu(e.mentionType)}function su(e){return"embed-image"===e.type}function uu(e){return e.type===hr.REMINDER}var lu={1:"Doc",3:"Sheet",8:"Bitable",11:"MindNote",12:"File",15:"Slide",30:"Slides",16:"Wiki",22:"Docx",38:"WhiteBoard"};function cu(e){return void 0!==lu[e]}function hu(e){return ru(e)?decodeURIComponent(e.link||""):e.link||e.text||""}function du(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e&&Array.isArray(e)){var n,r=ht(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;!iu(i)||i.mentionId&&!t||(i.mentionId=es())}}catch(e){r.e(e)}finally{r.f()}}}var fu=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,c.Z)(this,e),this.waitingQueue=[],this.runningSet=new Set,this.options=Object.assign({maxRunningCount:1},t)}var t;return(0,a.Z)(e,[{key:"schedule",value:function(e){var t=this;return new Promise((function(n,r){t.enqueue(e,n,r),t.execute()}))}},{key:"execute",value:(t=(0,l.Z)(u().mark((function e(){var t,n,r,o,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.waitingQueue.length>0&&this.runningSet.size<this.options.maxRunningCount)){e.next=19;break}return t=this.waitingQueue.shift(),n=(0,i.Z)(t,3),r=n[0],o=n[1],a=n[2],this.runningSet.add(r),e.prev=3,e.t0=o,e.next=7,r();case 7:e.t1=e.sent,(0,e.t0)(e.t1),e.next=14;break;case 11:e.prev=11,e.t2=e.catch(3),a(e.t2);case 14:return e.prev=14,this.runningSet.delete(r),e.next=18,this.execute();case 18:return e.finish(14);case 19:case"end":return e.stop()}}),e,this,[[3,11,14,19]])}))),function(){return t.apply(this,arguments)})},{key:"enqueue",value:function(e,t,n){this.waitingQueue.push([e,t,n])}}]),e}(),pu=function(e){function t(){return(0,c.Z)(this,t),(0,h.Z)(this,(0,d.Z)(t).apply(this,arguments))}return(0,p.Z)(t,e),(0,a.Z)(t,[{key:"enqueue",value:function(e,t,n){this.waitingQueue=[[e,t,n]]}}]),t}(fu);function vu(e){var t=(0,Ke.convertBase64StrToBuffer)(e);return{buffer:t,result:(0,Ke.ungzipBuffer)(t)}}function gu(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={};if(e.rows&&e.rows.length)for(var r=0,i=e.rows.length;r<i;r++){var o=e.rows[r];if(o&&o.columns&&o.columns.length){n[t+r]={};for(var a=0,s=o.columns.length;a<s;a++){var u=o.columns[a];u&&(n[t+r][a]=u)}}}return n}function _u(e){for(var t=e.sheets,n=0,r=0;r<t.length;r++){var i=t[r].embeddedBlocksModel.getBlocksMap();i&&(n+=Object.keys(i).length)}return n}var yu,mu="visibilitychange";!function(e){e.Visible="visible",e.Hidden="hidden"}(yu||(yu={}));var Eu=function(e){function t(){var e;if((0,c.Z)(this,t),(e=(0,h.Z)(this,(0,d.Z)(t).call(this))).handlePageVisible=function(){e.visibilityState="visible",e.emit(mu,"visible")},e.handlePageNotVisible=function(){e.visibilityState="hidden",e.emit(mu,"hidden")},e.handleVisibilityChange=function(){var t=document.visibilityState;e.visibilityState=t,e.emit(mu,t)},"object"!=("undefined"==typeof document?"undefined":(0,r.Z)(document)))return(0,h.Z)(e);var n=io.browser.isLarkPcTab?e.getStateFromLarkStatus():document.visibilityState;return e.visibilityState=n,(0,h.Z)(e)}return(0,p.Z)(t,e),(0,a.Z)(t,[{key:"getStateFromLarkStatus",value:function(){return"started"===(0,M.default)(window,"__APPLICATION__STATUS__")?"visible":"hidden"}},{key:"watch",value:function(){io.browser.isLarkPcTab?(window.addEventListener("application-stop",this.handlePageNotVisible),window.addEventListener("application-start",this.handlePageVisible)):window.addEventListener("visibilitychange",this.handleVisibilityChange),this.isWatching=!0}},{key:"unwatch",value:function(){io.browser.isLarkPcTab?(window.removeEventListener("application-stop",this.handlePageNotVisible),window.removeEventListener("application-start",this.handlePageVisible)):window.removeEventListener("visibilitychange",this.handleVisibilityChange),this.isWatching=!1}},{key:"isVisible",get:function(){return"visible"===this.visibilityState}}]),t}(nt()),bu=2147483647,Tu=/[^\x20-\x7E]/,Cu=/[\x2E\u3002\uFF0E\uFF61]/g,Su={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},wu=Math.floor,Ru=String.fromCharCode;function Au(e){throw new RangeError(Su[e])}function Ou(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function Mu(e,t,n){var r=0;for(e=n?wu(e/700):e>>1,e+=wu(e/t);e>455;r+=36)e=wu(e/35);return wu(r+36*e/(e+38))}function ku(e){return function(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),r+function(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}((e=e.replace(Cu,".")).split("."),t).join(".")}(e,(function(e){return Tu.test(e)?"xn--"+function(e){var t,n,r,i,o,a,s,u,l,c,h,d,f,p,v,g=[];for(d=(e=function(e){for(var t,n,r=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(n=e.charCodeAt(i++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--):r.push(t);return r}(e)).length,t=128,n=0,o=72,a=0;a<d;++a)(h=e[a])<128&&g.push(Ru(h));for(r=i=g.length,i&&g.push("-");r<d;){for(s=bu,a=0;a<d;++a)(h=e[a])>=t&&h<s&&(s=h);for(s-t>wu((bu-n)/(f=r+1))&&Au("overflow"),n+=(s-t)*f,t=s,a=0;a<d;++a)if((h=e[a])<t&&++n>bu&&Au("overflow"),h==t){for(u=n,l=36;!(u<(c=l<=o?1:l>=o+26?26:l-o));l+=36)v=u-c,p=36-c,g.push(Ru(Ou(c+v%p,0))),u=wu(v/p);g.push(Ru(Ou(u,0))),o=Mu(n,f,r==i),n=0,++r}++n,++t}return g.join("")}(e):e}))}function Iu(e){return null===e}function xu(e){return"string"==typeof e}function Nu(e){return"object"==(0,r.Z)(e)&&null!==e}function Pu(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var Lu=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function Du(e){switch((0,r.Z)(e)){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}}function Fu(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var Bu=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t};function Vu(e,t,n,r){t=t||"&",n=n||"=";var i={};if("string"!=typeof e||0===e.length)return i;var o=/\+/g;e=e.split(t);var a=1e3;r&&"number"==typeof r.maxKeys&&(a=r.maxKeys);var s=e.length;a>0&&s>a&&(s=a);for(var u=0;u<s;++u){var l,c,h,d,f=e[u].replace(o,"%20"),p=f.indexOf(n);p>=0?(l=f.substr(0,p),c=f.substr(p+1)):(l=f,c=""),h=decodeURIComponent(l),d=decodeURIComponent(c),Pu(i,h)?Lu(i[h])?i[h].push(d):i[h]=[i[h],d]:i[h]=d}return i}var Hu={parse:el,resolve:function(e,t){return el(e,!1,!0).resolve(t)},resolveObject:function(e,t){return e?el(e,!1,!0).resolveObject(t):t},format:function(e){return xu(e)&&(e=tl({},e)),nl(e)},Url:Uu};function Uu(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var Zu=/^([a-z0-9.+-]+:)/i,Wu=/:[0-9]*$/,ju=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Gu=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),zu=["'"].concat(Gu),Yu=["%","/","?",";","#"].concat(zu),Xu=["/","?","#"],Ku=/^[+a-z0-9A-Z_-]{0,63}$/,qu=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,$u={javascript:!0,"javascript:":!0},Ju={javascript:!0,"javascript:":!0},Qu={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function el(e,t,n){if(e&&Nu(e)&&e instanceof Uu)return e;var r=new Uu;return r.parse(e,t,n),r}function tl(e,t,n,i){if(!xu(t))throw new TypeError("Parameter 'url' must be a string, not "+(0,r.Z)(t));var o=t.indexOf("?"),a=-1!==o&&o<t.indexOf("#")?"?":"#",s=t.split(a);s[0]=s[0].replace(/\\/g,"/");var u=t=s.join(a);if(u=u.trim(),!i&&1===t.split("#").length){var l=ju.exec(u);if(l)return e.path=u,e.href=u,e.pathname=l[1],l[2]?(e.search=l[2],e.query=n?Vu(e.search.substr(1)):e.search.substr(1)):n&&(e.search="",e.query={}),e}var c,h,d,f,p=Zu.exec(u);if(p){var v=(p=p[0]).toLowerCase();e.protocol=v,u=u.substr(p.length)}if(i||p||u.match(/^\/\/[^@\/]+@[^@\/]+/)){var g="//"===u.substr(0,2);!g||p&&Ju[p]||(u=u.substr(2),e.slashes=!0)}if(!Ju[p]&&(g||p&&!Qu[p])){var _,y,m=-1;for(c=0;c<Xu.length;c++)-1!==(h=u.indexOf(Xu[c]))&&(-1===m||h<m)&&(m=h);for(-1!==(y=-1===m?u.lastIndexOf("@"):u.lastIndexOf("@",m))&&(_=u.slice(0,y),u=u.slice(y+1),e.auth=decodeURIComponent(_)),m=-1,c=0;c<Yu.length;c++)-1!==(h=u.indexOf(Yu[c]))&&(-1===m||h<m)&&(m=h);-1===m&&(m=u.length),e.host=u.slice(0,m),u=u.slice(m),rl(e),e.hostname=e.hostname||"";var E="["===e.hostname[0]&&"]"===e.hostname[e.hostname.length-1];if(!E){var b=e.hostname.split(/\./);for(c=0,d=b.length;c<d;c++){var T=b[c];if(T&&!T.match(Ku)){for(var C="",S=0,w=T.length;S<w;S++)T.charCodeAt(S)>127?C+="x":C+=T[S];if(!C.match(Ku)){var R=b.slice(0,c),A=b.slice(c+1),O=T.match(qu);O&&(R.push(O[1]),A.unshift(O[2])),A.length&&(u="/"+A.join(".")+u),e.hostname=R.join(".");break}}}}e.hostname.length>255?e.hostname="":e.hostname=e.hostname.toLowerCase(),E||(e.hostname=ku(e.hostname)),f=e.port?":"+e.port:"";var M=e.hostname||"";e.host=M+f,e.href+=e.host,E&&(e.hostname=e.hostname.substr(1,e.hostname.length-2),"/"!==u[0]&&(u="/"+u))}if(!$u[v])for(c=0,d=zu.length;c<d;c++){var k=zu[c];if(-1!==u.indexOf(k)){var I=encodeURIComponent(k);I===k&&(I=escape(k)),u=u.split(k).join(I)}}var x=u.indexOf("#");-1!==x&&(e.hash=u.substr(x),u=u.slice(0,x));var N=u.indexOf("?");if(-1!==N?(e.search=u.substr(N),e.query=u.substr(N+1),n&&(e.query=Vu(e.query)),u=u.slice(0,N)):n&&(e.search="",e.query={}),u&&(e.pathname=u),Qu[v]&&e.hostname&&!e.pathname&&(e.pathname="/"),e.pathname||e.search){f=e.pathname||"";var P=e.search||"";e.path=f+P}return e.href=nl(e),e}function nl(e){var t=e.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var n=e.protocol||"",i=e.pathname||"",o=e.hash||"",a=!1,s="";e.host?a=t+e.host:e.hostname&&(a=t+(-1===e.hostname.indexOf(":")?e.hostname:"["+this.hostname+"]"),e.port&&(a+=":"+e.port)),e.query&&Nu(e.query)&&Object.keys(e.query).length&&(s=function(e,t,n,i){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==(0,r.Z)(e)?Fu(Bu(e),(function(r){var i=encodeURIComponent(Du(r))+n;return Lu(e[r])?Fu(e[r],(function(e){return i+encodeURIComponent(Du(e))})).join(t):i+encodeURIComponent(Du(e[r]))})).join(t):i?encodeURIComponent(Du(i))+n+encodeURIComponent(Du(e)):""}(e.query));var u=e.search||s&&"?"+s||"";return n&&":"!==n.substr(-1)&&(n+=":"),e.slashes||(!n||Qu[n])&&!1!==a?(a="//"+(a||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):a||(a=""),o&&"#"!==o.charAt(0)&&(o="#"+o),u&&"?"!==u.charAt(0)&&(u="?"+u),n+a+(i=i.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(u=u.replace("#","%23"))+o}function rl(e){var t=e.host,n=Wu.exec(t);n&&(":"!==(n=n[0])&&(e.port=n.substr(1)),t=t.substr(0,t.length-n.length)),t&&(e.hostname=t)}function il(e,t){return Object.prototype.hasOwnProperty.call(e,t)}Uu.prototype.parse=function(e,t,n){return tl(this,e,t,n)},Uu.prototype.format=function(){return nl(this)},Uu.prototype.resolve=function(e){return this.resolveObject(el(e,!1,!0)).format()},Uu.prototype.resolveObject=function(e){if(xu(e)){var t=new Uu;t.parse(e,!1,!0),e=t}for(var n,r=new Uu,i=Object.keys(this),o=0;o<i.length;o++){var a=i[o];r[a]=this[a]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),u=0;u<s.length;u++){var l=s[u];"protocol"!==l&&(r[l]=e[l])}return Qu[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!Qu[e.protocol]){for(var c=Object.keys(e),h=0;h<c.length;h++){var d=c[h];r[d]=e[d]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||Ju[e.protocol])r.pathname=e.pathname;else{for(n=(e.pathname||"").split("/");n.length&&!(e.host=n.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==n[0]&&n.unshift(""),n.length<2&&n.unshift(""),r.pathname=n.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var f=r.pathname||"",p=r.search||"";r.path=f+p}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var v,g=r.pathname&&"/"===r.pathname.charAt(0),_=e.host||e.pathname&&"/"===e.pathname.charAt(0),y=_||g||r.host&&e.pathname,m=y,E=r.pathname&&r.pathname.split("/")||[],b=r.protocol&&!Qu[r.protocol];if(n=e.pathname&&e.pathname.split("/")||[],b&&(r.hostname="",r.port=null,r.host&&(""===E[0]?E[0]=r.host:E.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===n[0]?n[0]=e.host:n.unshift(e.host)),e.host=null),y=y&&(""===n[0]||""===E[0])),_)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,E=n;else if(n.length)E||(E=[]),E.pop(),E=E.concat(n),r.search=e.search,r.query=e.query;else if(!function(e){return null==e}(e.search))return b&&(r.hostname=r.host=E.shift(),(v=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=v.shift(),r.host=r.hostname=v.shift())),r.search=e.search,r.query=e.query,Iu(r.pathname)&&Iu(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r;if(!E.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var T=E.slice(-1)[0],C=(r.host||e.host||E.length>1)&&("."===T||".."===T)||""===T,S=0,w=E.length;w>=0;w--)"."===(T=E[w])?E.splice(w,1):".."===T?(E.splice(w,1),S++):S&&(E.splice(w,1),S--);if(!y&&!m)for(;S--;S)E.unshift("..");!y||""===E[0]||E[0]&&"/"===E[0].charAt(0)||E.unshift(""),C&&"/"!==E.join("/").substr(-1)&&E.push("");var R=""===E[0]||E[0]&&"/"===E[0].charAt(0);return b&&(r.hostname=r.host=R?"":E.length?E.shift():"",(v=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=v.shift(),r.host=r.hostname=v.shift())),(y=y||r.host&&E.length)&&!R&&E.unshift(""),E.length?r.pathname=E.join("/"):(r.pathname=null,r.path=null),Iu(r.pathname)&&Iu(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},Uu.prototype.parseHost=function(){return rl(this)};var ol=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function al(e){return new URLSearchParams(location.search.substring(1)).get(e)||""}function sl(e,t){var n=new URLSearchParams(location.search.slice(1));n.set(e,t);var r=n.toString();return r?"?"+r:""}function ul(e){var t=new URLSearchParams(location.search.slice(1));t.delete(e);var n=t.toString();return n?"?"+n:""}function ll(e){if(!e)return null;try{var t=Hu.parse(e);if(t&&t.query){var n,r=function(e,t,n,r){t=t||"&",n=n||"=";var i={};if("string"!=typeof e||0===e.length)return i;var o=/\+/g;e=e.split(t);var a=1e3;r&&"number"==typeof r.maxKeys&&(a=r.maxKeys);var s=e.length;a>0&&s>a&&(s=a);for(var u=0;u<s;++u){var l,c,h,d,f=e[u].replace(o,"%20"),p=f.indexOf(n);p>=0?(l=f.substr(0,p),c=f.substr(p+1)):(l=f,c=""),h=decodeURIComponent(l),d=decodeURIComponent(c),il(i,h)?ol(i[h])?i[h].push(d):i[h]=[i[h],d]:i[h]=d}return i}(t.query);if(r.sheet)return r.rangeId&&(n="id_".concat(r.rangeId)),{sheetId:r.sheet,rangeId:n||r.range}}}catch(e){return console.error("getCellPositionParam parse link error",e),null}return null}var cl=function(){return/shortcut=true/.test(location.search)},hl=function(){return(0,M.default)(window,"User.isPDF",!1)},dl=function(){return/[?&]rangeId=([^&]+)/.test(location.search)},fl=function(){function e(){(0,c.Z)(this,e)}return(0,a.Z)(e,null,[{key:"genTidSplitAction",value:function(e,t){return{action:"tidSplit",tid:e,sheet_id:t}}},{key:"genMergedTid",value:function(e,t,n){try{if(t<=0||t>e.length+1)return n;var r={action:"tidSplit"},i=(0,O.Z)(e,r),o=A(e,r,t-1),a=i.tid,s=o?o.tid:a;return o&&o!==e[t-1]&&(s+=1),"".concat(n,"-").concat(a,"-").concat(s)}catch(e){return io.moirae.teaLog({key:"client_sheet_trans_genmergedtid_err"}),Ks("genMergedTid fail",e),n}}}]),e}();function pl(e){return"updateRange"===e.action||"setRange"===e.action}fl.seed=0,fl.genStepTid=function(){return++fl.seed},fl.destroy=function(){fl.seed=0},fl.genSpecTid=function(e){return-(Math.abs(e)+parseFloat(Math.random().toFixed(5)))};var vl,gl=function(){var e;return function(){if(!e){e=io.getSheetCellLimitNum()||2e6}return e}}(),_l=function(){return gl().toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},yl=function(e){return e.replace(/^([a-zA-Z]+\d+):([a-zA-Z]+\d+)$/,(function(e,t,n){return t===n?t:e}))};function ml(){return window.performance.now()}function El(e){return Math.round(window.performance.now()-e)}!function(e){e[e.APPLY_FAIL=4e5]="APPLY_FAIL",e[e.APPLY_FAIL_SPAN_CONFLICT=400001]="APPLY_FAIL_SPAN_CONFLICT",e[e.SET_VALUE_FAIL=400100]="SET_VALUE_FAIL",e[e.SET_FORMULA_FAIL=400200]="SET_FORMULA_FAIL",e[e.SET_STYLE_FAIL=400300]="SET_STYLE_FAIL",e[e.ADD_SHEET_FAIL=400400]="ADD_SHEET_FAIL",e[e.CREATE_FAIL=400500]="CREATE_FAIL",e[e.SORT_FAIL=400600]="SORT_FAIL",e[e.SET_CELL_FAIL=400700]="SET_CELL_FAIL",e[e.SET_SPANS_FAIL=400800]="SET_SPANS_FAIL",e[e.SET_COLUMN_WIDTH_FAIL=400900]="SET_COLUMN_WIDTH_FAIL",e[e.SET_ROW_HEIGHT_FAIL=401e3]="SET_ROW_HEIGHT_FAIL",e[e.SET_SHEET_FAIL=401100]="SET_SHEET_FAIL",e[e.COPY_SHEET_FAIL=401200]="COPY_SHEET_FAIL",e[e.DEL_SHEET_FAIL=401300]="DEL_SHEET_FAIL",e[e.SOFT_DEL_SHEET_FAIL=401400]="SOFT_DEL_SHEET_FAIL",e[e.RESTORE_SHEET_FAIL=401500]="RESTORE_SHEET_FAIL",e[e.MOVE_SHEET_FAIL=401600]="MOVE_SHEET_FAIL",e[e.ADD_ROW_FAIL=401700]="ADD_ROW_FAIL",e[e.ADD_COL_FAIL=401800]="ADD_COL_FAIL",e[e.DEL_ROW_FAIL=401900]="DEL_ROW_FAIL",e[e.DEL_COL_FAIL=402e3]="DEL_COL_FAIL",e[e.HIDE_ROW_FAIL=402100]="HIDE_ROW_FAIL",e[e.UNHIDE_ROW_FAIL=402200]="UNHIDE_ROW_FAIL",e[e.HIDE_COL_FAIL=402300]="HIDE_COL_FAIL",e[e.UNHIDE_COL_FAIL=402400]="UNHIDE_COL_FAIL",e[e.DEL_FILTER_FAIL=402500]="DEL_FILTER_FAIL",e[e.SET_FILTER_FAIL=402600]="SET_FILTER_FAIL",e[e.FREEZE_SHEET_FAIL=402700]="FREEZE_SHEET_FAIL",e[e.ADD_COMMENTS_FAIL=402800]="ADD_COMMENTS_FAIL",e[e.RECOVER_FAIL=402900]="RECOVER_FAIL",e[e.LOCK_ROW_FAIL=403e3]="LOCK_ROW_FAIL",e[e.UNLOCK_ROW_FAIL=403100]="UNLOCK_ROW_FAIL",e[e.LOCK_COL_FAIL=403200]="LOCK_COL_FAIL",e[e.UNLOCK_COL_FAIL=403300]="UNLOCK_COL_FAIL",e[e.LOCK_SHEET_FAIL=403400]="LOCK_SHEET_FAIL",e[e.UNLOCK_SHEET_FAIL=403500]="UNLOCK_SHEET_FAIL",e[e.SET_CHART_FAIL=403600]="SET_CHART_FAIL",e[e.DEL_CHART_FAIL=403700]="DEL_CHART_FAIL",e[e.ADD_CONDITIONAL_FORMAT_FAIL=403900]="ADD_CONDITIONAL_FORMAT_FAIL",e[e.SET_CONDITIONAL_FORMAT_FAIL=404e3]="SET_CONDITIONAL_FORMAT_FAIL",e[e.DEL_CONDITIONAL_FORMAT_FAIL=404100]="DEL_CONDITIONAL_FORMAT_FAIL",e[e.MOVE_CONDITIONAL_FORMAT_FAIL=404200]="MOVE_CONDITIONAL_FORMAT_FAIL",e[e.COVER_SNAPSHOT_FAIL=404300]="COVER_SNAPSHOT_FAIL",e[e.ADD_BLOCK_FAIL=404400]="ADD_BLOCK_FAIL",e[e.DEL_BLOCK_FAIL=404500]="DEL_BLOCK_FAIL",e[e.RESTORE_BLOCK_FAIL=404600]="RESTORE_BLOCK_FAIL",e[e.MOVE_RANGE_FAIL=404700]="MOVE_RANGE_FAIL",e[e.MOVE_RANGE_CONFLICT_SPAN=404701]="MOVE_RANGE_CONFLICT_SPAN",e[e.COVER_SHEET_FAIL=404800]="COVER_SHEET_FAIL"}(vl||(vl={}));for(var bl={},Tl=0,Cl=[vl];Tl<Cl.length;Tl++){var Sl=Cl[Tl];for(var wl in Sl)bl[wl]={code:Number(wl),message:Sl[wl]}}var Rl=function(e){function t(e,n){var r;return(0,c.Z)(this,t),(r=(0,h.Z)(this,(0,d.Z)(t).call(this,"[code=".concat(e.code,"]").concat(e.message))))._extra=n,r._errCode=e.code,r._errMsg=e.message,r.name=r.constructor.name,"function"==typeof Error.captureStackTrace?Error.captureStackTrace((0,f.Z)(r),r.constructor):r.stack=new Error(e.message).stack,r}return(0,p.Z)(t,e),(0,a.Z)(t,[{key:"code",get:function(){return this._errCode}},{key:"message",get:function(){return this._errMsg}},{key:"extra",get:function(){return this._extra}}],[{key:"fromCode",value:function(e,n){return bl[e]?new t(bl[e],n):new t({code:e,message:"unknown code"},n)}}]),t}((0,v.Z)(Error)),Al="temp_",Ol="$$TEMP_PERSONAL",Ml=Al+Ol;function kl(e){return!!e&&e.startsWith(Al)}function Il(e){return e===Ml}function xl(e,t){var n=kl(t.view_id);return n?{action:"addView",sheet_id:e,is_local:n,value:t}:{action:"addView",sheet_id:e,value:t}}function Nl(e,t){var n=kl(t.view_id);return n?{action:"delView",sheet_id:e,is_local:n,value:t}:{action:"delView",sheet_id:e,value:t}}function Pl(e,t){var n=kl(t.view_id);return n?{action:"setView",sheet_id:e,is_local:n,value:t}:{action:"setView",sheet_id:e,value:t}}function Ll(e,t){var n=kl(t.view_id);return n?{action:"setFilterView",sheet_id:e,is_local:n,value:t}:{action:"setFilterView",sheet_id:e,value:t}}function Dl(e,t){return{action:"localActiveView",sheet_id:e,is_local:!0,value:{view_id:t}}}function Fl(e){return{action:"localDeactiveView",sheet_id:e,is_local:!0}}var Bl=function(){function e(){(0,c.Z)(this,e)}return(0,a.Z)(e,null,[{key:"init",value:function(t){try{if(""===t)return void(e.zoomDataObj={});var n=function(e){return e.reduce((function(e,t){var n=t.split("_"),r=(0,i.Z)(n,3),o=r[0],a=r[1],s=r[2];return e[o]||(e[o]={},e[o][a]={}),e[o][a]=s,e}),{})}(JSON.parse(localStorage.getItem("sheetZoom")||"[]"))[t];for(var r in n){var o=Number(n[r]);(Number.isNaN(o)||o<=0)&&delete n[r]}e.zoomDataObj=n||{}}catch(t){e.zoomDataObj={}}}},{key:"getItem",value:function(t){return e.zoomDataObj[t]||e.defaultZoom}},{key:"setItem",value:function(t,n,r){try{var i=JSON.parse(localStorage.getItem("sheetZoom")||"[]");i.length>30&&i.shift();var o=i.findIndex((function(e){return e.startsWith(t+"_"+n)}));if(o>-1)return 1===r?i.splice(o,1):i[o]="".concat(t,"_").concat(n,"_").concat(r),e.zoomDataObj[n]=r,void localStorage.setItem("sheetZoom",JSON.stringify(i));i.push("".concat(t,"_").concat(n,"_").concat(r)),e.zoomDataObj[n]=r,localStorage.setItem("sheetZoom",JSON.stringify(i))}catch(t){}}}]),e}();Bl.zoomDataObj={},Bl.defaultZoom=1;var Vl,Hl=new rt.xQ,Ul=function(e){Vl=e},Zl=function(){return Vl&&Vl._context&&Vl._context.isEmbed()?"sheet@doc":"true"===al("isExcel")?"sheet_im_preview":"sheet"},Wl=function(){var e=window&&window.store&&window.store.getState();return("sheet"===Zl()?(0,M.default)(e,"sheet.toolbar.toggleNavBar.pickup",!1):Vl&&Vl._context&&Vl._context.isFullScreenMode())?"true":"false"},jl=function(){var e=window&&window.store&&window.store.getState();return(0,M.default)(e,"sheet.toolbar.isSingleRow",!1)?"true":"false"},Gl=function(){var e=Vl&&Vl._context&&Vl._context.token;return io.encryptTea(e)},zl=function(){Vl=null},Yl=function(e){var t,n;if("edit"!==e)return"read_only";var r=null===(t=window)||void 0===t||null===(n=t.store)||void 0===n?void 0:n.getState();return(0,M.default)(r,"sheet.permission.sheetPermission",!1)&&(0,M.default)(r,"sheet.permission.hasPermission",!1)?"edit":"read_only"},Xl=function(e){var t,n,r,i,o={};try{var a=(null===(i=Vl)||void 0===i?void 0:i.editable)?"edit":"read_only";o={sheet_type:Zl(),is_full_screen:Wl(),is_toolbar_fold:jl(),sheet_id:Gl(),table_id:e?io.encryptTea(e.id()):io.encryptTea(Vl&&Vl.getActiveSheet()&&Vl.getActiveSheet().id()),is_filter_view:!!(null===(t=Vl)||void 0===t||null===(n=t.getActiveSheet())||void 0===n||null===(r=n.viewsModel)||void 0===r?void 0:r.getActiveViewId()),user_sheet_file_permission:a,user_sheet_tab_permission:Yl(a)}}catch(e){console.info("getPubParams Error",e)}return o},Kl=function(){function e(){(0,c.Z)(this,e),this.events={}}return(0,a.Z)(e,[{key:"addListener",value:function(e,t){var n=this.events[e];return null==n?this.events[e]=[t]:n.push(t),this}},{key:"removeListener",value:function(e,t){var n=this.events[e];if(null!=n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}return this}},{key:"emit",value:function(e){for(var t=this.events[e],n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(null!=t)for(var o=0;o<t.length;o++)t[o].apply(t,r)}}]),e}(),ql=function(){function e(t){(0,c.Z)(this,e),this.defaultValue=t,this._subscriptionMaps=new Map,this._valueSubject$=new it.X(t),this._notifier$=this._valueSubject$.pipe((0,at.distinctUntilChanged)(),(0,st.T)(1))}return(0,a.Z)(e,[{key:"next",value:function(e){return this._valueSubject$.next(e)}},{key:"subscribe",value:function(e){var t=this._notifier$.subscribe(e);return this._subscriptionMaps.set(e,t),t}},{key:"unsubscribe",value:function(e){var t=this._subscriptionMaps.get(e);t&&t.unsubscribe()}},{key:"unsubscribeAll",value:function(){var e,t=ht(this._subscriptionMaps.values());try{for(t.s();!(e=t.n()).done;){e.value.unsubscribe()}}catch(e){t.e(e)}finally{t.f()}this._valueSubject$.next(this.defaultValue),this._valueSubject$.complete(),this._subscriptionMaps.clear()}},{key:"value",get:function(){return this._valueSubject$.value}}]),e}(),$l=function(){function e(){(0,c.Z)(this,e),this.promiseMap=new Map}return(0,a.Z)(e,[{key:"startTrack",value:function(e){if(this.promiseMap.has(e))return this.promiseMap.get(e).promise;var t,n=new Promise((function(e){t=e}));return this.promiseMap.set(e,{promise:n,resolver:t}),n}},{key:"endTrack",value:function(e,t){var n=this.promiseMap.get(e);n&&(this.promiseMap.delete(e),n.resolver&&n.resolver(t))}},{key:"waitMessageResolve",value:function(e){var t=this.promiseMap.get(e);return t?t.promise:Promise.reject(new Error("no waiting promise"))}},{key:"reset",value:function(){this.promiseMap.clear()}},{key:"destroy",value:function(){this.reset()}}]),e}();function Jl(e,t){var n=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return e.sort((function(e,r){return n.compare(t(e),t(r))}))}var Ql,ec=null,tc=null,nc=null;function rc(){return Boolean(ec)}function ic(e){nc=e}function oc(){if(rc())return Promise.resolve(ec);if(tc)return tc;if(!nc)return ec={getPinyin:function(e){return e}},Promise.resolve(ec);var e=null,t=new Promise((function(t,n){e=setTimeout((function(){rc()?t(ec):n("pinyin load timeout")}),1e4)})),n=nc.then((function(t){return e&&clearTimeout(e),ec=t.default}));return tc=Promise.race([n,t]).then((function(e){return ec=e})).catch((function(e){return console.error("load pinyin error: ",e),ec={getPinyin:function(e){return e}},e})),tc}var ac=function(){function e(){(0,c.Z)(this,e),this.strToPinyinCache=new Map,this.charToPinyinCache=new Map}return(0,a.Z)(e,[{key:"compare",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.tryToBePinyin(e).toLowerCase(),i=this.tryToBePinyin(t).toLowerCase();return r===i?n?this.compareStringByUnicode(e,t):0:r>i?1:-1}},{key:"tryToBePinyin",value:function(t){var n=this.strToPinyinCache.get(t);if(n)return n;for(var r="",i=0;i<t.length;i++){var o=t.charAt(i),a=t.charCodeAt(i);r+=a>=19968&&a<=40869?e.PREFIX_CHAR+this.translateToPinyin(o):o}return this.strToPinyinCache.set(t,r),r}},{key:"translateToPinyin",value:function(e){if(this.charToPinyinCache.get(e))return this.charToPinyinCache.get(e);if(!ec)return e;var t=ec.getPinyin(e,"",!1,!0);return this.charToPinyinCache.set(e,t),t}},{key:"compareStringByUnicode",value:function(e,t){var n=e.toLowerCase(),r=t.toLowerCase();return n===r?0:n>r?1:-1}},{key:"clearPinyinCache",value:function(){this.strToPinyinCache.clear(),this.charToPinyinCache.clear()}}]),e}();function sc(){Ql=new ac}function uc(){return Ql||sc(),Ql}ac.ASCII_DEL=127,ac.PREFIX_CHAR=String.fromCharCode(ac.ASCII_DEL);var lc,cc=function(e){return Mc()[e]},hc=function(e){e=e.toLowerCase();for(var t=Array.from(Oc()),n=0;n<t.length;n++)if(e===t[n][1].locale.toLowerCase())return t[n];return null},dc=function(e){var t=e.match(/(\[\$-([^\]]*)\])/);return t?t[2]:null},fc=function(e){var t=e.match(Ic());return t?t[1]:null},pc=function(e){return""===e?e:e.replace(/\"|\s|\./g,"")};function vc(){return"lark"===(0,M.default)(window,"User.settingsConfig.ccm_platform_tea_config.user_brand","feishu")}function gc(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=Ca(6),n=new Set(e);n.has(t);)t=Ca(6);return t}!function(e){e[e.valid=0]="valid",e[e.invalid=1]="invalid",e[e.length=2]="length",e[e.repeat=3]="repeat",e[e.empty=4]="empty"}(lc||(lc={}));!function(){var e=0}();function _c(e){return!!Array.isArray(e)&&e.some((function(e){return"url"===e.type}))}function yc(e){return new Promise((function(t,n){setTimeout(t,e)}))}function mc(e,t){return e.concat(t)}function Ec(e){var t=!1;if(1===e.length){var n=e[0].action;if("setSheet"===n){var r=e[0].value;t=!1===r.hidden&&"visibility"===r.property_name}else"moveSheet"===n&&(t=!0)}return t}var bc,Tc,Cc,Sc,wc,Rc=function(e,t,n,r){return r=r||" ",n=n||"","".concat(function(e,t){return"".concat(ja(t)).concat(e+1)}(e,t)).concat(n?r+n:"")},Ac=function(e,t){t=t||" ";var n=(e=e||"").indexOf(t);return-1!==n&&e.slice(n+1)||""},Oc=(0,m.Z)((function(){return new Map([["CNY",{symbol:"¥",position:Pn.prefix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_CNY"),canAutomatic:!0,defaultFormatterCode:"¥#,##0.00",locale:"zh-CN"}],["USD",{symbol:"$",position:Pn.prefix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_USD"),canAutomatic:!0,defaultFormatterCode:"$#,##0.00",locale:"en-US"}],["EUR",{symbol:"€",position:Pn.prefix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_EUR"),canAutomatic:!0,defaultFormatterCode:"€#,##0.00",locale:"x-euro2"}],["GBP",{symbol:"£",position:Pn.prefix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_GBP"),canAutomatic:!0,defaultFormatterCode:"£#,##0.00",locale:"en-GB"}],["JPY",{symbol:"¥",position:Pn.prefix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_JPY"),canAutomatic:!0,defaultFormatterCode:"¥#,##0.00",locale:"ja-JP"}],["AUD",{symbol:"$",position:Pn.prefix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_AUD"),canAutomatic:!0,defaultFormatterCode:"$#,##0.00",locale:"en-AU"}],["CAD",{symbol:"$",position:Pn.prefix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_CAD"),canAutomatic:!0,defaultFormatterCode:"$#,##0.00",locale:"en-CA"}],["CHF",{symbol:'"CHF"',position:Pn.prefix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_CHF"),canAutomatic:!1,defaultFormatterCode:'"CHF"#,##0.00',locale:"fr-CH"}],["HKD",{symbol:"$",position:Pn.prefix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_HKD"),canAutomatic:!0,defaultFormatterCode:"$#,##0.00",locale:"zh-HK"}],["SGD",{symbol:"$",position:Pn.prefix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_SGD"),canAutomatic:!0,defaultFormatterCode:"$#,##0.00",locale:"zh-SG"}],["SEK",{symbol:'" kr"',position:Pn.suffix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_SEK"),canAutomatic:!1,defaultFormatterCode:'#,##0.00" kr"',locale:"sv-SE"}],["KRW",{symbol:'"₩"',position:Pn.prefix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_KRW"),canAutomatic:!0,defaultFormatterCode:'"₩"#,##0.00',locale:"ko-KR"}],["NOK",{symbol:'" kr"',position:Pn.suffix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_NOK"),canAutomatic:!1,defaultFormatterCode:'#,##0.00" kr"',locale:"nn-NO"}],["NZD",{symbol:"$",position:Pn.prefix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_NZD"),canAutomatic:!0,defaultFormatterCode:"$#,##0.00",locale:"en-NZ"}],["INR",{symbol:'"₹ "',position:Pn.prefix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_INR"),canAutomatic:!0,defaultFormatterCode:'"₹ "#,##0.00',locale:"en-IN"}],["MXN",{symbol:"$",position:Pn.prefix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_MXN"),canAutomatic:!0,defaultFormatterCode:"$#,##0.00",locale:"es-MX"}],["TWD",{symbol:"$",position:Pn.prefix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_TWD"),canAutomatic:!0,defaultFormatterCode:"$#,##0.00",locale:"zh-TW"}],["ZAR",{symbol:'"R"',position:Pn.prefix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_ZAR"),canAutomatic:!1,defaultFormatterCode:'"R"#,##0.00',locale:"en-ZA"}],["BRL",{symbol:'"R$"',position:Pn.prefix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_BRL"),canAutomatic:!1,defaultFormatterCode:'"R$"#,##0.00',locale:"pt-BR"}],["DKK",{symbol:'" kr."',position:Pn.suffix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_DKK"),canAutomatic:!1,defaultFormatterCode:'#,##0.00" kr."',locale:"da-DK"}],["PLN",{symbol:'" zł"',position:Pn.suffix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_PLN"),canAutomatic:!1,defaultFormatterCode:'#,##0.00" zł"',locale:"pl-PL"}],["THB",{symbol:'"฿"',position:Pn.prefix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_THB"),canAutomatic:!0,defaultFormatterCode:'"฿"#,##0.00',locale:"th-TH"}],["ILS",{symbol:'"₪ "',position:Pn.prefix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_ILS"),canAutomatic:!0,defaultFormatterCode:'"₪ "#,##0.00',locale:"he-IL"}],["IDR",{symbol:'"Rp"',position:Pn.prefix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_IDR"),canAutomatic:!1,defaultFormatterCode:'"Rp"#,##0.00',locale:"id-ID"}],["CZK",{symbol:'" Kč"',position:Pn.suffix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_CZK"),canAutomatic:!1,defaultFormatterCode:'#,##0.00" Kč"',locale:"cs-CZ"}],["AED",{symbol:'" د.إ."',position:Pn.suffix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_AED"),canAutomatic:!1,defaultFormatterCode:'#,##0.00" د.إ."',locale:"ar-AE"}],["TRY",{symbol:'"₺"',position:Pn.prefix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_TRY"),canAutomatic:!0,defaultFormatterCode:'"₺"#,##0.00',locale:"tr-TR"}],["HUF",{symbol:'" Ft"',position:Pn.suffix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_HUF"),canAutomatic:!1,defaultFormatterCode:'#,##0.00" Ft"',locale:"hu-HU"}],["CLP",{symbol:"$",position:Pn.prefix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_CLP"),canAutomatic:!1,defaultFormatterCode:"$#,##0.00",locale:"es-CL"}],["SAR",{symbol:'"ر.س."',position:Pn.suffix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_SAR"),canAutomatic:!0,defaultFormatterCode:'#,##0.00"ر.س."',locale:"ar-SA"}],["PHP",{symbol:'"₱"',position:Pn.prefix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_PHP"),canAutomatic:!0,defaultFormatterCode:'"₱"#,##0.00',locale:"fil-PH"}],["MYR",{symbol:'"RM"',position:Pn.prefix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_MYR"),canAutomatic:!1,defaultFormatterCode:'"RM"#,##0.00',locale:"ms-MY"}],["COP",{symbol:"$",position:Pn.prefix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_COP"),canAutomatic:!0,defaultFormatterCode:"$#,##0.00",locale:"es-CO"}],["RUB",{symbol:'" ₽"',position:Pn.suffix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_RUB"),canAutomatic:!1,defaultFormatterCode:'#,##0.00" ₽"',locale:"ru-RU"}],["RON",{symbol:'" L"',position:Pn.suffix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_RON"),canAutomatic:!1,defaultFormatterCode:'#,##0.00" L"',locale:"ro-MD"}],["VND",{symbol:'" ₫"',position:Pn.suffix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_VND"),canAutomatic:!1,defaultFormatterCode:'#,##0.00" ₫"',locale:"vi-VN"}],["MOP",{symbol:"$",position:Pn.prefix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_MOP"),canAutomatic:!0,defaultFormatterCode:"$#,##0.00",locale:"zh-MO"}],["NPR",{symbol:'"रू"',position:Pn.prefix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_NPR"),canAutomatic:!1,defaultFormatterCode:'"रू"#,##0.00',locale:"ne-NP"}],["BDT",{symbol:'"৳"',position:Pn.suffix,name:ct("LarkCCM_Sheets_Currency_CurrencyName_BDT"),canAutomatic:!0,defaultFormatterCode:'#,##0.00"৳"',locale:"bn-BD"}]])})),Mc=(0,m.Z)((function(){var e={};return Oc().forEach((function(t,n){var r=t.symbol,i=t.canAutomatic;r=pc(r),!e[r]&&i&&(e[r]=n)})),e})),kc=(0,m.Z)((function(){var e=new Set;return Oc().forEach((function(t){var n=t.canAutomatic,r=t.symbol;n&&(r.includes("$")&&(r=r.replace("$","\\$")),e.add(pc(r)))})),"("+Array.from(e).join("|")+")"})),Ic=(0,m.Z)((function(){return new RegExp(kc())}));!function(e){e.Number="Number",e.Content="Content",e.Date="Date"}(bc||(bc={})),function(e){e.Is="Is",e.IsEmpty="IsEmpty",e.IsNotEmpty="IsNotEmpty",e.Contains="Contains",e.DoesNotContain="DoesNotContain",e.StartsWith="StartsWith",e.EndsWith="EndsWith",e.IsDuplicate="IsDuplicate",e.IsUnique="IsUnique"}(Tc||(Tc={})),function(e){e.IsYesterday="IsYesterday",e.IsToday="IsToday",e.IsTomorrow="IsTomorrow",e.IsTheLastSevenDays="IsTheLastSevenDays"}(Cc||(Cc={})),function(e){e.IsEqualTo="IsEqualTo",e.IsNotEqualTo="IsNotEqualTo",e.GreaterThan="GreaterThan",e.GreaterThanOrEqualTo="GreaterThanOrEqualTo",e.LessThan="LessThan",e.LessThanOrEqualTo="LessThanOrEqualTo",e.IsBetween="IsBetween",e.IsNotBetween="IsNotBetween"}(Sc||(Sc={})),function(e){e.IsTop="IsTop",e.IsBottom="IsBottom",e.AboveAverage="AboveAverage",e.BelowAverage="BelowAverage"}(wc||(wc={}));var xc,Nc=(K={},(0,g.Z)(K,wc.AboveAverage,"greaterThan"),(0,g.Z)(K,wc.BelowAverage,"lessThan"),K),Pc=(Q={},(0,g.Z)(Q,bc.Number,(q={},(0,g.Z)(q,Sc.IsEqualTo,"equal"),(0,g.Z)(q,Sc.IsNotEqualTo,"notEqual"),(0,g.Z)(q,Sc.GreaterThan,"greaterThan"),(0,g.Z)(q,Sc.GreaterThanOrEqualTo,"greaterThanOrEqual"),(0,g.Z)(q,Sc.LessThan,"lessThan"),(0,g.Z)(q,Sc.LessThanOrEqualTo,"lessThanOrEqual"),(0,g.Z)(q,Sc.IsBetween,"between"),(0,g.Z)(q,Sc.IsNotBetween,"notBetween"),q)),(0,g.Z)(Q,bc.Content,($={},(0,g.Z)($,Tc.Is,"is"),(0,g.Z)($,Tc.Contains,"containsText"),(0,g.Z)($,Tc.DoesNotContain,"notContains"),(0,g.Z)($,Tc.StartsWith,"beginsWith"),(0,g.Z)($,Tc.EndsWith,"endsWith"),$)),(0,g.Z)(Q,bc.Date,(J={},(0,g.Z)(J,Cc.IsYesterday,"is"),(0,g.Z)(J,Cc.IsToday,"is"),(0,g.Z)(J,Cc.IsTomorrow,"is"),(0,g.Z)(J,Cc.IsTheLastSevenDays,"is"),J)),Q),Lc=(ee={},(0,g.Z)(ee,Cc.IsToday,"today"),(0,g.Z)(ee,Cc.IsTomorrow,"tomorrow"),(0,g.Z)(ee,Cc.IsYesterday,"yesterday"),(0,g.Z)(ee,Cc.IsTheLastSevenDays,"last7Days"),ee);!function(e){e[e.Success=0]="Success",e[e.Fail=1]="Fail",e[e.Pending=2]="Pending",e[e.PermissionDeny=3]="PermissionDeny",e[e.Unsupported=4]="Unsupported",e[e.ContextTooLong=5]="ContextTooLong",e[e.MyAIStop=6]="MyAIStop",e[e.LongTimeToWait=7]="LongTimeToWait",e[e.TNS_AREA=13020]="TNS_AREA",e[e.TNS_BRAND=13021]="TNS_BRAND",e[e.TNS_OUTPUT=13031]="TNS_OUTPUT",e[e.TNS_INPUT=13030]="TNS_INPUT",e[e.UNSUPPORTED_FORMULA=20]="UNSUPPORTED_FORMULA"}(xc||(xc={}));var Dc,Fc=1e3,Bc=window.navigator.userAgent,Vc=/OpenHarmony/i.test(Bc),Hc=(null===(te=window.navigator)||void 0===te?void 0:te.maxTouchPoints)>=1||Vc;!function(e){e[e.NORMAL_CORNER=0]="NORMAL_CORNER",e[e.NORMAL_CORNER_V2=1]="NORMAL_CORNER_V2",e[e.CIRCLE_CORNER=2]="CIRCLE_CORNER",e[e.CIRCLE_CORNER_V2=3]="CIRCLE_CORNER_V2",e[e.MOBILE_FILL_CORNER=4]="MOBILE_FILL_CORNER"}(Dc||(Dc={}));var Uc,Zc,Wc,jc,Gc=Je().isPcWeb||Je().isFromSuperApp()&&!Je().isMobile,zc=function(){function e(){(0,c.Z)(this,e),this.dispose$=new rt.xQ}return(0,a.Z)(e,[{key:"dispose",value:function(){this.dispose$.next(),this.dispose$.complete()}}]),e}();!function(e){e[e.TRUE=1]="TRUE",e[e.FALSE=0]="FALSE"}(Uc||(Uc={})),function(e){e.DOC="DOC",e.SHEET="SHEET"}(Zc||(Zc={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.NO_EXISTS=1]="NO_EXISTS"}(Wc||(Wc={})),function(e){e.CREATING="CREATING",e.ERROR="ERROR",e.CREATED="CREATED"}(jc||(jc={}));var Yc=function(){function e(){(0,c.Z)(this,e),this.isUsingWorker=!1,this.spreadPivotTableCount=0,this.stagedSpreadEvents=[],this.stagedSheetEvents=[],this.spreadUnsubscriber=[]}return(0,a.Z)(e,[{key:"setSpread",value:function(e){var t=this;if(this.spread=e,this.spreadPivotTableCount=_u(e),this.stagedSpreadEvents.length>0){var n=this.getSpreadCommonOptions(),r=function(){t.consumeSpreadEvents(n)};e.sheetIdle.registerIdleCallback(r),this.spreadUnsubscriber.push((function(){e.sheetIdle.unRegisterIdleCallback(r)}))}if(this.stagedSheetEvents.length>0){var i=function(){t.consumeSheetEvents()};e.sheetIdle.registerIdleCallback(i),this.spreadUnsubscriber.push((function(){e.sheetIdle.unRegisterIdleCallback(i)}))}}},{key:"consumeSpreadEvents",value:function(e){var t=this;this.spread&&this.stagedSpreadEvents.forEach((function(n){var r=n.eventName,i=n.option;t.collectSpreadEvent(r,i,e)})),this.stagedSpreadEvents.length=0}},{key:"consumeSheetEvents",value:function(){var e=this;this.spread&&this.stagedSheetEvents.forEach((function(t){var n=t.eventName,r=t.option,i=t.sheet;e.collectSheetEvent(n,r,i)})),this.stagedSheetEvents.length=0}},{key:"setIsUsingWorker",value:function(e){this.isUsingWorker=e}},{key:"getSheetCommonOptions",value:function(e){var t;if(this.spread&&!(t=e||this.spread.getActiveSheet())._disposed){var n=0,r=0,i=0,o=0,a=0,s=0,u=0,l=0,c=0,h=0,d=0,f=io.getCpuPerformance().timeCost,p=io.getCpuPerformance().estimatedSpeed;if(t){var v,g=t.sheetFilterModel&&t.sheetFilterModel.getFilterRange();g&&(o=g.rowCount*g.colCount),a=t._getSpanModel().length,d=t.conditionalFormatModel.getAllRules().length>0?1:0,c=Object.keys(t.getChartMap()).length;var _=null===(v=t)||void 0===v?void 0:v.embeddedBlocksModel.getBlocksMap();(0,I.Z)(_)&&(h=Object.keys(_).length),i=(n=t.getRowCount())*(r=t.getColumnCount()),l=t.getValidationRefCount(),s=this.spread.getCalcEngine().formulaSpace.formulas.size,u=this.spread.getCalcEngine().formulaRefManager.getNodeCount()}return{row_count:n,col_count:r,cell_count:i,span_count:a,filter_cell_count:o,formula_count:s,validation_ref_count:l,has_condition:d,has_chart:c>0?1:0,chart_count:c,sheet_pivot_table_count:h,spread_pivot_table_count:this.spreadPivotTableCount,has_pivot_table:this.spreadPivotTableCount>0?1:0,is_pivot_table_v2:1,aggregate_count:u,timeCostCpu:f,estimatedSpeed:p,using_worker:Number(this.isUsingWorker)}}}},{key:"getSpreadCommonOptions",value:function(){if(this.spread){var e=this.spread.sheets.length,t=this.spread.getBitableBlockNum(),n=this.spread.getCalcEngine().formulaSpace.formulas.size,r=io.getCpuPerformance().timeCost,i=io.getCpuPerformance().estimatedSpeed,o=0;return{sheetNum:e,total_cell_count:this.spread.sheets.reduce((function(e,t){var n=t.getRowCount()*t.getColumnCount();return o=Math.max(o,n),e+n}),0),max_sheet_cell_count:o,bitable_block_num:t,formula_count:n,spread_pivot_table_count:this.spreadPivotTableCount,has_pivot_table:this.spreadPivotTableCount>0?1:0,timeCostCpu:r,estimatedSpeed:i,using_worker:Number(this.isUsingWorker)}}}},{key:"collectSheetEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;if(this.spread){var r=this.getSheetCommonOptions(n);io.collectSuiteEvent(e,Object.assign({},r,{},t))}else this.stagedSheetEvents.push({eventName:e,option:t})}},{key:"collectSpreadEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;this.spread?io.collectSuiteEvent(e,Object.assign({},n||this.getSpreadCommonOptions(),{},t)):this.stagedSpreadEvents.push({eventName:e,option:t})}},{key:"captureException",value:function(e,t){io.moirae.ravenCatch(e,{tags:t})}},{key:"destroy",value:function(){this.consumeSpreadEvents(this.getSpreadCommonOptions()),this.consumeSheetEvents(),this.spreadUnsubscriber.forEach((function(e){return e()})),this.spreadUnsubscriber.length=0,this.spread=null}},{key:"eventReport",value:function(e){io.moirae.teaLog(e)}}]),e}(),Xc=new Yc,Kc="sheet_lifetime",qc="open_after_one_minute",$c={jsHeapSizeLimit:0,totalJSHeapSize:0,usedJSHeapSize:0},Jc=function(){var e=window.performance&&window.performance.memory;return e?{jsHeapSizeLimit:e.jsHeapSizeLimit,totalJSHeapSize:e.totalJSHeapSize,usedJSHeapSize:e.usedJSHeapSize}:$c},Qc=!1,eh=[];var th,nh,rh=function(e){return parseFloat((e/1024).toFixed())},ih="sheet_performance_memory",oh=function(){function e(){var t=this;(0,c.Z)(this,e),this.spread=null,this.sceneMap=new Map,this.subscriber=null,this.handleLogSceneEnd=function(){return t.logSceneEnd(Kc,!0)},this.logMemoryBeforeExec=function(e){e&&e.commandName&&t.logSceneBegin(e.commandName)},this.logMemoryAfterExec=function(e){e&&e.commandName&&t.logSceneEnd(e.commandName,!1,{cs_count:e.changesets&&e.changesets.length})}}return(0,a.Z)(e,[{key:"bindEvents",value:function(){"undefined"!=typeof window&&window.addEventListener("beforeunload",this.handleLogSceneEnd)}},{key:"unbindEvents",value:function(){"undefined"!=typeof window&&window.removeEventListener("beforeunload",this.handleLogSceneEnd)}},{key:"beginTracker",value:function(){var e=this;this.logSceneBegin(Kc),this.logSceneBegin(qc),setTimeout((function(){e.logSceneEnd(qc,!0)}),6e4)}},{key:"logSceneBegin",value:function(e,t){var n=window.performance.now(),r=Jc();if(this.sceneMap.has(e)){var i=this.sceneMap.get(e);this.sceneMap.set(e,Object.assign({},i,{begin:n},r,{eventParams:t}))}else this.sceneMap.set(e,Object.assign({begin:n},r,{eventParams:t}))}},{key:"logSceneEnd",value:function(e,t,n){if(!this.sceneMap.has(e))return console.warn("event ".concat(e," doesn't exsit")),this.sceneMap.delete(e);var r=Jc(),i=this.sceneMap.get(e)||{},o=Object.assign({scene_name:e,duration:void 0!==i.begin?window.performance.now()-i.begin:0,totalJSHeapSizeDelta:rh(r.totalJSHeapSize-i.totalJSHeapSize),usedJSHeapSizeDelta:rh(r.usedJSHeapSize-i.usedJSHeapSize),totalJSHeapSize:rh(r.totalJSHeapSize),usedJSHeapSize:rh(r.usedJSHeapSize)},i.eventParams,{},n);if(t&&this.spread&&this.spread.sheets){var a=this.spread.sheets.reduce((function(e,t){return 2===t.loadStatus?e+1:e}),0),s=this.spread.sheets.reduce((function(e,t){return t.loaded?t.getRowCount()*t.getColumnCount()+e:e}),0),u=Number((a/this.spread.sheets.length).toFixed(3));o=Object.assign({},o,{},Xc.getSheetCommonOptions(),{loadedSheetCount:a,loadedSheetCellCount:s,loadingPercent:u})}return Qc?eh.push((function(){return Xc.collectSpreadEvent(ih,o)})):Xc.collectSpreadEvent(ih,o),this.sceneMap.delete(e)}},{key:"setup",value:function(e){e&&(this.spread!==e&&this.destroy(),this.bindEvents(),this.subscriber=e.subscribe({CommandExecuting:this.logMemoryBeforeExec,CommandExecuted:this.logMemoryAfterExec}),this.spread=e)}},{key:"destroy",value:function(){var e;this.spread&&(eh.forEach((function(e){e&&e.apply(null)})),eh.length=0,this.unbindEvents(),null!==(e=this.subscriber)&&void 0!==e&&e.unsubscribe(),this.subscriber=null,this.spread=null,this.logSceneEnd(Kc,!0),this.sceneMap.clear())}}]),e}(),ah=new oh;!function(e){e.LOAD_SHEET_PAGE="load_sheet_page",e.RENDER_SHEET_PAGE="render_sheet_page",e.RENDER_SHEET_SSR_BEFORE_MOUNT="render_sheet_ssr_before_mount",e.RENDER_SHEET_SSR_MOUNT="render_sheet_ssr_mount",e.RENDER_SHEET_SSR_MOUNTED="render_sheet_ssr_mounted",e.DOWNLOAD_RESOURCE="download_resource",e.FETCH_CLIENT_VARS="fetch_client_vars",e.UNGZIP_CLIENT_VARS="ungzip_client_vars",e.APPLY_SNAPSHOT="apply_snapshot",e.RENDER_FIRST_PRINT="render_first_print",e.FETCH_SUB_BLOCK="fetch_sub_block",e.FASTER_FIRST_TICK="faster_first_tick",e.TIME_TO_USAGE="time_to_usage",e.EDITOR_TIME_TO_USAGE="editor_time_to_usage",e.TOOLBAR_TIME_TO_USAGE="toolbar_time_to_usage",e.WINDOW_LOADED="window_loaded",e.INDEXDB_LOCAL_CHECK="INDEXDB_LOCAL_CHECK",e.INDEXDB_LOCAL_REV_CHECK="INDEXDB_LOCAL_REV_CHECK",e.CONNECT_WEBSOCKET="connect_websocket",e.FAB_FIRST_VISIBLE="fab_first_visible",e.INIT_CALC="init_calc",e.APPLY_DATA="apply_data",e.KEYBOARD_EDIT="keyboard_edit",e.TOOLKIT_EDIT="toolkit_edit",e.DROPDOWN_EDIT="dropdown_edit",e.STAGE_PENDING="stage_pending",e.HISTORY_INIT="history_init",e.HISTORY_PREVIEW="history_preview",e.HISTORY_RECOVER="history_recover",e.SHEET_LOADED="client_sheet_loaded",e.SHEET_APPLY_CS="client_sheet_apply_cs",e.TRANSLATION_ENTER="translation_enter",e.SHEET_TRANSLATION="sheet_translation",e.SCROLL_TRANSLATION="scroll_translation",e.DATA_CHANGE_TRANSLATION="data_change_translation",e.TRANSLATION_RESET_LANG="translation_reset_lang",e.TRANSLATION_REQUEST="translation_request",e.GET_RESPONSABLE_RANGE="get_responsable_range",e.LOAD_DOC_SHEET_RESOURCE="load_doc_sheet_resource",e.CALL_BRIDGE_TO_MOUNT_SHEET="call_bridge_to_mount_sheet",e.RENDER_EMBED_SHEET_COMP="render_embed_sheet_comp",e.FIRST_WORKSHEET_IN_QUEUE_LOADED="first_worksheet_in_queue_loaded",e.ACTIVE_CELL_CHANGE="active_cell_change",e.SET_FILTER="set_filter",e.SET_FILTER_MODE="set_filter_mode",e.ENTER_FILTER_PERSONAL="enter_filter_personal",e.EXIT_FILTER_PERSONAL="exit_filter_personal",e.SEARCH="search",e.REPLACE="replace",e.PIVOT_TABLE_FIRST_RENDER="pivot_table_first_render",e.CLIPBOARD_PASTE="clipboard_paste",e.GET_PASTE_INFO="get_paste_info",e.CLIPBOARD_COPY="clipboard_copy",e.SERIALIZE_COPY_DATA="serialize_copy_data",e.ENTER_EDIT="enter_edit",e.DATA_CLEAN_GET_DUPLICATIONS="data_clean_get_duplications",e.CONTEXT_MENU_LOAD="context_menu_load",e.SELECTION_RANGE_CALC="selection_range_calc",e.BUILD_SHEET_FORMULA_TREE="build_sheet_formula_tree",e.SCROLL_TO_LINK_RANGE="scroll_to_link_range",e.HISTORY_SHEET_TO_USAGE="history_sheet_to_usage",e.HISTORY_SHEET_TO_USAGE_VIEW="history_sheet_to_usage_view",e.GENERATE_THUMBNAIL="generate_thumbnail",e.ALONE_HISTORY_BACK_T0_MAIN="history_back_to_main",e.FETCH_SHEET_PROTECTION="fetch_sheet_protection"}(th||(th={})),function(e){e[e.START=0]="START",e[e.END=1]="END",e[e.ERROR=2]="ERROR"}(nh||(nh={}));var sh,uh,lh,ch="sheet_translate_performance_stage",hh=(ne={},(0,g.Z)(ne,th.TRANSLATION_ENTER,ch),(0,g.Z)(ne,th.SHEET_TRANSLATION,ch),(0,g.Z)(ne,th.SCROLL_TRANSLATION,ch),(0,g.Z)(ne,th.DATA_CHANGE_TRANSLATION,ch),(0,g.Z)(ne,th.TRANSLATION_RESET_LANG,ch),(0,g.Z)(ne,th.TRANSLATION_REQUEST,ch),ne),dh=[],fh={},ph=!0,vh=function(e){var t=e.toUpperCase();return!!th[t]&&!["KEYBOARD_EDIT","TOOLKIT_EDIT","DROPDOWN_EDIT"].includes(t)},gh=(0,y.default)((function(){dh.forEach((function(e){e&&e.apply(null)})),dh.length=0}),2e3);function _h(e){var t,n=0,r=ht(e.sheets);try{for(r.s();!(t=r.n()).done;){n+=t.value.getValidationRefCount()}}catch(e){r.e(e)}finally{r.f()}return n}function yh(){ph=!1,fh={}}function mh(){return ph?"reload":"router"}function Eh(){var e,t,n=(null===(e=(t=window.performance).getEntriesByType)||void 0===e?void 0:e.call(t,"navigation"))||[];if(n.length>0&&ph){var r=n[0].fetchStart;sh=r}else sh=performance.now()}function bh(e,t,n,r){var i=hh[e]||"sheet_performance_stage",o=(n=n||{}).transactionId?"_".concat(n.transactionId):"";n.isSheetGarrEnable=1;var a=e===th.DOWNLOAD_RESOURCE||e===th.RENDER_SHEET_PAGE||e===th.LOAD_SHEET_PAGE||e===th.TIME_TO_USAGE||e===th.WINDOW_LOADED,s=e===th.DOWNLOAD_RESOURCE,u=performance.now(),l=window;if(a)if(io.browser.isMobile){if(s&&(!l.renderStartTS||!l.tapVisitStartTS))return;n.open_from=l.renderStartTS-l.tapVisitStartTS>=500?"reload":"router"}else n.open_from=mh();var c=function(t){var c=fh["".concat(e,"_start").concat(o)];if(c){var h;if(u>c)h=Math.round(u-c);else{var d=(0,M.default)(performance,"timing.navigationStart",0);h=Math.round(u+d-c)}h=n.costTime?n.costTime:s&&l.tapVisitStartTS&&l.renderStartTS?l.renderStartTS-l.tapVisitStartTS:h,a&&(n.total_time_cost=Math.round(u-sh)),vh(e)?(e===th.TIME_TO_USAGE?window.sheet_time_to_suage=h:e===th.RENDER_SHEET_PAGE&&(window.sheet_render_page_time_cost=h),dh.push((function(){Xc.collectSheetEvent("sheet_performance_operation",Object.assign({operation:"".concat(e,"_").concat(t)},n)),Xc.collectSheetEvent(i,Object.assign({stage:e,type:t,time_cost:h},n)),r&&r(Object.assign({time_cost:h},n))})),gh()):(Xc.collectSheetEvent("sheet_performance_operation",Object.assign({operation:"".concat(e,"_").concat(t)},n)),Xc.collectSheetEvent(i,Object.assign({stage:e,type:t,time_cost:h},n)),r&&r(Object.assign({time_cost:h},n))),"error"===t&&console.info("[SHEET LOG] render-node-log: ".concat(e," error")),delete fh["".concat(e,"_start").concat(o)],ah.logSceneEnd(e,!1,n)}};if(0===t){var h=u;(a||s)&&(h=io.browser.isMobile&&l.tapVisitStartTS?l.tapVisitStartTS:sh||u),fh["".concat(e,"_start").concat(o)]=h,vh(e)?(dh.push((function(){Xc.collectSheetEvent("sheet_performance_operation",Object.assign({operation:"".concat(e,"_start")},n))})),gh()):Xc.collectSheetEvent("sheet_performance_operation",Object.assign({operation:"".concat(e,"_start")},n)),ah.logSceneBegin(e,n)}else 1===t?c("success"):2===t&&c("error")}!function(e){e.DOC_IMAGE="doc_image",e.DRIVE_IMAGE="drive_image"}(uh||(uh={})),function(e){e.RESOLVED="resolved",e.REJECTED="rejected"}(lh||(lh={}));var Th,Ch=function(){function e(t){(0,c.Z)(this,e),this.imageType=t,this._resolvedImageCount=0,this._totalTimeCost=0,this._rejectedImageCount=0,this.collectResolvedImagesInfoBatchly=(0,y.default)(this.collectResolvedImagesInfo,3e3),this.collectRejectedImagesInfoBatchly=(0,y.default)(this.collectRejectedImagesInfo,3e3)}return(0,a.Z)(e,[{key:"collectResolvedImagesInfo",value:function(){0!==this._resolvedImageCount&&(io.collectSuiteEvent("sheet_image_monitor",{status:"resolved",image_type:this.imageType,count:this._resolvedImageCount,total_time_cost:this._totalTimeCost}),this._resolvedImageCount=0,this._rejectedImageCount=0)}},{key:"collectRejectedImagesInfo",value:function(){0!==this._rejectedImageCount&&(io.collectSuiteEvent("sheet_image_monitor",{status:"rejected",image_type:this.imageType,count:this._rejectedImageCount}),this._rejectedImageCount=0)}},{key:"collectImageError",value:function(e){}},{key:"onImageResolve",value:function(e){var t=e.timeCost;this._totalTimeCost+=t,++this._resolvedImageCount,this.collectResolvedImagesInfoBatchly()}},{key:"onImageReject",value:function(e){var t=e.ex;++this._rejectedImageCount,this.collectImageError(t),this.collectRejectedImagesInfoBatchly()}}]),e}(),Sh=new Ch("doc_image"),wh=new Ch("drive_image");function Rh(e,t){return e?"undo":t?"do":"redo"}!function(e){e.Do="do",e.Redo="redo",e.Undo="undo"}(Th||(Th={}));var Ah=function(e,t){var n=e.sheet,r=0,i=0;if(n){var o=n.getSelections();if(Array.isArray(o)){var a,s=ht(o.values());try{for(s.s();!(a=s.n()).done;){var u=a.value;r+=u.rowCount()*u.colCount()}}catch(e){s.e(e)}finally{s.f()}}e.commandName===Zn.FILL&&(i=n.getSelections().reduce((function(e,t){return e+n.getFormulaCountByRange(t)}),0))}var l={time_cost:e.rangeTime,command_name:e.commandName,selected_cell_count:r,selection_formula_count:i,changeset_count:e.changesets.length,executeType:e.executeType};Object.assign(l,t),Xc.collectSheetEvent("client_performance_command",l,n)};var Oh,Mh,kh=Symbol("single"),Ih=function(){function e(){var t=this;(0,c.Z)(this,e),this.logStack=[],this.onSheetStartLoad=function(e){bh(th.SHEET_LOADED,0,{transactionId:e})},this.onBlockDataReady=function(){bh(th.FETCH_SUB_BLOCK,1)},this.validateBlockRequest=function(e,t){e.schema_version?t.some((function(e){return/[A..Z]$/.test(e)}))&&io.moirae.teaLog({key:"client_sheet_sub_block_token_invalid",schema_version:e.schema_version||0}):t.some((function(e){return/[a..z]$/.test(e)}))&&io.moirae.teaLog({key:"client_sheet_sub_block_token_invalid",schema_version:e.schema_version||0})},this.blockReqError=function(e,t){var n;if(e instanceof Error&&!function(e){return!(!e||!e.__CANCEL__)}(e)?n=e.message:(!e||e.code&&0!==e.code)&&(n=e||""),void 0!==n){var r={};return r.requestId=t,r.codeServer=(e||{}).code,r.msgServer=(e||{}).msg,r}},this.timer=setInterval((function(){t.uploadLog()}),3e4)}return(0,a.Z)(e,[{key:"log",value:function(){try{for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logStack.push(JSON.stringify(t))}catch(t){console.error("args 存在非结构化对象")}}},{key:"uploadLog",value:function(){this.logStack.length&&io.moirae.teaLog({key:"client_sheet_block_data_tracker",bmLog:this.logStack.join("\n")}),this.logStack=[]}},{key:"clear",value:function(){this.logStack.length>0&&this.uploadLog(),this.timer&&clearInterval(this.timer),this.timer=void 0}},{key:"onSpreadLoaded",value:function(){this.clear()}},{key:"onInitError",value:function(e){this.log.apply(this,["onInitError"].concat(Array.prototype.slice.call(arguments)))}},{key:"onTaskDoneError",value:function(e){this.log.apply(this,["onTaskDoneError"].concat(Array.prototype.slice.call(arguments)))}},{key:"onFetchSubBlocks",value:function(e){this.log.apply(this,["onFetchSubBlock"].concat(Array.prototype.slice.call(arguments)))}},{key:"onFetchSubBlocksError",value:function(e){this.log.apply(this,["onFetchSubBlocksError"].concat(Array.prototype.slice.call(arguments)))}},{key:"onParseBlockOffsetError",value:function(e){this.log.apply(this,["onParseBlockOffsetError"].concat(Array.prototype.slice.call(arguments)))}},{key:"markSheetLoaded",value:function(e,t,n){this.log.apply(this,["markSheetLoaded"].concat(Array.prototype.slice.call(arguments)))}},{key:"onDestroy",value:function(){this.log.apply(this,["onDestroy"].concat(Array.prototype.slice.call(arguments)))}},{key:"onRequestSheets",value:function(e){this.log.apply(this,["onRequestSheets"].concat(Array.prototype.slice.call(arguments)))}},{key:"onRequestBlocks",value:function(e){this.log.apply(this,["onRequestBlocks"].concat(Array.prototype.slice.call(arguments)))}},{key:"onSetBlockRowCount",value:function(e,t){this.log.apply(this,["onSetBlockRowCount"].concat(Array.prototype.slice.call(arguments)))}},{key:"onSetBlockRowCountFail",value:function(){this.log.apply(this,["onSetBlockRowCountFail"].concat(Array.prototype.slice.call(arguments)))}},{key:"onRowDataApplied",value:function(e,t){}},{key:"onRowDataAppliedFail",value:function(){this.log.apply(this,["onRowDataAppliedFail"].concat(Array.prototype.slice.call(arguments)))}},{key:"onDataApplied",value:function(e){this.log.apply(this,["onDataApplied"].concat(Array.prototype.slice.call(arguments)))}},{key:"onTaskCallback",value:function(e){this.log.apply(this,["onTaskCallback"].concat(Array.prototype.slice.call(arguments)))}},{key:"onSheetLoaded",value:function(e){this.log.apply(this,["onSheetLoaded"].concat(Array.prototype.slice.call(arguments)))}},{key:"onLoadSingleSheetData",value:function(e){this.log.apply(this,["onLoadSingleSheetData"].concat(Array.prototype.slice.call(arguments)))}},{key:"onCandidateTasksNum",value:function(e){this.log.apply(this,["onCandidateTasksNum"].concat(Array.prototype.slice.call(arguments)))}},{key:"onPendingTaskCount",value:function(e){this.log.apply(this,["onPendingTaskCount"].concat(Array.prototype.slice.call(arguments)))}},{key:"onRun",value:function(){this.log.apply(this,["onRun"].concat(Array.prototype.slice.call(arguments)))}},{key:"onInitBlock",value:function(e,t,n){this.log.apply(this,["onInitBlock"].concat(Array.prototype.slice.call(arguments)))}},{key:"onInitSheetBlock",value:function(e){this.log.apply(this,["onInitSheetBlock"].concat(Array.prototype.slice.call(arguments)))}},{key:"onBlockRequesterStart",value:function(){this.log.apply(this,["onBlockRequesterStart"].concat(Array.prototype.slice.call(arguments)))}},{key:"onFetchStart",value:function(e,t,n,r){this.log.apply(this,["onFetchStart"].concat(Array.prototype.slice.call(arguments)))}},{key:"onTasksEnd",value:function(e,t,n){this.log.apply(this,["onTasksEnd"].concat(Array.prototype.slice.call(arguments)))}},{key:"onNoIdleTask",value:function(){this.log.apply(this,["onNoIdleTask"].concat(Array.prototype.slice.call(arguments)))}},{key:"onRunCandidateTask",value:function(e,t){this.log.apply(this,["onRunCandidateTask"].concat(Array.prototype.slice.call(arguments)))}},{key:"onAggregateTask",value:function(e){this.log.apply(this,["onAggregateTask"].concat(Array.prototype.slice.call(arguments)))}},{key:"onTaskDone",value:function(e,t,n){this.log.apply(this,["onTaskDone"].concat(Array.prototype.slice.call(arguments)))}},{key:"onAddTask",value:function(e,t){this.log.apply(this,["onAddTask"].concat(Array.prototype.slice.call(arguments)))}},{key:"onUpdateQueue",value:function(e,t){this.log("onUpdateQueue","queue: ".concat(e,", length: ").concat(t))}},{key:"onCancelApplyCS",value:function(e,t){this.log("onCancelApplyCS","cancelCount: ".concat(e,", remain: ").concat(t))}},{key:"onFollowError",value:function(e){this.log.apply(this,["onFollowError"].concat(Array.prototype.slice.call(arguments)))}},{key:"onBlockChannelNotReady",value:function(){this.log("onBlockChannelNotReady")}},{key:"onAnalysisActionSheetDep",value:function(e,t){this.log("onAnalysisActionSheetDep","depLength: ".concat(e," hasChannel: ").concat(t))}},{key:"onGetBackRefBySheetId",value:function(e){this.log.apply(this,["onGetBackRefBySheetId: "].concat(Array.prototype.slice.call(arguments)))}},{key:"destroy",value:function(){this.clear()}}],[{key:"instance",get:function(){return this[kh]?this[kh]:this[kh]=new this}}]),e}(),xh=[],Nh="",Ph=function(e){return{stage:e,now:Date.now()}},Lh=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if("start"===e)return xh=[Ph("start")],void(Nh=t);var n=xh[0];if(n&&"start"===n.stage)if("end"===e)xh.push(Ph("end")),(0,_.Z)(xh,(function(e,t){return Dh("editor_".concat(e.stage),t.now-e.now,Nh),t})),xh=[],Nh="";else{var r=Ph(e),i=(0,O.Z)(xh,(function(t){return t.stage===e}));i?i.now=r.now:xh.push(r)}},Dh=function(e,t,n){io.collectSuiteEvent("sheet_performance_stage",{stage:e,time_cost:t,from:n})},Fh="sheet_pivot_table_performance";!function(e){e.Success="success",e.Error="error"}(Oh||(Oh={})),function(e){e.RENDER_VIEW="RENDER_VIEW",e.CALCULATE_CACHE="CALCULATE_CACHE",e.CALCULATE_CUBE="CALCULATE_CUBE",e.CALCULATE_VIEW="CALCULATE_VIEW",e.CALCULATE_FORMULA="CALCULATE_FORMULA",e.TIME_TO_VISIT="TIME_TO_VISIT",e.TIME_TO_USAGE="TIME_TO_USAGE"}(Mh||(Mh={}));var Bh={},Vh=function(e){delete Bh[e]};function Hh(e){var t,n,r,i;return Number(((null!==(t=e.calculate_cache_time_cost)&&void 0!==t?t:0)+(null!==(n=e.calculate_cube_time_cost)&&void 0!==n?n:0)+(null!==(r=e.calculate_view_time_cost)&&void 0!==r?r:0)+(null!==(i=e.render_view_time_cost)&&void 0!==i?i:0)).toFixed(2))}var Uh,Zh,Wh=function(){function e(){(0,c.Z)(this,e),this.pendingTrackerInfo={}}return(0,a.Z)(e,[{key:"eventReport",value:function(e){io.collectSheetEvent(Fh,Object.assign({},e,{},Xc.getSheetCommonOptions(),{},this.getPivotCommonData(e.pivot_name),{pivot_name:io.encryptTea(e.pivot_name)}))}},{key:"reportAllPivotPerformance",value:function(e){io.collectSheetEvent(Fh,Object.assign({},e,{},Xc.getSheetCommonOptions(),{},this.getAllPivotCommonData()))}},{key:"setSpread",value:function(e){this.spread=e}},{key:"collectSuiteEvent",value:function(e,t){var n=null==t?void 0:t.pivot_name;n?io.collectSuiteEvent(e,Object.assign({},t,{},this.getPivotCommonData(n),{pivot_name:io.encryptTea(n)})):io.collectSuiteEvent(e,t)}},{key:"getPivotCommonData",value:function(e){var t,n;if(this.spread&&e){var r=null===(t=this.spread.getPivotDataSourceManager())||void 0===t?void 0:t.getSourceRange(e);return{source_range_size:null==r?void 0:r.size(),data_source:io.encryptTea(null!==(n=null==r?void 0:r.toString({isShowSheetName:!0,ref:r}))&&void 0!==n?n:"")}}}},{key:"getAllPivotCommonData",value:function(){if(!this.spread)return null;var e=this.spread.getPivotDataSourceManager(),t=this.spread.getActiveSheet().embeddedBlocksModel.getBlocksMap(),n=0,r=0;return Object.keys(t).forEach((function(t){var i=null==e?void 0:e.getSourceRange(t),o=null==i?void 0:i.size();o&&(n+=o,r++)})),r>0?{average_source_range_size:n/r,total_source_range_size:n}:{}}},{key:"reportPendingTrackData",value:function(e,t){if(this.pendingTrackerInfo){var n=t,r=this.pendingTrackerInfo[e];r&&(Object.assign(n,r,{calculate_formula_time_cost:Hh(r)}),this.eventReport(n),delete this.pendingTrackerInfo[e])}}},{key:"fromPendingTrackerInfo",value:function(e){var t={},n={};e.forEach((function(e){if(0===e.status)n[e.stage]={},n[e.stage].startTime=e.time;else if(1===e.status||2===e.status){var r,i=e.stage,o=null==n||null===(r=n[i])||void 0===r?void 0:r.startTime;if(o){var a=Number((e.time-o).toFixed(2));Object.assign(t,function(e,t){var n={key:Fh,sub_event_name:"calc_stage_event",pivot_name:e.pivotName},r=e.stage.toLowerCase();return n["".concat(r,"_time_cost")]=t,n["".concat(r,"_result")]=1===e.status?Oh.Success:Oh.Error,n}(e,a))}}else e.collectData&&Object.assign(t,e.collectData)})),this.pendingTrackerInfo[t.pivot_name]||(this.pendingTrackerInfo[t.pivot_name]={}),Object.assign(this.pendingTrackerInfo[t.pivot_name],t)}},{key:"collect",value:function(e,t,n){var r=performance.now();if(0===t)this.pendingTrackerInfo["".concat(e,"_start:").concat(n)]={startTime:r};else if(1===t){var i,o=null===(i=this.pendingTrackerInfo["".concat(e,"_start:").concat(n)])||void 0===i?void 0:i.startTime;if(!o)return;var a=Number((r-o).toFixed(2));this.eventReport({key:Fh,sub_event_name:e,pivot_name:n,duration_time:a}),delete this.pendingTrackerInfo["".concat(e,"_start:").concat(n)]}}},{key:"destroy",value:function(){this.pendingTrackerInfo={}}}]),e}(),jh=new Wh,Gh=function(){function e(){(0,c.Z)(this,e),this.map=new Map}return(0,a.Z)(e,[{key:"subscribe",value:function(e,t){return void 0===t?this.subscribeDepend(e):this.subscribeEvent(e,t)}},{key:"subscribeDepend",value:function(e){var t=this;return Object.keys(e).forEach((function(n){t._subscribe(n,e[n])})),new ot.w((function(){Object.keys(e).forEach((function(n){t.unsubscribe(n,e[n])}))}))}},{key:"subscribeEvent",value:function(e,t){var n=this;return this._subscribe(e,t),new ot.w((function(){n.unsubscribe(e,t)}))}},{key:"dispatch",value:function(e,t,n,r){if(0!==this.map.size){var i=this.map.get(e);void 0!==i&&i.forEach((function(e){e(t,n,r)}))}}},{key:"destroy",value:function(){this.map.clear()}},{key:"_subscribe",value:function(e,t){if("function"==typeof t){var n=this.map.get(e);void 0===n&&(n=new Set,this.map.set(e,n)),n.add(t)}}},{key:"unsubscribe",value:function(e,t){var n=this.map.get(e);void 0!==n&&n.delete(t)}}]),e}(),zh={options:{},nested:{Commands:{fields:{commands:{rule:"repeated",type:"Command",id:1}}},SimpleCommands:{fields:{commands:{rule:"repeated",type:"SimpleCommand",id:1}}},Command:{fields:{type:{type:"CommandType",id:1},mutations:{rule:"repeated",type:"Mutation",id:2},sheetId:{type:"string",id:3},resourceRefs:{type:"CommandResourceRefs",id:4}}},SimpleCommand:{fields:{type:{type:"CommandType",id:1},mutations:{rule:"repeated",type:"SimpleMutation",id:2},sheetId:{type:"string",id:3},resourceRefs:{type:"bytes",id:4}}},CommandType:{values:{CommandType_UNSPEDIFIED:0,CommandType_TOP_SNAPSHOT:1,CommandType_RESOURCE_SNAPSHOT:2,CommandType_TABLE_SNAPSHOT:3}},CommandResourceRefs:{fields:{filterStrings:{rule:"repeated",type:"string",id:1},dateGroupItems:{rule:"repeated",type:"DateGroupItem",id:2}}},Mutation:{oneofs:{mutationOneof:{oneof:["setWorkbookProperties","insertSheet","deleteSheet","moveSheet","setSheetProperties","setDimensionProperties","insertDimension","deleteDimension","mergeCells","unmergeCells","setRangeValues","setCellValues","mapRange","reorderRange","addWorkbookRange","updateWorkbookRange","deleteWorkbookRange","addComment","addReminder","updateReminder","deleteReminder","addRangeProtection","updateRangeProtection","deleteRangeProtection","setSheetProtection","removeSheetProtection","addConditionalFormatting","updateConditionalFormatting","deleteConditionalFormatting","moveConditionalFormatting","setAutoFilter","removeAutoFilter","addCustomView","updateCustomView","deleteCustomView","addFloatImage","updateFloatImage","deleteFloatImage","addFloatBlock","updateFloatBlock","deleteFloatBlock","addEmbeddedBlock","updateEmbeddedBlock","deleteEmbeddedBlock","addSparklineGroup","updateSparklineGroup","deleteSparklineGroup","setChartMap","addCalcResult"]}},fields:{type:{type:"MutationType",id:1},setWorkbookProperties:{type:"SetWorkbookPropertiesMutation",id:2},insertSheet:{type:"InsertSheetMutation",id:3},deleteSheet:{type:"DeleteSheetMutation",id:4},moveSheet:{type:"MoveSheetMutation",id:5},setSheetProperties:{type:"SetSheetPropertiesMutation",id:6},setDimensionProperties:{type:"SetDimensionPropertiesMutation",id:7},insertDimension:{type:"InsertDimensionMutation",id:8},deleteDimension:{type:"DeleteDimensionMutation",id:9},mergeCells:{type:"MergeCellsMutation",id:10},unmergeCells:{type:"UnmergeCellsMutation",id:11},setRangeValues:{type:"SetRangeValuesMutation",id:12},setCellValues:{type:"SetCellValuesMutation",id:13},mapRange:{type:"MapRangeMutation",id:14},reorderRange:{type:"ReorderRangeMutation",id:15},addWorkbookRange:{type:"AddWorkbookRangeMutation",id:16},updateWorkbookRange:{type:"UpdateWorkbookRangeMutation",id:17},deleteWorkbookRange:{type:"DeleteWorkbookRangeMutation",id:18},addComment:{type:"AddCommentMutation",id:19},addReminder:{type:"AddReminderMutation",id:20},updateReminder:{type:"UpdateReminderMutation",id:21},deleteReminder:{type:"DeleteReminderMutation",id:22},addRangeProtection:{type:"AddRangeProtectionMutation",id:23},updateRangeProtection:{type:"UpdateRangeProtectionMutation",id:24},deleteRangeProtection:{type:"DeleteRangeProtectionMutation",id:25},setSheetProtection:{type:"SetSheetProtectionMutation",id:26},removeSheetProtection:{type:"RemoveSheetProtectionMutation",id:27},addConditionalFormatting:{type:"AddConditionalFormattingMutation",id:29},updateConditionalFormatting:{type:"UpdateConditionalFormattingMutation",id:30},deleteConditionalFormatting:{type:"DeleteConditionalFormattingMutation",id:31},moveConditionalFormatting:{type:"MoveConditionalFormattingMutation",id:32},setAutoFilter:{type:"SetAutoFilterMutation",id:33},removeAutoFilter:{type:"RemoveAutoFilterMutation",id:34},addCustomView:{type:"AddCustomViewMutation",id:35},updateCustomView:{type:"UpdateCustomViewMutation",id:36},deleteCustomView:{type:"DeleteCustomViewMutation",id:37},addFloatImage:{type:"AddFloatImageMutation",id:38},updateFloatImage:{type:"UpdateFloatImageMutation",id:39},deleteFloatImage:{type:"DeleteFloatImageMutation",id:40},addFloatBlock:{type:"AddFloatBlockMutation",id:41},updateFloatBlock:{type:"UpdateFloatBlockMutation",id:42},deleteFloatBlock:{type:"DeleteFloatBlockMutation",id:43},addEmbeddedBlock:{type:"AddEmbeddedBlockMutation",id:44},updateEmbeddedBlock:{type:"UpdateEmbeddedBlockMutation",id:45},deleteEmbeddedBlock:{type:"DeleteEmbeddedBlockMutation",id:46},addSparklineGroup:{type:"AddSparklineGroupMutation",id:47},updateSparklineGroup:{type:"UpdateSparklineGroupMutation",id:48},deleteSparklineGroup:{type:"DeleteSparklineGroupMutation",id:49},setChartMap:{type:"SetChartMapMutation",id:55},addCalcResult:{type:"AddCalcResultMutation",id:56}}},SimpleMutation:{oneofs:{mutationOneof:{oneof:["setWorkbookProperties","insertSheet","setDimensionProperties","mergeCells","setRangeValues","addWorkbookRange","addComment","addReminder","addRangeProtection","setSheetProtection","addConditionalFormatting","setAutoFilter","addCustomView","addFloatImage","addFloatBlock","addEmbeddedBlock","addSparklineGroup","setChartMap","addCalcResult"]}},fields:{type:{type:"MutationType",id:1},setWorkbookProperties:{type:"SetWorkbookPropertiesMutation",id:2},insertSheet:{type:"InsertSheetMutation",id:3},setDimensionProperties:{type:"SetDimensionPropertiesMutation",id:7},mergeCells:{type:"MergeCellsMutation",id:10},setRangeValues:{type:"SimpleSetRangeValuesMutation",id:12},addWorkbookRange:{type:"AddWorkbookRangeMutation",id:16},addComment:{type:"AddCommentMutation",id:19},addReminder:{type:"AddReminderMutation",id:20},addRangeProtection:{type:"AddRangeProtectionMutation",id:23},setSheetProtection:{type:"SetSheetProtectionMutation",id:26},addConditionalFormatting:{type:"AddConditionalFormattingMutation",id:29},setAutoFilter:{type:"SetAutoFilterMutation",id:33},addCustomView:{type:"AddCustomViewMutation",id:35},addFloatImage:{type:"AddFloatImageMutation",id:38},addFloatBlock:{type:"AddFloatBlockMutation",id:41},addEmbeddedBlock:{type:"AddEmbeddedBlockMutation",id:44},addSparklineGroup:{type:"AddSparklineGroupMutation",id:47},setChartMap:{type:"SetChartMapMutation",id:55},addCalcResult:{type:"AddCalcResultMutation",id:56}}},MutationType:{values:{MutationType_UNSPEDIFIED:0,MutationType_SetWorkbookProperties:2,MutationType_InsertSheet:3,MutationType_DeleteSheet:4,MutationType_MoveSheet:5,MutationType_SetSheetProperties:6,MutationType_SetDimensionProperties:7,MutationType_InsertDimension:8,MutationType_DeleteDimension:9,MutationType_MergeCells:10,MutationType_UnmergeCells:11,MutationType_SetRangeValues:12,MutationType_SetCellValues:13,MutationType_MapRange:14,MutationType_ReorderRange:15,MutationType_AddWorkbookRange:16,MutationType_UpdateWorkbookRange:17,MutationType_DeleteWorkbookRange:18,MutationType_AddComment:19,MutationType_AddReminder:20,MutationType_UpdateReminder:21,MutationType_DeleteReminder:22,MutationType_AddRangeProtection:23,MutationType_UpdateRangeProtection:24,MutationType_DeleteRangeProtection:25,MutationType_SetSheetProtection:26,MutationType_RemoveSheetProtection:27,MutationType_AddConditionalFormatting:29,MutationType_UpdateConditionalFormatting:30,MutationType_DeleteConditionalFormatting:31,MutationType_MoveConditionalFormatting:32,MutationType_SetAutoFilter:33,MutationType_RemoveAutoFilter:34,MutationType_AddCustomView:35,MutationType_UpdateCustomView:36,MutationType_DeleteCustomView:37,MutationType_AddFloatImage:38,MutationType_UpdateFloatImage:39,MutationType_DeleteFloatImage:40,MutationType_AddFloatBlock:41,MutationType_UpdateFloatBlock:42,MutationType_DeleteFloatBlock:43,MutationType_AddEmbeddedBlock:44,MutationType_UpdateEmbeddedBlock:45,MutationType_DeleteEmbeddedBlock:46,MutationType_AddSparklineGroup:47,MutationType_UpdateSparklineGroup:48,MutationType_DeleteSparklineGroup:49,MutationType_CopyPaste:50,MutationType_CopySheet:51,MutationType_CoverSheet:52,MutationType_CoverSnapshot:53,MutationType_Recover:54,MutationType_SetChartMap:55,MutationType_AddCalcResult:56}},AddCalcResultMutation:{fields:{pivotTableViewModels:{rule:"repeated",type:"PivotTableViewModel",id:2}}},PivotTableViewModel:{fields:{id:{type:"string",id:1},viewModel:{type:"string",id:2},errorState:{type:"PivotErrorState",id:3}}},PivotErrorState:{values:{PivotErrorState_None:0,PivotErrorState_Shrink:1,PivotErrorState_Cover:2,PivotErrorState_Circle:3,PivotErrorState_ImportRange:4,PivotErrorState_LessThanTwo:5,PivotErrorState_CoverSource:6,PivotErrorState_SourceHasPivot:7,PivotErrorState_ServiceCalcLoading:8,PivotErrorState_UnSupportVersion:9,PivotErrorState_FormulaError:10,PivotErrorState_Loading:11}},AddCommentMutation:{fields:{value:{type:"Comment",id:1}}},Comment:{fields:{id:{type:"string",id:1},cell:{type:"GridRange",id:2},isResolved:{type:"bool",id:3}}},ConditionalFormatting:{fields:{id:{type:"string",id:1},ranges:{rule:"repeated",type:"GridRange",id:2},style:{type:"DifferentialFormatting",id:3},hasRef:{type:"bool",id:4,options:{deprecated:!0}},rule:{type:"ConditionalFormatRule",id:5}}},ConditionalFormatRule:{fields:{ruleType:{type:"ConditionalFormatRuleTypes",id:1},cellIs:{type:"CellIsRule",id:2},containText:{type:"ContainTextRule",id:3},timePeriod:{type:"TimePeriodRule",id:4},dataBar:{rule:"repeated",type:"DataBarAttr",id:5},colorScale:{rule:"repeated",type:"ColorScaleAttr",id:6},rank:{type:"RankAttr",id:7},average:{type:"AverageAttr",id:8},customFormula:{type:"CustomFormulaAttr",id:9},iconSet:{rule:"repeated",type:"IconSetAttr",id:10}}},ConditionalFormatRuleTypes:{values:{ConditionalFormatRuleTypes_UNSPEDIFIED:0,ConditionalFormatRuleTypes_DUPLICATE_VALUES:1,ConditionalFormatRuleTypes_UNIQUE_VALUES:2,ConditionalFormatRuleTypes_CELL_IS:3,ConditionalFormatRuleTypes_CONTAINS_TEXT:4,ConditionalFormatRuleTypes_TIME_PERIOD:5,ConditionalFormatRuleTypes_CONTAINS_BLANKS:6,ConditionalFormatRuleTypes_NOT_CONTAINS_BLANKS:7,ConditionalFormatRuleTypes_DATA_BAR:8,ConditionalFormatRuleTypes_COLOR_SCALE:9,ConditionalFormatRuleTypes_RANK:10,ConditionalFormatRuleTypes_AVERAGE:11,ConditionalFormatRuleTypes_EXPRESSION:12,ConditionalFormatRuleTypes_ICON_SET:13}},CellIsRule:{fields:{operator:{type:"CellIsRuleOperatorType",id:1},plainText:{rule:"repeated",type:"string",id:2},formula:{rule:"repeated",type:"string",id:3}}},CellIsRuleOperatorType:{values:{CellIsRuleOperatorType_UNSPECIFIED:0,CellIsRuleOperatorType_EQUAL:1,CellIsRuleOperatorType_NOT_EQUAL:2,CellIsRuleOperatorType_GREATER:3,CellIsRuleOperatorType_GREATER_OR_EQUAL:4,CellIsRuleOperatorType_LESS:5,CellIsRuleOperatorType_LESS_OR_EQUAL:6,CellIsRuleOperatorType_BETWEEN:7,CellIsRuleOperatorType_NOT_BETWEEN:8}},ContainTextRule:{fields:{operator:{type:"ContainTextRuleOperatorType",id:1},text:{type:"string",id:2}}},ContainTextRuleOperatorType:{values:{ContainTextRuleOperatorType_UNSPECIFIED:0,ContainTextRuleOperatorType_BEGINS_WITH:1,ContainTextRuleOperatorType_ENDS_WITH:2,ContainTextRuleOperatorType_CONTAINS:3,ContainTextRuleOperatorType_DOES_NOT_CONTAIN:4,ContainTextRuleOperatorType_IS:5}},TimePeriodRule:{fields:{operator:{type:"TimePeriodRuleOperatorType",id:1},period:{type:"TimePeriodType",id:2}}},TimePeriodRuleOperatorType:{values:{TimePeriodRuleOperatorType_UNSPECIFIED:0,TimePeriodRuleOperatorType_BEFORE:1,TimePeriodRuleOperatorType_IS:2,TimePeriodRuleOperatorType_AFTER:3}},TimePeriodType:{values:{TimePeriodType_UNSPECIFIED:0,TimePeriodType_TODAY:1,TimePeriodType_YESTERDAY:2,TimePeriodType_TOMORROW:3,TimePeriodType_LAST_7_DAYS:4,TimePeriodType_THIS_MONTH:5,TimePeriodType_LAST_MONTH:6,TimePeriodType_NEXT_MONTH:7,TimePeriodType_THIS_WEEK:8,TimePeriodType_LAST_WEEK:9,TimePeriodType_NEXT_WEEK:10}},DataBarAttr:{fields:{gradient:{type:"bool",id:1},value:{type:"double",id:2},color:{type:"Color",id:3},hideValue:{type:"bool",id:4},valueType:{type:"AttrValueType",id:5}}},AttrValueType:{values:{AttrValueType_UNSPECIFIED:0,AttrValueType_MIN_VALUE:1,AttrValueType_MAX_VALUE:2,AttrValueType_NUM:3,AttrValueType_PERCENTILE:4,AttrValueType_PERCENT:5,AttrValueType_FORMULA:6,AttrValueType_AUTO:7}},ColorScaleAttr:{fields:{valueType:{type:"AttrValueType",id:1},value:{type:"double",id:2},color:{type:"Color",id:3}}},RankAttr:{fields:{isBottom:{type:"bool",id:1},valueType:{type:"RankType",id:2},value:{type:"int32",id:3}}},RankType:{values:{RankType_UNSPECIFIED:0,RankType_PERCENT:1,RankType_SORT:2}},AverageAttr:{fields:{operator:{type:"AverageType",id:1}}},AverageType:{values:{AverageType_UNSPECIFIED:0,AverageType_GREATER:1,AverageType_GREATER_OR_EQUAL:2,AverageType_LESS:3,AverageType_LESS_OR_EQUAL:4}},CustomFormulaAttr:{fields:{formula:{rule:"repeated",type:"string",id:1}}},IconSetAttr:{fields:{iconType:{type:"IconGroupType",id:1},hideValue:{type:"bool",id:2},valueType:{type:"AttrValueType",id:3},operator:{type:"IconsRuleOperatorType",id:4},value:{type:"double",id:5},reverseIcons:{type:"bool",id:6}}},IconGroupType:{values:{IconGroupType_UNSPECIFIED:0,IconGroupType_ARROWS_3:1,IconGroupType_ARROWS_GRAY_3:2,IconGroupType_TRIANGLES_3:3,IconGroupType_ARROWS_GRAY_4:4,IconGroupType_ARROWS_4:5,IconGroupType_ARROWS_GRAY_5:6,IconGroupType_ARROWS_5:7,IconGroupType_CIRCLES_3:8,IconGroupType_MULTI_GRAPHICS_3:9,IconGroupType_CIRCLES_4:10,IconGroupType_CIRCLES_5:11,IconGroupType_STATUS_2:12,IconGroupType_STATUS_3:13,IconGroupType_COMMENT_STATUS_2:14,IconGroupType_FLAGS_3:15,IconGroupType_STARS_3:16,IconGroupType_HEART_SHAPED_3:17,IconGroupType_MOOD_3:18,IconGroupType_CIRCLES_RATIO_5:19}},IconsRuleOperatorType:{values:{IconsRuleOperatorType_UNSPECIFIED:0,IconsRuleOperatorType_GREATER:1,IconsRuleOperatorType_GREATER_OR_EQUAL:2,IconsRuleOperatorType_LESS:3,IconsRuleOperatorType_LESS_OR_EQUAL:4}},ConditionalFormattingResult:{oneofs:{_conditionalFormatStyle:{oneof:["conditionalFormatStyle"]}},fields:{conditionalFormatStyle:{type:"DifferentialFormatting",id:1,options:{proto3_optional:!0}},iconsStyle:{type:"IconsStyle",id:2},dataBarStyleInfo:{type:"DataBarStyleInfo",id:3}}},IconsStyle:{fields:{iconType:{type:"IconGroupType",id:1},iconLevel:{type:"int32",id:2}}},DataBarStyleInfo:{fields:{gradient:{type:"bool",id:1},color:{type:"Color",id:2},percent:{type:"double",id:3},originPoint:{type:"double",id:4}}},AddConditionalFormattingMutation:{fields:{value:{type:"ConditionalFormatting",id:2},index:{type:"int32",id:3}}},UpdateConditionalFormattingMutation:{fields:{value:{type:"ConditionalFormatting",id:2}}},DeleteConditionalFormattingMutation:{fields:{id:{type:"string",id:2},index:{type:"int32",id:3}}},MoveConditionalFormattingMutation:{fields:{sourceIndex:{type:"int32",id:2},targetIndex:{type:"int32",id:3}}},CustomView:{fields:{id:{type:"string",id:1},name:{type:"string",id:2},autoFilter:{type:"AutoFilter",id:3}}},AddCustomViewMutation:{fields:{value:{type:"CustomView",id:2}}},UpdateCustomViewMutation:{fields:{value:{type:"CustomView",id:2}}},DeleteCustomViewMutation:{fields:{id:{type:"string",id:2}}},DimensionInfo:{fields:{range:{type:"DimensionRange",id:1},info:{type:"AxisInfo",id:2}}},AxisInfo:{fields:{size:{type:"double",id:1},customSize:{type:"double",id:2},hidden:{type:"bool",id:3},name:{type:"string",id:4},displayName:{type:"string",id:5},formId:{type:"string",id:6}}},OutlineGroupInfo:{fields:{range:{type:"DimensionRange",id:1},info:{type:"OutlineInfo",id:2}}},OutlineInfo:{fields:{outlineLevel:{type:"int32",id:1},collapsed:{type:"bool",id:2}}},SetDimensionPropertiesMutation:{fields:{rowDimensions:{rule:"repeated",type:"DimensionInfo",id:2},colDimensions:{rule:"repeated",type:"DimensionInfo",id:3},rowOutlineGroups:{rule:"repeated",type:"OutlineGroupInfo",id:4},colOutlineGroups:{rule:"repeated",type:"OutlineGroupInfo",id:5}}},InsertDimensionMutation:{fields:{range:{type:"DimensionRange",id:2},type:{type:"DimensionType",id:3}}},DeleteDimensionMutation:{fields:{range:{type:"DimensionRange",id:2},type:{type:"DimensionType",id:3}}},EmbeddedBlock:{fields:{id:{type:"string",id:1},cell:{type:"GridRange",id:2},blockType:{type:"EmbeddedBlockType",id:3}}},EmbeddedBlockType:{values:{EmbeddedBlockType_UNSPECIFIED:0,EmbeddedBlockType_PIVOT_TABLE:1}},AddEmbeddedBlockMutation:{fields:{value:{type:"EmbeddedBlock",id:2}}},UpdateEmbeddedBlockMutation:{fields:{value:{type:"EmbeddedBlock",id:2}}},DeleteEmbeddedBlockMutation:{fields:{id:{type:"string",id:2}}},AutoFilter:{fields:{range:{type:"GridRange",id:1},filterColumns:{rule:"repeated",type:"FilterColumn",id:2}}},FilterColumn:{fields:{colId:{type:"int32",id:1},condition:{type:"FilterCondition",id:2},filteredRows:{rule:"repeated",type:"int32",id:3}}},FilterCondition:{oneofs:{conditionOneof:{oneof:["multiFilters","customFilters","colorFilter"]}},fields:{multiFilters:{type:"MultiFilters",id:1},customFilters:{type:"CustomFilters",id:2},colorFilter:{type:"ColorFilter",id:3}}},MultiFilters:{fields:{filters:{rule:"repeated",type:"string",id:1},filterIds:{rule:"repeated",type:"int32",id:2},dateGroupItems:{rule:"repeated",type:"DateGroupItem",id:3},dateGroupItemIds:{rule:"repeated",type:"int32",id:4}}},DateGroupItem:{fields:{year:{type:"int32",id:1},month:{type:"int32",id:2},day:{type:"int32",id:3},hour:{type:"int32",id:4},minute:{type:"int32",id:5},second:{type:"int32",id:6},dateTimeGrouping:{type:"DateTimeGrouping",id:7}}},DateTimeGrouping:{values:{DateTimeGrouping_UNSPEDIFIED:0,DateTimeGrouping_YEAR:1,DateTimeGrouping_MONTH:2,DateTimeGrouping_DAY:3,DateTimeGrouping_HOUR:4,DateTimeGrouping_MINUTE:5,DateTimeGrouping_SECOND:6}},CustomFilters:{fields:{customFilter:{rule:"repeated",type:"CustomFilter",id:1},and:{type:"bool",id:2}}},CustomFilter:{fields:{operator:{type:"CustomFilterOperator",id:1},value:{type:"string",id:2}}},CustomFilterOperator:{values:{CustomFilterOperator_Equal:0,CustomFilterOperator_NotEqual:1,CustomFilterOperator_GreaterThan:2,CustomFilterOperator_GreaterThanOrEqual:3,CustomFilterOperator_LessThan:4,CustomFilterOperator_LessThanOrEqual:5,CustomFilterOperator_BeginsWith:6,CustomFilterOperator_DoesNotBeginWith:7,CustomFilterOperator_EndsWith:8,CustomFilterOperator_DoesNotEndWith:9,CustomFilterOperator_Contains:10,CustomFilterOperator_DoesNotContain:11}},ColorFilter:{fields:{value:{type:"string",id:1},cellColor:{type:"bool",id:2}}},SetAutoFilterMutation:{fields:{value:{type:"AutoFilter",id:1}}},RemoveAutoFilterMutation:{fields:{sheetId:{type:"string",id:1}}},SetChartMapMutation:{fields:{chartMap:{type:"string",id:2}}},FloatBlock:{fields:{id:{type:"string",id:1},anchor:{type:"RelativeCellAnchor",id:2},type:{type:"FloatBlockType",id:3}}},FloatBlockType:{values:{FloatBlockType_UNSPECIFIED:0,FloatBlockType_CHART:1}},AddFloatBlockMutation:{fields:{value:{type:"FloatBlock",id:2}}},UpdateFloatBlockMutation:{fields:{value:{type:"FloatBlock",id:2}}},DeleteFloatBlockMutation:{fields:{id:{type:"string",id:2}}},FloatImage:{fields:{id:{type:"string",id:1},token:{type:"string",id:2},anchor:{type:"RelativeCellAnchor",id:3},link:{type:"string",id:4}}},AddFloatImageMutation:{fields:{value:{type:"FloatImage",id:2}}},UpdateFloatImageMutation:{fields:{value:{type:"FloatImage",id:2}}},DeleteFloatImageMutation:{fields:{id:{type:"string",id:2}}},MergeCellsMutation:{fields:{ranges:{rule:"repeated",type:"GridRange",id:2}}},UnmergeCellsMutation:{fields:{range:{type:"GridRange",id:1}}},ProtectionInfo:{fields:{id:{type:"string",id:1},creatorId:{type:"string",id:2},description:{type:"string",id:3},ranges:{rule:"repeated",type:"GridRange",id:4}}},AddRangeProtectionMutation:{fields:{value:{type:"ProtectionInfo",id:2}}},UpdateRangeProtectionMutation:{fields:{value:{type:"ProtectionInfo",id:2}}},DeleteRangeProtectionMutation:{fields:{id:{type:"string",id:2}}},SetSheetProtectionMutation:{fields:{sheetId:{type:"string",id:1},value:{type:"ProtectionInfo",id:2}}},RemoveSheetProtectionMutation:{fields:{sheetId:{type:"string",id:1},id:{type:"string",id:2}}},MapRangeMutation:{fields:{}},ReorderRangeMutation:{fields:{}},Reminder:{fields:{id:{type:"string",id:1},expireTime:{type:"fixed64",id:2},notifyTime:{type:"fixed64",id:3},notifyStrategyType:{type:"NotifyStrategyType",id:4},notifyText:{type:"string",id:5},notifyUserIds:{rule:"repeated",type:"string",id:6}}},NotifyStrategyType:{values:{NotifyStrategyTypes_UNSPEDIFIED:0,NotifyStrategyTypes_AT_TIME_OF_EVENT:1,NotifyStrategyTypes_BEFORE_5_MINUTES:2,NotifyStrategyTypes_BEFORE_15_MINUTES:3,NotifyStrategyTypes_BEFORE_30_MINUTES:4,NotifyStrategyTypes_BEFORE_1_HOUR:5,NotifyStrategyTypes_BEFORE_2_HOURS:6,NotifyStrategyTypes_AT_DAY_OF_EVENT:7,NotifyStrategyTypes_BEFORE_1_DAY:8,NotifyStrategyTypes_BEFORE_2_DAYS:9,NotifyStrategyTypes_BEFORE_1_WEEK:10,NotifyStrategyTypes_AT_TIME_BEFORE_1_DAY:11,NotifyStrategyTypes_AT_TIME_BEFORE_2_DAYS:12,NotifyStrategyTypes_AT_TIME_BEFORE_1_WEEK:13}},AddReminderMutation:{fields:{value:{type:"Reminder",id:2}}},UpdateReminderMutation:{fields:{value:{type:"Reminder",id:2}}},DeleteReminderMutation:{fields:{id:{type:"string",id:2}}},Cells:{fields:{cellIds:{rule:"repeated",type:"int32",id:1},cells:{rule:"repeated",type:"Cell",id:2}}},Cell:{oneofs:{_valueId:{oneof:["valueId"]},_formulaId:{oneof:["formulaId"]},_extendValueId:{oneof:["extendValueId"]},_styleId:{oneof:["styleId"]},_dataValidationId:{oneof:["dataValidationId"]},_reminderId:{oneof:["reminderId"]},_noteId:{oneof:["noteId"]},_conditionalFormattingResultId:{oneof:["conditionalFormattingResultId"]},_formulaSpecialInfoId:{oneof:["formulaSpecialInfoId"]}},fields:{valueType:{type:"CellValueType",id:1},valueId:{type:"int32",id:2,options:{proto3_optional:!0}},formulaId:{type:"int32",id:3,options:{proto3_optional:!0}},extendType:{type:"CellExtendType",id:4},extendValueId:{type:"int32",id:5,options:{proto3_optional:!0}},styleId:{type:"int32",id:6,options:{proto3_optional:!0}},dataValidationId:{type:"int32",id:7,options:{proto3_optional:!0}},reminderId:{type:"int32",id:8,options:{proto3_optional:!0}},noteId:{type:"int32",id:9,options:{proto3_optional:!0}},conditionalFormattingResultId:{type:"int32",id:10,options:{proto3_optional:!0}},formulaSpecialInfoId:{type:"int32",id:11,options:{proto3_optional:!0}}}},CellsDelta:{fields:{sparseCells:{rule:"repeated",type:"SparseCell",id:1},denseCells:{rule:"repeated",type:"CellDelta",id:2}}},SparseCell:{fields:{row:{type:"int32",id:1},col:{type:"int32",id:2},cell:{type:"CellDelta",id:3}}},CellDelta:{fields:{value:{type:"CellValue",id:1},style:{type:"CellStyle",id:2},dataValidation:{type:"CellDataValidation",id:3},reminder:{type:"CellReminder",id:4},note:{type:"CellNote",id:5}}},CellValue:{oneofs:{_valueId:{oneof:["valueId"]},_formulaId:{oneof:["formulaId"]},_formulaResultId:{oneof:["formulaResultId"]},_extendValueId:{oneof:["extendValueId"]}},fields:{valueType:{type:"CellValueType",id:1},valueId:{type:"int32",id:2,options:{proto3_optional:!0}},formulaId:{type:"int32",id:3,options:{proto3_optional:!0}},formulaResultId:{type:"int32",id:4,options:{proto3_optional:!0}},extendType:{type:"CellExtendType",id:5},extendValueId:{type:"int32",id:6,options:{proto3_optional:!0}}}},CellStyle:{oneofs:{_styleId:{oneof:["styleId"]}},fields:{styleId:{type:"int32",id:1,options:{proto3_optional:!0}}}},CellDataValidation:{oneofs:{_dataValidationId:{oneof:["dataValidationId"]},_dataValidationResult:{oneof:["dataValidationResult"]}},fields:{dataValidationId:{type:"int32",id:1,options:{proto3_optional:!0}},dataValidationResult:{type:"bool",id:2,options:{proto3_optional:!0}}}},CellReminder:{oneofs:{_reminderId:{oneof:["reminderId"]}},fields:{reminderId:{type:"string",id:1,options:{proto3_optional:!0}}}},CellNote:{oneofs:{_noteId:{oneof:["noteId"]}},fields:{noteId:{type:"int32",id:1,options:{proto3_optional:!0}}}},CellValueType:{values:{CellValueType_UNSPEDIFIED:0,CellValueType_Bool:1,CellValueType_Number:2,CellValueType_String:3,CellValueType_Formula:4,CellValueType_FormulaString:5,CellValueType_RichString:6,CellValueType_EmbedImage:7,CellValueType_Error:8}},CellExtendType:{values:{CellExtendType_UNSPEDIFIED:0,CellExtendType_Select:1}},CellFormatDelta:{fields:{cellFormats:{rule:"repeated",type:"CellFormatting",id:1},numberFormats:{rule:"repeated",type:"NumberFormat",id:2},fonts:{rule:"repeated",type:"Font",id:3},fills:{rule:"repeated",type:"Fill",id:4},borders:{rule:"repeated",type:"Border",id:5},alignments:{rule:"repeated",type:"CellAlignment",id:6},hideLinks:{rule:"repeated",type:"HideLink",id:7}}},CellValueRefDelta:{fields:{numbers:{rule:"repeated",type:"double",id:1},strings:{rule:"repeated",type:"string",id:2},richStrings:{rule:"repeated",type:"RichString",id:3},formulaStrings:{rule:"repeated",type:"string",id:4},formulas:{rule:"repeated",type:"Formula",id:5},formulaDatas:{rule:"repeated",type:"FormulaData",id:6},formulaRefMaps:{rule:"repeated",type:"FormulaRefMap",id:7},errorValues:{rule:"repeated",type:"ErrorValue",id:8}}},CellResourceRefDelta:{fields:{embedImages:{rule:"repeated",type:"EmbedImage",id:1},dataValidations:{rule:"repeated",type:"DataValidation",id:2},mentions:{rule:"repeated",type:"Mention",id:3},mentionInfos:{rule:"repeated",type:"MentionInfo",id:4},hyperlinks:{rule:"repeated",type:"Hyperlink",id:5},attachments:{rule:"repeated",type:"Attachment",id:6},extendValues:{rule:"repeated",type:"string",id:7},notes:{rule:"repeated",type:"Note",id:8},reminderIds:{rule:"repeated",type:"string",id:9},selectedMultipleValues:{rule:"repeated",type:"SelectedMultipleValue",id:10},colors:{rule:"repeated",type:"string",id:11},conditionalFormattingResults:{rule:"repeated",type:"ConditionalFormattingResult",id:12},formulaSpecialInfoStrings:{rule:"repeated",type:"string",id:13}}},RichString:{oneofs:{_textId:{oneof:["textId"]}},fields:{textId:{type:"int32",id:1,options:{proto3_optional:!0}},runs:{rule:"repeated",type:"Run",id:2}}},Run:{oneofs:{_fontId:{oneof:["fontId"]}},fields:{runType:{type:"CellRunType",id:1},endPos:{type:"int32",id:2},fontId:{type:"int32",id:3,options:{proto3_optional:!0}},refId:{type:"int32",id:4}}},CellRunType:{values:{CellRunType_UNSPEDIFIED:0,CellRunType_Text:1,CellRunType_Mention:2,CellRunType_Attachment:3,CellRunType_Hyperlink:4}},Formula:{oneofs:{_formulaDataId:{oneof:["formulaDataId"]},_formulaRefMapId:{oneof:["formulaRefMapId"]}},fields:{formulaDataId:{type:"int32",id:1,options:{proto3_optional:!0}},formulaRefMapId:{type:"int32",id:2,options:{proto3_optional:!0}}}},FormulaData:{fields:{v:{type:"int32",id:1},flag:{type:"int32",id:2},tree:{rule:"repeated",type:"string",id:3},tokens:{rule:"repeated",type:"string",id:4},importRangeId:{type:"string",id:5},importRangeMeta:{type:"ImportRangeMeta",id:6},params:{rule:"repeated",type:"string",id:7}}},FormulaRefMap:{fields:{refs:{keyType:"string",type:"GridRange",id:1}}},ImportRangeMeta:{fields:{spreadToken:{type:"string",id:1},ref:{type:"GridRange",id:2},isSyncStyle:{type:"bool",id:3},importRangeId:{type:"string",id:4},spreadSource:{type:"string",id:5},spreadName:{type:"string",id:6},refCount:{type:"int32",id:7}}},ErrorValue:{oneofs:{_message:{oneof:["message"]},_args:{oneof:["args"]},_errorTipsType:{oneof:["errorTipsType"]}},fields:{type:{type:"int32",id:1},code:{type:"int32",id:2},description:{type:"string",id:3},message:{type:"string",id:4,options:{proto3_optional:!0}},args:{type:"string",id:5,options:{proto3_optional:!0}},errorTipsType:{type:"ErrorTipsType",id:6,options:{proto3_optional:!0}}}},ErrorTipsType:{values:{ErrorTipsType_None:0,ErrorTipsType_FormulaError:1,ErrorTipsType_TextualNumber:2,ErrorTipsType_PivotNormalTableError:3,ErrorTipsType_Info:4,ErrorTipsType_PivotServiceCalcLoading:5}},EmbedImage:{fields:{token:{type:"string",id:1},size:{type:"Size2D",id:2},link:{type:"string",id:3}}},Hyperlink:{fields:{url:{type:"string",id:1},type:{type:"HyperlinkType",id:2}}},HyperlinkType:{values:{HyperlinkType_UNSPEDIFIED:0,HyperlinkType_Normal:1,HyperlinkType_Worksheet:2,HyperlinkType_Range:3}},Attachment:{fields:{fileToken:{type:"string",id:1},mimeType:{type:"string",id:2},size:{type:"int32",id:3}}},Note:{oneofs:{_valueId:{oneof:["valueId"]}},fields:{valueType:{type:"NoteValueType",id:1},valueId:{type:"int32",id:2,options:{proto3_optional:!0}},frameSize:{type:"Size2D",id:3}}},NoteValueType:{values:{NoteValueType_UNSPEDIFIED:0,NoteValueType_String:1,NoteValueType_RichString:2}},SelectedMultipleValue:{fields:{selectedValueIds:{rule:"repeated",type:"int32",id:1},selectedAutoFormats:{rule:"repeated",type:"int32",id:2}}},DataValidation:{oneofs:{dataValidationOneof:{oneof:["listDataValidation","numberDataValidation","dateDataValidation","textLengthDataValidation","checkboxDataValidation"]}},fields:{type:{type:"DataValidationConditionType",id:1},listDataValidation:{type:"ListDataValidation",id:2},numberDataValidation:{type:"NumberDataValidation",id:3},dateDataValidation:{type:"DateDataValidation",id:4},textLengthDataValidation:{type:"TextLengthDataValidation",id:5},checkboxDataValidation:{type:"CheckboxDataValidation",id:6}}},DataValidationConditionType:{values:{DataValidationConditionType_UNSPEDIFIED:0,DataValidationConditionType_List:1,DataValidationConditionType_Number:2,DataValidationConditionType_Date:3,DataValidationConditionType_TextLength:4,DataValidationConditionType_Checkbox:5}},DataValidationTips:{oneofs:{_handledWayOnInvalidData:{oneof:["handledWayOnInvalidData"]},_helpText:{oneof:["helpText"]}},fields:{handledWayOnInvalidData:{type:"int32",id:1,options:{proto3_optional:!0}},helpText:{type:"string",id:2,options:{proto3_optional:!0}}}},ListDataValidation:{fields:{listSourceType:{type:"ListSourceType",id:1},listItemFormula:{type:"ListItemFormula",id:2},listRangeFormula:{type:"ListRangeFormula",id:3},options:{type:"ListDataValidationOptions",id:4},tips:{type:"DataValidationTips",id:5}}},ListSourceType:{values:{ListSourceType_UNSPEDIFIED:0,ListSourceType_Range:1,ListSourceType_Items:2}},ListItemFormula:{fields:{listItemIds:{rule:"repeated",type:"int32",id:1},listItemColors:{rule:"repeated",type:"string",id:2},listItemColorIds:{rule:"repeated",type:"int32",id:3}}},ListRangeFormula:{fields:{refRangeString:{type:"string",id:1},listRangeColors:{type:"ListRangeColors",id:2},listItemColorIds:{rule:"repeated",type:"int32",id:3}}},ListRangeColors:{fields:{rows:{rule:"repeated",type:"ListRowRangeColors",id:1}}},ListRowRangeColors:{fields:{cols:{rule:"repeated",type:"string",id:1}}},ListDataValidationOptions:{oneofs:{_supportMultipleValues:{oneof:["supportMultipleValues"]},_ignoreCase:{oneof:["ignoreCase"]},_isDropdownIconHiddenInCell:{oneof:["isDropdownIconHiddenInCell"]},_shouldHighlightValidData:{oneof:["shouldHighlightValidData"]}},fields:{supportMultipleValues:{type:"bool",id:1,options:{proto3_optional:!0}},ignoreCase:{type:"bool",id:2,options:{proto3_optional:!0}},isDropdownIconHiddenInCell:{type:"bool",id:3,options:{proto3_optional:!0}},shouldHighlightValidData:{type:"bool",id:4,options:{proto3_optional:!0}}}},NumberDataValidation:{fields:{operator:{type:"DataValidationOperator",id:1},formulas:{rule:"repeated",type:"DataValidationCommonFormulaItem",id:2},options:{type:"NumberDataValidationOptions",id:3},tips:{type:"DataValidationTips",id:4}}},DataValidationOperator:{values:{NumberDataValidationOperator_UNSPEDIFIED:0,NumberDataValidationOperator_IsValid:1,NumberDataValidationOperator_Between:2,NumberDataValidationOperator_NotBetween:3,NumberDataValidationOperator_EqualTo:4,NumberDataValidationOperator_NotEqualTo:5,NumberDataValidationOperator_GreaterThan:6,NumberDataValidationOperator_LessThan:7,NumberDataValidationOperator_GreaterThanOrEqualTo:8,NumberDataValidationOperator_LessThanOrEqualTo:9}},NumberDataValidationOptions:{oneofs:{_validNumType:{oneof:["validNumType"]}},fields:{validNumType:{type:"int32",id:1,options:{proto3_optional:!0}}}},DateDataValidation:{fields:{operator:{type:"DataValidationOperator",id:1},formulas:{rule:"repeated",type:"DataValidationCommonFormulaItem",id:2},options:{type:"DateDataValidationOptions",id:3},tips:{type:"DataValidationTips",id:4}}},DateDataValidationOptions:{oneofs:{_isDatePickerVisibleInCell:{oneof:["isDatePickerVisibleInCell"]}},fields:{isDatePickerVisibleInCell:{type:"bool",id:1,options:{proto3_optional:!0}}}},TextLengthDataValidation:{fields:{operator:{type:"DataValidationOperator",id:1},formulas:{rule:"repeated",type:"DataValidationCommonFormulaItem",id:2},tips:{type:"DataValidationTips",id:3}}},CheckboxDataValidation:{fields:{formulas:{rule:"repeated",type:"int32",id:1},tips:{type:"DataValidationTips",id:2}}},DataValidationCommonFormulaItem:{fields:{value:{type:"double",id:1},autoFormatter:{type:"AutoFormatter",id:2}}},AutoFormatter:{fields:{formatCached:{type:"string",id:1}}},NumberType:{values:{NumberType_UNSPEDIFIED:0,NumberType_Integer:1,NumberType_Decimal:2}},HandledWayOnInvalidData:{values:{HandledWayOnInvalidData_UNSPEDIFIED:0,HandledWayOnInvalidData_ShowWarning:1,HandledWayOnInvalidData_RejectInput:2}},Mention:{oneofs:{_mentionId:{oneof:["mentionId"]},_mentionInfoId:{oneof:["mentionInfoId"]}},fields:{mentionId:{type:"string",id:1,options:{proto3_optional:!0}},mentionInfoId:{type:"int32",id:2,options:{proto3_optional:!0}}}},MentionInfo:{oneofs:{mentionOneof:{oneof:["mentionUserInfo","mentionFileInfo"]}},fields:{mentionType:{type:"MENTION_TYPE",id:1},mentionUserInfo:{type:"MentionUserInfo",id:2},mentionFileInfo:{type:"MentionFileInfo",id:3}}},MENTION_TYPE:{values:{MENTION_TYPE_UNSPEDIFIED:0,MENTION_TYPE_USER:1,MENTION_TYPE_FILE:2}},MentionUserInfo:{fields:{userInfo:{type:"UserInfo",id:1},mentionNotify:{type:"bool",id:2},notNotify:{type:"bool",id:3},blockNotify:{type:"bool",id:4},isExternal:{type:"bool",id:5}}},MentionFileInfo:{fields:{token:{type:"string",id:1},link:{type:"string",id:2},fileType:{type:"MENTION_FILE_TYPE",id:3},iconInfo:{type:"string",id:4}}},MENTION_FILE_TYPE:{values:{FILE_TYPE_UNSPEDIFIED:0,FILE_TYPE_DOC:1,FILE_TYPE_FOLDER:2,FILE_TYPE_SHEET:3,FILE_TYPE_SHEET_DOC:4,FILE_TYPE_CHAT:5,FILE_TYPE_BITABLE:8,FILE_TYPE_MINDNOTE:11,FILE_TYPE_FILE:12,FILE_TYPE_SLIDE:15,FILE_TYPE_WIKI:16,FILE_TYPE_DOCX:22,FILE_TYPE_SLIDES:30,FILE_TYPE_WHITE_BOARD:38}},SetRangeValuesMutation:{fields:{range:{type:"GridRange",id:1},valueRefDelta:{type:"CellValueRefDelta",id:2},resourceRefDelta:{type:"CellResourceRefDelta",id:3},formatDelta:{type:"CellFormatDelta",id:4},cellsDelta:{type:"CellsDelta",id:5},cells:{type:"Cells",id:6}}},SetCellValuesMutation:{fields:{range:{type:"GridRange",id:1},valueRefDelta:{type:"CellValueRefDelta",id:2},resourceRefDelta:{type:"CellResourceRefDelta",id:3},formatDelta:{type:"CellFormatDelta",id:4},cell:{type:"Cell",id:5}}},SimpleSetRangeValuesMutation:{fields:{range:{type:"GridRange",id:1},valueRefDelta:{type:"bytes",id:2},resourceRefDelta:{type:"CellResourceRefDelta",id:3},formatDelta:{type:"bytes",id:4},cellsDelta:{type:"bytes",id:5},cells:{type:"bytes",id:6}}},SimpleSetCellValuesMutation:{fields:{range:{type:"GridRange",id:1},valueRefDelta:{type:"bytes",id:2},resourceRefDelta:{type:"CellResourceRefDelta",id:3},formatDelta:{type:"bytes",id:4},cell:{type:"bytes",id:5}}},GridRange:{fields:{startRow:{type:"int32",id:1},startCol:{type:"int32",id:2},endRow:{type:"int32",id:3},endCol:{type:"int32",id:4},sheetId:{type:"string",id:5},sheetName:{type:"string",id:6},status:{type:"int32",id:7}}},Point2D:{fields:{x:{type:"double",id:1},y:{type:"double",id:2}}},Size2D:{fields:{w:{type:"double",id:1},h:{type:"double",id:2}}},DimensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},RelativeCellAnchor:{fields:{cell:{type:"GridRange",id:1},cellOff:{type:"Point2D",id:2},size:{type:"Size2D",id:3},zIndex:{type:"int32",id:4}}},AbsoluteAnchor:{fields:{point:{type:"Point2D",id:1},size:{type:"Size2D",id:2},zIndex:{type:"int32",id:3}}},DimensionType:{values:{DimensionType_UNSPEDIFIED:0,DimensionType_ROW:1,DimensionType_COL:2}},Padding:{fields:{left:{type:"int32",id:1},right:{type:"int32",id:2},top:{type:"int32",id:3},bottom:{type:"int32",id:4}}},CellFormatting:{oneofs:{_numFmtId:{oneof:["numFmtId"]},_fontId:{oneof:["fontId"]},_fillId:{oneof:["fillId"]},_borderId:{oneof:["borderId"]},_alignmentId:{oneof:["alignmentId"]},_autoNumFmtId:{oneof:["autoNumFmtId"]},_hideLinkId:{oneof:["hideLinkId"]}},fields:{numFmtId:{type:"int32",id:1,options:{proto3_optional:!0}},fontId:{type:"int32",id:2,options:{proto3_optional:!0}},fillId:{type:"int32",id:3,options:{proto3_optional:!0}},borderId:{type:"int32",id:4,options:{proto3_optional:!0}},alignmentId:{type:"int32",id:5,options:{proto3_optional:!0}},autoNumFmtId:{type:"int32",id:6,options:{proto3_optional:!0}},hideLinkId:{type:"int32",id:7,options:{proto3_optional:!0}}}},DifferentialFormatting:{fields:{numFmt:{type:"NumberFormat",id:1},font:{type:"Font",id:2},fill:{type:"Fill",id:3},border:{type:"Border",id:4},alignment:{type:"CellAlignment",id:5}}},NumberFormat:{fields:{numFmtId:{type:"int32",id:1},formatCode:{type:"string",id:2}}},Font:{fields:{name:{type:"string",id:1},bold:{type:"bool",id:2},italic:{type:"bool",id:3},strike:{type:"bool",id:4},underline:{type:"bool",id:5},color:{type:"Color",id:6},size:{type:"int32",id:7}}},Fill:{fields:{color:{type:"Color",id:1}}},Border:{fields:{left:{type:"BorderPr",id:1},right:{type:"BorderPr",id:2},top:{type:"BorderPr",id:3},bottom:{type:"BorderPr",id:4},diagonal:{type:"BorderPr",id:5},diagonalUp:{type:"bool",id:6},diagonalDown:{type:"bool",id:7}}},BorderPr:{oneofs:{_style:{oneof:["style"]}},fields:{color:{type:"Color",id:1},style:{type:"BorderStyle",id:2,options:{proto3_optional:!0}}}},BorderStyle:{values:{BorderStyle_UNSPEDIFIED:0,BorderStyle_none:1,BorderStyle_thin:2,BorderStyle_medium:3,BorderStyle_thick:4,BorderStyle_dotted:5,BorderStyle_dashed:6,BorderStyle_double:7,BorderStyle_hair:8,BorderStyle_dashDot:9,BorderStyle_dashDotDot:10,BorderStyle_slantDashDot:11,BorderStyle_mediumDashed:12,BorderStyle_mediumDashDot:13,BorderStyle_mediumDashDotDot:14}},Color:{fields:{rgb:{type:"string",id:1}}},CellAlignment:{fields:{horizontal:{type:"HorizontalAlignment",id:1},vertical:{type:"VerticalAlignment",id:2},textRotation:{type:"int32",id:3},wrapText:{type:"WrapTextType",id:4},indent:{type:"int32",id:5}}},HorizontalAlignment:{values:{HorizontalAlignment_UNSPEDIFIED:0,HorizontalAlignment_left:1,HorizontalAlignment_center:2,HorizontalAlignment_right:3}},VerticalAlignment:{values:{VerticalAlignment_UNSPEDIFIED:0,VerticalAlignment_top:1,VerticalAlignment_center:2,VerticalAlignment_bottom:3}},WrapTextType:{values:{WrapTextType_UNSPEDIFIED:0,WrapTextType_OVERFLOW:1,WrapTextType_AUTOWRAP:2,WrapTextType_WORDCLIP:3}},HideLink:{fields:{hideLink:{type:"bool",id:1}}},UserInfo:{fields:{id:{type:"string",id:1},name:{type:"string",id:2},enName:{type:"string",id:3},avatarUrl:{type:"string",id:4},displayName:{type:"string",id:5}}},SparklineGroup:{fields:{id:{type:"string",id:1},config:{type:"SparklineGroupConfig",id:2},sparklines:{keyType:"string",type:"Sparkline",id:3}}},SparklineGroupConfig:{fields:{themeType:{type:"SparklineThemeType",id:1},nonNumShowAs:{type:"SparklineNaNShowAs",id:2},emptyShowAs:{type:"SparklineNaNShowAs",id:3},containHiddenCells:{type:"bool",id:4},seriesColor:{type:"string",id:5},lineWidth:{type:"int32",id:6},type:{type:"SparklineType",id:7},axis:{type:"SparklineAxisConfig",id:8},showGradient:{type:"bool",id:9},showRadius:{type:"bool",id:10},extremumMax:{type:"SparklineExtremumConfig",id:11},extremumMin:{type:"SparklineExtremumConfig",id:12},points:{type:"SparklineSpecialPoints",id:13}}},SparklineThemeType:{values:{SparklineThemeType_UNSPECIFIED:0,SparklineThemeType_LIGHT:1,SparklineThemeType_SOFT:2,SparklineThemeType_BRAND:3,SparklineThemeType_FRESH:4,SparklineThemeType_PRO:5}},SparklineNaNShowAs:{values:{SparklineNaNShowAs_UNSPECIFIED:0,SparklineNaNShowAs_ZERO:1,SparklineNaNShowAs_SPACE:2,SparklineNaNShowAs_LINK:3}},SparklineType:{values:{SparklineType_UNSPECIFIED:0,SparklineType_LINE:1,SparklineType_COLUMN:2,SparklineType_WINLOSS:3}},SparklineAxisConfig:{fields:{color:{type:"string",id:1},reverse:{type:"bool",id:2},visible:{type:"bool",id:3}}},SparklineExtremumConfig:{fields:{type:{type:"ExtremumType",id:1},value:{type:"double",id:2}}},ExtremumType:{values:{ExtremumType_UNSPECIFIED:0,ExtremumType_AUTO:1,ExtremumType_GROUP:2,ExtremumType_CUSTOM:3}},SparklineSpecialPoints:{fields:{lastPoint:{type:"SpecialPointConfig",id:1},negativePoint:{type:"SpecialPointConfig",id:2},markersPoint:{type:"SpecialPointConfig",id:3},firstPoint:{type:"SpecialPointConfig",id:4},highPoint:{type:"SpecialPointConfig",id:5},lowPoint:{type:"SpecialPointConfig",id:6}}},SpecialPointConfig:{fields:{color:{type:"string",id:1},visible:{type:"bool",id:2}}},Sparkline:{fields:{id:{type:"string",id:1},source:{type:"string",id:2},position:{type:"GridRange",id:3}}},AddSparklineGroupMutation:{fields:{value:{type:"SparklineGroup",id:2}}},UpdateSparklineGroupMutation:{fields:{value:{type:"SparklineGroup",id:2}}},DeleteSparklineGroupMutation:{fields:{id:{type:"string",id:2}}},WorkbookPr:{fields:{lang:{type:"string",id:1},locale:{type:"string",id:2}}},WorkbookDefaults:{fields:{styles:{type:"DifferentialFormatting",id:1},format:{type:"WorkbookFormat",id:2}}},WorkbookFormat:{fields:{defaultColWidth:{type:"double",id:1},defaultRowHeight:{type:"double",id:2},lineHeightFactor:{type:"double",id:3},inlineAlign:{type:"bool",id:4},cellPadding:{type:"Padding",id:5}}},SetWorkbookPropertiesMutation:{fields:{workbookPr:{type:"WorkbookPr",id:1},defaults:{type:"WorkbookDefaults",id:2}}},WorkbookRange:{fields:{id:{type:"string",id:1},range:{type:"GridRange",id:2},type:{type:"WorkbookRangeType",id:3}}},WorkbookRangeType:{values:{WorkbookRangeType_UNSPEDIFIED:0,WorkbookRangeType_ChartOrPivotTable:1,WorkbookRangeType_Chart:2,WorkbookRangeType_PivotTable:3,WorkbookRangeType_Link:4}},AddWorkbookRangeMutation:{fields:{value:{type:"WorkbookRange",id:1}}},UpdateWorkbookRangeMutation:{fields:{id:{type:"string",id:1},range:{type:"GridRange",id:2}}},DeleteWorkbookRangeMutation:{fields:{id:{type:"string",id:1}}},InsertSheetMutation:{fields:{worksheetProperties:{type:"WorksheetProperties",id:1}}},DeleteSheetMutation:{fields:{sheetId:{type:"string",id:1},index:{type:"int32",id:2}}},MoveSheetMutation:{fields:{sourceIndex:{type:"int32",id:1},targetIndex:{type:"int32",id:2}}},SetSheetPropertiesMutation:{fields:{worksheetProperties:{type:"WorksheetProperties",id:1},originalName:{type:"string",id:2}}},WorksheetProperties:{fields:{id:{type:"string",id:1},index:{type:"int32",id:2},name:{type:"string",id:3},rowCount:{type:"int32",id:4},colCount:{type:"int32",id:5},sheetState:{type:"SheetState",id:6},sheetView:{type:"SheetView",id:7},sheetFormatPr:{type:"SheetFormatPr",id:8},sheetPr:{type:"SheetPr",id:9},softDelTime:{type:"string",id:10},externalBlock:{type:"ExternalBlock",id:11},importRanges:{rule:"repeated",type:"ImportRangeMeta",id:12}}},SheetFormatPr:{fields:{defaultColWidth:{type:"double",id:1},defaultRowHeight:{type:"double",id:2},outlineLevelRow:{type:"int32",id:3},outlineLevelCol:{type:"int32",id:4}}},SheetView:{fields:{frozenRowCount:{type:"int32",id:1},frozenColCount:{type:"int32",id:2},hideGridLines:{type:"bool",id:3}}},SheetPr:{fields:{tabColor:{type:"Color",id:1},tabType:{type:"SheetTabType",id:2}}},SheetState:{values:{SheetState_UNSPECIFIED:0,SheetState_VISIBlE:1,SheetState_HIDDEN:2}},ExternalBlock:{fields:{blockId:{type:"string",id:1},blockToken:{type:"string",id:2},blockType:{type:"ExternalBlockType",id:3}}},ExternalBlockType:{values:{ExternalBlockType_UNSPECIFIED:0,ExternalBlockType_BITABLE_BLOCK:1,ExternalBlockType_DOCX_BLOCK:2}},SheetTabType:{values:{SheetTabType_UNSPECIFIED:0,SheetTabType_CONNECTOR:1}}}};function Yh(){if(!Uh){var e=ut.Root.fromJSON(zh);Uh=e.lookupType("Commands")}return Uh}function Xh(e){var t=Yh().verify(e);if(t)throw new Error(t);return function(e){return(0,Ke.gzip)(e)}(Yh().encode(Yh().create(e)).finish())}function Kh(e){var t=function(e){return(0,Ke.ungzip)(e,!0)}(e),n=Yh().decode(t);return function(e){qh(e,{})}(n),n}function qh(e,t){if(e&&"object"==(0,r.Z)(e)&&!Array.isArray(e)){for(var n in e.__proto__=t.__proto__,e)if(e.hasOwnProperty(n)){if("object"!=(0,r.Z)(e[n]))continue;Array.isArray(e[n])&&0===e[n].length?delete e[n]:e[n].__proto__.hasOwnProperty("toNumber")?e[n]=e[n].toNumber():qh(e[n],t)}}else if(Array.isArray(e))for(var i=0;i<e.length;i++)qh(e[i],t)}!function(e){e[e.None=1]="None",e[e.AscSort=2]="AscSort",e[e.DescSort=4]="DescSort",e[e.FilterDefault=8]="FilterDefault",e[e.Filter=16]="Filter",e[e.FilterSort=32]="FilterSort",e[e.Expand=64]="Expand",e[e.Collapse=128]="Collapse"}(Zh||(Zh={}))},vsh_21955:function(e,t,n){"use strict";n.d(t,{a5:function(){return b},lC:function(){return E},Mn:function(){return w},EZ:function(){return S}});var r=n("vsh_1139"),i=n("vsh_67017"),o=n.n(i),a=n("vsh_98652"),s=n("vsh_19264"),u=n("vsh_4175"),l=n("vsh_47253"),c=n("vsh_47246"),h=n("vsh_72834"),d=n("vsh_24627"),f=n("vsh_52690"),p=n("vsh_8282"),v=n("vsh_82905"),g=n("vsh_22485"),_="ShellManagerPlugin",y=function(){function e(){(0,s.Z)(this,e),this.name=_,this.shellMap=new Set,this.watcher=new d.CPL}return(0,u.Z)(e,[{key:"init",value:function(){}},{key:"shellForEach",value:function(e){this.shellMap.forEach(e)}},{key:"mountSheet",value:function(e,t){t.updateSheet(e),t.exec()}},{key:"registerShell",value:function(e){var t=this;this.shellMap.add(e),e.subscribePropagation((function(n){var r=n.type,i=n.props;e.active&&t.watcher.dispatch(r,{shell:e,props:i})}))}},{key:"destroyShell",value:function(e){this.shellMap.delete(e),e.exit()}},{key:"destroyAllShells",value:function(){this.shellMap.forEach((function(e){e.exit()})),this.shellMap.clear()}},{key:"subscribe",value:function(e,t){return this.watcher.subscribe(e,t)}},{key:"unsubscribe",value:function(e,t){this.watcher.unsubscribe(e,t)}},{key:"destroy",value:function(){this.watcher.destroy(),this.destroyAllShells()}}]),e}(),m=function(){function e(){(0,s.Z)(this,e),this.moduleMap=new Map,this.watcherMap=new Map,this.paths=[],this.eventsMap=new Map}return(0,u.Z)(e,[{key:"getState",value:function(e){var t=e.split("/"),n=this.moduleMap.get(t[0]);if(n){for(var r=n.state,i=1,o=t.length;i<o;i++){if(!(t[i]in r))return;r=r[t[i]]}return r}}},{key:"commit",value:function(e,t,n){var r=this,i=e.split("/"),o=i[0],a=i[1],s=this.moduleMap.get(o);if(s){var u=s.commit[a];if(u){var l=s.state;u(s.state,t),this.paths.length&&this.paths.unshift({value:s.state,oldValue:l,path:o});var c=this.paths.slice(0);this.paths.length=0;for(var h=function(e){var t=c[e],i=t.path,o=t.value,a=t.oldValue;(r.watcherMap.get(i)||[]).slice().forEach((function(e){e(o,a,n)}))},d=c.length-1;d>=0;d--)h(d)}}}},{key:"watch",value:function(e,t){var n=this.watcherMap.get(e);n||(n=[],this.watcherMap.set(e,n)),n.push(t)}},{key:"unWatch",value:function(e,t){var n=this.watcherMap.get(e)||[],r=n.indexOf(t);r>=0&&n.splice(r,1)}},{key:"registerModule",value:function(e){var t=this;if(!this.hasModule(e.namespace)){var n=(0,c.default)(e);this.moduleMap.set(n.namespace,n);var r=n.state;Object.keys(r).forEach((function(e){var i=r[e],o=t.paths;Object.defineProperty(r,e,{get:function(){return i},set:function(t){var r=i;i=t,o.push({path:n.namespace+"/"+e,value:t,oldValue:r})}})}))}}},{key:"dispatchEvent",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0],i=t.slice(1),o=this.eventsMap.get(r);o&&(0,a.Z)(o).forEach((function(e){return e.apply(void 0,(0,a.Z)(i))}))}},{key:"subscribeEvent",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n[0],o=n[1],a=this.eventsMap.get(i);return a||(a=[],this.eventsMap.set(i,a)),a.push(o),new f.w((function(){return e.unsubscribeEvent(i,o)}))}},{key:"unsubscribeEvent",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0],i=t[1],o=this.eventsMap.get(r);if(!o)return!0;for(var a=o.length-1;a>=0;--a)if(o[a]===i)return o.splice(a,1),!0;return!1}},{key:"subscribeEventMap",value:function(e){var t=this;return Object.keys(e).forEach((function(n){t.subscribeEvent(n,e[n])})),new f.w((function(){t.unsubscribeEventMap(e)}))}},{key:"unsubscribeEventMap",value:function(e){var t=this;Object.keys(e).forEach((function(n){t.unsubscribeEvent(n,e[n])}))}},{key:"hasModule",value:function(e){return this.moduleMap.has(e)}},{key:"reset",value:function(){this.moduleMap.clear(),this.watcherMap.clear(),this.eventsMap.clear(),this.paths.length=0}}]),e}();var E=function(){function e(){(0,s.Z)(this,e),this.map=new Map,this.reset()}return(0,u.Z)(e,[{key:"clear",value:function(){this.map.clear(),this.reset()}},{key:"reset",value:function(){this.head={},this.tail={},this.tail.prev=this.head,this.head.next=this.tail}},{key:"has",value:function(e){return this.map.has(e)}},{key:"peek",value:function(){return this.head.next===this.tail?null:this.head.next.value}},{key:"append",value:function(e){var t={value:e,prev:this.tail.prev,next:this.tail};this.insert(t)}},{key:"unshift",value:function(e){var t={value:e,prev:this.head,next:this.head.next};this.insert(t)}},{key:"shift",value:function(){var e=this.head.next;return e===this.tail?null:(this.remove(e.value),e.value)}},{key:"insert",value:function(e){e.prev.next=e,e.next.prev=e,this.remove(e.value),this.map.set(e.value,e)}},{key:"remove",value:function(e){var t=this.map.get(e);null!=t&&(t.prev.next=t.next,t.next.prev=t.prev,this.map.delete(e))}},{key:"values",value:o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.head.next;case 1:if(t===this.tail){e.next=7;break}return e.next=4,t.value;case 4:t=t.next;case 5:e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))},{key:"size",get:function(){return this.map.size}}]),e}(),b="FormulaCalculationPlugin",T={timeQuantum:20},C=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T;(0,s.Z)(this,e),this.options=n,this.name=b,this.spread=null,this.queue=new E,this.hasFormulasCalculationJob=!1,this.spreadSubscriber=null,this.asyncFormulasPromise=null,this.needClearFuncCache=!1,this.registerFormulasCalculationJob=function(){var e;t.hasFormulasCalculationJob||t.asyncFormulasPromise||(t.hasFormulasCalculationJob=!0,null===(e=t.spread)||void 0===e||e.sheetIdle.registerIdleCallback(t.calculateDirtyFormulas,200))},this.unregisterFormulasCalculationJob=function(){var e;(t.hasFormulasCalculationJob||t.asyncFormulasPromise)&&(t.hasFormulasCalculationJob=!1,null===(e=t.spread)||void 0===e||e.sheetIdle.unRegisterIdleCallback(t.calculateDirtyFormulas))},this.handleActiveSheetChanged=function(e){var n,r=e.newSheet,i=r.id(),o=function e(n){var r=n.sheetId;if(r===i){var o=t.spread.getCalcEngine().formulaService.getFormulasInSheet(r);if(o){var a=[];o.forEach((function(e){a.push(e.getId())})),t.increaseFormulasPriority(r,a)}t.sdk.pluginStore.unsubscribeEvent("LoadStatusStore/WorksheetLoaded",e)}};2!==(null===(n=t.sdk.getPluginState("LoadStatusStore/sheets"))||void 0===n?void 0:n[r.id()])?t.sdk.pluginStore.subscribeEvent("LoadStatusStore/WorksheetLoaded",o):o({sheetId:i})},this.increaseUserChangedFormulasPriority=function(e){var n=e.range,r=e.type,i=n.sheet();if(i&&0!==r){var o=[];(0,h.KST)(n,(function(e,t){var n=i.getVar(e,t);n.isFormula()&&o.push(n.getId())})),o.length>0&&t.increaseFormulasPriority(i.id(),o)}},this.calculateDirtyFormulas=function(){t.hasFormulasCalculationJob=!1;var e=t.spread;if(null!=e){var n=e.getCalcEngine(),r=n.formulaSpace,i=n.formulaService,o=n.statistics,a=n.cfmStatistics,s=n.pivotStatistics;i.isSuspended()||(t.needClearFuncCache=!1,t.calculateDirtyFormulasInTimeQuantum(),r.dirtyFormulas.size||(!o.isFirstCalcFinish&&o.onFirstCalcFinished(r.formulas.size),n.pivotCalculateEngine.getPivotFormulaCount()&&(!s.isFirstCalcFinish&&s.onFirstCalcFinished(n.pivotCalculateEngine.getPivotFormulaCount()),s.onCalcFinished())),n.conditionalDirtyFormulas.size||a.isFirstCalcFinish||a.onFirstCalcFinished(r.formulas.size),r.dirtyFormulas.size>0||n.conditionalDirtyFormulas.size>0?t.registerFormulasCalculationJob():(t.needClearFuncCache=!0,t.clearFuncCache(),n.formulaService.emit("formulaCalcFinished")))}},this._clearFuncCache=function(){var e;t.needClearFuncCache&&(null===(e=t.spread)||void 0===e||e.getCalcEngine().formulaService.getFuncCacheManager().clear())},this.clearFuncCache=(0,l.default)(this._clearFuncCache,5e3)}return(0,u.Z)(e,[{key:"init",value:function(e){this.sdk=e,this.spread=e.spread,this.registerFormulasCalculationJob();var t=this.spread.getCalcEngine(),n=t.formulaSpace,r=t.formulaService;n.addListener(g.FormulaSpaceEvents.onBatchFormulasDirty,this.registerFormulasCalculationJob),r.addListener(g.FormulaEvents.onResumed,this.registerFormulasCalculationJob).addListener(g.FormulaEvents.onSuspended,this.unregisterFormulasCalculationJob),this.spreadSubscriber=this.spread.subscribe({ActiveSheetChanged:this.handleActiveSheetChanged,RangeChanged:this.increaseUserChangedFormulasPriority,ConditionalFormulaDirty:this.registerFormulasCalculationJob})}},{key:"increaseFormulasPriority",value:function(e,t){null!=this.spread&&this.queue.unshift([e,t.reverse()])}},{key:"calculateDirtyFormulasInTimeQuantum",value:function(){var e=this,t=this.spread.getCalcEngine(),n=t.formulaSpace,i=t.statistics,o=t.cfmStatistics,a=t.pivotStatistics,s=0,u=0,l=0;!i.isFirstCalcEnd&&i.onFirstCalcStart(),!o.isFirstCalcEnd&&o.onFirstCalcStart(),!a.isFirstCalcEnd&&a.onFirstCalcStart();for(var c=performance.now(),d=this.queue.peek();null!=d;d=this.queue.peek()){for(var f=d,p=(0,r.Z)(f,2),v=p[0],g=p[1],_=g.pop();null!=_;_=g.pop()){var y=t.getFormulaFromId(v,_);if(null!=y&&y.isDirty()&&(y.getVar(),s++),performance.now()-c>this.options.timeQuantum)return}this.queue.shift()}n.iterDirtyFormulas((function(t){return!(0,h.v4_)(t)&&(t.getVar(),s++,performance.now()-c>e.options.timeQuantum)}));var m=performance.now()-c,E=Date.now();n.iterDirtyFormulas((function(t){return t.getVar(),l++,performance.now()-c>e.options.timeQuantum}));var b=Date.now()-E,T=Date.now();if(0===n.dirtyFormulas.size&&t.conditionalDirtyFormulas.size>0){var C=new Map;t.conditionalDirtyFormulas.forEach((function(e){var t=Date.now();e.getVar(),u++;var n=Date.now();C.set(e,n-t)})),this.spread.dispatch("ConditionalFormulaChanged",[t.conditionalDirtyFormulas,C]),t.conditionalDirtyFormulas.clear()}var S=Date.now()-T;s&&i.onFirstCalcEnd(m,s),u&&o.onFirstCalcEnd(S,u),l&&a.onFirstCalcEnd(b,l),l&&b&&a.onCalcEnd(b,l)}},{key:"destroy",value:function(){var e;if(this.unregisterFormulasCalculationJob(),this.clearFuncCache.cancel(),null!=this.spread){var t=this.spread.getCalcEngine(),n=t.formulaSpace,r=t.formulaService;n.removeListener(g.FormulaSpaceEvents.onBatchFormulasDirty,this.registerFormulasCalculationJob),r.removeListener(g.FormulaEvents.onResumed,this.registerFormulasCalculationJob).removeListener(g.FormulaEvents.onSuspended,this.unregisterFormulasCalculationJob)}null!==(e=this.spreadSubscriber)&&void 0!==e&&e.unsubscribe(),this.spreadSubscriber=null,this.spread=null,this.sdk=null}}]),e}(),S=function(){function e(t,n){var r=this;(0,s.Z)(this,e),this.pluginMap=new Map,this.pluginStore=new m,this.suspendCount=0,this.wb=t instanceof h.IEE?t:new h.IEE(Object.assign({getHost:function(e){var t;return(null===(t=r.getPlugin("FocusPlugin"))||void 0===t?void 0:t.getHost(e))||null},setFocus:function(e){var t;null===(t=r.getPlugin("FocusPlugin"))||void 0===t||t.setFocus(e)},resetFocus:function(e){var t;null===(t=r.getPlugin("FocusPlugin"))||void 0===t||t.resetFocus(e)}},t),n),this.sdkIOC=function(e){var t=new p.W;return t.bind(v.UU).toConstantValue(e.getService(v.UU)),t.bind(v.tb).toConstantValue(e.getService(v.tb)),t.bind(v.Jv).toConstantValue(e.getService(v.Jv)),t.bind(v.QX).toConstantValue(e.getService(v.QX)),t.bind(v.zv).toConstantValue(e.getService(v.zv)),t.bind(v.Tl).to(v.XS).inSingletonScope(),t.bind(v.pV).to(v.Yv).inSingletonScope(),t.bind(v.ry).toFactory((function(){return function(e){return new v.t(e)}})),t.bind(v.B2).to(v.s2).inSingletonScope(),t}(this.wb),this.registerBuiltInPlugins()}return(0,u.Z)(e,[{key:"injectServices",value:function(e,t){e(this.sdkIOC),t&&this.spread.injectServices(t)}},{key:"getService",value:function(e){return this.sdkIOC.get(e)}},{key:"unbindService",value:function(e){return this.sdkIOC.unbind(e)}},{key:"getPlugin",value:function(e){return this.pluginMap.get(e)}},{key:"registerPlugin",value:function(e){Array.isArray(e)||(e=[e]);var t=this;e.reduce((function(e,n){return e.set(n.name,n),n.init({spread:t.spread,pluginStore:t.pluginStore,shellManager:t.shellManager,getPlugin:t.getPlugin.bind(t),isSuspended:t.isSuspended.bind(t),getService:t.getService.bind(t),shellForEach:t.shellForEach.bind(t),getPluginState:t.getPluginState.bind(t),registerPlugin:t.registerPlugin.bind(t),unregisterPlugin:t.unregisterPlugin.bind(t),mountSheet:t.mountSheet.bind(t),subscribePluginEventMap:t.subscribePluginEventMap.bind(t),unsubscribePluginEventMap:t.unsubscribePluginEventMap.bind(t)}),e}),this.pluginMap)}},{key:"unregisterPlugin",value:function(e){var t=this.pluginMap.get(e);return!!t&&(t.destroy(),this.pluginMap.delete(t.name),!0)}},{key:"unregisterAllPlugins",value:function(){this.pluginMap.forEach((function(e){e.destroy()})),this.pluginMap.clear()}},{key:"mountSheet",value:function(e,t,n){var r;this.pluginMap.forEach((function(r){var i;return null===(i=r.onSheetMount)||void 0===i?void 0:i.call(r,e,t,n)})),null===(r=this.getPlugin(_))||void 0===r||r.mountSheet(e,t)}},{key:"registerShell",value:function(e){var t;null!==(t=this.getPlugin(_))&&void 0!==t&&t.registerShell(e),this.pluginMap.forEach((function(t){var n;return null===(n=t.onShellRegistered)||void 0===n?void 0:n.call(t,e)}))}},{key:"destroyShell",value:function(e){var t;null===(t=this.getPlugin(_))||void 0===t||t.destroyShell(e)}},{key:"shellForEach",value:function(e){var t;null===(t=this.getPlugin(_))||void 0===t||t.shellForEach(e)}},{key:"isSuspended",value:function(){return this.suspendCount>0}},{key:"suspend",value:function(){this.suspendCount+=1}},{key:"resume",value:function(){this.suspendCount=Math.max(0,this.suspendCount-1)}},{key:"getPluginState",value:function(e){return this.pluginStore.getState(e)}},{key:"watchPluginState",value:function(e,t){return this.pluginStore.watch(e,t)}},{key:"unwatchPluginState",value:function(e,t){return this.pluginStore.unWatch(e,t)}},{key:"subscribePluginEvent",value:function(){var e;return(e=this.pluginStore).subscribeEvent.apply(e,arguments)}},{key:"unsubscribePluginEvent",value:function(){var e;return(e=this.pluginStore).unsubscribeEvent.apply(e,arguments)}},{key:"subscribePluginEventMap",value:function(e){return this.pluginStore.subscribeEventMap(e)}},{key:"unsubscribePluginEventMap",value:function(e){return this.pluginStore.unsubscribeEventMap(e)}},{key:"destroy",value:function(){this.unregisterAllPlugins(),this.sdkIOC.unbindAll(),this.pluginStore.reset(),this.wb.destroy()}},{key:"registerBuiltInPlugins",value:function(){this.registerPlugin([new y,new C])}},{key:"spread",get:function(){return this.wb}},{key:"shellManager",get:function(){return this.getPlugin(_)}}]),e}();function w(e){var t=e.required||[],n=e.optional;return function(e){var r=e.prototype.init;return e.prototype.init=function(e){var i=[],o=[];if(t.forEach((function(t){e.getService(t)||i.push(t)})),null!=n&&n.forEach((function(t){try{e.getService(t)||o.push(t)}catch(e){o.push(t)}})),i.length)throw console.log("missing required deps:",i),new Error("the required services which ".concat(this.name," plugin needed were not injected."));o.length&&console.warn("the optional services which ".concat(this.name," plugin needed were not injected."),o);for(var a=new Set(t),s=new Set(n),u=e.getService,l=arguments.length,c=new Array(l>1?l-1:0),h=1;h<l;h++)c[h-1]=arguments[h];return e.getService=function(t){if(!a.has(t)&&!s.has(t))throw new Error("service is not declared! please declare in ServicesDepDeclare decorator first");if(s.has(t))try{return u.call(e,t)}catch(e){return null}return u.call(e,t)},r.call.apply(r,[this,e].concat(c))},e}}},vsh_82905:function(e,t,n){"use strict";n.d(t,{jK:function(){return _.D1r},j6:function(){return R},Qh:function(){return I},UU:function(){return C},lO:function(){return S},pV:function(){return O},Yv:function(){return M},tb:function(){return x},E4:function(){return N},yd:function(){return G},Tl:function(){return V},XS:function(){return H},FP:function(){return F},NI:function(){return B},Jv:function(){return U},Dp:function(){return W},QX:function(){return P},mQ:function(){return D},f3:function(){return j},zv:function(){return z},zB:function(){return X},B2:function(){return K},s2:function(){return q},kM:function(){return $},Oc:function(){return J},Vw:function(){return w},ry:function(){return Q},t:function(){return ee}});var r=n("vsh_67017"),i=n.n(r),o=n("vsh_35067"),a=n("vsh_74561"),s=n("vsh_19264"),u=n("vsh_4175"),l=n("vsh_65498"),c=n("vsh_4561"),h=n("vsh_29033"),d=(n("vsh_1278"),n("vsh_99520")),f=n("vsh_22392"),p=n("vsh_47531"),v=n("vsh_73565"),g=n.n(v),_=n("vsh_24627"),y=n("vsh_93631"),m=(n("vsh_61028"),n("vsh_14499"));function E(e){return"".concat("base","/").concat(e)}function b(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==("undefined"==typeof Reflect?"undefined":(0,l.Z)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function T(e,t){return function(n,r){t(n,r,e)}}"function"==typeof SuppressedError&&SuppressedError;var C=E("client-meta"),S=function(){function e(){(0,s.Z)(this,e),this._metaData={token:"",userId:"",memberId:-1}}return(0,u.Z)(e,[{key:"setMeta",value:function(e){Object.assign(this._metaData,e)}},{key:"getMeta",value:function(){return Object.assign({},this._metaData)}},{key:"token",get:function(){return this._metaData.token}},{key:"userId",get:function(){return this._metaData.userId}},{key:"memberId",get:function(){return this._metaData.memberId}}]),e}();S=b([(0,d.b)()],S);var w,R,A,O=E("sheet-clipboard"),M=function(){function e(){var t=this;(0,s.Z)(this,e),this.eventEmitter=new(g()),this.pasteHandler=function(e){var n=t.wrapClipboardEvent(e);t.emitEvent("paste",n)},this.copyHandler=function(e){var n=t.wrapClipboardEvent(e);t.emitEvent("copy",n)},this.cutHandler=function(e){var n=t.wrapClipboardEvent(e);t.emitEvent("cut",n)},this.createElement()}return(0,u.Z)(e,[{key:"register",value:function(e,t){this.eventEmitter.addListener(e,t)}},{key:"unregister",value:function(e,t){this.eventEmitter.removeListener(e,t)}},{key:"dispatchClipboardEvent",value:function(e){this._textarea.dispatchEvent(e)}},{key:"emitEvent",value:function(e,t){this.eventEmitter.emit(e,t)}},{key:"focus",value:function(){this._textarea.focus()}},{key:"select",value:function(){this._textarea.select()}},{key:"blur",value:function(){this._textarea.blur()}},{key:"focusForClipboard",value:function(){_.Ps3.browser.isLark&&(_.Ps3.browser.isMobile||_.Ps3.browser.isIPad)||this.focus(),this.select()}},{key:"destroy",value:function(){var e=this._textarea;e.removeEventListener("paste",this.pasteHandler),e.removeEventListener("copy",this.copyHandler),e.removeEventListener("cut",this.cutHandler);var t=this._container,n=t.parentElement;n&&n.removeChild(t)}},{key:"createElement",value:function(){var e=document.createElement("div");e.style.position="fixed",e.style.top="-100px",e.style.left="-100px",e.style.width="0px",e.style.height="0px",e.style.overflow="hidden",this._container=e;var t=document.createElement("textarea");t.dataset.sheetElement="sheetClipboard",!_.Ps3.browser.isLark&&_.Ps3.browser.isIPad||t.setAttribute("readonly","true"),t.tabIndex=-1,t.style.position="absolute",t.style.overflow="hidden",t.style.background="white",t.style.webkitUserSelect="text",t.value=" ",e.appendChild(t),this._textarea=t,t.addEventListener("paste",this.pasteHandler),t.addEventListener("copy",this.copyHandler),t.addEventListener("cut",this.cutHandler),document.body.appendChild(this._container)}},{key:"wrapClipboardEvent",value:function(e){var t={},n=e.clipboardData;if(n){var r=n.getData;n._originGetDataForSheet=r,e.clipboardData.getData=function(e){return t[e]||(t[e]=n._originGetDataForSheet(e))}}return e}}]),e}();b([(0,f.P)()],M.prototype,"destroy",null),M=b([(0,d.b)()],M),(A=w||(w={}))[A.CONTENTCOPY=0]="CONTENTCOPY",A[A.CREATECOPY=1]="CREATECOPY",A[A.EXPORT=2]="EXPORT",A[A.PRINT=3]="PRINT",A[A.DOWNLOAD=4]="DOWNLOAD",A[A.DOCCONTENTCOPY=5]="DOCCONTENTCOPY",A[A.FILECONTENTCOPY=6]="FILECONTENTCOPY",A[A.DOCPRINT=7]="DOCPRINT",A[A.FILEPRINT=8]="FILEPRINT",A[A.DOCCREATECOPY=9]="DOCCREATECOPY",A[A.DOCEXPORT=10]="DOCEXPORT",A[A.DOCDOWNLOAD=11]="DOCDOWNLOAD",A[A.FILECREATECOPY=12]="FILECREATECOPY",A[A.FILEEXPORT=13]="FILEEXPORT",A[A.FILEDOWNLOAD=14]="FILEDOWNLOAD",A[A.ATTACHMENTDOWNLOAD=15]="ATTACHMENTDOWNLOAD",A[A.UPLOAD=16]="UPLOAD",A[A.EXTERNALACCESS=17]="EXTERNALACCESS",function(e){e[e.CHECKING=2004]="CHECKING",e[e.DELETED=3]="DELETED",e[e.NORMAL=1]="NORMAL"}(R||(R={}));var k,I=E("conditionalAccessControlService"),x=E("config"),N=function(){function e(){(0,s.Z)(this,e),this._configMap={}}return(0,u.Z)(e,[{key:"register",value:function(e){Object.assign(this._configMap,e)}},{key:"resolve",value:function(e,t){if((0,h.default)(this._configMap[e])){if((0,h.default)(t))throw new Error("configService resolve ".concat(String(e)," failed and no fallback value"));return t}return this._configMap[e]()}},{key:"destroy",value:function(){this._configMap={}}}]),e}();b([(0,f.P)()],N.prototype,"destroy",null),N=b([(0,d.b)()],N);var P=E("logger"),L="sheet-log-no-mix",D=k=function(){function e(){(0,s.Z)(this,e),this._enable=k.getDefaultEnable()}return(0,u.Z)(e,[{key:"enable",value:function(){return this._enable}},{key:"log",value:function(e,t,n,r){if(this._enable)return k.logger.log("%c[sheet][".concat(e,"]: ").concat(t),"color: #6eb6ff",n,r)}},{key:"info",value:function(e,t,n){if(this._enable)return k.logger.info("[sheet][".concat(e,"]: "),t,n)}},{key:"error",value:function(e,t,n,r){if(this._enable)return k.logger.error("[".concat(e,"]: ").concat(t),n,r)}},{key:"logMixedObject",value:function(e,t,n,r){if(this._enable)return k.logger.log("[".concat(e,"]"),t,(0,_.W43)(n,r))}},{key:"setEnable",value:function(e){this._enable=e,k.setDefaultEnable(e)}}],[{key:"getDefaultEnable",value:function(){var e=!(0,h.default)(window)&&window.localStorage&&!!window.localStorage.getItem(L),t="function"!=typeof k.logger.enabled||k.logger.enabled(k.mainScope);return e&&t}},{key:"setDefaultEnable",value:function(e){!(0,h.default)(window)&&window.localStorage&&(e?window.localStorage.setItem(L,"1"):window.localStorage.removeItem(L)),"function"==typeof k.logger.enable&&e?k.logger.enable(k.mainScope):"function"!=typeof k.logger.disable||e||k.logger.disable(k.mainScope)}}]),e}();D.mainScope="sheet",D.logger=console,D=k=b([(0,d.b)()],D);var F,B,V="error-recorder";!function(e){e.Core="Core",e.Plugin="Plugin",e.Service="Service",e.Module="Module"}(F||(F={})),function(e){e.ClientError="ClientError",e.ServerError="ServerError",e.NetworkError="NetworkError"}(B||(B={}));var H=function(){function e(t){(0,s.Z)(this,e),this.loggerService=t,this.error$=new y.xQ}return(0,u.Z)(e,[{key:"record",value:function(e,t,n,r){this.error$.next({scope:e,type:t,code:n,data:r}),this.loggerService.log("error-service","error occurred scope:".concat(e,", type: ").concat(t,", code: ").concat(n),r)}},{key:"subscribeError",value:function(e){return this.error$.subscribe(e)}},{key:"destroy",value:function(){this.error$.unsubscribe()}}]),e}();b([(0,f.P)()],H.prototype,"destroy",null),H=b([(0,d.b)(),T(0,(0,p.f)(P))],H);var U=E("i18n");function Z(e){return e}var W=function(){function e(){(0,s.Z)(this,e),this._tFunc=Z}return(0,u.Z)(e,[{key:"setTFunc",value:function(e){this._tFunc=e}},{key:"t",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this._tFunc.apply(this,[e].concat(n))}}]),e}();W=b([(0,d.b)()],W);var j=E("permission"),G={curRangeEditable:!1,curRowEditable:!1,curColEditable:!1,curSheetEditable:!1,curSheetVisiblePerm:!1},z=E("reporter"),Y={teaLog:c.default,ravenCatch:c.default,suspend:c.default,resume:c.default},X=function(){function e(t){(0,s.Z)(this,e),this.configService=t,this.reporter=Y,this.reportTemplates=new Map}return(0,u.Z)(e,[{key:"setReporter",value:function(e){this.reporter=e}},{key:"eventReport",value:function(e){this.reporter.teaLog(e)}},{key:"eventReportWithTemplate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.reportTemplates.get(e);r?r(t,this.reporter.teaLog):n&&t.key&&this.reporter.teaLog(t)}},{key:"addReportTemplate",value:function(e,t){this.reportTemplates.set(e,t)}},{key:"suspend",value:function(){this.reporter.suspend()}},{key:"resume",value:function(){this.reporter.resume()}},{key:"captureException",value:function(e,t){t.scm||(t.scm=JSON.stringify(this.configService.resolve("scmInfo",""))),this.reporter.ravenCatch(e,{tags:t})}},{key:"destroy",value:function(){this.reportTemplates.clear(),this.reporter=Y}}]),e}();b([(0,f.P)()],X.prototype,"destroy",null),X=b([(0,d.b)(),T(0,(0,p.f)(x))],X);var K=E("shared-buffer"),q=function(){function e(){(0,s.Z)(this,e),this.bufferPool=new Map}return(0,u.Z)(e,[{key:"setItem",value:function(e,t){this.bufferPool.set(e,t)}},{key:"getItem",value:function(e){var t;return null!==(t=this.bufferPool.get(e))&&void 0!==t?t:null}},{key:"getItemOnce",value:function(e){var t=this.bufferPool.get(e);return t?(this.removeItem(e),t):null}},{key:"removeItem",value:function(e){this.bufferPool.delete(e)}},{key:"clear",value:function(){this.bufferPool.clear()}}]),e}();b([(0,f.P)()],q.prototype,"clear",null),q=b([(0,d.b)()],q);var $=E("tracker"),J=function(){function e(){(0,s.Z)(this,e),this.commonParamsMap=new Map,this.trackData=new Map,this.trackRules=new Map}return(0,u.Z)(e,[{key:"getTrackData",value:function(e){return this.trackData.get(e)}},{key:"cleanTrackData",value:function(e){this.trackData.delete(e)}},{key:"addCommonParamsCollector",value:function(e){this.commonParamsMap.set(e.key,e)}},{key:"collect",value:function(e,t){var n={},r={nowTime:performance.now()};this.commonParamsMap.size&&this.commonParamsMap.forEach((function(t){(t.defaultOn&&t.blacklist.size&&!t.blacklist.has(e)||!t.defaultOn&&t.whitelist.size&&t.whitelist.has(e))&&Object.assign(r,(0,a.Z)({},t.key,t.collect()))})),Object.assign(n,t,r);var i=this.trackData.get(e)||[];i.push(n),this.trackData.set(e,i),this.track(e)}},{key:"addTrackRules",value:function(e){var t=this;e.forEach((function(e){t.trackRules.get(e.key)&&console.warn("TrackRule repeated, will overwrite current rule"),t.trackRules.set(e.key,e)}))}},{key:"removeTrackRules",value:function(e){var t=this;Array.isArray(e)?e.forEach((function(e){t.trackRules.delete(e)})):this.trackRules.delete(e)}},{key:"destroy",value:function(){this.trackData.clear(),this.trackRules.clear(),this.commonParamsMap.clear()}},{key:"track",value:function(e){var t=this.trackRules.get(e);t&&t.track&&t.track({getData:this.getTrackData.bind(this,e),cleanData:this.cleanTrackData.bind(this,e),reporter:_.PxA})}}]),e}();J=b([(0,d.b)()],J);var Q=E("worker-rpc"),ee=function(){function e(t){return(0,s.Z)(this,e),this.workerMessageHandlerMap=new Map,this.originalWorker=t,this.worker=(0,m.Ud)(t),this.addListener(t),this.getProxy("")}var t;return(0,u.Z)(e,[{key:"getProxy",value:function(e){try{var t=this;return new Proxy(this,{get:function(n,r){return n[r]?n[r]||(n[r]=t.getProxy(e)):t.worker[r]},set:function(e,t,n){return!1}})}catch(e){return console.error("in WorkerRPCService Proxy",e.message),{}}}},{key:"addListener",value:function(e){var t=this;e.addEventListener("message",(function(e){var n=e.data,r=n.type,i=n.data,o=n.time;if(void 0!==r){var a=t.workerMessageHandlerMap.get(r);if(a&&a.length>0)try{a.forEach((function(e){return e(i,o)}))}catch(e){console.error("Worker message handler error: ",e)}}}))}},{key:"addMessageHandler",value:function(e,t){var n=this.workerMessageHandlerMap.get(e);return n?!n.includes(t)&&(n.push(t),!0):(this.workerMessageHandlerMap.set(e,[t]),!0)}},{key:"removeMessageHandler",value:function(e,t){var n=this.workerMessageHandlerMap.get(e);if(!n)return!1;var r=n.indexOf(t);return r>=0&&(n.splice(r,1),!0)}},{key:"destroy",value:(t=(0,o.Z)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.workerMessageHandlerMap.clear(),null!==(t=this.worker)&&void 0!==t&&t[m.Yy](),this.originalWorker.terminate();case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}();ee=b([(0,d.b)()],ee)},vsh_7959:function(e,t,n){"use strict";n.d(t,{L91:function(){return mc},NBN:function(){return wc},wwp:function(){return Ec},hCs:function(){return Tc},Stn:function(){return bc},Nn3:function(){return yc},B_c:function(){return Sc},Uo:function(){return Cc},QSY:function(){return _c},nJ$:function(){return Hf},UMr:function(){return Bf},DHY:function(){return Vf},jO7:function(){return vd},Lym:function(){return pd},Ndp:function(){return Tf},WPM:function(){return U_},X2l:function(){return Z.X2l},pG9:function(){return V_},eBB:function(){return im},ilW:function(){return eE},Vzn:function(){return jm},SCW:function(){return Ov},hIB:function(){return Nm},C2X:function(){return Df},XX7:function(){return lE},djl:function(){return Vv},mhL:function(){return jv},T0_:function(){return Zm},BcS:function(){return vc},uGN:function(){return pb},HA9:function(){return Um},qMA:function(){return gp},SnY:function(){return VE},tvt:function(){return Oc},vDs:function(){return ph},oai:function(){return jE},uoB:function(){return UE},A6x:function(){return HE},IQy:function(){return zc},oV9:function(){return Gc},xUQ:function(){return Yc},Ch4:function(){return oh},Ik:function(){return ih},We6:function(){return Hc},aO6:function(){return Vc},hUz:function(){return Uc},Kq$:function(){return Zc},fA5:function(){return jc},Jqb:function(){return Wc},RV0:function(){return Xc},W$w:function(){return qc},QN$:function(){return Kc},rMb:function(){return XE},oaX:function(){return eb},rmK:function(){return Gv},Y6L:function(){return My},Sm4:function(){return Jd},MWT:function(){return dc},VNO:function(){return $d},ebx:function(){return Kd},wOx:function(){return N.getThemeColorByToken},LUx:function(){return K_},MF3:function(){return RE},MUF:function(){return F_},rB7:function(){return zE},e2d:function(){return Py},G_f:function(){return Dm},loA:function(){return Yh},Ue9:function(){return Xh},DLR:function(){return Ah},i9H:function(){return Bc},sJF:function(){return Rh},z8O:function(){return rd},Ehf:function(){return mf},WgK:function(){return bf},Y_t:function(){return vb},J$l:function(){return Ny}});var r=n("vsh_67017"),i=n.n(r),o=n("vsh_35067"),a=n("vsh_98652"),s=n("vsh_93035"),u=n("vsh_65498"),l=n("vsh_56589"),c=n("vsh_1139"),h=n("vsh_19264"),d=n("vsh_4175"),f=n("vsh_12064"),p=n("vsh_22462"),v=n("vsh_73455"),g=n("vsh_74561"),_=n("vsh_70098"),y=n("vsh_13867"),m=n("vsh_27679"),E=n("vsh_59980"),b=n("vsh_4468"),T=n("vsh_95436"),C=n("vsh_47253"),S=n("vsh_96636"),w=n("vsh_4561"),R=n("vsh_47246"),A=n("vsh_65726"),O=n("vsh_22023"),M=n("vsh_78400"),k=n("vsh_33916"),I=n("vsh_91497"),x=n("vsh_72834"),N=n("vsh_69691"),P=n("vsh_6127"),L=n.n(P),D=n("vsh_73565"),F=n.n(D),B=n("vsh_33476"),V=n.n(B),H=n("vsh_82905"),U=n("vsh_7121"),Z=n("vsh_24627"),W=n("vsh_64299"),j=n("vsh_99073"),G=n("vsh_22052"),z=n("vsh_52690"),Y=n("vsh_4285"),X=n("vsh_67295"),K=n("vsh_93631"),q=n("vsh_65949"),$=n("vsh_59992"),J=n("vsh_40742"),Q=n("vsh_81042"),ee=n("vsh_69831"),te={leading:!0,trailing:!1};Q.L;function ne(e,t,n){return void 0===t&&(t=J.P),void 0===n&&(n=te),function(r){return r.lift(new re(e,t,n.leading,n.trailing))}}var re=function(){function e(e,t,n,r){this.duration=e,this.scheduler=t,this.leading=n,this.trailing=r}return e.prototype.call=function(e,t){return t.subscribe(new ie(e,this.duration,this.scheduler,this.leading,this.trailing))},e}(),ie=function(e){function t(t,n,r,i,o){var a=e.call(this,t)||this;return a.duration=n,a.scheduler=r,a.leading=i,a.trailing=o,a._hasTrailingValue=!1,a._trailingValue=null,a}return q.__extends(t,e),t.prototype._next=function(e){this.throttled?this.trailing&&(this._trailingValue=e,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(oe,this.duration,{subscriber:this})),this.leading&&this.destination.next(e))},t.prototype._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},t.prototype.clearThrottle=function(){var e=this.throttled;e&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),e.unsubscribe(),this.remove(e),this.throttled=null)},t}($.L);function oe(e){e.subscriber.clearThrottle()}var ae,se,ue,le=n("vsh_56489"),ce=n("vsh_75071"),he=n("vsh_39668"),de=n("vsh_42958"),fe=n("vsh_17494"),pe=n("vsh_62536"),ve=n("vsh_71561"),ge=n("vsh_23188"),_e=n("vsh_98085"),ye=n("vsh_3083"),me=n("vsh_8497"),Ee=n("vsh_60029");function be(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Te(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Te(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}new Map;new Set(["slope"]);new Map;new Map;new Map,new Map,new Map;var Ce="Roadster";function Se(e,t,n){return[n?"[".concat(Ce," ").concat(n," ").concat(e,"]: "):"[".concat(Ce," ").concat(e,"]: ")].concat((0,a.Z)(t))}function we(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];console[e].apply(console,Se(t,r))}var Re="Microsoft YaHei",Ae=16,Oe="alphabetic",Me="#70c4ff99",ke="#126fe0",Ie="baseline",xe="black";try{JSON.parse('{"@byted-roadster/engine":"1.0.7","@byted-roadster/lite":"1.2.0","@byted-roadster/scheduler":"1.0.0","shared":"1.0.0","@byted-roadster/unicode":"1.0.0","@byted-roadster/animation":"1.0.0","@byted-roadster/roadster-redux":"1.0.0","@byted-roadster/ui":"1.2.0"}')}catch(pc){}function Ne(){}function Pe(e){return Object.prototype.toString.call(e)}function Le(e){return"string"==typeof e||"[object String]"===Pe(e)}function De(e){return("number"==typeof e||"[object Number]"===Pe(e))&&!Number.isNaN(e)}function Fe(e){var t=e.length;if(t>0)return e[t-1]}function Be(e,t){for(var n={},r=e.length,i=0;i<r;i++)t(n,e[i],i,e);return n}var Ve=Object.assign,He=Be([].concat(["Div","Text","EmbedDOM","EmbedRNode","BlockFlow","InlineFlow","Absolute","Fixed","FlexRow","FlexColumn","Table","TableRow","TableCell","Bitmap","Drawing"],["SuperList","Component","HalfFullscreen"]),(function(e,t){return e[t]=t}));He.Text,He.EmbedDOM,He.EmbedRNode,He.Drawing;var Ue=[He.Div,He.BlockFlow,He.InlineFlow,He.FlexRow,He.FlexColumn,He.HalfFullscreen],Ze=[He.Absolute,He.Fixed],We=[He.FlexRow,He.FlexColumn],je=[He.TableRow,He.FlexRow,He.InlineFlow],Ge=[He.BlockFlow,He.FlexColumn,He.SuperList];He.TableRow,He.FlexRow,He.FlexColumn,He.InlineFlow,He.Text,He.EmbedDOM,He.Bitmap,He.Div,He.Drawing;var ze=[He.Div,He.InlineFlow,He.Component,He.Text],Ye=["Top","Right","Bottom","Left"],Xe=["fontFamily","fontSize","fontColor","fontStyle","fontWeight"],Ke=[].concat(Xe,["lineHeight","forceLineHeight","leading","textIndent","overflowEllipsis","maxLines","weakWidth"],["underline","lineThrough","zoom","cursor"]),qe=[].concat((0,a.Z)(Ke),["alignSelf","flexGrow","flexShrink"],["display","opacity"]),$e=[].concat(Xe,["underline","lineThrough","cursor","zoom","display","opacity"]),Je=["width","minWidth","maxWidth"],Qe=[].concat(Je,["height","minHeight","maxHeight"]),et=Ye.map((function(e){return"margin".concat(e)})),tt=["margin"].concat((0,a.Z)(et)),nt=Ye.map((function(e){return"padding".concat(e)})),rt=["padding"].concat((0,a.Z)(nt)),it=Ye.map((function(e){return"outline".concat(e)})),ot=["outline"].concat((0,a.Z)(it)),at=Ye.map((function(e){return"outline".concat(e,"Width")})),st=["outlineWidth"].concat((0,a.Z)(at)),ut=Ye.map((function(e){return"outline".concat(e,"Style")})),lt=["outlineStyle"].concat((0,a.Z)(ut)),ct=Ye.map((function(e){return"outline".concat(e,"Color")})),ht=["outlineColor"].concat((0,a.Z)(ct)),dt=[].concat((0,a.Z)(it),(0,a.Z)(at),(0,a.Z)(ut),(0,a.Z)(ct)),ft=[].concat((0,a.Z)(ot),(0,a.Z)(st),(0,a.Z)(lt),(0,a.Z)(ht)),pt=[].concat((0,a.Z)(st),(0,a.Z)(ot)),vt=[].concat((0,a.Z)(ct),(0,a.Z)(ut),(0,a.Z)(at)),gt=Ye.map((function(e){return"border".concat(e)})),_t=["border"].concat((0,a.Z)(gt)),yt=Ye.map((function(e){return"border".concat(e,"Width")})),mt=["borderWidth"].concat((0,a.Z)(yt)),Et=Ye.map((function(e){return"border".concat(e,"Style")})),bt=["borderStyle"].concat((0,a.Z)(Et)),Tt=Ye.map((function(e){return"border".concat(e,"Color")})),Ct=["borderColor"].concat((0,a.Z)(Tt)),St=[].concat((0,a.Z)(gt),(0,a.Z)(yt),(0,a.Z)(Et),(0,a.Z)(Tt)),wt=[].concat((0,a.Z)(mt),(0,a.Z)(_t)),Rt=[].concat((0,a.Z)(Tt),(0,a.Z)(Et),(0,a.Z)(yt)),At=[].concat((0,a.Z)(_t),(0,a.Z)(mt),(0,a.Z)(bt),(0,a.Z)(Ct)),Ot={border:{allSide:St,allWidth:wt,allDirection:Rt,widthSide:yt,styleSide:Et,colorSide:Tt},outline:{allSide:dt,allWidth:pt,allDirection:vt,widthSide:at,styleSide:ut,colorSide:ct}},Mt=["TopLeft","TopRight","BottomRight","BottomLeft"].map((function(e){return"border".concat(e,"Radius")})),kt=["bTLR","bTRR","bBRR","bBLR"],It=kt.flatMap((function(e){return["".concat(e,"H"),"".concat(e,"V")]})),xt=["borderRadius"].concat((0,a.Z)(Mt)),Nt=["left","right","top","bottom"],Pt=["width","alignHorizontal","marginCollapse"].concat((0,a.Z)(qe)),Lt=[].concat(["alignMainAxis","alignCrossAxis","stretchDeep"],(0,a.Z)(Qe),(0,a.Z)(qe)),Dt={Component:qe,SuperList:Pt,HalfFullscreen:[].concat((0,a.Z)(Qe),(0,a.Z)(qe)),Div:["backgroundColor","cursor","overflowScrollX","overflowScrollY","outlineOffset","baselineOffset"].concat((0,a.Z)(Qe),(0,a.Z)(tt),(0,a.Z)(rt),(0,a.Z)(At),(0,a.Z)(xt),(0,a.Z)(qe),(0,a.Z)(ft),["transform"]),Text:[].concat((0,a.Z)($e),(0,a.Z)(qe)),EmbedDOM:["cursor","baselineOffset","zIndex","overflowVisible"].concat((0,a.Z)(Qe),(0,a.Z)(qe)),EmbedRNode:["cursor"].concat((0,a.Z)(Qe),(0,a.Z)(qe)),BlockFlow:Pt,InlineFlow:["alignHorizontal","alignVertical"].concat(Je,(0,a.Z)(qe)),Absolute:["zIndex"].concat(Nt,(0,a.Z)(qe)),Fixed:["zIndex"].concat(Nt,(0,a.Z)(qe)),FlexRow:Lt,FlexColumn:Lt,Table:["backgroundColor","border"].concat((0,a.Z)(qe)),TableRow:(0,a.Z)(qe),TableCell:["backgroundColor"].concat((0,a.Z)(qe)),Bitmap:[].concat((0,a.Z)(qe),["baselineOffset","fit","width","height"]),Drawing:[].concat((0,a.Z)(qe),["width","baselineOffset","height"])},Ft=new Set(["Div"]),Bt=new Set(["Div","Table"]);He.SuperList,He.Div,He.Text,He.BlockFlow,He.InlineFlow,He.Absolute,He.Fixed,He.FlexRow,He.FlexColumn,He.Table,He.TableRow,He.TableCell;var Vt=new Set([He.BlockFlow,He.FlexRow,He.FlexColumn,He.Table,He.EmbedRNode,He.SuperList]),Ht={width:{Div:"auto",Bitmap:"auto",EmbedDOM:"auto",EmbedRNode:"auto",HalfFullscreen:"auto",InlineFlow:"auto",BlockFlow:"100%",FlexRow:"100%",FlexColumn:"100%",SuperList:"100%"},height:{Div:"auto",Bitmap:"auto",EmbedDOM:"auto",EmbedRNode:"auto",HalfFullscreen:"auto",FlexRow:"auto",FlexColumn:"auto"}},Ut=new Set([He.InlineFlow,He.FlexRow]),Zt=["minWidth","maxWidth","left","right","marginLeft","marginRight","paddingLeft","paddingRight","borderLeftWidth","borderRightWidth","outlineLeftWidth","outlineRightWidth","minHeight","maxHeight","top","bottom","marginTop","marginBottom","paddingTop","paddingBottom","borderTopWidth","borderBottomWidth","outlineTopWidth","outlineBottomWidth","fontSize","textIndent","width","height","weakWidth","outlineOffset"].concat((0,a.Z)(It)),Wt={flexWidth:void 0,flexHeight:void 0,stretchWidth:void 0,stretchHeight:void 0},jt={fragments:void 0};function Gt(){return"undefined"!=typeof window?window:n.g}function zt(){var e;return null!==(e=Gt().navigator)&&void 0!==e?e:{userAgent:"node.js"}}var Yt=/apple/i.test(null!==(ae=zt().vendor)&&void 0!==ae?ae:"")&&/safari/i.test(null!==(se=zt().userAgent)&&void 0!==se?se:"")&&!/Mobi|Android/i.test(null!==(ue=zt().userAgent)&&void 0!==ue?ue:"");function Xt(e,t){for(var n=[],r=e;r&&(n.push(r),r!==t);)r=r.parent;return n}function Kt(e){for(var t=new Map,n=e;n;)n.parent&&t.set(n.parent,Jt(n)),n=n.parent;return t}function qt(e,t){for(var n=e.length,r=t.length,i=0;i<n&&i<r&&e[i]===t[i];)i++;return i-1}function $t(e,t){var n=Xt(e).reverse(),r=Xt(t).reverse();return{path1:n,path2:r,lcaIndex:qt(n,r)}}function Jt(e){var t,n,r;return null!==(t=null==e||null===(n=e.parent)||void 0===n||null===(r=n.children)||void 0===r?void 0:r.indexOf(e))&&void 0!==t?t:-1}function Qt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Jt,r=qt(e,t)+1;return e.length===r&&t.length>r?-1:t.length===r&&e.length>r?1:e.length===r&&e.length===t.length?0:n(e[r])<n(t[r])?-2:2}function en(e,t,n){e[t]=n}function tn(e,t){Ve(e,t)}function nn(e,t){delete e.style[t]}function rn(e){e.children&&(e.children.length=0)}Gt().__ROADSTER_CONTEXT_MANAGER__||(Gt().__ROADSTER_CONTEXT_MANAGER__=new function e(){var t,n,r,i,o=this;(0,h.Z)(this,e),this._rNodeContextMap=new Map,this.genId=(r=(null!==(n=t)&&void 0!==n?n:{}).initNum,i=void 0===r?1:r,function(e){return i++}),this.register=function(e){o._rNodeContextMap.set(o.genId(),e)},this.destroy=function(e){o._rNodeContextMap.delete(e)},this.getById=function(e){return o._rNodeContextMap.get(e)},this.getAll=function(){return Array.from(o._rNodeContextMap.values())}});var on,an=(on=Object.values(Dt).flat(),Array.from(new Set(on))).flatMap((function(e){return[e,"__".concat(e)]}));function sn(e,t,n){!function(e,t,n){e.style[t]=n}(e,t,n)}function un(e,t){!function(e,t){Ve(e.style,t)}(e,t)}function ln(e,t){t.forEach((function(t){nn(e,t)}))}function cn(e,t){nn(e,t)}function hn(e,t){return e.style}function dn(e){return function(e){var t;return{fontFamily:e.fontFamily||Re,fontSize:null!==(t=e.fontSize)&&void 0!==t?t:Ae,fontColor:e.fontColor||"black",fontStyle:e.fontStyle||"",fontWeight:e.fontWeight||""}}(hn(e))}function fn(e){return!!e&&It.some((function(t){return e[t]}))}Be(an,(function(e,t,n){e[t]=n.toString()})),Gt().__ROADSTER_GET_RENDER_OBJECT_STYLES__=hn;var pn=function(){for(var e,t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];null===(e=window.__ROADSTER_DEVTOOLS_TOOLS__)||void 0===e||(t=e.logger).error.apply(t,r)};function vn(e,t,n){var r,i=hn(e);sn(e,"fontSize",gn(t,n)*(null!==(r=null==i?void 0:i.zoom)&&void 0!==r?r:1))}function gn(e,t){var n,r,i,o,a=null!==(n=null==e?void 0:e.fontSize)&&void 0!==n?n:null==t?void 0:t.fontSize;"string"==typeof a&&a.includes("%")&&(i=null!==(o=null==t?void 0:t.fontSize)&&void 0!==o?o:Ae);return null!==(r=Tn(a,Sn(i,null==t?void 0:t.fontSize)))&&void 0!==r?r:Ae}var _n=/calc\(([^)]+)\)/,yn=/([+\-*/])/,mn=/(\d+(\.?\d+)?)(px|rem|em|vw|vh|%)/;function En(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return Number(e)},n=e.split(yn),r=[],i="+",o=0;o<n.length;++o){var a=n[o];if(yn.exec(a))i=a;else{var s=t(a);if(!De(s))return null;switch(i){case"+":r.push(s);break;case"-":r.push(-s);break;case"*":r.push(r.pop()*s);break;default:r.push(r.pop()/s)}}}var u=r.reduce((function(e,t){return e+t}),0);return De(u)?u:null}function bn(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=mn.exec(e);if(!r)return Number(e);var i=Number(r[1]),o=r[3];switch(o){case"rem":case"em":if(void 0===t[o])return;return i*t[o]*n;case"vw":return i/100*window.innerWidth*n;case"vh":return i/100*window.innerHeight*n;case"%":if(void 0===t[o])return;return i/100*t[o];default:return Number(i)*n}}function Tn(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(De(e))return e*n;if(!Le(e)||""===e)return null;if("0"===e)return 0;if(!e.includes("calc(")){var r=bn(e,t,n);return De(r)?e.startsWith("-")?-r:r:null}var i=_n.exec(e),o=i[1];return En(o,(function(e){return bn(e,t,n)}))}function Cn(e){var t=e.display;return void 0===t||t}function Sn(e,t){var n;return{"%":e===1/0?void 0:e,em:null!==(n=t)&&void 0!==n?n:Ae}}function wn(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={},r=0;r<Ke.length;r++){var i=Ke[r];e&&i in e?n[i]=e[i]:i in t&&(n[i]=t[i])}return n.fontSize&&(n.fontSize=gn(n,t)),e&&(void 0!==e.forceLineHeight?delete n.lineHeight:void 0!==e.lineHeight&&delete n.forceLineHeight),n}function Rn(e){return e.props.sourceStyle}function An(e,t,n){e[t]=n}function On(e,t){e.context&&Ve(e.context,t)}function Mn(e,t){e.constraint&&Ve(e.constraint,t)}var kn=Symbol("");function In(e,t){for(var n=0;n<t.length;n++){var r=t[n];if(!e.has(r))return;e=e.get(r)}return e}function xn(){var e=new Map,t=0;return{set:function(n,r){var i=function(e,t){for(var n=0;n<t.length;n++){var r=t[n],i=e.get(r);i||(i=new Map,e.set(r,i)),e=i}return e}(e,n);return i.has(kn)||t++,i.set(kn,r),r},get:function(t){var n=In(e,t);return null==n?void 0:n.get(kn)},has:function(t){var n=In(e,t);return!(null==n||!n.has(kn))},delete:function(n){var r,i=e,o=[[i,void 0]],a=be(n);try{for(a.s();!(r=a.n()).done;){var s=r.value;if(!i.has(s))return!1;i=i.get(s),o.push([i,s])}}catch(e){a.e(e)}finally{a.f()}var u=i.delete(kn);u&&t--;for(var l=o.length-1;l>0;l--){var h=(0,c.Z)(o[l],2),d=h[0],f=h[1];if(d.size)break;(0,c.Z)(o[l-1],1)[0].delete(f)}return u},clear:function(){e.clear(),t=0},get size(){return t}}}var Nn={},Pn=function(e){return e.map((function(e){var t=Nn[e];return t||(t=new Map,Nn[e]=t),t}))},Ln=["get","set","has"];function Dn(e){var t={};return Ln.forEach((function(n){return t[n]=e[n]})),e.toggle=function(n){n?(e.clear(),Ln.forEach((function(t){return e[t]=Ne}))):Ln.forEach((function(n){return e[n]=t[n]}))},e}function Fn(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=Pn(e),o=Dn(r?xn():new Map);return i.forEach((function(e){var r;return e.set(null!==(r=t)&&void 0!==r?r:o,Ve(n,{cache:o}))})),o}function Bn(e,t,n,r){var i,o=function(e,t,n){return Fn(e,t,n,!0)}(t,null!==(i=n)&&void 0!==i?i:e,r);return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n.length?n:[this];if(o.has(i))return o.get(i);var a=e.apply(this,n);return o.set(i,a),a}}var Vn,Hn=function(e,t){var n=function(e){return e.map((function(e){return Nn[e]})).filter((function(e){return e}))}(e);return null==t?n.map((function(e){return Array.from(e.values())})).flat():n.map((function(e){return e.get(t)})).filter((function(e){return e}))};function Un(e,t,n){new Set(Hn(t,n)).forEach((function(t){return t.cache.toggle(e)}))}function Zn(e){Vn=e}var Wn=function(){function e(){(0,h.Z)(this,e),this.plugins={}}return(0,d.Z)(e,[{key:"use",value:function(e){var t,n=be(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.plugins[r.type]||(this.plugins[r.type]=new r)}}catch(e){n.e(e)}finally{n.f()}}},{key:"has",value:function(e){return!!this.plugins[e]}},{key:"push",value:function(e,t){if(Vn){var n,r=this.plugins[e.type];if(r)null===(n=r.onPush)||void 0===n||n.call(r,e,t)}}},{key:"pushQueue",value:function(e,t){var n,r=be(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.push(i,t)}}catch(e){r.e(e)}finally{r.f()}}},{key:"clear",value:function(e,t){var n,r;null===(n=this.plugins[e])||void 0===n||null===(r=n.clear)||void 0===r||r.call(n,t)}},{key:"clearAll",value:function(e){var t,n;null===(t=this.plugins[e])||void 0===t||null===(n=t.clearAll)||void 0===n||n.call(t)}},{key:"flush",value:function(e,t){var n,r;Vn&&(null===(n=this.plugins[e])||void 0===n||null===(r=n.onFlush)||void 0===r||r.call(n,Vn,t))}}]),e}(),jn=new Wn,Gn={},zn=new WeakSet;function Yn(e,t){var n;if(!zn.has(t)){zn.add(t);var r,i,o=null!==(n=Gn[He.Component])&&void 0!==n?n:t,a=Gn[e]||{},s=t.layout,u=t.paint;if(s){var l=s.buildContext,c=s.createChildConstraint;l&&(s.buildContext=(i=l,function(e,t){var n=e.runtime;if(n){n.context={inheritedStyle:null==n?void 0:n.constraint.inheritedStyle};var r=e.parent;if(r){var o,a=r.runtime;if(null==a||null===(o=a.context)||void 0===o?void 0:o.isWeakWidth){var s=n.constraint,u=s.maxWidth,l=s.originMaxWidth,c=s.flexWidth;u=De(l)?l:u;var h=hn(e),d=h.width,f=h.maxWidth;void 0===c&&(De(d)&&d<=u||De(f)&&f<=u)||(n.context.isWeakWidth=!0)}}}i(e,t)})),c&&(s.createChildConstraint=(r=c,function(e,t,n){var i=e.runtime,o=t.runtime,a=i.constraint,s=Rn(t);o&&(o.constraint=Ve({},a,{inheritedStyle:wn(s,null==a?void 0:a.inheritedStyle)})),Ao(e)||Mn(o,{minWidth:void 0,minHeight:void 0}),r(e,t,n)}))}if(u){var h=u.commandPlugins;null!=h&&h.length&&jn.use(h)}Gn[e]=Object.fromEntries(["build","reconcile","layout","paint","mutate"].map((function(e){var n;return[e,Ve({},o[e],null!==(n=a[e])&&void 0!==n?n:{},t[e])]}))),e===He.Component&&Object.keys(Gn).forEach((function(e){e!==He.Component&&Yn(e,{})}))}}function Xn(e){return Gn[e]}function Kn(e){return Xn(e.type)}function qn(e){return!(null==e||!e.individual)}function $n(e){var t;return!!bo(e,He.InlineFlow)&&qn(null===(t=e.runtime)||void 0===t?void 0:t.context)}function Jn(e){return!!yo(e,He.InlineFlow)&&$n(null==(t=e)||null===(n=t.renderObjects)||void 0===n?void 0:n[0]);var t,n}var Qn=Object.create,er=Object.defineProperty,tr=Object.getOwnPropertyDescriptor,nr=Object.getOwnPropertyNames,rr=Object.getPrototypeOf,ir=Object.prototype.hasOwnProperty,or=function(e,t){return function(){return t||(0,e[nr(e)[0]])((t={exports:{}}).exports,t),t.exports}},ar=function(e,t,n){return n=null!=e?Qn(rr(e)):{},function(e,t,n,r){if(t&&"object"===(0,u.Z)(t)||"function"==typeof t){var i,o=be(nr(t));try{var a=function(){var o=i.value;ir.call(e,o)||o===n||er(e,o,{get:function(){return t[o]},enumerable:!(r=tr(t,o))||r.enumerable})};for(o.s();!(i=o.n()).done;)a()}catch(e){o.e(e)}finally{o.f()}}return e}(!t&&e&&e.__esModule?n:er(n,"default",{value:e,enumerable:!0}),e)},sr=or({"../node_modules/tiny-inflate/index.js":function(e,t){function n(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function r(e,t){this.source=e,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=t,this.destLen=0,this.ltree=new n,this.dtree=new n}var i=new n,o=new n,a=new Uint8Array(30),s=new Uint16Array(30),u=new Uint8Array(30),l=new Uint16Array(30),c=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),h=new n,d=new Uint8Array(320);function f(e,t,n,r){var i,o;for(i=0;i<n;++i)e[i]=0;for(i=0;i<30-n;++i)e[i+n]=i/n|0;for(o=r,i=0;i<30;++i)t[i]=o,o+=1<<e[i]}var p=new Uint16Array(16);function v(e,t,n,r){var i,o;for(i=0;i<16;++i)e.table[i]=0;for(i=0;i<r;++i)e.table[t[n+i]]++;for(e.table[0]=0,o=0,i=0;i<16;++i)p[i]=o,o+=e.table[i];for(i=0;i<r;++i)t[n+i]&&(e.trans[p[t[n+i]]++]=i)}function g(e){e.bitcount--||(e.tag=e.source[e.sourceIndex++],e.bitcount=7);var t=1&e.tag;return e.tag>>>=1,t}function _(e,t,n){if(!t)return n;for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var r=e.tag&65535>>>16-t;return e.tag>>>=t,e.bitcount-=t,r+n}function y(e,t){for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var n=0,r=0,i=0,o=e.tag;do{r=2*r+(1&o),o>>>=1,++i,n+=t.table[i],r-=t.table[i]}while(r>=0);return e.tag=o,e.bitcount-=i,t.trans[n+r]}function m(e,t,n){var r,i,o,a,s,u;for(r=_(e,5,257),i=_(e,5,1),o=_(e,4,4),a=0;a<19;++a)d[a]=0;for(a=0;a<o;++a){var l=_(e,3,0);d[c[a]]=l}for(v(h,d,0,19),s=0;s<r+i;){var f=y(e,h);switch(f){case 16:var p=d[s-1];for(u=_(e,2,3);u;--u)d[s++]=p;break;case 17:for(u=_(e,3,3);u;--u)d[s++]=0;break;case 18:for(u=_(e,7,11);u;--u)d[s++]=0;break;default:d[s++]=f}}v(t,d,0,r),v(n,d,r,i)}function E(e,t,n){for(;;){var r,i,o,c,h=y(e,t);if(256===h)return 0;if(h<256)e.dest[e.destLen++]=h;else for(r=_(e,a[h-=257],s[h]),i=y(e,n),c=o=e.destLen-_(e,u[i],l[i]);c<o+r;++c)e.dest[e.destLen++]=e.dest[c]}}function b(e){for(var t,n;e.bitcount>8;)e.sourceIndex--,e.bitcount-=8;if((t=256*(t=e.source[e.sourceIndex+1])+e.source[e.sourceIndex])!==(65535&~(256*e.source[e.sourceIndex+3]+e.source[e.sourceIndex+2])))return-3;for(e.sourceIndex+=4,n=t;n;--n)e.dest[e.destLen++]=e.source[e.sourceIndex++];return e.bitcount=0,0}!function(e,t){var n;for(n=0;n<7;++n)e.table[n]=0;for(e.table[7]=24,e.table[8]=152,e.table[9]=112,n=0;n<24;++n)e.trans[n]=256+n;for(n=0;n<144;++n)e.trans[24+n]=n;for(n=0;n<8;++n)e.trans[168+n]=280+n;for(n=0;n<112;++n)e.trans[176+n]=144+n;for(n=0;n<5;++n)t.table[n]=0;for(t.table[5]=32,n=0;n<32;++n)t.trans[n]=n}(i,o),f(a,s,4,3),f(u,l,2,1),a[28]=0,s[28]=258,t.exports=function(e,t){var n,a,s=new r(e,t);do{switch(n=g(s),_(s,2,0)){case 0:a=b(s);break;case 1:a=E(s,i,o);break;case 2:m(s,s.ltree,s.dtree),a=E(s,s.ltree,s.dtree);break;default:a=-3}if(0!==a)throw new Error("Data error")}while(!n);return s.destLen<s.dest.length?"function"==typeof s.dest.slice?s.dest.slice(0,s.destLen):s.dest.subarray(0,s.destLen):s.dest}}}),ur=or({"../node_modules/unicode-trie/swap.js":function(e,t){var n=18===new Uint8Array(new Uint32Array([305419896]).buffer)[0],r=function(e,t,n){var r=e[t];e[t]=e[n],e[n]=r};t.exports={swap32LE:function(e){n&&function(e){for(var t=e.length,n=0;n<t;n+=4)r(e,n,n+3),r(e,n+1,n+2)}(e)}}}}),lr=or({"../node_modules/unicode-trie/index.js":function(e,t){var n=sr(),r=ur().swap32LE,i=function(){function e(t){(0,h.Z)(this,e);var i="function"==typeof t.readUInt32BE&&"function"==typeof t.slice;if(i||t instanceof Uint8Array){var o;if(i)this.highStart=t.readUInt32LE(0),this.errorValue=t.readUInt32LE(4),o=t.readUInt32LE(8),t=t.slice(12);else{var a=new DataView(t.buffer);this.highStart=a.getUint32(0,!0),this.errorValue=a.getUint32(4,!0),o=a.getUint32(8,!0),t=t.subarray(12)}t=n(t,new Uint8Array(o)),t=n(t,new Uint8Array(o)),r(t),this.data=new Uint32Array(t.buffer)}else{var s=t;this.data=s.data,this.highStart=s.highStart,this.errorValue=s.errorValue}}return(0,d.Z)(e,[{key:"get",value:function(e){var t;return e<0||e>1114111?this.errorValue:e<55296||e>56319&&e<=65535?(t=(this.data[e>>5]<<2)+(31&e),this.data[t]):e<=65535?(t=(this.data[2048+(e-55296>>5)]<<2)+(31&e),this.data[t]):e<this.highStart?(t=this.data[2080+(e>>11)],t=((t=this.data[t+(e>>5&63)])<<2)+(31&e),this.data[t]):this.data[this.data.length-4]}}]),e}();t.exports=i}}),cr=or({"../packages/core-unicode/node_modules/base64-js/lib/b64.js":function(e){!function(e){var t="undefined"!=typeof Uint8Array?Uint8Array:Array,n="+".charCodeAt(0),r="/".charCodeAt(0),i="0".charCodeAt(0),o="a".charCodeAt(0),a="A".charCodeAt(0),s="-".charCodeAt(0),u="_".charCodeAt(0);function l(e){var t=e.charCodeAt(0);return t===n||t===s?62:t===r||t===u?63:t<i?-1:t<i+10?t-i+26+26:t<a+26?t-a:t<o+26?t-o+26:void 0}e.toByteArray=function(e){var n,r,i,o,a,s;if(e.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var u=e.length;a="="===e.charAt(u-2)?2:"="===e.charAt(u-1)?1:0,s=new t(3*e.length/4-a),i=a>0?e.length-4:e.length;var c=0;function h(e){s[c++]=e}for(n=0,r=0;n<i;n+=4,r+=3)h((16711680&(o=l(e.charAt(n))<<18|l(e.charAt(n+1))<<12|l(e.charAt(n+2))<<6|l(e.charAt(n+3))))>>16),h((65280&o)>>8),h(255&o);return 2===a?h(255&(o=l(e.charAt(n))<<2|l(e.charAt(n+1))>>4)):1===a&&(h((o=l(e.charAt(n))<<10|l(e.charAt(n+1))<<4|l(e.charAt(n+2))>>2)>>8&255),h(255&o)),s},e.fromByteArray=function(e){var t,n,r,i,o=e.length%3,a="";function s(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)}for(t=0,r=e.length-o;t<r;t+=3)n=(e[t]<<16)+(e[t+1]<<8)+e[t+2],a+=s((i=n)>>18&63)+s(i>>12&63)+s(i>>6&63)+s(63&i);switch(o){case 1:a+=s((n=e[e.length-1])>>2),a+=s(n<<4&63),a+="==";break;case 2:a+=s((n=(e[e.length-2]<<8)+e[e.length-1])>>10),a+=s(n>>4&63),a+=s(n<<2&63),a+="="}return a}}(void 0===e?e.base64js={}:e)}}),hr=ar(lr(),1),dr=ar(cr(),1).default.toByteArray("AAARAAAAAACA5AAAATMPzPDtnQuMXUUZx2e729u9d+/u9m67LaUUWlpoi9FWEiyighaxSkSkhocYQVArIiJiVUQE1AaiNBQQg4AKlkRqFRFBrUiaRgmQUqFQEyAQeQakSloaGrGp6H9yZ3Jnh3k/zrnQ8yW/zJkzr2++eZy5cx73iV5CngP/Aq+AZh8hk8E+YA44CBwc4L4TvA98CBwHTgCnOKRbBs42hC8HF4AVYCW4ClwHbgRrhHi3gN+Bu8DdYCN4GDwEHgNPgxfBy+BVsJul7RvfdptwJ4PpYAY4ALwVHAIWgSPAEnAsOA6cBD4FzmDh54DzWDj1XwQuBavAleBacCNYw8J/A9aBDcx/H9jMyn8UPAX+wfKn+m2D+2/wP9BTI6QOdve2/S0cT2H+feEeWGuneRvcd4DDwGIWTuNSjmbuR1hczgm1DqcwPgOWMcS4Js5G3K9J8a+Arhd65OHCJUJ+l+P4KnAdWA3W1jr1/S24E/xZKn8j/OsF/yb4/waeENJSnmHptgrndoBdYNyEdr+n0PZ9P9w6zrXANDBrQjvtPOYugLsIHD6hU+4HcPzhCfp68vxjbPUx5P8J8GnwBfAV8E3wXXAZWAWuATeA1WAtuI3ptI65G+DeBzaDR8FT4AUWtg3uTrBbUw/S3zmu4XhIYlg4ngqmg9ngLeBgcBhYDI4GS8HJ4HRwJjgXnA++w8q4BO7l4Grmvx7u6n5/m61laW6Du84j/YaAsu6V0jwo+Gm/pO3/CM49CV7ob4/nbf3ubAevAlJHU4CJYC8wkx3Pq5vTLxTCD7XEraioSAefB8rWo6KioqKioqKi4o3Fu7v0d9uR9bH7ITo+WG/v5dHjY3C8RQg7vm5P/0nE+SyLdxbcM/ra+zXLcXwBy3sF3MvAD+rt/bif0v0DHN/E0v0S7u31sftDlD/h3F8NZf8F4feDTTQeeAA8CDaDh6qwKqwKq8KqsORhj4InwTP19p5pmWytl8uOiooKLbHr2F3IY1yDkFoj/D5dQ5N2BOf3BvuD+eDtUrxD4H8POAocA44HJzfaep0O98xG+fPP9uE2CycScg5YY+A5MKdFyEmt14f9SDq3Gf6JI/h9AC4eaZ+7A+52MG8S1vhgBbgYNlgPXgOHDxByIVgNNoP34twO5heZ1cRvgZ4OpzXbcTnfh38j2AqGBwkZBR8FV4DNYHiIkGPBqqGx+exp3Do01m4VFRUVexLbSp4DyYQ9lwXD5f/+KxvTuvNc9I/zG/rwCxr6/FYgbKWUdhX817Bz52ue+6PPBN6Z+JlAE9dq6neDod6UmxG+FLreooh3Bzt3lyUPG3cr7Gtqw02K8rawc48LYX9vtJ9DPBLHz+P4JebfCfe/oHeg7R+AOwlMZX66773fQGdPe+7AWB0WwH893EUD7edej4C7hB4PqHXeB3meONDR6yhwqiIuj38D+NxAx0/jfwn+r7M8LoJ76UDnudZVOL7GlN+A2u78fsLPEf5rqY6/h389uAdsBA+zPB6D+7QmPx20Pi8izXawE+xSlDWu2T5uNDt1szHS1Je5F8JmGsLLYF6X6VMGC5kNDjXY4l2asMXN7r6OmDg6YdvTZ2KXNjvH9DpyIvOfCndZQf3si5pyljfbz+x+Q2ivbzfz30sNrcf3mJ5XdkH/KpMfOrbRTxDvZ+Bmzzalz2GXXUff8X1rs/MOwp7KHzznk/WIfw94TLFOe+ANdg3cAn0fSaAzteOTrC89D/cl8EoXzTebauZwqvdug760jn2DhDQH3W3SYnGnDZZff585gTNrcGz4/ALqsZDZ7BAPO5s4zEFn27y+GHksGWy/v3QMc5cOtsM+Puh/HT8NaT4Pvgy+KqT/Fo5XgJXgauH8j3F8E/gF+BW4nYX9Ee4GId69OL6f+bfAfXzw9euGZwW7nsXS/ZOde5m5/4G7Rsj3NRzXhtrHQ8ydDHf60Nj8n5VsMRvhc4f0bUPfFVswVOzzaN3GItT/vL7wa1c3zbGhlH1vuEyOQPs/3ttDRgmx0gIHgP0ZcxzSuDIf4BJJ0Byk2X6VkDTYMT1HZZwQhq5LJjKXbsMOONLPaArUJH9uCKvDuALLlMunbdnD/KOkElWfPFBzPgd9TA/a5+sCtH1mMfgxHyMt0mlTno7HHZHSivRKfkLy9rdZmfPv9vK7Dd4/xD7A/a42k/uUmGbEkrYIihq3bwT6AtPoCNEhtB3la7WtbcvudzmhtqBzPhd+vs78ZfezEFpCu40qjmvMtclgFxHavg0BeZ3qY9Oa4HLK7ru552bX9X9DOJZ1ylnnGrHX3WYfOVwVl8dxtUfqdn0z9CkuZY+Tsu3UJOFSRv/LaRM5DZ2b+ZjmQuOJv9uK0FWnv3xeF49L0XbOVa5OfNs3xfgJoYgyYuqfs0+krLstL1/9Wowi5zV5vJTRPlxStY9pjIplyWKzERff9uHrbVXe/Lw4n+vqZdKxqPZJgUlsOqjEtT1U49K1v3Apsz1i7Z1aDy4+46FOzJJi/If2w1zjP6RPi1LmtVOlZyq7m2xgmydESXm95POwTqfQa3yZ49+1TXKPf5O47ueLOhd9D6DIuYhLavv7zj02XXLbOoXdXcvL3f9d8tatE2VEKbpP+o53sR18ZW6XIEs9Mr8mcbcj/13Y7bbx7Rcqm4xIiOf6hOMW89cU9LF08j0J23yQ+ne3fN+Ju1R6BDdmLSFL6FhvOZwv+proOkfx8RE7t4t9S7e24PenVeI7nuW8Y8eha/m69NNKZu+SmV4yudZSpnlDXieZxlFuyiy76PKp8GsAF19dbfNeKK7rwFDdfcrXrX1y6uBT79Tlk4jyU6/ruO3HC37e98T1L5fYfYBU7cfXgVz/Eem83Mf482Y59I9Z26WEEL91VY7fj03Jz9sjdt0S+1uOS6weOdvPZF8ep8zffj7jJxadpKhDLC7jkEvI74UWCbv2p9BdLF+2V1nzWkwbpfq9n2p+lCVVOS7ly/3K5zkEnc6p91Ny4TqWbCL3sRTzh2lsjUrHZY9FCl9rEaLuU5w+yT+Z6b6fUA853iQy9l2QXtJ5b69X4RfjUoYFaH78HUNVO9ByGxZEHWg54xk62/Qz3XqEuKb4pv4q9lvd9WGKIi3R1NfUF7m4vOPE6ye+ryO/w+OSngTYRR6jdQPyO3A+qNI2FMcxZdQd2ifFNcYkol15f5fb0PV+lZjO59lV136T4/07U9mq99hU70Ga0JXnm87VLrLkKM9Hp9C6qPSSz6nCuSu/92prW5Ut5DqYbGfqQy79IaStbeWmGA8m25j8KfpPqvxdbRZru1i9fBlOoAMV8T5lqK5DDJ8yc9h0SCLWNqnF9/qRk2ZgGrlf5NDLZwylKCtUB1db+uSj8ruel/OIrZ+r3V3T5Bjfpnrb7Mbz4eFDinJmkDTzSUgddTZMYcuYdlf1OW4/VZwUOhdlf1u9i0bu8zbksanq07M08VXjQQ4Tx53OTio9VPmo9JlhKFeFylYzJIrqI6K/VwMN4/fFZP2p9AS4Oa7Dof2d61TkGHG1Uxll+rpl2q3IsovqK6n6tYxpH1UU8TkFvodbI273I2y4PjejEqq3bo6yYdr3F/epiVRPcQ4U/VRMY0LOnz/jodoXV9lpEkO3l04UZejqpCuLz+kudeHie21PjSz8e349QpzxUnyXOcw1/njhWExnQ7cXrourOs/vzcj2mM2ObW5uiirHVr5LvW1hs0lHeFuNl+Bt0m32T1V/Vf+bTdT9UOyPPjI7EptNbOvFHO2gs40NF0mxDuDXo9TP6aru1YY+YxCrg3jNE3G1r6yT73MQOeyp00Glvw7Xe6Oh8PdVxLWFSULvEcc8D+RSfuwzMib7uPQfW3k5nrPPfS+fllHGOzyimGzu8gxjaH/j6ct8n0rUI3U/cO0LvvOnnLev/V3b1dUOqnxi6m8b47H1l2Uq2KtAii7PV1K+qydLGe/ryTKvZA4qmZxrnabC3lTot3BHid93c7vtm7yx8D2TosuV17ex67p+0tnr4d8mlvfNholeYsvX/U702Z+X05l+g/YILhX+W1+8/2MrxwZ/DlX1m7eMvsplCnN5PWVdVTbskVyfPQJ5n6DmmUcsJFD3XOVz2/ZIx9xOqfaEisC0R1aEXbnw573FcP6sKRXfa5tKxPlqJmnvq3EpYxyLYtr7KevaKK7nc9XbVXLvYfnYxOX3ZFn6USnjWxCi8PKL2KcK7W8u9yRd+4Isqri6ckxrMlueOdrN1R6+eyqx+wE+9RH3JXzTu7Z5UX04R54pxxEX2/5QUXOSaz8TbSna1rWuZfUjeVy67ueRBDr79Iuc4z30muKjl2r+K2sM8jLF94NtotJTft5G1c/4sc/75yNS/iFj3bctdc8n8XZ2KdN0n7XI8a2Soq6XKeYAVf+JGaNEyFslPmvuWH181jiyjq7rAtVc4ztP8frr2kHVbiZJcb+afw+SP8chf1PUtgYPWY+K5ctxfSS2/vK3WF1IKTnnXrE/6STWfrES+10rV/3l7721AsrKIbmvv6a5Jff1UrduEfPxeZaKSjdcb2OvTzSPESGvIsVH/9xrEpe+IqJav7aIny1926+oPiFfM8Xrjc/4UNU3lpDnHrn4/D4JRRT+rGCqPsoltn1dcBHbeLFJUfNnzNxokpzzT+75Tofqm1up+q2PxO798TxC5woSWb6vXXoE5HjyOR6faOLn1lmnp28+pv+jF+uok9g6xNoidP5KvbfNRXctd5VYPXzWFCp4mKv42D/3uIhtU1l0685UhOgovyOm+18OnfisLVSSq+1cxff5lNQSW8ei9NRJ7PtwNol9tij3HGGaM1X3VnzX4yn10c0Vueej1HOWb52LbHsurtex3ORqW5Vdc123fNpQjKu6VxAjKWwWK0WWpZKYMWHTP+W4SqG3rZ+lkJh5bdRiA9t+i883hF31ib2+2fqHLGXcX4qxl7z/kuv95lAJ+YaVuN5K/V2s1Pk1M+ib45n4fQpCVfYMzfkUqNqgyDJ058Vv2ansoAovmn0VyPqp9LWRQjef8nz0Ueknx3WtywxDnj59S+XqytKlDR0Dpjk/tg1dry05885VN1u/dWm/0Pxdy0xB0XYMKcc01ov6rqj4rT3T/8ik7hO+865vman7VWq75y4/tf6p9Ms1XmPrp1vvuPRfn7WET3/3WSMUuS7LVYZqLRNTnml9FLMmLGMNHLtujZXY/YWi7KSrd1nfMdHJ/wE="),fr=new hr.default(dr);var pr=ar(lr(),1),vr=ar(cr(),1).default.toByteArray("ABAOAAAAAABAigAAAYkHdvjtmguIVUUYx2fbe/fedXddCYOlDHqCvUCKRAssKhXs/TKiMiJ6kUQPkbQwUVtIM0ipdCUkQ4XoQWX2AqMCKQINyhQMxCK06KGlgZTV/3Dmsl+zM3NmzpmZc1zngx8zd2bOzDcz33wzZ+6Z0s7YVWA6mAFmg3kkrWjYD54Bi8Eyg/IDYI0mfx14HWwEm8BmsAV8Db4l5XaDH8Gv4E/wN6jVGGsHXWAU6AMD4CWwtpY+exIPX0U4FmwAG8EmsBlsAVvBdrAL7AF7wT5wkPw+DOr1tHwPwuPq6fMnInwH4en1tJ1z6mn++fXB+i9E/FJwObge3AjGkfaT525D2tRmGr8L8Zm8voQHEX+U/34c4UIeX4JwORgAY0j5NYi/At4CH5D0hPubg8zizAVPc2hZHS8blnPNJ+jPZ6CNk6RtQfgNj8+q/b/8RKTvFMbg+7q6/p943n6Eh3h8AfiL57d1wO5ANzgWHA9O6UjzzuDhuI6h9Y5H2iRJeot+TtHxmYv+z+djMI2kJ314UdPviH8mC/O/VWIDLtrpJPM8TWNzkUgkEolEIpFIJBKJVIFr8e5aJ/c58wzuL27GM3eQd96fG4xd0WTsPqQ9xNPnIJwPZjbT+8AnEb8B8aU8fznCVWA1/70e4e8I38h4l34X+c+hnufBC2AFWAkGwKpmzIt5MS/mxTzXeQvAU2Bps/w9KxKJDF8+9Px/yrL2wf/VRWZI0uj5eFHNj042rOhJ2QEmGNA3krGxI4em3yukrcDvHaCvl7FretO0RQjfA/tA9yjGLgaXdTE2C3zXydjJIxhrtqXcSuIib3ap8yhP8Dr2o/wGxM/uxjsEWAe2d5vVEYlEIpHhyQHsCzXsD7/hnHAA++Fh8Af/Tmg89udJfI/+BxxC2i14Z/mX59cajE0he3h3I713ovtr8s3I6Mbgd2RjED+tId+Lz0T6uSTvAsQvUZRNmIq8q0n+TYj3En1uJ3nJ91/3aOqaqclLmIZ6rxPOK4/gmcfAQjAdeYt5HTNynGueJe2vRHy1oM9a/L6b1/tahq6Ut1H2ATz3PsKPLZ7zycPg84roQvkFOl0ZsL0lyXeaaPMHyRm9foTeDSTf7/YTZgv0a1hWG1r+aKPI2H+a8a7XK/ilLyr4rd1X0Gm7Qq+Jjr4H3WbZ7128PP2GuIuP5R7PY7iV+8ltFfCXO6HDnfBLu4kueyugl28S33SwkZ6NXNTV00zD0QhPAKceQb7+LOh6HtGXSebf1lY/4mtoQsFxKPq8CWLf5gzTb9QvKjiWX1agD5Pb2xgCI44h8TbDZ0yIUp7E8XdnxyHt3+W81Y5yXEqodqomZc9h3nmnoSo+3KWhwFRsx7zKe04V/UsoG9T1oZFRRqxDVtaHUL3KkirZSpXlaBgHV31zOQZZ/tx0ThoWZV3SlKQxnt5C/E19lk5cjLPYrqg7TW+JTDcbXWz25yxpjZ/OTlTj72p/a0pgQpzqQee4ScKyfYfOhmXrRyaq81jRtWOrcyPjOVdC22tmlA2lS0I7c9//Vp115u7+y/fdmov7DJkfpyLzna050OFif6nq/aXMV8j0F9N15UJJnnZdnxtU/rAsoWuAMf25Qaa3WJ7ujbpnbfQLbSe0bXGvD9m2qINqDEUdaXmbtkzLhpyPmhAva73o1oesrExvsazLcSxav2q907rF868PO/BtX0X9kUs9qD4+1ndef1uGqHxt1vu0ad027ZfxzibbT1vpujNUVp1lzmci4rlAdkaQza+v/rkYkzz7j3hmKlNEe7LRR7Xfyc4otLzsLsX1WhNtLq+vzzr3uhJTfYvYeVl7XYi2RBuTtedyvZnMkQyTs1XR9oro54qiYjpuYn9t9oyiYnr29zEeeetIxPTOtYj4GHvRHnzV73tPNrFpasu6vdL0fsbWdnyuHV0fZemiyPqvqse3D5D5HR9C+2vi+2nIMp4xHUcTm1LVHVKy+qnqL00vS3zsrWXNAxWZLcnWvM91K7Yhm3uZfrZi4rdN1qKPs4P42xTb9yid3jTP9VktlN9XteuqnjzzJatL91uV5lJka9y3Dqr1FkryrC8Xfr7Vdl69fIitj3G9R8n8qW7/UbVflj8x1TnvHJo8o1q3ocT12Mv8KhPSVM/Z6mJqX3nfHVTvguI9emj7lUmZOoRo28anqvZ4k3p9S95zna4uHxJ6XFpC11gZYuqvVM/K9pQyzgYtfVyK7d1F0fc71d5sc8dqo7MPobqLe5Tqt+m42egs1ms6DiHttSVF3uepffgUV/Wr+iDrj2oNlPEeJhNdX1qien8sqw+u28xru3lsVmUbOhuyqdtkH3MtefaYkHPYEnEOaXmxrtBiMm4h1plpGza+vYiY3LO6Wj9ZYjpHMh2z+uHbr5rYkzieTFJGJ7K7fbG+ov4zS0Q79CE6X6cqV+adg67dvDbt2zZdis8+iHadBxvdi+hoKj7XjqmY+HdT+yxi43nq9CUh2shq1zWu2jLpg01/fYlK9zL9cFbdIddNVrs+xFcbHYFwJb78vus9MYSE1KPI2cEFnRWAyoiS6fJMj4CtuOyrKL77boIo3WzomPkkdHui/Ac="),gr=new pr.default(vr);var _r=function(e){return e>=55296&&e<=56319},yr=function(e){return e>=56320&&e<=57343},mr=function(e,t){return 1024*(e-55296)+(t-56320)+65536},Er=[function(){var e=0;return{next:function(t){var n=1===e&&2===t;return e=t,n?2:0}}},function(){var e=0;return{next:function(t){var n=3===e||1===e||2===e;return e=t,n?1:0}}},function(){return{next:function(e){return 3===e||1===e||2===e?1:0}}},function(){var e=0;return{next:function(t){var n=9===e&&(9===t||10===t||12===t||13===t);return e=t,n?2:0}}},function(){var e=0;return{next:function(t){var n=!(12!==e&&10!==e||10!==t&&11!==t);return e=t,n?2:0}}},function(){var e=0;return{next:function(t){var n=(13===e||11===e)&&11===t;return e=t,n?2:0}}},function(){var e=0;return{next:function(t){var n=function(e,t){return 4===e||8===e||4===e||5===e||8===e||7===t?2:0}(t,e);return e=t,n}}},function(){var e=2;return{next:function(t,n){var r=function(e){return/^(?:[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u2388\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2605\u2607-\u2612\u2614-\u2685\u2690-\u2705\u2708-\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763-\u2767\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC00-\uDCFF\uDD0D-\uDD0F\uDD2F\uDD6C-\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDAD-\uDDE5\uDE01-\uDE0F\uDE1A\uDE2F\uDE32-\uDE3A\uDE3C-\uDE3F\uDE49-\uDFFA]|\uD83D[\uDC00-\uDD3D\uDD46-\uDE4F\uDE80-\uDEFF\uDF74-\uDF7F\uDFD5-\uDFFF]|\uD83E[\uDC0C-\uDC0F\uDC48-\uDC4F\uDC5A-\uDC5F\uDC88-\uDC8F\uDCAE-\uDCFF\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDEFF]|\uD83F[\uDC00-\uDFFD])$/.test(String.fromCodePoint(e))}(n),i=1===e&&r;return e=0===e&&4===t?0:0===e&&5===t?1:r?0:2,i?2:0}}},function(){var e=0;return{next:function(t){var n=!1;return 6===t?(e%2==1&&(n=!0),e+=1):e=0,n?2:0}}}],br=gr,Tr=function(){function e(t){(0,h.Z)(this,e),this.content=void 0,this._current=0,this._lastBreak=0,this._rules=void 0,this.content=t,this._rules=Er.map((function(e){return e()}))}return(0,d.Z)(e,[{key:"nextBreak",value:function(){for(var e=this._current;e<this.content.length;e++){var t=this.content.charCodeAt(e);if(this._current=e,_r(t)&&e+1<this.content.length&&yr(this.content.charCodeAt(e+1))){var n=this.content.charCodeAt(++e);t=mr(t,n)}var r,i=br.get(t),o=0,a=be(this._rules);try{for(a.s();!(r=a.n()).done;){var s=r.value.next(i,t);0!==s&&0===o&&(o=s)}}catch(e){a.e(e)}finally{a.f()}if(2!==o){var u=this._current;if(this._current=e+1,0!==u)return this._lastBreak=u,u}}return this._current=this.content.length,this._lastBreak>=this.content.length?null:(this._lastBreak=this._current,this._current)}}]),e}(),Cr=41,Sr=[[4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,4,4,4,4,4,4,4,4,4,4,4],[0,4,4,1,1,4,4,4,4,1,1,0,0,0,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[0,4,4,1,1,4,4,4,4,1,1,1,1,1,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[4,4,4,1,1,1,4,4,4,1,1,1,1,1,1,1,1,1,1,1,4,2,4,1,1,1,1,1,1,1,1,1,1],[1,4,4,1,1,1,4,4,4,1,1,1,1,1,1,1,1,1,1,1,4,2,4,1,1,1,1,1,1,1,1,1,1],[0,4,4,1,1,1,4,4,4,0,0,0,0,0,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[0,4,4,1,1,1,4,4,4,0,0,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[0,4,4,1,1,1,4,4,4,0,0,1,0,1,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[0,4,4,1,1,1,4,4,4,0,0,1,1,1,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[1,4,4,1,1,1,4,4,4,0,0,1,1,1,1,0,1,1,0,0,4,2,4,1,1,1,1,1,0,1,1,1,0],[1,4,4,1,1,1,4,4,4,0,0,1,1,1,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[1,4,4,1,1,1,4,4,4,1,1,1,1,1,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[1,4,4,1,1,1,4,4,4,1,1,1,1,1,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[1,4,4,1,1,1,4,4,4,1,1,1,1,1,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[0,4,4,1,1,1,4,4,4,0,1,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[0,4,4,1,1,1,4,4,4,0,0,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[0,4,4,1,0,1,4,4,4,0,0,1,0,0,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[0,4,4,1,0,1,4,4,4,0,0,0,0,0,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[1,4,4,1,1,1,4,4,4,1,1,1,1,1,1,1,1,1,1,1,4,2,4,1,1,1,1,1,1,1,1,1,0],[0,4,4,1,1,1,4,4,4,0,0,0,0,0,0,0,1,1,0,4,4,2,4,0,0,0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0],[1,4,4,1,1,1,4,4,4,1,1,1,1,1,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[1,4,4,1,1,1,4,4,4,1,1,1,1,1,1,1,1,1,1,1,4,2,4,1,1,1,1,1,1,1,1,1,1],[0,4,4,1,1,1,4,4,4,0,1,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,1,1,0,0,0,1,0],[0,4,4,1,1,1,4,4,4,0,1,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,0,1,0,0,0,1,0],[0,4,4,1,1,1,4,4,4,0,1,0,0,0,0,1,1,1,0,0,4,2,4,1,1,1,1,0,0,0,0,1,0],[0,4,4,1,1,1,4,4,4,0,1,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,1,1,0,0,0,1,0],[0,4,4,1,1,1,4,4,4,0,1,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,0,1,0,0,0,1,0],[0,4,4,1,1,1,4,4,4,0,0,0,0,0,0,0,1,1,0,0,4,2,4,0,0,0,0,0,1,0,0,1,0],[0,4,4,1,1,1,4,4,4,0,1,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0,0,1,1,0],[0,4,4,1,1,1,4,4,4,0,1,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[0,4,4,1,1,1,4,4,4,0,0,0,0,0,1,0,1,1,0,0,4,2,4,0,0,0,0,0,0,1,1,1,0],[0,4,4,1,1,0,4,4,4,0,0,0,0,0,0,0,0,0,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0]];function wr(e){return function(e,t){var n=(0,c.Z)(t,2),r=n[0],i=n[1];if(!r||!i)return!1;for(var o=0;o<e.length;o++){var a=e.codePointAt(o);if(a&&a>=r&&a<=i)return!0}return!1}(e,[2304,2431])}var Rr=fr,Ar=function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,h.Z)(this,e),this.position=t,this.required=n},Or=function(e){switch(e){case 33:case 39:case 40:case 42:return 12;case 35:return 5;default:return e}},Mr=function(e){switch(e){case 37:case 38:return 34;case Cr:return 22;default:return e}},kr=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,h.Z)(this,e),this.breaks=[],this.string=t,this.pos=0,this.lastPos=0,this.curClass=null,this.nextClass=null,this.LB8a=!1,this.LB21a=!1,this.LB30a=0,this.breakSpaces=n.breakSpaces||!1}return(0,d.Z)(e,[{key:"clearBreaks",value:function(){this.breaks.length=0}},{key:"pushBreak",value:function(e,t){this.breaks.push({position:e,required:t})}},{key:"shiftBreak",value:function(){var e=this.breaks.shift(),t=e.position,n=e.required;return new Ar(t,n)}},{key:"nextCodePoint",value:function(){var e=this.string.charCodeAt(this.pos++),t=this.string.charCodeAt(this.pos);return _r(e)&&yr(t)?(this.pos++,mr(e,t)):e}},{key:"nextCharClass",value:function(){return Or(Rr.get(this.nextCodePoint()))}},{key:"getSimpleBreak",value:function(){switch(this.nextClass){case Cr:return!1;case 34:case 37:case 38:return this.curClass=34,!1;case 36:return this.curClass=36,!1}return null}},{key:"getPairTableBreak",value:function(e){var t=!1;switch(Sr[this.curClass][this.nextClass]){case 0:t=!0;break;case 1:t=e===Cr;break;case 2:if(!(t=e===Cr))return t=!1;break;case 3:if(e!==Cr)return t}return this.LB8a&&(t=!1),!this.LB21a||16!==this.curClass&&17!==this.curClass?this.LB21a=13===this.curClass:(t=!1,this.LB21a=!1),28===this.curClass?(this.LB30a++,2===this.LB30a&&28===this.nextClass&&(t=!0,this.LB30a=0)):this.LB30a=0,this.curClass=this.nextClass,t}},{key:"nextBreak",value:function(){if(this.breaks.length)return this.shiftBreak();if(null===this.curClass){var e=this.nextCharClass();this.curClass=Mr(e),this.LB8a=31===e,this.LB30a=0}for(;this.pos<this.string.length;){this.lastPos=this.pos;var t=this.nextClass;if(this.nextClass=this.nextCharClass(),34===this.curClass||36===this.curClass&&37!==this.nextClass)return this.curClass=Mr(Or(this.nextClass)),this.pushBreak(this.lastPos,!0),this.shiftBreak();var n=this.getSimpleBreak();if(this.LB8a=31===this.nextClass,null===n){if(null===n&&(n=this.getPairTableBreak(t)),n)return this.pushBreak(this.lastPos),this.shiftBreak();this.clearBreaks()}else this.nextClass===Cr?this.breakSpaces&&this.pushBreak(this.pos):this.clearBreaks()}return this.lastPos<this.string.length?(this.lastPos=this.string.length,this.pushBreak(this.string.length),this.shiftBreak()):null}}]),e}(),Ir={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},xr={},Nr={};xr.L=1,Nr[1]="L",Object.keys(Ir).forEach((function(e,t){xr[e]=1<<t+1,Nr[xr[e]]=e})),Object.freeze(xr);var Pr=xr.LRI|xr.RLI|xr.FSI,Lr=xr.L|xr.R|xr.AL,Dr=xr.B|xr.S|xr.WS|xr.ON|xr.FSI|xr.LRI|xr.RLI|xr.PDI,Fr=xr.BN|xr.RLE|xr.LRE|xr.RLO|xr.LRO|xr.PDF,Br=xr.S|xr.WS|xr.B|Pr|xr.PDI|Fr,Vr=null;function Hr(e){return function(){if(!Vr){Vr=new Map;var e=function(e){if(Ir.hasOwnProperty(e)){var t=0;Ir[e].split(",").forEach((function(n){var r=n.split("+"),i=r[0],o=r[1];i=parseInt(i,36),o=o?parseInt(o,36):0,Vr.set(t+=i,xr[e]);for(var a=0;a<o;a++)Vr.set(++t,xr[e])}))}};for(var t in Ir)e(t)}}(),Vr.get(e.codePointAt(0))||xr.L}var Ur,Zr,Wr,jr="14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",Gr="6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye";function zr(e,t){var n,r=0,i=new Map,o=t&&new Map;return e.split(",").forEach((function e(a){if(a.includes("+"))for(var s=+a;s--;)e(n);else{n=a;var u=a.split(">"),l=u[0],c=u[1];l=String.fromCodePoint(r+=parseInt(l,36)),c=String.fromCodePoint(r+=parseInt(c,36)),i.set(l,c),t&&o.set(c,l)}})),{map:i,reverseMap:o}}function Yr(){if(!Ur){var e=zr(jr,!0),t=e.map,n=e.reverseMap;Ur=t,Zr=n,Wr=zr(Gr,!1).map}}function Xr(e){return Yr(),Ur.get(e)||null}function Kr(e){return Yr(),Zr.get(e)||null}function qr(e){return Yr(),Wr.get(e)||null}var $r=xr.L,Jr=xr.R,Qr=xr.EN,ei=xr.ES,ti=xr.ET,ni=xr.AN,ri=xr.CS,ii=xr.B,oi=xr.S,ai=xr.ON,si=xr.BN,ui=xr.NSM,li=xr.AL,ci=xr.PDI,hi=new Map;function di(e,t){var n="".concat(e,"-").concat(t);if(hi.has(n))return hi.get(n);for(var r=new Uint32Array(e.length),i=0;i<e.length;i++)r[i]=Hr(e[i]);var o=new Map;function a(e,t){var n=r[e];r[e]=t,o.set(n,o.get(n)-1),n&Dr&&o.set(Dr,o.get(Dr)-1),o.set(t,(o.get(t)||0)+1),t&Dr&&o.set(Dr,(o.get(Dr)||0)+1)}var s=new Uint8Array(e.length),u=new Map,l=[],c=null;l.push({start:0,end:e.length-1,level:"rtl"===t?1:"ltr"===t?0:function(t,n){for(var i=t;i<e.length;i++){var o=r[i];if(o&(Jr|li))return 1;if(o&(ii|$r)||n&&o===ci)return 0;if(o&Pr){var a=tt(i);i=-1===a?e.length:a}}return 0}(0,!1)});for(var h=0;h<l.length;h++){var d=[{_level:(c=l[h]).level,_override:0,_isolate:0}],f=void 0;o.clear();for(var p=c.start;p<=c.end;p++){var v=r[p];f=d[d.length-1],o.set(v,(o.get(v)||0)+1),v&Dr&&o.set(Dr,(o.get(Dr)||0)+1),s[p]=f._level,f._override&&v!==si&&a(p,f._override)}for(var g=[],_=null,y=c.start;y<=c.end;y++){var m=r[y];if(!(m&Fr)){var E=s[y],b=m&Pr,T=m===ci;_&&E===_._level?(_._end=y,_._endsWithIsolInit=b):g.push(_={_start:y,_end:y,_level:E,_startsWithPDI:T,_endsWithIsolInit:b})}}for(var C=[],S=0;S<g.length;S++){var w=g[S];if(!w._startsWithPDI||w._startsWithPDI&&!u.has(w._start)){for(var R=[_=w],A=void 0;_&&_._endsWithIsolInit&&null!=(A=u.get(_._end));)for(var O=S+1;O<g.length;O++)if(g[O]._start===A){R.push(_=g[O]);break}for(var M=[],k=0;k<R.length;k++)for(var I=R[k],x=I._start;x<=I._end;x++)M.push(x);for(var N=s[M[0]],P=c.level,L=M[0]-1;L>=0;L--)if(!(r[L]&Fr)){P=s[L];break}var D=M[M.length-1],F=s[D],B=c.level;if(!(r[D]&Pr))for(var V=D+1;V<=c.end;V++)if(!(r[V]&Fr)){B=s[V];break}C.push({_seqIndices:M,_sosType:Math.max(P,N)%2?Jr:$r,_eosType:Math.max(B,F)%2?Jr:$r})}}for(var H=0;H<C.length;H++){var U=C[H],Z=U._seqIndices,W=U._sosType,j=U._eosType;if(o.get(ui))for(var G=0;G<Z.length;G++){var z=Z[G];if(r[z]&ui){for(var Y=W,X=G-1;X>=0;X--)if(!(r[Z[X]]&Fr)){Y=r[Z[X]];break}a(z,Y&(Pr|ci)?ai:Y)}}if(o.get(Qr))for(var K=0;K<Z.length;K++){var q=Z[K];if(r[q]&Qr)for(var $=K-1;$>=-1;$--){var J=-1===$?W:r[Z[$]];if(J&Lr){J===li&&a(q,ni);break}}}if(o.get(li))for(var Q=0;Q<Z.length;Q++){var ee=Z[Q];r[ee]&li&&a(ee,Jr)}if(o.get(ei)||o.get(ri))for(var te=1;te<Z.length-1;te++){var ne=Z[te];if(r[ne]&(ei|ri)){for(var re=0,ie=0,oe=te-1;oe>=0&&(re=r[Z[oe]])&Fr;oe--);for(var ae=te+1;ae<Z.length&&(ie=r[Z[ae]])&Fr;ae++);re===ie&&(r[ne]===ei?re===Qr:re&(Qr|ni))&&a(ne,re)}}if(o.get(Qr))for(var se=0;se<Z.length;se++){var ue=Z[se];if(r[ue]&Qr){for(var le=se-1;le>=0&&r[Z[le]]&(ti|Fr);le--)a(Z[le],Qr);for(var ce=se+1;ce<Z.length&&r[Z[ce]]&(ti|Fr);ce++)a(Z[ce],Qr)}}if(o.get(ti)||o.get(ei)||o.get(ri))for(var he=0;he<Z.length;he++){var de=Z[he];if(r[de]&(ti|ei|ri)){a(de,ai);for(var fe=he-1;fe>=0&&r[Z[fe]]&Fr;fe--)a(Z[fe],ai);for(var pe=he+1;pe<Z.length&&r[Z[pe]]&Fr;pe++)a(Z[pe],ai)}}if(o.get(Qr))for(var ve=0,ge=W;ve<Z.length;ve++){var _e=Z[ve],ye=r[_e];ye&Qr?ge===$r&&a(_e,$r):ye&Lr&&(ge=ye)}if(o.get(Dr)){for(var me=Jr|Qr|ni,Ee=me|$r,be=[],Te=[],Ce=0;Ce<Z.length;Ce++)if(r[Z[Ce]]&Dr){var Se=e[Z[Ce]],we=void 0;if(null!==Xr(Se)){if(!(Te.length<63))break;Te.push({char:Se,seqIndex:Ce})}else if(null!==(we=Kr(Se)))for(var Re=Te.length-1;Re>=0;Re--){var Ae=Te[Re].char;if(Ae===we||Ae===Kr(qr(Se))||Xr(qr(Ae))===Se){be.push([Te[Re].seqIndex,Ce]),Te.length=Re;break}}}be.sort((function(e,t){return e[0]-t[0]}));for(var Oe=0;Oe<be.length;Oe++){for(var Me=be[Oe],ke=Me[0],Ie=Me[1],xe=!1,Ne=0,Pe=ke+1;Pe<Ie;Pe++){var Le=Z[Pe];if(r[Le]&Ee){xe=!0;var De=r[Le]&me?Jr:$r;if(De===nt(Le)){Ne=De;break}}}if(xe&&!Ne){Ne=W;for(var Fe=ke-1;Fe>=0;Fe--){var Be=Z[Fe];if(r[Be]&Ee){var Ve=r[Be]&me?Jr:$r;Ne=Ve!==nt(Be)?Ve:nt(Be);break}}}if(Ne){if(r[Z[ke]]=r[Z[Ie]]=Ne,Ne!==nt(Z[ke]))for(var He=ke+1;He<Z.length;He++)if(!(r[Z[He]]&Fr)){Hr(e[Z[He]])&ui&&(r[Z[He]]=Ne);break}if(Ne!==nt(Z[Ie]))for(var Ue=Ie+1;Ue<Z.length;Ue++)if(!(r[Z[Ue]]&Fr)){Hr(e[Z[Ue]])&ui&&(r[Z[Ue]]=Ne);break}}}for(var Ze=0;Ze<Z.length;Ze++)if(r[Z[Ze]]&Dr){for(var We=Ze,je=Ze,Ge=W,ze=Ze-1;ze>=0;ze--){if(!(r[Z[ze]]&Fr)){Ge=r[Z[ze]]&me?Jr:$r;break}We=ze}for(var Ye=j,Xe=Ze+1;Xe<Z.length;Xe++){if(!(r[Z[Xe]]&(Dr|Fr))){Ye=r[Z[Xe]]&me?Jr:$r;break}je=Xe}for(var Ke=We;Ke<=je;Ke++)r[Z[Ke]]=Ge===Ye?Ge:nt(Z[Ke]);Ze=je}}}for(var qe=c.start;qe<=c.end;qe++){var $e=s[qe],Je=r[qe];if(1&$e?Je&($r|Qr|ni)&&s[qe]++:Je&Jr?s[qe]++:Je&(ni|Qr)&&(s[qe]+=2),Je&Fr&&(s[qe]=0===qe?c.level:s[qe-1]),qe===c.end||Hr(e[qe])&(oi|ii))for(var Qe=qe;Qe>=0&&Hr(e[Qe])&Br;Qe--)s[Qe]=c.level}}var et={levels:s,paragraphs:l};return hi.set(n,et),et;function tt(t){for(var n=1,i=t+1;i<e.length;i++){var o=r[i];if(o&ii)break;if(o&ci){if(0==--n)return i}else o&Pr&&n++}return-1}function nt(e){return 1&s[e]?Jr:$r}}function fi(e){var t=Rn(e),n=t.width,r=t.maxWidth,i=t.minWidth;return n&&"auto"!==n||r||i}var pi=function(e){if(void 0===e.lineBreakerPosition){for(var t=e.props.content,n=[0],r=new kr(t,{breakSpaces:!0}),i=r.nextBreak();i;)n.push(i.position),i=r.nextBreak();e.lineBreakerPosition=n}};function vi(e){if(!1===e.props.lineWrap)return 1;if(Ro(e))return 0;if(fi(e))return 1;var t;if(!wo(e)&&(!bo(e,He.Div)&&!bo(e,"Component")||null===(t=e.children)||void 0===t||!t.length))return 1;return $n(e)?1:e.children&&0!==e.children.length?null:1}function gi(e){var t,n,r,i;return!((!e.element||(i=e.element,i.parent))&&1!==vi(e))||!$n(e.parent)&&(null===(t=e.parent)||void 0===t||null===(n=t.runtime)||void 0===n||null===(r=n.context)||void 0===r?void 0:r.individual)}function _i(e){var t=e.width,n=e.height,r=0,i=0,o=0,a=0,s=0,u=0,l=0,c=0,h=0,d=0,f=0,p=0,v=t,g=n,_=t,y=n;if(mi(e.type)){var m,E,b,T,C,S,w,R,A,O,M,k,I=hn(e);r=null!==(m=I.marginLeft)&&void 0!==m?m:0,i=null!==(E=I.marginTop)&&void 0!==E?E:0,o=null!==(b=I.marginRight)&&void 0!==b?b:0,a=null!==(T=I.marginBottom)&&void 0!==T?T:0,s=null!==(C=I.paddingLeft)&&void 0!==C?C:0,u=null!==(S=I.paddingTop)&&void 0!==S?S:0,l=null!==(w=I.paddingRight)&&void 0!==w?w:0,c=null!==(R=I.paddingBottom)&&void 0!==R?R:0,h=null!==(A=I.borderLeftWidth)&&void 0!==A?A:0,d=null!==(O=I.borderTopWidth)&&void 0!==O?O:0,v=t-s-l-h-(f=null!==(M=I.borderRightWidth)&&void 0!==M?M:0),g=n-u-c-d-(p=null!==(k=I.borderBottomWidth)&&void 0!==k?k:0),_=t+r+o,y=n+i+a}return{marginLeft:r,marginTop:i,marginRight:o,marginBottom:a,borderBottom:p,paddingLeft:s,paddingTop:u,paddingRight:l,paddingBottom:c,borderLeft:h,borderTop:d,borderRight:f,contentWidth:v,contentHeight:g,outerWidth:_,outerHeight:y,innerWidth:t,innerHeight:n}}function yi(e){return Mo(e)?_i(e):{marginLeft:0,marginTop:0,marginRight:0,marginBottom:0,borderLeft:0,borderTop:0,borderRight:0,borderBottom:0,paddingLeft:0,paddingTop:0,paddingRight:0,paddingBottom:0,contentWidth:0,contentHeight:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0}}function mi(e){return Ft.has(e)}function Ei(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=Math.max(n,t),a=i?o:Math.min(r,o);return"auto"===e?a:r}var bi=function(e){var t,n=e.runtime;if(n){var r=n.constraint;null==r||null===(t=r.fragments)||void 0===t||t.add(e),null!=r&&r.disableRTL&&To(e,[He.Text])&&(e.dir="none")}};function Ti(e,t,n){var r,i=hn(e),o=t?{}:i;if(t)for(var a=0;a<t.length;a++){var s=t[a];o[s]=i[s]}var u=e.runtime;On(u,Ci(e,o)),On(u,{individual:null!==(r=n)&&void 0!==r?r:gi(e)}),bi(e)}function Ci(e,t){var n=function(e,t){var n,r,i=e.runtime.constraint,o=i.maxWidth,a=i.stretchWidth,s=i.flexWidth,u=i.originMaxWidth,l=t.maxWidth,c=t.width,h=t.minWidth;if(De(s))return{maxWidth:s,minWidth:s,width:s};var d=null!==(n=o)&&void 0!==n?n:1/0,f=null!==(r=h)&&void 0!==r?r:0,p=c,v=u,g=0,_=0;if(mi(e.type)){var y,m,E,b,T,C,S=t.paddingLeft,w=t.paddingRight,R=t.borderLeftWidth,A=t.borderRightWidth;g=(null!==(y=t.marginLeft)&&void 0!==y?y:0)+(null!==(m=t.marginRight)&&void 0!==m?m:0),_=(null!==(E=S)&&void 0!==E?E:0)+(null!==(b=w)&&void 0!==b?b:0)+(null!==(T=R)&&void 0!==T?T:0)+(null!==(C=A)&&void 0!==C?C:0)}De(v)&&(Vt.has(e.type)&&(d=Math.max(d,v)),v=bo(e,He.Table)?void 0:Math.max(v-g,0));d=Math.max(d-g,0),De(l)&&(d=Math.min(d,l));f=Math.max(f,_),De(p)?d=f=p=Math.min(Math.max(f,p),d):De(a)&&(f=Math.min(Math.max(a-g,f),d));return{maxWidth:d,minWidth:f,width:p,originMaxWidth:v}}(e,t),r=n.maxWidth,i=n.minWidth,o=n.originMaxWidth,a=function(e,t){var n,r,i=e.runtime.constraint,o=i.maxHeight,a=i.stretchHeight,s=i.flexHeight,u=t.maxHeight,l=t.height,c=t.minHeight;if(De(s))return{maxHeight:s,minHeight:s,height:s};var h=null!==(n=o)&&void 0!==n?n:1/0,d=null!==(r=c)&&void 0!==r?r:0,f=l,p=0,v=0;if(mi(e.type)){var g,_,y,m,E,b,T=t.paddingTop,C=t.paddingBottom,S=t.borderTopWidth,w=t.borderBottomWidth;p=(null!==(g=t.marginTop)&&void 0!==g?g:0)+(null!==(_=t.marginBottom)&&void 0!==_?_:0),v=(null!==(y=T)&&void 0!==y?y:0)+(null!==(m=C)&&void 0!==m?m:0)+(null!==(E=S)&&void 0!==E?E:0)+(null!==(b=w)&&void 0!==b?b:0)}h=Math.max(h-p,0),De(u)&&(h=Math.min(h,u));d=Math.max(d,v),De(f)?h=d=f=Math.min(Math.max(d,f),h):De(a)&&(d=Math.min(Math.max(a-p,d),h));return{maxHeight:h,minHeight:d,height:f}}(e,t),s=a.maxHeight,u=a.minHeight;return{maxWidth:r,minWidth:i,maxHeight:s,minHeight:u,originMaxWidth:o,isRelayoutBoundary:0!==r&&0!==s&&r===i&&s===u}}function Si(e){var t=e.runtime.context,n=t.maxWidth,r=void 0===n?1/0:n,i=t.maxHeight,o=void 0===i?1/0:i,a=t.originMaxWidth,s=e.type;a=function(e,t,n){if(!De(t)||e>t)return t;if(!Vt.has(n))return e}(r,a,s);var u,l=hn(e);if(mi(s)){var h,d,f,p,v,g,_,y,m=l.borderLeftWidth,E=l.borderRightWidth,b=l.borderTopWidth,T=l.borderBottomWidth,C=(null!==(h=m)&&void 0!==h?h:0)+(null!==(d=E)&&void 0!==d?d:0)+(null!==(f=l.paddingLeft)&&void 0!==f?f:0)+(null!==(p=l.paddingRight)&&void 0!==p?p:0),S=(null!==(v=b)&&void 0!==v?v:0)+(null!==(g=T)&&void 0!==g?g:0)+(null!==(_=l.paddingTop)&&void 0!==_?_:0)+(null!==(y=l.paddingBottom)&&void 0!==y?y:0);r=Math.max(r-C,0),o=Math.max(o-S,0)}if(u=s,Bt.has(u)){var w=l.overflowScrollX,R=l.overflowScrollY;if(w){var A=wi(r,a),O=(0,c.Z)(A,2);r=O[0],a=O[1]}R&&(o=1/0)}De(a)&&(r=1/0);var M={originMaxWidth:a,maxWidth:r,maxHeight:o};return Ao(e)?M:Ve(M,Wt)}function wi(e,t){return t?[e,t]:[1/0,e]}function Ri(e){var t=e.maxWidth,n=e.originMaxWidth;return n&&t===1/0?Ve({},e,{maxWidth:n}):e}function Ai(e,t){var n=e.children;if(null!=n&&n.length){var r,i=be(n);try{for(i.s();!(r=i.n()).done;){var o=r.value;!Co(o)&&t(o)}}catch(e){i.e(e)}finally{i.f()}}}function Oi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=0,i=0;return Ai(e,(function(e){var o=yi(e),a=o.outerWidth,s=o.outerHeight,u=o.marginLeft,l=o.marginTop;tn(e,{left:u+t,top:l+n}),r=Math.max(a,r),i=Math.max(s,i)})),[r,i]}var Mi={wrapup:function(e,t){var n=t.maxWidth,r=t.minWidth,i=t.maxHeight,o=t.minHeight,a=t.isWeakWidth,s=Oi(e);tn(e,{width:Ei("auto",s[0],r,n,a),height:Ei("auto",s[1],o,i)})},getNext:function(e){for(var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=null!==(t=e.children)&&void 0!==t?t:[],i=r.length;n<i-1&&Co(r[n+1]);)n++;return++n>=i?-1:n},buildContext:function(e){return Ti(e,[])},createChildConstraint:function(e,t){Mn(t.runtime,Si(e))}},ki=new WeakMap;function Ii(e){var t;return null===(t=ki.get(e))||void 0===t?void 0:t.visibleAreaMap}function xi(e){var t;null===(t=Ii(e))||void 0===t||t.clear()}function Ni(e,t){var n=ki.get(e);if(n){for(var r=n.area,i=n.visibleAreaMap,o=t;o;){var a=i.get(o);if(a)return[a,o];o=o.parent}return[r,null]}}var Pi={color:Me,controlBarColor:ke,needControlBar:!1,controlWidth:2,controlBarRadius:4},Li=function(e){return e.TOP="borderTopColor",e.RIGHT="borderRightColor",e.BOTTOM="borderBottomColor",e.LEFT="borderLeftColor",e}(Li||{}),Di=function(e){return e.TOP="borderTop",e.RIGHT="borderRight",e.BOTTOM="borderBottom",e.LEFT="borderLeft",e}(Di||{}),Fi=function(e){return e.TOP="outlineTopColor",e.RIGHT="outlineRightColor",e.BOTTOM="outlineBottomColor",e.LEFT="outlineLeftColor",e}(Fi||{}),Bi=function(e){return e.TOP="outlineTop",e.RIGHT="outlineRight",e.BOTTOM="outlineBottom",e.LEFT="outlineLeft",e}(Bi||{}),Vi=function(e,t,n){return e>=t&&e<n},Hi=function(e,t,n){return Math.min(Math.max(e,t),n)},Ui=function(e,t){var n=e.x,r=e.y,i=t.left,o=t.top,a=t.width,s=t.height;return Vi(n,i,i+a)&&Vi(r,o,o+s)},Zi={left:0,top:0,width:0,height:0};function Wi(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zi,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Ve(t,e)}var ji=function(e,t){var n=e.left+e.width,r=e.top+e.height,i=t.left+t.width,o=t.top+t.height;return!(n<t.left||i<e.left||r<t.top||o<e.top)},Gi=function(e,t){var n=e.left,r=e.top,i=e.left+e.width,o=e.top+e.height,a=t.left,s=t.top,u=t.left+t.width,l=t.top+t.height;return n<=a&&i>=u&&r<=s&&o>=l};function zi(e){if(!e.length)return Wi();var t=e.map((function(e){var t=e.left,n=e.top;return{left:t,top:n,right:t+e.width,bottom:n+e.height}})).reduce((function(e,t){var n=e.left,r=e.top,i=e.right,o=e.bottom,a=t.left,s=t.top,u=t.right,l=t.bottom;return{left:Math.min(n,a),top:Math.min(r,s),right:Math.max(i,u),bottom:Math.max(o,l)}})),n=t.left,r=t.top,i=t.right,o=t.bottom;return{left:n,top:r,width:Math.max(0,i-n),height:Math.max(0,o-r)}}function Yi(e){if(!e.length)return Wi();var t=e.map((function(e){var t=e.left,n=e.top;return{left:t,top:n,right:t+e.width,bottom:n+e.height}})).reduce((function(e,t){var n=e.left,r=e.top,i=e.right,o=e.bottom,a=t.left,s=t.top,u=t.right,l=t.bottom;return{left:Math.max(n,a),top:Math.max(r,s),right:Math.min(i,u),bottom:Math.min(o,l)}})),n=t.left,r=t.top,i=t.right,o=t.bottom;return{left:n,top:r,width:Math.max(0,i-n),height:Math.max(0,o-r)}}function Xi(e,t,n){var r=n.startFrom,i=n.endTo,o=n.origin,a=(o=void 0===o?{left:0,top:0}:o).left,s=void 0===a?0:a,u=o.top,l=void 0===u?0:u,c=n.relativeTo,h=(c=void 0===c?{left:0,top:0}:c).left,d=void 0===h?0:h,f=c.top,p=void 0===f?0:f,v=n.childrenProperty,g=void 0===v?"children":v,_=n.parentProperty,y=void 0===_?"parent":_,m=[],E=[],b=r?Kt(r):null,T=i?Kt(i):null;m.push({node:e,left:s-d,top:l-p,sourceLeft:s-d,sourceTop:l-p});for(var C=1;m.length;){var S,w,R=m.pop(),A=R.node,O=R.left,M=R.top,k=O,I=M;if(Co(A))k=(null!==(S=A.x)&&void 0!==S?S:0)-d,I=(null!==(w=A.y)&&void 0!==w?w:0)-p;else A!==e&&(k+=A.left,I+=A.top);E.push({node:A,left:k,top:I,sourceLeft:O,sourceTop:M}),C=t({left:k,top:I,renderObject:A,isBackward:!1})||1;var x=A[g];if(null!=x&&x.length&&C<=1){var N,P=null!==(N=null==b?void 0:b.get(A))&&void 0!==N?N:-1,L=null==x?void 0:x[Math.max(P,0)];if(L){var D,F,B,V,H=k-(null!==(D=A.scrollLeft)&&void 0!==D?D:0),U=I-(null!==(F=A.scrollTop)&&void 0!==F?F:0),Z=O-(null!==(B=A.scrollLeft)&&void 0!==B?B:0),W=M-(null!==(V=A.scrollTop)&&void 0!==V?V:0);m.push({node:L,left:H,top:U,sourceLeft:Z,sourceTop:W});continue}}for(;E.length;){var j=E.pop(),G=j.node,z=j.left,Y=j.top,X=j.sourceLeft,K=j.sourceTop;if(C<=1&&t({left:z,top:Y,renderObject:G,isBackward:!0}),3!==C&&G!==e){var q=G[y];if(q){var $=q[g],J=$.indexOf(G)+1,Q=null==T?void 0:T.get(q);if(void 0===Q||Q>=J){var ee=null==b?void 0:b.get(q),te=$[J];if(void 0!==ee&&J<ee&&(te=$[ee]),te){m.push({node:te,left:X,top:K,sourceLeft:X,sourceTop:K});break}}}}C=1}}}function Ki(e,t){var n,r;return null===(n=Kn(e))||void 0===n||null===(r=n.paint)||void 0===r?void 0:r[t]}var qi=function(e,t,n){var r=hn(t).transform;if(r&&r.rotate){var i=n.left,o=n.top,a=n.width,s=n.height,u=r.rotate,l=r.origin,c=void 0===l?{x:a/2,y:s/2}:l,h={x:i+c.x,y:o+c.y};e.save(),e.rotate(u*Math.PI/180,h)}},$i=function(e,t){var n=hn(t).transform;n&&n.rotate&&e.restore()};function Ji(e,t,n){var r=t.borderLeft,i=t.borderTop,o=t.paddingLeft,a=t.paddingTop,s=t.contentWidth,u=t.contentHeight,l=n.left+r+o,c=n.top+i+a,h=Math.max(e.x,l),d=Math.max(e.y,c),f=Math.min(e.x+e.width,l+s),p=Math.min(e.y+e.height,c+u);return{x:h,y:d,width:Math.max(0,f-h),height:Math.max(0,p-d),scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function Qi(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t.left,i=t.top,o=t.width,a=t.height,s=t.fill,u=t.stroke,l=t.radius;l?to(e,l):(e.beginPath(),e.rect(r,i,o,a)),n&&eo(e,t),s&&e.fill(),u&&e.stroke()}function eo(e,t){var n,r=t.fill,i=t.stroke,o=t.lineWidth,a=t.opacity;(r&&(e.fillStyle=r),i)&&(e.strokeStyle=i,e.lineWidth=null!==(n=o)&&void 0!==n?n:0);a!==e.globalAlpha&&(e.globalAlpha=a)}function to(e,t){var n=(0,c.Z)(t.rect,2),r=(0,c.Z)(n[0],2),i=r[0],o=r[1],a=(0,c.Z)(n[1],2),s=a[0],u=a[1],l=(0,c.Z)(t.ellipse,2),h=(0,c.Z)(l[0],4),d=h[0],f=h[1],p=h[2],v=h[3],g=(0,c.Z)(l[1],4),_=g[0],y=g[1],m=g[2],E=g[3];e.beginPath(),e.ellipse(d[0],d[1],_[0],_[1],0,Math.PI,1.5*Math.PI,!1),e.lineTo(f[0],o),e.ellipse(f[0],f[1],y[0],y[1],0,1.5*Math.PI,0,!1),e.lineTo(i+s,p[1]),e.ellipse(p[0],p[1],m[0],m[1],0,0,.5*Math.PI,!1),e.lineTo(v[0],o+u),e.ellipse(v[0],v[1],E[0],E[1],0,.5*Math.PI,Math.PI,!1),e.lineTo(i,d[1]),e.closePath()}function no(e,t,n,r,i){if(fn(i)){var o=i.borderTopWidth,a=void 0===o?0:o,s=i.borderRightWidth,u=void 0===s?0:s,l=i.borderBottomWidth,c=void 0===l?0:l,h=i.borderLeftWidth,d=void 0===h?0:h,f=i.bTLRH,p=void 0===f?0:f,v=i.bTLRV,g=void 0===v?p:v,_=i.bTRRH,y=void 0===_?0:_,m=i.bTRRV,E=void 0===m?y:m,b=i.bBRRH,T=void 0===b?0:b,C=i.bBRRV,S=void 0===C?T:C,w=i.bBLRH,R=void 0===w?0:w,A=i.bBLRV,O=void 0===A?R:A,M=function(e){return e.map((function(e){return Math.max(0,e)}))},k=M([p-d,g-a]),I=[e+k[0],t+k[1]],x=M([y-u,E-a]),N=[e+n-x[0],t+x[1]],P=M([R-d,O-c]),L=[e+P[0],t+r-P[1]],D=M([T-u,S-c]);return{rect:[[e,t],[n,r]],ellipse:[[I,N,[e+n-D[0],t+r-D[1]],L],[k,x,D,P]]}}}var ro={willPaint:Ne,didPaint:Ne};function io(e,t){for(var n=0,r=e.length;n<r;){var i=Math.floor((n+r)/2);switch(t(e[i],i,e)){case"left":r=i;break;case"right":n=i+1;break;case"found":return i}}return n}var oo=function(){var e,t,n=Fn(["mutate"],e,t,!1);return function(e){for(var t,r,i=bo(e)?To:mo,o=bo(e)?$n:Jn,a=!1,s=e;s;){if(!r&&n.has(s)){r=n.get(s),a=!0;break}if(o(s)&&(r=s),i(s,[He.Absolute,He.Fixed,He.TableCell])||!s.parent||i(s.parent,[He.BlockFlow,He.SuperList,He.FlexColumn,He.FlexRow]))break;s=s.parent}r=null!==(t=r)&&void 0!==t?t:s;for(var u=Xt(e,a?s:r),l=0;l<u.length;l++)n.set(u[l],r);return r}}();function ao(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null!==(t=e.children)&&void 0!==t&&t.length?e.children.length:bo(e,He.Text)||yo(e,He.Text)?e.props.content.length:n}function so(e,t,n){var r,i=e.children;r=De(n)&&n<i.length&&n>=0?n:i.length,en(t,"parent",e),function(e,t,n){var r=e.children;(void 0===r?[]:r).splice(t,0,n)}(e,r,t),So(t)&&function(e){var t=function(e){if(bo(e,He.Fixed)){for(;e.parent;)e=e.parent;return e}for(;e.parent;){if(So(e.parent))return e.parent;e=e.parent}return e}(e);if(t){en(e,"refPosRo",t),t.posRos||(t.posRos=[]);var n=t.posRos,r=(i=n,o=Xt(e).reverse(),i.length&&Qt(Xt(Fe(i)).reverse(),o)<0?i.length:io(i,(function(e){var t=Qt(Xt(e).reverse(),o);return t>0?"left":t<0?"right":"found"})));r>=n.length?n.splice(n.length,0,e):n[r]!==e&&n.splice(r,0,e)}var i,o}(t)}function uo(e){if("number"==typeof e)return new Array(4).fill(e);var t=lo(e),n=t.length;return n?(n>3||(1===n?(t[1]=t[0],t[3]=t[0]):t[3]=t[1],n<3&&(t[2]=t[0])),t):new Array(4).fill(0)}function lo(e){for(var t=[],n=0,r=(e=e.trim().replace(/\s+/g," ")).length,i=0;i<r;i++)switch(e[i]){case"(":for(;++i<r&&")"!==e[i];);break;case" ":t.push(e.substring(n,i)),n=i+1}return t.push(e.substring(n)),t}new Set(["borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","outlineTopWidth","outlineRightWidth","outlineBottomWidth","outlineLeftWidth","borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius","marginTop","marginRight","marginBottom","marginLeft","paddingTop","paddingRight","paddingBottom","paddingLeft","width","height","maxWidth","maxHeight","minWidth","minHeight","outlineOffset","top","right","bottom","left","fontSize","textIndent"]);var co={},ho=function(e){var t,n,r,i,o,a,s,u,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:go(e),h={bTLRH:null!==(t=e.borderTopLeftRadius)&&void 0!==t?t:e.bTLRH,bTLRV:null!==(n=e.borderTopLeftRadius)&&void 0!==n?n:e.bTLRV,bTRRH:null!==(r=e.borderTopRightRadius)&&void 0!==r?r:e.bTRRH,bTRRV:null!==(i=e.borderTopRightRadius)&&void 0!==i?i:e.bTRRV,bBRRH:null!==(o=e.borderBottomRightRadius)&&void 0!==o?o:e.bBRRH,bBRRV:null!==(a=e.borderBottomRightRadius)&&void 0!==a?a:e.bBRRV,bBLRH:null!==(s=e.borderBottomLeftRadius)&&void 0!==s?s:e.bBLRH,bBLRV:null!==(u=e.borderBottomLeftRadius)&&void 0!==u?u:e.bBLRV},d=e.borderRadius,f=null!=d&&""!==d;if(f)if(d!==e.__borderRadius){var p,v,g=function(t,n){return void 0!==e[t]&&l[t]>l.borderRadius?h[t]:n};if("string"==typeof d){var _,y=d.split("/").map((function(e){return uo(e)})),m=(0,c.Z)(y,2);p=m[0],v=m[1],v=null!==(_=v)&&void 0!==_?_:p}else v=p=uo(d);kt.map((function(e){return["".concat(e,"H"),"".concat(e,"V")]})).forEach((function(e,t){var n=(0,c.Z)(e,2),r=n[0],i=n[1];h[r]=g(r,p[t]),h[i]=g(i,v[t])}))}else Object.keys(h).forEach((function(t){!e["__".concat(t)]||void 0!==e[t]&&l[t]>l.borderRadius||(h[t]=e["__".concat(t)])}));Mt.forEach((function(t,n){var r=e[t];if(r&&!(f&&l.borderRadius>l[t])){var i=["".concat(kt[n],"H"),"".concat(kt[n],"V")];if(r!==e["__".concat(t)]){var o,a;if("string"==typeof r){var s,u=lo(r),d=(0,c.Z)(u,2);o=d[0],a=null!==(s=a=d[1])&&void 0!==s?s:o}else a=o=r;var p=[o,a];i.forEach((function(n,r){return h[n]=function(n,r){return void 0!==e[n]&&l[n]>l[t]?h[n]:r}(n,p[r])}))}else i.forEach((function(n){!e["__".concat(n)]||void 0!==e[n]&&l[n]>l[t]||(h[n]=e["__".concat(n)])}))}})),It.forEach((function(t){void 0===h[t]&&(h[t]=e["__".concat(t)])})),Ve(e,h)};function fo(e,t){for(var n=0;n<t.length;n++)if(e[t[n]])return!0;return!1}function po(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:go(e),r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=Ot[t],o=(i.allSide,i.allWidth),a=i.allDirection,s=i.widthSide,u=i.styleSide,l=i.colorSide;if(r||fo(e,o)){var h={};a.forEach((function(t){h[t]=e[t]}));var d=void 0!==e[t]&&null!==e[t]&&""!==e[t];if(d)if(e[t]!==e["__".concat(t)]){var f=function(r,i){return void 0!==e[r]&&n[r]>n[t]?h[r]:i},p=lo(e[t]),v=(0,c.Z)(p,3),g=v[0],_=v[1],y=v[2];g&&s.forEach((function(e){h[e]=f(e,g)})),_&&u.forEach((function(e){h[e]=f(e,_)})),y&&l.forEach((function(e){h[e]=f(e,y)}))}else Object.keys(h).forEach((function(r){!e["__".concat(r)]||void 0!==e[r]&&n[r]>n[t]||(h[r]=e["__".concat(r)])}));Ye.forEach((function(r){var i="".concat(t).concat(r),o=e[i];if(o&&!(d&&n[t]>n[i]))if(o!==e["__".concat(i)]){var a=lo(o),s=(0,c.Z)(a,3),u=s[0],l=s[1],f=s[2];u&&(void 0===e["".concat(i,"Width")]||n["".concat(i,"Width")]<n[i])&&(h["".concat(i,"Width")]=u),l&&(void 0===e["".concat(i,"Style")]||n["".concat(i,"Style")]<n[i])&&(h["".concat(i,"Style")]=l),f&&(void 0===e["".concat(i,"Color")]||n["".concat(i,"Color")]<n[i])&&(h["".concat(i,"Color")]=f)}else["".concat(i,"Width"),"".concat(i,"Style"),"".concat(i,"Color")].forEach((function(t){!e["__".concat(t)]||void 0!==e[t]&&n[t]>n[i]||(h[t]=e["__".concat(t)])}))})),["Width","Style","Color"].forEach((function(r){var i,o="".concat(t).concat(r),a=e[o];void 0===a||d&&n[t]>n[o]||(a!==e["__".concat(o)]&&(i=uo(a)),Ye.forEach((function(a,s){var u,l;e["".concat(t).concat(a)]&&n["".concat(t).concat(a)]>n[o]||e["".concat(t).concat(a).concat(r)]&&n["".concat(t).concat(a).concat(r)]>n[o]||(h["".concat(t).concat(a).concat(r)]=null!==(u=null===(l=i)||void 0===l?void 0:l[s])&&void 0!==u?u:e["__".concat(t).concat(a).concat(r)])})))})),s.forEach((function(e){var t=h[e];h[e]="string"==typeof t?parseInt(t,10):t})),Ve(e,h)}}function vo(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:go(e),r=Ye.map((function(e){return"".concat(t).concat(e)})),i=e[t];if(void 0===i)return r.forEach((function(t){return e[t]=e[t]||0}));if(e["__".concat(t)]===i)return r.forEach((function(t){(void 0===e[t]||n[t]<n["__".concat(t)])&&(e[t]=e["__".concat(t)])}));if(!_o(i))return pn("unsupport "+t+" value",i),co;var o=uo(i);r.forEach((function(r,i){(void 0===e[r]||n[r]<n[t])&&(e[r]=o[i])}))}function go(e){var t={};return Object.keys(e).forEach((function(e,n){t[e]=n})),t}function _o(e){var t=(0,u.Z)(e);return"number"===t||"string"===t}function yo(e,t){var n,r=Eo(e)?He.Component:null==e||null===(n=e.type)||void 0===n?void 0:n.key;return t?t===r:void 0!==He[r]}function mo(e,t){var n,r=null==e||null===(n=e.type)||void 0===n?void 0:n.key;return t.includes(r)||Eo(e)&&t.includes(He.Component)}function Eo(e){var t=null==e?void 0:e.type;return"function"==typeof t&&!t.isRoadsterComponent}function bo(e,t){var n=null==e?void 0:e.type;return t?t===n:void 0!==He[n]}function To(e,t){var n=null==e?void 0:e.type;return t?t.includes(n):void 0!==He[n]}function Co(e){return To(e,Ze)}function So(e){return Co(e)||function(e){return To(e,Ue)&&!!e.props.asRelative}(e)}function wo(e){return bo(e,He.InlineFlow)}function Ro(e){return bo(e,He.Text)}function Ao(e){return To(e,We)}function Oo(e){return To(e,je)}function Mo(e){return Cn(hn(e))&&!Co(e)}function ko(e){return!!e.width&&!!e.height&&Mo(e)}function Io(e){for(var t=e,n=oo(t);null!==(r=t)&&void 0!==r&&r.parent;){var r;if(t.parent===n&&$n(t.parent))return t;t=t.parent}}function xo(e){var t,n,r={root:(n=e).root,element:n.element,type:n.type,parent:void 0,children:[],style:{},props:Ve({},n.props),width:0,height:0,top:0,left:0};tn(r,{width:e.width,height:e.height,left:e.left,top:e.top,style:Ve({},e.style),sourceRo:e}),"baseline"in e&&en(r,"baseline",e.baseline),"lineOuterHeight"in e&&en(r,"lineOuterHeight",e.lineOuterHeight),"lineOffsetTop"in e&&en(r,"lineOffsetTop",e.lineOffsetTop),"dir"in e&&en(r,"dir",e.dir),rn(r);var i=null===(t=e.element)||void 0===t?void 0:t.renderObjects;if(null!=i&&i.length){var o=i.indexOf(e);i.splice(o+1,0,r)}return r}function No(e){var t={status:1,context:null,constraint:null,isSkipLayout:!1,isComputedStyle:!1,completedLinesCount:void 0,didCallLayout:!1};return e.runtime=t,t}function Po(e){return 0==(5&e.status)}function Lo(e){return!Po(e)}function Do(e){return!Fo(e)&&!Po(e)}function Fo(e){return(4&e.status)>0}function Bo(e,t,n){for(var r=0,i=0;i<t.length;i++)r|=t[i];n?e|=r:e&=4294967295^r;return e}function Vo(e){if(!e)return!1;if(0!==e.width||0!==e.height||0!==e.left||0!==e.top)return!0;var t=e.runtime;return!(!t||Do(t))}[].concat((0,a.Z)(Tt),(0,a.Z)(Et));function Ho(e){var t,n;return null!==(t=Ro(e)?e.props.content.length:null===(n=e.children)||void 0===n?void 0:n.length)&&void 0!==t?t:0}function Uo(e){var t,n,r,i,o=null!==(t=e.fontWeight)&&void 0!==t?t:400,a=null!==(n=e.fontStyle)&&void 0!==n?n:"normal",s=null!==(r=e.fontFamily)&&void 0!==r?r:Re;return{fontWeight:o,fontSize:null!==(i=e.fontSize)&&void 0!==i?i:Ae,fontFamily:s,fontStyle:a}}function Zo(e){var t=Uo(e),n=t.fontWeight,r=t.fontStyle,i=t.fontSize,o=t.fontFamily;return"".concat(n," ").concat(r," ").concat(i,"px ").concat(o)}function Wo(e,t){var n,r,i,o,a=t.constraint,s=t.utils,u=null!==(n=e.runtime)&&void 0!==n?n:No(e),l=null===(r=Xn(e.type))||void 0===r?void 0:r.layout,c=e.parent;if(c){var h,d,f,p=c.runtime;if(p&&a)An(p,"context",Ve({},a,null!==(f=p.context)&&void 0!==f?f:{}));var v=null===(h=Xn(c.type))||void 0===h||null===(d=h.layout)||void 0===d?void 0:d.createChildConstraint;null==v||v(c,e,s)}else a.inheritedStyle=wn(Rn(e),a.inheritedStyle),An(u,"constraint",a);!0===t.disableComputeStyle||u.isComputedStyle||(null==l||null===(o=l.computeStyle)||void 0===o||o.call(l,e,u.constraint),u&&(u.isComputedStyle=!0));null==l||null===(i=l.buildContext)||void 0===i||i.call(l,e,s)}var jo=function(e,t){var n,r,i=e.runtime;if(Lo(i)){var o=t.utils,a=t.index;null===(n=(r=Kn(e).layout).wrapup)||void 0===n||n.call(r,e,i.context,o),function(e){var t=e.runtime;if(t){var n=e.children,r=void 0===n?[]:n,i=2147418112&t.status,o=0;(2&t.status)>0&&(o|=2);for(var a=0,s=0;s<r.length;s++){var u=r[s];if(Mo(u)){var l=u.runtime;if(l&&(Do(l)?a|=2:Po(l)&&(a|=1),Fo(l)&&(a|=4)),3==(3&a)||4==(4&a)){o|=4;break}}}0==(4&o)&&2==(2&a)&&2==(2|a)&&(o=1),(5&t.status)>0&&0==(5&o)&&(o|=2),An(t,"status",i|o)}}(e);var s,u,l,c=e.parent;if(c&&Mo(e))null===(s=(u=Kn(c).layout).transition)||void 0===s||s.call(u,c,e,c.runtime.context,o,null!==(l=a)&&void 0!==l?l:Jt(e))}};var Go=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=e.measureText(t,Object.assign({},n,{fontSize:n.fontSize/r})),o=i.width,a=i.actualBoundingBoxAscent,s=i.actualBoundingBoxDescent,u=i.actualBoundingBoxLeft,l=i.actualBoundingBoxRight,c=i.fontBoundingBoxAscent,h=i.fontBoundingBoxDescent;return{width:o*r,actualBoundingBoxAscent:a&&a*r,actualBoundingBoxDescent:s&&s*r,actualBoundingBoxLeft:u&&u*r,actualBoundingBoxRight:l&&l*r,fontBoundingBoxAscent:c&&c*r,fontBoundingBoxDescent:h&&h*r}},zo=function(e,t,n,r,i,o){if("italic"!==i.fontStyle)return n;n=Ve({},n);var a,s=Go(e,r,i,o),u=s.actualBoundingBoxLeft,l=s.actualBoundingBoxRight,c=s.width;if(void 0===u||void 0===l){var h=e.measureFont(i.fontFamily,i.fontSize).slope;l=c-(u=-t.height*(a=h*Math.PI/180,Math.tan(a))/2)}return n.left-t.left<=0&&(n.left+=u,n.width-=u),n.left+n.width>=t.left+t.width&&(n.width+=l-c),n};var Yo=function(e,t){var n,r;Un(!0,["layout"],r);var i,o,a=t.eventEmitter,s=t.onInterceptRenderObject,u=t.painter,l=t.maxHeight,c=t.maxWidth,h=t.disableComputeStyle,d=function(e,t){var n=t.eventEmitter,r=t.painter;return{getRootConstraint:function(){return function(e){for(var t=e;null!==(n=t)&&void 0!==n&&n.parent;){var n;t=t.parent}return t}(e).runtime.constraint},cloneRo:function(e){var t=xo(e);return null==n||n.trigger("cloneRenderObject",[e,t]),t},destroyRo:function(e){var t=e.parent;if(t){var r=t.children.indexOf(e);t.children.splice(r,1),function(e,t,n){for(var r=[e];r.length;){var i=r.pop();if(t(i))return i;for(var o=i.children,a=void 0===o?[]:o,s=a.length-1;s>=0;s--)null!=n&&n(a[s])||r.push(a[s])}}(e,(function(e){var t=e.refPosRo;if(t){var n=t.posRos.indexOf(e);t.posRos.splice(n,1)}}))}null==n||n.trigger("destroyRenderObject",[e])},measureText:function(e,t){return r.measureText(e,t)},measureFont:function(e,t){return r.measureFont(e,t)},measureTextWithZoom:function(e,t,n){return Go(r,e,t,n)}}}(e,{eventEmitter:a,painter:u}),f=(i=null!==(n=s)&&void 0!==n?n:[],o=i,function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0;i<o.length;i++)if(e=o[i].apply(null,n))return e});!function(e,t,n){var r=n.childrenProperty,i=void 0===r?"children":r,o=n.parentProperty,a=void 0===o?"parent":o,s=n.getNext,u=[],l=[];u.push({renderObject:e,index:0,isBackward:!1});for(var c=1;u.length;){var h=u.pop(),d=h.renderObject;c=t(h)||1,h.isBackward=!0,l.push(h);var f=d[i];if(null!=f&&f.length&&c<=1){var p,v=null!==(p=null==s?void 0:s(d))&&void 0!==p?p:0,g=null==f?void 0:f[v];if(g){u.push({renderObject:g,index:v,isBackward:!1});continue}}for(;l.length;){var _=l.pop(),y=_.renderObject,m=_.index;if(c<=1&&t(_),3!==c&&y!==e){var E=y[a];if(E){var b,T,C=null!==(b=null==s?void 0:s(E,m))&&void 0!==b?b:m+1,S=null===(T=E[i])||void 0===T?void 0:T[C];if(S){u.push({renderObject:S,index:C,isBackward:!1});break}}}c=1}}}(e,(function(t){var n,r=t.renderObject,i=t.index,o=t.isBackward,s=f(r,o);if(s&&s>1)return s;var u,p=null!==(n=r.runtime)&&void 0!==n?n:No(r),v=p.isSkipLayout,g=p.context;if(o){if(void 0!==(u=r.isDestructed)&&u)return 1;p.status=Bo(p.status,[65536],!0),jo(r,{utils:d,index:i}),p.status=Bo(p.status,[65536],!1),null==a||a.trigger("rolayout",[r])}else{var _,y;if(function(e,t){for(var n=[],r=e;r;){var i=r.runtime;if(null!=i&&i.context)break;n.push(r),r=r.parent}for(;n.length;)Wo(n.pop(),t)}(r,{utils:d,constraint:r===e&&void 0!==c&&void 0!==l?{maxWidth:c,maxHeight:l}:void 0,disableComputeStyle:h}),!(Cn(hn(r))&&!v&&0!==(null==g?void 0:g.maxHeight)&&0!==(null==g?void 0:g.maxWidth))||!Lo(p))return 2;null===(_=Kn(r).layout)||void 0===_||null===(y=_.willLayout)||void 0===y||y.call(_,r,p.context,d)}return 1}),{getNext:function(e,t){return Kn(e).layout.getNext(e,t)}}),function(e,t){Un(!1,e,t)}(["layout"])};var Xo=[function(e){return Cn(e.renderObject.style)?void 0:2},function(e){var t=hn(e.renderObject).opacity;if(De(t)&&t<=0)return 2},function(e){var t=e.area,n=e.rect;return n.left+n.width<t.x?2:void 0},function(e){var t=e.area;return e.rect.left>t.x+t.width?2:void 0},function(e){var t=e.renderObject,n=e.area,r=e.rect;if(r.height+r.top<n.y&&!function(e){if(!bo(e,He.TableRow))return!1;var t=e.parent,n=e.children,r=e.height,i=Jt(e);if(!n||i<0)return!1;for(var o=0;o<n.length;o++){var a=n[o];if(r!==a.height+2*a.top){var s=t.children[i+1];if(s&&!s.children[o].height)return!0}}return!1}(t))return 2},function(e,t){var n=e.area;if(e.rect.top>n.y+n.height)return null!=t&&t.isInHorizontalRo?2:3}];function Ko(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xo;return function(t,n){var r;return e.find((function(e){return r=e(t,n)})),r}}var qo=new WeakMap;function $o(e,t,n,r,i){var o,a;if(jn.has(5)&&null!==(o=t.children)&&void 0!==o&&o.length&&!Qo(t)&&(fn(hn(t))||function(e){var t=e.children,n=e.width,r=e.height;if(null!=t&&t.length){if(t.length>10)return!0;var i=zi(t),o=i.width,a=i.height,s=i.left,u=i.top;return s+o>n||u+a>r||s<0||u<0}return!1}(t)||i)){var s=null!==(a=Ni(e,t))&&void 0!==a?a:[],u=(0,c.Z)(s,1)[0];jn.push({type:5,subType:"clip",painter:e,renderObject:t,parentArea:u,area:r,rect:n,needSetPaintArea:!0})}}function Jo(e,t){jn.has(5)&&!Qo(t)&&function(e,t){var n;return!(null===(n=Ii(e))||void 0===n||!n.has(t))}(e,t)&&jn.push({type:5,subType:"restore",painter:e})}function Qo(e){return Co(e)||bo(e,He.HalfFullscreen)||bo(e,He.TableRow)}function ea(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=t.painter,a=t.area,s=t.colorConverter,u=o.globalAlpha,l=null!==(n=i)&&void 0!==n?n:{},h=l.eventEmitter,d=l.relativeTo,f=l.interceptors,p=l.origin,v=l.others,g=l.flushAll,_=void 0===g||g;Zn(o);for(var y=a.scrollTop,m=a.scrollLeft,E=Ko(f),b=[[e,{origin:p}]],T=function(e,t){b.push([e,Ve({globalAlpha:o.globalAlpha,isInHorizontalRo:!!r&&e!==r},t)])},C=function(){var e=b.pop(),t=(0,c.Z)(e,2),n=t[0],u=t[1],l=u.globalAlpha,f=u.origin,p=u.rectContainer,g=u.isInHorizontalRo,_=void 0;De(l)&&(_=o.globalAlpha,o.globalAlpha=l),Xi(n,(function(e){var t,u,l,c,d=e.left,f=e.top,_=e.renderObject,b=e.isBackward;d-=m,f-=y;var C=_.width,S=_.height,w=null!==(t=null===(u=i.translate)||void 0===u?void 0:u.x)&&void 0!==t?t:0,R=null!==(l=null===(c=i.translate)||void 0===c?void 0:c.y)&&void 0!==l?l:0,A={left:d+w,top:f+R,width:C,height:S},O={colorConverter:s,renderObject:_,area:Ve({},a,{x:a.x+w,y:a.y+R}),rect:A,asRoot:n===_,painter:o,pushPaintQueue:T,rectContainer:p,others:v};if(b)r===_&&(r=void 0),na(O,h);else{var M,k,I=!g&&!r,x=null!==(M=E(O,{isInHorizontalRo:!I}))&&void 0!==M?M:null===(k=Ki(_,"paintInterceptor"))||void 0===k?void 0:k(O);if(x&&x>1)return x;I&&Oo(_)&&(r=_),ta(O,h)}return 1}),{relativeTo:d,origin:f}),De(_)&&(o.globalAlpha=_)};b.length;)C();_&&ra(),xi(o),o.globalAlpha!==u&&(o.globalAlpha=u)}function ta(e,t){var n=e.renderObject,r=e.painter,i=e.rect,o=e.area,a=e.asRoot;!function(e,t){var n=hn(t).opacity;if(De(n)&&n<1){var r=n<=0?.001:n;e.globalAlpha*=r,qo.set(t,(function(){e.globalAlpha/=r}))}}(r,n),null==t||t.trigger("iwillpaintro",[e]);var s=Ki(n,"willPaint");null==s||s(e),$o(r,n,i,o,a)}function na(e,t){var n=e.renderObject,r=e.painter,i=Ki(n,"didPaint");null==i||i(e),null==t||t.trigger("ididpaintro",[e]),function(e){var t=qo.get(e);t&&(t(),qo.delete(e))}(n),Jo(r,n)}function ra(){jn.flush(1,"backgroundColor"),jn.flush(7),jn.flush(1,"selection"),jn.flush(2),jn.flush(3),jn.flush(6),jn.flush(4)}var ia=new Set(It),oa=new Set(Zt);function aa(e,t,n,r,i){var o;o=e,Array.isArray(o)||(e=[e]);for(var a=0;a<e.length;a++)sa(e[a],t,n,r,i)}function sa(e,t,n,r,i){var o,a=hn(t).zoom;n&&e in n?o=n[e]:i&&e in i&&(o=i[e]);var s=Sn(r,null==i?void 0:i.fontSize),u=o;if(oa.has(e)){if(!De(u=Tn(o,s,a)))return void cn(t,e);ia.has(e)&&(u=Math.min(u,r/2),Le(o)&&o.endsWith("%")||(u=Math.min(u,Math.min(t.width,t.height)/2)))}sn(t,e,u)}function ua(e,t){var n,r;return{x:e.x-t.left+(null!==(n=t.scrollLeft)&&void 0!==n?n:0),y:e.y-t.top+(null!==(r=t.scrollTop)&&void 0!==r?r:0)}}function la(e,t){var n,r;return{x:e.x+t.left-(null!==(n=t.scrollLeft)&&void 0!==n?n:0),y:e.y+t.top-(null!==(r=t.scrollTop)&&void 0!==r?r:0)}}var ca=Bn((function(e,t){var n=Xt(e,t);return n.pop(),n.reduce((function(e,t){return la(e,t)}),{x:0,y:0})}),["mutate","layout"]);function ha(e,t,n){var r=ca(t,n),i=r.x,o=r.y;return{x:e.x+i,y:e.y+o}}function da(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Ve(t,Wi());return n.left=e.x,n.top=e.y,n.width=e.width,n.height=e.height,n}function fa(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Wi(),r=t.bTLRH,i=void 0===r?0:r,o=t.bTLRV,a=void 0===o?0:o,s=t.bTRRH,u=void 0===s?0:s,l=t.bTRRV,c=void 0===l?0:l,h=t.bBLRH,d=void 0===h?0:h,f=t.bBLRV,p=void 0===f?0:f,v=t.bBRRH,g=void 0===v?0:v,_=t.bBRRV,y=void 0===_?0:_,m=Math.max(i,d),E=Math.max(u,g),b=Math.max(a,c),T=Math.max(p,y);return n.left=e.left+m,n.width=e.width-m-E,n.top=e.top+b,n.height=e.height-b-T,n}function pa(e){var t,n,r=e.top,i=e.height;"lineOffsetTop"in e&&"lineOuterHeight"in e&&(r=null!==(t=e.lineOffsetTop)&&void 0!==t?t:r,i=null!==(n=e.lineOuterHeight)&&void 0!==n?n:i);return{top:r,height:i}}function va(e,t){var n=pa(e),r=n.top,i=n.height,o=hn(e),a=o.leadingTop,s=void 0===a?0:a,u=o.leadingBottom,l=void 0===u?0:u,c=t.x,h=t.y,d=e.left,f=e.width;return h<r-s?"left":h>=r+i+l?"right":c<d?"left":c>=d+f?"right":"found"}function ga(e,t){var n=t.x,r=e.left,i=e.width;return n<r?"left":n>=r+i?"right":"found"}function _a(e,t){var n=t.y,r=e.top,i=e.height;return n<r?"left":n>=r+i?"right":"found"}function ya(e){return function(t,n){return function(e,t,n){var r,i=e.children;if(null===(r=i)||void 0===r||!r.length)return null;var o=io(i=i.filter(ko),(function(e){return n(e,t)}));if(o>=i.length)return null;var a=i[o];if(Ui(t,a))return a;return null}(t,n,e)}}He.InlineFlow,He.BlockFlow,He.FlexRow,He.FlexColumn,He.SuperList;var ma={InlineFlow:ya(va),BlockFlow:ya(_a),FlexRow:ya(ga),FlexColumn:ya(_a),SuperList:ya(_a)};function Ea(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=ba;return bo(e,He.TableRow)?r=Ta:bo(e,He.InlineFlow)&&e.hasRTL?r=ba:n&&e.type in ma&&(r=ma[e.type]),r(e,t)}function ba(e,t){var n,r=e.children;if(null===(n=r)||void 0===n||!n.length)return null;for(var i=(r=r.filter(ko)).length-1;i>=0;i--){var o=r[i];if(Ui(t,o)&&Vo(o))return o}return null}function Ta(e,t){if(!Vo(e))return null;var n=e.parent.children,r=e.runtime.context.tpu,i=null==r?void 0:r.getRelatedCellsByRowIndex(null==r?void 0:r.getRowIndex(e));if(null!=i&&i.length)for(var o=la(t,e),a=0;a<i.length;a++){var s=(0,c.Z)(i[a],2),u=s[0],l=s[1],h=n[u],d=ua(o,h),f=h.children[l];if(Ui(d,f)&&ko(f))return t.y=d.y,f}return ba(e,t)}var Ca=Object.defineProperty,Sa=function(e){return!!hn(e).overflowScrollX||bo(e,He.HalfFullscreen)};function wa(e,t,n,r){var i=hn(e).zoom,o=void 0===i?1:i,a=t.width;if(void 0===a){var s,u=e.parent;if(u&&(Ut.has(u.type)||Sa(u)||bo(u,He.BlockFlow)&&"auto"===u.style.width))a="auto";else a=null!==(s=Ht.width[e.type])&&void 0!==s?s:"auto"}if("auto"!==a){var l=Tn(a,Sn(n,null==r?void 0:r.fontSize),o);sn(e,"width",De(l)?l:"auto")}else sn(e,"width","auto")}function Ra(e,t,n,r){var i,o,a=hn(e).zoom,s=void 0===a?1:a,u=t.height;if("auto"!==(u=null!==(i=null!==(o=u)&&void 0!==o?o:Ht.height[e.type])&&void 0!==i?i:"auto")){var l=Tn(u,Sn(n,null==r?void 0:r.fontSize),s);sn(e,"height",De(l)?l:"auto")}else sn(e,"height","auto")}function Aa(e,t){var n=t.opacity;De(n)&&(n=n>1?1:n<0?0:n),sn(e,"opacity",n)}var Oa=function(e,t,n){var r,i,o=t.baselineOffset;if(o){var a=null==n?void 0:n.fontSize,s=hn(e),u=s.zoom,l=void 0===u?1:u,c=null!==(r=null!==(i=s.fontSize)&&void 0!==i?i:a)&&void 0!==r?r:Ae;sn(e,"baselineOffset",Tn(o,Sn(c,c),l))}},Ma={buildContext:function(e){return Ti(e)},createChildConstraint:function(e,t){var n=t.runtime;Mn(n,Si(e)),Mn(n,fi(e)||!1===e.props.lineWrap?jt:{})},wrapup:function(e,t){var n,r,i,o,a=t.maxWidth,s=t.minWidth,u=t.maxHeight,l=t.minHeight,c=t.isWeakWidth,h=yi(e),d=h.paddingLeft,f=h.paddingRight,p=h.paddingTop,v=h.paddingBottom,g=h.borderTop,_=h.borderLeft,y=h.borderBottom,m=h.borderRight,E=d+_,b=p+g,T=Oi(e,E,b),C=E+f+m+T[0],S=b+v+y+T[1],w=hn(e);(tn(e,{width:Ei(null!==(n=w.width)&&void 0!==n?n:"auto",C,s,a,c),height:Ei(null!==(r=w.height)&&void 0!==r?r:"auto",S,l,u)}),Sa(e))&&tn(e,{scrollLeft:null!==(i=e.scrollLeft)&&void 0!==i?i:0,scrollWidth:C});(function(e){return!!hn(e).overflowScrollY})(e)&&tn(e,{scrollTop:null!==(o=e.scrollTop)&&void 0!==o?o:0,scrollHeight:S});Na(e,Ve({},Rn(e)))}},ka=Object.assign({computeStyle:function(e,t){var n,r,i=Ve({},Rn(e));r=go(n=i),vo(n,"margin",r),vo(n,"padding",r),po(n,"border",r),po(n,"outline",r);var o=Ri(t),s=o.maxWidth,u=o.maxHeight,l=o.inheritedStyle;aa("zoom",e,i,void 0,l),wa(e,i,s,l),aa(["minWidth","maxWidth"],e,i,s,l),Ra(e,i,u,l),aa(["minHeight","maxHeight"],e,i,u,l),aa("display",e,i),function(e,t,n,r,i){var o=t.transform;if(o){var a=o.rotate,s=o.origin;if(a&&"number"==typeof a)if(void 0!==(null==s?void 0:s.x)&&void 0!==(null==s?void 0:s.y)){var u=hn(e).zoom,l=void 0===u?1:u,c=Sn(r,null==i?void 0:i.fontSize),h=Sn(n,null==i?void 0:i.fontSize);sn(e,"transform",{rotate:a,origin:{x:Tn(s.x,h,l),y:Tn(s.y,c,l)}})}else sn(e,"transform",{rotate:a,origin:void 0});else sn(e,"transform",void 0)}}(e,i,s,u,l),aa(["borderLeftWidth","borderRightWidth","outlineLeftWidth","outlineRightWidth"].concat((0,a.Z)(nt),(0,a.Z)(et),["outlineOffset"]),e,i,s,l),aa(["borderTopWidth","borderBottomWidth","outlineTopWidth","outlineBottomWidth"],e,i,u),aa(["backgroundColor","cursor","overflowScrollX","overflowScrollY"].concat((0,a.Z)(Tt),(0,a.Z)(Et),(0,a.Z)(ct),(0,a.Z)(ut)),e,i),Aa(e,i),Oa(e,i,l)}},Ma),Ia=kt.map((function(e){return"".concat(e,"H")})),xa=kt.map((function(e){return"".concat(e,"V")}));function Na(e,t){ho(t),aa(Ia,e,t,e.width),aa(xa,e,t,e.height)}var Pa=.5*Math.PI,La=.25*Math.PI,Da={TOP:0,RIGHT:1,BOTTOM:2,LEFT:3},Fa=[[1,1],[-1,1],[-1,-1],[1,-1]],Ba=function(e){return Math.sin(e)},Va=function(e){return Math.cos(e)},Ha={TOP:[Ba,Va],RIGHT:[Va,Ba],BOTTOM:[Ba,Va],LEFT:[Va,Ba]};function Ua(e){return Fa[e%Fa.length]}function Za(e,t,n){var r=e.rect,i=r.left,o=r.top,s=e.renderObject,u=e.boxMetrics,l=e.painter,h=hn(s),d="outline"===t,f=h["".concat((d?Bi:Di)[n],"Width")];if(De(f)&&!(f<=0)){var p,v,g,_,y,m,E,b,T=s.height,C=s.width;if(d)p=[null!==(g=h.outlineTopWidth)&&void 0!==g?g:0,null!==(_=h.outlineRightWidth)&&void 0!==_?_:0,null!==(y=h.outlineBottomWidth)&&void 0!==y?y:0,null!==(m=h.outlineLeftWidth)&&void 0!==m?m:0],v=p.map((function(e){var t;return e?e+(null!==(t=h.outlineOffset)&&void 0!==t?t:0):e}));else p=[u.borderTop,u.borderRight,u.borderBottom,u.borderLeft];switch(n){case"TOP":E=[[i,o],[i+C,o]],v&&(E[0][0]-=v[3],E[0][1]-=v[0],E[1][0]+=v[1],E[1][1]-=v[0]);break;case"RIGHT":E=[[i+C,o],[i+C,o+T]],v&&(E[0][0]+=v[1],E[0][1]-=v[0],E[1][0]+=v[1],E[1][1]+=v[2]);break;case"BOTTOM":E=[[i+C,o+T],[i,o+T]],v&&(E[0][0]+=v[1],E[0][1]+=v[2],E[1][0]-=v[3],E[1][1]+=v[2]);break;case"LEFT":E=[[i,o+T],[i,o]],v&&(E[0][0]-=v[3],E[0][1]+=v[2],E[1][0]-=v[3],E[1][1]-=v[0])}if(d){var S=function(e,t){return e>0?e+v[t]:e},w=h.bTLRH,R=void 0===w?0:w,A=h.bTLRV,O=void 0===A?R:A,M=h.bTRRH,k=void 0===M?0:M,I=h.bTRRV,x=void 0===I?k:I,N=h.bBRRH,P=void 0===N?0:N,L=h.bBRRV,D=void 0===L?P:L,F=h.bBLRH,B=void 0===F?0:F,V=h.bBLRV,H=void 0===V?B:V;b={bTLRH:S(R,3),bTLRV:S(O,0),bTRRH:S(k,1),bTRRV:S(x,0),bBRRH:S(P,1),bBRRV:S(D,2),bBLRH:S(B,3),bBLRV:S(H,2)}}else b=h;var U=function(e){var t,n,r,i,o,s=e.path,u=e.side,l=e.widths,h=e.radius,d=(0,c.Z)(l,4),f=d[0],p=d[1],v=d[2],g=d[3],_=h.bTLRH,y=void 0===_?0:_,m=h.bTLRV,E=void 0===m?y:m,b=h.bTRRH,T=void 0===b?0:b,C=h.bTRRV,S=void 0===C?T:C,w=h.bBRRH,R=void 0===w?0:w,A=h.bBRRV,O=void 0===A?R:A,M=h.bBLRH,k=void 0===M?0:M,I=h.bBLRV,x=void 0===I?k:I,N=(0,c.Z)(s,2),P=N[0],L=N[1],D=Da[u],F=Ua(D),B=Ua(D+1),V=Ha[u],H=0,U=[La,La];switch(u){case"TOP":t=[g,f],n=[p,f],r=[y,E],i=[T,S],H=1.5*Math.PI,!g&&(U[0]=Pa),!p&&(U[1]=Pa),o=[0,1];break;case"RIGHT":t=[p,f],n=[p,v],r=[T,S],i=[R,O],H=0,!f&&(U[0]=Pa),!v&&(U[1]=Pa),o=[1,0];break;case"BOTTOM":t=[p,v],n=[g,v],r=[R,O],i=[k,x],H=.5*Math.PI,!p&&(U[0]=Pa),!g&&(U[1]=Pa),o=[0,1];break;case"LEFT":t=[g,v],n=[g,f],r=[k,x],i=[y,E],H=Math.PI,!v&&(U[0]=Pa),!f&&(U[1]=Pa),o=[1,0]}var Z=i.map((function(e,t){return Math.max(0,e-n[t])})),W=r.map((function(e,n){return Math.max(0,e-t[n])}));Z.includes(0)&&(Z=[0,0]),W.includes(0)&&(W=[0,0]);var j=F.map((function(e,t){return P[t]+e*r[t]})),G=B.map((function(e,t){return L[t]+e*i[t]})),z=B.map((function(e,t){return L[t]+e*(Z[t]+n[t])})),Y=F.map((function(e,n){return P[n]+e*(W[n]+t[n])})),X=[],K=[],q=F.map((function(e,t){return j[t]-e*V[t](U[0])*r[t]})),$=B.map((function(e,t){return G[t]-e*o[t]*i[t]})),J=B.map((function(e,t){return z[t]-e*V[t](U[1])*Z[t]})),Q=F.map((function(e,t){return Y[t]-e*o[t]*W[t]}));return r.includes(0)||X.push(["ellipse",[].concat((0,a.Z)(j),(0,a.Z)(r),[0,H-U[0],H,!1])]),X.push(["lineTo",(0,a.Z)($)]),i.includes(0)||X.push(["ellipse",[].concat((0,a.Z)(G),(0,a.Z)(i),[0,H,H+U[1],!1])]),Z.includes(0)||K.push(["ellipse",[].concat((0,a.Z)(z),(0,a.Z)(Z),[0,H+U[1],H,!0])]),K.push(["lineTo",(0,a.Z)(Q)]),W.includes(0)||K.push(["ellipse",[].concat((0,a.Z)(Y),(0,a.Z)(W),[0,H,H-U[0],!0])]),{pA:q,pE:J,outerPath:X,innerPath:K}}({path:E,side:n,widths:p,radius:b}),Z=Ve({type:7,fill:h[(d?Fi:Li)[n]]||xe,path:E,painter:l},U);jn.push(Z),jn.flush(7)}}var Wa=";",ja="_",Ga=function(){function e(){(0,h.Z)(this,e),this.cmds={}}return(0,d.Z)(e,[{key:"onPush",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ja,n=this.cmds[t];n||(this.cmds[t]=n=new Map);var r=e.fill,i=void 0===r?"":r,o=e.stroke,a=void 0===o?"":o,s=e.lineWidth,u=void 0===s?0:s,l=e.opacity,c="".concat(i).concat(Wa).concat(a).concat(Wa).concat(u).concat(Wa).concat(l),h=n.get(c);if(!h)return n.set(c,h=[]),void h.push(e);var d=e.left,f=e.top,p=e.width,v=e.height,g=io(h,(function(e){var t=e.left,n=e.top;return f<n||f===n&&d<t?"left":f>n||f===n&&d>t?"right":"found"})),_=h[Math.max(0,g-1)];_&&((f===_.top&&v===_.height||d===_.left&&p===_.width)&&ji(_,e)||Gi(_,e)||Gi(e,_))?Ve(_,zi([_,e])):h.splice(g,0,e)}},{key:"onFlush",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ja,n=this.cmds[t];if(n){var r=e.fillType,i=e.strokeType;e.strokeType=1,e.fillType="backgroundColor"===t?0:2,n.forEach((function(t,n){var r=n.split(Wa),i=(0,c.Z)(r,4),o=i[0],a=i[1],s=i[2],u=i[3];eo(e,{fill:o,stroke:a,lineWidth:+s,opacity:+u});var l,h=be(t);try{for(h.s();!(l=h.n()).done;){var d=l.value;Qi(e,d)}}catch(e){h.e(e)}finally{h.f()}})),n.clear(),e.fillType=r,e.strokeType=i}}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ja;delete this.cmds[e]}},{key:"clearAll",value:function(){this.cmds={}}}],[{key:"type",get:function(){return 1}}]),e}();function za(e,t){e.lineWidth=t.lineWidth,e.strokeStyle=t.stroke,e.globalAlpha=t.opacity}function Ya(e,t){var n,r=be(t);try{for(r.s();!(n=r.n()).done;){var i,o=(0,c.Z)(n.value,2),s=o[0],u=o[1];null===(i=e[s])||void 0===i||i.call.apply(i,[e].concat((0,a.Z)(u)))}}catch(e){r.e(e)}finally{r.f()}}var Xa={willPaint:function(e){var t,n,r,i,o,a,s,u,l=e.painter,c=e.renderObject,h=e.rect,d=c.width,f=c.height;if(0!==c.width&&0!==c.height){var p=h.left,v=h.top;qi(l,c,h),null===(t=l.setKeepSaveNum)||void 0===t||t.call(l);var g={painter:l,rect:h,renderObject:c,boxMetrics:_i(c)};!function(e){var t=e.rect,n=t.top,r=t.left,i=e.renderObject,o=e.boxMetrics,a=e.painter,s=hn(i);if(s.backgroundColor){var u=o.borderTop,l=o.borderRight,c=o.borderBottom,h=o.borderLeft,d=o.paddingTop,f=o.paddingRight,p=o.paddingBottom,v=o.paddingLeft,g=o.contentWidth,_=o.contentHeight;if(g+v+f!==0&&_+d+p!==0){var y=r+h,m=r+h+g+v+f-y,E=n+u,b=n+u+_+d+p-E,T={type:1,left:y,top:E,width:m,height:b,fill:s.backgroundColor,opacity:a.globalAlpha,radius:no(y,E,m,b,Ve({borderTopWidth:u,borderRightWidth:l,borderBottomWidth:c,borderLeftWidth:h},s))};jn.push(T,"backgroundColor"),jn.flush(1,"backgroundColor")}}}(g),["border","outline"].forEach((function(e){["TOP","RIGHT","BOTTOM","LEFT"].forEach((function(t){Za(g,e,t)}))})),null===(n=(r=c.props).draw)||void 0===n||n.call(r,{ctx:l,fontColor:null!==(i=c.style.fontColor)&&void 0!==i?i:null===(o=c.runtime)||void 0===o||null===(a=o.context)||void 0===a||null===(s=a.inheritedStyle)||void 0===s?void 0:s.fontColor,left:p,top:v,width:d,height:f}),null===(u=l.restoreIfNeed)||void 0===u||u.call(l)}},didPaint:function(e){var t=e.painter,n=e.renderObject;0!==n.width&&0!==n.height&&$i(t,n)},commandPlugins:[Ga,function(){function e(){(0,h.Z)(this,e)}return(0,d.Z)(e,[{key:"onPush",value:function(e){!function(e){var t=e.pA,n=e.pE,r=e.outerPath,i=e.innerPath,o=e.fill,s=e.painter;s.beginPath(),s.moveTo.apply(s,(0,a.Z)(t)),Ya(s,r),s.lineTo.apply(s,(0,a.Z)(n)),Ya(s,i),s.closePath();var u=s.fillType;s.fillType=1,s.fillStyle=o,s.fill(),s.fillType=u}(e)}}],[{key:"type",get:function(){return 7}}]),e}()]},Ka={wrapup:function(e,t,n){var r=t.isWeakWidth,i=e.runtime.constraint,o=i.maxWidth,a=void 0===o?1/0:o,s=i.maxHeight,u=void 0===s?1/0:s,l=i.minWidth,c=void 0===l?0:l,h=i.minHeight,d=void 0===h?0:h,f=dn(e),p=hn(e).zoom,v=n.measureTextWithZoom(e.props.content,f,p).width,g=dn(e),_=g.fontFamily,y=g.fontSize,m=n.measureFont(_,y),E=m.fontHeight,b=m.fontAscent;en(e,"textWidth",v),en(e,"textHeight",E),en(e,"baseline",b),en(e,"width",r?v:Math.max(c,Math.min(v,a))),en(e,"height",Math.max(d,Math.min(E,u)))},computeStyle:function(e,t){var n=t.inheritedStyle,r=Rn(e);aa(["zoom","fontFamily","fontColor","fontStyle","fontWeight","underline","lineThrough","cursor"],e,r,void 0,Ve({fontSize:Ae,fontFamily:Re},n)),aa("display",e,r),vn(e,r,n),Aa(e,r),Oa(e,r,n)},buildContext:function(e){bi(e)}};function qa(e,t){for(var n=Xt(e,t),r=Math.max(0,n.length-(wo(t)?2:1)),i=n[r],o=pa(i),a=o.top,s=o.height,u=ha({x:0,y:0},e,i).y+i.top-a,l=s-e.height-u,c=0,h=0,d=[],f=3,p=0;p<r;p++){var v=n[p],g=v.parent,_=g.children.filter(Mo);if(v!==_[0]&&(f&=-2),v!==Fe(_)&&(f&=-3),0===f)break;mi(g.type)&&d.push({ro:g,position:f})}for(var y=e,m=0,E=0,b=0,T=d;b<T.length;b++){var C=T[b],S=C.ro,w=C.position;1&w&&(c-=m),2&w&&(h-=E);var R=ha({x:0,y:0},y,S).x,A=hn(S),O=A.marginLeft;m=void 0===O?0:O;var M=A.marginRight;E=void 0===M?0:M,1&w&&(c+=R+m),2&w&&(h+=S.width-y.width-R+E),y=S}return{outerTop:u,outerBottom:l,outerLeft:c,outerRight:h,marginLeft:m,marginRight:E}}function $a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e.charCodeAt(t);return n>1536&&n<1632||n>1641&&n<1791||n>1872&&n<1919||n>2160&&n<2207||n>2208&&n<2303||n>64336&&n<65023||n>65136&&n<65279}function Ja(e){return e.ligatureStatus?Qa(e.props.content,e.ligatureStatus):e.props.content}function Qa(e,t){return 1&t&&(e="‮‍"+e),2&t&&(e+="‍‏‬"),e}function es(e,t,n,r){var i,o,a=e.props.content;if("rtl"!==e.dir)return a.slice(t,n);n=null!==(i=n)&&void 0!==i?i:a.length;var s=null!==(o=e.ligatureStatus)&&void 0!==o?o:0,u=0;return" "!==a[t-1]&&"start"!==r&&(u|=1)," "!==a[n]&&"end"!==r&&(u|=2),0===t&&(u&=-2|s),n>=a.length&&(u&=-3|s),Qa(a.slice(t,n),u)}function ts(e,t,n){var r,i=e.renderObject,o=e.painter,a=e.rect,s=a.top,u=a.left,l=e.colorConverter,h=hn(i);if(h[n]){var d,f=i.width,p=i.baseline,v=i.height,g=dn(i),_=g.fontFamily,y=g.fontSize,m=g.fontColor,E=o.measureFont(_,y),b=E.xHeight,T=E.emDescent,C=l?l(m):m,S=Math.max(1*(null!==(r=h.zoom)&&void 0!==r?r:1),y/Ae);switch(n){case"underline":d=s+p+T,d=Math.min(d,s+v-S);break;case"lineThrough":d=s+p-b/2-y/Ae}if(void 0!==d){var w={left:u,top:d,width:f,height:S},R=t?Yi([w,t]):w;if(R.height&&R.width){var A=R.left,O=R.top;!function(e,t){var n,r,i=t.lineWidth,o=t.strokeStyle,a=t.renderObject,s=t.path,u=t.opacity,l=(0,c.Z)(s,2),h=(0,c.Z)(l[0],2),d=h[0],f=h[1],p=(0,c.Z)(l[1],2),v=p[0],g=p[1],_=null===(n=Ni(e,a))||void 0===n?void 0:n[0],y=[[0,f],[0,g]];y[0][0]=Math.max(d,null!==(r=null==_?void 0:_.x)&&void 0!==r?r:0),y[1][0]=Math.min(v,_?_.x+_.width:1/0),y[0][0]>=y[1][0]||jn.push({lineWidth:i,stroke:o,path:y,type:2,opacity:u})}(o,{renderObject:i,lineWidth:R.height,strokeStyle:C,path:[[A,O],[A+R.width,O]],opacity:o.globalAlpha})}}}}function ns(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t.clip&&jn.push(t.clip),r&&rs(e,t);var i=null!==(n=t.zoom)&&void 0!==n?n:1;e.scale(i,i),e.fillText(t.text,t.x,t.y,t.maxWidth),e.scale(1/i,1/i),t.clip&&jn.push({type:5,painter:t.clip.painter,subType:"restore"})}function rs(e,t){var n;e.textBaseline=null!==(n=t.textBaseline)&&void 0!==n?n:Oe,e.font=t.font,e.fillStyle=t.color,e.globalAlpha=t.opacity}var is=function(){function e(){(0,h.Z)(this,e),this.cmds={}}return(0,d.Z)(e,[{key:"onPush",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ja,i=this.cmds[r];i||(this.cmds[r]=i=new Map),e.textBaseline=null!==(t=e.textBaseline)&&void 0!==t?t:Oe;var o=e.font,a=e.color,s=e.textBaseline,u=void 0===s?"":s,l=e.opacity,c=e.zoom,h="".concat(o).concat(Wa).concat(a).concat(Wa).concat(u).concat(Wa).concat(l).concat(Wa).concat(null!==(n=c)&&void 0!==n?n:1),d=i.get(h);d||i.set(h,d=[]),d.push(e)}},{key:"onFlush",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ja,n=e.fillType;e.fillType=2;var r=this.cmds[t];null==r||r.forEach((function(t,n){var r=n.split(Wa),i=(0,c.Z)(r,5),o=i[0],a=i[1],s=i[2],u=i[3],l=i[4];rs(e,{font:o,color:a,textBaseline:s,opacity:+u,zoom:+l});var h,d=be(t);try{for(d.s();!(h=d.n()).done;){var f=h.value;ns(e,f)}}catch(e){d.e(e)}finally{d.f()}})),null==r||r.clear(),e.fillType=n}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ja;delete this.cmds[e]}},{key:"clearAll",value:function(){this.cmds={}}}],[{key:"type",get:function(){return 3}}]),e}(),os=function(){function e(){(0,h.Z)(this,e),this.cmds={}}return(0,d.Z)(e,[{key:"onPush",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ja,n=e.lineWidth,r=e.stroke,i=e.path,o=e.opacity;if(2===i.length){var a=this.cmds[t];a||(this.cmds[t]=a=new Map);var s="".concat(n).concat(Wa).concat(r).concat(Wa).concat(o),u=a.get(s);u||a.set(s,u=[]),u.push(e)}}},{key:"onFlush",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ja,n=this.cmds[t];if(n){var r=e.strokeType;e.strokeType=2;var i=function(e,t,n,r){if(e!==t){var i=e<t?[e,t]:[t,e];if(r.has(n)){var o=r.get(n),a=Math.min(o[0],i[0]),s=Math.max(o[1],i[1]);return s-a<=o[1]-o[0]+i[1]-i[0]?(o[0]=a,void(o[1]=s)):(r.set(n,i),o)}r.set(n,i)}},o=function(t,n,r,i){e.moveTo(t,n),e.lineTo(r,i)};n.forEach((function(t,n){e.beginPath();var r=n.split(Wa),a=(0,c.Z)(r,3),s=a[0],u=a[1],l=a[2];za(e,{lineWidth:+s,stroke:u,opacity:+l});var h,d=new Map,f=new Map,p=be(t);try{for(p.s();!(h=p.n()).done;){var v=h.value,g=(0,c.Z)(v.path,2),_=(0,c.Z)(g[0],2),y=_[0],m=_[1],E=(0,c.Z)(g[1],2),b=E[0],T=E[1];if(m===T){var C=i(y,b,m,f);C&&o(C[0],m,C[1],m)}else if(y===b){var S=i(m,T,y,d);S&&o(y,S[0],y,S[1])}else o(y,m,b,T)}}catch(e){p.e(e)}finally{p.f()}d.forEach((function(e,t){return o(t,e[0],t,e[1])})),f.forEach((function(e,t){return o(e[0],t,e[1],t)})),e.stroke()})),n.clear(),e.strokeType=r}}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ja;delete this.cmds[e]}},{key:"clearAll",value:function(){this.cmds={}}}],[{key:"type",get:function(){return 2}}]),e}(),as=function(e){var t,n=e.rect,r=e.renderObject,i=e.painter,o={colorConverter:e.colorConverter,painter:i,rect:n,originRect:n,renderObject:r};if(jn.has(5)){var a=Ni(i,r),s=Ji((0,c.Z)(a,1)[0],_i(r),n);t={left:s.x,top:s.y,width:s.width,height:s.height}}if(n.height<r.textHeight){var u=Ve({},n),l=r.textHeight-u.height;u.top-=l/2,o.rect=u}!function(e,t){var n,r=e.painter,i=e.renderObject,o=e.rect,a=e.colorConverter,s=i.props,u=i.textWidth,l=i.baseline,h=null!==(n=hn(i).zoom)&&void 0!==n?n:1,d=s.content;if(d){i.ligatureStatus&&(d=Ja(i)),"rtl"===i.dir&&(d="‮"+d+"‏");var f=dn(i);f.fontSize=f.fontSize/h;var p=o.left,v=o.top,g=o.height,_={type:3,font:Zo(f),color:a?a(f.fontColor):f.fontColor,text:d,x:p/h,y:(v+l)/h,opacity:r.globalAlpha,zoom:h};if(t){var y=t.left,m=t.top,E=t.width,b=t.height;if(p<y||v<m||p+u>y+E||v+g>m+b){var T=zo(r,o,{left:y,top:m,width:E,height:b},d,f,h);_.clip={type:5,subType:"clip",rect:T,renderObject:i,painter:r,needSetPaintArea:!1};var C=Ni(r,i),S=(0,c.Z)(C,2),w=S[0],R=S[1],A=w.style;if(A&&fn(A)){var O=Wi();if(da(w,O),fa(O,A,O),!Gi(O,T)){var M,k,I=null!==(M=null==R?void 0:R.width)&&void 0!==M?M:w.width,x=null!==(k=null==R?void 0:R.height)&&void 0!==k?k:w.height;_.clip.radius=no(w.x,w.y,I,x,A)}}}}jn.push(_)}}(o,t),ts(o,t,"underline"),ts(o,t,"lineThrough")},ss={didPaint:as,commandPlugins:[is,os]},us=[.5,.75,.85,1,1.15,1.25,1.5,1.75,2,2.5,3];function ls(){if(Yt){var e=window.top;try{e.innerWidth}catch(t){e=window}Math.min(hs(us,e.outerWidth/e.innerWidth),hs(us,(e.outerHeight-52)/e.innerHeight))||1}else 1}function cs(e,t){return Math.abs(e-t)<.01}function hs(e,t){var n=function(e,t){var n=0,r=e.length,i=!1;for(;n<r;){var o=n+(r-n>>>1);t>e[o]?n=o+1:(r=o,i=cs(t,e[o]))}return i?n:-n-1}(e,t);return n<0&&(n=-n-1)>0&&t-e[n-1]<e[n]-t&&--n,e[n]||e[e.length-1]}function ds(e){var t,n=e.node,r=e.offset,i=Math.max(1,ao(n,1/0));return t=i===1/0&&n.parent?{node:n.parent,offset:Jt(n)+(r?1:0)}:{node:n,offset:Math.max(0,Math.min(i,r))},Ve({},e,t)}function fs(e){return{value:e,prev:null,next:null}}function ps(e){return 0===e.type}ls();var vs=function(){function e(){(0,h.Z)(this,e),this.chainStartNode=void 0,this.chainEndNode=void 0,this.chainMap=void 0,this.cacheChainToArray=null,this.type=0,this.init()}return(0,d.Z)(e,[{key:"init",value:function(){this.chainStartNode=fs(null),this.chainEndNode=fs(null),this.chainStartNode.next=this.chainEndNode,this.chainEndNode.prev=this.chainStartNode,this.chainMap=new Map,this.cacheChainToArray=null}},{key:"reset",value:function(){this.init()}},{key:"insertAfter",value:function(t,n){var r;if(bo(n)){if(!(r=this.chainMap.get(n)))return}else r=n;var i=e.createTextFragmentNode(t),o=r,a=i,s=r.next;o.next=a,a.prev=o,a.next=s,s.prev=a,this.chainMap.set(t,i),this.cacheChainToArray=null}},{key:"push",value:function(e){if(!this.chainMap.get(e)){var t=this.chainEndNode.prev;this.insertAfter(e,t)}}},{key:"remove",value:function(e){var t=this.chainMap.get(e);if(t){var n=t.prev,r=t.next;n.next=r,r.prev=n,this.chainMap.delete(e),this.cacheChainToArray=null}}},{key:"cutTextFragment",value:function(t){var n=this.chunks.indexOf(t),r=this.chunks.slice(0,n+1),i=this.chunks.slice(n+1);this.reset();for(var o=0;o<r.length;o++)this.push(r[o]);for(var a=e.createTextFragment(),s=0;s<i.length;s++)a.push(i[s]);return[this,a]}},{key:"concatTextFragment",value:function(e){for(var t=e.chunks,n=0;n<t.length;n++)this.push(t[n])}},{key:"head",get:function(){return this.chainStartNode}},{key:"tail",get:function(){return this.chainEndNode}},{key:"chunks",get:function(){if(this.cacheChainToArray)return this.cacheChainToArray;var t=e.transformChainToArray(this.chainStartNode);return t=t.slice(1,t.length-1),this.cacheChainToArray=t,t}}],[{key:"createTextFragmentNode",value:function(e){return fs(e)}},{key:"transformChainToArray",value:function(e){for(var t=[],n=e;n;)t.push(n.value),n=n.next;return t}},{key:"createTextFragment",value:function(){return new e}}]),e}(),gs=function(){function e(t){var n=t.inlineFlow;(0,h.Z)(this,e),this.inlineFlow=void 0,this.data=[],this.renderObjectToFragmentMap=new Map,this.cachePlainFragments=[],this.inlineFlow=n}return(0,d.Z)(e,[{key:"compute",value:function(){for(var e=0;e<this.length;e++){var t=this.data[e];if(ps(t))for(var n=0;n<t.chunks.length;n++){var r=t.chunks[n];pi(r)}}}},{key:"findPreviousFragmentByRenderTree",value:function(e){for(var t=[e];t.length;){var n=t.length>1?"down":"up",r=t.pop();if(r===this.inlineFlow)return{type:1,data:null};if(this.hasFragmentByRenderObject(r)&&r!==e)return{type:0,data:r};var i,o=Jt(r),a=r.parent;if("up"===n)t.push(a),Array.prototype.push.apply(t,a.children.slice(0,o));else Array.prototype.push.apply(t,null!==(i=r.children)&&void 0!==i?i:[])}return{type:2,data:null}}},{key:"add",value:function(t){if(null!==vi(t)&&!this.hasFragmentByRenderObject(t))if(this.length){var n=this.findPreviousFragmentByRenderTree(t);if(2!==n.type)if(1!==n.type)this.insertAfter(t,n.data);else{if(!Ro(t)){var r=e.createBlock({renderObject:t});return this.data.splice(0,0,r),void this.renderObjectToFragmentMap.set(t,r)}if(ps(this.firstFragment))this.firstFragment.insertAfter(t,this.firstFragment.head),this.renderObjectToFragmentMap.set(t,this.firstFragment);else{var i=e.createTextFragment();i.push(t),this.data.splice(0,0,i),this.renderObjectToFragmentMap.set(t,i)}}}else this.push(t)}},{key:"push",value:function(t){var n=vi(t);if(null!==n)if(0===n){var r=this.getFragmentByRenderObject(t);r||(this.lastFragment&&ps(this.lastFragment)||this.data.push(e.createTextFragment()),r=this.lastFragment),r.push(t),this.renderObjectToFragmentMap.set(t,r)}else{var i=e.createBlock({renderObject:t});this.data.push(i),this.renderObjectToFragmentMap.set(t,i)}}},{key:"update",value:function(e){this.inlineFlow.isDestructed||(this.remove(e),this.add(e))}},{key:"hasFragmentByRenderObject",value:function(e){return this.renderObjectToFragmentMap.has(e)}},{key:"getFragmentByRenderObject",value:function(e){return this.renderObjectToFragmentMap.get(e)}},{key:"insertAfter",value:function(t,n){var r=this.getFragmentByRenderObject(n);if(r)if(ps(r))if(Ro(t))r.insertAfter(t,n),this.renderObjectToFragmentMap.set(t,r);else{var i=e.createBlock({renderObject:t}),o=r.cutTextFragment(n),a=(0,c.Z)(o,2)[1],s=this.data.indexOf(r);this.data.splice(s+1,0,i,a),this.renderObjectToFragmentMap.set(t,i);for(var u=0;u<a.chunks.length;u++)this.renderObjectToFragmentMap.set(a.chunks[u],a)}else{var l=this.data.indexOf(r),h=l+1;if(h>=this.length)return void this.push(t);var d=this.data[h];if(Ro(t))if(ps(d))d.insertAfter(t,d.head),this.renderObjectToFragmentMap.set(t,d);else{var f=e.createTextFragment();f.push(t),this.data.splice(l+1,0,f),this.renderObjectToFragmentMap.set(t,f)}else{var p=e.createBlock({renderObject:t});this.data.splice(l+1,0,p),this.renderObjectToFragmentMap.set(t,p)}}else this.push(t)}},{key:"remove",value:function(e){var t=this.getFragmentByRenderObject(e);if(t){if(Ro(e)){var n=t;if(n.remove(e),0===n.chunks.length){var r=this.data.indexOf(n);this.data.splice(r,1)}}else{var i=this.data.indexOf(t);this.data.splice(i,1);var o=this.data[i-1],a=this.data[i];if(o&&a&&ps(o)&&ps(a)){this.concatTextFragment(o,a),this.data.splice(i,1);for(var s=0;s<a.chunks.length;s++)this.renderObjectToFragmentMap.set(a.chunks[s],o)}}this.renderObjectToFragmentMap.delete(e)}}},{key:"concatTextFragment",value:function(e,t){e.concatTextFragment(t)}},{key:"findInlineFlowChildByLeaf",value:function(e){for(var t=e;t;){var n;if(t.parent===this.inlineFlow)return t;t=null!==(n=t.parent)&&void 0!==n?n:null}return null}},{key:"length",get:function(){return this.data.length}},{key:"lastFragment",get:function(){return this.data[this.length-1]}},{key:"firstFragment",get:function(){return this.data[0]}},{key:"isFragmentValid",get:function(){return!this.inlineFlow.isDestructed}}],[{key:"createTextFragment",value:function(){return new vs}},{key:"createBlock",value:function(e){return{type:1,renderObject:e.renderObject}}}]),e}();function _s(e,t){if(!function(e){var t;if(0===e.offset)return!0;var n=e.node;if(Ro(n))return n.props.content.length===e.offset;return n.dir===Eu.NONE||(null===(t=n.children)||void 0===t?void 0:t.length)===e.offset}(e))return e;var n=function(e){var t=(n=e.node,null!==(r=null===(i=n.runtime)||void 0===i?void 0:i.fragments)&&void 0!==r?r:null===(o=n.runtime)||void 0===o||null===(a=o.constraint)||void 0===a?void 0:a.fragments);var n,r,i,o,a;if(t){var s=Object.assign({},e);if(t.inlineFlow.dir===Eu.NONE)for(var u=Es(t).indexOf(e.node),l=t.inlineFlow;l;){var c,h,d,f=null===(c=l)||void 0===c||null===(h=c.runtime)||void 0===h||null===(d=h.constraint)||void 0===d?void 0:d.fragments;if(null!=f&&f.inlineFlow.dir&&[Eu.LTR,Eu.RTL].includes(f.inlineFlow.dir)){t=f,s={node:l,offset:u};break}l=f?f.inlineFlow:l.parent}var p=Es(t);return p=p.filter((function(e){return e.dir})),{fragments:t,chunks:p,renderPoint:s}}}(e);if(n){var r=n.renderPoint,i=n.fragments.inlineFlow.dir,o=n.chunks,a=n.renderPoint.node;if(!function(e,t){if(t.dir===Eu.NONE)return e.dir===Eu.LTR;return e.dir===t.dir}(t,a)){var s=ms(n),u=s.index,l=s.isStartEdge,c=s.isEndEdge,h=Io(a);if(u<0||!l&&!c)return e;if(l)for(var d=u,f=o.length;d<f;d++){if(ys(i,o[d])){r.node=o[d],r.offset=0;break}var p,v;if(d===f-1)r.node=o[d],r.offset=null!==(p=null===(v=o[d].props.content)||void 0===v?void 0:v.length)&&void 0!==p?p:1/0}else if(c)for(var g=u;g>=0;g--){var _=Io(o[g]);if(ys(i,o[g])||(null==_?void 0:_.lineOffsetTop)!==(null==h?void 0:h.lineOffsetTop)){var y,m;r.node=o[g],r.offset=null!==(y=null===(m=o[g].props.content)||void 0===m?void 0:m.length)&&void 0!==y?y:1/0;break}}return r.node.dir===Eu.NONE&&(r.node=function(e){var t=e=ds(e),n=t.node.children,r=t.offset;if(null==n||!n.length)return e;for(var i=r>=n.length,o=n[i?n.length-1:r];null!==(a=o.children)&&void 0!==a&&a.length;){var a;o=o.children[i?o.children.length-1:0]}var s=i?ao(o,1):0;return ds(Ve({},e,{node:o,offset:s}))}(r).node,r.offset=0),r}ms(n)}return e}function ys(e,t){return e===Eu.LTR?t.dir!==Eu.RTL:t.dir===Eu.RTL}function ms(e){var t=e.renderPoint,n=e.fragments.inlineFlow.dir,r=e.chunks,i=e.renderPoint.node,o=r.indexOf(i),a=!r[o-1]||ys(n,r[o-1]),s=!r[o+1]||ys(n,r[o+1]);return i.dir===Eu.NONE?{index:o,isStartEdge:(Ro(i)||0===e.renderPoint.offset)&&a,isEndEdge:(Ro(i)||0!==e.renderPoint.offset)&&s}:{index:o,isStartEdge:0===t.offset&&a,isEndEdge:(!Ro(i)||t.offset===i.props.content.length)&&s}}function Es(e){for(var t=[],n=e.data,r=0;r<n.length;r++){var i=n[r];ps(i)?t=t.concat(i.chunks):t.push(i.renderObject)}return t}function bs(e,t){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){var t,n;return null!==(t=null===(n=e.children)||void 0===n?void 0:n.length)&&void 0!==t?t:0},r=$t(e.node,t.node),i=r.path1,o=r.path2,a=r.lcaIndex,s=e.offset,u=t.offset,l=i[a],c=a+1;i=i.slice(c),o=o.slice(c);var h=[];if(i.length){var d=Fe(i),f=n(d);s<=f&&h.push({node:d,start:s,end:f})}for(var p=i.length-2;p>=0;p--){var v=i[p],g=v.children,_=g.indexOf(i[p+1])+1,y=g.length;_<y&&h.push({node:v,start:_,end:y})}var m=i.length?l.children.indexOf(i[0])+1:s,E=o.length?l.children.indexOf(o[0]):u;m<E&&h.push({node:l,start:m,end:E});for(var b=0;b<o.length-1;b++){var T=o[b],C=T.children.indexOf(o[b+1]);C>0&&h.push({node:T,start:0,end:C})}if(o.length&&u>=0){var S=Fe(o);h.push({node:S,start:0,end:u})}return h}(e,t,(function(e){return ao(e,1)}))}function Ts(e,t){var n=e,r=t.cloneRo(e);if(Ro(r)){var i,o,a=r.runtime=No(r),s=n.runtime;a.isComputedStyle=!(null==s||!s.isComputedStyle),a.fragments=null!==(i=s.fragments)&&void 0!==i?i:null===(o=s.constraint)||void 0===o?void 0:o.fragments,An(a,"status",Bo(a.status,[1],!1))}return un(n,{paddingRight:0,marginRight:0,borderRightWidth:0,bTRRH:0,bTRRV:0,bBRRH:0,bBRRV:0}),un(r,{paddingLeft:0,marginLeft:0,borderLeftWidth:0,bTLRH:0,bTLRV:0,bBLRH:0,bBLRV:0}),r.props.sourceStyle=Ve(Object.keys(r.props.sourceStyle).filter((function(e){return!e.startsWith("__")})).reduce((function(e,t){return e[t]=r.props.sourceStyle[t],e}),{}),{marginLeft:0,paddingLeft:0,borderLeftWidth:0}),r}var Cs=function(e,t){if(e.length<2)return[void 0,void 0];var n=e.lastIndexOf(t);if(n>-1)e.splice(n,0,t),n++;else{for(var r=0,i=e.length-1;i-r>1;){var o=Math.floor((r+i)/2);if(t===e[o]){e.splice(o+1,0,t,t),n=o+2;break}t<e[o]?i=o:r=o}e[r]<t&&t<e[i]&&(e.splice(r+1,0,t,t),n=r+2)}return[e.slice(0,n),e.slice(n).map((function(e){return e-t}))]},Ss=function(e,t,n){var r,i,o=t.pos,a=t.target,s=a.props.content,u=a.lineBreakerPosition,l=a.graphemeBreakerPosition,h=s.slice(0,o),d=s.slice(o),f=Cs(null!==(r=u)&&void 0!==r?r:[],o),p=(0,c.Z)(f,2),v=p[0],g=p[1],_=Cs(null!==(i=l)&&void 0!==i?i:[],o),y=(0,c.Z)(_,2),m=y[0],E=y[1],b=hn(a).zoom,T=dn(a),C=n.measureTextWithZoom(es(a,0,o,"end"),T,b).width,S=n.measureTextWithZoom(es(a,o,s.length,"start"),T,b).width,w=a.width-C-S;tn(a,{width:C,textWidth:C,props:Ve({},a.props,{content:h}),lineBreakerPosition:v,graphemeBreakerPosition:m});var R=Ts(a,n),A=R;tn(R,{width:S,textWidth:S,props:Ve({},a.props,{content:d}),left:0,lineBreakerPosition:g,graphemeBreakerPosition:E});for(var O=a,M=0,k=a.parent,I=function(){var t=k.children;if(M=t.indexOf(O),k===e)return"break";var r=Ts(k,n),i=t.slice(0,M+1),o=t.slice(M+1),a=k.width;C+=O.left,rn(k),i.forEach((function(e){so(k,e)})),k.runtime&&An(k.runtime,"status",2),en(k,"width",C),o.forEach((function(e){en(e,"left",e.left-C-w),so(r,e)})),r.runtime&&An(r.runtime,"status",2),en(r,"width",a-C-w),en(r,"left",0),so(r,R,0),R=r,O=k,k=k.parent};k;){if("break"===I())break}return un(O,{marginBottom:0}),un(R,{marginTop:0}),{leafRightRo:A,rightRo:R,rightRoIndex:M}},ws=function(e,t,n){for(var r,i=t.target,o=i,a=0,s=i.parent;s;){var u=s.children;if(a=u.indexOf(o),s===e)break;var l=s.width;(r||a>0)&&function(){r&&a++;var e=u.slice(0,a),t=u.slice(a),i=Ts(s,n),o=0,c=0;rn(s),e.forEach((function(t,n){if(so(s,t),o=t.left+t.width,c=o,n===e.length-1){var r=hn(t).marginRight;o+=void 0===r?0:r}})),en(s,"width",c),t.forEach((function(e){en(e,"left",e.left-o),so(i,e)})),r&&(en(r,"left",0),so(i,r,0)),en(i,"width",l-o),r=i}(),o=s,s=s.parent}return r&&en(r,"left",0),{rightRo:r,lastTargetIndex:a}};function Rs(e,t,n){var r=n.maxWidth,i=n.isDomain,o=n.lineIndex,a=void 0===o?0:o,s=hn(e).textIndent;if(void 0===i||void 0===r){var u,l,c,h=e.runtime;r=null!==(u=null==h||null===(l=h.context)||void 0===l?void 0:l.maxWidth)&&void 0!==u?u:0,i=(null==h||null===(c=h.context)||void 0===c?void 0:c.maxWidth)!==1/0}if(!i||a||!s)return 0;var d=yi(t);return d.marginLeft+d.borderLeft+d.paddingLeft+s<r?s:0}function As(e){var t,n,r,i=e.runtime;return null!==(t=null==i||null===(n=i.context)||void 0===n?void 0:n.fragments)&&void 0!==t?t:null==i||null===(r=i.constraint)||void 0===r?void 0:r.fragments}function Os(e){return e%2?"rtl":"ltr"}function Ms(e,t,n,r,i,o){for(var a=0,s=t,u=0,l=r.length;u<l;u++){var c=Ss(e,{pos:r[u]-a,target:s},n),h=c.leafRightRo,d=c.rightRo,f=c.rightRoIndex;en(s,"dir",null==i?void 0:i[u]),s=h,a=r[u],so(e,d,f+1),null==o||o.add(h)}en(s,"dir",null==i?void 0:i[r.length])}function ks(e,t,n){if(t.dir)for(var r=t,i=t;;){var o;if(!(r=r.parent))return;if(r===e)return;if(null!==(o=r)&&void 0!==o&&o.children&&r.children.length>1){var a=ws(e,{target:i},n),s=a.rightRo,u=a.lastTargetIndex;s&&so(e,s,u+1)}i=r}}function Is(e,t){if(!e.children)return{parent2index:new Map,parent2children:new Map};var n="",r=t.data,i=[],o=new Map,s=new Map;function u(t,n){i.push({index:t,renderObject:n});for(var r=n;r&&r.parent!==e;)r=r.parent;if(r){var a=o.get(r);a?a.push(n):o.set(r,[n]),s.set(n,r)}}for(var l=0,c=r.length;l<c;l++){var h=r[l];if(ps(h))for(var d=h.chunks,f=0,p=d.length;f<p;f++){var v=d[f];v.textWidth<=0||(u(n.length,v),n+="none"===v.dir?"LTR":v.props.content)}else{var g=h.renderObject;u(n.length,g),g.dir?n+="LTR":n+=" "}}for(var _=function(e,t,n,r){var i=e.length;n=Math.max(0,null==n?0:+n),r=Math.min(i-1,null==r?i-1:+r);var o=[];return t.paragraphs.forEach((function(i){var a=Math.max(n,i.start),s=Math.min(r,i.end);if(a<s){for(var u=t.levels.slice(a,s+1),l=s;l>=a&&Hr(e[l])&Br;l--)u[l]=i.level;for(var c=i.level,h=1/0,d=0;d<u.length;d++){var f=u[d];f>c&&(c=f),f<h&&(h=1|f)}for(var p=c;p>=h;p--)for(var v=0;v<u.length;v++)if(u[v]>=p){for(var g=v;v+1<u.length&&u[v+1]>=p;)v++;v>g&&o.push([g+n,v+n])}}})),o}(n,di(n,e.dir)),y=0,m=_.length;y<m;y++){for(var E=_[y],b=[],T=0,C=0,S=i.length;C<S;C++){var w=i[C];E[0]<=w.index&&w.index<=E[1]&&(0===b.length&&(T=C),b.push(w))}b.length>1&&i.splice.apply(i,[T,b.length].concat((0,a.Z)(b.reverse())))}for(var R=new Map,A=0,O=i.length;A<O;A++){var M=i[A].renderObject,k=s.get(M);k&&!R.has(k)&&R.set(k,A)}return{parent2index:R,parent2children:o}}function xs(e,t){for(var n=0,r=t.inlineFlowRo,i=t.utils,o=0,a=e.length;o<a;o++){var s=e[o];if(bo(s,He.Text)&&(en(s,"ligatureStatus",0),s.width>0&&"rtl"===s.dir)){var u=e[o-1],l=e[o+1];u&&bo(u,He.Text)&&"rtl"===u.dir&&$a(u.props.content,u.props.content.length-1)&&en(s,"ligatureStatus",s.ligatureStatus+1),l&&bo(l,He.Text)&&"rtl"===l.dir&&$a(l.props.content)&&en(s,"ligatureStatus",s.ligatureStatus+2);var c=hn(s).zoom,h=dn(s),d=Ja(s),f=i.measureTextWithZoom(d,h,c).width;if(s.textWidth===f)continue;var p=s.textWidth-f;s.textWidth=f;for(var v=s;v&&v!==r;)v.width-=p,v=v.parent;n+=p}}return n}var Ns=function(e,t,n){if("none"!==e.dir){for(var r=t.data,i=!1,o="",a=[],s=0,u=r.length;s<u;s++){var l=r[s];if(ps(l))for(var c=l.chunks,h=0,d=c.length;h<d;h++){var f=c[h];f.textWidth<=0||"none"===f.dir||(a.push(f),o+=f.props.content)}}for(var p=di(o),v=p.levels,g=[],_=[],y=v[0],m=1,E=v.length;m<E;m++){if(v[m]!==y){var b=v[m];b!==y&&(g.push(m),_.push(Os(y)),y=b,i=!0),y=b}}_.push(Os(y)),en(e,"dir",Os(p.paragraphs[0].level)),en(e,"hasRTL","rtl"===e.dir||i);for(var T=0,C=0,S=0,w=a.length;S<w;S++){for(var R=a[S],A=R.props.content.length,O=g[C],M=R.dir?void 0:{breakpointList:[],directionList:[]};T<O&&O<T+A;)null==M||M.breakpointList.push(O-T),null==M||M.directionList.push(_[C]),O=g[++C];null==M||M.directionList.push(_[C]),M&&M.directionList.length>0&&Ms(e,R,n,M.breakpointList,M.directionList,t),O===T+A&&C++,T+=A}for(var k=e.dir,I=0,x=r.length;I<x;I++){var N=r[I];if(ps(N))for(var P=N.chunks,L=0,D=P.length;L<D;L++){var F=P[L];!k||"none"===F.dir||F.dir===k&&"rtl"!==F.dir||(ks(e,F,n),k=F.dir)}}}},Ps=function(e,t){var n,r=t.utils,i=t.direction,o=t.fragments;i||(i=e.dir);for(var s=hn(e).alignHorizontal,u=Is(e,o),l=u.parent2index,c=u.parent2children,h=0,d=null!==(n=e.children)&&void 0!==n?n:[],f=new Map,p=e.runtime.context.tempData.childStates,v=e.width,g=0,_=d.length;g<_;g++){var y=d[g],m=p.get(y),E=yi(y);if(f.set(y,E),h+=E.outerWidth,m){var b=m.lineStart,T=v-h,C=0;if("center"===s?C=.5*T:"right"===s&&(C=T),0===b&&("left"===s&&"ltr"===e.dir||"right"===s&&"rtl"===e.dir)){var S=Rs(e,d[b],{lineIndex:b});C="ltr"===e.dir?C+S:C-S}for(var w=[],R=[],A=b,O=g+1;A<O;A++){var M,k=d[A],I=c.get(k);I&&R.push.apply(R,(0,a.Z)(I)),w.push({index:null!==(M=l.get(k))&&void 0!==M?M:A,renderObject:k})}w.sort((function(e,t){return e.index-t.index}));var x=xs(R,{inlineFlowRo:e,utils:r});"center"===s?C+=.5*x:"right"===s&&(C+=x);for(var N=0,P=w.length;N<P;N++){var L,D=w[N].renderObject;if(D&&!Co(D)){var F=null!==(L=f.get(D))&&void 0!==L?L:yi(D);en(D,"left",C+F.marginLeft),C=D.left+D.width+F.marginRight}}h=0}}};function Ls(e){return function(t,n,r,i){var o,a=null===(o=t.children)||void 0===o?void 0:o.filter(ko);if(null==a||!a.length)return{node:t,offset:0};var s=io(a,(function(t){return e(t,n)})),u=a[s];return(s===a.length||s>0&&"found"!==e(u,n))&&(u=a[s-1]),Bs(u,ua(n,u),r,i)}}var Ds=Ls(ga),Fs=Ls(_a);function Bs(e,t,n,r){var i;return null!==(i=e.children)&&void 0!==i&&i.length?wo(e)&&!r.isNotFirstInlineFlow?function(e,t,n,r){var i,o,a,s=null===(i=e.children)||void 0===i?void 0:i.filter(ko);if(null===(o=s)||void 0===o||!o.length)return{node:e,offset:0};var u=0,l=t.y,c=!Vi(l,0,e.height),h=c?ga:va;if(c){for(var d=l<0,f=pa(s[d?0:s.length-1]).top,p=[],v=0;v<s.length;v++){var g=s[d?v:s.length-v-1];if(f!==pa(g).top)break;p.push(g)}d||p.reverse(),s=p}if(e.hasRTL&&(s=Array.from(s).filter((function(e){return e.width>0})).sort((function(e,t){var n,r;return(null!==(n=e.lineOffsetTop)&&void 0!==n?n:e.top)-(null!==(r=t.lineOffsetTop)&&void 0!==r?r:t.top)||e.left-t.left}))),u=io(s,(function(e){return h(e,t)})),a=s[u],(u===s.length||u>0&&"found"!==h(a,t))&&(a=s[--u]),u+1<s.length){var _=pa(a);l>=_.top+_.height&&(a=s[u+1])}return r.isNotFirstInlineFlow=!0,_s(Bs(a,ua(t,a),n,r),e)}(e,t,n,r):To(e,Ge)?Fs(e,t,n,r):Oo(e)?Ds(e,t,n,r):function(e,t,n,r){var i,o=null===(i=e.children)||void 0===i?void 0:i.filter(ko);if(null==o||!o.length)return{node:e,offset:0};for(var a=t.x,s=o[0],u=o.length-1;u>=0;u--){var l=o[u];if(a>=l.left){s=l;break}}return Bs(s,ua(t,s),n,r)}(e,t,n,r):Ro(e)?function(e,t,n,r){var i=t.x,o=e.textWidth,a=e.props.content;if((i="rtl"===e.dir?o-i:i)<=0)return{node:e,offset:0};if(i>=o)return{node:e,offset:a.length};for(var s=hn(e).zoom,u=dn(e),l=new Tr(a),c=0,h=null,d=0,f=0;null!==(h=l.nextBreak())&&(f=o-Go(n,a.slice(h),u,s).width,!(d<=i&&i<=f));)c=h,d=f;if(!h)return{node:e,offset:a.length};var p=f-d,v=r.align;switch(void 0===v?"auto":v){case"left":h=c;break;case"right":break;default:i<d+p/2&&(h=c)}return{node:e,offset:h}}(e,t,n,r):function(e,t,n){var r=n.align,i=0;switch(void 0===r?"auto":r){case"left":i=0;break;case"right":i=1;break;default:i=t.x<e.width/2?0:1}return{node:e,offset:i}}(e,t,r)}var Vs=[0,0,1,1],Hs=function(e){return!e||e.every((function(e){return!e}))?Vs:e};var Us={buildContext:function(e){return Ti(e)},computeStyle:function(e,t){var n=Ri(t),r=n.maxWidth,i=n.maxHeight,o=n.inheritedStyle,a=Rn(e);aa(["zoom"],e,a,void 0,o),wa(e,a,r,o),Ra(e,a,i,o),Oa(e,a,o),function(e,t){sn(e,"fit",t.fit)}(e,a),function(e,t){sn(e,"position",t.position)}(e,a)},wrapup:function(e,t){var n,r,i=t.maxWidth,o=t.minWidth,a=t.maxHeight,s=t.minHeight,u=e.props,l=u.source,h=u.crop,d=void 0===h?[0,0,1,1]:h,f=De(null==l?void 0:l.width)?l.width:0,p=De(null==l?void 0:l.height)?l.height:0,v=Hs(d),g=(0,c.Z)(v,4),_=g[0],y=g[1],m=g[2],E=g[3],b=hn(e),T=b.width,C=b.height;f*=m-_;var S,w,R,A,O=(p*=E-y)?f/p:1;De(T)&&(S=T,w=null!==(R=w)&&void 0!==R?R:T/O);De(C)&&(S=null!==(A=S)&&void 0!==A?A:C*O,w=C);tn(e,{width:S=Hi(null!==(n=S)&&void 0!==n?n:f,o,i),height:w=Hi(null!==(r=w)&&void 0!==r?r:p,s,a)})}};var Zs,Ws,js=function(e,t){var n,r=t.clips,i=t.source,o=t.dest,a=t.data,s=t.opacity,u=null!==(n=null!=r&&r.length?r.map((function(t){return function(e,t){var n=t.rect,r=t.radius;if(n||r){if(e.save(),e.beginPath(),n){var i=n.left,o=n.top,a=n.width,s=n.height;e.rect(i,o,a,s),e.clip()}return r&&(to(e,r),e.clip()),function(){return e.restore()}}}(e,t)})).reduce((function(e,t){return function(){null==t||t(),null==e||e()}})):void 0)&&void 0!==n?n:Ne;e.globalAlpha=s,e.drawImage(a,i.left,i.top,i.width,i.height,o.left,o.top,o.width,o.height),u()},Gs=function(){function e(){(0,h.Z)(this,e),this.cmds={}}return(0,d.Z)(e,[{key:"onPush",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ja,n=this.cmds[t];n||(this.cmds[t]=n=[]),n.push(e)}},{key:"onFlush",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ja,n=this.cmds[t];n&&(e.save(),n.forEach((function(t){0!==t.data.width&&js(e,t)})),e.restore(),n.length=0)}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ja;delete this.cmds[e]}},{key:"clearAll",value:function(){this.cmds={}}}]),e}();Zs="type",Ws=4,function(e,t,n){t in e?Ca(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(Gs,"symbol"!==(0,u.Z)(Zs)?Zs+"":Zs,Ws);var zs={didPaint:function(e){var t,n=e.painter,r=e.rect,i=e.renderObject,o=i.props,a=o.source,s=o.crop;if(a){var u=Hs(s),l=(0,c.Z)(u,4),h=l[0],d=l[1],f=l[2],p=l[3],v=r.left,g=r.top,_=r.width,y=r.height,m=i.style,E=m.fit,b=void 0===E?"none":E,T=m.position,C=[],S=a.width,w=a.height,R=h*S,A=d*w,O=v,M=g,k=_,I=y,x=(S*=f-h)/(w*=p-d),N=_/y;if("none"!==b?("fill"===b?(k=_,I=y):"contain"===b||"scale-down"===b&&(_<S||y<w)?N>x?(I=y,k=y*x):(k=_,I=_/x):"cover"===b&&(N>x?(k=_,I=_/x):(I=y,k=y*x)),O=v+.5*(_-k),M=g+.5*(y-I)):(k=S,I=w,O=v-(S-_)/2,M=g-(w-y)/2),T)switch(T){case"left":O=v;break;case"top":M=g;break;case"bottom":M=g-(I-y);break;case"right":O=v-(k-_);break;case"bottom left":O=v,M=g-(I-y);break;case"bottom right":M=g-(I-y),O=v-(k-_);break;case"top left":M=g,O=v;break;case"top right":M=g,O=v-(k-_)}var P={left:O,top:M,width:k,height:I};Gi(r,P)||C.push({rect:{left:v,top:g,width:_,height:y}});var L=null!==(t=Ni(n,i))&&void 0!==t?t:[],D=(0,c.Z)(L,1)[0];if(D&&D.style&&fn(D.style)){var F=da(D);fa(F,D.style,F),Gi(F,r)||C.push({rect:{left:D.x,top:D.y,width:D.width,height:D.height},radius:no(D.x,D.y,D.width,D.height,D.style)})}jn.push({type:4,data:a,clips:C,source:{left:R,top:A,width:S,height:w},dest:P,opacity:1})}},paintSelection:function(e){var t=e.painter,n=e.renderObject,r=e.rect,i=e.range,o=e.nodePosition,a=(0,c.Z)(i,2);if(!(a[0]>=a[1])){var s=oo(n),u=qa(n,s),l=u.outerTop,h=u.outerBottom,d=u.outerLeft,f=u.outerRight,p=u.marginLeft,v=u.marginRight,g=d-(1&o?p:0),_=f-(2&o?v:0),y={left:r.left-g,top:r.top-l,width:g+r.width+_,height:l+r.height+h};if(y.width&&y.height){var m=Ni(t,s),E=(0,c.Z)(m,1)[0],b=Yi([y,{left:E.x,top:E.y,width:E.width,height:E.height}]),T=Ve({type:1,fill:Pi.color,opacity:t.globalAlpha},b);jn.push(T,"selection")}}},commandPlugins:[Gs,os,Ga]},Ys={buildContext:function(e){return Ti(e)},computeStyle:function(e,t){var n=Ri(t),r=n.maxWidth,i=n.maxHeight,o=n.inheritedStyle,a=Rn(e);aa("zoom",e,a,void 0,o),wa(e,a,r,o),Ra(e,a,i,o),Oa(e,a,o)},wrapup:function(e,t){var n,r,i=t.maxWidth,o=t.minWidth,a=t.maxHeight,s=t.minHeight,u=hn(e),l=u.width,c=u.height;tn(e,{width:Ei(null!==(n=l)&&void 0!==n?n:"auto",0,o,i),height:Ei(null!==(r=c)&&void 0!==r?r:"auto",0,s,a)})}},Xs={willPaint:function(e){var t,n,r,i,o,a,s,u,l=e.painter,c=e.renderObject,h=e.rect,d=e.colorConverter,f=c.width,p=c.height;if(0!==c.width&&0!==c.height){var v=h.left,g=h.top;qi(l,c,h),null===(t=l.setKeepSaveNum)||void 0===t||t.call(l);var _,y=null!==(n=c.style.fontColor)&&void 0!==n?n:null===(r=c.runtime)||void 0===r||null===(i=r.context)||void 0===i||null===(o=i.inheritedStyle)||void 0===o?void 0:o.fontColor,m=y;if(d)m=d(y);else m=null!==(_=l.getColorByToken(y))&&void 0!==_?_:y;null===(a=(s=c.props).draw)||void 0===a||a.call(s,{ctx:l,fontColor:m,left:v,top:g,width:f,height:p}),null===(u=l.restoreIfNeed)||void 0===u||u.call(l)}},didPaint:function(e){var t=e.painter,n=e.renderObject;0!==n.width&&0!==n.height&&$i(t,n)},paintSelection:function(e){var t=e.painter,n=e.renderObject,r=e.rect,i=e.range,o=e.nodePosition,a=(0,c.Z)(i,2);if(!(a[0]>=a[1])){var s=oo(n),u=qa(n,s),l=u.outerTop,h=u.outerBottom,d=u.outerLeft,f=u.outerRight,p=u.marginLeft,v=u.marginRight,g=d-(1&o?p:0),_=f-(2&o?v:0),y={left:r.left-g,top:r.top-l,width:g+r.width+_,height:l+r.height+h};if(y.width&&y.height){var m=Ni(t,s),E=(0,c.Z)(m,1)[0],b=Yi([y,{left:E.x,top:E.y,width:E.width,height:E.height}]),T=Ve({type:1,fill:Pi.color,opacity:t.globalAlpha},b);jn.push(T,"selection")}}},commandPlugins:[Ga]},Ks={buildContext:function(e){return Ti(e,["width"],!0)},createChildConstraint:function(e,t){var n=t.runtime;Mn(n,Si(e)),Mn(n,jt)},wrapup:function(e,t){var n,r=t.maxWidth,i=t.minWidth,o=t.maxHeight,a=t.minHeight,s=t.isWeakWidth,u=hn(e).marginCollapse,l=e.children,c=0,h=0,d=0;if(null!=l&&l.length)for(var f=0;f<l.length;f++){var p=l[f];if(!Co(p))if(Cn(hn(p))){var v=_i(p),g=v.outerWidth,_=v.outerHeight,y=v.marginLeft,m=v.marginTop,E=v.marginBottom;if(tn(p,{left:y,lineOuterHeight:_}),u)en(p,"top",h+=Math.max(m,f?c:0)),h+=p.height,c=E;else en(p,"top",h+m),h+=_;d=Math.max(d,g)}else tn(p,{left:0,lineOuterHeight:0,top:h+c})}u&&(h+=c),tn(e,{width:Ei(null!==(n=hn(e).width)&&void 0!==n?n:r===1/0?"auto":r,d,i,r,s),height:Ei("auto",h,a,o)}),function(e){var t;if(null===(t=e.children)||void 0===t||!t.length)return;var n=hn(e).alignHorizontal;if(n){var r=e.width;"center"===n?e.children.forEach((function(e){en(e,"left",r/2-e.width/2)})):"right"===n&&e.children.forEach((function(e){var t=yi(e),n=t.outerWidth,i=t.marginLeft;en(e,"left",r-n+i)}))}}(e)},computeStyle:function(e,t){var n=Ri(t),r=n.maxWidth,i=n.inheritedStyle,o=Rn(e);aa("zoom",e,o,void 0,i),wa(e,o,r,i),aa(["minWidth","maxWidth"],e,o,r,i),aa(["alignHorizontal","marginCollapse","display"],e,o),Aa(e,o)}};function qs(e,t,n,r){var i,o=hn(t).zoom,a=function(e,t){var n=De(e),r=!1;if("string"==typeof e){var i=(e=e.trim())[e.length-1];(n=i>="0"&&i<="9")?e=parseFloat(e):r="%"===i}if(n||r){var o=e;return n&&(o="".concat(100*e,"%")),o}var a,s=Tn(e,{});if(De(s))return s*(null!==(a=t)&&void 0!==a?a:1)}(null!==(i=null==n?void 0:n[e])&&void 0!==i?i:null==r?void 0:r[e],o);void 0!==a&&sn(t,e,a)}function $s(e,t){var n=e.height,r=e.baseline;switch(t){case"top":return 0;case"bottom":return n;case"middle":return n/2;default:if(!r){var i=hn(e).baselineOffset;return"number"==typeof i?n+i:n}return r}}function Js(e,t){var n,r=e.children;return null===(n=r)||void 0===n||!n.length||wo(e)&&void 0!==e.baseline?$s(e,t):(r=r.filter(Mo)).length?Qs(r,t).alignLine:$s(e,t)}function Qs(e,t){for(var n=0,r=new Array(e.length),i=0;i<e.length;i++){var o=e[i];r[i]=o.top+Js(o,t),n=Math.max(n,r[i])}return{alignLine:n,childAlignLines:r}}function eu(e,t){var n,r=t.lineHeight,i=t.force,o=t.maxFontSize,a=t.contentHeight;Le(r)&&r.endsWith("%")?n=o*(.01*parseFloat(r)):n=De(r)?r:a;var s=i?n:Math.max(n,a),u=.5*(s-a);!i&&(u=Math.max(u,0));for(var l=0;l<e.length;l++){var c=e[l];en(c,"lineOuterHeight",s),en(c,"top",c.top+u)}return{lineOuterHeight:s,halfGap:u}}function tu(e){for(var t=0,n=function e(n){if(wo(n)){var r=n.runtime;if(null!=r&&r.context)return void(t=Math.max(r.context.maxFontSize,t))}var i=hn(n).fontSize;De(i)&&(t=Math.max(i,t));var o=n.children;if(null!=o&&o.length)for(var a=0;a<o.length;a++){var s=o[a];Mo(s)&&e(s)}},r=0;r<e.length;r++){var i=e[r];Mo(i)&&n(i)}return t}function nu(e,t,n){var r=dn(e),i=r.fontFamily,o=r.fontSize,a=n.measureFont(i,o),s=a.fontHeight,u=a.fontAscent,l=t.map((function(e){return e.top})).reduce((function(e,t){return Math.min(e,t)}),1/0);return{top:l===1/0?0:l,style:r,height:s,baseline:u}}var ru=function(e){var t,n,r,i,o,a,s,u,l;n=(t=e).renderObject,r=t.renderObjectAtLast,i=t.maxWidth,o=t.isWeakWidth,a=n.runtime.context.tempData,s=yi(r),u=r.left+r.width+s.marginRight,l=Math.max(a.maxLineWidth,a.leftStart,u),o&&(l=Math.max(l,u)),a.maxLineWidth=!o&&i<l?i:l;var c=hn(e.renderObject),h=c.leadingTop,d=void 0===h?0:h,f=c.leadingBottom,p={leadingTop:d,leadingBottom:void 0===f?0:f};!function(e,t){var n,r,i=t.leadingTop,o=e.renderObject,a=e.renderObjectAtLast,s=o.runtime.context.tempData,u=s.currLineStartIndex,l=null!==(n=null===(r=a.parent)||void 0===r?void 0:r.children)&&void 0!==n?n:[a],c=l.indexOf(a);if(!(u>c)){for(var h=s.heightSum+i,d=u;d<=c;d++){var f=l[d];en(f,"lineOffsetTop",h);var p=hn(f).marginTop;en(f,"top",h+(void 0===p?0:p))}var v=o.ellipsisRo;a===(null==v?void 0:v.extra.renderObjectAtLast)&&(en(v,"lineOffsetTop",h),en(v,"top",h))}}(e,p),function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.leadingTop,i=void 0===r?0:r,o=n.leadingBottom,a=void 0===o?i:o,s=e.renderObjectAtLast,u=e.utils,l=e.renderObject,c=l.runtime.context.tempData,h=c.currLineStartIndex,d=null!==(t=l.children)&&void 0!==t?t:[s],f=d.indexOf(s);if(!(h>f)){var p=hn(l),v=p.alignVertical,g=void 0===v?"baseline":v,_=p.forceLineHeight,y=p.lineHeight,m=(p.zoom,d.slice(h,f+1)),E=l.runtime,b=l.ellipsisRo;s===(null==b?void 0:b.extra.renderObjectAtLast)&&m.push(b);var T=nu(l,m,u);m.push(T);for(var C=Qs(m,g),S=C.alignLine,w=C.childAlignLines,R=tu(m),A=1/0,O=0,M=0;M<m.length;M++){var k=m[M];if(Mo(k)){en(k,"top",k.top+S-w[M]);var I=hn(k),x=I.marginTop,N=void 0===x?0:x,P=I.marginBottom,L=void 0===P?0:P;A=Math.min(A,k.top-N),O=Math.max(O,k.top+k.height+L)}}var D=O-A,F=D,B=0;if(qn(E.context)){var V,H=void 0!==_,U=eu(m,{lineHeight:null!==(V=H?_:y)&&void 0!==V?V:D,force:H,maxFontSize:R,contentHeight:D});F=U.lineOuterHeight,B=U.halfGap}On(E,{maxFontSize:R}),en(l,"baseline",S+B),c.heightSum+=i+F+a}}(e,p)},iu=function(e){ru(e),function(e){var t;An(e,"completedLinesCount",(null!==(t=e.completedLinesCount)&&void 0!==t?t:0)+1)}(e.renderObject.runtime)};var ou=function(e,t,n){var r=e.runtime.context.tempData;r.currLineStartIndex=t,r.leftStart=0,r.remainingWidth=n};var au=function(e,t){for(var n=e;n&&n.parent!==t;)n=n.parent;return n};function su(e){var t;if(!e)return null;if(Ro(e))return e;var n=null===(t=e.children)||void 0===t?void 0:t.filter((function(e){return Mo(e)}));return 1===(null==n?void 0:n.length)&&function(e){return!(!1===e.props.lineWrap||!Ho(e)||!To(e,ze))}(n[0])?su(n[0]):null}function uu(e,t,n){var r=hn(e).zoom,i=Ve({},n,dn(e));return t.measureTextWithZoom("...",Uo(i),r)}function lu(e,t,n){for(var r=e.width,i=e.props.content,o=hn(e).zoom,a=Uo(dn(e)),s=r-t,u=new Tr(i),l=u.nextBreak(),c=0,h=0,d=0,f=0;null!==l;){var p=i.slice(0,l),v=n.measureTextWithZoom(p,a,o);if(v.width>s){c=h,d=f;break}h=l,f=v.width,l=u.nextBreak()}tn(e,{width:d,textWidth:d}),tn(e,{props:Ve(e.props,{content:i.slice(0,c)})})}function cu(e){var t=e.rootRenderObject,n=e.style,r=e.ellipsisWidth,i=e.ellipsisHeight,o=e.baseline,a=e.renderObjectAtLast,s=e.cutWith,u=void 0===s?0:s,l={root:t.root,element:t.element,type:He.Text,parent:t,children:[],style:Ve({},n),width:r,height:i,props:{selectable:!1,sourceStyle:{},content:"..."},top:a.top,left:a.left+a.width-u,textWidth:r,textHeight:i,baseline:o,extra:{renderObjectAtLast:a,cutWith:u}};t.ellipsisRo=l}function hu(e,t){var n=e.rootRenderObject,r=e.utils,i=e.isWeakWidth,o=e.maxWidth,a=n.runtime.context.tempData,s=As(n),u=Ss(n,t,r),l=u.rightRo,c=u.leafRightRo;if(l){var h=au(t.target,n),d=Jt(h);so(n,l,d+1),s.add(c),a.leftStart=h.left+h.width,iu({renderObjectAtLast:h,renderObject:n,utils:r,maxWidth:o,isWeakWidth:i}),ou(n,d+1,o)}return{rightRo:l,leafRightRo:c}}function du(e){var t=e.rootRenderObject,n=e.remainingWidth,r=e.remainingHeight,i=void 0===r?0:r,o=e.utils,a=e.maxWidth,s=e.isWeakWidth,u=e.indent,l=void 0===u?0:u,h=t.runtime.context.tempData;h.childStates.clear();for(var d=As(t).data.reduce((function(e,t){return ps(t)?t.chunks.forEach((function(t){e.push({ro:t,type:0})})):e.push({ro:t.renderObject,type:1}),e}),[]),f=l,p=-1,v=null,g=null,_=0,y=0,m=function(){p++;var r=d[p],u=r.ro,m=r.type;if(Co(u)||u.isDestructed)return"continue";var E=au(u,t),b=Jt(E),T=function(e,t){for(var n=yi(e),r=n.marginLeft,i=n.marginRight,o=e.parent,a=Jt(e);o&&o!==t&&!(a>0);){a=Jt(o);var s=yi(o);r+=s.paddingLeft+s.borderLeft+s.marginLeft,i+=s.paddingRight+s.borderRight+s.marginRight,o=o.parent}return[r,i]}(u,t),C=(0,c.Z)(T,2),S=C[0],w=C[1],R=yi(u),A={remainingWidth:n,remainingHeight:i-h.heightSum,committedLine:y,renderObject:E,rootRenderObject:t,utils:o};if(b&&function(e){var t=e.renderObject,n=e.rootRenderObject,r=e.remainingWidth,i=e.remainingHeight,o=e.committedLine;if(i<yi(t).outerHeight)return!0;var a=hn(n).maxLines;if(!De(a)||!a)return!1;var s=a-o;return s<=0||1===s&&r<yi(t).outerWidth&&!su(t)}(A)){var O,M=t.runtime.context,k=function(e){var t=e.rootRenderObject,n=e.inheritedStyle,r=e.index,i=e.utils,o=hn(t),a=o.overflowEllipsis;if(!o.maxLines&&!a)return!1;for(var s=t.children,u=s[r],l=u.left,c=u.width,h=pa(s[r]),d=h.top,f=h.height,p=c+l,v=r+1;v<s.length;v++){var g=s[v],_=hn(g),y=_.marginTop,m=_.marginBottom;sn(g,"display",!1),tn(g,{left:p,top:d+f,height:0,lineOffsetTop:d+f,lineOuterHeight:0}),y&&sn(g,"marginTop",0),m&&sn(g,"marginBottom",0)}if(!a)return!0;for(var E=0,b=null;r>=0;){var T=(b=s[r]).left,C=yi(b),S=C.innerWidth,w=C.marginLeft,R=dn(b),A=R.fontFamily,O=R.fontSize,M=i.measureFont(A,O),k=M.fontHeight,I=M.fontAscent;if(E){var x=uu(b,i).width;if(p-T-S>=x)return cu({rootRenderObject:t,style:Ve({fontSize:O,fontFamily:A},n,hn(b)),ellipsisWidth:x,ellipsisHeight:k,baseline:I,renderObjectAtLast:b}),!0}if(S){var N=su(b);if(N){var P=uu(N,i).width;if(P<S){var L=N.width;lu(N,P,i);var D=b.width!==N.width?L-N.width:0;return cu({rootRenderObject:t,style:hn(N),ellipsisWidth:P,ellipsisHeight:k,baseline:I,renderObjectAtLast:b,cutWith:D}),!0}}}if(sn(b,"display",!1),!T||w===T)return!0;E=T,r--}}({rootRenderObject:t,inheritedStyle:null!==(O=null==M?void 0:M.inheritedStyle)&&void 0!==O?O:{},index:b-1,utils:o});if(k)return"break"}if(0===m&&Ro(u)){var I,x=null!==(I=u.props.content)&&void 0!==I?I:"",N=hn(u).zoom,P=Uo(dn(u)),L=o.measureTextWithZoom(x,P,N).width,D=v===u,F=!1;if(g!==E||D){var B=f;(B+=yi(E).marginLeft)>n?F=!0:en(E,"left",B)}var V=S+L+w;if(f+V<n)return f+=V,v=u,g=E,"continue";var H=u.lineBreakerPosition,U=u.graphemeBreakerPosition,Z=R.paddingLeft+R.borderLeft,W=R.paddingRight+R.borderRight;f+=S+Z;for(var j=function(r){var i=H[r],a=H[r+1],s=es(u,i,a),c=o.measureTextWithZoom(s,P,N).width,m=r===H.length-2?W+w:0;if(f+c+m<=n)return f+=c,G=r,"continue";if(!(S+Z+c+m>n||0===y&&l&&l+S+Z+c+m>n)||F){var b=0===i&&v,T=b&&v&&Ro(v)?(G=r,{type:1,target:v,pos:v.props.content.length}):b&&v&&!Ro(v)?(G=r,{type:0,target:v,pos:i}):(G=r,{type:1,target:u,pos:i}),C=au(T.target,t),R=Jt(C);if(b){if(C===g){var A=ws(t,{target:u},o),O=A.rightRo,M=A.lastTargetIndex;O&&so(t,O,M+1)}!function(e,t,n,r){var i=r.rootRenderObject,o=r.utils,a=r.maxWidth,s=r.isWeakWidth;i.runtime.context.tempData.leftStart=n.target.left+n.target.width,iu({renderObjectAtLast:e,renderObject:i,utils:o,maxWidth:a,isWeakWidth:s}),ou(i,t+1,a)}(C,R,T,e),!D&&d.splice(p+1,0,{ro:u,type:0})}else{var k=hu(e,T).leafRightRo;d.splice(p+1,0,{ro:k,type:0})}return h.childStates.set(C===g?g:E,{lineStart:_,lineEnd:R}),f=0,_=R+1,y++,G=r,"break"}if(i>0){var I=hu(e,{type:1,target:u,pos:i}).leafRightRo;d.splice(p+1,0,{ro:I,type:0});var x=Jt(au(u,t));return h.childStates.set(E,{lineStart:_,lineEnd:x}),f=0,_=x+1,y++,G=r,"break"}U||(!function(e){if(void 0===e.graphemeBreakerPosition){for(var t=e.props.content,n=[0],r=new Tr(t),i=r.nextBreak();i;)n.push(i),i=r.nextBreak();e.graphemeBreakerPosition=n}}(u),U=u.graphemeBreakerPosition);for(var L=Math.max(0,U.indexOf(i)),B="rtl"===u.dir,V=L;V<U.length-1;V++){var j=B?i:U[V],z=U[V+1],Y=es(u,j,z,"end"),X=o.measureTextWithZoom(Y,P,N).width,K=V===U.length-2?W+w:0;if(!(f+X+K<=n||V===L)){var q={type:1,target:u,pos:U[V]},$=hu(e,q).leafRightRo;d.splice(p+1,0,{ro:$,type:0});var J=Jt(E);h.childStates.set(E,{lineStart:_,lineEnd:J}),f=0,_=J+1,y++,r=H.length-1;break}(!B||V===L)&&(f+=X)}G=r},G=0;G<H.length-1;G++){var z=j(G);if("continue"!==z&&"break"===z)break}v=u,g=E}else{var Y=u.width,X=S+Y+w,K=v===u;if(g!==E||K){var q=f;q+=yi(E).marginLeft,en(E,"left",q)}if(f+X<=n)return f+=X,v=u,g=E,"continue";var $,J=K?u:null!==($=v)&&void 0!==$?$:u,Q=au(J,t),ee=Jt(Q);if(Q===g){var te=ws(t,{target:u},o),ne=te.rightRo,re=te.lastTargetIndex;ne&&so(t,ne,re+1)}iu({renderObjectAtLast:Q,renderObject:t,utils:o,maxWidth:a,isWeakWidth:s}),ou(t,ee+1,a),!K&&d.splice(p+1,0,{ro:u,type:1}),h.childStates.set(Q,{lineStart:_,lineEnd:ee}),_=ee+1,y++,f=0,v=u,g=E}};p<d.length-1;){var E=m();if("continue"!==E&&"break"===E)break}}var fu=function(e){var t=e.renderObject,n=e.rootRenderObject,r=e.utils,i=e.indent,o=e.maxWidth,a=e.isWeakWidth,s=n.runtime.context.tempData;du({rootRenderObject:n,renderObject:t,indent:i,remainingWidth:s.remainingWidth,remainingHeight:s.remainingHeight,utils:r,maxWidth:o,isWeakWidth:a})},pu=function(e){var t,n=e.renderObject,r=e.rootRenderObject,i=e.indent,o=yi(n),a=r.runtime.context.tempData;a.leftStart+=null!==(t=i)&&void 0!==t?t:0,en(n,"left",a.leftStart+o.marginLeft),a.leftStart+=o.outerWidth,a.remainingWidth=Math.max(0,e.maxWidth-a.leftStart)};function vu(e){!function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];we.apply(void 0,["error","error"].concat(t))}("".concat(e," 只支持以 px 为单位的字符串类型值"))}function gu(e){return/^\d+(\.\d+)?px$/.test(e)}var _u=new Set([void 0,"auto"]),yu={buildContext:function(e){var t=e.runtime;Ti(e,["width","minWidth","maxWidth"]),qn(t.context)&&function(e,t){Ve(t.context,{fragments:new gs({inlineFlow:e})})}(e,t);var n=t.context;if(null==n||!n.isWeakWidth){var r,i=hn(e),o=i.weakWidth,a=i.minWidth;if(void 0!==o)On(t,{isWeakWidth:!0}),void 0===a&&void 0===(null===(r=t.constraint)||void 0===r?void 0:r.flexWidth)&&On(t,{minWidth:0})}On(t,{maxFontSize:dn(e).fontSize})},createChildConstraint:function(e,t){var n=e.runtime,r=n.constraint,i=n.context,o=i.maxWidth,a=i.fragments;qn(i)||(a=null==r?void 0:r.fragments);var s=r.originMaxWidth,u=wi(o,s),l=(0,c.Z)(u,2);o=l[0],s=l[1];var h=t.runtime;h&&Mn(h,Ve({maxWidth:o,originMaxWidth:s,fragments:a,disableRTL:"none"===e.dir},Wt))},wrapup:function(e,t,n){var r,i,o=t.maxWidth,a=void 0===o?0:o,s=t.minWidth,u=t.maxHeight,l=t.minHeight,c=t.isWeakWidth,h=t.fragments,d={currLineStartIndex:0,leftStart:0,maxLineWidth:0,remainingWidth:a,remainingHeight:u,heightSum:0,isChildrenReady:!0,childStates:new Map};t.tempData=d;var f=(null!==(r=e.children)&&void 0!==r?r:[]).filter((function(e){return Mo(e)}));if(f.length){var p=qn(t),v=function(t){var r=f[t];p&&null!=h&&h.data.length&&Ns(e,h,n),null==h||h.compute();var i={renderObject:r,rootRenderObject:e,maxWidth:a,isWeakWidth:c,utils:n,isDomain:p,indent:t?0:Rs(e,r,{lineIndex:t,maxWidth:a,isDomain:p})},o=r.runtime;if(!d.isChildrenReady||!Po(o))return d.isChildrenReady=!1,void pu(i);d.isChildrenReady=!0,function(e,t){delete e[t]}(r,"lineOuterHeight"),p?fu(i):pu(i)};if(v(0),!p)for(var g=1;g<f.length;g++)v(g);var _=Fe((f=e.children).filter(Mo));if(_){var y=f.indexOf(_);d.currLineStartIndex<=y&&(iu({renderObjectAtLast:_,utils:n,renderObject:e,maxWidth:a,isWeakWidth:c}),d.childStates.set(_,{lineStart:d.currLineStartIndex,lineEnd:y}))}}var m=d.maxLineWidth,E=d.heightSum,b=hn(e),T=b.weakWidth,C=b.width;tn(e,{width:c&&De(T)?Math.max(m,s):Ei(null!==(i=C)&&void 0!==i?i:"auto",m,s,a,c),height:Ei("auto",E,l,u)}),Rn(e).alignHorizontal||sn(e,"alignHorizontal","rtl"===e.dir?"right":"left"),e.hasRTL&&qn(t)&&h&&(null==h?void 0:h.data.length)>0?Ps(e,{utils:n,fragments:h}):function(e){var t,n,r=e.renderObject,i=hn(r).alignHorizontal;if(i&&"left"!==i&&("center"===i||"right"===i)){var o=null!==(t=null===(n=r.children)||void 0===n?void 0:n.slice(0))&&void 0!==t?t:[],a=0,s=r.runtime.context.tempData.childStates;o.forEach((function(e){var t=s.get(e),n=yi(e);if(a+=n.outerWidth,t){var u=r.width-a,l="center"===i?.5*u:u;o.slice(t.lineStart,t.lineEnd+1).forEach((function(e){if(!Co(e)){var t=yi(e);en(e,"left",l+t.marginLeft),l=e.left+e.width+t.marginRight}})),a=0}}))}}({renderObject:e,utils:n}),delete t.tempData},computeStyle:function(e,t){var n=Ri(t),r=n.inheritedStyle,i=n.maxWidth,o=Rn(e);aa(["alignHorizontal","alignVertical","zoom","maxLines","textIndent","overflowEllipsis","display"],e,o,void 0,r);var a=o,s=a.width,u=a.weakWidth,l=!1;if(!_u.has(u)&&_u.has(s)?(l=!0,o=Ve({width:u},o)):cn(e,"weakWidth"),wa(e,o,i,r),aa(["minWidth","maxWidth"],e,o,i,r),l){var h=hn(e),d=h.width,f=h.maxWidth;De(d)&&(!De(f)||f>d?sn(e,"weakWidth",d):(cn(e,"width"),cn(e,"weakWidth")))}aa(["fontFamily"],e,o,void 0,Ve({fontFamily:Re},r)),vn(e,o,r),function(e,t,n){var r=t.forceLineHeight,i=t.lineHeight;void 0!==r?qs("forceLineHeight",e,t,n):void 0!==i?qs("lineHeight",e,t,n):n&&(void 0!==n.forceLineHeight?qs("forceLineHeight",e,t,n):void 0!==n.lineHeight&&qs("lineHeight",e,t,n))}(e,o,r),function(e,t,n){var r,i,o=null!==(r=null==t?void 0:t.leading)&&void 0!==r?r:null==n?void 0:n.leading;if(void 0!==o){if(!Le(o))return ln(e,["leading"]),vu("leading");var a=lo(o),s=(0,c.Z)(a,2),u=s[0],l=s[1];if(l=l||u,!gu(u)||!gu(l))return ln(e,["leading"]),vu("leading");var h=null!==(i=hn(e).zoom)&&void 0!==i?i:1;sn(e,"leadingTop",parseFloat(u)),sn(e,"leadingBottom",parseFloat(l)*h)}}(e,o,r),hn(e).alignVertical||sn(e,"alignVertical",Ie),Aa(e,o)}},mu={didPaint:function(e){var t=e.renderObject,n=e.rect,r=e.painter,i=e.area,o=e.asRoot,a=t.ellipsisRo;if(a){var s={left:n.left+a.left,top:n.top+a.top,width:a.width,height:a.height};as({rect:s,renderObject:a,painter:r,area:i,asRoot:o})}}};var Eu=function(e){return e.LTR="ltr",e.RTL="rtl",e.AUTO="auto",e.NONE="none",e}(Eu||{}),bu={layout:ka,paint:Xa};function Tu(e){return Tu.type=He.Div,Yn(He.Div,bu),e.children}var Cu={layout:yu,paint:mu};function Su(e){return Su.type=He.InlineFlow,Yn(He.InlineFlow,Cu),e.children}var wu={layout:Ka,paint:ss};function Ru(e){return Ru.type=He.Text,Yn(He.Text,wu),e.children}var Au={layout:Ks};function Ou(e){return Ou.type=He.BlockFlow,Yn(He.BlockFlow,Au),e.children}var Mu={layout:Ma},ku="SimpleDiv";function Iu(e){return Iu.type=ku,Yn(ku,Mu),e.children}var xu={layout:Us,paint:zs};function Nu(e){return Nu.type=He.Bitmap,Yn(He.Bitmap,xu),e.children}var Pu={layout:Ys,paint:Xs};function Lu(e){return Lu.type=He.Drawing,Yn(He.Drawing,Pu),e.children}var Du={layout:Mi,paint:ro};var Fu={blinkmacsystemfont:{fs:128,fh:151,fa:124,fd:27,ea:112.5,ed:15.5,lh:151,xh:65,ch:103,as:28,ds:23,sl:12.1},"helvetica neue":{fs:128,fh:149.5,fa:122,fd:27.5,ea:111,ed:17,lh:153,xh:66,ch:102,as:28,ds:26,sl:11.9},times:{fs:128,fh:147,fa:115,fd:32,ea:105.5,ed:22.5,lh:147,xh:58,ch:110,as:31,ds:27,sl:14.9},arial:{fs:128,fh:143,fa:116,fd:27,ea:108.5,ed:19.5,lh:147,xh:66,ch:101,as:28,ds:26,sl:11.8},"segoe ui":{fs:128,fh:170,fa:138,fd:32,ea:117,ed:11,lh:170,xh:64,ch:116,as:33,ds:30,sl:12},"pingfang sc":{fs:128,fh:179,fa:135.5,fd:43.5,ea:110,ed:18,lh:179,xh:66,ch:103,as:28,ds:27,sl:14.1},"microsoft yahei":{fs:128,fh:169,fa:135.5,fd:33.5,ea:115,ed:13,lh:169,xh:69,ch:113,as:36,ds:32,sl:14.1},tahoma:{fs:128,fh:154.5,fa:128,fd:26.5,ea:114.5,ed:13.5,lh:154.5,xh:70,ch:120,as:29,ds:26,sl:14.1},"hiragino sans gb":{fs:128,fh:128,fa:112.5,fd:15.5,ea:112.5,ed:15.5,lh:192,xh:70,ch:108,as:30,ds:27,sl:14.1},"apple color emoji":{fs:128,fh:168,fa:128,fd:40,ea:108,ed:20,lh:179,xh:66,ch:103,as:28,ds:27,sl:14.1},"segoe ui emoji":{fs:128,fh:120,fa:93,fd:27,ea:97,ed:31,lh:137,xh:63,ch:116,as:34,ds:30,sl:14.1},"segoe ui symbol":{fs:128,fh:170,fa:138,fd:32,ea:117,ed:11,lh:170,xh:64,ch:116,as:33,ds:30,sl:14.1},"noto color emoji":{fs:128,fh:150.5,fa:119,fd:31.5,ea:107.5,ed:20.5,lh:179,xh:66,ch:103,as:28,ds:27,sl:14.1}},Bu={fs:"fontSize",fh:"fontHeight",fa:"fontAscent",fd:"fontDescent",ea:"emAscent",ed:"emDescent",lh:"lineHeight",xh:"xHeight",ch:"capHeight",as:"ascender",ds:"descender",sl:"slope"},Vu=128;function Hu(e){return Object.keys(Bu).forEach((function(t){void 0!==e[t]&&(e[Bu[t]]=e[t])})),e}var Uu=new Map;function Zu(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Vu;"string"==typeof r&&(r=parseInt(r,10));var i,o,a,s=e.toLowerCase();if(a=null!==(t=Uu.get(e))&&void 0!==t?t:Uu.get(s))return(i=a.get(r))?i:(o=Gu(i=Hu(i=a.get(Vu)),r),a.set(r,o),o);var u=Ku(e),l=u&&"serif"!==u&&"sans-serif"!==u,c=null!==(n=null==u?void 0:u.toLowerCase())&&void 0!==n?n:s;return o=Gu(i=Hu(i=Fu[c]?Fu[c]:Fu.arial),r),a=new Map([[Vu,i],[r,o]]),Uu.set(e,a),Uu.set(s,a),u&&(Uu.set(u,a),Uu.set(c,a)),l&&(Fu[c]=i),o}var Wu,ju=new Set(["slope"]);function Gu(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Vu,r=n/(null!==(t=e.fontSize)&&void 0!==t?t:Vu),i={};for(var o in e)i[o]=(ju.has(o)?1:r)*e[o];return i}var zu=1e-5,Yu=new Map;function Xu(e){var t=e.toLowerCase();if("arial"===t||"helvetica"===t||"sans-serif"===t||"serif"===t)return!0;if(Yu.has(e))return Yu.get(e);var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",t=document.createElement(e);return t.style.left="100vw",t.style.top="100vh",t.style.position="absolute",t.style.zIndex="-99999",t.style.visibility="hidden",t.style.pointerEvents="none",t}("span");n.textContent="abcdefghijklmnopqrstuvwxyz",n.style.fontSize="".concat(Vu,"px"),n.style.fontFamily=e+",Arial",document.body.appendChild(n);var r=n.getBoundingClientRect(),i=r.width,o=r.height,a=function(e){if(!Wu){e.style.fontFamily="Arial";var t=e.getBoundingClientRect(),n=t.width,r=t.height;Wu=[n,r]}return Wu}(n),s=(0,c.Z)(a,2),u=s[0],l=s[1];document.body.removeChild(n);var h=Math.abs(i-u)>zu||Math.abs(o-l)>zu;return Yu.set(e,h),h}function Ku(e){for(var t=e.split(","),n=0;n<t.length;n++)if(Xu(t[n]))return t[n].replace(/["'\s]+/g," ").trim();return null}var qu=new Map;function $u(e,t){if(""===e)return{width:0};var n=this.font;t&&(n="object"===(0,u.Z)(t)?function(e){var t,n,r,i=null!==(t=e.fontWeight)&&void 0!==t?t:"",o=null!==(n=e.fontStyle)&&void 0!==n?n:"",a=null!==(r=e.fontFamily)&&void 0!==r?r:"",s=e.fontSize;return"number"==typeof s?s="".concat(s,"px"):s||(s="16px"),"".concat(i," ").concat(o," ").concat(s," ").concat(a)}(t):t),qu.get(n)||qu.set(n,new Map);var r=qu.get(n),i=r.get(e);return i||(t&&(this.font=n),i=this.__measureText__?this.__measureText__(e):this.measureText(e),r.set(e,i)),i}function Ju(e){if("measureFont"in e)return e;var t=e.measureText;return Object.defineProperty(e,"measureText",{get:function(){return $u}}),Object.defineProperty(e,"__measureText__",{get:function(){return t}}),Object.defineProperty(e,"measureFont",{get:function(){return Zu}}),e}function Qu(e){return Array.isArray(e)}function el(e,t){for(var n,r,i,o,a,s=arguments.length,u=new Array(s>2?s-2:0),l=2;l<s;l++)u[l-2]=arguments[l];var c=null===(i=e({children:u=(u=Qu(u=null!==(r=(t=null!==(n=t)&&void 0!==n?n:{}).children)&&void 0!==r?r:u.flat(1/0))?u:[u]).flat(2)}))||void 0===i||null===(o=i.filter)||void 0===o?void 0:o.call(i,(function(e){return e}));if(!e.type&&"function"==typeof e)return e(Object.assign({children:u},t));var h=null!==(a=t.style)&&void 0!==a?a:{};delete t.style;var d={root:0,type:e.type,parent:void 0,children:[],style:Object.assign({},h),props:Object.assign({},t,{sourceStyle:h}),width:0,height:0,top:0,left:0};t.disableRTL&&(d.dir=Eu.NONE),t.draw&&(d.props.draw=t.draw),t.dir&&(d.dir=t.dir);for(var f=0;null!==(p=f<(null==c?void 0:c.length))&&void 0!==p&&p;f++){var p,v=c[f];v.parent=d}return d.children=c,d}function tl(e,t){var n,r=e.node,i=e.start,o=e.end,a=[Math.min(i,o),Math.max(i,o)];if(i=a[0],o=a[1],Ro(r)){var s=function(e,t,n){var r=hn(e).zoom,i=(0,c.Z)(t,2),o=i[0],a=i[1],s=dn(e),u=e.props.content,l="rtl"===e.dir?Go(n,es(e,0,o),s,r).width:Go(n,u.slice(a),s,r).width,h=o<a?"rtl"===e.dir?Go(n,es(e,0,a),s,r).width-l:Go(n,u.slice(o),s,r).width-l:0;return{textRight:l,textLeft:e.textWidth-l-h,textWidth:h}}(r,[i,o],t),u=s.textLeft,l=s.textWidth,h=nl(r);return[Object.assign({},h,{left:u+h.left,width:l})]}return null!==(n=r.children)&&void 0!==n&&n.length?i<o?r.children.slice(i,o).map((function(e){return nl(e)})):i>=r.children.length?[nl(function(e){var t=e.length;if(t>0)return e[t-1]}(r.children))]:[nl(r)]:[nl(r)]}function nl(e){for(var t={left:e.left,top:e.top,width:e.width,height:e.height};e.parent;)t.left+=e.parent.left,t.top+=e.parent.top,e=e.parent;return t}function rl(e,t,n){var r=function(e,t){for(var n=!1,r=e,i=e;null!==(o=r)&&void 0!==o&&o.children;){var o;(r=Ea(r,t,n=n||!!r.runtime&&Po(r.runtime)))&&(t=ua(t,r),i=r)}return Xt(i)}(e,t);if(!r.length)return null;if(!function(e){for(var t=e.parent;t;){if(wo(t))return!0;t=t.parent}return!1}(r[0]))return{node:r[0],offset:0};var i=nl(r[0]),o=function(e,t,n,r){var i=e.height;return t.y<0?{node:e,offset:0}:t.y>=i?{node:e,offset:Math.max(1,Ho(e))}:Bs(e,t,n,r)}(r[0],{x:t.x-i.left,y:t.y-i.top},n,{align:"left"});return o}var il=function(){function e(){(0,h.Z)(this,e),this.painter=void 0,this.maxContentWidth=1/0,this.rNode=void 0}return(0,d.Z)(e,[{key:"render",value:function(e){this.layout(e),this.paint()}},{key:"layout",value:function(e,t){var n;this.rNode.renderTree=e,this.painter=Ju(null!==(n=null==t?void 0:t.painter)&&void 0!==n?n:this.painter),this.rNode.layout({painter:this.painter,maxWidth:this.maxContentWidth})}},{key:"paint",value:function(e){var t;this.painter=Ju(null!==(t=null==e?void 0:e.painter)&&void 0!==t?t:this.painter),this.rNode.paint({painter:this.painter,area:null==e?void 0:e.area,colorConverter:null==e?void 0:e.colorConverter,interceptors:null==e?void 0:e.interceptors})}},{key:"hitTest",value:function(e){return this.painter?rl(this.rNode.renderTree,e,this.painter):null}},{key:"getRect",value:function(e){var t=this;if(!this.painter)return{left:0,top:0,width:0,height:0};if("startPoint"in e){var n=function(e){var t,n,r=e.startPoint,i=e.endPoint,o=[];return r&&i&&Array.prototype.push.apply(o,bs(r,i)),o.length||(r&&o.push({node:r.node,start:r.offset,end:r.offset}),!i||(t=r)===(n=i)||t&&n&&t.node===n.node&&t.offset===n.offset||o.push({node:i.node,start:i.offset,end:i.offset})),o}(e).map((function(e){return tl(e,t.painter)})).flat();return 1===n.length?n[0]:n}return nl(e)}},{key:"setColorToken",value:function(e){this.painter&&this.painter.setColorMap(e)}},{key:"renderTree",get:function(){return this.rNode.renderTree}}]),e}(),ol=new(function(){function e(){(0,h.Z)(this,e),this.command=[]}return(0,d.Z)(e,[{key:"collectPaintOptions",value:function(e,t){this.command.push({renderObject:t.renderTree,option:e})}},{key:"flushPaintOptions",value:function(e){var t,n=be(this.command);try{for(n.s();!(t=n.n()).done;){var r,i,o,a,s,u=t.value,l=u.renderObject,c=u.option,h=null!==(r=c.area)&&void 0!==r?r:{width:l.width,height:l.height,scrollLeft:0,scrollTop:0,x:0,y:0};ea(l,{colorConverter:c.colorConverter,painter:Ju(e),area:h},{interceptors:c.interceptors,flushAll:!1,translate:{x:null!==(i=null===(o=c.position)||void 0===o?void 0:o.x)&&void 0!==i?i:0,y:null!==(a=null===(s=c.position)||void 0===s?void 0:s.y)&&void 0!==a?a:0}})}}catch(e){n.e(e)}finally{n.f()}this.command=[],ra()}}]),e}()),al=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).call(this))).paintCollecter=ol,Yn(He.Component,Du),e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"collectPaintCommand",value:function(e){var t;null===(t=this.paintCollecter)||void 0===t||t.collectPaintOptions(e,this.rNode)}},{key:"flushPaintCommand",value:function(e){var t;null===(t=this.paintCollecter)||void 0===t||t.flushPaintOptions(e)}}]),t}(il),sl=function(){function e(){(0,h.Z)(this,e),this.renderTree=void 0,this.painter=void 0}return(0,d.Z)(e,[{key:"build",value:function(){}},{key:"layout",value:function(e){Yo(this.renderTree,{maxHeight:1/0,maxWidth:e.maxWidth,painter:e.painter})}},{key:"paint",value:function(e){var t,n,r=null!==(t=e.area)&&void 0!==t?t:{width:this.renderTree.width,height:this.renderTree.height,scrollLeft:0,scrollTop:0,x:0,y:0},i=null!==(n=e.painter)&&void 0!==n?n:this.painter;ea(this.renderTree,{colorConverter:e.colorConverter,painter:i,area:r},{interceptors:e.interceptors,flushAll:e.flushAll})}}]),e}();var ul,ll=function(){var e=new al;window.__ROADSTER_LITE_CONTEXT__=e;var t=new sl;return e.rNode=t,e},cl=function(){function e(e){this._typographer=e,this._insetSegPainter=null}return e.prototype.setInsetSegPainter=function(e){this._insetSegPainter=e},e.prototype.convertThemeColor=function(e,t){return e},e.prototype.paintLines=function(e,t,n){var r=this;e.save();var i=this._typographer.visualInfo().x;if(t&&(t.x+=i),!1!==n?(e.translate(i,0),this._typographer.context.paint({painter:e,colorConverter:function(e){return r.convertThemeColor(e,k.ColorThemeType.Color)}}),e.translate(-i,0)):this._typographer.context.collectPaintCommand({colorConverter:function(e){return r.convertThemeColor(e,k.ColorThemeType.Color)},position:t}),this._insetSegPainter){var o=this._typographer.stream().defaultStyle();this._typographer.lines().forEach((function(t){t.segs.forEach((function(t){t instanceof I.InsetSeg&&r._insetSegPainter.paint(e,t,o)}))}))}e.restore()},e.prototype.flush=function(e){var t;null===(t=this._typographer.context)||void 0===t||t.flushPaintCommand(e)},e}(),hl=function(){return hl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},hl.apply(this,arguments)};function dl(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}!function(e){e[e.Style=0]="Style",e[e.Inset=1]="Inset",e[e.Line=2]="Line",e[e.Align=3]="Align"}(ul||(ul={}));var fl=function(){function e(e){void 0===e&&(e={}),this._defaultStyle=e,this._str="",this._trees=[],this._isDirty=!1,this._posAndTypeComp=function(e,t){return e.pos===t.pos?e.type-t.type:e.pos-t.pos},this.updateDefaultStyle(this._defaultStyle),this._lines=new k.SortedArray(I.rgComp),this._lines.insert({rg:{from:0,to:0},isWindowsBreak:!1}),this._styles=new k.SortedArray(I.rgComp),this._aligns=new k.SortedArray(I.rgComp),this._insets=new k.SortedArray(I.posComp)}return e.prototype.removeAllDecorator=function(e,t){},e.prototype.str=function(){return this._str},e.prototype.updateStr=function(e){if(this._str!==e)if(this._isDirty=!0,this._str=e,this._lines.clear(),this._str)for(var t=e,n=0;t;){var r=t.indexOf("\n"),i=r<0?t.length:r,o="\r"===t.charAt(i-1),a={from:n,to:n+i-(o?2:1)};this._lines.insert({rg:a,isWindowsBreak:o});var s=i+1;n+=s,t=t.substring(s)}else this._lines.insert({rg:{from:0,to:0},isWindowsBreak:!1})},e.prototype.trees=function(){return this._isDirty&&this.updateTrees(),this._trees},e.prototype.lines=function(){return this._lines},e.prototype.styles=function(){return this._styles},e.prototype.aligns=function(){return this._aligns},e.prototype.insets=function(){return this._insets},e.prototype.addStyleAttr=function(e){this._isDirty=!0,this._styles.insert(e)},e.prototype.addAlignAttr=function(e){this._isDirty=!0,this._aligns.insert(e)},e.prototype.addInset=function(e){this._isDirty=!0,!1!==e.wrapText&&(e.wrapText=!0),this._insets.insert(e)},e.prototype.defaultStyle=function(){return this._defaultStyle},e.prototype.updateDefaultStyle=function(e){this._isDirty=!0;var t=this._defaultStyle=e;if(t.fontInfo){var n=t.fontInfo;n.fontFamily||(n.fontFamily=I.defaultFont.fontFamily),n.fontSize||(n.fontSize=I.defaultFont.fontSize),n.fontStyle||(n.fontStyle=I.defaultFont.fontStyle),n.fontWeight||(n.fontWeight=I.defaultFont.fontWeight)}else t.fontInfo=I.defaultFont;t.color||(t.color="black")},e.prototype.separateIter=function(){for(var e=new k.SortedArray(this._posAndTypeComp),t=new k.SortedArray(this._posAndTypeComp),n=this.lines().iter();n.next();){var r=n.value(),i=r.rg,o=r.isWindowsBreak;e.insert({pos:i.from,type:ul.Line,isWindowsBreak:o}),t.insert({pos:i.to,type:ul.Line,isWindowsBreak:o})}for(var a=this.styles().iter();a.next();){var s=a.value(),u=(i=s.rg,s.style);e.insert({pos:i.from,type:ul.Style,style:u}),t.insert({pos:i.to,type:ul.Style,style:u})}for(var l=this.aligns().iter();l.next();){var c=l.value(),h=(i=c.rg,{hAlign:c.hAlign,vAlign:c.vAlign});e.insert({pos:i.from,type:ul.Align,align:h}),t.insert({pos:i.to,type:ul.Align,align:h})}for(var d=this.insets().iter();d.next();){var f=d.value(),p=f.pos,v=f.width,g=f.height,_=f.customData;t.insert({pos:p-1,type:ul.Inset,inset:{pos:p,width:v,height:g,customData:_}})}return[e,t]},e.prototype.updateTrees=function(){var e=this;this._trees=[];for(var t,n,r,i=[],o=new Set,a=function(){var e={};return o.forEach((function(t){return Object.assign(e,t)})),e},s=function(n,r){if(!(n>=r)){var o=e._str.substring(n,r);if(""!==o&&"​"!==o&&(!t||t.type!==I.SegmentType.InsetSegment||" "!==o)){var s={type:I.SegmentType.TextSegment,from:n,to:r-1,text:o,style:a()};i.push(s),t=s}}},u=new Set,l=function(t){var n={};if(0===i.length&&void 0!==t){var r={type:I.SegmentType.TextSegment,from:t,to:t,text:"",style:a()};i.push(r)}u.forEach((function(e){return Object.assign(n,e)})),e._trees.push(hl(hl({},n),{segments:i})),i=[]},c=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}(this.separateIter(),2),h=c[0],d=c[1],f=h.iter().next(),p=d.iter().next(),v=0;f&&p&&p.value();){var g=f.value()?f.value().pos:Number.POSITIVE_INFINITY,_=p.value().pos;if(g<=_){(y=f.value().type)===ul.Style&&(s(v,g),o.add(f.value().style)),y===ul.Align&&u.add(f.value().align),v<g&&(v=g),f.next()}else{var y=p.value().type,m=_+1;if(s(v,m),y===ul.Inset&&(n=p.value().inset,r=void 0,r=hl({type:I.SegmentType.InsetSegment},n),i.push(r),t=r),y===ul.Line)l(v),m+=p.value().isWindowsBreak?2:1;if(y===ul.Style){var E=p.value().style;o.delete(E)}y!==ul.Align||p.isLast()||u.delete(p.value().align),v<m&&(v=m),p.next()}}i.length>0&&l()},e}(),pl=["mention","attachment"],vl=function(){function e(e,t,n){this._typographer=e,this._customRenderer=t,this._rImage=n}return e.prototype.getRenderTree=function(){var e=this,t=this._typographer.stream().trees(),n=t.map((function(t){return e.createInlineFlow(t)}));return this.createBlockFlow(n,t[0])},e.prototype.createBlockFlow=function(e,t){var n=this._typographer.options,r=n.width,i=n.height,o=n.wordWrap,a=this._typographer.stream().defaultStyle(),s=a.fontInfo,u=a.decoration,l=a.color,c=a.lineHeight,h=s||I.defaultFont,d=h.fontFamily,f=h.fontSize,p=h.fontWeight,v=h.fontStyle,g={};if(null!=r&&r!==Number.MAX_VALUE&&!0===o&&(g.weakWidth=r),null!=i&&i!==Number.MAX_VALUE&&(g.height=i),null!=d&&(g.fontFamily=d),null!=f&&(g.fontSize=f),null!=p&&(g.fontWeight=p),null!=v&&(g.fontStyle=v),null!=c&&(g.lineHeight="".concat(c,"px")),null!=l&&(g.fontColor=l),null!=u&&(u&I.TextDecoration.Bottom&&(g.underline=!0),u&I.TextDecoration.Mid&&(g.lineThrough=!0)),null!=t){var _=t.hAlign,y=t.vAlign;null!=_&&(g.alignHorizontal=this.getAlignHorizontal(_)),null!=y&&(g.alignVertical=this.getAlignVertical(y))}return el(Ou,{style:g,children:e})},e.prototype.getAlignHorizontal=function(e){switch(e){case I.HorizontalAlign.Center:return"center";case I.HorizontalAlign.Right:return"right";case I.HorizontalAlign.Left:default:return"left"}},e.prototype.getAlignVertical=function(e){return"baseline"},e.prototype.getSourceStyle=function(e){var t;return e.type===I.SegmentType.TextSegment?e.style:null===(t=e.customData)||void 0===t?void 0:t.style},e.prototype.getStyleFromSegment=function(e){var t,n=null!==(t=this.getSourceStyle(e))&&void 0!==t?t:{},r=n.color,i=n.fontInfo,o=n.decoration,a=n.cursor,s=i||{},u=s.fontFamily,l=s.fontSize,c=s.fontWeight,h=s.fontStyle,d={};return null!=u&&(d.fontFamily=u),null!=l&&(d.fontSize=l),null!=c&&(d.fontWeight=c),null!=h&&(d.fontStyle=h),null!=r&&(d.fontColor=r),null!=a&&(d.cursor=a.toLowerCase()),null!=o&&(d.underline=void 0,d.lineThrough=void 0,o&I.TextDecoration.Bottom&&(d.underline=!0),o&I.TextDecoration.Mid&&(d.lineThrough=!0)),d},e.prototype.createInlineFlow=function(e){var t=this,n=this._typographer.options,r=n.width,i=n.wordWrap,o=e.hAlign,a=e.vAlign,s={lineHeight:1.4};return null!=r&&r!==Number.MAX_VALUE&&!0===i&&(s.weakWidth=r),null!=o&&(s.alignHorizontal=this.getAlignHorizontal(o)),null!=a&&(s.alignVertical=this.getAlignVertical(a)),el(Su,{style:s,children:e.segments.map((function(e){return t.processSegment(e)}))})},e.prototype.processSegment=function(e){var t;if(null===(t=this._customRenderer)||void 0===t?void 0:t.segment){var n=this.getStyleFromSegment(e),r=this._customRenderer.segment(e,n,this._rImage);if(r)return r}switch(e.type){case I.SegmentType.TextSegment:return this.createText(e);case I.SegmentType.InsetSegment:return this.createDiv(e);default:return null}},e.prototype.createText=function(e){var t=e.text,n=(e.style||{}).customData,r={content:t,style:this.getStyleFromSegment(e)};return n&&n.seg&&pl.indexOf(n.seg.type)>-1&&(r.dir="none",r.disableRTL=!0),el(Ru,r)},e.prototype.createDiv=function(e){var t,n,r=e.width,i=e.height,o=e.customData;r=parseFloat(r),i=parseFloat(i),Number.isNaN(r)&&(r=0),Number.isNaN(i)&&(i=0);var a=el(Ru,{content:"",style:{fontSize:i/1.25}}),s={children:[a],style:{width:r,height:i}};return o&&o.seg&&pl.indexOf(o.seg.type)>-1&&(s.dir="ltr"),(null===(n=null===(t=null==o?void 0:o.style)||void 0===t?void 0:t.customData)||void 0===n?void 0:n.seg)&&pl.indexOf(o.style.customData.seg.type)>-1&&(a.props.content="​​",s.dir="ltr"),el(Iu,s)},e}(),gl=function(){function e(e,t,n){void 0===n&&(n=10),this._font="normal 400 12px Arial",this._fontFamily="Arial",this._fontSize=10,this.update(e,t,n)}return e.prototype.update=function(e,t,n){void 0===n&&(n=10),this._fontFamily=e,this._fontSize=n,this._font=(0,I.fontString)({fontSize:n,fontFamily:e,fontWeight:t})},e.prototype.measureWord=function(e){return $u.call(ml.measurerCtx,e,this._font).width},e.prototype.lineHeight=function(){return Zu.call(ml.measurerCtx,this._fontFamily,this._fontSize).fontHeight},e}(),_l=function(){function e(){this._paddingImgs=[]}return e.prototype.addImage=function(e,t){var n=this,r=I.ImageRef.newImage(e,"anonymous");if(!r.isLoaded){var i=new Promise((function(e,o){r.onLoaded((function(){var t=n._paddingImgs.indexOf(i);-1!==t&&n._paddingImgs.splice(t,1),e(r.element())})),r.onError((function(){var e=r.element(),n=t;n&&(!1===e.complete||e.width||n!==e.getAttribute("src"))||(t=void 0,n="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),e.setAttribute("src",n)}))}));this._paddingImgs.push(i)}return r.element()},e.prototype.clearImages=function(){this._paddingImgs=[]},Object.defineProperty(e.prototype,"images",{get:function(){return this._paddingImgs},enumerable:!1,configurable:!0}),e}();function yl(e,t,n){for(var r=[e];r.length;){var i=r.pop();if(t(i))return i;for(var o=i.children,a=void 0===o?[]:o,s=a.length-1;s>=0;s--)n&&n(a[s])||r.push(a[s])}return null}var ml=function(){function e(t){void 0===t&&(t={ellipsis:null}),this._context=ll(),this._lines=[],this._options={ellipsis:null},this._hasRTL=!1,this._stream=new fl,this._rImage=new _l,this._template=new vl(this,e._customRenderer,this._rImage),this.updateOptions(t)}return e.useCustomRenderer=function(t){this._enableRenderIcon&&(e._customRenderer=t)},e.enableRenderIcon=function(t){e._enableRenderIcon=t},e.createTypographer=function(t){return void 0===t&&(t={ellipsis:null}),new e(t)},e.createTypographyPainter=function(e){return new cl(e)},Object.defineProperty(e.prototype,"hasRTL",{get:function(){return this._hasRTL},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"context",{get:function(){return this._context},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rImage",{get:function(){return this._rImage},enumerable:!1,configurable:!0}),Object.defineProperty(e,"measurerCtx",{get:function(){return e._measurerCanvas.ctx()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),e.prototype.wordWrap=function(){return this._options.wordWrap||!1},e.prototype.posHitText=function(e){var t=e.clone().move(-this.getVisualX(this.lines()),0),n=this.context.hitTest(t);if(!n||!Ro(n.node))return null;var r=this.context.renderTree,i=r.left,o=r.top,a=r.width,s=r.height;if(!new k.FRect(i,o,a,s).containPoint(t))return null;var u,l=-1;return yl(this._context.renderTree,(function(e){return e===n.node?(l+=n.offset,!0):(Ro(e)&&(l+=e.props.content.length),wo(e)&&(u=e,l++),!1)})),{index:l,textNode:n.node,inlineFlow:u}},e.prototype.posHitSegInfo=function(e){var t,n,r=e.clone().move(-this.getVisualX(this.lines()),0),i=this.context.hitTest(r);if(!i)return null;for(var o=i.node;o;)wo(o)&&(n=o),o.props.segment&&(t=o),o=o.parent;if(!t||!n)return null;var a=t.props.segment;return{index:a.from+i.offset,textSegment:a,segmentNode:t,lineNode:n,renderPoint:i}},e.prototype.posHitChar=function(t){if(e._enableRenderIcon){var n=this.posHitSegInfo(t);if(!n)return-1;for(var r=n.index;"​"===this._stream.str().charAt(r);)r++;return r}var i=this.posHitText(t);if(!i)return-1;for(var o=i.index;"​"===this._stream.str().charAt(o);)o++;return o},e.prototype.posHitIcon=function(t){if(e._enableRenderIcon){var n=this.posHitSegInfo(t);if(n){var r=n.renderPoint;if(-1!==n.index&&!Ro(r.node)){var i=this._context.getRect({startPoint:r,endPoint:{node:r.node,offset:r.offset+1}});return Array.isArray(i)?null:new k.FRect(i.left+this.getVisualX(this.lines()),i.top,i.width,i.height)}}}return null},e.prototype.posHitSeg=function(t){var n;if(e._enableRenderIcon){var r=this.posHitSegInfo(t);if(r){var i=r.index,o=r.textSegment,a=r.segmentNode,s=r.lineNode,u=this._stream.trees(),l=this.getVisualX(u),c=a.left,h=a.top,d=a.width,f=a.height,p=s.left,v=s.top,g=o.text.length,_=new k.FRect(c+l+p,h+v,d,f);return new I.TextSeg(i,g,g,_,{})}return null}var y=this.posHitText(t);if(y){i=y.index;var m=y.textNode,E=y.inlineFlow,b=(u=this._stream.trees(),l=this.getVisualX(u),c=m.left,m.top),T=(d=m.width,f=m.height,p=E?E.left:0,v=E?E.top:0,(null===(n=m.props.content)||void 0===n?void 0:n.length)||0);_=new k.FRect(c+l+p,b+v,d,f);return new I.TextSeg(i,T,T,_,{})}var C=new k.SortedArray((function(e,t){return e.y<t.y?-1:e.y>t.y?1:0}),this._lines),S=C.lbound({y:t.y},!0);if(-1===S)return null;var w=C.at(S);if(w.y<=t.y&&t.y<w.y+w.height){var R=new k.SortedArray((function(e,t){return e.rect.y>t.rect.y&&e.rect.y<t.rect.y+t.rect.height?e.rect.x<t.rect.x?-1:e.rect.x>t.rect.x?1:0:e.rect.y<t.rect.y?-1:e.rect.y>t.rect.y+t.rect.height?1:0}),w.segs),A=R.lbound({rect:{x:t.x,y:t.y}},!0);if(-1===A)return null;var O=R.at(A);if(O.rect.x<=t.x&&t.x<O.rect.maxX)return O.rect.containPoint(t)?O:null}return null},e.prototype.charRect=function(e){if(e<0)return new k.FRect;var t,n=-1;if(yl(this._context.renderTree,(function(r){if(Ro(r)){var i=r.props.content.length;return n+i>=e?(t={node:r,offset:e-n},!0):(n+=i,!1)}return wo(r)&&n++,!1})),!t)return new k.FRect;var r=this._context.getRect({startPoint:t,endPoint:{node:t.node,offset:t.offset+1}});return Array.isArray(r)?new k.FRect:new k.FRect(r.left+this.getVisualX(this.lines()),r.top,r.width,r.height)},e.prototype.reset=function(){this._stream.updateStr(""),this._stream.removeAllDecorator(0,0)},e.prototype.stream=function(){return this._stream},e.prototype.isOverflowWithEllipsis=function(){return!1},e.prototype.updateOptions=function(e){this._options=e,e.defaultStyle&&this._stream.updateDefaultStyle(e.defaultStyle)},e.prototype.getVisualX=function(e){var t=this.options.width;if(!t||t===Number.MAX_VALUE)return 0;var n=this.context.renderTree.width;switch(e[0]&&e[0].hAlign||I.HorizontalAlign.Left){case I.HorizontalAlign.Right:return t-n;case I.HorizontalAlign.Center:return(t-n)/2;default:return 0}},e.prototype.visualInfo=function(){var e=this.context.renderTree,t=e.width,n=e.height,r=this.lines();return{x:this.getVisualX(r),width:t,height:n,lineCount:r.length,ellipsLine:null}},e.prototype.typography=function(){var t=this._template.getRenderTree();this.context.layout(t,{painter:e.measurerCtx}),this._processLines()},e.prototype._processLines=function(){this._lines=[];var e=this._context.renderTree.children,t=this._stream.trees();if(e&&t.length)for(var n=0,r=this.getVisualX(t),i=t.length;n<i;n++){var o=e[n];this._hasRTL=this._hasRTL||o.hasRTL;var a=t[n],s=o.children,u=a.segments;if(s&&u){for(var l=R(u),c=A(s),h=l.next(),d=c.next(),f=[];!h.done&&!d.done;){var p=d.value,v=p.left,g=p.top,_=p.width,y=p.height,m=new k.FRect(v+r+o.left,g+o.top,_,y),E=new I.InsetSeg(m,h.value);f.push(E),h=l.next(),d=c.next()}var b=o.top,T=o.width,C=o.height,S=a.hAlign,w=a.vAlign;this._lines.push({y:b,width:T,height:C,segs:f,from:0,hAlign:S||I.HorizontalAlign.Left,vAlign:w||I.VerticalAlign.Center,baseline:0})}}function R(e){var t,n;return dl(this,(function(r){switch(r.label){case 0:t=0,r.label=1;case 1:return t<e.length?(n=e[t]).type!==I.SegmentType.InsetSegment?[3,3]:[4,n]:[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}function A(e){var t,n;return dl(this,(function(r){switch(r.label){case 0:t=0,r.label=1;case 1:return t<e.length?"SimpleDiv"!==(n=e[t]).type?[3,3]:[4,n]:[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}},e.prototype.lines=function(){return this._lines},e.prototype._newMeasurer=function(e){var t=this._stream.defaultStyle().fontInfo,n=e.fontInfo||t;return new gl(n.fontFamily||t.fontFamily,n.fontWeight||I.FontWeight.normal,n.fontSize||t.fontSize)},e._measurerCanvas=k.FCanvasPool.borrowCanvas(null,void 0,!1),e._enableRenderIcon=!1,e}(),El=n("vsh_22485"),bl=n("vsh_8073"),Tl=n("vsh_22392"),Cl=n("vsh_99520"),Sl=n("vsh_47531"),wl=n("vsh_63738"),Rl=n("vsh_19044"),Al=n("vsh_26278"),Ol=function(e,t,n){var r;return el.apply(void 0,[e,Object.assign({},t,{key:n})].concat((0,a.Z)(null!==(r=[t.children].flat(1))&&void 0!==r?r:[])))},Ml=["type","icon","children","tag","wrapperStyle","iconStyle","tagStyle"],kl=["ctx","fontColor"],Il=["type","avatar","children","wrapperStyle","lineStyle","avatarWrapperStyle","avatarStyle"];var xl={borderRadius:"4px",cursor:"pointer"},Nl={margin:"0 2px"},Pl={width:"1em"},Ll={padding:"2px 4px 0px 4px",height:"calc(1em + 2px)"},Dl={fontSize:"0.7em"},Fl={readable:{wrapper:{fontColor:"--text-link-normal",$hover:{backgroundColor:"--udtoken-btn-text-bg-pri-hover"},$active:{backgroundColor:"--udtoken-btn-text-bg-pri-pressed"},$focus:{backgroundColor:"--udtoken-btn-text-bg-pri-focus"}},tagWrapper:{fontColor:"--udtoken-tag-text-s-blue",backgroundColor:"--udtoken-tag-bg-blue"}},unreadable:{wrapper:{fontColor:"--text-caption",$hover:{backgroundColor:"--udtoken-btn-text-bg-neutral-hover"},$active:{backgroundColor:"--udtoken-btn-text-bg-neutral-pressed"},$focus:{backgroundColor:"--udtoken-btn-text-bg-neutral-focus"}},tagWrapper:{fontColor:"--udtoken-tag-neutral-text-normal",backgroundColor:"--udtoken-tag-neutral-bg-normal"}}};function Bl(e){var t=e.type,n=void 0===t?"readable":t,r=e.icon,i=e.children,o=e.tag,a=e.wrapperStyle,s=void 0===a?{}:a,u=e.iconStyle,l=void 0===u?{}:u,c=e.tagStyle,h=void 0===c?{}:c,d=(0,Al.Z)(e,Ml),f=function(e){var t=e.type,n=e.wrapperStyle,r=e.iconStyle,i=e.tagStyle,o=Fl[t],a=o.wrapper,s=o.tagWrapper;return{wrapper:Object.assign({},xl,a,n),iconWrapper:Object.assign({},Nl,Pl,r),childrenWrapper:Object.assign({},Nl),tagWrapper:Object.assign({},Nl,Ll,s,i),tagInner:Object.assign({},Dl)}}({type:n,wrapperStyle:s,iconStyle:l,tagStyle:h}),p=f.wrapper,v=f.iconWrapper,g=f.childrenWrapper,_=f.tagWrapper,y=f.tagInner;return Ol(Tu,Object.assign({style:p},d,{children:Ol(Su,{disableRTL:!0,children:[r&&Ol(Tu,{style:v,children:r}),i&&Ol(Tu,{style:g,children:i}),o&&Ol(Tu,{style:_,children:Ol(Tu,{style:y,children:o})})]})}))}function Vl(e){return"string"==typeof e||"[object String]"===function(e){return Object.prototype.toString.call(e)}(e)}var Hl=Object.assign,Ul=function(e){var t=e.fit,n=e.position,r=e.crop,i=e.width,o=e.height,a=e.imgStyle,s=e.data;return Ol(Nu,{crop:r,source:s,style:Hl({width:i,height:o,fit:t,position:n},a)})};function Zl(e){var t;return Ul(Object.assign({width:"1em",height:"1em"},e,{imgStyle:Object.assign({baselineOffset:"-0.14em",fit:"contain"},null!==(t=e.imgStyle)&&void 0!==t?t:{})}))}var Wl=function(e,t){return e&&"currentcolor"===e.toLowerCase()?t:e};function jl(e,t,n){var r,i,o,a,s,u,l=n.fill,h=n.stroke,d=n.strokeWidth,f=n.fillRule,p=n.clipRule,v=n.color,g=n.strokeDasharray,_=n.strokeDashoffset,y=n.strokeLinecap,m=n.strokeLinejoin,E=n.strokeMiterlimit;e.save();var b=t.attributes;if(e.fillStyle=null!==(r=null!==(i=null!==(o=v)&&void 0!==o?o:l)&&void 0!==i?i:Wl(b.fill,v))&&void 0!==r?r:e.fillStyle,t.attributes["fill-opacity"]&&(e.globalAlpha=Number(b["fill-opacity"])),y&&(e.lineCap=y),m&&(e.lineJoin=m),E&&(e.miterLimit=E),g&&e.setLineDash(g),_&&(e.lineDashOffset=_),e.strokeStyle=h||(null!==(a=Wl(b.stroke,v))&&void 0!==a?a:e.strokeStyle),e.lineWidth=null!==(s=null!==(u=d)&&void 0!==u?u:b["stroke-width"]?parseFloat(b["stroke-width"]):void 0)&&void 0!==s?s:e.lineWidth,"path"===t.name){var T=t.attributes.d;if(T){var C,S,w,R,A,O,M=new Path2D(T);(h||b.stroke)&&e.stroke(M);var k=null!==(C=null===(S=t.attributes.bounds)||void 0===S?void 0:S.split(" "))&&void 0!==C?C:[],I=(0,c.Z)(k,2),x=I[0],N=I[1];e.translate(Number(null!==(w=x)&&void 0!==w?w:0),Number(null!==(R=N)&&void 0!==R?R:0)),e.fill(M,null!==(A=f)&&void 0!==A?A:b["fill-rule"]);var P=null!==(O=p)&&void 0!==O?O:b["clip-rule"];P&&e.clip(M,P)}}t.children.forEach((function(t){return jl(e,t,n)})),e.restore()}function Gl(e,t,n,r){var i=t.left,o=t.top,a=t.width,s=t.height;e.save(),e.fillStyle="transparent",e.translate(i,o);var u=n.attributes,l=u.width,h=u.height,d=u.viewBox,f=!1;if(l&&h){var p;e.save();var v=function(e){return e.split(/\s+|,/).map(Number)}(null!==(p=d)&&void 0!==p?p:""),g=(0,c.Z)(v,4),_=g[0],y=g[1],m=g[2],E=g[3],b=Number(l),T=Number(h);isNaN(m)||isNaN(E)||(b=m,T=E);var C=Math.min(a,s)/Math.max(b,T);isNaN(_)||isNaN(y)||e.translate(-_*C,-y*C),e.scale(C,C),f=!0}jl(e,n,r),f&&e.restore(),e.restore()}var zl=function(e){var t=e.src,n=e.width,r=e.height,i=e.svgStyle,o=e.selectable,a=Object.assign({width:n,height:r},i);if(t&&!Vl(t)){var s=t.attributes;a.width||(a.width=s.width),a.height||(a.height=s.height)}return Ol(Lu,{draw:function(e){var n,r=e.ctx,i=e.fontColor,o=(0,Al.Z)(e,kl),a=Hl({color:null!==(n=i)&&void 0!==n?n:"rgb(0, 0, 0)"});Vl(t)?function(e,t,n,r){var i,o=r.fillRule,a=r.stroke,s=r.strokeWidth,u=r.fill,l=r.color,c=r.strokeLinecap,h=r.strokeLinejoin,d=r.strokeMiterlimit,f=r.strokeDasharray,p=r.strokeDashoffset,v=new Path2D(n);e.save(),e.translate(t.left,t.top),u&&(e.fillStyle=null!==(i=l)&&void 0!==i?i:Wl(u,l),e.fill(v,o)),a&&s&&(c&&(e.lineCap=c),h&&(e.lineJoin=h),d&&(e.miterLimit=d),f&&e.setLineDash(f),p&&(e.lineDashOffset=p),e.strokeStyle=Wl(a,l),e.lineWidth=s,e.stroke(v)),e.restore()}(r,o,t,a):Gl(r,o,t,a)},style:a,selectable:o})},Yl={cursor:"pointer"},Xl={},Kl={borderRadius:1/0,padding:"2px 6px 2px 2px"},ql={borderRadius:"50%",margin:"0 4px 0 0"},$l={width:"calc(1.31em + 0.11px)",height:"calc(1.31em + 0.11px)",fit:"cover"},Jl={self:{wrapper:{borderRadius:1/0,padding:"2px 4px",fontColor:"--static-white",backgroundColor:"--function-info-500",$hover:{backgroundColor:"--function-info-400"},$active:{backgroundColor:"--function-info-600"},$focus:{backgroundColor:"--function-info-400"}}},readable:{wrapper:{borderRadius:"4px",padding:"0px 2px",fontColor:"--text-link-normal",$hover:{backgroundColor:"--udtoken-btn-text-bg-pri-hover"},$active:{backgroundColor:"--udtoken-btn-text-bg-pri-pressed"},$focus:{backgroundColor:"--udtoken-btn-text-bg-pri-focus"}}},unreadable:{wrapper:{borderRadius:"4px",padding:"0px 2px",fontColor:"--text-caption",$hover:{backgroundColor:"--udtoken-btn-text-bg-neutral-hover"},$active:{backgroundColor:"--udtoken-btn-text-bg-neutral-pressed"},$focus:{backgroundColor:"--udtoken-btn-text-bg-neutral-focus"}}}},Ql={self:{wrapper:{fontColor:"--static-white",backgroundColor:"--primary-pri-500",$hover:{backgroundColor:"--primary-pri-400"},$active:{backgroundColor:"--primary-pri-600"},$focus:{backgroundColor:"--primary-pri-400"}}},readable:{wrapper:{fontColor:"--text-link-normal",backgroundColor:"--primary-pri-100",$hover:{backgroundColor:"--primary-pri-200"},$active:{backgroundColor:"--primary-pri-300"},$focus:{backgroundColor:"--primary-pri-200"}}},unreadable:{wrapper:{fontColor:"--text-caption",backgroundColor:"--udtoken-tag-neutral-bg-normal",$hover:{backgroundColor:"--udtoken-tag-neutral-bg-normal-hover"},$active:{backgroundColor:"--udtoken-tag-neutral-bg-normal-press"},$focus:{backgroundColor:"--udtoken-tag-neutral-bg-normal-hover"}}}};function ec(e){var t=e.type,n=void 0===t?"readable":t,r=e.avatar,i=e.children,o=e.wrapperStyle,a=void 0===o?{}:o,s=e.lineStyle,u=void 0===s?{}:s,l=e.avatarWrapperStyle,c=void 0===l?{}:l,h=e.avatarStyle,d=void 0===h?{}:h,f=(0,Al.Z)(e,Il),p=function(e){var t=e.type,n=e.hasAvatar,r=e.wrapperStyle,i=e.lineStyle,o=e.avatarWrapperStyle,a=e.avatarStyle,s=(n?Ql:Jl)[t].wrapper;return{wrapper:Object.assign({},Yl,s,n?Kl:{},r),line:Object.assign({},Xl,i),avatarWrapper:Object.assign({},ql,o),avatarImageStyle:Object.assign({},$l,a)}}({type:n,hasAvatar:!!r,wrapperStyle:a,lineStyle:u,avatarWrapperStyle:c,avatarStyle:d}),v=p.wrapper,g=p.line,_=p.avatarWrapper,y=p.avatarImageStyle;return Ol(Tu,Object.assign({style:v},f,{children:Ol(Su,{disableRTL:!0,style:g,children:[r?Ol(Tu,{style:_,children:Ol(Ul,{data:r,fit:"fill",imgStyle:y})}):Ol(Ru,{content:"@"}),i]})}))}var tc=function(e){return"type"in e&&"attributes"in e};function nc(e){var t=Hl({width:"100%",height:"100%"},Vl(e)||tc(e)?{src:e}:e);if((this instanceof nc?this.constructor:void 0)||"provides"in t)throw new Error("Icon can not be invoked with 'new', and should not use in JSX.");return Ol(zl,Object.assign({},t))}function rc(e){var t,n=Vl(e)||tc(e)?{src:e}:e;return nc(Object.assign({height:"1em",width:"1em"},n,{svgStyle:Object.assign({baselineOffset:"-0.14em"},null!==(t=n.svgStyle)&&void 0!==t?t:{})}))}var ic,oc,ac,sc,uc,lc=n("vsh_73043");function cc(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return hc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hc(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function hc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dc(){return M.CURSOR_COLOR_PALETTE}var fc,pc,vc={SHELL:{FROZEN_AREA_OVERFLOW:"frozen_area_overflow",FROZEN_AREA_CHANGE:"frozen_area_change",RESIZE:"resize",SCROLL_TO_CELL:"scroll_to_cell"},CARD_VIEW:{CARD_SWITCHED:"card_switched",SWITCH_CARD_BY_ANIME:"switch_card_by_anime",REQUEST_EDIT:"request_edit",START_EDIT:"start_edit",END_EDIT:"end_edit",EDIT_STATE_CHANGED:"edit_state_changed",EDIT_ERROR:"edit_error",UPDATE_SHARE_ICON_BADGE:"update_share_icon_badge",SET_EDITOR_OPTIONS:"set_editor_options"},REF_VIEW:{SWIPE:"swipe",ROW_CLICK:"row_ck",SCROLLER_SCROLL:"scroll"},SHEET_VIEW:{ZOOM:"sheet_view_zoom",TEMP_CANCEL_FROZEN:"temp_cancel_frozen",UPDATE_PINCH_START_POS:"update_pinch_start_pos",UPDATE_PINCH_END_POS:"update_pinch_end_pos",SCROLL:"sheet_view_scroll"},SHEET_OPRATION:"sheet_opration",LOG:{EDIT_CELL_CONTENT:"edit_cell_content",CLICK_SHEET_HIDE:"click_sheet_hide",CLICK_SHEET_HIDE_CANCEL:"click_sheet_hide_cancel",CLIENT_ADJUST_RANGE_SIZE:"client_adjust_range_size",CLICK_FULL_SHEET_BTN:"click_full_sheet_btn",CLICK_SHEET_VIEW:"click_sheet_view",BEFORE_CELL_ACTIVE:"before_cell_active",AFTER_CELL_ACTIVE:"after_cell_active"}},gc="colorful",_c="".concat(gc,"-yellow"),yc="".concat(gc,"-red"),mc="".concat(gc,"-blue"),Ec="".concat(gc,"-green"),bc="".concat(gc,"-purple"),Tc="".concat(gc,"-orange"),Cc="".concat(gc,"-wathet"),Sc="".concat(gc,"-turquoise"),wc="".concat(gc,"-carmine"),Rc=((0,N.getThemeColorByToken)("text-title"),(0,N.getThemeColorByToken)("text-placeholder"),(0,N.getThemeColorByToken)("ccmtoken-mindnote-highlightcolor-neutral"),(0,N.getThemeColorByToken)("ccmtoken-mindnote-highlightcolor-neutral")),Ac=(0,N.getThemeColorByToken)("text-link-hover"),Oc=((0,N.getThemeColorByToken)("N700-FG"),(0,N.getThemeColorByToken)("text-disabled"),(0,N.getThemeColorByToken)("N200-FG"),(0,N.getThemeColorByToken)("N50-FG"),(0,N.getThemeColorByToken)("N00-FG"),(0,N.getThemeColorByToken)("text-link-loading"),(0,N.getThemeColorByToken)("ccmtoken-doc-highlightcolor-green-solid"),(0,N.getThemeColorByToken)("illustration-yellow"),(0,N.getThemeColorByToken)("ccmtoken-doc-highlightcolor-red-solid"),(0,N.getThemeColorByToken)("N650-FG"),(0,N.getThemeColorByToken)("N200-FG"),(0,N.getAlphaColor)((0,N.getThemeColorByToken)("text-title"),.65),(0,N.getThemeColorByToken)("N50-FG"),(0,N.getAlphaColor)((0,N.getThemeColorByToken)("text-title"),.4),(0,N.getThemeColorByToken)("text-disabled"),(0,N.getThemeColorByToken)("N200-FG"),(0,N.getThemeColorByToken)("text-disabled"),(0,N.getAlphaColor)((0,N.getThemeColorByToken)("text-title"),.2),Rc),Mc=Ac,kc="var(--text-link-hover)",Ic=((0,N.getThemeColorByToken)("text-link-hover"),L().isMac?(0,N.getAlphaColor)((0,N.getThemeColorByToken)("N900-FG"),.1):(0,N.getAlphaColor)((0,N.getThemeColorByToken)("N900-FG"),.15)),xc=L().isMac?"var(--N900-FG, 0.1)":"var(--N900-FG, 0.15)",Nc=((0,N.getThemeColorByToken)("text-link-disabled"),(0,N.getThemeColorByToken)(_c),"var(--".concat(_c,")")),Pc=((0,N.getThemeColorByToken)("G500-FG"),(0,N.getThemeColorByToken)("N00-FG")),Lc=(0,N.getThemeColorByToken)(_c),Dc=(0,N.getThemeColorByToken)("var(--function-danger-content-default)"),Fc=((0,N.getThemeColorByToken)("var(--function-danger-on-danger-fill)"),Mc),Bc=kc,Vc=((0,N.getThemeColorByToken)("text-link-hover"),(0,N.getAlphaColor)((0,N.getThemeColorByToken)("text-title"),.1),(0,N.getThemeColorByToken)("illustration-wathet"),"crossLightGray"),Hc="crossLightBlue",Uc="crossLightGreen",Zc="crossLightPurple",Wc="crossLightYellow",jc="crossLightRed",Gc="crossGray",zc="crossBlue",Yc="crossGreen",Xc="crossPurple",Kc="crossYellow",qc="crossRed",$c="var(--R600-FG)",Jc=(0,N.getThemeColorByToken)("N00-FG"),Qc=(0,N.getAlphaColor)((0,N.getThemeColorByToken)("R600-FG"),.1),eh=(0,N.getAlphaColor)((0,N.getThemeColorByToken)("B500-FG"),.1),th=(0,N.getThemeColorByToken)("B500-FG"),nh=.12,rh=.55,ih=(ic={},(0,g.Z)(ic,Vc,"var(--N500, ".concat(nh,")")),(0,g.Z)(ic,Hc,"var(--".concat(mc,", ").concat(nh,")")),(0,g.Z)(ic,Uc,"var(--".concat(Ec,", ").concat(nh,")")),(0,g.Z)(ic,Zc,"var(--".concat(bc,", ").concat(nh,")")),(0,g.Z)(ic,Wc,"var(--".concat(_c,", ").concat(nh,")")),(0,g.Z)(ic,jc,"var(--".concat(yc,", ").concat(nh,")")),(0,g.Z)(ic,Gc,"var(--N500, ".concat(rh,")")),(0,g.Z)(ic,zc,"var(--".concat(mc,", ").concat(rh,")")),(0,g.Z)(ic,Yc,"var(--".concat(Ec,", ").concat(rh,")")),(0,g.Z)(ic,Xc,"var(--".concat(bc,", ").concat(rh,")")),(0,g.Z)(ic,Kc,"var(--".concat(_c,", ").concat(rh,")")),(0,g.Z)(ic,qc,"var(--".concat(yc,", ").concat(rh,")")),ic),oh=(oc={},(0,g.Z)(oc,Vc,lc("LarkCCM_Sheets_ColorPalette_LightGray_Tooltip")),(0,g.Z)(oc,Hc,lc("LarkCCM_Sheets_ColorPalette_LightBlue_Tooltip")),(0,g.Z)(oc,Uc,lc("LarkCCM_Sheets_ColorPalette_LightGreen_Tooltip")),(0,g.Z)(oc,Zc,lc("LarkCCM_Sheets_ColorPalette_LightPurple_Tooltip")),(0,g.Z)(oc,Wc,lc("LarkCCM_Sheets_ColorPalette_LightYellow_Tooltip")),(0,g.Z)(oc,jc,lc("LarkCCM_Sheets_ColorPalette_LightRed_Tooltip")),(0,g.Z)(oc,Gc,lc("LarkCCM_Sheets_ColorPalette_Gray_Tooltip")),(0,g.Z)(oc,zc,lc("LarkCCM_Sheets_ColorPalette_Blue_Tooltip")),(0,g.Z)(oc,Yc,lc("LarkCCM_Sheets_ColorPalette_Green_Tooltip")),(0,g.Z)(oc,Xc,lc("LarkCCM_Sheets_ColorPalette_Purple_Tooltip")),(0,g.Z)(oc,Kc,lc("LarkCCM_Sheets_ColorPalette_Yellow_Tooltip")),(0,g.Z)(oc,qc,lc("LarkCCM_Sheets_ColorPalette_Red_Tooltip")),oc),ah={normal:(0,N.getThemeColorByToken)("N50-BG"),embed:(0,N.getThemeColorByToken)("N00-BG")},sh="var(--N50-BG)",uh="var(--N00)",lh=((0,N.getAlphaColor)((0,N.getThemeColorByToken)("B500-BG"),.06),"var(--B500-BG, 0.06)"),ch=(0,N.getThemeColorByToken)("text-caption"),hh="var(--text-caption)",dh=(0,N.getThemeColorByToken)("ccmtoken-mindnote-highlightcolor-neutral"),fh=(0,N.getThemeColorByToken)("N500-BG"),ph=1,vh={color:Ic,width:ph},gh={color:xc,width:ph},_h={color:"var(--text-link-disabled)",width:1},yh={color:(0,N.getThemeColorByToken)("N800-FG"),width:ph},mh={color:xc,width:ph},Eh={color:Nc,width:2},bh={color:"var(--text-link-hover)",width:1},Th={color:"var(--B300)",width:1},Ch=((0,N.getThemeColorByToken)("text-disabled"),"var(--text-disabled)"),Sh=2,wh=((0,N.getAlphaColor)((0,N.getThemeColorByToken)("text-title"),.4),{offsetX:0,offsetY:0,color:"var(--text-title, 0.4)",blur:16}),Rh=2,Ah=((0,N.getAlphaColor)((0,N.getThemeColorByToken)("bg-tips"),.1),{color:Fc,width:Rh}),Oh={color:kc,width:Rh},Mh={color:(0,N.getThemeColorByToken)("N00-FG"),width:1},kh=((0,N.getAlphaColor)((0,N.getThemeColorByToken)("B500-BG"),.06),"var(--B500-FG, 0.06)"),Ih={color:(0,N.getThemeColorByToken)("primary-pri-500"),width:2},xh={color:Bc,width:1},Nh={color:Bc,width:1},Ph={color:Bc,width:1},Lh={color:"var(--G500-BD)",width:2},Dh=(0,N.getThemeColorByToken)("G500-FG"),Fh=(0,N.getAlphaColor)((0,N.getThemeColorByToken)("colorful-green"),.1),Bh={color:(0,N.getThemeColorByToken)("N00-FG"),width:2},Vh={color:Dh,width:1},Hh=(0,N.getAlphaColor)((0,N.getThemeColorByToken)(_c),.1),Uh={color:Pc,width:2},Zh={color:Lc,width:1},Wh={color:Pc,width:2},jh={color:Dc,width:1},Gh=(0,N.getAlphaColor)((0,N.getThemeColorByToken)("function-danger-500"),.1),zh={color:"var(--illustration-wathet)",width:2},Yh=((0,N.getAlphaColor)((0,N.getThemeColorByToken)("B500-BG"),.2),(0,N.getAlphaColor)((0,N.getThemeColorByToken)(yc),.45)),Xh=(0,N.getAlphaColor)((0,N.getThemeColorByToken)(_c),.45),Kh=((0,N.getAlphaColor)((0,N.getThemeColorByToken)(_c),.25),"var(--".concat(_c,", 0.25)"));(pc=fc||(fc={}))[pc.Level0=0]="Level0",pc[pc.Level1=100]="Level1",pc[pc.Level2=200]="Level2",pc[pc.Level3=300]="Level3",pc[pc.Level4=400]="Level4",pc[pc.Level5=500]="Level5",pc[pc.Level6=600]="Level6",pc[pc.Level7=700]="Level7",pc[pc.Level8=800]="Level8",pc[pc.Level9=900]="Level9",pc[pc.Level10=1e3]="Level10";(0,N.getThemeColorByToken)("ccmtoken-mindnote-highlightcolor-neutral"),(0,N.getThemeColorByToken)("text-disabled");var qh="var(--ccmtoken-mindnote-highlightcolor-neutral)",$h="var(--text-disabled)",Jh=((0,N.getThemeColorByToken)("bg-body"),"var(--bg-body)"),Qh={borderRight:Oh,background:lh,zindex:200},ed={borderBottom:Oh,background:lh,zindex:200},td=((0,N.getAlphaColor)((0,N.getThemeColorByToken)("bg-body"),.2),{borderBottom:Oh,background:"var(--bg-body, 0.2)",zindex:200}),nd=((0,N.getAlphaColor)((0,N.getThemeColorByToken)("bg-body"),.2),{borderRight:Oh,background:"var(--bg-body, 0.2)",zindex:200}),rd={x:3,y:3,width:6,height:6,border:Mh,background:Fc},id={x:3,y:3,width:6,height:6,border:{color:"var(--N00-FG)",width:1},background:Bc},od=12,ad=12,sd=((0,N.getThemeColorByToken)("N00-FG"),{width:12,height:12,border:{width:1.5,color:"var(--N00-FG)"},background:kc}),ud=0,ld=0,cd=50,hd=24,dd=12,fd=4,pd={backColor:Xh},vd={backColor:Yh},gd=devicePixelRatio||1;x.GQK.isTest&&(gd=1);var _d={color:Fc,width:1},yd={color:Jc,width:2},md={color:$c,width:1},Ed={color:th,width:1},bd={color:$c,width:2,style:k.borderDash.dash,dashLine:[5,5].map((function(e){return e*gd}))},Td=(k.borderDash.dash,[5,5].map((function(e){return e*gd})),{color:Bc,width:1,style:k.borderDash.dash,dashLine:[5,5].map((function(e){return e*gd}))}),Cd=((0,N.getThemeColorByToken)("N700-BG"),{normal:{background:sh,borderRight:gh,borderBottom:gh},hover:{background:sh},selected:{background:lh},inView:{background:"var(--N700-BG)",borderRight:mh,borderBottom:mh},embed:{background:uh,borderRight:gh,borderBottom:gh}}),Sd={normal:{background:(0,N.getThemeColorByToken)("ccmtoken-doc-highlightcolor-neutral-solid")},hover:{background:fh},selected:{background:dh},embed:{background:(0,N.getAlphaColor)((0,N.getThemeColorByToken)("ccmtoken-doc-highlightcolor-neutral-solid"),.7)}},wd=(I.HorizontalAlign.Center,I.VerticalAlign.Center,(0,N.getThemeColorByToken)("B500-BG"),(0,N.getThemeColorByToken)("N00-FG"),I.VerticalAlign.Center,I.HorizontalAlign.Center,(0,N.getThemeColorByToken)("bg-body"),(0,N.getThemeColorByToken)("ccmtoken-doc-highlightcolor-red-solid"),(0,N.getThemeColorByToken)("ccmtoken-doc-highlightcolor-red-solid"),(0,N.getThemeColorByToken)("ccmtoken-doc-highlightcolor-red-solid"),(0,N.getThemeColorByToken)("ccmtoken-doc-highlightcolor-red-solid"),(0,N.getThemeColorByToken)("ccmtoken-doc-highlightcolor-red-solid"),I.VerticalAlign.Center,I.HorizontalAlign.Center,{width:18,height:10,triangleWidth:4,triangleHeight:6,padding:2,zindex:200,fillColor:(0,N.getThemeColorByToken)("icon-n1"),background:(0,N.getThemeColorByToken)("bg-body"),background_hover:(0,N.getThemeColorByToken)("ccmtoken-mindnote-highlightcolor-neutral")}),Rd="var(--icon-n1)",Ad="var(--bg-body)",Od="var(--ccmtoken-mindnote-highlightcolor-neutral)",Md=((0,N.getThemeColorByToken)("bg-body"),(0,N.getAlphaColor)((0,N.getThemeColorByToken)("shadow-default"),.1),I.VerticalAlign.Center,{fontFamily:"Arial",fontSize:14,lineHeight:20,padding:8,color:kc,radius:4,border:{width:1,color:"var(--ccmtoken-mindnote-highlightcolor-neutral)"},background:"var(--bg-body)",shadow:{offsetX:0,offsetY:4,blur:24,color:"var(--shadow-default, 0.1)"},vAlign:I.VerticalAlign.Center,maxWidth:470,maxHeight:136,wordWrap:!0,ellipsis:"..."});Number((.35*.75).toFixed(2)),Number(1.5.toFixed(2));function kd(e,t,n){return e._getSpanModel().find(t,n)||null}function Id(e,t,n){var r=kd(e,t,n);return r?{rowCount:r.rowCount(),colCount:r.colCount()}:{rowCount:1,colCount:1}}function xd(e){for(var t,n=e;null!==n.parent();)n=n.parent();return(null===(t=n)||void 0===t?void 0:t.dispatcher())||null}function Nd(e){var t=e.getSelections();if(t&&1!==t.length)return!1;var n=t[0],r=1===n.rowCount()&&1===n.colCount(),i=!!e.getSpans(n).length;return r||i}function Pd(e,t){var n,r;if(!e)return!1;var i=null!==(n=null===(r=e.getSpans(new x.e6w(t.row,t.col,1,1,e))[0])||void 0===r?void 0:r.toJSON())&&void 0!==n?n:t,o=(0,x.Pq3)(e,i.row,i.col),a=Nd(e),s=function(e,t){if(t){var n=e.getActiveCellIndex(),r=e.getSelections(),i=e.getSpan(t.row,t.col);return!(1!==r.length||!(0,O.default)(r[0].toJSON(),null==i?void 0:i.toJSON()))||!!n&&n.row===t.row&&n.column===t.col}}(e,t),u=!(null!=o&&o.fileToken)||e.parent.getService(H.Qh).checkAttachment(o.fileToken).previewable;return a&&s&&o&&u}var Ld=function(e){var t=null==e?void 0:e.getService(H.tb);return!!t&&t.resolve("isSegmentInteractionDisabled",!1)};function Dd(e,t){var n=t.spread,r=t.sheetId,i=t.width,o=t.height,a={width:i,height:o,x:0,y:0,col:0,row:0,padding:[0,0,0,0],timestamp:Date.now()},s=e.sheetView(),u=n.getSheetFromId(r),l=function(e){var t=e.sheetView(),n=t.getBRViewPort(),r=n.width,i=n.height,o=t.getDocRect(),a=o.width,s=o.height;return{width:Math.min(a,r),height:Math.min(s,i)}}(e),c=l.width,h=l.height,d=u.getColHeaderWidth(),f=u.getRowHeaderHeight(),p=s.getViewModel().getFrozenX(),v=s.getViewModel().getFrozenY(),g=(c-d-i)/2,_=(h-f-o)/2,y=s.getDocOffset(),m=y.offsetX,E=y.offsetY,b=m<g&&g<p?0:m+g-p,T=E<_&&_<v?0:E+_-v,C=s.getCellIndexByDocPos({x:b,y:T}),S=C.row,w=C.col,R=s.getCellRect(S,w),A=R.x,O=R.y;return a.x=Math.max(0,Math.min(b,g)+d-A),a.y=Math.max(0,Math.min(T,_)+f-O),a.col=w,a.row=S,a}var Fd=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments)))._sheetViewX=0,e._sheetViewY=0,e._realTimeSheetViewY=0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"getSheetViewX",value:function(){return this._sheetViewX}},{key:"setSheetViewX",value:function(e){this._sheetViewX!==e&&(this._sheetViewX=e,this.notifyListeners())}},{key:"getSheetViewY",value:function(){return this._sheetViewY}},{key:"setSheetViewY",value:function(e){this._sheetViewY!==e&&(this._sheetViewY=e,this.notifyListeners())}},{key:"getRealTimeSheetViewY",value:function(){return this._realTimeSheetViewY}},{key:"setRealTimeSheetViewY",value:function(e){this._realTimeSheetViewY!==e&&(this._realTimeSheetViewY=e,Tf.emit(vc.SHEET_VIEW.SCROLL))}},{key:"getShellUIConfig",value:function(){return this._shellUIConfig}},{key:"setShellUIConfig",value:function(e){this._shellUIConfig=e}}]),t}(k.ChangeNotifier);var Bd=function(e){return function(t,n){var r=Object.getOwnPropertyDescriptor(t,n);r&&!1===r.configurable||Object.defineProperty(t,n,Object.assign({},r,{set:function(e){throw new Error("App State cant be muted")},get:function(){return k.Provider.of(e,this)}}))}}(Fd),Vd={callOriginalEventHandler:!1};function Hd(e){var t=-1;return function(n){var r=n.prototype,i=r.event,o=new Set(e),a=!1;return r.event=function(e){return o.has(e.type)?(-1!==t&&t!==e.type||(t=e.type,a=i.call(this,e)),a):i.call(this,e)},n}}var Ud={C100:["#fdddef","#5c2542"],C200:["#f9aed9","#91376a"],C300:["#f57ac0","#ad407e"],C400:["#f14ba9","#cc4792"],C50:["#fef1f8","#421b31"],C500:["#f01d94","#e352a3"],C600:["#c71077","#ed66b3"],C700:["#9e1361","#ff91cf"],C800:["#7a0f4b","#ffbde2"],C900:["#520a32","#ffdbef"],W100:["#d9f3fd","#173742"],W200:["#b1e8fc","#225b70"],W300:["#7edafb","#2782a3"],W400:["#50cefb","#2ea5d1"],W50:["#ecf9fe","#142930"],W500:["#14c0ff","#42bdeb"],W600:["#049fd7","#5fd4fe"],W700:["#037eaa","#89dffe"],W800:["#006185","#c2eeff"],W900:["#004761","#def6ff"],T100:["#d5f6f2","#153d38"],T200:["#a9efe6","#23665d"],T300:["#64e8d6","#269687"],T400:["#14e1c6","#37b8a6"],T50:["#eafaf8","#162e2b"],T500:["#00d6b9","#41ccb9"],T600:["#04b49c","#5cdbca"],T700:["#078372","#7febdc"],T800:["#036356","#b7f7ef"],T900:["#024b41","#daf9f5"],L100:["#eef6c6","#495706"],L200:["#dfee96","#6d8205"],L300:["#d2e76a","#91ad02"],L400:["#c3dd40","#abc912"],L50:["#f7fae5","#2e3605"],L500:["#b3d600","#b9d627"],L600:["#8fac02","#c7e04d"],L700:["#667901","#d6ea75"],L800:["#495700","#e7f5a6"],L900:["#354200","#f6ffcc"],O100:["#feead2","#57330a"],O200:["#fed4a4","#845117"],O300:["#ffba6b","#bd7017"],O400:["#ffa53d","#de8218"],O50:["#fff5eb","#33210b"],O500:["#ff8800","#f2962c"],O600:["#de7802","#f5a54a"],O700:["#b26206","#fabc75"],O800:["#8f4f04","#ffd8ac"],O900:["#6b3900","#ffeace"],N00:["#ffffff","#0a0a0a"],B400:["#4e83fd","#2e65d1"],G500:["#34c724","#54c248"],P500:["#7f3bf5","#9762f5"],R500:["#f54a45","#f05b56"],N100:["#f2f3f5","#292929"],B100:["#e1eaff","#192a4c"],G100:["#d9f5d6","#1f471b"],P100:["#ece2fe","#361d61"],Y100:["#faf1d1","#574711"],R200:["#fbbfbc","#6b2827"],N300:["#dee0e3","#434343"],B200:["#bacefd","#203e78"],G300:["#8ee085","#339428"],P300:["#ad82f7","#6533bd"],Y400:["#fad355","#f0bb0a"],R400:["#f76964","#cc4743"],N500:["#8f959e","#757575"],B500:["#3370ff","#4c88ff"],G600:["#2ea121","#6dd162"],P600:["#6425d0","#a472fc"],Y500:["#ffc60a","#fac823"],R600:["#d83931","#fa7873"],N700:["#373c43","#e0e0e0"],B600:["#245bdb","#70a0ff"],G800:["#186010","#bdf0b8"],P800:["#380d82","#d3bafd"],Y600:["#dc9b04","#fcd456"],R800:["#812520","#fec6c3"],N900:["#1f2329","#ebebeb"],B800:["#133c9a","#b8cfff"],G900:["#124b0c","#d6f5d2"],P900:["#270561","#e3d4ff"],Y800:["#795101","#ffe694"],R900:["#621c18","#ffe0e0"]},Zd=["N00","B400","G500","P500","R500","N100","B100","G100","P100","R200","Y100","N300","B200","G300","P300","R400","Y400","N500","B500","G600","P600","R600","Y500","N700","B600","G800","P800","R800","Y600","N900","B800","G900","P900","R900","Y800"],Wd=function(e,t){var n=Ud[e];if(n)return n[t===U.ThemeType.LIGHT?0:1]},jd=function(){var e,t={},n=cc(Zd);try{for(n.s();!(e=n.n()).done;){var r=e.value;t[Ud[r][0]]=r}}catch(e){n.e(e)}finally{n.f()}return t}(),Gd=N.browser.isBytedanceApp&&(N.browser.isMobile||N.browser.isIPad),zd=new Map,Yd=new Map;function Xd(e,t){var n=(0,U.getCurrentThemeType)(),r=new(V())(e),i=r.getAlpha(),o=jd[r.toHexString()];if(o&&Zd.indexOf(o)>-1){var a=Wd(o,n),s=new(V())(a);return i<1&&s.isValid()?(s.setAlpha(i),s.toRgbString()):a}return function(e){if(Gd){var t=Yd.get(e);if(t)return t;var n=new(V())(e);return t=1!==n.getAlpha()?n.toHex8String():n.toHexString(),Yd.set(e,t),t}return e}((0,N.getDarkColor)(e,t))}function Kd(e,t){var n=(0,U.getCurrentThemeType)();if(n===U.ThemeType.DARK){var r="".concat(e.trim(),"-").concat(t,"-").concat(n);if(zd.has(r))return zd.get(r);var i=Xd(e,t);return zd.set(r,i),i}return e}var qd,$d=function(e){return Kd(e,N.ColorType.FOREGROUND)},Jd=function(e){return Kd(e,N.ColorType.BACKGROUND)},Qd=function(){var e=["00","100","200","300","400","500","600","700","800","900","1000"],t=["W","T","L","O","C"].map((function(t){return e.map((function(e){return"".concat(t).concat(e)}))})).flat(1),n=new Map;return t.forEach((function(e){var t=M[e];t&&n.set(String(t).toLowerCase(),e)})),n}(),ef=new Map,tf=function(e,t){ef.set(e,t)},nf={},rf=V().names||{};Object.keys(rf).forEach((function(e){var t=rf[e],n=6===t.length?t:function(e){return[0,1,2].map((function(t){return e[t].repeat(2)})).join("")}(t);nf[e.toLowerCase()]="#".concat(n).toLowerCase()})),function(e){e[e.VARIABLE=0]="VARIABLE",e[e.HEX=1]="HEX",e[e.RGB=2]="RGB",e[e.UNKNOWN=3]="UNKNOWN"}(qd||(qd={}));var of,af="var(--",sf=af.length,uf=["#","rgb"],lf=function(e,t){if(!uf.some((function(t){return e.startsWith(t)})))return e;var n=Object.entries(t).map((function(e){var t=(0,c.Z)(e,2),n=t[0],r=t[1];return"".concat(n,":").concat(r)})).join(",");return n?"".concat(e,";").concat(n):e},cf=function(e){var t=e.split(";"),n=(0,c.Z)(t,2),r=n[0],i=n[1],o=null==i?void 0:i.trim();if(!o)return{baseColor:r,richInfo:null};var a={};return o.split(",").map((function(e){return e.split(":").map((function(e){return e.trim()}))})).forEach((function(e){var t=(0,c.Z)(e,2),n=t[0],r=t[1],i=n.toLowerCase();"colortype"!==i?"alpha"!==i?a[n]=r:a.alpha=Number(r):a.colorType=r.toUpperCase()})),{baseColor:r,richInfo:a}},hf=function(e){var t=e.toLowerCase();return t.startsWith(af)?{value:e.slice(sf,-1),type:0}:t.startsWith("#")?{value:t,type:1}:t.startsWith("rgb")?{value:t,type:2}:t.startsWith("--")?{value:t.slice(2),type:0}:nf[e]?{value:nf[e],type:1}:{value:t,type:3}},df=(ac={},(0,g.Z)(ac,k.ColorThemeType.Color,N.ColorType.FOREGROUND),(0,g.Z)(ac,k.ColorThemeType.Background,N.ColorType.BACKGROUND),(0,g.Z)(ac,k.ColorThemeType.Border,N.ColorType.BORDER),ac),ff=new Map;function pf(){var e=(0,U.getCurrentThemeType)();of!==e&&(of=e,ff.clear())}var vf=new Map;function gf(e,t){if((0,U.getCurrentThemeType)()===U.ThemeType.LIGHT)return e;if(!vf.has(e)){var n=new(V())(e);vf.set(e,n.toHexString().toLowerCase())}var r=vf.get(e);return ef.has(r)?ef.get(r):Qd.has(r)?function(e){var t=(0,U.getCurrentThemeType)();return Wd(e,t)}(Qd.get(r)):Kd(e,t)}var _f,yf,mf=function(e,t){if("string"!=typeof e)return e;var n=ff.get(e);if(n)return n;var r=hf(e),i=r.value,o=r.type;if(0===o){var a=i.split(","),s=(0,c.Z)(a,2),u=s[0],l=s[1],h=(0,N.getThemeColorByToken)(u);if(l){var d=parseFloat(l.trim());h=(0,N.getAlphaColor)(h,d)}return ff.set(e,h),h}if(3===o)return i;var f=cf(i),p=f.baseColor,v=f.richInfo;if(!v)return gf(p,null==t?N.ColorType.FOREGROUND:df[t]);var g=v.colorType||N.ColorType.FOREGROUND,_="number"==typeof v.alpha&&1!==v.alpha,y=gf(p,g),m=_?(0,N.getAlphaColor)(y,v.alpha):y;return ff.set(e,m),m},Ef={},bf=function(e){if("string"!=typeof e)return e;var t=Ef[e];if(t)return t;var n=hf(e),r=n.value,i=n.type;if(0===i){var o=r.split(","),a=(0,c.Z)(o,2),s=a[0],u=a[1],l=Wd(s,U.ThemeType.LIGHT)||(0,N.getColor)(s,U.ThemeType.LIGHT);if(u){var h=parseFloat(u.trim());l=(0,N.getAlphaColor)(l,h)}return Ef[e]=l,l}if(3===i)return r;var d=cf(r),f=d.baseColor,p=d.richInfo;if(!p)return f;var v="number"==typeof p.alpha&&1!==p.alpha?(0,N.getAlphaColor)(f,p.alpha):f;return Ef[e]=v,v},Tf=new(F());!function(e){e.icon="wdk/icon"}(_f||(_f={})),function(e){e.comment="COMMENT_ICON"}(yf||(yf={}));var Cf=function(e){function t(e,n,r,i){var o;return(0,h.Z)(this,t),(o=(0,f.Z)(this,(0,p.Z)(t).call(this,e)))._getFvgImgUrl=n,o._drawSVG=r,o.type=i,o}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"clip",value:function(e,t,n,r){this._clip={dx:e,dy:t,dw:n,dh:r}}},{key:"clearClip",value:function(){this._clip=void 0}},{key:"fvgNode",value:function(){var e=(0,l.Z)((0,p.Z)(t.prototype),"fvgNode",this).call(this),n=this._cfg;return e.type=I.WdkFvgType.image,this._clip&&(e.cfg.x+=this._clip.dx,e.cfg.y+=this._clip.dy,e.cfg.width+=this._clip.dw,e.cfg.height+=this._clip.dh),n.color&&(e.cfg.color=n.color),n.background&&(e.cfg.background=n.background),n.opacity&&(e.cfg.opacity=n.opacity),e.cfg.imgUrl=this._getFvgImgUrl(this),e}},{key:"renderWidget",value:function(e,n){(0,l.Z)((0,p.Z)(t.prototype),"renderWidget",this).call(this,e,n);var r=this._cfg.x,i=this._cfg.y,o=this._cfg.width,a=this._cfg.height;try{if(e.save(),this._clip){var s=this._clip;e.rect(r,i,o,a),e.clip(),this._drawSVG(e,new k.FRect(r+s.dx,i+s.dy,o+s.dw,a+s.dh),this)}else this._drawSVG(e,new k.FRect(r,i,o,a),this);e.restore()}catch(e){}}},{key:"color",get:function(){return this._cleanProp("color")}},{key:"opacity",get:function(){return this._cleanProp("opacity")}}]),t}(k.FWidget),Sf=function(){function e(){(0,h.Z)(this,e)}return(0,d.Z)(e,[{key:"has",value:function(e,t,n){return!1}},{key:"widget",value:function(e,t,n){var r=e.sheet;if(this.has(e.sheet,t,n)){var i=this.getBaseWidget(r,t,n),o=this.iconSize();return i.updateByCfg({width:o,height:o,cursor:Ld(r.parent)?"default":"pointer",background:"transparent",imgUrl:this.icon(r,t,n),x:this.offsetX(),y:this.offsetY(),zindex:1}),this.addListener(i,r,t,n),i}return null}},{key:"getBaseWidget",value:function(e,t,n){return new I.FImage(null)}},{key:"anchor",value:function(){return"bottom"}},{key:"addListener",value:function(e,t,n,r){}},{key:"iconSize",value:function(){return 0}},{key:"background",value:function(){return(0,N.getThemeColorByToken)("bg-body")}},{key:"icon",value:function(e,t,n){return""}},{key:"offsetX",value:function(){return-2}},{key:"offsetY",value:function(){return-3}}]),e}();function wf(){return"data:image/svg+xml,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%3F%3E%0A%3Csvg%20width%3D%228px%22%20height%3D%228px%22%20viewBox%3D%220%200%208%208%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%0A%20%20%20%20%3Cg%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M0%2C0%20L8.00150342%2C0%20L8.00150342%2C8%20L8%2C8%20C3.581722%2C8%205.41083001e-16%2C4.418278%200%2C9.79717439e-16%20Z%22%20id%3D%22Rectangle-11%22%20fill%3D%22%23F9DA58%22%3E%3C%2Fpath%3E%0A%20%20%20%20%3C%2Fg%3E%0A%3C%2Fsvg%3E"}function Rf(e,t,n){var r=e.fillType;e.translate(t.x,t.y),e.fillStyle=(0,k.convertThemeColor)(n,"var(--colorful-yellow)"),e.fillType=k.ColorThemeType.Color,e.fill(new Path2D("M0,0 L8.00150342,0 L8.00150342,8 L8,8 C3.581722,8 5.41083001e-16,4.418278 0,9.79717439e-16 Z")),e.fillType=r}var Af,Of,Mf,kf,If,xf,Nf,Pf,Lf=function(e){function t(){return(0,h.Z)(this,t),(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"has",value:function(e,t,n){var r=e.getComments(t,n);if(r)for(var i=0;i<r.length;i++)if(!r[i].isResolved)return!0;return!1}},{key:"widget",value:function(e,t,n){if(this.has(e.sheet,t,n)){var r=new Cf(null,wf,Rf,"COMMENT_ICON"),i=this.iconSize()-1;return r.updateByCfg({width:i,height:i,cursor:"pointer",background:"transparent",x:this.offsetX(),y:this.offsetY(),zindex:1}),r}return null}},{key:"anchor",value:function(){return"top"}},{key:"iconSize",value:function(){return 8}},{key:"background",value:function(){return(0,N.getAlphaColor)((0,N.getThemeColorByToken)("bg-tips"),0)}},{key:"offsetX",value:function(){return 2}},{key:"offsetY",value:function(){return-2}}]),t}(Sf),Df=16,Ff=1e3,Bf=20,Vf=0,Hf=0;!function(e){e.NONE="NONE",e.FOCUS_ON_BLOCK="FOCUS_ON_BLOCK",e.COVER_ON_BLOCK="COVER_ON_BLOCK"}(Af||(Af={})),function(e){e.CellValue="sheet/cell-value"}(Of||(Of={})),function(e){e[e.None=0]="None",e[e.Underline=1]="Underline",e[e.Full=2]="Full"}(Mf||(Mf={})),function(e){e[e.PreResize=42]="PreResize",e[e.HeaderEnterEvent=43]="HeaderEnterEvent",e[e.HeaderLeaveEvent=44]="HeaderLeaveEvent",e[e.DragDropEvent=10]="DragDropEvent"}(kf||(kf={})),function(e){e[e.Row=0]="Row",e[e.Col=1]="Col"}(If||(If={})),function(e){e[e.DragFilling=43]="DragFilling",e[e.DragFilled=44]="DragFilled"}(xf||(xf={})),function(e){e.CELLS_0_3W="cells_0_3W",e.CELLS_3W_6W="cells_3W_6W",e.CELLS_6W_9W="cells_6W_9W",e.CELLS_9W="cells_9W"}(Nf||(Nf={})),function(e){e[e.Center=0]="Center",e[e.Top=1]="Top",e[e.Left=2]="Left",e[e.Custom=3]="Custom"}(Pf||(Pf={}));var Uf=["background_layer","data_clean_background","highlight_layer","comment_layer","protected_edit_cell_layer","protected_cell_layer","image_layer","conditional_format_layer","data_bar","typography_layer","invalidate_layer","header_text_layer","icon_set_layer","compatibility_document_layer","stroke_layer","unhide_icon_layer","filter_icon_layer","filter_sort_icon_layer","collapse_cion_layer","dropdown_icon_layer","comment_icon_layer","tip_icon_layer","inset_icon_layer","card_border_layer","read_more_layer","list_layer","float_image","reminder_icon_layer","color_scale_layer","content","float_block_image","invalidate_icon","group_hide_line","sparkline_layer","cell_note_icon"],Zf={scroller:{gap:8,thin:4,autoHide:!1},scrollerTrack:{enable:!0},selection:{cornerWidgetType:k.FBase,normalSelectionBorderWidth:2},corner:{triangleEnable:!0},header:{borderEnable:!0,swapCanvasEnable:!0},unHide:{bgColor:wd.background},floatImage:{editable:!0},image:{isFetchImage:!1},contentLayer:{simulateEnabled:!0,clickEventEnabled:!0},invalidate:{widthOffset:0},dropdown:{iconSize:12}},Wf={defaultZoom:1,padding:{bottom:72,right:Df+8+72},header:{bgColor:sh}},jf={padding:{bottom:Hf,right:Vf}},Gf=(sc={},(0,g.Z)(sc,U.ThemeType.LIGHT,0),(0,g.Z)(sc,U.ThemeType.DARK,1),sc),zf={conditionFormat:{R400:["#f76964","#cc4743"],"Y300-FG":["#f7dc82","#f7da7d"],"R400-BG":["#f76964","#8e0c07"],"Y400-BG":["#fad355","#987504"],"Y500-BG":["#ffc60a","#c69800"],"Y100-BG":["#faf1d1","#4a3c08"],"R50-BG":["#fef1f1","#390404"],"Y800-BG":["#795101","#614101"],"G400-BG":["#62d256","#478e26"],"N500-BG":["#8f959e","#585858"],"N600-BG":["#646a73","#565656"],"N700-BG":["#373c43","#313131"],"G100-BG":["#d9f5d6","#204210"]},reminder:{"text-default":["#3370ff","#4C88FF"],"icon-default":["#8f959e","#757575"]},cardMode:{"line-border-card":["#dee0e3",(0,N.getAlphaColor)("#ebebeb",.15)],"icon-n1":["#2b2f36","#e8e8e8"],"fill-disabled":["#bbbfc4","#5f5f5f"],"text-caption":["#646a73","#a6a6a6"]}};function Yf(e,t){var n,r,i=Gf[(0,U.getCurrentThemeType)()];return(null===(n=zf[e])||void 0===n||null===(r=n[t])||void 0===r?void 0:r[i])||""}var Xf=function(){function e(){(0,h.Z)(this,e),this.injectableStaticConfig=(0,R.default)(Zf),this.configs=new Map}return(0,d.Z)(e,[{key:"register",value:function(e,t){this.configs.set(e,t)}},{key:"resolve",value:function(e){if(!this.configs.has(e))throw new Error("no config found for ".concat(e));return this.configs.get(e)}},{key:"unregister",value:function(e){this.configs.delete(e)}},{key:"getUIConfigByFObj",value:function(e){var t=k.Faster.findFaster(e);if(!t)throw new Error("faster is not available");var n=t.app();if(!n)throw new Error("app is not running");return Kf.resolve(n.UID)}}]),e}(),Kf=new Xf,qf=function(){function e(){(0,h.Z)(this,e)}return(0,d.Z)(e,null,[{key:"getColor",value:function(t){var n=e._cache.get(t);return n||(n=V()(t),e._cache.set(t,n),n)}},{key:"clear",value:function(){e._cache.clear()}}]),e}();qf._cache=new Map,k.FApp.onAppExit(qf.clear);var $f=L().isMobile||L().isIPad?20:16,Jf=[1,2,1,2],Qf=[3,2,3,2],ep=[0,6,0,6],tp=(uc={},(0,g.Z)(uc,Z.K6s.REMINDER,[0,8,0,4]),(0,g.Z)(uc,Z.K6s.MENTION,[0,4,0,4]),uc),np=[1.5,4,0,4],rp=12,ip="M5.75739 9.16652L2.34652 4.47657C2.24907 4.34257 2.27869 4.15495 2.41269 4.0575C2.46396 4.02021 2.52574 4.00012 2.58914 4.00012L9.41088 4.00012C9.57656 4.00012 9.71088 4.13443 9.71088 4.30012C9.71088 4.36352 9.69079 4.42529 9.6535 4.47657L6.24263 9.16652C6.14518 9.30051 5.95755 9.33014 5.82356 9.23268C5.79817 9.21422 5.77585 9.1919 5.75739 9.16652Z",op=function(e){function t(){return(0,h.Z)(this,t),(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))}return(0,v.Z)(t,e),t}(Cf);function ap(e,t){var n=(0,N.getThemeColorByToken)("ccmtoken-mindnote-highlightcolor-neutral"),r=.2;switch(e){case"light":n=(0,N.getThemeColorByToken)("N00-FG"),r=1;break;case"dark":n=(0,N.getThemeColorByToken)("text-placeholder"),r=1;break;case"inValid":n=(0,N.getThemeColorByToken)("R500-FG"),r=1;break;case"inValidInRed":n=(0,N.getThemeColorByToken)("N1000-FG"),r=.5}if(t){switch(e){case"dark":case"light":n=(0,N.getThemeColorByToken)("text-link-hover"),r=1;break;case"inValid":case"inValidInRed":n=(0,N.getThemeColorByToken)("R300-FG"),r=1}n=qf.getColor(n).toHexString()}return{color:n,opacity:r}}function sp(e,t,n,r){var i=e.getStyle(t,n),o=e.getDropdown(t,n);return o&&o.isValid?i.backColor&&qf.getColor(i.backColor).isDark()?ap("light",r):ap("dark",r):i.backColor&&function(e){return V().readability("red",e)/21}(i.backColor)<.07?ap("inValidInRed",r):ap("dark",r)}function up(e){return"data:image/svg+xml,"+encodeURIComponent(function(e,t){return'<svg width="'.concat(rp,'" height="').concat(rp,'" viewBox="0 0 ').concat(rp," ").concat(rp,'" fill="none" xmlns="http://www.w3.org/2000/svg">    <path fill-rule="evenodd" clip-rule="evenodd" d="').concat(ip,'" fill="').concat(e,'" fill-opacity="').concat(t,'"/>  </svg>')}(e.color,e.opacity))}function lp(e,t,n){var r=n.color,i=Kf.injectableStaticConfig.dropdown.iconSize,o=i/rp,a=($f-i)/2;e.translate(t.x+a,t.y+a),e.scale(o,o),e.fillStyle=r,e.fill(new Path2D(ip),"evenodd")}var cp=function(e){function t(){return(0,h.Z)(this,t),(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"has",value:function(e,t,n){var r=e.getDataValidation(t,n);return Boolean(r&&(0,x.Ju9)(r))}},{key:"widget",value:function(e,t,n){var r=e.sheet;if(!r.isCellEditable(t,n))return null;if(this.has(e.sheet,t,n)){var i=this.iconSize(),o=new op(null,up,lp),a=sp(r,t,n,!1),s=a.color,u=a.opacity;return o.updateByCfg({width:i,height:i,cursor:"pointer",background:"transparent",x:this.offsetX(),y:this.offsetY(),zindex:1,color:s,opacity:u}),this.addListener(o,r,t,n),o}return null}},{key:"anchor",value:function(){return"bottom"}},{key:"iconSize",value:function(){return $f}},{key:"addListener",value:function(e,t,n,r){e.addListener(k.FEventType.Click,(function(){return t._trigger(Z.zW2.ShowDropdown,{sheet:t,row:n,col:r}),!0})),e.addListener(k.FEventType.MouseEnter,(function(){var i=sp(t,n,r,!0),o=i.color,a=i.opacity;return e.updateByCfg({color:o,opacity:a}),!0})),e.addListener(k.FEventType.MouseLeave,(function(){var i=sp(t,n,r,!1),o=i.color,a=i.opacity;return e.updateByCfg({color:o,opacity:a}),!0})),e.addListener(k.FEventType.Dblclick,(function(){return!0}))}}]),t}(Sf);function hp(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==("undefined"==typeof Reflect?"undefined":(0,u.Z)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function dp(e,t){return function(n,r){t(n,r,e)}}"function"==typeof SuppressedError&&SuppressedError;var fp=function(e){function t(){return(0,h.Z)(this,t),(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))}return(0,v.Z)(t,e),t}(I.FImage);fp=hp([Hd([k.FEventType.Tap,k.FEventType.Click])],fp);var pp=function(e){function t(){return(0,h.Z)(this,t),(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"has",value:function(e,t,n){var r=e.viewsModel,i=r.activeView,o=Boolean(i),a=Boolean(null==i?void 0:i.filterModel.filterRange),s=r.isInPersonalTempView();return!(o&&a&&!s)&&(!Boolean(e.filterModel.getFilterButton(t,n))&&void 0!==Z.Ps3.pivotTableHelper.getFilterSort(e,t,n))}},{key:"anchor",value:function(){return"bottom"}},{key:"getBaseWidget",value:function(e,t,n){return new fp(null)}},{key:"addListener",value:function(e,t,n,r){var i=this,o=function(e){var i,o=t.getPivotTableManager().getCellInfo(n,r),a=Z.Ps3.pivotTableHelper.getFilterSort(t,n,r);"corner"!==(null==o?void 0:o.areaType)&&"colDim"!==(null==o?void 0:o.areaType)&&"page"!==(null==o?void 0:o.areaType)||(i=o.fieldName);var s=t.getNotExpendCellRect(n,r);return t._trigger(Z.zW2.ShowFilterSort,{source:"canvas",sheet:t,btnInfo:{status:a,fieldName:i,row:n,col:r},cellRect:{x:s.x,y:s.y,width:s.width,height:s.height}}),!0};e.addListener(k.FEventType.Tap,o),e.addListener(k.FEventType.Click,o),e.addListener(k.FEventType.Dblclick,(function(){return!0})),e.addListener(k.FEventType.DoubleTap,(function(){return!0})),e.addListener(k.FEventType.MouseEnter,(function(){return e.updateByCfg({imgUrl:i.icon(t,n,r,!0)}),!0})),e.addListener(k.FEventType.MouseMove,(function(e){return e.srcEventPreventDefault(),!0})),e.addListener(k.FEventType.MouseLeave,(function(){return e.updateByCfg({imgUrl:i.icon(t,n,r,!1)}),!0}))}},{key:"iconSize",value:function(){return 16}},{key:"icon",value:function(e,t,n,r){return function(e,t,n){var r;switch(e){case 16:r='<svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">      <rect fill="'.concat(n,'" width="18" height="18" rx="2"/>      <path fill="').concat(t,'" d="M16 3H2L7.5 8V13L10.5 15.5V8L16 3Z"/>      </svg>');break;case 2:r='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">      <rect fill="'.concat(n,'" width="16" height="16" rx="2"/>      <path fill="').concat(t,'" d="M10.5 2.66699H9.59812C9.59812 2.66699 9.38875 2.73518 9.34932 2.83842L7.51729 7.63745C7.45065 7.81202 7.57957 7.99922 7.76643 7.99922H8.25521C8.36662 7.99922 8.46629 7.92996 8.50514 7.82555L8.83724 6.933H11.258L11.5895 7.82627C11.6283 7.9308 11.728 8.00017 11.8395 8.00017H12.3326C12.5195 8.00017 12.6484 7.81294 12.5817 7.63837L10.7488 2.83842C10.7094 2.73518 10.6104 2.66699 10.5 2.66699ZM10.8624 5.86652H9.23042L10.0328 3.70859H10.0579L10.8624 5.86652Z"/>      <path fill="').concat(t,'" d="M7.77449 9.06699C7.77449 8.91972 7.89388 8.80032 8.04116 8.80032H12.3024C12.4497 8.80032 12.5691 8.91972 12.5691 9.06699V9.41888C12.5691 9.49588 12.5358 9.56912 12.4778 9.61976L9.44362 12.2689H12.3024C12.4497 12.2689 12.5691 12.3883 12.5691 12.5355V13.067C12.5691 13.2143 12.4497 13.3337 12.3024 13.3337H8.04116C7.89388 13.3337 7.77449 13.2143 7.77449 13.067V12.5802C7.77449 12.5032 7.80781 12.4299 7.86586 12.3793L10.7474 9.86566H8.04116C7.89388 9.86566 7.77449 9.74627 7.77449 9.59899V9.06699Z"/>      <path fill="').concat(t,'" d="M3.31361 10.333H4.66607V3.59967C4.66607 3.4524 4.78546 3.33301 4.93274 3.33301H5.3994C5.54668 3.33301 5.66607 3.4524 5.66607 3.59967V13.1796C5.66607 13.4379 5.33564 13.5453 5.18374 13.3365L3.18421 10.5871C3.1073 10.4814 3.18284 10.333 3.31361 10.333Z"/>      </svg>');break;case 4:r='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">      <rect fill="'.concat(n,'" width="16" height="16" rx="2"/>      <path fill="').concat(t,'" d="M3.31332 10.3337H4.66578V3.60032C4.66578 3.45305 4.78517 3.33366 4.93245 3.33366H5.39912C5.54639 3.33366 5.66578 3.45305 5.66578 3.60032V13.1803C5.66578 13.4385 5.33536 13.546 5.18345 13.3371L3.18392 10.5878C3.10701 10.482 3.18255 10.3337 3.31332 10.3337Z"/>      <path fill="').concat(t,'" d="M10.4993 8.00032H9.59746C9.59746 8.00032 9.38808 8.06851 9.34865 8.17175L7.51663 12.9708C7.44999 13.1454 7.57891 13.3326 7.76576 13.3326H8.25455C8.36596 13.3326 8.46562 13.2633 8.50448 13.1589L8.83657 12.2663H11.2574L11.5888 13.1596C11.6276 13.2641 11.7273 13.3335 11.8388 13.3335H12.3319C12.5188 13.3335 12.6477 13.1463 12.5811 12.9717L10.7481 8.17175C10.7087 8.06851 10.6098 8.00032 10.4993 8.00032ZM10.8618 11.1999H9.22976L10.0321 9.04192H10.0572L10.8618 11.1999Z"/>      <path fill="').concat(t,'" d="M7.77383 2.93366C7.77383 2.78638 7.89322 2.66699 8.04049 2.66699H12.3018C12.449 2.66699 12.5684 2.78638 12.5684 2.93366V3.28555C12.5684 3.36254 12.5352 3.43578 12.4772 3.48642L9.44296 6.13555H12.3018C12.449 6.13555 12.5684 6.25494 12.5684 6.40221V6.93366C12.5684 7.08093 12.449 7.20033 12.3018 7.20033H8.0405C7.89322 7.20033 7.77383 7.08093 7.77383 6.93366V6.44691C7.77383 6.36987 7.80714 6.2966 7.8652 6.24595L10.7468 3.73232H8.0405C7.89322 3.73232 7.77383 3.61293 7.77383 3.46566V2.93366Z"/>      </svg>');break;case 32:r='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">      <rect fill="'.concat(n,'" width="16" height="16" rx="2"/>      <path fill="').concat(t,'" d="M14 3H5L8.46154 7.16667V11.3333L10.5385 13V7.16667L14 3Z"/>      <path fill="').concat(t,'" d="M2.16029 10H3.51275V3.26667C3.51275 3.11939 3.63214 3 3.77942 3H4.24608C4.39336 3 4.51275 3.11939 4.51275 3.26667V12.8466C4.51275 13.1049 4.18232 13.2123 4.03042 13.0035L2.03089 10.2541C1.95397 10.1484 2.02952 10 2.16029 10Z"/>      </svg>');break;default:r='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 16 16" fill="none">      <rect width="16" height="16" rx="2" fill="'.concat(n,'" />      <path fill="').concat(t,'" d="M2.5 4C2.5 3.72386 2.72386 3.5 3 3.5H13C13.2761 3.5 13.5 3.72386 13.5 4C13.5 4.27614 13.2761 4.5 13 4.5H3C2.72386 4.5 2.5 4.27614 2.5 4Z" />      <path fill="').concat(t,'" d="M4 8C4 7.72386 4.22386 7.5 4.5 7.5H11.5C11.7761 7.5 12 7.72386 12 8C12 8.27614 11.7761 8.5 11.5 8.5H4.5C4.22386 8.5 4 8.27614 4 8Z" />      <path fill="').concat(t,'" d="M6 11.5C5.72386 11.5 5.5 11.7239 5.5 12C5.5 12.2761 5.72386 12.5 6 12.5H10C10.2761 12.5 10.5 12.2761 10.5 12C10.5 11.7239 10.2761 11.5 10 11.5H6Z" />      </svg>')}return"data:image/svg+xml,".concat(encodeURIComponent(r))}(Z.Ps3.pivotTableHelper.getFilterSort(e,t,n),(0,N.getThemeColorByToken)(r?"text-link-normal":"text-link-hover"),(0,N.getThemeColorByToken)(r?"bg-filler":"N00"))}}]),t}(Sf);var vp=function(e){function t(){return(0,h.Z)(this,t),(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))}return(0,v.Z)(t,e),t}(I.FImage);vp=hp([Hd([k.FEventType.Tap,k.FEventType.Click])],vp);var gp,_p=function(e){function t(){return(0,h.Z)(this,t),(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"has",value:function(e,t,n){return void 0!==Z.Ps3.pivotTableHelper.getCollapse(e,t,n)}},{key:"anchor",value:function(){return"left"}},{key:"getBaseWidget",value:function(e,t,n){return new vp(null)}},{key:"addListener",value:function(e,t,n,r){var i=this,o=t.getPivotTableManager(),a=function(){var e=o.getPivotTableNameByCell(n,r),i=o.getPivotTableByName(e),a=o.getCellInfo(n,r),s=a.areaType,u=a.fieldNameList,l=a.fieldName,c=a.items,h=a.buttonState;if("colDim"===s||"rowDim"===s){var d=u.indexOf(l||"");if(d<0)return!0;t._trigger(Z.zW2.CollapseClick,{sheet:t,pivotTable:i,fieldName:l,buttonState:h,items:c,itemIndex:d,ptName:e})}return!0};e.addListener(k.FEventType.Tap,a),e.addListener(k.FEventType.Click,a),e.addListener(k.FEventType.MouseEnter,(function(){return e.updateByCfg({imgUrl:i.icon(t,n,r,!0)}),!0})),e.addListener(k.FEventType.MouseMove,(function(e){return e.srcEventPreventDefault(),!0})),e.addListener(k.FEventType.MouseLeave,(function(){return e.updateByCfg({imgUrl:i.icon(t,n,r,!1)}),!0}))}},{key:"iconSize",value:function(){return 14}},{key:"icon",value:function(e,t,n,r){return function(e,t,n){var r;return r=128===e?'<svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">      <rect fill="'.concat(n,'" stroke="').concat(t,'" x="1.69971" y="1.69995" width="10.6" height="10.6" rx="1.5"/>      <path fill="').concat(t,'" d="M7.0332 3.5332C6.71104 3.5332 6.44987 3.79437 6.44987 4.11654V6.44987H4.11654C3.79437 6.44987 3.5332 6.71104 3.5332 7.0332C3.5332 7.35537 3.79437 7.61654 4.11654 7.61654H6.44987V9.94987C6.44987 10.272 6.71104 10.5332 7.0332 10.5332C7.35537 10.5332 7.61654 10.272 7.61654 9.94987V7.61654H9.94987C10.272 7.61654 10.5332 7.35537 10.5332 7.0332C10.5332 6.71104 10.272 6.44987 9.94987 6.44987H7.61654V4.11654C7.61654 3.79437 7.35537 3.5332 7.0332 3.5332Z"/>      </svg>'):'<svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">      <rect fill="'.concat(n,'" stroke="').concat(t,'" x="1.69971" y="1.69995" width="10.6" height="10.6" rx="1.5"/>      <path fill="').concat(t,'" d="M7.61654 6.44995H6.44987H4.11654C3.79437 6.44995 3.5332 6.71112 3.5332 7.03328C3.5332 7.35545 3.79437 7.61662 4.11654 7.61662H6.44987L7.61654 7.61662H9.94987C10.272 7.61662 10.5332 7.35545 10.5332 7.03329C10.5332 6.71112 10.272 6.44995 9.94987 6.44995H7.61654Z"/>      </svg>'),"data:image/svg+xml,".concat(encodeURIComponent(r))}(Z.Ps3.pivotTableHelper.getCollapse(e,t,n)||64,(0,N.getThemeColorByToken)("icon-n3"),(0,N.getThemeColorByToken)(r?"bg-filler":"N00"))}}]),t}(Sf);!function(e){e[e.None=0]="None",e[e.FormulaError=1]="FormulaError",e[e.TextualNumber=2]="TextualNumber",e[e.PivotNormalTableError=3]="PivotNormalTableError",e[e.Info=4]="Info",e[e.PivotServiceCalcLoading=5]="PivotServiceCalcLoading"}(gp||(gp={}));var yp=function(){function e(t,n){(0,h.Z)(this,e),this.sheet=t,this.cacheManager=n,this.typographerCacheModel=new x.yJh,this.typographyInfoCacheModel=new x.yJh,this.tipsModel=new x.yJh,this.dvCacheModel=new x.yJh,this.sheet._dataModel.addModels([this.typographerCacheModel,this.typographyInfoCacheModel,this.tipsModel,this.dvCacheModel])}return(0,d.Z)(e,[{key:"getTips",value:function(e,t){var n=this.sheet.getPivotTableManager(),r=n.getPivotErrorStateByCell(e,t);if(null!==r)switch(r){case x.bfo.None:if(void 0!==n.getCellErrorInfo(e,t))return 3;break;case x.bfo.ServiceCalcLoading:return 5;case x.bfo.Loading:return 4;default:return 3}var i=this.tipsModel.get(e,t);if(null!==i)return i;var o=this.sheet.getVar(e,t);return i=(0,x.WBL)(this.sheet,e,t)?o.isFormula()||(0,x.E42)(o)?0:2:function(e,t,n){var r=e.getVar(t,n);if(!r.isFormula())return!1;var i=r.getRawVar();return!!i.isError()&&(0,x.lYP)(i.errorCode)}(this.sheet,e,t)?4:mp(this.sheet,e,t)?(0,N.isShortCut)()&&o.isError()&&o.info&&o.info.errorTipsType?o.info.errorTipsType:0:1,this.tipsModel.set(e,t,i),i}},{key:"removeTips",value:function(e,t,n,r){this.tipsModel.clear(e,t,n,r)}},{key:"getDVResult",value:function(e,t,n){var r=this.dvCacheModel.get(e,t);if(!r){if(!(n=n||this.sheet.getDataValidation(e,t)))return null;r=[n.checkCellValid(e,t),n],this.dvCacheModel.set(e,t,r)}return r[0]}},{key:"removeDVResult",value:function(e,t,n,r){this.dvCacheModel.clear(e,t,n,r)}},{key:"iterDVCacheCells",value:function(e){return this.dvCacheModel.iterWithPos(0,0,this.sheet.getRowCount(),this.sheet.getColumnCount()).filter((function(t){return e===t[0][1]}))}},{key:"getTypographyInfo",value:function(e,t){var n=this.typographyInfoCacheModel.get(e,t),r=this.sheet.parent.getPermissionVersion();return n&&n.version===r?n.typographyInfo:null}},{key:"setTypographyInfo",value:function(e,t,n){var r=this.sheet.parent.getPermissionVersion();this.typographyInfoCacheModel.set(e,t,{typographyInfo:n,version:r})}},{key:"removeTypography",value:function(e,t,n,r){this.typographerCacheModel.clear(e,t,n,r),this.typographyInfoCacheModel.clear(e,t,n,r),this.cacheManager.removeCell(this,e,t,n,r)}},{key:"getTypography",value:function(e,t,n){var r=this.sheet.parent.getPermissionVersion(),i=this.typographerCacheModel.get(e,t);if(n){var o=null==i?void 0:i.hint;if(o&&i.version===r)return o}else{var a=null==i?void 0:i.typography;if(a&&(this.cacheManager.updateCell(this,e,t),i.version===r))return a}return null}},{key:"setTypography",value:function(e,t,n,r){var i=this.sheet.parent.getPermissionVersion(),o=this.typographerCacheModel.get(e,t);o||(o={version:i},this.typographerCacheModel.set(e,t,o)),r?o.hint=n:(o.typography=n,this.cacheManager.updateCell(this,e,t))}},{key:"removeAllCache",value:function(e,t,n,r){this.tipsModel.clear(e,t,n,r),this.dvCacheModel.clear(e,t,n,r),this.removeTypography(e,t,n,r)}},{key:"resetCache",value:function(){this.tipsModel.reset(),this.dvCacheModel.reset(),this.typographerCacheModel.reset(),this.typographyInfoCacheModel.reset(),this.cacheManager.removeSheet(this)}},{key:"destroy",value:function(){this.sheet._dataModel.removeModels([this.typographerCacheModel,this.typographyInfoCacheModel,this.tipsModel,this.dvCacheModel])}}]),e}();function mp(e,t,n){var r=e.parent.getCellFormulaValidation(e,t,n);return!r||0===r.state}function Ep(e){return"data:image/svg+xml,"+encodeURIComponent(function(e){return'<?xml version="1.0" encoding="UTF-8"?><svg width="8px" height="8px" viewBox="0 0 8 8" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Rectangle</title><desc>Created with Sketch.</desc><g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Rectangle" fill="'+e+'"><polygon transform="translate(4.000000, 4.000000) scale(-1, 1) translate(-4.000000, -4.000000) " points="0 0 8 0 8 8"></polygon></g></g></svg>'}(mf(e.color)))}function bp(e,t,n){e.translate(t.x,t.y);var r=n.color,i=e.fillType;e.fillStyle=(0,k.convertThemeColor)(n,r,k.ColorThemeType.Color),e.fillType=k.ColorThemeType.Color,e.beginPath(),e.moveTo(0,0),e.lineTo(8,0),e.lineTo(0,8),e.closePath(),e.fill(),e.fillType=i}var Tp=function(e){return"var(--function-".concat(e,"-content-default)")},Cp=function(e){function t(){return(0,h.Z)(this,t),(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"getTipsType",value:function(e,t,n){return e.cache.getTips(t,n)}},{key:"widget",value:function(e,t,n){var r;switch(this.getTipsType(e,t,n)){case 2:r=Tp("success");break;case 3:case 1:r=Tp("danger");break;case 5:r=Tp("warning");break;case 4:r=Tp("info");break;default:return null}var i=new Cf(null,Ep,bp),o=this.iconSize();return i.updateByCfg({width:o,height:o,cursor:"pointer",background:"transparent",x:this.offsetX(),y:this.offsetY(),zindex:1,color:r,opacity:1}),i}},{key:"anchor",value:function(){return"top_left"}},{key:"iconSize",value:function(){return 8}},{key:"fillColor",value:function(e,t,n){return mp(e,t,n)?mf("var(--G500-FG)"):mf("var(--R500-FG)")}},{key:"offsetX",value:function(){return 0}},{key:"offsetY",value:function(){return 0}}]),t}(Sf),Sp=function(e){return Yf("conditionFormat",e)},wp=function(){return Sp("R50-BG")},Rp=function(){return Sp("R400-BG")},Ap=function(){return Sp("Y100-BG")},Op=function(){return Sp("Y400-BG")},Mp=function(){return Sp("Y500-BG")},kp=function(){return Sp("Y800-BG")},Ip=function(){return Sp("G400-BG")},xp=function(){return Sp("N500-BG")},Np=function(){return Sp("N600-BG")},Pp=function(){return Sp("N700-BG")},Lp={Top:["M13.41 20.215c.076-.174.076-.394.076-.835V8.246l3.77 3.6c.327.313.49.469.672.54.243.097.516.097.76 0 .181-.071.345-.227.671-.54.327-.311.49-.467.565-.641a.905.905 0 0 0 0-.725c-.075-.174-.238-.33-.565-.642l-6.138-5.863-.168-.161c-.252-.24-.407-.389-.548-.477a.77.77 0 0 0-.127-.065 1.034 1.034 0 0 0-.758 0c-.183.072-.346.228-.672.54-.105.1-.193.184-.266.257L4.64 9.84c-.327.313-.49.468-.566.643-.1.232-.1.492 0 .724.076.174.24.33.566.642.326.312.49.468.672.54.243.096.516.096.759 0 .182-.072.345-.228.672-.54l3.768-3.6V19.38c0 .44 0 .661.075.835a.97.97 0 0 0 .537.513c.182.072.413.072.875.072s.693 0 .875-.072a.97.97 0 0 0 .537-.513Z"],Bottom:["M10.59 3.784c-.076.175-.076.395-.076.836v11.134l-3.77-3.601c-.327-.312-.49-.468-.672-.54a1.034 1.034 0 0 0-.76 0c-.181.072-.345.228-.671.54-.327.312-.49.468-.566.642-.1.232-.1.493 0 .725.076.174.24.33.566.642l6.138 5.863.168.161c.252.24.407.389.548.477a.767.767 0 0 0 .127.065c.243.096.515.096.758 0 .183-.072.346-.228.672-.54.105-.1.193-.184.266-.257l6.041-5.77c.327-.313.49-.468.565-.643a.903.903 0 0 0 0-.724c-.075-.174-.238-.33-.565-.642-.326-.312-.49-.468-.672-.54a1.035 1.035 0 0 0-.759 0c-.182.072-.345.228-.672.54l-3.768 3.6V4.62c0-.44 0-.661-.075-.836a.97.97 0 0 0-.537-.512c-.182-.072-.413-.072-.875-.072s-.693 0-.875.072a.97.97 0 0 0-.537.512Z"],Right:["M3.598 13.41c.178.076.403.076.855.076H15.84l-3.683 3.77c-.32.327-.479.49-.553.672a1.013 1.013 0 0 0 0 .76c.074.181.234.345.553.671.319.327.478.49.656.565a.944.944 0 0 0 .741 0c.178-.075.338-.238.657-.565l5.996-6.138.165-.168c.246-.252.398-.407.488-.548a.763.763 0 0 0 .066-.127 1.013 1.013 0 0 0 0-.758c-.073-.183-.233-.346-.552-.672a14.04 14.04 0 0 0-.263-.266L14.21 4.64c-.32-.327-.479-.49-.657-.566a.948.948 0 0 0-.741 0c-.178.076-.338.24-.657.566-.319.326-.478.49-.552.672a1.013 1.013 0 0 0 0 .759c.074.182.233.345.552.672l3.681 3.768H4.453c-.452 0-.677 0-.855.075a.98.98 0 0 0-.524.537C3 11.306 3 11.537 3 11.999s0 .693.074.875a.98.98 0 0 0 .524.537Z"],TopRight:["M7.006 19.419c.196-.081.372-.257.723-.608l8.856-8.856v5.73c0 .496 0 .744.08.94.109.26.316.468.577.576.196.081.444.081.94.081.497 0 .745 0 .94-.081.262-.108.47-.316.577-.576.081-.196.081-.444.081-.94V6.1c0-.382 0-.618-.036-.795a.804.804 0 0 0-.045-.148 1.065 1.065 0 0 0-.576-.577c-.196-.081-.444-.081-.94-.081-.159 0-.293 0-.407.003h-9.18c-.496 0-.744 0-.94.08a1.065 1.065 0 0 0-.576.577c-.081.196-.081.444-.081.94 0 .497 0 .745.08.94.109.262.316.469.577.577.196.081.444.081.94.081h5.727l-8.854 8.854c-.351.35-.526.526-.608.722a1.065 1.065 0 0 0 0 .815c.082.196.257.372.608.722.35.351.526.527.722.608.261.108.554.108.815 0Z"],BottomRight:["M4.581 6.726c.081.196.257.371.608.722l8.856 8.856h-5.73c-.496 0-.744 0-.94.082a1.065 1.065 0 0 0-.576.576c-.081.196-.081.444-.081.94 0 .496 0 .745.081.94.108.261.315.469.576.577.196.08.444.08.94.08h9.328c.077.002.162.002.256.002.383 0 .618 0 .795-.038a.805.805 0 0 0 .149-.044c.26-.108.468-.316.576-.577.081-.195.081-.444.081-.94 0-.158 0-.292-.003-.406v-9.18c0-.496 0-.744-.08-.94a1.065 1.065 0 0 0-.577-.577c-.196-.08-.444-.08-.94-.08-.497 0-.745 0-.94.08a1.065 1.065 0 0 0-.577.577c-.081.196-.081.444-.081.94v5.726L7.448 5.19c-.35-.351-.526-.527-.722-.608a1.065 1.065 0 0 0-.815 0c-.196.081-.371.257-.722.608-.351.35-.527.526-.608.722a1.065 1.065 0 0 0 0 .815Z"]},Dp={Top:["M11.246 6.345a.996.996 0 0 1 1.508 0l7.791 8.952c.575.661.114 1.703-.754 1.703H4.21c-.868 0-1.33-1.042-.754-1.703l7.791-8.952Z"],Center:["M3.2 10.56c0-.53.463-.96 1.035-.96h15.53c.571 0 1.035.43 1.035.96v2.843c0 .55-.481.997-1.075.997H4.235c-.572 0-1.035-.43-1.035-.96v-2.88Z"],Bottom:["M12.754 17.655a.996.996 0 0 1-1.508 0L3.455 8.703C2.88 8.042 3.34 7 4.209 7H19.79c.868 0 1.33 1.042.754 1.703l-7.791 8.952Z"]},Fp={Circle:["M20.337 12a8.337 8.337 0 1 1-16.674 0 8.337 8.337 0 0 1 16.674 0Z"],Diamond:["M4.577 12.258a.395.395 0 0 1 0-.516l7.171-8.144a.33.33 0 0 1 .504 0l7.171 8.144a.395.395 0 0 1 0 .516l-7.17 8.144a.33.33 0 0 1-.505 0l-7.171-8.144Z"],Triangle:["M11.448 3.912a.606.606 0 0 1 1.104 0l6.839 15.293a.598.598 0 0 1-.552.838H5.16a.598.598 0 0 1-.552-.838l6.839-15.293Z"]},Bp={Cross:["M4.079 6.166c.079.19.25.362.591.703L9.801 12l-5.13 5.131c-.342.341-.513.512-.592.703-.105.254-.105.54 0 .793.079.19.25.361.591.703.342.341.512.512.703.591.254.105.54.105.793 0 .19-.079.362-.25.703-.591L12 14.199l5.13 5.13c.342.342.513.513.704.592.254.105.539.105.793 0 .19-.079.361-.25.703-.591.341-.342.512-.513.59-.703.106-.254.106-.54 0-.793-.078-.191-.249-.362-.59-.703L14.199 12l5.13-5.13c.342-.342.513-.513.592-.704a1.038 1.038 0 0 0 0-.793c-.079-.19-.25-.361-.591-.703-.342-.341-.513-.512-.703-.59a1.037 1.037 0 0 0-.793 0c-.191.078-.362.249-.703.59L12 9.801l-5.13-5.13c-.342-.342-.513-.513-.704-.592a1.037 1.037 0 0 0-.793 0c-.19.079-.361.25-.703.591-.341.342-.512.512-.591.703-.105.254-.105.54 0 .793Z"],Check_2:["M18.728 5.645c.33-.328.495-.493.679-.569.245-.101.521-.101.767 0 .184.076.349.24.679.57.33.328.494.493.57.676a.996.996 0 0 1 0 .765c-.075.183-.24.348-.57.677l-10.624 10.59c-.33.33-.494.494-.679.57a1.005 1.005 0 0 1-.766 0c-.184-.076-.35-.24-.68-.57-.33-.328-.494-.493-.57-.677a.996.996 0 0 1 0-.764c.076-.183.24-.348.57-.677l10.624-10.59Z","M3.147 13.412c-.33-.329-.495-.493-.57-.677a.996.996 0 0 1 0-.764c.075-.184.24-.348.57-.677.33-.329.495-.494.68-.57.245-.1.52-.1.766 0 .184.076.35.241.68.57l4.957 4.942c.33.33.495.494.57.677a.995.995 0 0 1 0 .764c-.075.184-.24.349-.57.678-.33.328-.495.493-.68.569a1.005 1.005 0 0 1-.766 0c-.184-.076-.35-.24-.68-.57l-4.957-4.942Z"],Caution:["M10 4.6c0-.56 0-.84.109-1.054a1 1 0 0 1 .437-.437C10.76 3 11.04 3 11.6 3h.8c.56 0 .84 0 1.054.109a1 1 0 0 1 .437.437C14 3.76 14 4.04 14 4.6v9.3c0 .56 0 .84-.109 1.054a1 1 0 0 1-.437.437c-.214.109-.494.109-1.054.109h-.8c-.56 0-.84 0-1.054-.109a1 1 0 0 1-.437-.437C10 14.74 10 14.46 10 13.9V4.6Zm0 14c0-.56 0-.84.109-1.054a1 1 0 0 1 .437-.437C10.76 17 11.04 17 11.6 17h.8c.56 0 .84 0 1.054.109a1 1 0 0 1 .437.437C14 17.76 14 18.04 14 18.6v.8c0 .56 0 .84-.109 1.054a1 1 0 0 1-.437.437C13.24 21 12.96 21 12.4 21h-.8c-.56 0-.84 0-1.054-.109a1 1 0 0 1-.437-.437C10 20.24 10 19.96 10 19.4v-.8Z"]},Vp={ThumbsUp:["M19.665 12.433c.344-.442.535-.983.535-1.546 0-.894-.514-1.74-1.343-2.211a1.635 1.635 0 0 0-.703-.185h-5.192l.123-2.446c.029-.591-.107-1.297-.404-1.602-.205-.21-.377-.357-.652-.471a2.243 2.243 0 0 0-.87-.172c-1.066 0-2.008.697-2.291 1.694l-1.761 6.189H7.1V20.2h9.682c.188 0 .373-.036.543-.107.976-.404 1.605-1.33 1.605-2.357 0-.25-.037-.497-.11-.736a2.512 2.512 0 0 0 .424-2.283c.344-.441.535-.983.535-1.546-.004-.25-.041-.5-.115-.738ZM3.8 12.319v7.244c0 .353.293.637.656.637H5.79v-8.517H4.456a.646.646 0 0 0-.656.636Z"],ThumbsDown:["M19.665 11.567c.344.442.535.983.535 1.546 0 .894-.514 1.74-1.343 2.211a1.635 1.635 0 0 1-.703.185h-5.192l.123 2.446c.029.591-.107 1.297-.404 1.602-.205.211-.377.357-.652.471-.275.115-.57.173-.87.172-1.066 0-2.008-.697-2.291-1.694l-1.761-6.188H7.1V3.8h9.682c.188 0 .373.036.543.108.976.403 1.605 1.329 1.605 2.356 0 .25-.037.497-.11.736a2.512 2.512 0 0 1 .424 2.283c.344.441.535.983.535 1.546-.004.25-.041.5-.115.738ZM3.8 11.681V4.437c0-.352.293-.637.656-.637H5.79v8.518H4.456a.646.646 0 0 1-.656-.637Z"]},Hp={Normal:["M18.896 4.228c-1.689.449-2.911.494-3.897.363-.995-.133-1.794-.447-2.687-.803l-.027-.011c-.877-.35-1.849-.737-3.064-.898-1.233-.164-2.672-.092-4.53.4a.884.884 0 0 0-.497.332A.982.982 0 0 0 4 4.2v16.056c0 .25.116.49.283.667a.93.93 0 0 0 .658.277c.236 0 .514-.1.681-.277a.975.975 0 0 0 .26-.667v-6.14c1.349-.294 2.27-.311 3.119-.199.995.133 1.794.447 2.687.803l.027.011c.877.35 1.849.737 3.064.898 1.236.164 2.681.091 4.548-.405.152-.04.389-.204.485-.335.096-.13.188-.37.188-.58V5.143a.992.992 0 0 0-.09-.414.934.934 0 0 0-.252-.33.866.866 0 0 0-.362-.18 1.005 1.005 0 0 0-.4.008Z"]},Up={Empty:["M11.558 4.086a.474.474 0 0 1 .884 0L14.18 8.46c.205.515.685.87 1.24.908l4.652.319c.421.029.612.575.272.863l-3.579 3.022a1.457 1.457 0 0 0-.471 1.464l1.137 4.571a.48.48 0 0 1-.714.535l-3.95-2.506a1.431 1.431 0 0 0-1.535 0l-3.949 2.506a.48.48 0 0 1-.714-.535l1.137-4.57a1.457 1.457 0 0 0-.471-1.465L3.656 10.55c-.34-.288-.15-.834.272-.863l4.653-.319a1.441 1.441 0 0 0 1.24-.908l1.737-4.374Z"],Half_2:["M11.56 4.087a.47.47 0 0 1 .88 0l1.737 4.374c.205.516.687.872 1.242.91l4.652.32c.42.028.609.57.27.856l-3.578 3.022a1.46 1.46 0 0 0-.472 1.468l1.137 4.571a.477.477 0 0 1-.71.531l-3.948-2.506a1.435 1.435 0 0 0-1.54 0l-3.949 2.506a.477.477 0 0 1-.71-.531l1.138-4.571a1.46 1.46 0 0 0-.472-1.468l-3.579-3.022c-.338-.285-.148-.828.27-.857l4.653-.319a1.444 1.444 0 0 0 1.242-.91l1.738-4.374Z","M13.738 8.644 12 4.27v12.655a1.9 1.9 0 0 1 1.02.297l3.949 2.506-1.138-4.571a1.95 1.95 0 0 1 .63-1.96l3.579-3.023-4.652-.319a1.92 1.92 0 0 1-1.65-1.211Z"],Full:["M11.11 3.908a.955.955 0 0 1 1.78 0l1.737 4.374a.96.96 0 0 0 .825.606l4.653.319c.862.059 1.213 1.15.55 1.71l-3.579 3.023a.975.975 0 0 0-.315.98l1.138 4.571c.21.847-.708 1.522-1.44 1.058l-3.95-2.507a.95.95 0 0 0-1.019 0l-3.949 2.506c-.732.465-1.65-.21-1.44-1.057L7.24 14.92a.975.975 0 0 0-.315-.98l-3.579-3.022c-.663-.56-.312-1.652.55-1.711l4.653-.319a.96.96 0 0 0 .825-.606l1.737-4.374Z"]},Zp={Empty:["M20.17 9.649c0-2.673-2.141-4.849-4.77-4.849a4.712 4.712 0 0 0-3.415 1.485A4.718 4.718 0 0 0 8.571 4.8C5.94 4.8 3.8 6.975 3.8 9.649c-.001.09.008.17.015.235a1.142 1.142 0 0 0-.003.066c0 .473.118.993.348 1.546.008.02.015.04.023.057 1.454 3.415 7.05 7.345 7.287 7.525a.829.829 0 0 0 1.006-.004c.204-.156 4.977-3.521 6.87-6.705.073-.107.127-.211.174-.3.015-.03.028-.058.044-.086l.006-.013a.287.287 0 0 1 .02-.032 5.02 5.02 0 0 0 .277-.613c.196-.505.293-.954.293-1.374a.87.87 0 0 0-.004-.085 1.92 1.92 0 0 0 .013-.217Z"],Half_2:["M11.189 19.419h.001l1.296-.39.29.384.003-.001.005-.004.017-.013.057-.041.188-.137a42.132 42.132 0 0 0 2.558-2.032c1.461-1.258 3.175-2.928 4.166-4.581a3.75 3.75 0 0 0 .18-.309l.012-.023.003-.007.022-.042a.25.25 0 0 1 .01-.02l.009-.015.008-.011.02-.037c.12-.23.22-.448.3-.664.21-.541.324-1.049.324-1.54 0-.026 0-.051-.002-.077a2.28 2.28 0 0 0 .012-.225c0-2.925-2.354-5.315-5.257-5.315-1.272 0-2.48.474-3.418 1.295a5.197 5.197 0 0 0-3.418-1.295c-2.904 0-5.256 2.388-5.256 5.315 0 .097.007.184.014.249l-.001.051c0 .547.135 1.126.381 1.717l.032.078c.776 1.808 2.613 3.697 4.224 5.124a41.446 41.446 0 0 0 3.145 2.511l.075.055Z","M15.425 4.8c2.631 0 4.775 2.17 4.775 4.834 0 .088-.007.162-.014.217a.832.832 0 0 1 .004.084c0 .419-.096.867-.293 1.37a5.066 5.066 0 0 1-.276.611.305.305 0 0 0-.02.032l-.007.013c-.016.028-.03.056-.044.085-.047.09-.101.193-.173.3-1.896 3.174-6.674 6.529-6.878 6.684a.832.832 0 0 1-.506.17l.014-12.92a4.726 4.726 0 0 1 3.418-1.48Z"],Full:["m11.197 19.42-.002-.001c-.01-.009-.036-.027-.075-.055-.337-.244-1.683-1.215-3.147-2.51-1.613-1.428-3.451-3.316-4.227-5.125a1.066 1.066 0 0 1-.032-.078c-.247-.59-.382-1.17-.382-1.717l.001-.051a2.348 2.348 0 0 1-.014-.25c0-2.926 2.354-5.314 5.26-5.314a5.2 5.2 0 0 1 3.42 1.295 5.198 5.198 0 0 1 3.422-1.295c2.904 0 5.26 2.39 5.26 5.315 0 .09-.005.166-.011.225l.002.076c0 .493-.114 1-.325 1.54a5.58 5.58 0 0 1-.3.665l-.02.037-.008.011-.009.015a3.956 3.956 0 0 1-.032.063l-.004.007-.012.022c-.042.08-.102.193-.179.309-.992 1.653-2.707 3.323-4.17 4.58a42.105 42.105 0 0 1-2.748 2.17l-.057.041-.017.013-.005.004h-.002v.001l-1.587.007Zm0 0c.235.176.513.261.79.261m-.79-.261.79.261m0 0c.282 0 .562-.09.797-.268l-.797.268Z"]},Wp={Sad_2:["M20.8 12a8.8 8.8 0 1 1-17.6 0 8.8 8.8 0 0 1 17.6 0Z","M8.758 9.684a.926.926 0 1 1 1.853 0 .926.926 0 0 1-1.853 0Zm4.632 0a.926.926 0 1 1 1.852 0 .926.926 0 0 1-1.853 0Zm-4.537 7.174a.602.602 0 0 1-1.117-.45l.559.223-.56-.223.001-.001v-.002l.002-.003.004-.01a2.126 2.126 0 0 1 .056-.123 4.773 4.773 0 0 1 .881-1.221c.67-.67 1.744-1.334 3.321-1.334 1.578 0 2.65.664 3.32 1.334a4.767 4.767 0 0 1 .882 1.22 2.756 2.756 0 0 1 .056.124l.004.01.001.003v.002l-.558.224.56-.223a.602.602 0 0 1-1.118.45l-.004-.01a2.81 2.81 0 0 0-.142-.269 3.565 3.565 0 0 0-.532-.68c-.488-.487-1.268-.981-2.469-.981-1.201 0-1.981.494-2.469.981a3.568 3.568 0 0 0-.65.896l-.024.053-.004.01Z"],Normal_2:["M20.8 12a8.8 8.8 0 1 1-17.6 0 8.8 8.8 0 0 1 17.6 0Z","M8.758 10.101c0-.383.31-.695.695-.695h.463a.695.695 0 1 1 0 1.39h-.463a.695.695 0 0 1-.695-.695Zm4.632 0c0-.383.31-.695.694-.695h.463a.695.695 0 1 1 0 1.39h-.463a.695.695 0 0 1-.694-.695Zm-5.697 5.141c0-.332.27-.602.602-.602v1.204a.602.602 0 0 1-.602-.602Zm.602.602h7.41a.603.603 0 0 0 0-1.204h-7.41v1.204Z"],Happy_2:["M20.8 12a8.8 8.8 0 1 1-17.6 0 8.8 8.8 0 0 1 17.6 0Z","M8.758 9.684a.926.926 0 1 1 1.853 0 .926.926 0 0 1-1.853 0Zm4.632 0a.926.926 0 1 1 1.852 0 .926.926 0 0 1-1.853 0ZM8.853 14.09a.602.602 0 0 0-1.117.45l.559-.224-.56.223.001.002v.001l.002.004.004.01a2.126 2.126 0 0 0 .056.122A4.773 4.773 0 0 0 8.68 15.9c.67.67 1.744 1.335 3.321 1.335 1.578 0 2.65-.665 3.32-1.335a4.767 4.767 0 0 0 .882-1.22 2.756 2.756 0 0 0 .056-.124l.004-.01.001-.003v-.001s.001-.002-.558-.225l.56.223a.602.602 0 0 0-1.118-.45l-.004.01-.025.053c-.023.05-.062.124-.117.216-.11.184-.284.432-.532.68-.488.488-1.268.981-2.469.981-1.201 0-1.981-.493-2.469-.981a3.568 3.568 0 0 1-.65-.896 1.645 1.645 0 0 1-.024-.053l-.004-.01Z"]},jp={CirclesRatio0:["M12 19.874a7.874 7.874 0 1 0 0-15.747 7.874 7.874 0 0 0 0 15.747Zm0 .926a8.8 8.8 0 1 1 0-17.6 8.8 8.8 0 0 1 0 17.6Z"],CirclesRatio25_2:["M12 19.874a7.874 7.874 0 1 1 0-15.748 7.874 7.874 0 0 1 0 15.748Zm0 .926a8.8 8.8 0 1 0 0-17.6 8.8 8.8 0 0 0 0 17.6Z","M19.874 12A7.874 7.874 0 0 0 12 4.126V12h7.874Z"],CirclesRatio50_2:["M12 19.874a7.874 7.874 0 1 1 0-15.748 7.874 7.874 0 0 1 0 15.748Zm0 .926a8.8 8.8 0 1 0 0-17.6 8.8 8.8 0 0 0 0 17.6Z","M12 19.873a7.874 7.874 0 1 0 0-15.747v15.747Z"],CirclesRatio75_2:["M12 19.874a7.874 7.874 0 1 1 0-15.748 7.874 7.874 0 0 1 0 15.748Zm0 .926a8.8 8.8 0 1 0 0-17.6 8.8 8.8 0 0 0 0 17.6Z","M4.126 12A7.874 7.874 0 1 0 12 4.126V12H4.126Z"],CirclesRatio100_2:["M12 19.874a7.874 7.874 0 1 1 0-15.748 7.874 7.874 0 0 1 0 15.748Zm0 .926a8.8 8.8 0 1 0 0-17.6 8.8 8.8 0 0 0 0 17.6Z","M19.874 12a7.874 7.874 0 1 1-15.747 0 7.874 7.874 0 0 1 15.747 0Z"]},Gp={"3Arrows":[{path2Ds:Lp.Top,fillStyleGenerators:[Ip]},{path2Ds:Lp.Right,fillStyleGenerators:[Op]},{path2Ds:Lp.Bottom,fillStyleGenerators:[Rp]}],"3ArrowsGray":[{path2Ds:Lp.Top,fillStyleGenerators:[xp]},{path2Ds:Lp.Right,fillStyleGenerators:[xp]},{path2Ds:Lp.Bottom,fillStyleGenerators:[xp]}],"3Triangles":[{path2Ds:Dp.Top,fillStyleGenerators:[Ip]},{path2Ds:Dp.Center,fillStyleGenerators:[Op]},{path2Ds:Dp.Bottom,fillStyleGenerators:[Rp]}],"4ArrowsGray":[{path2Ds:Lp.Top,fillStyleGenerators:[xp]},{path2Ds:Lp.TopRight,fillStyleGenerators:[xp]},{path2Ds:Lp.BottomRight,fillStyleGenerators:[xp]},{path2Ds:Lp.Bottom,fillStyleGenerators:[xp]}],"4Arrows":[{path2Ds:Lp.Top,fillStyleGenerators:[Ip]},{path2Ds:Lp.TopRight,fillStyleGenerators:[Op]},{path2Ds:Lp.BottomRight,fillStyleGenerators:[Op]},{path2Ds:Lp.Bottom,fillStyleGenerators:[Rp]}],"5ArrowsGray":[{path2Ds:Lp.Top,fillStyleGenerators:[xp]},{path2Ds:Lp.TopRight,fillStyleGenerators:[xp]},{path2Ds:Lp.Right,fillStyleGenerators:[xp]},{path2Ds:Lp.BottomRight,fillStyleGenerators:[xp]},{path2Ds:Lp.Bottom,fillStyleGenerators:[xp]}],"5Arrows":[{path2Ds:Lp.Top,fillStyleGenerators:[Ip]},{path2Ds:Lp.TopRight,fillStyleGenerators:[Op]},{path2Ds:Lp.Right,fillStyleGenerators:[Op]},{path2Ds:Lp.BottomRight,fillStyleGenerators:[Op]},{path2Ds:Lp.Bottom,fillStyleGenerators:[Rp]}],"3Circles":[{path2Ds:Fp.Circle,fillStyleGenerators:[Ip],strokeStyleGenerators:[Ip],strokeWidths:[.926]},{path2Ds:Fp.Circle,fillStyleGenerators:[Op],strokeStyleGenerators:[Op],strokeWidths:[.926]},{path2Ds:Fp.Circle,fillStyleGenerators:[Rp],strokeStyleGenerators:[Rp],strokeWidths:[.926]}],"3MultiGraphics":[{path2Ds:Fp.Circle,fillStyleGenerators:[Ip],strokeStyleGenerators:[Ip],strokeWidths:[.926]},{path2Ds:Fp.Triangle,fillStyleGenerators:[Op],strokeStyleGenerators:[Op],strokeWidths:[.713]},{path2Ds:Fp.Diamond,fillStyleGenerators:[Rp],strokeStyleGenerators:[Rp],strokeWidths:[.963]}],"4Circles":[{path2Ds:Fp.Circle,fillStyleGenerators:[Ip],strokeStyleGenerators:[Ip],strokeWidths:[.926]},{path2Ds:Fp.Circle,fillStyleGenerators:[Op],strokeStyleGenerators:[Op],strokeWidths:[.926]},{path2Ds:Fp.Circle,fillStyleGenerators:[Rp],strokeStyleGenerators:[Rp],strokeWidths:[.926]},{path2Ds:Fp.Circle,fillStyleGenerators:[xp],strokeStyleGenerators:[xp],strokeWidths:[.926]}],"5Circles":[{path2Ds:Fp.Circle,fillStyleGenerators:[Ip],strokeStyleGenerators:[Ip],strokeWidths:[.926]},{path2Ds:Fp.Circle,fillStyleGenerators:[Op],strokeStyleGenerators:[Op],strokeWidths:[.926]},{path2Ds:Fp.Circle,fillStyleGenerators:[Rp],strokeStyleGenerators:[Rp],strokeWidths:[.926]},{path2Ds:Fp.Circle,fillStyleGenerators:[xp],strokeStyleGenerators:[xp],strokeWidths:[.926]},{path2Ds:Fp.Circle,fillStyleGenerators:[Pp],strokeStyleGenerators:[Pp],strokeWidths:[.926]}],"2Status":[{path2Ds:Bp.Check_2,fillStyleGenerators:[Ip,Ip]},{path2Ds:Bp.Cross,fillStyleGenerators:[Rp]}],"3Status":[{path2Ds:Bp.Check_2,fillStyleGenerators:[Ip,Ip]},{path2Ds:Bp.Caution,fillStyleGenerators:[Op]},{path2Ds:Bp.Cross,fillStyleGenerators:[Rp]}],"2CommentStatus":[{path2Ds:Vp.ThumbsUp,fillStyleGenerators:[Ip]},{path2Ds:Vp.ThumbsDown,fillStyleGenerators:[Rp]}],"3Flags":[{path2Ds:Hp.Normal,fillStyleGenerators:[Ip]},{path2Ds:Hp.Normal,fillStyleGenerators:[Op]},{path2Ds:Hp.Normal,fillStyleGenerators:[Rp]}],"3Stars":[{path2Ds:Up.Full,fillStyleGenerators:[Mp]},{path2Ds:Up.Half_2,fillStyleGenerators:[Mp,Ap],strokeStyleGenerators:[Mp,null],strokeWidths:[.969,null]},{path2Ds:Up.Empty,fillStyleGenerators:[Ap],strokeStyleGenerators:[Mp],strokeWidths:[.963]}],"3HeartShaped":[{path2Ds:Zp.Full,fillStyleGenerators:[Rp]},{path2Ds:Zp.Half_2,fillStyleGenerators:[Rp,wp],strokeStyleGenerators:[Rp,null],strokeWidths:[.963,null]},{path2Ds:Zp.Empty,fillStyleGenerators:[wp],strokeStyleGenerators:[Rp],strokeWidths:[.963]}],"3Mood":[{path2Ds:Wp.Happy_2,fillStyleGenerators:[Op,kp]},{path2Ds:Wp.Normal_2,fillStyleGenerators:[Op,kp]},{path2Ds:Wp.Sad_2,fillStyleGenerators:[Op,kp]}],"5CirclesRatio":[{path2Ds:jp.CirclesRatio100_2,fillStyleGenerators:[Np,xp]},{path2Ds:jp.CirclesRatio75_2,fillStyleGenerators:[Np,xp]},{path2Ds:jp.CirclesRatio50_2,fillStyleGenerators:[Np,xp]},{path2Ds:jp.CirclesRatio25_2,fillStyleGenerators:[Np,xp]},{path2Ds:jp.CirclesRatio0,fillStyleGenerators:[Np]}]};function zp(){return""}var Yp=function(e){function t(){return(0,h.Z)(this,t),(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"iconSize",value:function(){return 24}},{key:"widget",value:function(e,t,n){var r=this,i=e.sheet,o=i.conditionalFormatModel.getCellStyle(t,n);if(o&&i.conditionalFormatModel.isIconsStyle(o)){var a=this.iconSize(),s=Gp[o.iconType][o.iconLevel],u=new Cf(null,zp,(function(e,t){e.translate(t.x+r.offsetX(),t.y+r.offsetY());var n=s.path2Ds,i=s.fillStyleGenerators,o=s.strokeStyleGenerators,a=void 0===o?[]:o,u=s.strokeWidths,l=void 0===u?[]:u;n.forEach((function(t,n){var r=new Path2D(t),o=i[n];e.lineWidth=1,e.fillStyle=o(),e.fill(r);var s=a[n];s&&(e.lineWidth=l[n]||1,e.strokeStyle=s(),e.stroke(r))}))}));return u.updateByCfg({width:a,height:a,cursor:"default",background:"transparent",zindex:1}),u}return null}},{key:"anchor",value:function(){return"left"}},{key:"offsetX",value:function(){return-2}},{key:"offsetY",value:function(){return-.5}}]),t}(Sf);function Xp(e){return"data:image/svg+xml,"+encodeURIComponent(function(e){return'<?xml version="1.0" encoding="UTF-8"?><svg width="8px" height="8px" viewBox="0 0 8 8" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Rectangle</title><desc>Created with Sketch.</desc><g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Rectangle" fill="'+e+'"><polygon transform="translate(4.000000, 4.000000) scale(-1, 1) translate(-4.000000, -4.000000)" points="0 0 8 0 8 8"></polygon></g></g></svg>'}(mf(e.color)))}function Kp(e,t,n){e.translate(t.x,t.y);var r=n.color,i=e.fillType;e.fillStyle=(0,k.convertThemeColor)(n,r,k.ColorThemeType.Color),e.fillType=k.ColorThemeType.Color,e.beginPath(),e.moveTo(0,0),e.lineTo(8,0),e.lineTo(8,8),e.closePath(),e.fill(),e.fillType=i}var qp=function(e){function t(){return(0,h.Z)(this,t),(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"widget",value:function(e,t,n){if(this.isDataValidationInvalid(e,t,n)){var r=new Cf(null,Xp,Kp),i=this.iconSize();return r.updateByCfg({width:i,height:i,cursor:"pointer",background:"transparent",x:this.offsetX(),y:this.offsetY(),zindex:1,color:"var(--R400-FG)",opacity:1}),r}return null}},{key:"isDataValidationInvalid",value:function(e,t,n){var r=e.sheet.getDataValidation(t,n);return!!r&&(!!r.isOptionError||!e.cache.getDVResult(t,n,r).getValue())}},{key:"anchor",value:function(){return"top"}},{key:"iconSize",value:function(){return 8}},{key:"offsetX",value:function(){return 0}},{key:"offsetY",value:function(){return 0}}]),t}(Sf);function $p(e){return"data:image/svg+xml,"+encodeURIComponent(function(e){return'<?xml version="1.0" encoding="UTF-8"?><svg width="8px" height="8px" viewBox="0 0 8 8" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Rectangle</title><desc>Created with Sketch.</desc><g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Rectangle" fill="'+e+'"><polygon transform="translate(4.000000, 4.000000) scale(-1, 1) translate(-4.000000, -4.000000)" points="0 0 8 0 8 8"></polygon></g></g></svg>'}(mf(e.color)))}function Jp(e,t,n){e.translate(t.x,t.y);var r=n.color,i=e.fillType;e.fillStyle=(0,k.convertThemeColor)(n,r,k.ColorThemeType.Color),e.fillType=k.ColorThemeType.Color,e.beginPath(),e.moveTo(0,0),e.lineTo(8,0),e.lineTo(8,8),e.closePath(),e.fill(),e.fillType=i}var Qp=function(e){function t(){return(0,h.Z)(this,t),(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"widget",value:function(e,t,n){if(this.hasCellNote(e,t,n)){var r=new Cf(null,$p,Jp),i=this.iconSize();return r.updateByCfg({width:i,height:i,background:"transparent",x:this.offsetX(),y:this.offsetY(),zindex:1,color:"var(--R400)",opacity:1}),r}return null}},{key:"has",value:function(e,t,n){return!!e._getCellNote(t,n)}},{key:"hasCellNote",value:function(e,t,n){return this.has(e.sheet,t,n)}},{key:"anchor",value:function(){return"top"}},{key:"iconSize",value:function(){return 8}},{key:"offsetX",value:function(){return 0}},{key:"offsetY",value:function(){return 0}}]),t}(Sf);k.borderDash.dash,[5,5].map((function(e){return e*(devicePixelRatio||1)}));var ev={color:Bc,width:1,style:k.borderDash.dash,dashLine:[5,5].map((function(e){return e*(devicePixelRatio||1)}))},tv=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).width=0,e.height=0,e.background="",e.hidden=!1,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=this.background,t=this.border,n=this.width,r=this.height;return k.Stack.with({width:n,height:r}).fill((function(){return[k.SizedBox.with({width:n,height:r}).fill((function(){return k.BorderBox.with({border:t})})),k.SizedBox.with({width:n,height:r}).fill((function(){return I.FBlock.with({background:e})}))]}))}}]),t}(k.FBaseWidget);function nv(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4?arguments[4]:void 0;if(!t)return new k.FRect;var o=t,a=o.rowFrom(),s=o.colFrom(),u=a+o.rowCount(),l=s+o.colCount();if(u<e.fromRow()||e.toRow()<a||l<e.fromCol()||e.toCol()<s)return new k.FRect(-e.docWidth(),0,1,1);var c=e.cell2ViewPos({row:a,col:s}),h=e.cell2ViewPos({row:u,col:l}),d=e.contentDoc().rect,f=e.visibleArea(),p=i?(i[0]||0)*i.length/devicePixelRatio/e.getSheetView().zoom:0;if(u>f.rowTo+1){var v=h.y;h.y=d.y+d.height+40,p&&(h.y+=(v-h.y)%p)}if(l>f.colTo+1){var g=h.x;h.x=d.x+d.width+100,p&&(h.x+=(g-h.x)%p)}if(a<f.rowFrom){var _=c.y;c.y=d.y-40,p&&(c.y-=(c.y-_)%p)}if(s<f.colFrom){var y=c.x;c.x=d.x-100,p&&(c.x-=(c.x-y)%p)}c.move(-n,-r),h.move(n-1,r-1);var m=h.x-c.x,E=h.y-c.y;return m=0===m?1:m,E=0===E?1:E,new k.FRect(c.x,c.y,m,E)}hp([k.State],tv.prototype,"width",void 0),hp([k.State],tv.prototype,"height",void 0),hp([k.State],tv.prototype,"border",void 0),hp([k.State],tv.prototype,"background",void 0),hp([k.State],tv.prototype,"hidden",void 0);var rv=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).hidden=!1,e.rgs=[],e.view=null,e.ignore=!0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=this;return!1===this.hidden&&this.view?k.Stack.fill((function(){return e.rgs.map((function(t,n){var r=nv(e.view,t,0,0),i=r.x,o=r.y,a=r.width,s=r.height,u="ConditionFormatSelection"+n++,l=Ph;return k.Positioned.with({left:i,top:o,key:u}).fill((function(){return tv.with({width:a,height:s,background:"var(--B500-FG, 0.06)",border:l})}))}))})):null}}]),t}(k.FBaseWidget);hp([k.State],rv.prototype,"hidden",void 0),hp([k.State],rv.prototype,"rgs",void 0),hp([k.State],rv.prototype,"view",void 0),hp([k.State],rv.prototype,"ignore",void 0);var iv=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).hidden=!1,e.rgs=[],e.view=null,e.ignore=!0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=this;return!1===this.hidden&&this.view?k.Stack.fill((function(){return e.rgs.map((function(t,n){var r=nv(e.view,t,0,0),i=r.x,o=r.y,a=r.width,s=r.height,u="AiHighlightArea"+n++,l=Ph;return k.Positioned.with({left:i,top:o,key:u}).fill((function(){return tv.with({width:a,height:s,background:"var(--B500-FG, 0.06)",border:l})}))}))})):null}}]),t}(k.FBaseWidget);hp([k.State],iv.prototype,"hidden",void 0),hp([k.State],iv.prototype,"rgs",void 0),hp([k.State],iv.prototype,"view",void 0),hp([k.State],iv.prototype,"ignore",void 0);var ov=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).rgs=[],e.view=null,e.ignore=!0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=this;return this.view?k.Stack.fill((function(){return e.rgs.map((function(t,n){var r=Lh.width,i=nv(e.view,t,r,r),o=i.x,a=i.y,s=i.width,u=i.height,l="ConditionHighLightSelection"+n++;return k.Positioned.with({left:o,top:a,key:l}).fill((function(){return tv.with({width:s,height:u,border:Lh})}))}))})):null}}]),t}(k.FBaseWidget);hp([k.State],ov.prototype,"rgs",void 0),hp([k.State],ov.prototype,"view",void 0),hp([k.State],ov.prototype,"ignore",void 0);var av=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).rgs=[],e.view=null,e.ignore=!0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=this;return this.view?k.Stack.fill((function(){return e.rgs.map((function(t,n){var r=Vh.width,i=nv(e.view,t,r,r),o=i.x,a=i.y,s=i.width,u=i.height,l="ProtectionHighlightSelection"+n++;return k.Positioned.with({left:o,top:a,key:l}).fill((function(){return k.Stack.fill((function(){return[tv.with({width:s,height:u,background:Fh}),k.SizedBox.with({width:s,height:u}).fill((function(){return k.BorderBox.with({border:Bh})})),k.SizedBox.with({width:s,height:u}).fill((function(){return k.BorderBox.with({border:Vh})}))]}))}))}))})):null}}]),t}(k.FBaseWidget);hp([k.State],av.prototype,"rgs",void 0),hp([k.State],av.prototype,"view",void 0),hp([k.State],av.prototype,"ignore",void 0);var sv=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).rgs=[],e.view=null,e.ignore=!0,e.colorType=0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=this;return this.view?k.Stack.fill((function(){return e.rgs.map((function(t,n){var r=nv(e.view,t,1,1),i=Uh,o=Zh,a=Hh,s=r.x,u=r.y,l=r.width,c=r.height,h="PivotTableHighlightSelection"+n++;return 1===e.colorType&&(i=Wh,a=Gh,o=jh),k.Positioned.with({left:s,top:u,key:h}).fill((function(){return k.Stack.fill((function(){return[tv.with({width:l,height:c,background:a}),k.SizedBox.with({width:l,height:c}).fill((function(){return k.BorderBox.with({border:i})})),k.SizedBox.with({width:l,height:c}).fill((function(){return k.BorderBox.with({border:o})}))]}))}))}))})):null}}]),t}(k.FBaseWidget);hp([k.State],sv.prototype,"rgs",void 0),hp([k.State],sv.prototype,"view",void 0),hp([k.State],sv.prototype,"ignore",void 0),hp([k.State],sv.prototype,"colorType",void 0);var uv=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).rgs=[],e.view=null,e.ignore=!0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=this;return this.view?k.Stack.fill((function(){return e.rgs.map((function(t,n){var r=nv(e.view,t,0,0),i=r.x,o=r.y,a=r.width,s=r.height,u=xh,l="ChartSelection"+n++;return k.Positioned.with({left:i,top:o,key:l}).fill((function(){return tv.with({width:a,height:s,background:"var(--B500-FG, 0.06)",border:u})}))}))})):null}}]),t}(k.FBaseWidget);hp([k.State],uv.prototype,"rgs",void 0),hp([k.State],uv.prototype,"view",void 0),hp([k.State],uv.prototype,"ignore",void 0);var lv=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).rgs=[],e.view=null,e.ignore=!0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=this;return this.view?k.Stack.fill((function(){return e.rgs.map((function(t,n){var r=nv(e.view,t,0,0),i=r.x,o=r.y,a=r.width,s=r.height,u=Nh,l="FloatBlocksSelection"+n++;return k.Positioned.with({left:i,top:o,key:l}).fill((function(){return tv.with({width:a,height:s,background:"var(--B500-FG, 0.06)",border:u})}))}))})):null}}]),t}(k.FBaseWidget);hp([k.State],lv.prototype,"rgs",void 0),hp([k.State],lv.prototype,"view",void 0),hp([k.State],lv.prototype,"ignore",void 0);var cv=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).rg=null,e.view=null,e.ignore=!0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){if(this.rg&&this.view){var e=nv(this.view,this.rg,0,0,ev.dashLine),t=e.x,n=e.y,r=e.width,i=e.height;return k.Stack.fill((function(){return[k.Positioned.with({key:"AutoFillSelection",left:t,top:n}).fill((function(){return tv.with({width:r,height:i,border:ev})}))]}))}return null}}]),t}(k.FBaseWidget);hp([k.State],cv.prototype,"rg",void 0),hp([k.State],cv.prototype,"view",void 0),hp([k.State],cv.prototype,"ignore",void 0);var hv=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).rgs=[],e.view=null,e.ignore=!0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=this;return this.view?k.Stack.fill((function(){return e.rgs.map((function(t,n){var r=nv(e.view,t,0,0,ev.dashLine),i=r.x,o=r.y,a=r.width,s=r.height,u="PainterSelection"+n++;return k.Positioned.with({left:i,top:o,key:u}).fill((function(){return tv.with({width:a,height:s,border:ev})}))}))})):null}}]),t}(k.FBaseWidget);hp([k.State],hv.prototype,"rgs",void 0),hp([k.State],hv.prototype,"view",void 0),hp([k.State],hv.prototype,"ignore",void 0);var dv,fv,pv,vv=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).rgs=[],e.view=null,e.ignore=!0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=this;if(!this.view)return null;var t=0===this.type,n=t?"var(--R500)":"var(--W300)",r=t?1:2,i=t?"var(--R500, 0.1)":"var(--W300, 0.1)",o=t?0:2;return k.Stack.fill((function(){return e.rgs.map((function(t,a){var s=nv(e.view,t,o,o),u=s.x,l=s.y,c=s.width,h=s.height,d="Sparkline"+a++;return k.Positioned.with({left:u,top:l,key:d}).fill((function(){return tv.with({width:c,height:h,border:{width:r,color:n},background:i})}))}))}))}}]),t}(k.FBaseWidget);hp([k.State],vv.prototype,"rgs",void 0),hp([k.State],vv.prototype,"view",void 0),hp([k.State],vv.prototype,"type",void 0),hp([k.State],vv.prototype,"ignore",void 0),function(e){e[e.Selection=0]="Selection",e[e.Layer=1]="Layer",e[e.SheetView=2]="SheetView",e[e.Grid=3]="Grid",e[e.None=4]="None"}(dv||(dv={})),function(e){e[e.HIGH=0]="HIGH",e[e.LOW=1]="LOW"}(fv||(fv={}));var gv=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).type=0,e}return(0,v.Z)(t,e),t}(Z.JTr),_v=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).isMounted=!1,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"build",value:function(){(0,l.Z)((0,p.Z)(t.prototype),"build",this).call(this),this.isMounted||(this.sub=this.initState(),this.isMounted=!0)}},{key:"destroy",value:function(){var e;(0,l.Z)((0,p.Z)(t.prototype),"destroy",this).call(this),null===(e=this.sub)||void 0===e||e.unsubscribe()}}]),t}(k.FBaseWidget),yv=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).type=1,e.host=null,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"bindRendererHost",value:function(e){this.host=e}},{key:"dispose",value:function(){(0,l.Z)((0,p.Z)(t.prototype),"dispose",this).call(this),this.host=null}}]),t}(Z.JTr),mv=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).type=2,e.host=null,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"bindRendererHost",value:function(e){this.host=e}},{key:"dispose",value:function(){(0,l.Z)((0,p.Z)(t.prototype),"dispose",this).call(this),this.host=null}}]),t}(Z.JTr),Ev=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).type=3,e}return(0,v.Z)(t,e),t}(Z.JTr);!function(e){e[e.Column=0]="Column",e[e.Row=1]="Row"}(pv||(pv={}));var bv=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).color=ih[Wc],e.width=0,e.height=0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=this,t=this.width,n=this.height;return k.SizedBox.with({width:t,height:n}).fill((function(){return I.FBlock.with({background:e.color})}))}}]),t}(k.FBaseWidget);hp([k.State],bv.prototype,"color",void 0),hp([k.State],bv.prototype,"width",void 0),hp([k.State],bv.prototype,"height",void 0);var Tv=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).ignore=!0,e.rgs=[],e.crossColor="",e.view=null,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"initState",value:function(){var e=this;return this.state$.subscribe((function(t){var n=t.rgs,r=t.color;e.rgs=n,e.crossColor=r}))}},{key:"describe",value:function(){var e=this;return this.view?k.Stack.fill((function(){return e.rgs.map((function(t,n){var r=nv(e.view,t,.5,.5),i=r.x,o=r.y,a=r.width,s=r.height,u="CrossSelection_"+n++;return k.Positioned.with({left:i,top:o,key:u}).fill((function(){return bv.with({width:a,height:s,color:e.crossColor})}))}))})):null}}]),t}(_v);hp([k.State],Tv.prototype,"state$",void 0),hp([k.State],Tv.prototype,"ignore",void 0),hp([k.State],Tv.prototype,"rgs",void 0),hp([k.State],Tv.prototype,"crossColor",void 0),hp([k.State],Tv.prototype,"view",void 0);var Cv=function(e){function t(e,n){var r;(0,h.Z)(this,t),(r=(0,f.Z)(this,(0,p.Z)(t).call(this))).crossColor$=new W.X(""),r.ranges$=new W.X([]),r.state$=(0,j.aj)(r.crossColor$,r.ranges$).pipe((0,le.map)((function(e){var t=(0,c.Z)(e,2);return{color:t[0],rgs:t[1]}})));var i=e.pipe((0,ce.w)((function(e){var t,n;return null!==(t=null===(n=Sv(e))||void 0===n?void 0:n.crossHighlightEnabled$)&&void 0!==t?t:(0,G.of)(!1)}))),o=e.pipe((0,ce.w)((function(e){var t,n;return null!==(t=null===(n=Sv(e))||void 0===n?void 0:n.crossHighlightColor$)&&void 0!==t?t:(0,G.of)("")})));return(0,j.aj)(n,i,o,e).pipe((0,he.b)(16),(0,de.R)(r.dispose$)).subscribe((function(e){var t=(0,c.Z)(e,4),n=t[0],i=t[1],o=t[2],a=t[3];a&&r.rebuildCrossHighlight(a,n,!!i,o)})),r}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"dispose",value:function(){(0,l.Z)((0,p.Z)(t.prototype),"dispose",this).call(this),this.crossColor$.complete(),this.ranges$.complete()}},{key:"render",value:function(e){return Tv.with({key:"CrossSelections",view:e,state$:this.state$})}},{key:"rebuildCrossHighlight",value:function(e,t,n,r){var i=t.length,o=[],a=e.getColumnCount(),s=e.getRowCount();if(n)for(var u=0;u<i;u++){var l=t[u];l.colCount()<a&&l.rowCount()<s&&o.push(l)}if(o.length>0){var c=this.getCrossHighLightByRanges(e,o,s,a);this.setRenderProperties(c,r)}else this.setRenderProperties([],r)}},{key:"getCrossHighLightByRanges",value:function(e,t,n,r){if(0===t.length)return[];var i=this.getGapByRowOrColumn(t,0,n,r),o=this.getGapByRowOrColumn(t,1,n,r),a=[];i.forEach((function(t){o.forEach((function(n){var r=new x.e6w(n.start,t.start,n.count,t.count,e);a.push(r)}))})),a=a.concat(t);var s=[new x.e6w(0,0,n,r,e)];return a.forEach((function(e){var t=[];s.forEach((function(n){[].push.apply(t,n.sub(e))})),s=t})),s}},{key:"getGapByRowOrColumn",value:function(e,t,n,r){if(0===e.length)return[];var i,o,a;0===t?(o="col",a="colCount",i=r):(o="row",a="rowCount",i=n);var s=[],u=e.map((function(e){return e.toJSON()})).sort((function(e,t){return e[o]<t[o]?-1:1}));if(u.length>=2)for(var l=0,c=1;c<u.length;){var h=u[c],d=u[l],f=d[o]+d[a]-1;if(f>=h[o]+h[a]-1)c++;else{if(f<h[o]){var p=h[o]-d[o]-d[a];p>0&&s.push({start:f+1,count:p})}l=c,c++}}var v=u[0];s.push({start:0,count:v[o]}),u=u.sort((function(e,t){return e[o]+e[a]<t[o]+t[a]?-1:1}));var g=u[u.length-1];return s.push({start:g[o]+g[a],count:i}),s}},{key:"setRenderProperties",value:function(e,t){var n=ih[t]||"";this.crossColor$.next(n),this.ranges$.next(e)}},{key:"crossColor",get:function(){return this.crossColor$.getValue()}},{key:"ranges",get:function(){return this.ranges$.getValue()}}]),t}(gv);function Sv(e){return null==e?void 0:e.inject(x.YLM)}function wv(e){var t=e.worksheet$,n=e.selections$;return new Cv(t,n)}var Rv=function(e){function t(e){var n;(0,h.Z)(this,t),(n=(0,f.Z)(this,(0,p.Z)(t).call(this))).worksheet$=e;var r=n.worksheet$.pipe((0,fe.h)((function(e){return!!e})));return(0,j.aj)(r,r.pipe((0,ce.w)((function(e){return e.viewsModel.activeView$})),(0,pe.O)(null),(0,ve.distinctUntilChanged)(),(0,ge.G)()),r.pipe((0,ce.w)((function(e){return e.inject(H.f3).suiteEditable$})),(0,ve.distinctUntilChanged)())).pipe((0,de.R)(n.dispose$)).subscribe((function(e){var t=(0,c.Z)(e,3),r=t[0],i=(0,c.Z)(t[1],2),o=i[0],a=i[1],s=t[2];return n.updateHeaderStyle(r,o,a,s)})),n}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"updateHeaderStyle",value:function(e,t,n,r){var i,o,a=Boolean(t&&!(0,Z.y_b)(t.getId())),s=Boolean(n&&r&&!(0,Z.y_b)(n.getId()));r&&!a&&s?null===(i=this.host)||void 0===i||i.toggleHeaderDarkTheme(!0):a&&!s&&(null===(o=this.host)||void 0===o||o.toggleHeaderDarkTheme(!1))}}]),t}(mv);function Av(e){return new Rv(e.worksheet$)}var Ov=function(e){function t(e){var n;return(0,h.Z)(this,t),(n=(0,f.Z)(this,(0,p.Z)(t).call(this)))._rg=e,n.rowFrom=0,n.colFrom=0,n.rowTo=0,n.colTo=0,e.sheet()&&n.updateRange(e),n}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"updateRange",value:function(e){this._rg=e,this.rowFrom=this._rg.rowFrom(),this.colFrom=this._rg.colFrom(),this.rowTo=this._rg.rowTo(),this.colTo=this._rg.colTo()}},{key:"size",value:function(){return null===this._rg.sheet()?{width:0,height:0}:{width:this.measureWidth(this.colFrom,this.colTo+1),height:this.measureHeight(this.rowFrom,this.rowTo+1)}}},{key:"rowPos",value:function(e){return this.measureHeight(this.rowFrom,e)}},{key:"colPos",value:function(e){return this.measureWidth(this.colFrom,e)}},{key:"cell2DocPos",value:function(e,t){return new k.FPoint(this.colPos(t),this.rowPos(e))}},{key:"measureCol",value:function(e){return this._rg.sheet()._getColInfos().getPos(this.colFrom,e)}},{key:"measureRow",value:function(e){return this._rg.sheet()._getRowInfos().getPos(this.rowFrom,e)}},{key:"measureWidth",value:function(e,t){return this._rg.sheet()._getColInfos().getDistance(e,t)}},{key:"measureHeight",value:function(e,t){return this._rg.sheet()._getRowInfos().getDistance(e,t)}},{key:"fromCol",value:function(){return this.colFrom}},{key:"fromRow",value:function(){return this.rowFrom}},{key:"toCol",value:function(){return this.colTo}},{key:"toRow",value:function(){return this.rowTo}}]),t}(I.FDocMeasurer),Mv=function(e){function t(e,n){var r;return(0,h.Z)(this,t),(r=(0,f.Z)(this,(0,p.Z)(t).call(this,"header_text_layer",e))).getFgColor=n,r}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"render",value:function(e,n,r,i,o){var a=e.fillType,s=this.getFgColor();e.save(),e.textAlign="center",e.textBaseline="middle",e.font=(0,I.fontString)({fontSize:12,fontFamily:(0,Z.BNt)()}),e.fillStyle=(0,k.convertThemeColor)(i,s,k.ColorThemeType.Color),e.fillType=k.ColorThemeType.Color,(0,l.Z)((0,p.Z)(t.prototype),"render",this).call(this,e,n,r,i,o),e.restore(),e.fillType=a}},{key:"_renderCell",value:function(e,t,n,r,i,o){var a=this._measure,s=t.text,u=t.bgColor,l=a.cell2DocPos(n,r),c=a.measureHeight(n,n+1),h=a.measureWidth(r,r+1),d=l.x+h/2,f=l.y+c/2,p=e.fillType;u&&(e.save(),e.fillStyle=(0,k.convertThemeColor)(o,u,k.ColorThemeType.Background),e.fillType=k.ColorThemeType.Background,e.fillRect(l.x,l.y,h,c),e.restore()),e.fillType=k.ColorThemeType.Color,e.fillText(s,d,f),e.fillType=p}},{key:"_iterFVGNode",value:function(e,t,n){if(e){var r=this._measure,i=r.cell2DocPos(t,n),o=r.measureHeight(t,t+1),a=r.measureWidth(n,n+1),s=i.x,u=i.y,l=e.text,c=e.bgColor;return{type:I.WdkFvgType.text,cfg:{x:s,y:u,width:a,height:o,lineHeight:o,color:hh,fontSize:12,fontFamily:(0,Z.BNt)(),text:l,background:c,vAlign:I.VerticalAlign.Center,hAlign:I.HorizontalAlign.Center}}}return null}}]),t}(I.FIterLayer);var kv=function(e){function t(e,n){var r;return(0,h.Z)(this,t),(r=(0,f.Z)(this,(0,p.Z)(t).call(this,e))).sheetView=n,r}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"measureWidth",value:function(e,t){return e<0&&t<0||e>0&&t>0||0===e&&0===t?0:this.sheetView.getSheetRowHeaderWidth()}},{key:"measureCol",value:function(e){return 0}}]),t}(Ov),Iv=function(e){function t(e){return(0,h.Z)(this,t),(0,f.Z)(this,(0,p.Z)(t).call(this,e))}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"measureHeight",value:function(e,t){if(e<0&&t<0||e>0&&t>0||0===e&&0===t)return 0;var n=this._rg.sheet();return n?n._getSheetColHeaderHeight():0}},{key:"measureRow",value:function(e){return 0}}]),t}(Ov),xv=function(e){function t(e,n,r,i){var o,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return(0,h.Z)(this,t),(o=(0,f.Z)(this,(0,p.Z)(t).call(this,e,null,void 0,i)))._doc=n,o._iterCreator=r,o.ignoreCellOverflow=a,o._viewRange=new k.FRect,o._widgetsCache=new Map,o._widgetsCount=0,o}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"reset",value:function(){var e=this;this._viewRange.reset(),this._widgetsCache.forEach((function(t){t.forEach((function(t){e.destroyWidgets(t)}))})),this._widgetsCache.clear(),this._widgetsCount=0}},{key:"cloneViewRange",value:function(e){this._viewRange.x=e.x,this._viewRange.y=e.y,this._viewRange.width=e.width,this._viewRange.height=e.height}},{key:"updateViewRect",value:function(e,t,n,r){var i=this,o=r.lastRowColRect,a=r.lastViewRect,s=r.newRowColRect,u=r.newViewRect;if(!a.containRect(u)){this.cloneViewRange(s);var l=s.sub(o),h=this._measure,d=function(e){i._iterCreator(e.y,e.x,e.maxY-1,e.maxX-1,t,i.ignoreCellOverflow?void 0:r.iterCtx).forEach((function(e){var t=(0,c.Z)(e,2),n=t[0],r=t[1],o=r.row,a=r.col,s=i.getWidgets(o,a);s&&i.destroyWidgets(s);var u=h.cell2DocPos(o,a);n.forEach((function(e){e.updateByCfg({x:e.x+u.x,y:e.y+u.y}),e.setParent(i._doc)})),s?i.setWidgets(o,a,n):i.addWidgets(o,a,n)}))};r.iterCtx?d(s):l.forEach(d),this._widgetsCount>1e4&&this.recycleWidgetsCache(t)}}},{key:"getWidgets",value:function(e,t){var n=this._widgetsCache.get(e);return n?n.get(t):void 0}},{key:"setWidgets",value:function(e,t,n){this._widgetsCache.get(e).set(t,n)}},{key:"addWidgets",value:function(e,t,n){var r=this._widgetsCache.get(e);r||(r=new Map,this._widgetsCache.set(e,r)),r.set(t,n),this._widgetsCount++}},{key:"destroyWidgets",value:function(e){e.forEach((function(e){e.destroy()}))}},{key:"recycleWidgetsCache",value:function(e){var t=this,n=new x.$gu,r=this._viewRange,i=r.y,o=r.x,a=r.maxY-1,s=r.maxX-1;this._iterCreator(i,o,a,s,e).forEach((function(e){var t=(0,c.Z)(e,2),r=(t[0],t[1]),i=r.row,o=r.col;return n.add(i,o)})),this._widgetsCache.forEach((function(e,r){e.forEach((function(i,o){n.has(r,o)||(t.destroyWidgets(i),e.delete(o),t._widgetsCount--)})),e.size||t._widgetsCache.delete(r)}))}}]),t}(I.FLayer),Nv=function(e){function t(e,n,r){var i,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4?arguments[4]:void 0;return(0,h.Z)(this,t),(i=(0,f.Z)(this,(0,p.Z)(t).call(this,e)))._type=n,i._idx=r,i._editable=o,i._sheet=a,i.updateByCfg({radius:5,background:o?Ad:void 0,cursor:o?"pointer":"default"}),i}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"getUIConfig",value:function(){return Kf.injectableStaticConfig}},{key:"renderWidget",value:function(e,n){(0,l.Z)((0,p.Z)(t.prototype),"renderWidget",this).call(this,e,n);var r=this._cfg.width,i=this._cfg.height,o=this._cfg.x,a=this._cfg.y,s=wd.triangleWidth,u=wd.triangleHeight,c=wd.padding,h=e.fillType;e.save(),e.translate(o,a);var d=(0,k.convertThemeColor)(this,"var(--ccmtoken-mindnote-highlightcolor-neutral)");e.fillType=k.ColorThemeType.Color,this._editable?e.fillStyle=(0,k.convertThemeColor)(this,Rd):e.fillStyle=d,0===this._type?(e.beginPath(),e.moveTo(r/2,c),e.lineTo(c,c+s),e.lineTo(c+u,c+s),e.fill(),e.beginPath(),e.moveTo(r/2,i-c),e.lineTo(c,i-c-s),e.lineTo(c+u,i-c-s),e.fill()):(e.beginPath(),e.moveTo(c,i/2),e.lineTo(c+s,c),e.lineTo(c+s,c+u),e.fill(),e.beginPath(),e.moveTo(r-c,i/2),e.lineTo(r-c-s,c),e.lineTo(r-c-s,c+u),e.fill()),e.closePath(),e.fillStyle!==d&&(e.fillStyle=d),e.fillType=h,e.restore()}},{key:"mouseDown",value:function(){return!0}},{key:"mouseEnter",value:function(){return!this._editable||(this.updateByCfg({background:Od}),!0)}},{key:"mouseLeave",value:function(){return!this._editable||(this.updateByCfg({background:Ad}),!0)}},{key:"_handleClick",value:function(e){var t;if(!this._editable)return!0;var n=this._sheet,r=0===this._type,i=r?n.getRowCount():n.getColumnCount(),o=r?n._getRowInfos():n._getColInfos(),a=this._idx,s=function(e,t,n){var r=e.iterVisible(t,n).first_if((function(e){return!e.value}));return r?r.count:0}(o,a,i);"unhideRow"==(r?"unhideRow":"unhideCol")?n.unhideRow([{target:a,count:s}]):n.unhideCol([{target:a,count:s}]);var u="",l=0;return r?(u="row",l=s):(u="col",l=s),null!==(t=Z.Ps3.collectSheetEvent)&&void 0!==t&&t.call(Z.Ps3,"ccm_sheet_content_page_click",{click:"unhide_row_column",target:"none",type:u,action_type:"edit_area"}),Tf.trigger(vc.LOG.CLICK_SHEET_HIDE_CANCEL,[vc.LOG.CLICK_SHEET_HIDE_CANCEL,this,{range_type:u,range_num:l,source:"sheet_arrow_click"}]),!0}},{key:"click",value:function(e){return this._handleClick(e)}}]),t}(k.FWidget);var Pv,Lv=function(e){function t(e,n,r){var i;return(0,h.Z)(this,t),(i=(0,f.Z)(this,(0,p.Z)(t).call(this,kf.PreResize,e)))._from=n,i._size=r,i}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"rowColType",value:function(){return this.target.type()}},{key:"size",value:function(){return this._size}},{key:"from",value:function(){return this._from}}]),t}(k.FEvent),Dv=function(e){function t(e,n,r){var i;return(0,h.Z)(this,t),(i=(0,f.Z)(this,(0,p.Z)(t).call(this,kf.HeaderEnterEvent,e))).target=e,i.rowColType=n,i.idx=r,i}return(0,v.Z)(t,e),t}(k.FEvent),Fv=function(e){function t(e,n,r){var i;return(0,h.Z)(this,t),(i=(0,f.Z)(this,(0,p.Z)(t).call(this,kf.HeaderLeaveEvent,e))).target=e,i.rowColType=n,i.idx=r,i}return(0,v.Z)(t,e),t}(k.FEvent);!function(e){e[e.StartEdge=0]="StartEdge",e[e.Content=1]="Content",e[e.EndEdge=2]="EndEdge",e[e.OverContent=3]="OverContent"}(Pv||(Pv={}));var Bv=function(e){function t(e,n,r,i){var o;(0,h.Z)(this,t),(o=(0,f.Z)(this,(0,p.Z)(t).call(this,null)))._idx=e,o._sheet=n,o._sheetView=r,o._type=i,o._preResize=-1,o._hideRowOrColCount=0,o._isResizing=!1,o._dragStartPos=new k.FPoint(0,0),o._draggingIdx=-1;var a=Kf.injectableStaticConfig.header.borderEnable?gh:void 0;return 0===o._type?o.updateByCfg({width:o._sheetView.getSheetRowHeaderWidth(),height:o._sheet.getRowHeight(o._idx),borderBottom:a}):o.updateByCfg({width:o._sheet.getColumnWidth(o._idx),height:o._sheetView.getSheetColHeaderHeight(),borderRight:a}),o}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"idx",value:function(){return this._idx}},{key:"type",value:function(){return this._type}},{key:"release",value:function(){}},{key:"checkTargetProtected",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;return 0===this._type?n=this._sheet.checkRowProtected(e):1===this._type&&(n=this._sheet.checkColProtected(e)),t&&n&&this._sheet._raiseInvalidOperation(8,"change_row_col_size"),n}},{key:"checkSheetProtected",value:function(){return this._sheet.options.isProtected}},{key:"checkSheetIsConnectorTab",value:function(){return this._sheet.tabType.isConnectorTab()}},{key:"mouseDown",value:function(e){var t;if(!this._sheetView.viewModel.getResizeEditable())return!1;this._sheetView.setMouseDownStatus(!0);var n=this._mouseResizeIdx(e);if(n>=0){this._dragStartPos=e.globalPoint(),this._draggingIdx=this._idx,this._preResize=n;var r=this._dragStartPos.y>x.ipL._defaultColHeaderRowHeight;this._sheet.trigger(Z.zW2.ResizeRowOrCol,{isRow:r});var i=this._mouseEvent2PreResizeInfo(e),o=i.from,a=i.size;return this._preResizeNotify(new Lv(this,o,a)),!0}return!(!this._sheetView.viewModel.getEditable()||!this._canGrabingRowCol()||Z.Ps3.browser.isSafari&&(e.buttons===k.FMouseButtons.None||e.buttons===k.FMouseButtons.Secondary||(null===(t=e.nativeEvent)||void 0===t?void 0:t.buttons)===k.FMouseButtons.None)||(this.updateByCfg({cursor:"grabbing"}),this._sheetView.setDragDropStatus(!0),1))}},{key:"mouseMove",value:function(e){if(!this._sheetView.viewModel.getResizeEditable())return!1;if(this._isGrabbingRowOrCol()&&!this._sheetView.viewModel.getEditable())return!1;if(this._preResize>=0){if(e.buttons===k.FMouseButtons.None)return this._isResizing?(this.mouseUp(e),!1):(this._preResize=-1,!1);this._isResizing||(this._isResizing=!0,this._sheetView.shellWatcher.dispatch("RowOrColStartDrag"));var t=this._mouseEvent2PreResizeInfo(e),n=t.from,r=t.size;return this._preResizeNotify(new Lv(this,n,r)),!1}if(this._preResizeNotify(new Lv(this,0,0)),this._mouseResizeIdx(e)>=0){var i;return i=0===this._type?"row-resize":"col-resize",this.updateByCfg({cursor:i}),!1}if(!this._sheetView.viewModel.getEditable())return this.updateByCfg({cursor:"default"}),!1;var o="grabbing"===this.cursor?this.cursor:"default",a=this._sheetView.getMouseDownStatus();return(this._canGrabingRowCol()&&!a||this._isGrabbingRowOrCol())&&(o="grab"),this.updateByCfg({cursor:o}),!1}},{key:"mouseUp",value:function(e){if(!this._sheetView.viewModel.getResizeEditable())return!1;if(this._canGrabingRowCol()&&this.updateByCfg({cursor:"grab"}),this._isGrabbingRowOrCol())return!1;if(this._preResize<0)return!1;if(this._sheetView.shellWatcher.dispatch("RowOrColDragged",{sheet:this._sheet}),this._isResizing=!1,this._preResizeNotify(new Lv(this,0,0)),this._draggingIdx!==this._idx)return this._preResize=-1,!1;if(this.checkTargetProtected(this._preResize,!0))return this._preResize=-1,!1;var t=e.globalPoint().sub(this._dragStartPos),n=this._sheet,r=this._mouseEvent2PreResizeInfo(e).size,i=!this._sheetView.viewModel.getEditable();if(0===this._type&&0!==t.y){var o=[];n._isRowSelected(this._preResize)?n._selectionModel.forEach((function(e){e.colCount()===n.getColumnCount()&&o.push({target:e.rowFrom(),count:e.rowCount()})})):o.push({target:this._preResize,count:1}),r>6?(n.resizeRow(o,r,i),Z.Ps3.ccmEventTracking("ccm_sheet_content_page_click",Object.assign({},(0,Z.dK5)(),{click:"set_row_col_size",target:"none",action_type:"direct",set_type:"row",set_method:"set_size"}))):(n.hideRow(o),this.clickSheetHideLog("row"))}if(1===this._type&&0!==t.x){var a=[];n._isColumnSelected(this._preResize)?n._selectionModel.forEach((function(e){e.rowCount()===n.getRowCount()&&a.push({target:e.colFrom(),count:e.colCount()})})):a.push({target:this._preResize,count:1}),r>6?(n.resizeCol(a,r,i),Z.Ps3.ccmEventTracking("ccm_sheet_content_page_click",Object.assign({},(0,Z.dK5)(),{click:"set_row_col_size",target:"none",action_type:"direct",set_type:"col",set_method:"set_size"}))):(n.hideCol(a),this.clickSheetHideLog("col"))}return this._preResize=-1,!1}},{key:"dblClick",value:function(e){if(!this._sheetView.viewModel.getResizeEditable())return!1;var t=this._mouseResizeIdx(e);if(t<0)return!0;var n=this._sheet,r=!this._sheetView.viewModel.getEditable();if(0===this._type){var i=[];n._isRowSelected(t)?n._selectionModel.forEach((function(e){if(e.colCount()===n.getColumnCount())for(var t=0;t<e.rowCount();t++)i.push(e.rowFrom()+t)})):i.push(t),n.autoFitRow(i,r),Z.Ps3.ccmEventTracking("ccm_sheet_content_page_click",{click:"set_row_col_size",target:"none",action_type:"double_click",set_type:"row",set_method:"self_adaption"})}else{var o=[];n._isColumnSelected(t)?n._selectionModel.forEach((function(e){if(e.rowCount()===n.getRowCount())for(var t=0;t<e.colCount();t++)o.push(e.colFrom()+t)})):o.push(t);var a=this._sheetView.getViewModel().getColumnsWidthHint(o);n.setColumnsSize(o,a,r),Z.Ps3.ccmEventTracking("ccm_sheet_content_page_click",{click:"set_row_col_size",target:"none",action_type:"double_click",set_type:"col",set_method:"self_adaption"})}return!0}},{key:"mouseEnter",value:function(e){return k.ListenersControl.sendEvent(this,new Dv(this,this._type,this._idx)),!1}},{key:"mouseLeave",value:function(e){return k.ListenersControl.sendEvent(this,new Fv(this,this._type,this._idx)),!1}},{key:"clickSheetHideLog",value:function(e){Tf.trigger(vc.LOG.CLICK_SHEET_HIDE,[vc.LOG.CLICK_SHEET_HIDE,this,{range_type:e,range_num:1,source:"sheet_head_drag"}])}},{key:"_mouseResizeIdx",value:function(e){var t=-1,n=this._mouseArea(e);if(0===n||2===n){var r=this._idx;0===n&&(r-=1),0!==this._type&&1!==this._type||(this._hideRowOrColCount=function(e,t,n){for(var r=0===e?"Row":"Col",i=0,o=t;o>=0&&!n["get".concat(r,"Visible")](o);o--)i++;return i}(this._type,r,this._sheet),t=r-this._hideRowOrColCount)}return t}},{key:"_mouseArea",value:function(e){var t=this.mapFromGlobal(new k.FPoint(e.globalPoint().x,e.globalPoint().y)),n=t.x,r=t.y;return 0===this._type?this._headerArea(r,this._cfg.height):this._headerArea(n,this._cfg.width)}},{key:"_headerArea",value:function(e,t){return e<0||t<e?3:e<=3?0:t-e<=3?2:1}},{key:"_preResizeNotify",value:function(e){k.ListenersControl.sendEvent(this._sheetView,e)}},{key:"_mouseEvent2PreResizeInfo",value:function(e){var t,n=0,r=this._preResize===this._idx-1-this._hideRowOrColCount;if(0===this._type){if(t=e.y,r){var i=this._sheet.getRowHeight(this._preResize);t+=i,n=-i}}else if(t=e.x,r){var o=this._sheet.getColumnWidth(this._preResize);t+=o,n=-o}return{from:n,size:t}}},{key:"_canGrabingRowCol",value:function(){if(this.checkSheetProtected())return!1;if(this.checkTargetProtected(this._idx))return!1;if(this.checkSheetIsConnectorTab())return!1;var e=this._sheetView.sheet().getSelections(),t=e[e.length-1],n=this._idx,r=0===this._type&&t instanceof x.lq$&&n>=t.rowFrom()&&n<=t.rowTo(),i=1===this._type&&t instanceof x.rvb&&n>=t.colFrom()&&n<=t.colTo();return r||i}},{key:"_isGrabbingRowOrCol",value:function(){return this._sheetView.getDragDropStatus()}}]),t}(k.FWidget);I.FLabel;var Vv,Hv=function(e){function t(e,n,r){var i;return(0,h.Z)(this,t),(i=(0,f.Z)(this,(0,p.Z)(t).call(this,e))).p=e,i._from=n,i._to=r,i.onDocFlush=function(){return i._syncStyle(),!1},i.updateByCfg({ignore:!0}),i._syncStyle(),e.addListener(k.FEventType.AfterFlush,i.onDocFlush),i}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"destroy",value:function(){this.p.removeListener(k.FEventType.AfterFlush,this.onDocFlush),(0,l.Z)((0,p.Z)(t.prototype),"destroy",this).call(this)}},{key:"updateRange",value:function(e,t){void 0!==e&&(this._from=e),void 0!==t&&(this._to=t)}},{key:"getRange",value:function(){return{from:this._from,to:this._to}}},{key:"_syncStyle",value:function(){console.error("implemented this in derive class")}}]),t}(k.FWidget),Uv=function(e){function t(e,n,r,i){var o;return(0,h.Z)(this,t),(o=(0,f.Z)(this,(0,p.Z)(t).call(this,e,n,r))).updateByCfg(Object.assign({},i)),o}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"_syncStyle",value:function(){if(null!=this.parent()){var e=this.parent(),t=e.measurer(),n=t.rowPos(this._from),r=t.rowPos(this._to);n=e.doc2View(new k.FPoint(0,n)).y-1,r=e.doc2View(new k.FPoint(0,r)).y;var i=e.width;this.updateByCfg({x:0,y:n,height:r-n,width:i>1?i:0})}}}]),t}(Hv),Zv=function(e){function t(e,n,r,i){var o;return(0,h.Z)(this,t),(o=(0,f.Z)(this,(0,p.Z)(t).call(this,e,n,r))).updateByCfg(Object.assign({},i)),o}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"_syncStyle",value:function(){if(null!=this.parent()){var e=this.parent(),t=e.measurer(),n=t.colPos(this._from),r=t.colPos(this._to);n=e.doc2View(new k.FPoint(n,0)).x-1,r=e.doc2View(new k.FPoint(r,0)).x;var i=e.height;this.updateByCfg({x:n,y:0,width:r-n,height:i>1?i:0})}}}]),t}(Hv),Wv=10,jv=function(){function e(t,n,r,i){var o=this;(0,h.Z)(this,e),this._view=t,this._sheetView=n,this._autoScrollIfOver=r,this._doSel=i,this._start=null,this._end=null,this._startPt=new k.FPoint(0,0),this.hasHandledRowFrozen=!1,this.hasHandledColFrozen=!1,this._handleSelectFrozenRange=function(e){var t=e._brTable,n=e.row,r=e.col,i=e.rowCount,a=e.colCount,s=e.pt,u=e.frozenRowCount,l=e.frozenColCount,c=t.contentDoc(),h={adjustRowCount:-1,adjustColCount:-1};if(!l&&!u)return h;if(o._hasHandledRowFrozen&&o._hasHandledColFrozen)return h;if(o.getIsExtendsMode(e.opts))return h;var d=r+a-1,f=n+i-1,p=t.docPos2Cell(s.x,s.y),v=p.col,g=p.row;return l&&!o._hasHandledColFrozen&&r<l&&(s.x>0&&s.x<c.width&&(d!==v||d===l)&&(c.updateByCfg({posX:0}),o._hasHandledColFrozen=!0,h.adjustColCount=l-r+1),s.x<=0&&d>=l&&(c.updateByCfg({posX:0}),o._hasHandledColFrozen=!0)),u&&!o._hasHandledRowFrozen&&n<u&&(s.y>0&&s.y<c.height&&(f!==g||f===u)&&(c.updateByCfg({posY:0}),o._hasHandledRowFrozen=!0,h.adjustRowCount=u-n+1),s.y<=0&&f>=u&&(c.updateByCfg({posY:0}),o._hasHandledRowFrozen=!0)),h}}return(0,d.Z)(e,[{key:"view",value:function(){return this._view}},{key:"start",value:function(e,t,n){if(null==this._view.parent()||!this._sheetView)return null;var r=new k.FPoint(e,t),i=n&&n.preStart;return this._start=i?{row:i instanceof x.rvb?-1:i.rowFrom(),col:i instanceof x.lq$?-1:i.colFrom()}:this._sheetView.globalPoint2VisibleCell(r),this._startPt=this._view.mapFromGlobal(r),this._hasHandledRowFrozen=!1,this._hasHandledColFrozen=!1,this.continueSel(e,t,n)}},{key:"continueSel",value:function(e,t,n){var r=this;if(null===this._start)return null;if(null==this._view.parent()||!this._sheetView)return null;var i=this._end,o=new k.FPoint(e,t);this._end=this._sheetView.globalPoint2VisibleCell(o),this._continueX=e,this._continueY=t,this._autoScrollIfOver&&this._tryOverScroll(this._continueX,this._continueY,this._sheetView)&&setTimeout((function(){return r.continueSel(r._continueX,r._continueY)}),200),(null==n?void 0:n.shiftKey)&&(this._hasHandledRowFrozen=!0,this._hasHandledColFrozen=!0);var a=this._composeRange(e,t,n),s=i===this._end||null!==i&&null!==this._end&&i.row===this._end.row&&i.col===this._end.col;return null===a||!this._doSel||s&&!(null!=n&&n.isEnd)||this._doSel(a,this._customData,o,null==n?void 0:n.isEnd),a}},{key:"end",value:function(e,t,n){var r=this.continueSel(e||this._continueX,t||this._continueY,Object.assign({},n,{isEnd:!0}));return this._start=this._end=null,r}},{key:"tryOverScroll",value:function(e,t,n){this._tryOverScroll(e,t,n)}},{key:"setOp",value:function(e){var t=this._doSel;return this._doSel=e,t}},{key:"customData",value:function(e){this._customData=e}},{key:"startCell",value:function(){return this._start}},{key:"endCell",value:function(){return this._end}},{key:"getIsExtendsMode",value:function(e){if(!e)return!1;return e.shiftKey&&-1!==["mouseMoveEvent","mouseDownEvent","mouseUPEvent"].indexOf(e.triggerFrom)}},{key:"_composeRange",value:function(e,t,n){var r=this._start,i=this._end;if(!r||!i||!this._sheetView)return null;var o=Math.min(r.row,i.row),a=Math.min(r.col,i.col),s=Math.abs(r.row-i.row)+1,u=Math.abs(r.col-i.col)+1,l=this._sheetView.sheet(),c=this._sheetView.brTable(),h=c.mapFromGlobal(new k.FPoint(e,t)),d=l.frozenColumnCount(),f=l.frozenRowCount(),p=this._handleSelectFrozenRange({_brTable:c,row:o,col:a,rowCount:s,colCount:u,pt:h,frozenRowCount:f,frozenColCount:d,opts:n}),v=p.adjustRowCount,g=p.adjustColCount;return-1===o?new x.rvb(a,u,l):-1===a?new x.lq$(o,s,l):new x.e6w(o,a,v>-1?v:s,g>-1?g:u,l)}},{key:"_tryOverScroll",value:function(e,t,n){var r=!1,i=this._view.posX,o=this._view.posY,a=n._brTable._content,s=n._brTable.mapFromGlobal(new k.FPoint(e,t)),u=a.measurer().size(),l=a.width<u.width,c=a.height<u.height,h=a.posX,d=a.maxPosX,f=a.posY,p=a.maxPosY,v=s.x+n._tlTable.width<0,g=s.x>a.x+a.width-10,_=s.y+n._trTable.height<0,y=s.y>a.y+a.height-10,m=80+Df;if(v&&s.x<this._startPt.x&&h>0&&l&&i>0){var E=n.x>0?n.x-Wv:h-10;this.scroll({x:E}),r=!0}if(g&&h<d&&s.x+n._blTable.width>this._startPt.x&&h-m<u.width-a.width&&l){var b=n.x>0?n.x-Wv:h+10;this.scroll({x:b}),r=!0}if(_&&s.y<this._startPt.y&&f>0&&c&&o>0){var T=n.isEmbed?-10:f-10;this.scroll({y:T}),r=!0}if(y&&f<p&&s.y+n._trTable.height>this._startPt.y&&f-72<u.height-a.height&&c){var C=n.isEmbed?Wv:f+10;this.scroll({y:C}),r=!0}return r||0!==f||(r=this.tryScrollDocY(s)),r||(r=this.tryScrollSheetViewX(s)),r}},{key:"scroll",value:function(e){var t,n=e.x,r=e.y;null===(t=this._sheetView)||void 0===t||t.scroll({x:n,y:r})}},{key:"tryScrollDocY",value:function(e){var t=this._sheetView;if(!t||0===t.overHeight)return!1;var n=t.overHeight/t.transform.d-t.trTable().height-t.rightColumnHeader().height-10;return!!(e.y>=n-10&&t.isEmbed)&&(this.scroll({y:Wv}),!0)}},{key:"tryScrollSheetViewX",value:function(e){var t=this._sheetView;if(!t)return!1;var n=t.viewModel.getWidth()-t.appModel.getSheetViewX()-t.bottomRowHeader().width;if(e.x>n-10){var r=Math.max(0,t.appModel.getSheetViewX()-Wv);return!!t.canHScroll(t.appModel.getSheetViewX()-r)&&(this.scroll({x:r}),!0)}return!1}},{key:"_hasHandledRowFrozen",get:function(){return this.hasHandledRowFrozen},set:function(e){this.hasHandledRowFrozen=e}},{key:"_hasHandledColFrozen",get:function(){return this.hasHandledColFrozen},set:function(e){this.hasHandledColFrozen=e}}]),e}();function Gv(e,t){if(!e.isValid())return e;var n=t.getSpans(e).reduce((function(e,t){return e.union(t)}),e);return n.isValid()?n.equal(e)?n:Gv(n,t):e}function zv(e,t,n,r,i){var o=e,a=L().isMac?t:n,s=0;if(a&&!o){s=2;var u=null==r?void 0:r.getSelections();i&&(null==u?void 0:u.some((function(e){return e.containCell(i.row,i.col)})))&&(s=3)}return!a&&o&&(s=1),s}function Yv(e,t,n,r){var i;return 0===t.rowFrom()&&0===t.colFrom()?((i=nv(e,t,0,0)).height+=1,i.width+=1):0===t.rowFrom()?(i=nv(e,t,n,0)).height+=1:0===t.colFrom()?(i=nv(e,t,0,r)).width+=1:i=nv(e,t,n,r),i}!function(e){e[e.set=0]="set",e[e.extend=1]="extend",e[e.add=2]="add",e[e.del=3]="del"}(Vv||(Vv={}));var Xv=function(e){function t(e,n,r,i,o){var a;(0,h.Z)(this,t),(a=(0,f.Z)(this,(0,p.Z)(t).call(this,e,r))).horizontal=n,a._sheetView=o,a.headerSelections=[],a._selEditMode=0,a._fgColor=hh,a._doSelection=function(e,t,n){if(a._sheet){var r=a.translateRange(e);a._selectRange(r)}},a.setPadding(i);var u=o;u.isEmbed&&a.setIgnoreBuffer(!0),a.selRangeHelper=new jv((0,s.Z)(a),u,!0,a._doSelection),a.headerTextLayer=new Mv((function(e,t,n,r){return a.horizontal?function(e,t,n,r){return t=Math.max(0,t),n=Math.min(n,e.getColumnCount()-1),e.iterVisibleCol(t,n).map((function(t){return[{text:e.getColValue(t).toString(),bgColor:r},{col:t,row:0}]}))}(a._sheet,t,r,a._bgColor):function(e,t,n,r){return t=Math.max(0,t),n=Math.min(n,e.getRowCount()-1),e.iterVisibleRow(t,n).map((function(t){return[{text:e.getRowValue(t).toString(),bgColor:r},{col:0,row:t}]}))}(a._sheet,e,n,a._bgColor)}),(function(){return a._fgColor})),a.addLayer(a.headerTextLayer);var l=new I.FWidgetLayer("header_border_layer",a.doc,(function(e,t,n,r){return a.horizontal?function(e,t,n,r){return e.iterVisibleCol(n,r).map((function(n){return[new Bv(n,e,t,1),{col:n,row:0}]}))}(a._sheet,a._sheetView,t,r):function(e,t,n,r){return e.iterVisibleRow(n,r).map((function(n){return[new Bv(n,e,t,0),{col:0,row:n}]}))}(a._sheet,a._sheetView,e,n)}));return a.addLayer(l),a.addLayer(new xv("unhide_icon_layer",a.doc,(function(e,t,n,r){return a.horizontal?function(e,t,n){var r=e._getColInfos(),i=r.firstVisible(0,t);return i&&i.index===t&&(t=0),r.iterVisible(t,n,!1).filter((function(e){return!e.value})).map((function(t){var n=t.index,r=t.count,i=e.inject(H.f3).sheetBusinessEditable&&e.parent.permissionManager.hasPermission(e.id())&&!e.checkColProtected(n,r),o=new Nv(null,1,n,i,e),a=wd.height,s=wd.width,u=e._getSheetColHeaderHeight();return o.updateByCfg({width:s,height:a,x:-s/2,y:(u-a)/2}),[o,{row:0,col:n}]}))}(a._sheet,t,r).map((function(e){return[[e[0]],e[1]]})):function(e,t,n){var r=e._getRowInfos(),i=r.firstVisible(0,t);return i&&i.index===t&&(t=0),r.iterVisible(t,n,!1).filter((function(e){return!e.value})).map((function(t){var n=t.index,r=t.count,i=e.inject(H.f3).sheetBusinessEditable&&e.parent.permissionManager.hasPermission(e.id())&&!e.checkRowProtected(n,r),o=new Nv(null,0,n,i,e),a=wd.height,s=wd.width;return o.updateByCfg({width:a,height:s,y:-s/2,x:wd.padding+1}),[o,{row:n,col:0}]}))}(a._sheet,e,n).map((function(e){return[[e[0]],e[1]]}))}))),a.getUIConfig().header.swapCanvasEnable||a.disableSwapCanvas(),a}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"getUIConfig",value:function(){return Kf.injectableStaticConfig}},{key:"setPadding",value:function(e){this.horizontal?this.doc.setPadding([0,e,0,0]):this.doc.setPadding([0,0,e,0])}},{key:"setColors",value:function(e,t,n,r){this._fgColor=e,this._bgColor=t,this._bgRowCfg=n,this._bgColCfg=r}},{key:"translateRange",value:function(e){return this.horizontal?this._rangeToColumns(e):this._rangeToRows(e)}},{key:"_rangeToColumns",value:function(e){return new x.rvb(e.colFrom(),e.colCount(),this._sheet)}},{key:"_rangeToRows",value:function(e){return new x.lq$(e.rowFrom(),e.rowCount(),this._sheet)}},{key:"_selectRange",value:function(e){if(this._sheet){var t=this._sheet,n={row:t.getActiveRowIndex(),col:t.getActiveColumnIndex()};if(1!==this._selEditMode){var r=this.selRangeHelper.startCell();null!==r&&(n.row=r.row,n.col=r.col)}2===this._selEditMode?(t.setActiveCell(n.row,n.col,{triggerEvent:!1,setSelection:!1,clearSelection:!1}),t._expandSelectedRange(e)):t.setSelection(e,n)}}},{key:"_range2region",value:function(e,t,n){var r=e.length;e=e.sort((function(e,n){return e[t]()-n[t]()}));for(var i=[],o=0,a=0,s=!0,u=0;u<r;u++){var l;for(o=e[u][t](),a=e[u][t]()+e[u][n]()-1;s;)void 0!==e[u+1]&&a>=e[u+1][t]()?(a=Math.max(a,e[u+1][t]()+e[u+1][n]()-1),u++):s=!1;s=!0,i.push((l={},(0,g.Z)(l,t,o),(0,g.Z)(l,n,a-o+1),l))}return i}},{key:"sheet",value:function(){return this._sheet}},{key:"updateSheet",value:function(e){this._sheet=e}},{key:"setSelEditMode",value:function(e){this._selEditMode=e}},{key:"selEditMode",value:function(){return this._selEditMode}},{key:"getSheetView",value:function(){return this._sheetView}},{key:"startSelAtPoint",value:function(e,t,n){this.selRangeHelper.start(e,t,n)}},{key:"continueSelAtPoint",value:function(e,t,n){this.selRangeHelper.continueSel(e,t,n)}},{key:"endSelAtPoint",value:function(e,t,n){this.selRangeHelper.end(e,t,n)}},{key:"tryOverScroll",value:function(e,t){return this.selRangeHelper.tryOverScroll(e,t,this._sheetView)}},{key:"pointToRange",value:function(e){var t=this._sheetView.globalPoint2Cell(e);return this.translateRange(new x.e6w(t.row,t.col,1,1,this._sheet))}},{key:"pointToVisibleRange",value:function(e){var t=this._sheetView.globalPoint2VisibleCell(e);return this.translateRange(new x.e6w(t.row,t.col,1,1,this._sheet))}},{key:"isEditable",value:function(){var e=this._sheetView;return e&&e.viewModel.getEditable()}},{key:"isRowEditable",value:function(){var e=this._sheetView;return e&&e.viewModel.getRowEditable()}},{key:"isColEditable",value:function(){var e=this._sheetView;return e&&e.viewModel.getColEditable()}},{key:"isResizeEditable",value:function(){var e;return!(null===(e=this._sheetView)||void 0===e||!e.viewModel.getResizeEditable())}},{key:"unselectFloatingObjects",value:function(){this.headerSelections.forEach((function(e){return e.updateByCfg({hidden:!0})}))}},{key:"reselectFloatingObjects",value:function(){this.headerSelections.forEach((function(e){return e.updateByCfg({hidden:!1})}))}},{key:"updateSelections",value:function(e){if(this.headerSelections.forEach((function(e){return e.destroy()})),this.headerSelections=[],!(0,N.isShortCut)())if(this.horizontal)for(var t=this._range2region(e,"colFrom","colCount"),n=t.length,r=0;r<n;r++){var i=t[r],o=new Zv(this,i.colFrom,i.colFrom+i.colCount,this._bgColCfg);this.headerSelections.push(o)}else for(var a=this._range2region(e,"rowFrom","rowCount"),s=a.length,u=0;u<s;u++){var l=a[u],c=new Uv(this,l.rowFrom,l.rowFrom+l.rowCount,this._bgRowCfg);this.headerSelections.push(c)}}}]),t}(I.FDocView),Kv=500,qv=[10,20,30,50,100],$v=15e3,Jv=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Kv,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:$v;(0,h.Z)(this,e),this.cb=t,this.collectMax=r,this.timeoutToReport=i,this.list=new Map,this.timeout=null,this.reportTimer=null,this.reportAll=function(){if(0!==n.list.size){var e={},t=0;n.list.forEach((function(n,r){e[r]=n.sum,t=Math.max(n.count,t)})),e.count=t,n.cb(e),n.list.clear(),n.tryClearTimeout()}}}return(0,d.Z)(e,[{key:"addLayer",value:function(e){this.list.set(e,{startTime:null,count:0,sum:0})}},{key:"setStartTime",value:function(e,t){this.list.has(e)||this.addLayer(e),this.list.get(e).startTime=t}},{key:"start",value:function(e){var t=Date.now();this.setStartTime(e,t),null===this.timeout&&(this.timeout=window.setTimeout(this.reportAll,this.timeoutToReport))}},{key:"end",value:function(e){var t=Date.now(),n=this.list.get(e);n&&null!==n.startTime&&(n.sum+=t-n.startTime,n.count++,n.count>=this.collectMax&&null===this.reportTimer&&(this.reportTimer=window.setTimeout(this.reportAll))),this.setStartTime(e,null)}},{key:"tryClearTimeout",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.reportTimer&&(clearTimeout(this.reportTimer),this.reportTimer=null)}},{key:"destroy",value:function(){this.cb=w.default,this.tryClearTimeout()}}]),e}(),Qv=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Kv,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:qv,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:$v;(0,h.Z)(this,e),this.cb=t,this.collectMax=n,this.overTimeList=r,this.timeoutToReport=i,this.sum=0,this.max=0,this.min=Number.MAX_SAFE_INTEGER,this.count=0,this.timeout=null,this.init()}return(0,d.Z)(e,[{key:"init",value:function(){this.count=0,this.max=0,this.min=Number.MAX_SAFE_INTEGER,this.greaterThan=new Array(this.overTimeList.length).fill(0),this.sum=0}},{key:"overTimeCount",value:function(e){var t=this;this.overTimeList.forEach((function(n,r){e>=n&&t.greaterThan[r]++}))}},{key:"reportFirstCalc",value:function(e,t,n){var r=n.statistics.getAll(),i={paint_time:e,max:e,min:e,count:1,first_calc:1,calc_formula_count:t,cache_formula_count:r[x.R4C.ServerSideCacheFormulaCount]||0,cached_formula_count:r[x.R4C.ServerSideCacheHitFormulaCount]||0};this.cb(i)}},{key:"add",value:function(e){var t=this;null===this.timeout&&(this.timeout=setTimeout((function(){0!==t.count&&t.report()}),this.timeoutToReport)),this.sum+=e,this.max=Math.max(e,this.max),this.min=Math.min(e,this.min),this.count++,this.overTimeCount(e),this.count===this.collectMax&&this.report()}},{key:"report",value:function(){var e=this,t={paint_time:this.sum/this.count,max:this.max,min:this.min,count:this.count,first_calc:0,calc_formula_count:-1,cache_formula_count:-1,cached_formula_count:-1};this.greaterThan.forEach((function(n,r){var i="over"+e.overTimeList[r];t[i]=n/e.count})),this.cb(t),this.init(),this.tryClearTimeout()}},{key:"tryClearTimeout",value:function(){this.timeout&&0===this.count&&(clearTimeout(this.timeout),this.timeout=null)}},{key:"destroy",value:function(){this.cb=w.default,this.tryClearTimeout()}}]),e}(),eg=[Z.EEh.LOAD_ALONE,Z.EEh.LOAD_EMBED];var tg=function(){function e(t,n){var r=this;(0,h.Z)(this,e),this._sheet=t,this.getVisibleRange=n,this._fpsElapsedTime=0,this._fpsFrameCount=0,this.reportFps=function(t){var n,i=r._sheet;if(i&&!(t.fps>=63&&1===t.frameCount)){var o=function(e){var t=e.hasSingleAction();if(!1!==t)return t;var n,r=cc(eg);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(e.has(i))return i}}catch(e){r.e(e)}finally{r.f()}var o=e.getLog().find((function(e){return e.startsWith(Z.fkS)}));return o||null}(t.logs);if(o&&o!==Z.EEh.HIDE_FREEZE_SHADOW){if(r._lastFPSType||(r._lastFPSType=o),r._lastReportTime||(r._lastReportTime=Date.now()),o===r._lastFPSType&&Date.now()-r._lastReportTime<e.MAX_REPORT_DURATION)return r._fpsFrameCount+=t.frameCount,void(r._fpsElapsedTime+=t.elapsedTime);var a=i.getRowCount(),s=i.getColumnCount(),u=function(e,t){var n=e.getPivotTableManager();if(!n||!n.hasPivotTable())return!1;var r=t().toJSON(),i=r.row,o=r.col;return n.isIntersectPivotTable(i,o,1,1)}(i,r.getVisibleRange),l={row_count:a,column_count:s,fps:Math.round(r._fpsFrameCount/r._fpsElapsedTime*1e3),frame_count:r._fpsFrameCount,elapsed_time:r._fpsElapsedTime,type:"sheet",opItem:r._lastFPSType,status:r._sheet.parent.isSearching?"searching":"",viewMode:void 0!==(null===(n=r._sheet)||void 0===n?void 0:n.initTranslateParams)?Z.TTY.TRANSLATE:Z.TTY.NORMAL,pivot_invisible:u};Z.PxA.collectSheetEvent("faster_performance_fps",l,r._sheet),r._lastReportTime=Date.now(),r._lastFPSType=o,r._fpsFrameCount=t.frameCount,r._fpsElapsedTime=t.elapsedTime}}}}return(0,d.Z)(e,[{key:"updateSheet",value:function(e){this._sheet=e}}]),e}();tg.MAX_REPORT_DURATION=2e3;var ng=function(e){function t(e){var n;return(0,h.Z)(this,t),(n=(0,f.Z)(this,(0,p.Z)(t).call(this))).key="FCornerTriangle",n.isEmbed=!1,n.x=0,n.y=0,n.height=0,n.width=0,n.hover=!1,n.isEmbed=e||!1,n.background=Sd.normal.background,n}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"paintSelf",value:function(e){e.save();var n=this.background;n=this.hover?Sd.hover.background:Sd.normal.background;var r=e.fillType,i=(0,k.convertThemeColor)(this,n,k.ColorThemeType.Background);e.fillType=k.ColorThemeType.Background,i&&e.fillStyle!==i&&(e.fillStyle=i);var o=this.x,a=this.y,s=this.width,u=this.height,l=t.PADDING,c=t.SIZE;e.beginPath(),e.moveTo(o+s-c-l,a+u-l),e.lineTo(o+s-l,a+u-l),e.lineTo(o+s-l,a+u-c-l),e.fill(),e.restore(),e.fillType=r}}]),t}(k.FBaseWidget);ng.SIZE=12,ng.PADDING=4,hp([k.State],ng.prototype,"key",void 0),hp([k.State],ng.prototype,"isEmbed",void 0),hp([k.State],ng.prototype,"background",void 0),hp([k.State],ng.prototype,"x",void 0),hp([k.State],ng.prototype,"y",void 0),hp([k.State],ng.prototype,"height",void 0),hp([k.State],ng.prototype,"width",void 0),hp([k.State],ng.prototype,"hover",void 0);var rg=function(e){function t(e,n,r,i){var o;return(0,h.Z)(this,t),(o=(0,f.Z)(this,(0,p.Z)(t).call(this))).sheetView=r,o.key="SheetCorner",o.hover=!1,o.editable=!1,o.width=0,o.height=0,o.background=Cd.normal.background,o.isEmbed=!1,o.borderCfg=[{color:Cd.normal.borderRight.color,width:0},{color:Cd.normal.borderRight.color,width:1},{color:Cd.normal.borderRight.color,width:1},{color:Cd.normal.borderRight.color,width:0}],o._sheet=e,o._$shellWatcher=n,o.isEmbed=i||!1,o.background=o.isEmbed?Cd.embed.background:Cd.normal.background,o}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=this,t=this.background,n=this.borderCfg,r=this.width,i=this.height,o=this.getUIConfig().corner.triangleEnable;return k.SizedBox.with({width:r,height:i,key:"SheetCornerSizedBox"}).fill((function(){return k.Stack.with({key:"SheetCornerStack"}).fill((function(){return[k.SizedBox.with({width:r,height:i}).fill((function(){return I.FBlock.with({background:t})})),k.SizedBox.with({width:r,height:i}).fill((function(){return k.BorderBox.with({border:n})})),o?ng.with({hover:e.hover,isEmbed:e.isEmbed,height:e.height,width:e.height,x:e.width-e.height}):null]}))}))}},{key:"renderTree",value:function(e){e.save();var t=this.pos;e.translate(t.x,t.y),this.children().length>0?(this.paintSelf(e),this.renderChildren(e)):this.paintSelf(e),e.translate(-t.x,-t.y),e.restore()}},{key:"getUIConfig",value:function(){return Kf.injectableStaticConfig}},{key:"updateBorder",value:function(e){e.background&&(this.background=e.background),e.borderBottom&&(this.borderCfg[2]=e.borderBottom,this.borderCfg=this.borderCfg),e.borderRight&&(this.borderCfg[1]=e.borderRight,this.borderCfg=this.borderCfg)}},{key:"updateSheet",value:function(e){this._sheet=e}},{key:"click",value:function(e){if(Tf.trigger(vc.LOG.CLICK_FULL_SHEET_BTN,[vc.LOG.CLICK_FULL_SHEET_BTN,this]),!this._sheet)return!1;var t=this._sheet,n={sheet:t,sheetName:t.name(),row:-1,col:-1};return this._$shellWatcher.dispatch("CellClicked",n),!1}},{key:"dblClick",value:function(){return!0}},{key:"mouseDown",value:function(e){if(!this._sheet)return!1;var t=this._sheet;switch(zv(e.shiftKey,e.metaKey,e.ctrlKey)){case 0:this.sheetView.clearFloatImageSelection(),t.setSelection(new x.SWH(t));break;case 2:t.addSelection(new x.SWH(t));break;case 1:var n={row:t.getActiveRowIndex(),col:t.getActiveColumnIndex()};t.setSelection(new x.SWH(t),n)}return!1}},{key:"mouseEnter",value:function(e){return this.hover=!0,!1}},{key:"mouseLeave",value:function(e){return this.isEmbed||(this.hover=!1),!1}}]),t}(k.FBaseWidget);hp([k.State],rg.prototype,"key",void 0),hp([k.State],rg.prototype,"hover",void 0),hp([k.State],rg.prototype,"editable",void 0),hp([k.State],rg.prototype,"width",void 0),hp([k.State],rg.prototype,"height",void 0),hp([k.State],rg.prototype,"background",void 0),hp([k.State],rg.prototype,"isEmbed",void 0),hp([k.State],rg.prototype,"borderCfg",void 0);var ig=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments)))._width=0,e._height=0,e._isOverDoc=!1,e._isDocumentReadonly=!0,e._editable=!1,e._rowEditable=!1,e._colEditable=!1,e._resizeEditable=!0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"getWidth",value:function(){return this._width}},{key:"setWidth",value:function(e){return this._width!==e&&(this._width=e,this.notifyListeners(),!0)}},{key:"getHeight",value:function(){return this._height}},{key:"setHeight",value:function(e){return this._height!==e&&(this._height=e,this.notifyListeners(),!0)}},{key:"getIsOverDoc",value:function(){return this._isOverDoc}},{key:"setIsOverDoc",value:function(e){this._isOverDoc!==e&&(this._isOverDoc=e,this.notifyListeners())}},{key:"getIsDocumentReadonly",value:function(){return this._isDocumentReadonly}},{key:"setIsDocumentReadonly",value:function(e){this._isDocumentReadonly!==e&&(this._isDocumentReadonly=e,this.notifyListeners())}},{key:"getEditable",value:function(){return this._editable}},{key:"setEditable",value:function(e){this._editable!==e&&(this._editable=e,this.notifyListeners())}},{key:"getRowEditable",value:function(){return this._rowEditable}},{key:"setRowEditable",value:function(e){this._rowEditable!==e&&(this._rowEditable=e,this.notifyListeners())}},{key:"getColEditable",value:function(){return this._colEditable}},{key:"setColEditable",value:function(e){this._colEditable!==e&&(this._colEditable=e,this.notifyListeners())}},{key:"getResizeEditable",value:function(){return this._resizeEditable}},{key:"setResizeEditable",value:function(e){this._resizeEditable!==e&&(this._resizeEditable=e,this.notifyListeners())}},{key:"updateDataBatch",value:function(e){var t=e.width,n=e.height,r=e.isOverDoc;void 0!==t&&(this._width=t),void 0!==n&&(this._height=n),void 0!==r&&(this._isOverDoc=r),this.notifyListeners()}}]),t}(k.ChangeNotifier),og=function(e){function t(e){return(0,h.Z)(this,t),(0,f.Z)(this,(0,p.Z)(t).call(this,"".concat(e,"_fillRect"),(function(){return{value:function(){return null},next:function(){return null}}})))}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"fill",value:function(e,t,n,r){if("string"==typeof t){var i=e.fillType;n.width+=1,n.height+=1,e.fillType=k.ColorThemeType.Background,this._fillStyle(e,(0,k.convertThemeColor)(r,t,k.ColorThemeType.Background),n),e.fillType=i}else this._fillPattern(e,t,n,r)}}]),t}(I.FFillLayer),ag=function(e){function t(e,n,r,i,o){var a;return(0,h.Z)(this,t),(a=(0,f.Z)(this,(0,p.Z)(t).call(this,e,n,i,o))).name=e,a._overflowByTextWidth=!1,a.fillRect=new og(e),!0===r&&(a._overflowByTextWidth=!0),a}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"_beforeRender",value:function(e){this.fillRect._beforeRender(e)}},{key:"_afterRender",value:function(e){this.fillRect._afterRender(e)}},{key:"_renderCell",value:function(e,t,n,r,i,o){var a=this.cell2Rect(n,r,t.rowCount,t.colCount,i);a.width-=vh.width,a.height-=vh.width,this.fillRect.fill(e,t.value,a,o)}},{key:"cell2Rect",value:function(e,t,n,r,i){var o=this._measure.cell2DocPos(e,t),a=this._measure.measureHeight(e,e+n),s=this._measure.measureWidth(t,t+r);if(this._overflowByTextWidth){var u=i.get("textLeft"),l=i.get("textRight"),c=Math.min(u&&u.getData(e,t)||0,0),h=Math.max(l&&l.getData(e,t)||0,s);return new k.FRect(o.x+c,o.y,h-c,a)}return new k.FRect(o.x,o.y,s,a)}},{key:"_iterFVGNode",value:function(e,t,n,r){var i={type:k.WidgetType.widget,cfg:{}},o=this.cell2Rect(t,n,e.rowCount,e.colCount,r);return Object.assign(i.cfg,o),"string"==typeof e.value&&Object.assign(i.cfg,{background:e.value}),i}}]),t}(I.FIterLayer);function sg(e){return null==e?void 0:e.inject(x.Vb3)}var ug,lg=function(e){function t(e){var n;return(0,h.Z)(this,t),(n=(0,f.Z)(this,(0,p.Z)(t).call(this))).zIndex=11,n.render=function(e,t,r,i){return new ag("highlight_layer",(function(e,t,r,i,o){return n.sheet.cellModel.iterVisibleCellSpan(e,t,r,i,o).map((function(e){var t=e.row,r=e.col,i=n.getHighlightColor(t,r);return n.enabled&&i?[Object.assign({value:i},Id(n.sheet,t,r)),e]:void 0})).filter((function(e){return!!e}))}),!1,void 0,(function(){return!n.cellColors||!n.cellColors.size}))},n.getHighlightColor=function(e,t){if(n.cellColors)return n.cellColors.get(e,t)},(0,j.aj)(e.pipe((0,fe.h)((function(e){return Boolean(e)}))),e.pipe((0,ce.w)((function(e){var t,n;return null!==(t=null===(n=sg(e))||void 0===n?void 0:n.enabled$)&&void 0!==t?t:(0,G.of)(!1)}))),e.pipe((0,ce.w)((function(e){var t,n;return null!==(t=null===(n=sg(e))||void 0===n?void 0:n.cellColors$)&&void 0!==t?t:(0,G.of)(new x.GfN)}))),e.pipe((0,ce.w)((function(e){var t,n;return null!==(t=null===(n=sg(e))||void 0===n?void 0:n.dirtyRect$)&&void 0!==t?t:(0,G.of)(void 0)})))).pipe((0,de.R)(n.dispose$)).subscribe((function(e){var t,r=(0,c.Z)(e,4),i=r[0],o=r[1],a=r[2],s=r[3];n.sheet=i,n.enabled=o,n.cellColors=a,null===(t=n.host)||void 0===t||t.refresh(s)})),n}return(0,v.Z)(t,e),t}(yv);function cg(e){return new lg(e.worksheet$)}!function(e){e[e.None=0]="None",e[e.UP=1]="UP",e[e.DOWN=2]="DOWN"}(ug||(ug={}));var hg=new I.FontMeasurer(I.TEXT_DEFAULT_FONT_STYLE.fontFamily,I.FontWeight.bold,I.TEXT_DEFAULT_FONT_STYLE.fontSize),dg=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).width=0,e.height=0,e.userRg=null,e.userLabelPosition=0,e.userLabelAvailableWidth=304,e.label=new I.FLabel(null),e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=this;if(this.userRg){var t=this.userRg,n=t.text,r=t.color,i=this.width,o=this.height,a={color:lf(r,{colorType:N.ColorType.BACKGROUND}),width:2},s={top:2===this.userLabelPosition?o:this.label.height>0?-this.label.height:-18},u=I.HorizontalAlign.Right,l=hg.measureWord(n);return this.userLabelAvailableWidth<l?(u=I.HorizontalAlign.Left,s.left=4):s.right=0,k.Stack.with({clip:!1}).fill((function(){return 0!==e.userLabelPosition?(e.label.updateByCfg({text:n,color:M.N00,background:r,hAlign:u,vAlign:I.VerticalAlign.Center,padding:[2,8],fontWeight:I.FontWeight.bold}),[k.SizedBox.with({width:i,height:o}).fill((function(){return k.BorderBox.with({border:a})})),k.Positioned.with(s).fill((function(){return(0,ye.widget2State)(e.label)}))]):[k.SizedBox.with({width:i,height:o}).fill((function(){return k.BorderBox.with({border:a})}))]}))}return null}},{key:"destroy",value:function(){(0,l.Z)((0,p.Z)(t.prototype),"destroy",this).call(this),this.label.destroy()}}]),t}(k.FBaseWidget);hp([k.State],dg.prototype,"width",void 0),hp([k.State],dg.prototype,"height",void 0),hp([k.State],dg.prototype,"userRg",void 0),hp([k.State],dg.prototype,"userLabelPosition",void 0),hp([k.State],dg.prototype,"userLabelAvailableWidth",void 0);var fg=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).rgs=[],e.hoverCell=null,e.editingCell=null,e.ignore=!0,e.view=null,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"initState",value:function(){var e=this,t=new z.w;return t.add(this.rgs$.subscribe((function(t){return e.rgs=t}))),t.add(this.hCell$.subscribe((function(t){return e.hoverCell=t}))),t.add(this.eCell$.subscribe((function(t){return e.editingCell=t}))),t}},{key:"describe",value:function(){var e=this;return this.view?k.Stack.with({clip:!1}).fill((function(){return e.rgs.map((function(t,n){var r=nv(e.view,t.range,2,2),i=r.x,o=r.y,a=r.width,s=r.height,u="CursorSelection"+n++,l=0,c=t.text,h=t.range.rowFrom(),d=t.range.colFrom(),f=t.userLabelAvailableWidth;if(e.editingCell){c=t.editorText;var p=e.editingCell,v=p.row,g=p.col;h===v&&d===g&&(l=Eg(v))}else if(e.hoverCell){var _=e.hoverCell,y=_.row,m=_.col;h===y&&d===m&&(l=Eg(y))}return k.Positioned.with({left:i,top:o,key:u}).fill((function(){return dg.with({width:a,height:s,userRg:Object.assign({},t,{text:c}),userLabelPosition:l,userLabelAvailableWidth:f})}))}))})):null}}]),t}(_v);hp([k.State],fg.prototype,"rgs$",void 0),hp([k.State],fg.prototype,"hCell$",void 0),hp([k.State],fg.prototype,"eCell$",void 0),hp([k.State],fg.prototype,"rgs",void 0),hp([k.State],fg.prototype,"hoverCell",void 0),hp([k.State],fg.prototype,"editingCell",void 0),hp([k.State],fg.prototype,"ignore",void 0),hp([k.State],fg.prototype,"view",void 0);var pg=function(e){function t(e,n,r,i){var o;(0,h.Z)(this,t),(o=(0,f.Z)(this,(0,p.Z)(t).call(this))).rgs$=new W.X([]),o.hCell$=new W.X(null),o.eCell$=new W.X(null);var a=(0,j.aj)(e,n).pipe(ne(16,void 0,{leading:!0,trailing:!0}),(0,le.map)((function(e){var t,n=(0,c.Z)(e,2),r=n[0],i=n[1];return t=!r||r._disposed?[]:o.rebuildCollabCursors(r,i),o.rgs$.next(t),t})));return(0,j.aj)(a,r.pipe(ne(16,void 0,{leading:!0,trailing:!0}))).pipe((0,de.R)(o.dispose$)).subscribe((function(e){var t=(0,c.Z)(e,2),n=t[0],r=t[1],i=o.rebuildHoverCell(n,r);o.hCell$.next(i)})),(0,j.aj)(a,i.pipe(ne(16,void 0,{leading:!0,trailing:!0}))).pipe((0,de.R)(o.dispose$)).subscribe((function(e){var t=(0,c.Z)(e,2),n=t[0],r=t[1],i=o.rebuildEditingCell(n,r);o.eCell$.next(i)})),o}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"dispose",value:function(){(0,l.Z)((0,p.Z)(t.prototype),"dispose",this).call(this),this.clearCursors(),this.rgs$.complete()}},{key:"render",value:function(e){return fg.with({view:e,key:"CursorSelections",rgs$:this.rgs$,hCell$:this.hCell$,eCell$:this.eCell$})}},{key:"clearCursors",value:function(){this.rgs$.next([])}},{key:"rebuildCollabCursors",value:function(e,t){var n=e.id(),r={},i=[];return t.forEach((function(e){var t=e.cursor_info;if(t&&t.sheet_id===n){var i=t.selection,o="".concat(i.row,"_").concat(i.col);r[o]=r[o]||[],r[o].push(e)}})),Object.keys(r).forEach((function(t){var n=r[t];if(0!==n.length){var o=n[0].cursor_info.selection,a=e.parent.getUserLanguage(),s=Gv(new x.e6w(o.row,o.col,1,1,e),e),u=gg(n,a),l=_g(n,a,u),c=e.getCellRect(o.row,o.col),h=c.x-e.getCellRect(0,0).x+c.width;i.push({range:s,color:n[n.length-1].color,userLabelAvailableWidth:h,text:u,editorText:l})}})),i}},{key:"rebuildHoverCell",value:function(e,t){var n=null;if(t){var r=t.row,i=t.col;e.some((function(e){var t=e.range.rowFrom(),o=e.range.colFrom();t===r&&o===i&&(n={row:r,col:i})}))}return n}},{key:"rebuildEditingCell",value:function(e,t){var n=null;if(t){var r=t.row,i=t.col;e.some((function(e){var t=e.range.rowFrom(),o=e.range.colFrom();t===r&&o===i&&(n={row:r,col:i})}))}return n}}]),t}(gv);function vg(e){var t=e.collabCursors$,n=e.worksheet$,r=e.hoverCell$,i=e.editingCell$;return new pg(n,t,r,i)}function gg(e,t){var n=mg(e),r="",i="";return n.length>3?(i=n.slice(0,2).map((function(e){return bg(e,t)})).join("、"),r=lc("common.cursor_hint_text",i,n.length-2)):(i=n.map((function(e){return bg(e,t)})).join("、"),r=i),yg(i,r)}function _g(e,t,n){var r=e.filter((function(e){var t;return 1===(null===(t=e.cursor_info)||void 0===t?void 0:t.editorStatus)}));if(0===r.length)return n||gg(e,t);var i=mg(r),o="",a="";return i.length>=2?(a=i.slice(0,2).map((function(e){return bg(e,t)})).join("、"),o=lc("LarkCCM_Sheets_EditCell_MultipleUserAreEditing",{userName:a,num:i.length})):(a=bg(i[0],t),o=lc("LarkCCM_Sheets_EditCell_UserIsEditing",{userName:bg(i[0],t)})),yg(a,o)}function yg(e,t){var n=304;if(hg.measureWord(t)<=n)return t;var r="..."+t.replace(e,"");return function(e,t){for(var n=0,r=e.length,i=0,o=0;n<=r;){var a=Math.floor((n+r)/2),s=e.substring(0,a),u=hg.measureWord(s);if(u<t)n=a+1,u>o&&(i=a,o=u);else{if(!(u>t))return s;r=a-1}}return e.substring(0,i)}(e,n-=hg.measureWord(r))+r}function mg(e){var t=new Set;return e.filter((function(e){var n=e.user_id;return!t.has(n)&&(t.add(n),!0)}))}function Eg(e){return 0===e?2:1}function bg(e,t){var n=function(e,t){var n=e.display_name;if(n){var r,i=n.i18n_value;return i?("zh"===t?r=i.zh_cn:"en"===t?r=i.en_us:"ja"===t&&(r=i.ja_jp),r=r||n.value):n.value}}(e,t);return n||(n="zh"===t?e.cn_name||e.en_name:"en"===t?e.en_name||e.cn_name:e.user_name||e.en_name)}var Tg,Cg=function(){function e(t){(0,h.Z)(this,e),this._layout=t,this.gLWs=new Map,this.tables=null}return(0,d.Z)(e,[{key:"registerGridShell",value:function(e,t){if(this.gLWs.has(e))throw new Error("[GridLayoutManager]: layer ".concat(e," already registered!"));this.gLWs.set(e,t),this.reLayout()}},{key:"registerTableViews",value:function(e){this.tables=e}},{key:"reLayout",value:function(){var e=this,t=this.gLWs.size;Array.from(this.gLWs).sort((function(e,t){var n=(0,c.Z)(e,1)[0];return(0,c.Z)(t,1)[0]-n})).forEach((function(n,r){var i=(0,c.Z)(n,2),o=(i[0],i[1]),a=o.corner,s=o.rowAreas,u=o.colAreas;e._layout.changeElementParams(a,r,r),s.forEach((function(n,i){1===s.length?e._layout.changeElementParams(n,r,r+1,1,t-r+2-1):e._layout.changeElementParams(n,r,r+1+i)})),u.forEach((function(n,i){1===u.length?e._layout.changeElementParams(n,r+1,r,t-r+2-1,1):e._layout.changeElementParams(n,r+1+i,r)}))}));var n=this.tables;this._layout.changeElementParams(n.tl,t,t),this._layout.changeElementParams(n.tr,t+1,t),this._layout.changeElementParams(n.bl,t,t+1),this._layout.changeElementParams(n.br,t+1,t+1)}},{key:"dispose",value:function(){this.gLWs.clear()}}]),e}();!function(e){e.ROW="BorderRow",e.COL="BorderCol"}(Tg||(Tg={}));var Sg=function(e){function t(e,n){var r;return(0,h.Z)(this,t),(r=(0,f.Z)(this,(0,p.Z)(t).call(this,"cell_border_layer",null,["BorderRow","BorderCol"])))._iterSpan=e,r._tableView=n,r._isNeededFirstLine=!1,r.drawBorder=new Ee.ContinuouslyDrawBorder,r}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"_iterBorder",value:function(e,t,n,r){var i=this;if(null!==this._measure){var o=this._measure,a=new k.FPoint(e.x,e.y),s=new k.FPoint(e.x+e.width-gh.width,e.y+e.height-gh.width),u=o.docPos2Cell(a),l=o.docPos2Cell(s);u.row!==o.fromRow()&&(u.row-=1),u.col!==o.fromCol()&&(u.col-=1);var h=t.get("BorderCol"),d={};h.each((function(e,t){return wg(d,t,[e,e])}));var f={},p={};this._iterSpan(u.row,u.col,l.row,l.col).forEach((function(e){var t=(0,c.Z)(e,2),n=t[0],r=t[1],o=n.rowFrom(),a=n.rowTo(),s=i._tableView.sheet()._getRowInfos().firstVisible(o,a,!0);if(s)for(var u=r.rowFrom();u<=r.rowTo()&&u!==s.index;++u){var l=r.colFrom(),h=r.colTo();wg(f,u,[l,h])}var d=n.colFrom(),v=n.colTo(),g=i._tableView.sheet()._getColInfos().firstVisible(d,v,!0);if(g)for(var _=r.colFrom();_<=r.colTo()&&_!==g.index;++_){var y=r.rowFrom(),m=r.rowTo();wg(p,_,[y,m])}})),Object.keys(f).forEach((function(e){f[e].sort((function(e,t){return e[0]-t[0]}))})),Object.keys(d).forEach((function(e){d[e].sort((function(e,t){return e[0]-t[0]}))})),Object.keys(p).forEach((function(e){p[e].sort((function(e,t){return e[0]-t[0]}))}));var v=f,g=function(e,t){return Object.keys(e).forEach((function(n){t[n]&&(t[n]=function(e,t){for(var n=[],r=0,i=0,o=e.length,a=t.length;r<o&&i<a;)e[r][0]<t[i][0]?(n.push(e[r]),r++):e[r][0]>t[i][0]?(n.push(t[i]),i++):(e[r][1]<t[i][1]?n.push(t[i]):n.push(e[r]),r++,i++);for(;r<o;)n.push(e[r]),r++;for(;i<a;)n.push(t[i]),i++;return n}(e[n],t[n]))})),Object.assign(e,t)}(d,p),_=o.rowPos(u.row),y=_-1,m=o.colPos(u.col),E=o.colPos(l.col+1);this._isNeededFirstLine&&n(m,_,E,_,u.row-1);var b=0;this._tableView.sheet()._getRowInfos().iter(u.row,l.row).filter((function(e){return e.value>0})).map((function(e){return b=e.value,new x.FfW(e)})).flatten().forEach((function(e){if(y+=b,v[e]){var t=[m];v[e].forEach((function(e){var n=o.colPos(e[0]),r=o.colPos(e[1]+1);t.push(n,r)})),t.push(E);for(var r=0;r<t.length;r+=2)n(t[r],y,t[r+1],y)}else n(m,y,E,y)}));var T=o.colPos(u.col),C=T-1,S=o.rowPos(u.row),w=o.rowPos(l.row+1);this._isNeededFirstLine&&n(T,S,T,w,u.col-1);var R=0;this._tableView.sheet()._getColInfos().iter(u.col,l.col).filter((function(e){return e.value>0})).map((function(e){return R=e.value,new x.FfW(e)})).flatten().forEach((function(e){if(C+=R,g[e]){var t=[S];g[e].forEach((function(e){var n=o.rowPos(e[0]),r=o.rowPos(e[1]+1);t.push(n,r)})),t.push(w);for(var r=0;r<t.length;r+=2)n(C,t[r],C,t[r+1])}else n(C,S,C,w)}))}}},{key:"render",value:function(e,t,n){var r=this,i=(0,k.convertThemeColor)(this._tableView,gh.color,k.ColorThemeType.Border),o=e.fillType;e.fillType=k.ColorThemeType.Border,this.drawBorder.start(e,gh.width,i),this._iterBorder(t,n,(function(t,n,i,o){r.drawBorder.continueDrawline(e,t,n,i,o)}),e),this.drawBorder.end(e),e.fillType=o}},{key:"firstLine",value:function(e){this._isNeededFirstLine=e}},{key:"fvgNode",value:function(e,t){var n=[];return this.isEnabled()&&this._iterBorder(e,t,(function(e,t,r,i){var o={type:k.WidgetType.widget,cfg:{}},a=r-e,s=i-t;if(!(a<=0&&s<=0)){var u=gh.color;o.cfg={x:e,y:t,width:a||gh.width,height:s||gh.width,background:u},n.push(o)}})),n}}]),t}(I.FLayer);function wg(e,t,n){e[t]=e[t]||[],e[t].push(n)}function Rg(e,t){var n=t.sheet,r=t.measurer,i=t.rowFrom,o=t.colFrom,a=t.rowTo,s=t.colTo,u=t.iterCtx,l=t.context,c=t.viewModel,h=e.factory,d=function(e,t){var n=t.get(e);return n||(n=new I.RowColRenderData,t.set(e,n),n)}(h.anchor(),l);return e.iterVisible(n,i,o,a,s,u).map((function(t){var i=t.row,o=t.col;if("dropdown"!==e.name||n.isCellEditable(i,o)){var a;if(a=h.widget(c,i,o)){var s=function(e,t,n,r,i){if(!i){var o=function(e,t,n){var r=e._getSpanModel().find(t,n);return r?{rowFrom:r.rowFrom(),colFrom:r.colFrom(),rowTo:r.rowTo(),colTo:r.colTo()}:null}(e,n,r);if(o)return{width:t.measureWidth(o.colFrom,o.colTo+1),height:t.measureHeight(o.rowFrom,o.rowTo+1)}}return{width:t.measureWidth(r,r+1),height:t.measureHeight(n,n+1)}}(n,r,i,o,"filter"===e.name),u=s.width,l=s.height,f=n.getCellPadding(),p=n.getStyle(i,o),v=d.getData(i,o);return v||(v=0),function(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=0,u=0,l=0,c=0;e<o&&(s=e,l=-e,i.updateByCfg({width:i.width+e}),e=0),t<a&&(u=t,c=-t,i.updateByCfg({height:i.height+t}),t=0),e+i.width+o>n&&(l=e+i.width-n,i.updateByCfg({width:i.width-l})),t+i.height+a>r&&(c=t+i.height-r,i.updateByCfg({height:i.height-c})),0===s&&0===u&&0===c&&0===l||i.clip(s,u,l,c),i.updateByCfg({x:e,y:t})}(e.getX(u,v,f),e.getY(l,f,p.vAlign),u,l,a),a.width<=0||a.height<=0?void 0:(v+=e.getWidth(f),d.setData(i,o,v),[[a],t])}}})).filter((function(e){return!!e}))}var Ag={getX:function(e,t){return e-t-this.factory.iconSize()},getY:function(){return 0},getWidth:function(){return this.factory.iconSize()}},Og={getX:function(e,t,n){return e-t-this.factory.iconSize()-n[1]},getY:function(e,t){return e-this.factory.iconSize()-t[2]},getWidth:function(e){return this.factory.iconSize()+e[1]}},Mg={getX:function(e,t,n){return e-t-this.factory.iconSize()-n[1]},getY:function(e,t,n){switch(n){case I.VerticalAlign.Bottom:return e-this.factory.iconSize()-t[2];case I.VerticalAlign.Center:return(e-this.factory.iconSize())/2;default:return t[2]}},getWidth:function(e){return this.factory.iconSize()+e[1]}},kg={getX:function(e,t,n){return n[3]+t},getY:function(e,t,n){switch(n){case I.VerticalAlign.Bottom:return e-this.factory.iconSize()-t[2]-2;case I.VerticalAlign.Center:return(e-this.factory.iconSize())/2;default:return t[2]+2}},getWidth:function(e){return this.factory.iconSize()+e[3]}},Ig=Object.assign({factory:new pp,name:"filterSort"},Og,{iterVisible:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.cellModel.iterVisibleCell.apply(e.cellModel,n)}}),xg=Object.assign({factory:new _p,name:"collapse"},kg,{iterVisible:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.cellModel.iterVisibleCell.apply(e.cellModel,n)}}),Ng=Object.assign({factory:new cp,name:"dropdown"},Mg,{iterVisible:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.cellModel.iterVisibleDataValidation.apply(e.cellModel,n).filter((function(e){return(0,x.Ju9)(e[0])&&!e[0].options.isDropdownIconHiddenInCell})).map((function(e){return e[1]}))}}),Pg=Object.assign({factory:new Lf,name:"comment"},Ag,{getX:function(e){return e-this.factory.iconSize()-1},iterVisible:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.cellModel.iterVisibleComment.apply(e.cellModel,n).map((function(e){return e[1]}))}}),Lg=Object.assign({factory:new Cp,name:"tips"},{getX:function(e,t){return t},getY:function(){return 0},getWidth:function(){return this.factory.iconSize()}},{getWidth:function(){return this.factory.iconSize()},iterVisible:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.cellModel.iterVisibleContent.apply(e.cellModel,n).map((function(e){return e[1]}))}}),Dg=Object.assign({factory:new Yp,name:"iconSet"},{getX:function(e,t,n){return n[3]+t},getY:function(e){return(e-this.factory.iconSize())/2},getWidth:function(){return this.factory.iconSize()}},{iterVisible:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(t=e.cellModel).iterVisibleCellSpan.apply(t,r)}}),Fg=Object.assign({factory:new qp,name:"invalidateIcon"},Ag,{getX:function(e){return e-this.factory.iconSize()-1},iterVisible:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.cellModel.iterVisibleContent.apply(e.cellModel,n).map((function(e){return e[1]}))}}),Bg=Object.assign({factory:new Qp,name:"cellNoteIcon"},Ag,{getX:function(e){return e-this.factory.iconSize()-1},iterVisible:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.cellModel.iterVisibleNote.apply(e.cellModel,n).map((function(e){return e[1]}))}});function Vg(e){return Rg(Ig,e)}function Hg(e){return Rg(xg,e)}function Ug(e){return Rg(Ng,e)}function Zg(e){return Rg(Pg,e)}function Wg(e){return Rg(Lg,e)}function jg(e){return Rg(Dg,e)}function Gg(e){return Rg(Fg,e)}function zg(e){return Rg(Bg,e)}var Yg=function(e){function t(){return(0,h.Z)(this,t),(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"continueDrawDiagonal",value:function(e,t,n,r,i,o){o&&e.strokeStyle!==o&&(e.strokeStyle=o);var a=this.t;t=Math.round(a.mapPointX(t,0)),r=Math.round(a.mapPointX(r,0)),n=Math.round(a.mapPointY(0,n)),i=Math.round(a.mapPointY(0,i)),(0,Ee.drawLine)(e,t,n,r,i)}}]),t}(Ee.ContinuouslyDrawBorder),Xg=function(e){function t(e){var n;return(0,h.Z)(this,t),(n=(0,f.Z)(this,(0,p.Z)(t).call(this,"stroke_layer",e))).isNeededFirstLine=!1,n.calcBorderOffset=function(e){return((null==e?void 0:e.width)||1)/2},n.drawBorder=new Yg,n}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"_beforeRender",value:function(e){this.drawBorder.start(e,1,void 0)}},{key:"_afterRender",value:function(e){this.drawBorder.end(e)}},{key:"_renderCell",value:function(e,t,n,r,i,o){var a=this,s=i.get("BorderCol"),u=this._cell2Rect(n,r,t.rowCount,t.colCount),l=u.width,h=u.height,d=u.x-1,f=u.y-1,p=t.borderTop,v=t.borderRight,g=t.borderBottom,_=t.borderLeft,y=(0,k.QuaterSplit)(void 0,{width:0,color:""},p,v,g,_),m=(0,c.Z)(y,4),E=m[0],b=m[1],T=m[2],C=m[3],S=e.fillType;e.fillType=k.ColorThemeType.Border;var w=e.strokeType;e.strokeType=k.ColorThemeType.Border;var R,A,O=function(t,n,r,i,s){s.width<=0||a.drawBorder.continueDrawline(e,t,n,r,i,Ee.Operation.plus,(0,k.convertThemeColor)(o,s.color,k.ColorThemeType.Border))},M=-1===f&&this.isNeededFirstLine,I=-1===d&&this.isNeededFirstLine;this.drawDiagonalLine(e,d,f,l,h,t,-1===f,-1===d,o),E.width&&O(I?d+1:d,A=M?f+1:f,R=d+l+E.width,A,E),b.width&&!s.getData(n,r)&&O(R=d+l,M?f+1:f,R,A=f+h+b.width,b),T.width&&O(d+l+T.width,A=f+h,R=I?d+1:d,A,T),C.width&&!s.getData(n,r-1)&&O(R=I?d+1:d,f+h+C.width,R,A=M?f+1:f,C),e.fillType=S,e.strokeType=w}},{key:"drawDiagonalLine",value:function(e,t,n,r,i,o,a,s,u){var l=this;if(Z.Ps3.getAddDiagonalEnabled()){var c=o.borderTop,h=o.borderRight,d=o.borderBottom,f=o.borderLeft,p=o.diagonal,v=o.diagonalUp,g=o.diagonalDown;if(null!=p&&p.width){var _=function(t,n,r,i,o){o.width<=0||l.drawBorder.continueDrawDiagonal(e,t,n,r,i,(0,k.convertThemeColor)(u,o.color,k.ColorThemeType.Border))},y=this.calcBorderOffset(c),m=this.calcBorderOffset(f),E=this.calcBorderOffset(h),b=this.calcBorderOffset(d);v&&_(t+m+(s?1:0),n+i+b,t+r+E,n+y+(a?1:0),p),g&&_(t+m+(s?1:0),n+y+(a?1:0),t+r+E,n+i+b,p)}}}},{key:"_cell2Rect",value:function(e,t,n,r){var i=this._measure.cell2DocPos(e,t),o=this._measure.measureHeight(e,e+n),a=this._measure.measureWidth(t,t+r);return new k.FRect(i.x,i.y,a,o)}},{key:"_iterFVGNode",value:function(e,t,n,r){var i=e.border,o=e.borderTop,a=e.borderRight,s=e.borderBottom,u=e.borderLeft;if(!(i||o||a||s||u))return null;var l=r.get("BorderCol"),h=(0,k.QuaterSplit)(i,{width:0,color:""},o,a,s,u),d=(0,c.Z)(h,4),f=d[0],p=d[1],v=d[2],g=d[3],_={type:k.WidgetType.widget,cfg:{}},y=this._cell2Rect(t,n,e.rowCount,e.colCount);return f.width&&(0!==t&&(y.y-=f.width,y.height+=f.width),Object.assign(_.cfg,{borderTop:o})),p.width&&!l.getData(t,n)&&Object.assign(_.cfg,{borderRight:a}),v.width&&Object.assign(_.cfg,{borderBottom:s}),g.width&&!l.getData(t,n-1)&&(0!==n&&(y.x-=g.width,y.width+=g.width),Object.assign(_.cfg,{borderLeft:u})),Object.assign(_.cfg,y),_}},{key:"firstLine",value:function(e){this.isNeededFirstLine=e}}]),t}(I.FIterLayer);function Kg(){var e={x:0,y:0},t={x:0,y:0};return{hook:function(n){if(n.type===k.FEventType.MouseDown){var r=n;return e.x=r.x,void(e.y=r.y)}if(n.type===k.FEventType.MouseUp){var i=n;return t.x=i.x,void(t.y=i.y)}},isLegallyClick:function(){return Math.abs(t.x-e.x)<2&&Math.abs(t.y-e.y)<2}}}var qg=function(e){function t(e,n){var r;return(0,h.Z)(this,t),(r=(0,f.Z)(this,(0,p.Z)(t).call(this,null))).onClick=e,r.disable=n,r}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"active",value:function(e){return!this.disable&&this.onClick(e)}},{key:"doubleActive",value:function(){return!0}}]),t}(I.FCheckboxWithoutLabel);qg=hp([function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Vd,n={};return function(r){(0,A.Z)(e,(function(e,i){var o=r.prototype;if(o[i])return n[i]="",e.forEach((function(e){var r=o[e],a=!1;o[e]=function(){for(var s,u=arguments.length,l=new Array(u),c=0;c<u;c++)l[c]=arguments[c];t.callOriginalEventHandler&&r&&r.call.apply(r,[this].concat(l));var h=t.allowPreEvents||{},d=n[i]&&h[n[i]]&&h[n[i]]===e,f=t.allowMarkAsIntegratedEvent===e;return n[i]&&n[i]!==e&&!d?(f&&(n[i]=e),a):(n[i]=e,a=(s=o[i]).call.apply(s,[this].concat(l)))}})),r;console.warn("no ".concat(i," handler found for target"))}))}}({active:["tap","click"],doubleActive:["doubleTap","doubleClick"]})],qg);var $g="CheckBox",Jg=new Map;function Qg(e,t){var n=Jg.get(e.type);if(n)return n(e.props,t)}Jg.set($g,(function(e,t){var n,r=new qg(e.onClick,e.disabled),i=t.getPoint(),o=e.checkboxHeight||16,a=e.checkboxWidth||16,s=t.getCellWidth(),u=t.getCellHeight(),l=t.getCellPadding(),h=t.getStyleWithConditionalFormat(),d=t.getCellHAlign(),f=function(e){var t,n,r=e.baseX,i=e.baseY,o=(0,c.Z)(e.padding,4),a=o[0],s=o[1],u=o[2],l=o[3],h=e.cellWidth,d=e.cellHeight,f=e.height,p=e.width,v=e.hAlign,_=void 0===v?Z.KqL.Center:v,y=e.vAlign,m=void 0===y?I.VerticalAlign.Center:y,E=function(){return(h-p)/2},b=(t={},(0,g.Z)(t,Z.KqL.Left,(function(){return l})),(0,g.Z)(t,Z.KqL.Right,(function(){return h-s-p})),(0,g.Z)(t,Z.KqL.Center,E),(0,g.Z)(t,Z.KqL.General,E),t),T=(n={},(0,g.Z)(n,I.VerticalAlign.Top,(function(){return a})),(0,g.Z)(n,I.VerticalAlign.Center,(function(){return(d-f)/2})),(0,g.Z)(n,I.VerticalAlign.Bottom,(function(){return d-u-f})),n);return{x:Math.floor(b[_]())+r,y:Math.floor(T[m]())+i}}({baseX:i.x,baseY:i.y,height:o,width:a,cellWidth:s,cellHeight:u,padding:l,vAlign:h.vAlign,hAlign:d}),p=f.x,v=f.y,_=function(e,t){var n=e||Z.vYI;return"number"!=typeof t||1===t?n:lf(n,{colorType:N.ColorType.FOREGROUND,alpha:t})},y=_(h.foreColor),m=p-i.x,E=v-i.y,b=e.disabled,T=y,C=b?T:_(h.foreColor,.8);return(a+l[1]+l[3]>s||o+l[0]+l[2]>u)&&(n=[-m,-E,s,u]),r.updateByCfg({x:p,cursor:b?void 0:"pointer",y:v,width:a,height:o,noCheckBorderWidth:1,checked:e.checked,checkedBackground:T,checkedHoverBackground:C,noCheckBackground:"transparent",noCheckHoverBackground:"transparent",noCheckBorderColor:T,noCheckBorderHoverColor:C,iconColor:"--static-white",disabled:b,clip:n}),r}));var e_=function(){function e(){var t=this;(0,h.Z)(this,e),this.tables=new x.GfN,this.delete=function(e,n){return t.tables.delete(e,n)},this.get=function(e,n){return t.tables.get(e,n)}}return(0,d.Z)(e,[{key:"append",value:function(e,t,n){var r=this.tables.get(e,t);r||(r=[],this.tables.set(e,t,r)),r.push(n)}},{key:"forEach",value:function(e){this.tables.forEach((function(t,n,r){return e(n,r,t)}))}},{key:"size",value:function(){return this.tables.size}},{key:"clear",value:function(){this.tables.clear()}}]),e}();var t_=function(){function e(){var t=this;(0,h.Z)(this,e),this.renderProviders=new Map,this.register=function(e,n){t.renderProviders.set(e,n)}}return(0,d.Z)(e,[{key:"iter",value:function(e,t,n,r,i){if(!(this.renderProviders.size<=0)){var o=new e_;this.renderProviders.forEach((function(e){(0,e.cellDataIterCreator)(n.rowFrom,n.colFrom,n.rowTo,n.colTo,r).forEach((function(e){if(e){var t=(0,c.Z)(e,2),n=t[0],r=t[1];Array.isArray(n)?n.forEach((function(e){return o.append(r.row,r.col,e)})):o.append(r.row,r.col,n)}}))})),o.forEach((function(n,r,o){var a=o.map((function(i){return{widget:Qg(i,{getPoint:function(){return t.cell2DocPos(n,r)},getCellHeight:function(){return e.getCellHeight(n,r,!0)},getCellWidth:function(){return e.getCellWidth(n,r,!0)},getStyleWithDropdownAndConditionalFormat:function(){return e.getStyleWithDropdownAndConditionalFormat(n,r)},getStyleWithConditionalFormat:function(){return e.getStyleWithConditionalFormat(n,r)},getCellPadding:function(){return e.getCellPadding()},getCellActualStyle:function(){return e.getActualStyle(n,r)},getCellHAlign:function(){return e.getCellHAlign(n,r)}}),renderInfo:i}}));i(n,r,a)}))}}}]),e}(),n_=!1,r_={};var i_=function(e){return e?mf(e,k.ColorThemeType.Color):void 0},o_=function(e){return mf(e,k.ColorThemeType.Background)};function a_(e,t,n,r){if(t!==I.TextDecoration.None){var i=e.strokeType;e.strokeStyle=e.fillStyle;var o=Math.floor(Math.max(n-12,0)/21+1);e.lineWidth=o;var a=r.x,s=r.width;if(t&I.TextDecoration.Bottom){var u=r.maxY-(r.height-n)/2;u=Math.min(r.maxY-o,u),e.beginPath(),e.moveTo(a,u),e.lineTo(a+s,u),e.stroke()}if(t&I.TextDecoration.Mid){var l=r.y+r.height/2;e.beginPath(),e.moveTo(a,l),e.lineTo(a+s,l),e.stroke()}if(t&I.TextDecoration.Top){var c=r.y+(r.height-n)/2;e.beginPath(),e.moveTo(a,c),e.lineTo(a+s,c),e.stroke()}e.strokeType=i}}function s_(e,t){return function(n){return n?(0,k.convertThemeColor)(e,n,t):void 0}}var u_=function(e){function t(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,h.Z)(this,t),(r=(0,f.Z)(this,(0,p.Z)(t).call(this,"typography_layer",null))).doc=e,r._tableView=n,r.ignoreCellOverflow=i,r.widgetCache=new e_,r.renderAssistant=new t_,r.registerRenderProvider=r.renderAssistant.register,r.clickSimulate=Kg(),r}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"reset",value:function(){this.widgetCache.clear()}},{key:"updateViewRect",value:function(e,t,n,r){var i=this,o=this._tableView.sheet();if(this._measure&&o){var a=this._measure,s=r.lastRowColRect,u=r.lastViewRect,l=r.newRowColRect,c=r.newViewRect;u.containRect(c)||(this.widgetCache.size()>1e4&&this.widgetCache.forEach((function(e,t,n){n.forEach((function(e){return e.widget.destroy()})),i.widgetCache.delete(e,t)})),l.sub(s).forEach((function(e){i.renderAssistant.iter(o,a,function(e){return{rowFrom:e.y,colFrom:e.x,rowTo:e.maxY-1,colTo:e.maxX-1}}(e),r,(function(e,t,r){var o=i.widgetCache.get(e,t);o&&o.forEach((function(e){return e.widget.destroy()})),r.forEach((function(r){var o=r.widget,a=r.renderInfo;i.widgetCache.append(e,t,{widget:o,renderInfo:a}),o.setParent(n)}))}))})))}}},{key:"render",value:function(e,t,n,r,i){if(null!==this._measure){e.save(),this.ignoreCellOverflow&&(e.beginPath(),(0,Ee.preciseRect)(e,t),e.clip());for(var o,a=c_(this._tableView.getSheetView().getViewModel(),this._tableView.sheet(),i.renderRange,i.iterCtx,this.ignoreCellOverflow),s=a.next();null!==s;s=a.next())this._renderCell(e,s[0],s[1].row,s[1].col,n,r);this.flush(e),n_||(null!==(o=Z.Ps3.collectSheetEvent)&&void 0!==o&&o.call(Z.Ps3,"ccm_sheet_rich_text_usage_dev",r_),r_={},n_=!0),e.restore()}}},{key:"flush",value:function(e){var t;null!==(t=this.rPainter)&&void 0!==t&&t.flush(e),this.rPainter=void 0}},{key:"shouldRenderCell",value:function(e,t){var n=this.widgetCache.get(e,t);return!n||!n.some((function(e){return"CheckBox"===e.renderInfo.type}))}},{key:"_renderCell",value:function(e,t,n,r,i,o){if(this.shouldRenderCell(n,r)&&this._measure){var a=this._measure.cell2DocPos(n,r),s=a.x+t.offset.x,u=a.y+t.offset.y,l=t.clip;if(l){e.save(),e.beginPath();var c=l.clone().move(a.x,a.y);e.rect(c.x,c.y,c.width,c.height),e.clip()}if(e.translate(s,u),t.background){var h=e.fillType;e.beginPath(),f_(e,this._backgroundRect(t)),e.fillStyle=(0,k.convertThemeColor)(o,t.background,k.ColorThemeType.Background),e.fillType=k.ColorThemeType.Background,e.fill(),e.fillType=h}var d=function(e,t){return(0,k.convertThemeColor)(o,e,t)};if(0===t.type){var f,p=ml.createTypographyPainter(t.typher);p.convertThemeColor=d,p.setInsetSegPainter(function(e){var t=s_(e,k.ColorThemeType.Color),n=s_(e,k.ColorThemeType.Background);return{paint:function(e,r,i){if(r.inset.customData&&(r.inset.customData.text||r.inset.customData.customSegs)){e.save(),e.textBaseline="middle";var o=r.inset.customData,a=o.style,s=a&&a.fontInfo||i.fontInfo,u=i.fontInfo,l=s.fontSize||u&&u.fontSize||12,c=s.fontFamily||u&&u.fontFamily||"Arial",h=s.fontStyle||u&&u.fontStyle||"normal",d=s.fontWeight||u&&u.fontWeight||400,f=e.fillType,p=o.background&&n(o.background);if(p){e.beginPath(),e.fillType=k.ColorThemeType.Background;var v=r.rect.width-Z.Y_J.margin[1]-Z.Y_J.margin[3],g=r.rect.height-Z.Y_J.margin[0]-Z.Y_J.margin[2];f_(e,new k.FRect(r.rect.x+Z.Y_J.margin[3],r.rect.y+Z.Y_J.margin[0],v,g)),e.fillStyle=p,e.fill()}var _=o.text;if(_){var y=t(a&&a.color||i.color);e.font=(0,I.fontString)({fontSize:l,fontFamily:c,fontStyle:h,fontWeight:d}),e.fillStyle=y,e.fillType=k.ColorThemeType.Color,e.textAlign="center";var m=r.rect.y+r.rect.height/2,E=r.rect.x+r.rect.width/2;e.fillText(_,E,m);var b=(void 0!==a.decoration?a.decoration:i.decoration)||I.TextDecoration.None,T=p?r.rect.x+Z.Y_J.padding[1]:r.rect.x,C=p?r.rect.width-Z.Y_J.margin[1]-2*Z.Y_J.padding[1]:r.rect.width,S=new k.FRect(T,r.rect.y,C,r.rect.height);a_(e,b,l,S)}else o.customSegs.forEach((function(n){var o=n.text;if(o){var a=n.style,s=t(a&&a.color||i.color);e.font=(0,I.fontString)({fontSize:l,fontFamily:c,fontStyle:h,fontWeight:d}),e.fillStyle=s,e.fillType=k.ColorThemeType.Color,e.textAlign="left";var u=r.rect.y+r.rect.height/2,f=p?r.rect.x+n.x+Z.Y_J.padding[1]+Z.Y_J.margin[3]:r.rect.x+n.x;e.fillText(o,f,u);var v=(void 0!==a.decoration?a.decoration:i.decoration)||I.TextDecoration.None,g=new k.FRect(f,r.rect.y,n.width,r.rect.height);a_(e,v,l,g)}}));e.textBaseline="alphabetic",e.fillType=f,e.restore()}}}}(o)),p.paintLines(e,new k.FPoint(s,u),!!l),this.rPainter||l||(this.rPainter=p);var v=null===(f=t.typher.rImage)||void 0===f?void 0:f.images;if(null!=v&&v.length){var g=t.typher.visualInfo(),_=new k.FRect(s+g.x,u,g.width,g.height);this._repaintWhenImagesLoaded(_,o,v)}}else{var y=t.typher;y.convertThemeColor=d,y.paint(e)}e.translate(-s,-u),t.clip&&e.restore();var m=t.typher.visualInfo(),E=t.offset.x+m.x,b=E+m.width;if(t.clip&&(E=Math.max(t.clip.x,E),b=Math.min(t.clip.maxX,b)),this._setBorderData(i,n,r,a,E,b),this._tableView.sheet().getHighlightCell(n,r)){var T=i.get("textLeft"),C=i.get("textRight");T||(T=new I.RowColRenderData,i.set("textLeft",T)),C||(C=new I.RowColRenderData,i.set("textRight",C)),T.setData(n,r,E),C.setData(n,r,b)}}}},{key:"_repaintWhenImagesLoaded",value:function(e,t,n){Promise.all(n).then((function(){var n;null!==(n=t.markDirtyRect)&&void 0!==n&&n.call(t,e),t.markChildDirty()}))}},{key:"event",value:function(e){var n=Kf.injectableStaticConfig;if(n.contentLayer.simulateEnabled&&this.clickSimulate.hook(e),e.type===k.FEventType.Tap){var r=e;this._click(r.center,e)}else if(e.type===k.FEventType.Click&&n.contentLayer.clickEventEnabled&&this.clickSimulate.isLegallyClick()){var i=e;this._click(new k.FPoint(i.x,i.y),e)}else e.type===k.FEventType.MouseMove?this._onMouseMove(e):e.type===k.FEventType.MouseLeave&&this._onMouseLeave(e);return(0,l.Z)((0,p.Z)(t.prototype),"event",this).call(this,e)}},{key:"_onMouseLeave",value:function(e){var t=this._tableView&&this._tableView.getSheetView();null!=t&&t.shellWatcher.dispatch("ContentLeave"),null==t||t.shellWatcher.dispatch("HideReminderTooltip")}},{key:"_onMouseMove",value:function(e){var t=this._segInfo(new k.FPoint(e.x,e.y),e);if(null!==t){var n=this._tableView.sheet(),r=this._tableView&&this._tableView.getSheetView();if(null!=r&&r.shellWatcher.dispatch("SegHover",{sheet:n,sheetName:n.name(),info:t}),null!==t.seg){var i=t.typher.stream().styles(),o=t.charPos,a=i.lbound({rg:{from:o,to:o}},!0);if(-1===a)return;if(t.reminderIconRect){var s=null==r?void 0:r.getViewModel().typography.typographyInfo(t.row,t.col);if(s&&0===s.type){var u,l,c=s.offset,h=c.x,d=c.y,f=t.reminderIconRect,p=f.x,v=f.y,g=f.width,_=null!==(u=null===(l=this._measure)||void 0===l?void 0:l.cell2DocPos(t.row,t.col))&&void 0!==u?u:{x:0,y:0},y=new k.FPoint(p+h+_.x+g/2,v+d+_.y),m=e.target.mapToGlobal(y);null!=r&&r.shellWatcher.dispatch("ShowReminderTooltip",{x:m.x,y:m.y,row:t.row,col:t.col,sheet:n}),(0,x.Xy9)({action:"hover_clock_icon"})}return void e.target.updateByCfg({cursor:"pointer"})}null==r||r.shellWatcher.dispatch("HideReminderTooltip");var E=i.at(a);if(E.rg.from<=o&&o<=E.rg.to){var b=E.style.cursor||"default";return void e.target.updateByCfg({cursor:b})}}null!=r&&r.shellWatcher.dispatch("HideReminderTooltip"),e.target.updateByCfg({cursor:"default"})}e.target===this.doc&&e.target.updateByCfg({cursor:"default"})}},{key:"_click",value:function(e,t){var n=this._segInfo(e,t);if(null!==n&&null!==n.seg){var r,i=this._tableView.sheet();null===(r=this._tableView&&this._tableView.getSheetView())||void 0===r||r.shellWatcher.dispatch("SegClicked",{sheet:i,sheetName:i.name(),info:n})}}},{key:"_segInfo",value:function(e,t){if(e=this.doc.mapFromGlobal(t.target.mapToGlobal(e)),null===this._tableView)return null;var n=this._tableView.sheet();if(null===n)return null;var r=this._measure.docPos2Cell(e),i=r.row,o=r.col,a=n._getSpanModel().find(i,o);null!==a&&(i=a.rowFrom(),o=a.colFrom());var s=null;if(n.getVar(i,o)!==El.NULL_VAR)s=this._hitCellInfo(i,o,e,t);else if(null===s){var u=d_(n,i,o);null!==u&&(s=this._hitCellInfo(i,u,e,t));var l=h_(n,i,o);null!==l&&(s=s||this._hitCellInfo(i,l,e,t))}return null===s&&(s={seg:null,row:i,col:o,fEvent:t,rect:null,charPos:-1,typher:null,reminderIconRect:null}),s}},{key:"_hitCellInfo",value:function(e,t,n,r){var i=this._tableView&&this._tableView.getSheetView();if(!i)return null;var o=i.getViewModel().typography.typographyInfo(e,t);if(!o||0!==o.type)return null;var a=o.typher,s=this._measure.cell2DocPos(e,t),u=n.sub(s);if(o.clip&&!o.clip.containPoint(u))return null;u=u.sub(o.offset);var l=a.posHitChar(u),c=a.posHitSeg(u),h=this._findSegByPos(a,l);if(null!==h){var d;if(c)d=c.rect.clone();else{var f=a.charRect(h.rg.from),p=a.charRect(h.rg.to);d=f.union(p)}o.clip&&o.clip.x>d.x&&(d.x=o.clip.x);var v=d.move(o.offset.x,o.offset.y).move(s.x,s.y),g=i.mapWidgetToGlobal(v,this._tableView.contentDoc().doc);if(!g)return null;var _=h.style.customData,y=_.type()===Z.K6s.REMINDER&&a.posHitIcon?a.posHitIcon(u):null;return{row:e,col:t,fEvent:r,rect:g,charPos:l,typher:a,seg:_,reminderIconRect:y}}if(null!==c&&c instanceof I.InsetSeg&&c.inset.customData){var m=c.rect.clone().move(o.offset.x,o.offset.y).move(s.x,s.y),E={row:e,col:t,fEvent:r,rect:i.mapWidgetToGlobal(m,this._tableView.contentDoc().doc),typher:a};if(c.inset.customData.customSegs){var b=c.inset.customData,T=b.background,C=b.customSegs,S=u.x-c.rect.x;S-=T?Z.Y_J.margin[3]+Z.Y_J.padding[1]:0;var w=C.findIndex((function(e){return S>=e.x&&S<=e.x+e.width}));if(-1!==w)return Object.assign({},E,{charPos:w,seg:C[w].seg,reminderIconRect:null})}else if(c.inset.customData.style&&c.inset.customData.style.customData){var R=c.inset.customData.style;return Object.assign({},E,{charPos:c.inset.pos,seg:R.customData,reminderIconRect:null})}}return null}},{key:"_backgroundRect",value:function(e,t){t||(t=e.clip);var n=e.typher.visualInfo(),r=n.x+e.offset.x,i=t&&t.x>r?ep[3]:0,o=t&&t.maxX<r+n.width+ep[1]?ep[1]:0;return new k.FRect(n.x-ep[3]-i,0,n.width+ep[1]+ep[3]+o+i,n.height)}},{key:"_findSegByPos",value:function(e,t){if(-1===t)return null;var n=e.stream().styles(),r=n.lbound({rg:{from:t,to:t}},!0);if(-1===r)return null;var i=n.at(r);return i.rg.to<r?null:i}},{key:"_setBorderData",value:function(e,t,n,r,i,o){var a=this._tableView.sheet()._getSpanModel().find(t,n),s=a?a.colCount():1;if(i<0||o>this._measure.measureWidth(n,n+s))for(var u=this._measure.measureCol(r.x+i+1),l=this._measure.measureCol(r.x+o-1),c=e.get("BorderCol"),h=u;h<l;++h)c.setData(t,h,!0)}},{key:"fvgNode",value:function(e){var t=this,n=[];if(null===this._measure)return n;for(var r=this._tableView.sheet(),i=this._measure.docPos2Cell(e.leftTop()),o=this._measure.docPos2Cell(new k.FPoint(e.maxX-1,e.maxY-1)),a=c_(this._tableView.getSheetView().getViewModel(),this._tableView.sheet(),new k.FRect(i.col,i.row,o.col-i.col+1,o.row-i.row+1)),s=this.doc._renderCtx,u=function(e){var i=(0,c.Z)(e,2)[1],o=i.row,a=i.col;if(!t.shouldRenderCell(o,a))return"continue";var u=e[0],l=t._measure.cell2DocPos(o,a),h=u.type,d=u.typher,f=u.typher.visualInfo(),p=u.offset.x+f.x,v=p+f.width;u.clip&&(p=Math.max(u.clip.x,p),v=Math.min(u.clip.maxX,v)),t._setBorderData(s,o,a,l,p,v);var g=u.clip;if(null==g||!1===g){var _=t._tableView.getSheetView().getViewModel().typography,y=_.getTypherContext(o,a);g=_.clipRect(o,a,y)}var m=u.background,E=u.offset.x,b=u.offset.y,T=r.getCellPadding(),C=[0,T[1],0,T[3]],S=r.getDataValidation(o,a);S&&(0,x.b_9)(S)&&S.options.shouldHighlightValidData&&(C[1]=ep[1],C[3]=ep[3]);var w=d.lines(),R={type:k.WidgetType.widget,cfg:{x:g.x+l.x,y:g.y+l.y,width:g.width,height:g.height},children:[]};if(m){var A=t._backgroundRect(u,g);A.x+=E-g.x,A.y+=b,t._setTypographyBackgroundFVGNode(R,A,m)}if(n.push(R),0===h){var O=u.offset;t._setRichtextFVGNode(R,d,O,r.getInlineAlign(),g,d._width),w.forEach((function(e){return e.segs.forEach((function(e){e instanceof I.InsetSeg&&t._setTypographyCustomInsegFVGNode(R,e,E,b,g)}))}))}else w.forEach((function(e){var n=e.hAlign,r=e.vAlign,i=e.height,o=e.painter,a=o.text,s=o.textRect,u=o.style;t._setTextFVGNode(I.WdkFvgType.text,R,a,u,n,r,s,i,C,E,b+e.y,g)}))},l=a.next();null!==l;l=a.next())u(l);return n}},{key:"_setTypographyCustomInsegFVGNode",value:function(e,t,n,r,i){var o=this;if(t.inset.customData&&(t.inset.customData.text||t.inset.customData.customSegs)){var a=t.inset.customData,s=Object.assign({},a.style,{decoration:a.style.textDecoration}),u=a.text,l=a.background,c=l?t.rect.width-Z.Y_J.margin[1]-Z.Y_J.margin[3]:t.rect.width,h=l?t.rect.height-Z.Y_J.margin[0]-Z.Y_J.margin[2]:t.rect.height,d=i?t.rect.x+Z.Y_J.margin[3]+n-i.x:t.rect.x+Z.Y_J.margin[3]+n,f=t.rect.y+r;if(l){f+=Z.Y_J.margin[0];var p=new k.FRect(d,f,c,h);this._setTypographyBackgroundFVGNode(e,p,l)}if(u){var v=f,g=l?d+Z.Y_J.padding[1]:d,_=new k.FRect(g,v,c,h);this._setTypographyMultipleValueFVGNode(I.WdkFvgType.text,e,u,s,_,h)}else a.customSegs.forEach((function(t){var n=t.text;if(n){var r=Object.assign({},s,t.style),i=d+t.x+Z.Y_J.padding[1],a=new k.FRect(i,f,t.width,t.height);o._setTypographyMultipleValueFVGNode(I.WdkFvgType.text,e,n,r,a,h)}}))}}},{key:"_setTypographyBackgroundFVGNode",value:function(e,t,n){e.children.unshift({type:k.WidgetType.widget,cfg:{background:n,x:t.x,y:t.y,width:t.width,height:t.height,radius:10}})}},{key:"_setRichtextFVGNode",value:function(e,t,n,r,i,o){var a=t.stream(),s=t.visualInfo(),u=t.wordWrap(),l=o;l&&l!==Number.MAX_VALUE||(l=i.width);var c=a.styles().toArray().map((function(e){return e.style={decoration:e.style.decoration,fontInfo:e.style.fontInfo,color:i_(e.style.color),lineHeight:e.style.lineHeight},e})),h=a.insets().toArray().map((function(e){if(e.customData&&(e.customData.text||e.customData.customSegs)){var t=e.customData.style&&Object.assign({},e.customData.style);null!=t&&t.foreColor&&(t.foreColor=i_(t.foreColor)),null!=t&&t.backColor&&(t.backColor=o_(t.backColor)),e.customData={text:e.customData.text,style:t,background:o_(e.customData.background),customSegs:e.customData.customSegs}}else delete e.customData;return e})),d={type:I.WdkFvgType.richtext,cfg:{x:n.x,y:n.y,width:l,height:s.height,wordWrap:u,defaultStyle:a.defaultStyle(),text:a.str(),styles:c,insets:h,aligns:a.aligns().toArray(),inlineAlign:r}};e.children.push(d)}},{key:"_setTextFVGNode",value:function(e,t,n,r,i,o,s,u,l,c,h,d,f){l=(0,a.Z)(l);var p=s.clone();p.x+=c;var v=t.cfg.width,g=u,_=h-d.y;switch(i){case I.HorizontalAlign.Left:l[3]=p.x;break;case I.HorizontalAlign.Center:(d.x<0||p.x<0||f)&&(l[3]=p.x-d.x,i=I.HorizontalAlign.Left);break;case I.HorizontalAlign.Right:l[1]=v-p.width-p.x+d.x}var y={type:e,cfg:Object.assign({x:0,y:_,width:v,height:g,lineHeight:u},r.fontInfo,{textDecoration:r.decoration,color:r.color,padding:l,hAlign:i,vAlign:o,text:n,inlineAlign:this._tableView.sheet().getInlineAlign()})};t.children.push(y)}},{key:"_setTypographyMultipleValueFVGNode",value:function(e,t,n,r,i,o){var a=i.clone(),s=a.width,u=o,l=a.y,c={type:e,cfg:Object.assign({x:a.x,y:l,width:s,height:u,lineHeight:o},r.fontInfo,{textDecoration:r.decoration,color:r.color,text:n,inlineAlign:this._tableView.sheet().getInlineAlign()})};t.children.push(c)}}]),t}(I.FLayer);function l_(e,t,n,r){return t._getRowInfos().iterEachActualVisible(n.y,n.maxY).map((function(i){var o=[];if(!(t.hasContent(i,n.x)||r&&n.x!==r.colFrom)){var a=d_(t,i,n.x);if(null!==a){var s=e.typography.typographyInfo(i,a),u=s.typher.visualInfo(),l=e.getMeasurer(),c=s.offset.x+u.x+u.width+l.colPos(a);l.measureCol(c)>=n.x&&o.push([s,{row:i,col:a}])}}if(!(t.hasContent(i,n.maxX-1)||r&&n.x!==r.colTo)){var h=h_(t,i,n.maxX-1);if(null!==h){var d=e.typography.typographyInfo(i,h),f=d.typher.visualInfo(),p=e.getMeasurer(),v=d.offset.x+f.x+p.colPos(h);p.measureCol(v)<=n.maxX&&o.push([d,{row:i,col:h}])}}return bl.FIterator.fromArray(o)})).flatten()}function c_(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=n.x,a=n.x+n.width-1,s=i?{colFrom:o,colTo:a}:void 0;return t.cellModel.iterVisibleVar(n.y,n.x,n.maxY-1,n.maxX-1,r).map((function(t){return[e.typography.typographyInfo(t.row,t.col),t]})).chain(l_(e,t,n,s))}function h_(e,t,n){for(var r=e.getColumnCount();++n<r&&(!e.hasContent(t,n)||!e.getColumnVisible(n)););return n<r&&!e._isPartofMergeCell(t,n)?n:null}function d_(e,t,n){for(;--n>=0&&(!e.hasContent(t,n)||!e.getColumnVisible(n)););return n>=0&&!e._isPartofMergeCell(t,n)?n:null}function f_(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;e.arc(t.x+n,t.y+n,n,Math.PI,1.5*Math.PI),e.lineTo(t.x+t.width-n,t.y),e.arc(t.x+t.width-n,t.y+n,n,1.5*Math.PI,2*Math.PI),e.lineTo(t.x+t.width,t.y+t.height-n),e.arc(t.x+t.width-n,t.y+t.height-n,n,0,.5*Math.PI),e.lineTo(t.x+n,t.y+t.height),e.arc(t.x+n,t.y+t.height-n,n,.5*Math.PI,Math.PI),e.closePath()}function p_(e,t,n,r,i){var o=(0,c.Z)(n,4),a=o[0],s=o[1],u=o[2],l=o[3],h=new k.FRect(t.x+l,t.y+a),d=new k.FRect(t.x+l,t.y+a,t.width-l-s,t.height-a-u),f=e.width(),p=e.height(),v=d.width/f,g=d.height/p,_=Math.min(g,v);return h.width=Math.round(f*_),h.height=Math.round(p*_),r===I.HorizontalAlign.Center?h.x+=(d.width-h.width)/2:r===I.HorizontalAlign.Right&&(h.x+=d.width-h.width),i===I.VerticalAlign.Center?h.y+=(d.height-h.height)/2:i===I.VerticalAlign.Bottom&&(h.y+=d.height-h.height),[h.clone(),new k.FRect(0,0,f,p)]}function v_(e,t,n,r,i,o,a,s){switch(o){case 4:case 3:return function(e,t,n,r,i,o,a,s){var u=(0,c.Z)(n,4),l=u[0],h=u[1],d=u[2],f=u[3],p=new k.FRect(t.x+f,t.y+l,t.width-f-h,t.height-l-d),v=p.width,g=p.height;4===o&&a&&s&&(v=p.width/a*e.width(),g=p.height/s*e.height());var _=new k.FRect(0,0,v,g);return r===I.HorizontalAlign.Center?_.x=(e.width()-v)/2:r===I.HorizontalAlign.Right&&(_.x=e.width()-v),i===I.VerticalAlign.Center?_.y=(e.height()-g)/2:i===I.VerticalAlign.Bottom&&(_.y=e.height()-g),[p,_]}(e,t,n,r,i,o,a,s);case 2:return function(e,t,n){var r=(0,c.Z)(n,4),i=r[0],o=r[1],a=r[2],s=r[3];return[new k.FRect(t.x+s,t.y+i,t.width-s-o,t.height-i-a),new k.FRect(0,0,e.width(),e.height())]}(e,t,n);case 1:return p_(e,t,n,r,i);default:return Z.Ps3.getImageRectByEqualEnable()?p_(e,t,n,r,i):function(e,t,n){var r=(0,c.Z)(n,4),i=r[0],o=r[1],a=r[2],s=r[3],u=new k.FRect(t.x+s,t.y+i),l=new k.FRect(t.x+s,t.y+i,t.width-s-o,t.height-i-a),h=e.width(),d=e.height(),f=h/d;h>l.width?(u.width=l.width,u.height=u.width/f):(u.width=h,u.height=d);var p=l.height-u.height;u.y+=p;var v=u.clone();p<0&&(v.y-=p,v.height+=p);var g=h/l.width,_=g>1?v.height*g:v.height;return[v,new k.FRect(0,d-_,h,_)]}(e,t,n)}}var g_=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments)))._imageRefList=new Set,e.unloadedImage=new Set,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"_renderCell",value:function(e,t,n,r,i,o){var a=this,s=t.image,u=t.cellWidth,l=t.cellHeight,h=t.cellPadding,d=t.hAlign,f=t.vAlign,p=t.mode,v=t.customWidth,g=t.customHeight,_=this._measure.cell2DocPos(n,r),y=new k.FRect(_.x,_.y,u,l);if(this._imageRefList.has(s.ref)||(this._imageRefList.add(s.ref),s.ref.addRef()),s.isLoaded()){var m=v_(s,y,h,d,f,p,v,g),E=(0,c.Z)(m,2),b=E[0],T=E[1];e.drawImage(s.element(),T.x,T.y,T.width,T.height,b.x,b.y,b.width,b.height),s.release()}else s.onceLoaded((function(){var e=v_(s,y,h,d,f),t=(0,c.Z)(e,1)[0];o.markDirtyRect&&o.markDirtyRect(t),o.markChildDirty(),s.release(),a.unloadedImage.delete(s)})),this.unloadedImage.add(s)}},{key:"imageLoaded",value:function(){var e=this;return new Promise((function(t){if(0===e._imageRefList.size)t(!0);else{var n=[];e._imageRefList.forEach((function(e){e.isReady||n.push(e)})),0===n.length&&t(!0);var r=0;n.forEach((function(e){e.onLoaded((function(){++r===n.length&&setTimeout((function(){return t(!0)}),100)}))}))}}))}},{key:"destroy",value:function(){this.unloadedImage.forEach((function(e){return e.release()})),this._imageRefList.forEach((function(e){return e.release()})),this.unloadedImage.clear(),this._imageRefList.clear()}},{key:"_iterFVGNode",value:function(e,t,n){var r=e.image,i=e.cellWidth,o=e.cellHeight,a=e.cellPadding,s=r.imgUrl(),u={type:I.WdkFvgType.image,cfg:{}},l=this._measure.cell2DocPos(t,n),c=l.x+a[3],h=l.y+a[0],d=i-a[1]-a[3],f=o-a[0]-a[2],p=new k.FRect(c,h,d,f);return Object.assign(u.cfg,p),u.cfg.imgUrl=s,u}}]),t}(I.FIterLayer),__=function(e){function t(e,n,r,i){var o;return(0,h.Z)(this,t),(o=(0,f.Z)(this,(0,p.Z)(t).call(this,e,n,r,i))).name=e,o.setFillStyle=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.isGradient,i=n.color,o=n.startX,a=n.width,s=n.rect,u=n.sumWidth,l=n.additionX;if(t)if(r){var c=(0,x.Ukk)((0,x.T_q)(i),0),h=e.createLinearGradient(o+u,s.y,o+l,s.y);h.addColorStop(0,i),h.addColorStop(1,c),e.fillStyle=h}else e.fillStyle=i;else if(r){var d=(0,x.Ukk)((0,x.T_q)(i),0),f=e.createLinearGradient(o,s.y,o+a,s.y);f.addColorStop(0,i),f.addColorStop(1,d),e.fillStyle=f}else e.fillStyle=i},o.getBorderConfig=function(e){var t=function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return[void 0,null].includes(e)?t:e}));return{right:t(e.right,2),left:t(e.left,2),top:t(e.top,2),bottom:t(e.bottom,2)}},o.renderBorder=function(e,t,n){var r=n.startX,i=n.rect,a=n.border,s=n.width,u=n.height,l=n.additionX,c=n.color;if(n.isGradient&&s){var h=[],d=.5;t?(h.push({x:r+s-d+l,y:i.y+a.top}),h.push({x:r+l,y:i.y+a.top}),h.push({x:r+l,y:i.y+u+2+1,dir:Ee.Operation.subtract}),h.push({x:r+s-d+l,y:i.y+u+2+1})):(h.push({x:r+1,y:i.y+a.top}),h.push({x:r+s-d,y:i.y+a.top}),h.push({x:r+s-d,y:i.y+u+2+1,dir:Ee.Operation.subtract}),h.push({x:r+1,y:i.y+u+2+1})),o.drawBorder.start(e,1,c),h.reduce((function(t,n){var r=t.dir||Ee.Operation.plus;return o.drawBorder.continueDrawline(e,t.x,t.y,n.x,n.y,r),n})),o.drawBorder.end(e)}},o.drawBorder=new Ee.ContinuouslyDrawBorder,o}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"_renderCell",value:function(e,t,n,r,i,o){var a,s,u,l,c=t.percent,h=t.isGradient,d=t.originPoint,f=t.rowCount,p=t.colCount,v=e.fillType,g=(0,k.convertThemeColor)(o,t.color,k.ColorThemeType.Background),_=this.getBorderConfig(t.border||{}),y=this.cell2Rect(n,r,f,p),m=c<0,E=y.height-_.bottom-_.top-2*vh.width;if(m){var b=Math.abs(c),T=1===d?_.right:0;if(a=y.width*d-_.left-T-2*vh.width,s=y.x+_.left,l=a-(u=a*b),a<0||u<=0)return;this.setFillStyle(e,m,{isGradient:h,color:g,startX:s,width:u,rect:y,sumWidth:a,additionX:l}),e.fillType=k.ColorThemeType.Background,e.fillRect(s+l,y.y+_.top,u,E+1)}else{var C=0===d?_.left:0;if(a=y.width*(1-d)-_.right-C-2*vh.width,s=y.x+y.width*d+C,u=a*c,a<0||u<=0)return;this.setFillStyle(e,m,{isGradient:h,color:g,startX:s,width:u,rect:y}),e.fillType=k.ColorThemeType.Background,e.fillRect(s,y.y+_.top,u,E+1)}this.renderBorder(e,m,{startX:s,rect:y,border:_,width:u,height:E,additionX:l,color:g,isGradient:h}),e.fillType=v}},{key:"cell2Rect",value:function(e,t,n,r){var i=this._measure.cell2DocPos(e,t),o=this._measure.measureHeight(e,e+n),a=this._measure.measureWidth(t,t+r);return new k.FRect(i.x,i.y,a,o)}}]),t}(I.FIterLayer);function y_(e,t,n){return"data:image/svg+xml,".concat(encodeURIComponent(e?'<svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="18" height="18" rx="2" fill="'.concat(n,'"/><path d="M16 3H2L7.5 8V13L10.5 15.5V8L16 3Z" fill="').concat(t,'"/></svg>'):'<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 16 16" fill="none"><rect width="16" height="16" rx="2" fill="'.concat(n,'" /><path d="M2.5 4C2.5 3.72386 2.72386 3.5 3 3.5H13C13.2761 3.5 13.5 3.72386 13.5 4C13.5 4.27614 13.2761 4.5 13 4.5H3C2.72386 4.5 2.5 4.27614 2.5 4Z" fill="').concat(t,'"/><path d="M4 8C4 7.72386 4.22386 7.5 4.5 7.5H11.5C11.7761 7.5 12 7.72386 12 8C12 8.27614 11.7761 8.5 11.5 8.5H4.5C4.22386 8.5 4 8.27614 4 8Z" fill="').concat(t,'" /><path d="M6 11.5C5.72386 11.5 5.5 11.7239 5.5 12C5.5 12.2761 5.72386 12.5 6 12.5H10C10.2761 12.5 10.5 12.2761 10.5 12C10.5 11.7239 10.2761 11.5 10 11.5H6Z" fill="').concat(t,'" /></svg>')))}var m_=function(e){function t(){return(0,h.Z)(this,t),(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))}return(0,v.Z)(t,e),t}(I.FImage);m_=hp([Hd([k.FEventType.Tap,k.FEventType.Click])],m_);var E_=function(e){function t(e){var n;return(0,h.Z)(this,t),(n=(0,f.Z)(this,(0,p.Z)(t).call(this))).dispatchShellEvent=e,n}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"has",value:function(e,t,n){return!!this.getFilterIconType(e.filterModel,t,n)}},{key:"anchor",value:function(){return"bottom"}},{key:"getBaseWidget",value:function(){return new m_(null)}},{key:"addListener",value:function(e,t,n,r){var i=this;e.addListener(k.FEventType.Dblclick,(function(){return!0}));var o=this.getFilterIconType(t.filterModel,n,r),a=function(){var e=t.getNotExpendCellRect(n,r);return t._trigger(Z.zW2.ShowFilter,{sheet:t,btnInfo:o,cellRect:{x:e.x,y:e.y,width:e.width,height:e.height}}),!0};e.addListener(k.FEventType.Tap,a),e.addListener(k.FEventType.Click,a),e.addListener(k.FEventType.MouseEnter,(function(){var o=e.width,a=e.height,s=e.mapToGlobal(new k.FPoint(0,0)),u=s.x,l=s.y;return i.dispatchShellEvent("FilterIconEnter",{x:u,y:l,width:o,height:a}),e.updateByCfg({imgUrl:i.icon(t,n,r,!0)}),!0})),e.addListener(k.FEventType.MouseMove,(function(e){return e.srcEventPreventDefault(),!0})),e.addListener(k.FEventType.MouseLeave,(function(){return i.dispatchShellEvent("FilterIconLeave"),e.updateByCfg({imgUrl:i.icon(t,n,r,!1)}),!0})),e.addListener(k.FEventType.Destroy,(function(){return i.dispatchShellEvent("FilterIconLeave"),!0}))}},{key:"iconSize",value:function(){return 16}},{key:"icon",value:function(e,t,n,r){var i=this.getFilterIconType(e.filterModel,t,n);return null===i?"":this.getImageSrc(i,r)}},{key:"getImageSrc",value:function(e,t){var n=(0,N.getThemeColorByToken)("text-link-hover"),r=(0,N.getThemeColorByToken)("text-link-normal"),i=(0,N.getThemeColorByToken)("N00"),o=(0,N.getThemeColorByToken)("bg-filler");return t?y_(e.active,r,o):y_(e.active,n,i)}},{key:"getFilterIconType",value:function(e,t,n){if(!e.filterRange)return null;var r=e.getFilterRange();return t!==r.row||n>=r.col+r.colCount||n<r.col?null:{row:t,col:n,active:!!e.getValidFilterRules().get(n),filteredRowCount:0}}}]),t}(Sf),b_=function(e){function t(e,n){var r;return(0,h.Z)(this,t),(r=(0,f.Z)(this,(0,p.Z)(t).call(this))).worksheet$=e,r.sheetView=n,r.worksheet=null,e.pipe((0,fe.h)((function(e){return!!e})),(0,de.R)(r.dispose$)).subscribe((function(e){return r.worksheet=e})),r}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"render",value:function(e,t,n,r){var i=this,o=this.sheetView.shellWatcher,a=Object.assign({name:"filter",factory:new E_(o.dispatch),iterVisible:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(t=e.cellModel).iterVisibleCell.apply(t,r)}},Og);return new xv("filter_icon_layer",t,(function(e,t,s,u,l,c){return Rg(a,{sheet:i.worksheet,viewModel:i.sheetView.getViewModel(i.worksheet),measurer:n,rowFrom:e,colFrom:t,rowTo:s,colTo:u,context:l,iterCtx:c,ignoreCellOverflow:r.ignoreCellOverflow,dispatchShellEvent:o.dispatch||w.default})}),(function(){var e;return!(null!==(e=i.worksheet)&&void 0!==e&&e.filterModel.hasFilter())}),r.ignoreCellOverflow)}}]),t}(yv);function T_(e){return new b_(e.worksheet$,e)}var C_=function(){return function(e){var t,n=[];return new Y.y((function(r){var i=e.subscribe((function(e){n.push(e),t||(t=Promise.resolve(void 0).then((function(){r.next(n),t=void 0})))}),(function(e){return r.error(e)}),(function(){return r.complete()}));return function(){return i.unsubscribe()}}))}},S_=function(){return function(e){return new Y.y((function(t){var n,r=function(){n=null,t.next()},i=function(){n&&(cancelAnimationFrame(n),n=null)},o=e.subscribe((function(){i(),n=requestAnimationFrame(r)}),(function(e){i(),t.error(e)}),(function(){i(),t.complete()}));return function(){o.unsubscribe()}}))}},w_=function(e){function t(e){var n;return(0,h.Z)(this,t),(n=(0,f.Z)(this,(0,p.Z)(t).call(this))).worksheet$=e,n.worksheet$.pipe((0,fe.h)((function(e){return!!e})),(0,ce.w)((function(e){var t=e.viewsModel.activeView$.pipe((0,le.map)((function(t){return(null==t?void 0:t.filterModel)||e.filterModel}))),r=t.pipe((0,ce.w)((function(e){return e.currentRange$}))),i=t.pipe((0,ce.w)((function(e){return e.filteredOutRows$})));return(0,X.T)(r.pipe((0,pe.O)(void 0),(0,ge.G)(),(0,_e.b)((function(t){var r=(0,c.Z)(t,2),i=r[0],o=r[1];return n.clearRangeCache(e,i,o)}))),i.pipe((0,_e.b)((function(){return n.handleFilteredOutRowsChanged(e)}))))})),C_(),(0,de.R)(n.dispose$)).subscribe((function(){var e;return null===(e=n.host)||void 0===e?void 0:e.refresh()})),n}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"handleFilteredOutRowsChanged",value:function(e){var t;e.updateExcludedRows();var n=null===(t=this.host)||void 0===t?void 0:t.getViewModel(e);if(n){var r=e.filterModel.filterRange;(r?e.getSpans(r):[]).forEach((function(e){n.cache.removeTypography(e.rowFrom(),e.colFrom(),1,1)}))}}},{key:"clearRangeCache",value:function(e,t,n){var r,i=null===(r=this.host)||void 0===r?void 0:r.getViewModel(e);if(i&&(!t||null==n||!n.equal(t))){if(n){var o=n.rowFrom();i.cache.removeTypography(o,n.colFrom(),1,n.colCount(!0)),i.fitRowCalc.addDirtyRow(o)}if(t){var a=t.rowFrom();i.cache.removeTypography(a,t.colFrom(),1,t.colCount(!0)),i.fitRowCalc.addDirtyRow(a)}}}}]),t}(mv);function R_(e){return new w_(e.worksheet$)}var A_=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).visible=!1,e.view=null,e.ignore=!0,e.rgs=[],e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"initState",value:function(){var e=this;return this.range$.subscribe((function(t){return e.rgs=t?[t]:[]}))}},{key:"describe",value:function(){var e=this;if(!this.view||!this.visible||this.view.getSheetView().invisible)return null;var t=Th;return k.Stack.fill((function(){return e.rgs.map((function(n,r){var i=e.view.getSheetView(),o=i&&i.isRowColHeaderHidden?Yv(e.view,n,1,1):nv(e.view,n,1,1),a=o.x,s=o.y,u=o.width,l=o.height,c="filter-selection-"+r++;return k.Positioned.with({key:c,left:a,top:s}).fill((function(){return k.SizedBox.with({width:u,height:l}).fill((function(){return k.BorderBox.with({border:t})}))}))}))}))}}]),t}(_v);hp([k.State],A_.prototype,"visible",void 0),hp([k.State],A_.prototype,"view",void 0),hp([k.State],A_.prototype,"ignore",void 0),hp([k.State],A_.prototype,"range$",void 0),hp([k.State],A_.prototype,"rgs",void 0);var O_=function(e){function t(e,n){var r;return(0,h.Z)(this,t),(r=(0,f.Z)(this,(0,p.Z)(t).call(this))).worksheet$=e,r.filterSelVisible$=n,r.visible=!1,r.range$=r.worksheet$.pipe((0,ve.distinctUntilChanged)(),(0,ce.w)((function(e){return e?e.viewsModel.activeView$.pipe((0,le.map)((function(t){return t?t.filterModel:e.filterModel})),(0,ce.w)((function(e){return e.currentRange$})),(0,ce.w)((function(e){var t;return null!==(t=null==e?void 0:e.$)&&void 0!==t?t:(0,G.of)(void 0)}))):(0,G.of)(void 0)})),(0,de.R)(r.dispose$)),r.filterSelVisible$.subscribe((function(e){r.visible=e})),r}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"render",value:function(e){return A_.with({visible:this.visible,view:e,range$:this.range$,key:"FilterSelections"})}}]),t}(gv);function M_(e){return new O_(e.worksheet$,e.filterSelVisible$)}var k_,I_,x_=16;!function(e){e[e.None=0]="None",e[e.Bold=1]="Bold",e[e.Color=2]="Color"}(k_||(k_={})),function(e){e[e.Line=0]="Line",e[e.ColorfulLine=1]="ColorfulLine",e[e.LineClickArea=2]="LineClickArea",e[e.Button=3]="Button"}(I_||(I_={}));var N_=function(e){function t(e,n){var r;return(0,h.Z)(this,t),(r=(0,f.Z)(this,(0,p.Z)(t).call(this,e))).dispatch=n,r.point=new k.FWidget((0,s.Z)(r)),r.interactive=!0,k.Bind.propBind(r.point,"x",(0,s.Z)(r),"width",(function(e){return e-1})),k.Bind.propBind(r.point,"y",(0,s.Z)(r),"height",(function(e){return e-1})),r.point.updateByCfg({width:1,height:1}),r}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"update",value:function(e){var t=e.groupBarBackgroundColor,n=e.groupBarBorderColor,r=e.interactive;this.interactive=r,this.updateByCfg({background:t}),this.point.updateByCfg({background:n})}},{key:"mouseDown",value:function(e){return!this.interactive||e.buttons!==k.FMouseButtons.Secondary||(this.dispatch("ContextMenuGroupCorner"),!0)}},{key:"destroy",value:function(){(0,l.Z)((0,p.Z)(t.prototype),"destroy",this).call(this),this.point.destroy()}}]),t}(k.FWidget),P_=function(e,t){return 0===e?0:(22*e+6)*t},L_=function(e){return 22*(e-1)+6},D_=function(e){return"".concat(e.type,",").concat(e.level,",").concat(e.start,",").concat(e.count,",").concat(e.state)},F_=function(e){var t=e.split(",").map((function(e){return Number(e)})),n=(0,c.Z)(t,5),r=n[0],i=n[1],o=n[2],a=n[3],s=n[4];return{isRow:r===Z.xj7.ROW,level:i,start:o,count:a,expanded:s===x.w2y.Expand}},B_=function(e,t,n,r,i,o,a,s){var u,l,c={},h=(null===(u=t._rowInfos.firstVisible(0,t.getRowCount()))||void 0===u?void 0:u.index)||0,d=(null===(l=t._colInfos.firstVisible(0,t.getColumnCount()))||void 0===l?void 0:l.index)||0;return e.forEach((function(e){var t=e.level,u=e.visible,l=e.start,f=e.count,p=e.type,v=e.state;if(u){var g=p===Z.xj7.ROW,_=v===x.w2y.Expand,y=D_(e),m=Object.assign({id:y,isRow:g,level:t},function(e,t,n,r,i,o,a,s,u){var l=t?function(t,n){return e.measureHeight(t,n)}:function(t,n){return e.measureWidth(t,n)},c=r<=a?8/o+1:l(0,r),h=l(0,r+i);return!n&&c===s&&r<u&&u<=h&&(c-=8/o-2),c===s&&(c+=8/o+2),h===s&&(h-=2),{start:c*o,length:(h-c)*o}}(n,g,_,l,f,r,g?h:d,g?i:a,g?o:s),{expand:e.state===x.w2y.Expand,highlightType:0});c[y]=m}})),c};var V_,H_=function(e){return 0!==e.length&&e.every((function(e){return function(e){return e.rgType===Z.xj7.ROW||e.rgType===Z.xj7.COL}(e)}))};!function(e){e[e.None=0]="None",e[e.Outline=1]="Outline",e[e.RowGroupBar=2]="RowGroupBar",e[e.ColGroupBar=3]="ColGroupBar",e[e.Corner=4]="Corner"}(V_||(V_={}));var U_=function(){function e(t,n,r){var i=this;(0,h.Z)(this,e),this.sheet=t,this.model=n,this.permissionService=r,this.subscription=new z.w,this.sheetZoomRatio=1,this.zoomRatio=1,this.isInHistory=!1,this.editable=!0,this.sheetEditableUnderProtection=!0,this.readOnly=!1,this.measurer=void 0,this._dirty$=new W.X(void 0),this._state$=new W.X({rowGroupLevelCount:0,colGroupLevelCount:0,rowGroupWidth:0,colGroupHeight:0,rowGroupWidthForDom:0,colGroupHeightForDom:0,sheetCornerWidth:0,sheetCornerHeight:0,zoom:1,outlines:{},groupBarBorderColor:"",groupBarBackgroundColor:"",buttonBackgroundColor:"",levelButtonBorderColor:"",levelButtonFontColor:"",levelButtonHoverBackgroundColor:"",outlineNormalColor:"",outlinePrimaryColor:"",outlineButtonIconColor:"",hoveredLevelButton:void 0,frozenRowPos:0,frozenColPos:0,interactive:!0}),this._menuState$=new W.X({type:V_.None}),this.state$=this._state$.asObservable(),this.layoutChanged$=this.state$.pipe((0,ve.distinctUntilChanged)((function(e,t){return e.rowGroupWidth===t.rowGroupWidth&&e.colGroupHeight===t.colGroupHeight}))),this.calcViewState=function(){var e=i.sheet,t=i.zoomRatio,n=i.model,r=i.hoveredLevelButton,o=i.measurer,s=e._getSheetColHeaderHeight(),u=e._getSheetRowHeaderWidth(),l=Math.max.apply(Math,[0].concat((0,a.Z)(n.rowOutlineTree.map((function(e){return e.level}))))),c=Math.max.apply(Math,[0].concat((0,a.Z)(n.colOutlineTree.map((function(e){return e.level}))))),h=Boolean(e.viewsModel.activeView)&&!e.viewsModel.isInPersonalTempView()&&i.editable,d=n.rowOutlineTree.concat(n.colOutlineTree),f=e.frozenRowCount(),p=e.frozenColumnCount(),v=i.measurer.measureHeight(0,f),g=i.measurer.measureWidth(0,p),_=!i.readOnly&&!i.isInHistory&&i.editable&&i.sheetEditableUnderProtection,y={rowGroupLevelCount:l,colGroupLevelCount:c,rowGroupWidth:P_(l,t),colGroupHeight:P_(c,t),rowGroupWidthForDom:P_(l,1)*(i.sheetZoomRatio>1?1:i.sheetZoomRatio),colGroupHeightForDom:P_(c,1)*(i.sheetZoomRatio>1?1:i.sheetZoomRatio),sheetCornerHeight:s,sheetCornerWidth:u,zoom:t,outlines:B_(d,e,o,1/t,v,f,g,p),groupBarBorderColor:h?"var(--colorful-neutral)":"var(--line-border-card)",groupBarBackgroundColor:h?"var(--N600-BG)":"var(--bg-base)",buttonBackgroundColor:"var(--bg-body)",levelButtonBorderColor:"var(--line-border-component)",levelButtonFontColor:_?"var(--text-title)":"var(--text-disabled)",levelButtonHoverBackgroundColor:"var(--udtoken-btn-se-bg-neutral-hover)",outlineNormalColor:"var(--line-border-component)",outlinePrimaryColor:h?"var(--primary-fill-loading)":"var(--primary-fill-default)",outlineButtonIconColor:(0,N.getThemeColorByToken)(_?"icon-n1":"icon-disabled"),hoveredLevelButton:r,frozenRowPos:v,frozenColPos:g,interactive:_};return i.removeOverlapOutline(y),_&&(i.highlightHoveredOutline(y),i.highlightSelectionOutline(y)),y},this.refreshViewState=function(){return i._state=i.calcViewState(),(0,O.default)(i._state,i._state$.getValue())||i._state$.next(i._state),i._state},this.handleSelectionChange=function(e){var t=e.oldSelections,n=e.newSelections;(H_(t)||H_(n))&&i.setDirty()},this.setDirty=function(){i._state=void 0,i._dirty$.next(void 0)},this.bindEvents(!0),this.measurer=new Ov(new x.e6w(0,0,1,1,t))}return(0,d.Z)(e,[{key:"highlightHoveredOutline",value:function(e){if(this.hoveredOutlineId){var t=e.outlines[this.hoveredOutlineId];t&&(t.highlightType=1)}}},{key:"highlightSelectionOutline",value:function(e){var t=this,n=this.sheet.getSelections();if(n&&0!==n.length){var r=this.model;n.forEach((function(n){var i=function(e,t){return e.rowCount()===t.getRowCount()?{type:Z.xj7.COL,col:e.colFrom(),colCount:e.colCount()}:e.colCount()===t.getColumnCount()?{type:Z.xj7.ROW,row:e.rowFrom(),rowCount:e.rowCount()}:void 0}(n,t.sheet);i&&r.getEntireMatchOutlines(i).forEach((function(t){var n=D_(t);e.outlines[n]&&(e.outlines[n].highlightType=2)}))}))}}},{key:"removeOverlapOutline",value:function(e){var t={};Object.values(e.outlines).forEach((function(n){var r=n.level,i=n.start,o=n.isRow?Z.xj7.ROW:Z.xj7.COL,a=t[o]||{},s=a[r]||{},u=s[i];u?F_(n.id).start>F_(u.id).start?(s[i]=n,delete e.outlines[u.id]):delete e.outlines[n.id]:s[i]=n;a[r]=s,t[o]=a}))}},{key:"bindEvents",value:function(e){var t=this;if(this.subscription.unsubscribe(),e){var n=this.sheet.outlineGroupModel,r=this.sheet.inject(H.f3),i=this.sheet.parent.permissionManager.editableSheets$;this.subscription=new z.w,this.subscription.add(this.sheet.subscribe({RowAdded:this.setDirty,RowDeleted:this.setDirty,RowSizeChanged:this.setDirty,RowVisible:this.setDirty,ColumnAdded:this.setDirty,ColumnDeleted:this.setDirty,ColumnSizeChanged:this.setDirty,ColumnVisibleChanged:this.setDirty,StyleChanged:this.setDirty,SelectionChanged:this.handleSelectionChange,FrozenChanged:this.setDirty})),this.subscription.add(n.rowOutlines$.subscribe(this.setDirty)),this.subscription.add(n.colOutlines$.subscribe(this.setDirty)),this.subscription.add(r.sheetBusinessEditable$.subscribe((function(e){t.editable=e,t.setDirty()}))),this.subscription.add(this.sheet.viewsModel.activeView$.subscribe(this.setDirty)),this.subscription.add(this._dirty$.pipe(S_()).subscribe(this.refreshViewState)),this.subscription.add(i.subscribe((function(e){var n=e[t.sheet.id()]||!1;n!==t.sheetEditableUnderProtection&&(t.sheetEditableUnderProtection=n,t.setDirty())})))}}},{key:"onHoverOutline",value:function(e,t){this.hoveredOutlineId=t?e:void 0,this.setDirty()}},{key:"onHoverLevelButton",value:function(e,t,n){this.hoveredLevelButton=n?{isRow:e,level:t}:void 0,this.setDirty()}},{key:"onSheetZoom",value:function(e){if(this.sheetZoomRatio!==e){var t=e<=1?1:1/e;this.sheetZoomRatio=e,this.zoomRatio=t,this.setDirty()}}},{key:"onUIStateChange",value:function(){this.setDirty()}},{key:"setMenuState",value:function(e){return this.permissionService.sheetBusinessEditable?this._menuState$.next(e):this._menuState$.next({type:V_.None})}},{key:"setIsInHistory",value:function(e){this.isInHistory!==e&&(this.isInHistory=e,this.setDirty())}},{key:"setReadOnly",value:function(e){this.readOnly!==e&&(this.readOnly=e,this.setDirty())}},{key:"destroy",value:function(){this.bindEvents(!1),this._dirty$.complete()}},{key:"state",get:function(){return void 0===this._state?this.refreshViewState():this._state}},{key:"menuState",get:function(){return this._menuState$.getValue()}}]),e}();hp([(0,Tl.P)()],U_.prototype,"destroy",null),U_=hp([(0,Cl.b)(),dp(0,(0,Sl.f)(x.SJM)),dp(1,(0,Sl.f)(x.Gdm)),dp(2,(0,Sl.f)(H.f3))],U_);var Z_=function(e){function t(e,n){var r;return(0,h.Z)(this,t),(r=(0,f.Z)(this,(0,p.Z)(t).call(this,e))).dispatch=n,r.isRow=!0,r.label=new I.FLabel((0,s.Z)(r)),r.interactive=!0,r}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"update",value:function(e,t,n){var r=n.zoom,i=n.sheetCornerHeight,o=n.sheetCornerWidth,a=n.buttonBackgroundColor,s=n.levelButtonBorderColor,u=n.levelButtonFontColor,l=n.interactive,c=n.levelButtonHoverBackgroundColor,h=n.hoveredLevelButton;this.level=t,this.isRow=e,this.interactive=l,this.updateByCfg({x:e?L_(t):o/r/2-8,y:e?i/r/2-8:L_(t),width:x_,height:x_,background:(null==h?void 0:h.isRow)===e&&h.level===t?c:a,border:{color:s,width:1},radius:6,cursor:l?"pointer":void 0,transform:1===r?void 0:(new k.TMatrix).scale(r,r)}),this.label.updateByCfg({width:x_,height:x_,text:"".concat(t),fontSize:12,lineHeight:17,vAlign:I.VerticalAlign.Center,hAlign:I.HorizontalAlign.Center,color:u})}},{key:"mouseDown",value:function(e){return!this.interactive||void 0===this.level||void 0===this.isRow||e.buttons===k.FMouseButtons.MainButton&&(this.dispatch("ClickLevelButton",{level:this.level,isRow:this.isRow}),!0)}},{key:"mouseEnter",value:function(e){return!(!this.interactive||void 0===this.level||(this.dispatch("HoverLevelButton",{isRow:this.isRow,level:this.level,hover:!0}),1))}},{key:"mouseLeave",value:function(e){return!(!this.interactive||void 0===this.level||(this.dispatch("HoverLevelButton",{isRow:this.isRow,level:this.level,hover:!1}),1))}}]),t}(k.FWidget),W_=function(e){function t(e,n){var r;return(0,h.Z)(this,t),(r=(0,f.Z)(this,(0,p.Z)(t).call(this,e))).dispatch=n,r.levelButtons=new Map,r.isRow=!0,r.interactive=!0,r}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"updateSelf",value:function(e,t){var n=e.groupBarBackgroundColor,r=e.groupBarBorderColor,i=e.interactive;this.interactive=i,this.updateByCfg({background:n,border:[{color:r,width:0},{color:r,width:t?1:0},{color:r,width:t?0:1},{color:r,width:0}]})}},{key:"updateLevelButtons",value:function(e,t){for(var n=e.rowGroupLevelCount,r=e.colGroupLevelCount,i=t?n:r,o=1;o<=8;o++){var a;if(o<=i){var s=this.levelButtons.get(o)||new Z_(this,this.dispatch);s.update(t,o,e),this.levelButtons.set(o,s)}else null!==(a=this.levelButtons.get(o))&&void 0!==a&&a.destroy(),this.levelButtons.delete(o)}}},{key:"update",value:function(e,t){this.updateSelf(e,t),this.updateLevelButtons(e,t),this.isRow=t}},{key:"mouseDown",value:function(e){return!this.interactive||e.buttons!==k.FMouseButtons.Secondary||(this.dispatch("ContextMenuOnGroupBar",{isRow:this.isRow}),!0)}},{key:"destroy",value:function(){(0,l.Z)((0,p.Z)(t.prototype),"destroy",this).call(this),this.levelButtons.forEach((function(e){return e.destroy()})),this.levelButtons.clear()}}]),t}(k.FWidget),j_=function(e){function t(e,n){var r;return(0,h.Z)(this,t),(r=(0,f.Z)(this,(0,p.Z)(t).call(this,e))).dispatch=n,r.icon=new I.FImage((0,s.Z)(r)),r.interactive=!0,r.expanded=!0,r.iconColor=void 0,r.updateByCfg({width:x_,height:x_,radius:6,zindex:3}),r.icon.updateByCfg({x:2,y:2,width:12,height:12}),r}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"update",value:function(e,t){this.id=t;var n=e.outlines[t];if(n){var r=n.isRow,i=n.start,o=n.level,a=n.highlightType,s=n.expand,u=e.zoom,l=e.buttonBackgroundColor,c=e.outlineNormalColor,h=e.outlinePrimaryColor,d=e.outlineButtonIconColor,f=e.interactive;if(this.interactive=f,this.updateByCfg({x:r?L_(o):i-8-1,y:r?i-8-1:L_(o),background:l,cursor:f?"pointer":void 0,transform:1===u?void 0:(new k.TMatrix).scale(u,u)}),0===a&&this.updateByCfg({border:{color:c,width:1}}),1===a&&this.updateByCfg({border:{color:c,width:2}}),2===a&&this.updateByCfg({border:{color:h,width:1}}),this.expanded!==s||this.iconColor!==d){var p=this.getSvgIcon(s,d);this.expanded=s,this.iconColor=d,this.icon.updateByCfg({imgUrl:p})}}else console.error("不存在该 outline, id 为:",t)}},{key:"getSvgIcon",value:function(e,t){return"data:image/svg+xml,".concat(encodeURIComponent(e?'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 12a1 1 0 0 1 1-1h18a1 1 0 1 1 0 2H3a1 1 0 0 1-1-1Z" fill="'.concat(t,'"/></svg>'):'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2a1 1 0 0 0-1 1v8H3a1 1 0 1 0 0 2h8v8a1 1 0 1 0 2 0v-8h8a1 1 0 1 0 0-2h-8V3a1 1 0 0 0-1-1Z" fill="'.concat(t,'"/></svg>')))}},{key:"mouseDown",value:function(e){return!(this.interactive&&this.id&&(e.buttons===k.FMouseButtons.MainButton?(this.dispatch("ClickOutlineButton",{id:this.id}),0):e.buttons===k.FMouseButtons.Secondary&&(this.dispatch("ContextMenuOnOutline",{id:this.id}),0)))}},{key:"mouseEnter",value:function(e){return!(!this.interactive||!this.id||(this.dispatch("HoverOutline",{id:this.id,hover:!0}),1))}},{key:"mouseLeave",value:function(e){return!(!this.interactive||!this.id||(this.dispatch("HoverOutline",{id:this.id,hover:!1}),1))}}]),t}(k.FWidget),G_=function(e){function t(e,n){var r;return(0,h.Z)(this,t),(r=(0,f.Z)(this,(0,p.Z)(t).call(this,e))).dispatch=n,r.interactive=!0,r.updateByCfg({zindex:2}),r}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"update",value:function(e,t){this.id=t;var n=e.outlines[t];if(n){var r=n.isRow,i=n.start,o=n.level,a=n.expand,s=n.length,u=e.zoom,l=e.interactive;this.interactive=l,a?this.updateByCfg({x:r?L_(o):i-8-1,y:r?i-8-1:L_(o),width:r?x_:s+8+2,height:r?s+8+2:x_,cursor:l?"pointer":void 0,transform:1===u?void 0:(new k.TMatrix).scale(u,u)}):this.updateByCfg({width:0,height:0})}}},{key:"mouseDown",value:function(e){return!(this.interactive&&this.id&&(e.buttons===k.FMouseButtons.MainButton?(this.dispatch("ClickOutline",{id:this.id}),0):e.buttons===k.FMouseButtons.Secondary&&(this.dispatch("ContextMenuOnOutline",{id:this.id}),0)))}},{key:"mouseEnter",value:function(e){return!(!this.interactive||!this.id||(this.dispatch("HoverOutline",{id:this.id,hover:!0}),1))}},{key:"mouseLeave",value:function(e){return!(!this.interactive||!this.id||(this.dispatch("HoverOutline",{id:this.id,hover:!1}),1))}}]),t}(k.FWidget),z_=function(e){function t(e){var n;return(0,h.Z)(this,t),(n=(0,f.Z)(this,(0,p.Z)(t).call(this,e))).updateByCfg({zindex:0}),n}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"calcWidthHight",value:function(e,t){var n=t.isRow,r=t.highlightType,i=t.length,o=e.zoom,a=1===r?2:1;return n?{width:0===r?8:e.rowGroupWidth/o,height:i+a}:{width:i+a,height:0===r?8:e.colGroupHeight/o}}},{key:"update",value:function(e,t){var n=e.outlines[t];if(n){var r=n.isRow,i=n.start,o=n.level,a=n.highlightType;if(n.expand){var s=e.zoom,u=e.outlineNormalColor,l=e.outlinePrimaryColor,c=this.calcWidthHight(e,n),h=c.width,d=c.height,f=1===a?2:1;this.updateByCfg({x:r?L_(o)+(x_-f)/2:i-f,y:r?i-f:L_(o)+(x_-f)/2,width:h,height:d,radius:[0,r?0:4,0,r?4:0],transform:1===s?void 0:(new k.TMatrix).scale(s,s)});var p={color:u,width:1},v={color:u,width:2},g={color:l,width:1},_={color:"",width:0};0===a?this.updateByCfg({border:[r?_:p,r?_:p,r?p:_,r?p:_],zindex:0}):1===a?this.updateByCfg({border:[v,r?_:v,r?v:_,v],zindex:0}):2===a&&this.updateByCfg({border:[g,r?_:g,r?g:_,g],zindex:1})}else this.updateByCfg({width:0,height:0})}}}]),t}(k.FWidget),Y_=function(e){function t(e,n,r){var i;return(0,h.Z)(this,t),(i=(0,f.Z)(this,(0,p.Z)(t).call(this,e))).dispatch=n,i.isRow=r,i.container=new k.FWidget((0,s.Z)(i)),i.borderWidget=new k.FWidget((0,s.Z)(i)),i.outlineWidgets=new Map,i.interactive=!0,k.Bind.propBind(i.borderWidget,r?"height":"width",(0,s.Z)(i),r?"height":"width"),k.Bind.propBind(i.borderWidget,r?"x":"y",(0,s.Z)(i),r?"width":"height",(function(e){return e-1})),k.Bind.propBind(i.container,r?"width":"height",(0,s.Z)(i),r?"width":"height"),i.borderWidget.updateByCfg({width:r?1:i.width,height:r?i.height:1}),i.container.updateByCfg({width:r?i.width:5e4,height:r?5e4:i.height}),i}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"updateSelf",value:function(e){var t=e.groupBarBackgroundColor,n=e.interactive;this.interactive=n,this.updateByCfg({background:t})}},{key:"updateBorder",value:function(e){var t=e.groupBarBorderColor;this.borderWidget.updateByCfg({background:t})}},{key:"updateOutlineWidgets",value:function(e){var t=this,n=Object.values(e.outlines).filter((function(e){return e.isRow===t.isRow})),r=new Set;n.forEach((function(n){var i=n.id,o=F_(i),a=o.level,s=o.start,u="".concat(a,",").concat(s),l=t.outlineWidgets.get(u)||{button:new j_(t.container,t.dispatch),line:new z_(t.container),lineClickArea:new G_(t.container,t.dispatch)};t.outlineWidgets.set(u,l),r.add(u),l.button.update(e,i),l.line.update(e,i),l.lineClickArea.update(e,i)})),r.size!==this.outlineWidgets.size&&this.outlineWidgets.forEach((function(e,n){r.has(n)||(Object.values(e).forEach((function(e){return e.destroy()})),t.outlineWidgets.delete(n))}))}},{key:"update",value:function(e){this.updateSelf(e),this.updateBorder(e),this.updateOutlineWidgets(e)}},{key:"getInnerContainer",value:function(){return this.container}},{key:"mouseDown",value:function(e){return!this.interactive||e.buttons!==k.FMouseButtons.Secondary||(this.dispatch("ContextMenuOnGroupBar",{isRow:this.isRow}),!0)}},{key:"destroy",value:function(){(0,l.Z)((0,p.Z)(t.prototype),"destroy",this).call(this),this.outlineWidgets.forEach((function(e){return Object.values(e).forEach((function(e){return e.destroy()}))})),this.outlineWidgets.clear()}}]),t}(k.FWidget),X_=function(e){function t(e){var n;(0,h.Z)(this,t),(n=(0,f.Z)(this,(0,p.Z)(t).call(this))).host=e,n.frozenRowPos=0,n.frozenColPos=0,n.refresh=function(e){var t=e.frozenRowPos,r=e.frozenColPos;n.groupCorner.update(e),n.rowLevelButtonContainer.update(e,!0),n.rowTopOutlineScrollContainer.update(e),n.rowBottomOutlineScrollContainer.update(e),n.rowBottomOutlineScrollContainer.getInnerContainer().updateByCfg({y:-n.host.brTable.contentDoc().posY-t}),n.colLevelButtonContainer.update(e,!1),n.colLeftOutlineScrollContainer.update(e),n.colRightOutlineScrollContainer.update(e),n.colRightOutlineScrollContainer.getInnerContainer().updateByCfg({x:-n.host.brTable.contentDoc().posX-r}),n.frozenRowPos=t,n.frozenColPos=r};var r=e.container,i=e.dispatch,o=e.worksheet$,a=e.zoom$;return n.groupCorner=new N_(r,i),n.rowLevelButtonContainer=new W_(r,i),n.rowTopOutlineScrollContainer=new Y_(r,i,!0),n.rowBottomOutlineScrollContainer=new Y_(r,i,!0),n.colLevelButtonContainer=new W_(r,i),n.colLeftOutlineScrollContainer=new Y_(r,i,!1),n.colRightOutlineScrollContainer=new Y_(r,i,!1),n.initSubscription(o,a),n}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"initSubscription",value:function(e,t){var n=this,r=e.pipe((0,de.R)(this.dispose$),(0,fe.h)((function(e){return Boolean(e)})),(0,le.map)((function(e){return e})));t=t.pipe((0,de.R)(this.dispose$));var i=r.pipe((0,le.map)((function(e){return e.outlineGroupModel}))),o=r.pipe((0,le.map)((function(e){return e.inject(U_)}))),a=o.pipe((0,ce.w)((function(e){return e.state$}))),s=i.pipe((0,ce.w)((function(e){return e.hiddenSetChangedVersion$})),S_()),u=o.pipe((0,ce.w)((function(e){return e.layoutChanged$})));o.subscribe((function(e){return n.viewModel=e})),a.subscribe(this.refresh),u.subscribe((function(){return n.host.forceLayout()})),(0,j.aj)(r,s).subscribe((function(e){var t=(0,c.Z)(e,1)[0];t.updateExcludedCols(),t.updateExcludedRows();var r=n.host.getViewModel(t);t.getSpans(new x.lq$(0,t.getRowCount(),t)).forEach((function(e){null==r||r.cache.removeTypography(e.rowFrom(),e.colFrom(),1,1)})),n.host.rebuild(),n.host.forceUpdate()})),(0,j.aj)(o,t).subscribe((function(e){var t=(0,c.Z)(e,2),n=t[0],r=t[1];return n.onSheetZoom(r)}))}},{key:"updateLayout",value:function(){if(!this.viewModel)return{height:0,width:0};var e=this.viewModel.state,t=e.rowGroupLevelCount,n=e.colGroupLevelCount,r=e.rowGroupWidth,i=e.colGroupHeight;return{height:0===n?0:i+1,width:0===t?0:r+1}}},{key:"bindRendererHost",value:function(e){e.layoutManager.registerGridShell(2,{corner:this.groupCorner,rowAreas:[this.rowLevelButtonContainer,this.rowTopOutlineScrollContainer,this.rowBottomOutlineScrollContainer],colAreas:[this.colLevelButtonContainer,this.colLeftOutlineScrollContainer,this.colRightOutlineScrollContainer]})}},{key:"initBindings",value:function(){var e=this,t=this.rowTopOutlineScrollContainer.getInnerContainer();k.Bind.propBind(this.rowTopOutlineScrollContainer,"height",this.host.tlTable.contentDoc(),"height"),k.Bind.propBind(t,"y",this.host.tlTable.contentDoc(),"posY",(function(e){return-e}));var n=this.rowBottomOutlineScrollContainer.getInnerContainer();k.Bind.propBind(this.rowBottomOutlineScrollContainer,"height",this.host.brTable.contentDoc(),"height"),k.Bind.propBind(n,"y",this.host.brTable.contentDoc(),"posY",(function(t){return-t-e.frozenRowPos}));var r=this.colLeftOutlineScrollContainer.getInnerContainer();k.Bind.propBind(this.colLeftOutlineScrollContainer,"width",this.host.tlTable.contentDoc(),"width"),k.Bind.propBind(r,"x",this.host.tlTable.contentDoc(),"posX",(function(e){return-e}));var i=this.colRightOutlineScrollContainer.getInnerContainer();k.Bind.propBind(this.colRightOutlineScrollContainer,"width",this.host.brTable.contentDoc(),"width"),k.Bind.propBind(i,"x",this.host.brTable.contentDoc(),"posX",(function(t){return-t-e.frozenColPos}))}}]),t}(Ev);function K_(e){return new X_(e)}var q_=function(e){function t(e,n){var r;return(0,h.Z)(this,t),(r=(0,f.Z)(this,(0,p.Z)(t).call(this))).config=n,r.model=null,r.sub=new z.w,r.zIndex=r.config.zIndex,r.sub.add(e.pipe((0,fe.h)((function(e){return Boolean(e)}),(0,de.R)(r.dispose$))).subscribe((function(e){r.sheet=e,r.model=e.protectionModel}))),r}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"render",value:function(e){var t=this,n=this,r={get sheet(){return n.sheet},get model(){return n.model}},i=this.config,o=i.layerName,a=i.protectionType,s=i.getWatermark,u=i.isLayerEmpty,l=i.getProtectionRangesInView;return new ag(o,(function(e,n,i,o,u){var c=new x.e6w(e,n,i-e+1,o-n+1,t.sheet);return function(e,t){var n=t.protectionRangesInView,r=n.length,i=e.sheet,o=e.model,a=o&&i.getParent().options.isShowProtectedRange&&o.getProtectionsCount()>0&&r>0;return i.cellModel.iterVisibleCellSpan(t.fromRow,t.fromCol,t.toRow,t.toCol,t.ctx).map((function(e){if(a){var o=e.row,s=e.col,u=kd(i,o,s);u||(u=new x.e6w(o,s,1,1,i));for(var l=0;l<r;l++)if(n[l].isIntersect(u))return[Object.assign({value:{imgSrc:t.imgSrc}},Id(i,o,s)),e]}})).filter(Boolean)}(r,{protectionType:a,protectionRangesInView:l(t.sheet,t.model,c),fromRow:e,fromCol:n,toRow:i,toCol:o,imgSrc:s(),ctx:u})}),void 0,void 0,(function(){return u(t.sheet,t.model)}))}},{key:"dispose",value:function(){(0,l.Z)((0,p.Z)(t.prototype),"dispose",this).call(this),this.sub.unsubscribe()}}]),t}(yv),$_=function(e){return"data:image/svg+xml,".concat(encodeURIComponent(e))},J_=function(e){var t={layerName:"protected_cell_layer",zIndex:7,protectionType:"denied",getWatermark:function(){var e=(0,N.getThemeColorByToken)("N1000"),t=(0,U.getCurrentThemeType)()===U.ThemeType.DARK?"0.2":"0.1";return $_('<svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><g opacity="'.concat(t,'"><path d="M1 0L0 1V0H1ZM7 8L8 7V8H7Z" fill="').concat(e,'"/><path d="M0 8V7L7 0H8V1L1 8H0Z" fill="').concat(e,'"/></g></svg>'))},getProtectionRangesInView:function(e,t,n){return(null==t?void 0:t.getProtectionRangesByRange(n,"denied"))||[]},isLayerEmpty:function(e,t){return!(t&&t.getProtectionsByRange(void 0,"denied").length>0)}};return new q_(e.worksheet$,t)},Q_=function(e){var t={layerName:"protected_edit_cell_layer",zIndex:6,protectionType:"allowed",getWatermark:function(){var e=(0,N.getThemeColorByToken)("N1000"),t=(0,U.getCurrentThemeType)()===U.ThemeType.DARK?"0.11":"0.04";return $_('<svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><g opacity="'.concat(t,'"><path d="M1 0L0 1V0H1ZM7 8L8 7V8H7Z" fill="').concat(e,'"/><path d="M0 8V7L7 0H8V1L1 8H0Z" fill="').concat(e,'"/></g></svg>'))},getProtectionRangesInView:function(e,t,n){return e.parent.permissionManager.hasPermission(e.id())&&(null==t?void 0:t.getProtectionRangesByRange(n,"allowed"))||[]},isLayerEmpty:function(e,t){return!(t&&e.parent.permissionManager.hasPermission(e.id())&&t.getProtectionsByRange(void 0,"allowed").length>0)}};return new q_(e.worksheet$,t)},ey=function(e){function t(e,n,r){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return(0,h.Z)(this,t),(i=(0,f.Z)(this,(0,p.Z)(t).call(this,e)))._type=o,i.updateByCfg({type:i._type||0,background:r,width:n,height:n}),i}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"renderWidget",value:function(e,t){var n=this._cfg.x||0,r=this._cfg.y||0,i=e.fillType;e.fillType=k.ColorThemeType.Background;var o=this._cfg.background;o&&(e.fillStyle=(0,k.convertThemeColor)(this,o,k.ColorThemeType.Background));var a=this.width,s=this.width*Math.sin(Math.PI/3);e.beginPath(),e.moveTo(n,r),1===this._cfg.type?(e.lineTo(n+a/2,r+s),e.lineTo(n+a,r)):(e.lineTo(n+s,r+a/2),e.lineTo(n,r+a)),e.fill(),e.fillType=i}}]),t}(k.FWidget),ty=function(){function e(){(0,h.Z)(this,e),this._formulas=[]}return(0,d.Z)(e,[{key:"updateFormular",value:function(e){this._formulas=e}},{key:"reset",value:function(){this._formulas.length=0}},{key:"getFormular",value:function(e){return this._formulas[e]}},{key:"getFormulars",value:function(){return this._formulas.slice()}},{key:"count",value:function(){return this._formulas.length}}]),e}(),ny=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).width=0,e.height=0,e.isAppending=!1,e.isActive=!1,e.isSelected=!1,e.color="",e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e,t=this,n="var(--".concat(this.color,")"),r="var(--".concat(this.color,", 0.1)");this.isAppending?e=Object.assign({},Td,{color:n}):void 0!==this.isAppending&&(e=Object.assign({},Oh,{color:n}));var i=this.width,o=this.height,a=e;return k.Stack.fill((function(){return t.isActive?[k.SizedBox.with({width:i,height:o}).fill((function(){return k.BorderBox.with({border:a})})),k.SizedBox.with({width:i,height:o}).fill((function(){return I.FBlock.with({background:r})}))]:[k.SizedBox.with({width:i,height:o}).fill((function(){return k.BorderBox.with({border:a})}))]}))}}]),t}(k.FBaseWidget);hp([k.State],ny.prototype,"width",void 0),hp([k.State],ny.prototype,"height",void 0),hp([k.State],ny.prototype,"isAppending",void 0),hp([k.State],ny.prototype,"isActive",void 0),hp([k.State],ny.prototype,"isSelected",void 0),hp([k.State],ny.prototype,"color",void 0);var ry=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).rgs=[],e.view=null,e.ignore=!0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=this;return this.view?k.Stack.fill((function(){return e.rgs.map((function(t,n){var r=t.isActive,i=t.isAppending,o=t.token,a=nv(e.view,t.rg,0,0,i&&Td.dashLine),s=a.x,u=a.y,l=a.width,c=a.height,h="FormulaSelection".concat(n);return k.Positioned.with({key:h,left:s,top:u}).fill((function(){return ny.with({width:l,height:c,isActive:r,isAppending:i,color:o})}))}))})):null}}]),t}(k.FBaseWidget);hp([k.State],ry.prototype,"rgs",void 0),hp([k.State],ry.prototype,"view",void 0),hp([k.State],ry.prototype,"ignore",void 0);var iy=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).rgs=[],e.view=null,e.ignore=!0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=this;return this.view?k.Stack.fill((function(){return e.rgs.map((function(t,n){var r=zh.width,i=e.view.getSheetView(),o=i&&i.isRowColHeaderHidden?Yv(e.view,t,r,r):nv(e.view,t,r,r),a=o.x,s=o.y,u=o.width,l=o.height,c="ImportRangeHighLightSelection"+n++;return k.Positioned.with({left:a,top:s,key:c}).fill((function(){return tv.with({width:u,height:l,border:zh})}))}))})):null}}]),t}(k.FBaseWidget);hp([k.State],iy.prototype,"rgs",void 0),hp([k.State],iy.prototype,"view",void 0),hp([k.State],iy.prototype,"ignore",void 0);var oy=function(e){function t(e,n,r){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;(0,h.Z)(this,t),(i=(0,f.Z)(this,(0,p.Z)(t).call(this,e))).p=e,i.rg=n,i.posXBuffer=o,i.posYBuffer=a,i.onDocFlush=function(){return i._syncPosAndSize(),!1},i.updateByCfg({ignore:!0}),i._syncPosAndSize(),e.contentDoc().addListener(k.FEventType.AfterFlush,i.onDocFlush),i.range=n,i._background=new k.FWidget((0,s.Z)(i)),i._background.updateByCfg({width:i.width,height:i.height,background:"var(--bg-body)",opacity:.65});var u=108;return i._bar=new k.FWidget((0,s.Z)(i)),i._bar.updateByCfg({height:8,background:"var(--bg-filler)",width:u,borderLeft:{color:"var(--text-link-hover)",width:r*u}}),k.Bind.propBind(i._bar,"x",(0,s.Z)(i),"width",(function(e){return(e-i._bar.width)/2})),k.Bind.propBind(i._bar,"y",(0,s.Z)(i),"height",(function(e){return(e-i._bar.height)/2})),k.Bind.propBind(i._bar,"borderLeft",(0,s.Z)(i),"value",(function(e){return{color:(0,N.getThemeColorByToken)("text-link-hover"),width:e*u}})),k.Bind.propBind(i._bar,"background",(0,s.Z)(i),"color"),i}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"resetStyle",value:function(){this.updateByCfg({x:0,y:0,width:0,height:0,ignore:!0})}},{key:"destroy",value:function(){this.p.contentDoc().removeListener(k.FEventType.AfterFlush,this.onDocFlush),(0,l.Z)((0,p.Z)(t.prototype),"destroy",this).call(this)}},{key:"_syncPosAndSize",value:function(){if(null!=this.parent()&&this.rg){var e=this.parent(),t=this.rg.rowFrom(),n=this.rg.colFrom(),r=t+this.rg.rowCount(),i=n+this.rg.colCount();if(r<e.fromRow()||e.toRow()<t||i<e.fromCol()||e.toCol()<n)this.updateByCfg({x:-e.docWidth()});else{var o=e.cell2ViewPos({row:t,col:n}),a=e.cell2ViewPos({row:r,col:i}),s=e.contentDoc().rect;r>e.toRow()&&(a.y=s.y+s.height+40),i>e.toCol()&&(a.x=s.x+s.width+100),t<e.fromRow()&&(o.y=s.y-40),n<e.fromCol()&&(o.x=s.x-100),0===t?o.move(0,-this.posYBuffer):o.move(0,1-this.posYBuffer),0===n?o.move(-this.posXBuffer,0):o.move(1-this.posXBuffer,0),a.move(this.posXBuffer,this.posYBuffer);var u=a.x-o.x,l=a.y-o.y;this.updateByCfg({x:o.x-1,y:o.y-1,width:u,height:l})}}}},{key:"paint",value:function(e,n){var r=this.parent().contentDoc().paintedRect();r.move(-this.posXBuffer,-this.posYBuffer),r.width+=2*this.posXBuffer,r.height+=2*this.posYBuffer;var i=r.intersectRect(n);i.isEmpty()||(0,l.Z)((0,p.Z)(t.prototype),"paint",this).call(this,e,i)}},{key:"updateRange",value:function(e){this.rg=e,this._syncPosAndSize()}}]),t}(k.FWidget);function ay(e,t,n){var r=t.getFrozenArea(),i=r.width,o=r.height,a=!(!i&&!o),s=e.getColHeaderWidth(),u=e.getRowHeaderHeight(),l=t.tables(),h=(0,c.Z)(l,4),d=h[0],f=h[1],p=h[2],v=h[3],g=o+u>n.y,_=i+s>n.x,y=v;a&&(g&&_?y=d:!g&&_?y=p:g&&!_&&(y=f));var m=n.x,E=n.y,b=n.width,T=n.height,C=new k.FPoint(m,E);y.mapFromParent(C),y.viewPos2Doc(C);var S=y.docPos2Cell(C.x,C.y),w=S.row,R=S.col,A=y.cell2DocPos({row:w,col:R});return{x:C.x-A.x,y:C.y-A.y,row:w,col:R,width:b,height:T}}function sy(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.dispatch(t?"FloatImageMultipleSelect":"FloatImageMultipleSelectEnd")}var uy,ly={width:9,height:9,background:"var(--B500-BG)",border:{width:1,color:"var(--N00-FG)"},radius:4.5},cy={x:4,y:4,ignore:!0,border:{width:1,color:"var(--text-link-hover)"},cursor:"zoom-in"};!function(e){e[e.TopLeft=0]="TopLeft",e[e.TopRight=1]="TopRight",e[e.BottomLeft=2]="BottomLeft",e[e.BottomRight=3]="BottomRight",e[e.Top=4]="Top",e[e.Right=5]="Right",e[e.Bottom=6]="Bottom",e[e.Left=7]="Left",e[e.ALL=8]="ALL"}(uy||(uy={}));var hy,dy=function(e){function t(e,n){var r;return(0,h.Z)(this,t),(r=(0,f.Z)(this,(0,p.Z)(t).call(this,e)))._type=n,r}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"type",value:function(){return this._type}}]),t}(k.FWidget),fy=function(e){function t(e){var n;return(0,h.Z)(this,t),(n=(0,f.Z)(this,(0,p.Z)(t).call(this,null)))._tableView=e,n._disable=!1,n._content=null,n._points=[],n._onEventType=null,n._globalPoint=new k.FPoint(0,0),n._oldDataInfo={row:0,col:0,x:0,y:0,width:0,height:0},n._aspectRatio=0,n._isActive=!1,n._once=!1,n._moveImageReport=w.default,n._resizeImageReport=w.default,n.getImgInfo=function(e,t){var r=e.getSheetFromId(t);if(!r||!n._content)return null;var i=r.getFloatImageMap()[n._content.id()],o=Z.Ps3.imageHelper.getDriveImageUrl(i.floatImageSetting.imageToken,e._context.getToken());return{fileToken:i.floatImageSetting.imageToken,height:i.floatImageSetting.height,link:o,width:i.floatImageSetting.width}},n.updateByCfg({ignore:[k.FEventType.MouseWheel],skipSelfEvent:!0}),n._container=new k.FWidget((0,s.Z)(n)),n._container.updateByCfg(cy),k.Bind.propBind(n._container,"width",(0,s.Z)(n),"width",(function(e){return e-8})),k.Bind.propBind(n._container,"height",(0,s.Z)(n),"height",(function(e){return e-8})),n._initPoints(),n.addEventFilter((function(e){return(e.type===k.FEventType.Dblclick||e.type===k.FEventType.ContextMenu)&&(e.preventDefault(),e.type!==k.FEventType.ContextMenu)})),n._moveImageReport=n._getDebounceAdjustImage("move_image"),n._resizeImageReport=n._getDebounceAdjustImage("resize_image"),n}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"_getDebounceAdjustImage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;return(0,S.default)((function(){var t;null===(t=Z.Ps3.collectSheetEvent)||void 0===t||t.call(Z.Ps3,"ccm_sheet_content_page_click",{click:"adjust_image",target:"none",sub_click:e,image_type:"over_cell"})}),t)}},{key:"_initPoints",value:function(){var e=new dy(this,0),t=new dy(this,1),n=new dy(this,2),r=new dy(this,3),i=new dy(this,4),o=new dy(this,5),a=new dy(this,7),s=new dy(this,6);e.updateByCfg(Object.assign({cursor:"nwse-resize"},ly)),t.updateByCfg(Object.assign({cursor:"nesw-resize"},ly)),n.updateByCfg(Object.assign({cursor:"nesw-resize"},ly)),r.updateByCfg(Object.assign({cursor:"nwse-resize"},ly)),i.updateByCfg(Object.assign({cursor:"ns-resize"},ly)),o.updateByCfg(Object.assign({cursor:"ew-resize"},ly)),a.updateByCfg(Object.assign({cursor:"ew-resize"},ly)),s.updateByCfg(Object.assign({cursor:"ns-resize"},ly)),e.updateByCfg({x:0,y:0}),a.updateByCfg({x:0}),i.updateByCfg({y:0}),t.updateByCfg({y:0}),n.updateByCfg({x:0}),k.Bind.propBind(o,"x",this,"width",(function(e){return e-9})),k.Bind.propBind(o,"y",this,"height",(function(e){return e/2-4.5})),k.Bind.propBind(a,"y",this,"height",(function(e){return e/2-4.5})),k.Bind.propBind(i,"x",this,"width",(function(e){return e/2-4.5})),k.Bind.propBind(s,"x",this,"width",(function(e){return e/2-4.5})),k.Bind.propBind(s,"y",this,"height",(function(e){return e-9})),k.Bind.propBind(t,"x",o,"x"),k.Bind.propBind(n,"y",s,"y"),k.Bind.propBind(r,"x",o,"x"),k.Bind.propBind(r,"y",s,"y"),this._points.push(e,t,n,r,i,o,a,s)}},{key:"updateDisableStatus",value:function(e){this._disable!==e&&(this._disable=e),!0===this._disable?(this._hideControlPoint(),this._container.updateByCfg({border:{width:2,color:"var(--text-link-hover)"}})):this._showControlPoint()}},{key:"_hideControlPoint",value:function(){this._points.forEach((function(e){return e.updateByCfg({hidden:!0})}))}},{key:"_showControlPoint",value:function(){this._points.forEach((function(e){return e.updateByCfg({hidden:!1})}))}},{key:"_bindPosCallback",value:function(e){return e+4.5}},{key:"_bindSizeCallback",value:function(e){return e-9}},{key:"show",value:function(){if(this._content){this.updateByCfg({hidden:!1});var e=this._content,t=e.x,n=e.y,r=e.width,i=e.height,o=e.zindex;this.updateByCfg({x:t-4.5,y:n-4.5,width:r+9,height:i+9,zindex:o+1,cursor:"zoom-in"}),k.Bind.propBind(this._content,"x",this,"x",this._bindPosCallback),k.Bind.propBind(this._content,"y",this,"y",this._bindPosCallback),k.Bind.propBind(this._content,"width",this,"width",this._bindSizeCallback),k.Bind.propBind(this._content,"height",this,"height",this._bindSizeCallback)}}},{key:"updateContent",value:function(e){null!==this._content&&this._content!==e&&this._content.exitEdit(),this._content=e}},{key:"mouseDown",value:function(e){var t;if(2===e.buttons)return null!==(t=this._tableView.getSheetView())&&void 0!==t&&t.shellWatcher.dispatch("HideCellContextMenu"),!1;var n=e.target;this._globalPoint=e.globalPoint(),this._onEventType=n instanceof dy?n.type():8,this._aspectRatio=this.width/this.height,this._isActive=!0;var r=this._getSheetView();return r&&sy(r.shellWatcher,!0),!0}},{key:"mouseMove",value:function(e){var t,n=this,r=this._getSheetView();if(!r)return!1;if(null===this._tableView.floatImage)return!1;if(2===e.buttons)return!1;if(this._disable)return!1;if(!1===this._isActive)return!1;r.shellWatcher.dispatch("FloatImageDragMove");var i=e.target,o=e.globalPoint(),a=r.zoom,s=(o.x-this._globalPoint.x)/a,u=(o.y-this._globalPoint.y)/a;if(!1===this._once){this._once=!0;var l=this._tableView.parent();if(this._tableView.floatImage.rnds.forEach((function(e){var t,n=e.mapToGlobal(new k.FPoint(0,0));null!==(t=e._content)&&void 0!==t&&t.setParent(l),e.setParent(l),e.updateByCfg({x:n.x/a,y:n.y/a})})),this._content){var c=xd(this._content);c&&c.capture(e.target)}}this._globalPoint=o;var h=0,d=0,f=0,p=0;if(i instanceof dy){if(i.type()!==this._onEventType)return!0;switch(i.type()){case 0:Math.abs(s)>Math.abs(u)?u=s/this._aspectRatio:s=u*this._aspectRatio;var v=this.x+s,g=this.y+u,_=this.width-s,y=this.height-u,m=this._tableView.sheet().getColHeaderWidth();v-m+4.5<=0&&(v=m-4.5);var E=this._tableView.sheet().getRowHeaderHeight();g-E+4.5<=0&&(g=E-4.5),_>5.5&&y>5.5&&(h=v-this.x,d=g-this.y,f=_-this.width,p=y-this.height);break;case 1:Math.abs(s)>Math.abs(u)?u=-s/this._aspectRatio:s=-u*this._aspectRatio;var b=this.y+u,T=this.width+s,C=this.height-u,S=this._tableView.sheet().getRowHeaderHeight();b-S+4.5<=0&&(b=S-4.5),T>5.5&&C>5.5&&(d=b-this.y,f=T-this.width,p=C-this.height);break;case 3:Math.abs(s)>Math.abs(u)?u=s/this._aspectRatio:s=u*this._aspectRatio;var w=this.width+s,R=this.height+u;w>5.5&&R>5.5&&(f=w-this.width,p=R-this.height);break;case 2:Math.abs(s)>Math.abs(u)?u=-s/this._aspectRatio:s=-u*this._aspectRatio;var A=this.x+s,O=this.width-s,M=this.height+u,I=this._tableView.sheet().getColHeaderWidth();A-I+4.5<=0&&(A=I-4.5),O>5.5&&M>5.5&&(h=A-this.x,f=O-this.width,p=M-this.height);break;case 6:var x=this.height+u;x>5.5&&(p=x-this.height);break;case 4:var N=this.y+u,P=this.height-u,L=this._tableView.sheet().getRowHeaderHeight();N-L+4.5<=0&&(N=L-4.5),P>5.5&&(p=P-this.height,d=N-this.y);break;case 7:var D=this.x+s,F=this.width-s,B=this._tableView.sheet().getColHeaderWidth();D-B+4.5<=0&&(D=B-4.5),F>5.5&&(h=D-this.x,f=F-this.width);break;case 5:var V=this.width+s;V>5.5&&(f=V-this.width)}r.shellWatcher.dispatch("HideFloatMenu"),this._resizeImageReport()}else if(8===this._onEventType){var H=this.x+s,U=this.y+u,Z=this._tableView.sheet().getRowHeaderHeight(),W=this._tableView.sheet().getColHeaderWidth();H-W+4.5<=0&&(H=W-4.5),U-Z+4.5<=0&&(U=Z-4.5),h=H-this.x,d=U-this.y,r.shellWatcher.dispatch("HideFloatMenu"),this._moveImageReport()}return this._content&&(h||d||f||p)&&(null!==(t=this._tableView.floatImage)&&void 0!==t&&t.layer.updateImageRender({dx:h,dy:d,dw:f,dh:p}),r.tables().filter((function(e){return e!==n._tableView})).forEach((function(e){var t;null===(t=e.floatImage)||void 0===t||t.layer.toggleEntitesHidden()}))),!0}},{key:"mouseUp",value:function(e){if(2===e.buttons)return!1;var n="",r=!1;return e.target instanceof t?n="embed_img_move":e.target instanceof dy&&(n="embed_img_size",r=!0),n&&Z.Ps3.collectSuiteEvent("sheet_opration",{action:n,item_located_type:"over_cell"}),this.moveEnd(!r)}},{key:"moveEnd",value:function(){var e,t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=this._getSheetView();if(!r)return!1;if(null===this._tableView.floatImage)return!1;if(!this._isActive)return!1;var i=this._tableView.sheet();if(this._content&&!1===this._once&&n&&this.fullscreenImg(),this._disable)return this._isActive=!1,this._once=!1,!1;if(r.shellWatcher.dispatch("FloatImageDragEnd"),this._onEventType=null,this._content&&!0===this._once){var o=ay(i,this._getSheetView(),this._content);!0===this._isValidChange(o)?(this._oldDataInfo=o,sy(r.shellWatcher,!1),this._tableView.floatImage.layer.updateContentData()):sy(r.shellWatcher,!1),this._tableView.floatImage.layer.updateResizeDragWhenMoveEnd(),r.tables().filter((function(e){return e!==t._tableView})).forEach((function(e){var t;null===(t=e.floatImage)||void 0===t||t.layer.toggleEntitesHidden(!1)}))}else sy(r.shellWatcher,!1);return null!==(e=xd(this))&&void 0!==e&&e.releaseCapture(),this._isActive=!1,this._once=!1,!0}},{key:"content",value:function(){return this._content||null}},{key:"contentId",value:function(){return this._content?this._content.id():""}},{key:"fullscreenImg",value:function(){var e,t=this._getSheetView();if(t){var n=this._tableView.sheet(),r=n.parent,i=this.getImgInfo(r,n.id());if(i){var o=i.fileToken,a=r.getService(H.Qh);(!o||a.checkAttachment(o).previewable)&&(t.shellWatcher.dispatch("OpenFloatImgFullScreen",i),null===(e=Z.Ps3.collectSheetEvent)||void 0===e||e.call(Z.Ps3,"ccm_sheet_content_page_click",{click:"view_image",target:"ccm_drive_page_view ",image_type:"over_cell",action_type:"click"}))}}}},{key:"_isValidChange",value:function(e){var t=this;return Object.keys(this._oldDataInfo).some((function(n){return t._oldDataInfo[n]!==e[n]}))}},{key:"validateCfg",value:function(e){return!(e.width<29||e.height<29)}},{key:"_getSheetView",value:function(){return this._tableView.getSheetView()}}]),t}(k.FWidget),py=function(e){function t(e,n,r,i){var o;return(0,h.Z)(this,t),(o=(0,f.Z)(this,(0,p.Z)(t).call(this,e)))._id=n,o._token=r,o._tableView=i,o._isActive=!1,o._disable=!1,o._realZindex=0,o.rnd=null,o._hasTapped=!1,o._previewable=!0,o._activeImage=function(e){o._id===e&&!1===o._isActive&&o.enterEdit()},o._inActiveImage=function(e){o._id===e&&!0===o._isActive&&o.exitEdit()},o.updateByCfg({ignore:[k.FEventType.MouseWheel,k.FEventType.PanStart],crossOrigin:"use-credentials"}),o._tableView.uiEvent.on("ActiveImage",o._activeImage),o._tableView.uiEvent.on("InActiveImage",o._inActiveImage),o}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"isActive",value:function(){return this._isActive}},{key:"id",value:function(){return this._id}},{key:"token",value:function(){return this._token}},{key:"setZindex",value:function(e){var t;this._realZindex=null!==(t=e)&&void 0!==t?t:0}},{key:"getZindex",value:function(){return this._realZindex}},{key:"setPreviewable",value:function(e){this._previewable=e}},{key:"updateDisableStatus",value:function(e){this._disable=e}},{key:"enterEdit",value:function(){if(this._isActive=!0,this.updateByCfg({zindex:(0,x.NPK)()+1e3}),this._tableView.floatImage){this.removeRnd();var e=new fy(this._tableView);this.rnd=e,this._tableView.floatImage.rnds.push(this.rnd),this._tableView.floatImage.content.doc.addChild(this.rnd),e.updateContent(this),e.show(),e.updateDisableStatus(this._disable),this._previewable&&this.updateByCfg({cursor:"zoom-in"})}this._tableView.uiEvent.trigger("ActiveImage",[this._id])}},{key:"exitEdit",value:function(){this._isActive=!1,this.updateByCfg({zindex:this.getZindex()}),this.updateByCfg({cursor:"default"}),this.removeRnd(),this._tableView.uiEvent.trigger("InActiveImage",[this._id])}},{key:"removeRnd",value:function(){var e=this;if(this._tableView.floatImage){var t,n=this._tableView.floatImage.rnds.find((function(t){return t.contentId()===e.id()}));if(n)null!==(t=xd(n))&&void 0!==t&&t.releaseCapture(),n.parent().removeChild(n),this._tableView.floatImage.rnds=this._tableView.floatImage.rnds.filter((function(t){return t.contentId()!==e.id()}));this.rnd=null}}},{key:"press",value:function(e){return this.handleEnterEdit(e)}},{key:"tap",value:function(e){return this.handleEnterEdit(e)}},{key:"handleEnterEdit",value:function(e){var t=this._tableView.sheet();return!(!this.isReady()||!t)&&(t.clearSelection(),this._hasTapped=!0,this.handleMouseDownEnterEdit(e,!1))}},{key:"dblClick",value:function(){return!0}},{key:"mouseDown",value:function(e){if(!1===this.isReady())return!1;if(this._hasTapped)return this._hasTapped=!1,!0;var t=(L().isMac?e.metaKey:e.ctrlKey)||e.shiftKey;return this._isActive?this.handleMouseDownActive(e,t):this.handleMouseDownEnterEdit(e,t)}},{key:"handleMouseDownActive",value:function(e,t){var n,r;return t?(null!==(n=this.rnd)&&void 0!==n&&n.mouseDown(e),this.exitEdit(),this._tableView.sheet().floatImageModel.removeActiveId(this._id),!0):(2===e.buttons&&this.dispatchContextMenu(e),(null===(r=this.rnd)||void 0===r?void 0:r.mouseDown(e))||!1)}},{key:"handleMouseDownEnterEdit",value:function(e,t){var n=this._getSheetView();return!n||(this.enterEdit(),t?this._tableView.sheet().floatImageModel.appendActiveId(this._id):(n.tables().forEach((function(e){return e.clearFloatImageSelection()})),this._tableView.sheet().floatImageModel.setActiveId([this._id],!0)),2===e.buttons&&this.dispatchContextMenu(e),!0)}},{key:"dispatchContextMenu",value:function(e){var t=this._getSheetView();if(t){t.shellWatcher.dispatch("HideCellContextMenu");var n=e.globalPoint();t.shellWatcher.dispatch("ShowFloatMenu",{pt:n,id:this._id})}}},{key:"mouseMove",value:function(e){var t;return!!this._isActive&&(this.updateByCfg({cursor:1===e.buttons?"grabbing":0===e.buttons&&this._previewable?"zoom-in":"default"}),(null===(t=this.rnd)||void 0===t?void 0:t.mouseMove(e))||!1)}},{key:"mouseUp",value:function(e){var t;return!!this._isActive&&(this.updateByCfg({cursor:this._previewable?"zoom-in":"default"}),(null===(t=this.rnd)||void 0===t?void 0:t.mouseUp(e))||!1)}},{key:"frozenAreaUnfold",value:function(){var e=this._getSheetView();if(e){var t=e.tlTable(),n=e.trTable(),r=e.blTable(),i=e.brTable(),o=[];if(null!==t.floatImage){var a=t.floatImage.layer.getImageById(this._id);if(a){var s=new k.FPoint(a.x,a.y),u=t.floatImage.content.doc.mapToGlobal(s);o.push(u)}}if(null!==n.floatImage){var l=n.floatImage.layer.getImageById(this._id);if(l){var c=new k.FPoint(l.x,l.y),h=n.floatImage.content.doc.mapToGlobal(c);o.push(h)}}if(null!==r.floatImage){var d=r.floatImage.layer.getImageById(this._id);if(d){var f=new k.FPoint(d.x,d.y),p=r.floatImage.content.doc.mapToGlobal(f);o.push(p)}}if(null!==i.floatImage){var v=i.floatImage.layer.getImageById(this._id);if(v){var g=new k.FPoint(v.x,v.y),_=i.floatImage.content.doc.mapToGlobal(g);o.push(_)}}if(0!==o.length)for(var y=o[0].x,m=o[0].y,E=1;E<o.length;E++)y!==o[E].x&&e.brTable().contentDoc().updateByCfg({posX:0}),m!==o[E].y&&e.brTable().contentDoc().updateByCfg({posY:0})}}},{key:"_getSheetView",value:function(){return this._tableView.getSheetView()}},{key:"destroy",value:function(){var e;this._tableView.uiEvent.off("ActiveImage",this._activeImage),this._tableView.uiEvent.off("InActiveImage",this._inActiveImage),null!==(e=this.rnd)&&void 0!==e&&e.destroy(),(0,l.Z)((0,p.Z)(t.prototype),"destroy",this).call(this)}}]),t}(I.FImage);!function(e){e[e.TOP=0]="TOP",e[e.LEFT=1]="LEFT",e[e.BOTTOM=2]="BOTTOM",e[e.RIGHT=3]="RIGHT"}(hy||(hy={}));var vy=function(e){function t(e,n){var r;return(0,h.Z)(this,t),(r=(0,f.Z)(this,(0,p.Z)(t).call(this,e)))._direction=n,r}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"renderWidget",value:function(e,n,r){if((r=r||this._cfg).shadow&&r.shadow.blur){var i=r.shadow.blur,o=new k.FRect(r.x,r.y,r.width,r.height);0===this._direction?(o.y-=i,o.height+=i):1===this._direction?(o.x-=i,o.width+=i):2===this._direction?o.height+=i:3===this._direction&&(o.width+=i),e.rect(o.x,o.y,o.width,o.height)}(0,l.Z)((0,p.Z)(t.prototype),"renderWidget",this).call(this,e,n,r)}}]),t}(k.FWidget),gy=function(e){function t(e,n){var r;return(0,h.Z)(this,t),(r=(0,f.Z)(this,(0,p.Z)(t).call(this,xf.DragFilling,e))).w=e,r.range=n,r}return(0,v.Z)(t,e),t}(k.FEvent),_y=function(e){function t(e){var n;return(0,h.Z)(this,t),(n=(0,f.Z)(this,(0,p.Z)(t).call(this,xf.DragFilled,e))).w=e,n}return(0,v.Z)(t,e),t}(k.FEvent),yy=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).cursor="Crosshair",e.selectionController=null,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=od,t=ad,n=new Array(4).fill({color:"var(--N00-FG)",width:1}),r=id.width-2,i=id.height-2;return k.SizedBox.with({width:e,height:t}).fill((function(){return k.Center.fill((function(){return k.BorderBox.with({border:n}).fill((function(){return k.SizedBox.with({width:r,height:i}).fill((function(){return I.FBlock.with({background:id.background})}))}))}))}))}},{key:"mouseDown",value:function(e){if(!this.selectionController)return!1;var t=e.globalPoint(),n=t.x,r=t.y;return this.selectionController._fillHandler.start(n,r),this.selectionController._fillHandler.clearContinueSelTimer(),!0}},{key:"mouseMove",value:function(e){if(!this.selectionController||!this.selectionController.sheetView)return!1;var t=this.selectionController.sheetView;if(!this.selectionController.sheetView.viewModel.getEditable())return!1;var n=e.globalPoint();if(e.buttons===k.FMouseButtons.None)return this.mouseUp(e);var r=this.selectionController._fillHandler.continueSel(n.x,n.y),i=new gy(t,r);if(k.ListenersControl.sendEvent(t,i),null!==r){var o=L().isMac?e.altKey:e.ctrlKey;this.selectionController.showTooltip(r,o)}else this.selectionController.removeTooltip();return!0}},{key:"mouseUp",value:function(e){if(!this.selectionController)return!1;this.selectionController._fillHandler.clearContinueSelTimer();var t=this.selectionController.sheetView;if(!t.viewModel.getEditable())return!1;var n=this.selectionController._fillHandler.direction(),r=e.globalPoint(),i=this.selectionController._fillHandler.end(r.x,r.y,{shiftKey:e.shiftKey,triggerFrom:"mouseUPEvent"});if(null==n||null==i)return!0;var o=this.selectionController.getActiveSelectedRange(),a=this.selectionController.clipFillRange(i,n);if(null!==a&&!o.equal(a)&&this.selectionController.validateFillRange(o,a,!0)){var s=L().isMac?e.altKey:e.ctrlKey;this.selectionController.executeFill(o,a,i,n,s,"drag")}var u=new _y(t);return k.ListenersControl.sendEvent(t,u),this.selectionController.removeTooltip(),!0}},{key:"dblClick",value:function(e){if(!this.selectionController||!this.selectionController.sheetView)return!1;if(!this.selectionController.sheetView.viewModel.getEditable())return!0;var t=this.selectionController.sheet._getActiveSelectedRange(),n=function(e,t){if(e.colFrom()<=0)return null;for(var n=t.getRowCount(),r=new x.e6w(e.rowFrom(),e.colFrom()-1,1,1,t),i=r.rowFrom(),o=r.colFrom(),a=e.colTo(),s=e.colFrom(),u=0,l=i;l<n&&null!=t.getValue(l,o);l++){if(l>e.rowTo()){for(var c=!1,h=s;h<a+1;h++)null!=t.getValue(l,h)&&(c=!0);if(c)break}u++}return u<=e.rowCount()?null:new x.e6w(e.rowTo()+1,e.colFrom(),u-e.rowCount(),e.colCount(),t)}(t,this.selectionController.sheet);if(!n)return!0;var r=new x.e6w(t.rowFrom(),t.colFrom(),t.rowCount()+n.rowCount(),t.colCount(),this.selectionController.sheet),i=L().isMac?e.altKey:e.ctrlKey;return this.selectionController.executeFill(t,n,r,3,i,"double_click"),!0}}]),t}(k.FBaseWidget);hp([k.State],yy.prototype,"cursor",void 0),hp([k.State],yy.prototype,"selectionController",void 0);var my=function(e){function t(e,n){var r;return(0,h.Z)(this,t),(r=(0,f.Z)(this,(0,p.Z)(t).call(this,e.contentDoc(),e.getSheetView(),!0,(function(){}))))._sheet=n,r._continuePt=new k.FPoint(0,0),r.continueSelTimer=null,r}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"updateSheet",value:function(e){this._sheet=e}},{key:"start",value:function(e,t){var n=this._sheet._getActiveSelectedRange();this._start={row:n.rowFrom(),col:n.colFrom()};var r=new k.FPoint(e,t);return this._startPt=this.view().mapFromGlobal(r),this.continueSel(e,t)}},{key:"direction",value:function(){if(null===this._start||null===this._end)return null;var e=this._sheet._getActiveSelectedRange(),t=e.rowFrom()+e.rowCount()-1,n=e.colFrom()+e.colCount()-1,r=this._end.row-t,i=this._end.col-n;return Math.abs(i)>Math.abs(r)?i>0?1:0:r>0?3:2}},{key:"clearContinueSelTimer",value:function(){this.continueSelTimer&&(clearInterval(this.continueSelTimer),this.continueSelTimer=null)}},{key:"continueSel",value:function(e,t){var n=this;if(null===this._start||!this._sheetView)return null;if(null==this.view().parent())return null;var r=this._sheet.getSelections()[0],i=r.rowFrom(),o=r.colFrom();i===this._start.row&&o===this._start.col||this.start(e,t);var a=this._end,s=new k.FPoint(e,t);if(this._end=this._sheetView.globalPoint2Cell(s),this._continueX=e,this._continueY=t,this._continuePt=this.view().mapFromGlobal(s),this._autoScrollIfOver&&this._tryOverScroll(this._continueX,this._continueY,this._sheetView)&&(this.clearContinueSelTimer(),this.continueSelTimer=setTimeout((function(){return n.continueSel(n._continueX,n._continueY)}),100)),!this.validateXY())return null;var u=this._composeRange(e,t),l=a===this._end||null!==a&&null!==this._end&&a.row===this._end.row&&a.col===this._end.col;return null!==u&&this._doSel&&!l&&this._doSel(u,this._customData,s),u}},{key:"validateXY",value:function(){return!(!this._start||!this._end||this._continuePt.x===this._startPt.x&&this._continuePt.y===this._startPt.y)}},{key:"_composeRange",value:function(e,n){var r=(0,l.Z)((0,p.Z)(t.prototype),"_composeRange",this).call(this,e,n);if(null===r)return null;var i=this._sheet._getActiveSelectedRange(),o=this.direction();return 2===o||3===o?(r.setColFrom(i.colFrom()),r.setColCount(i.colCount())):(r.setRowFrom(i.rowFrom()),r.setRowCount(i.rowCount())),i.contain(r)?i:(2===o&&r.setRowCount(r.rowCount()+i.rowCount()-1),0===o&&r.setColCount(r.colCount()+i.colCount()-1),r)}}]),t}(jv);var Ey=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).rg=null,e.view=null,e.skipSelfEvent=!0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){if(!this.view||!this.rg)return null;var e=this.view.getCornerBtnPosition(this.rg);return e?k.Stack.fill((function(){return e.filter((function(e){return e.enable})).map((function(e,t){var n=e.left,r=e.top;return k.Positioned.with({left:n,top:r,key:"SelectionCircleCorner_".concat(t)}).fill((function(){return by.with({left:n,top:r})}))}))})):null}}]),t}(k.FBaseWidget);hp([k.State],Ey.prototype,"rg",void 0),hp([k.State],Ey.prototype,"view",void 0),hp([k.State],Ey.prototype,"skipSelfEvent",void 0);var by=function(e){function t(){return(0,h.Z)(this,t),(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"paintSelf",value:function(e){var t=sd.width,n=sd.background;e.save(),e.beginPath(),e.fillStyle=(0,k.convertThemeColor)(this,n,k.ColorThemeType.Background),e.arc(t/2,t/2,t/2,0,2*Math.PI),e.fill(),e.restore()}}]),t}(k.FBaseWidget),Ty=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).rg=null,e.view=null,e.selectionController=null,e.skipSelfEvent=!0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=this;if(this.rg&&this.view){var t=nv(this.view,this.rg,2,2),n=t.x,r=t.y,i=t.width,o=r+t.height-1-ad/2,a=n+i-1-od/2;return k.Stack.with({clip:!1}).fill((function(){return[k.Positioned.with({top:o,left:a,key:"NormalSelectionCorner"}).fill((function(){return yy.with({selectionController:e.selectionController})}))]}))}return null}}]),t}(k.FBaseWidget);hp([k.State],Ty.prototype,"rg",void 0),hp([k.State],Ty.prototype,"view",void 0),hp([k.State],Ty.prototype,"selectionController",void 0),hp([k.State],Ty.prototype,"skipSelfEvent",void 0);var Cy=function(){var e=Z.Ps3.browser,t=e.isMac,n=e.isIPad,r=e.isIOS;return t||n||r},Sy=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).cursor="Crosshair",e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=od,t=ad,n=new Array(4).fill({color:"var(--N00-FG)",width:1}),r=id.width-2,i=id.height-2;return k.SizedBox.with({width:e,height:t}).fill((function(){return k.Center.fill((function(){return k.BorderBox.with({border:n}).fill((function(){return k.SizedBox.with({width:r,height:i}).fill((function(){return I.FBlock.with({background:id.background})}))}))}))}))}},{key:"mouseDown",value:function(e){if(!this.dispatchShellEvent)return!1;var t=e.globalPoint();return this.dispatchShellEvent("CornerMouseDown",{glbPt:t}),!0}},{key:"mouseMove",value:function(e){if(!this.dispatchShellEvent)return!1;var t=e.globalPoint(),n=Cy()?e.altKey:e.ctrlKey;return e.buttons===k.FMouseButtons.None?this.dispatchShellEvent("CornerMouseUp",{glbPt:t,reverseAutoFill:n}):this.dispatchShellEvent("CornerMouseMove",{glbPt:t,reverseAutoFill:n}),!0}},{key:"mouseUp",value:function(e){if(!this.dispatchShellEvent)return!1;var t=e.globalPoint(),n=Cy()?e.altKey:e.ctrlKey;return this.dispatchShellEvent("CornerMouseUp",{glbPt:t,reverseAutoFill:n}),!0}},{key:"dblClick",value:function(e){if(!this.dispatchShellEvent)return!1;var t=e.globalPoint();return this.dispatchShellEvent("CornerDbClick",{glbPt:t}),!0}}]),t}(k.FBaseWidget);hp([k.State],Sy.prototype,"cursor",void 0),hp([k.State],Sy.prototype,"dispatchShellEvent",void 0);var wy=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).rg=null,e.view=null,e.skipSelfEvent=!0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=this.rg,t=this.view;if(e&&t){var n=nv(t,e,2,2),r=n.x,i=n.y,o=n.width,a=i+n.height-1-ad/2,s=r+o-1-od/2;return k.Stack.with({clip:!1}).fill((function(){return[k.Positioned.with({top:a,left:s,key:"NormalSelectionCornerV2"}).fill((function(){var e;return Sy.with({dispatchShellEvent:null===(e=t.getSheetView())||void 0===e?void 0:e.shellWatcher.dispatch})}))]}))}return null}}]),t}(k.FBaseWidget);function Ry(e){return null==e?void 0:e.inject(x.Wph)}hp([k.State],wy.prototype,"rg",void 0),hp([k.State],wy.prototype,"view",void 0),hp([k.State],wy.prototype,"skipSelfEvent",void 0);var Ay=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).view=null,e.ignore=!0,e.rg=null,e.borderStyle=null,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"initState",value:function(){var e=this;return this.state$.subscribe((function(t){var n=t.rg,r=t.borderStyle;e.rg=n,e.borderStyle=r}))}},{key:"describe",value:function(){if(!this.view||!this.rg)return null;var e=this.borderStyle||ev,t=nv(this.view,this.rg,0,0,e.dashLine),n=t.x,r=t.y,i=t.width,o=t.height;return k.Stack.fill((function(){return[k.Positioned.with({key:"AutoFillSelectionV2",left:n,top:r}).fill((function(){return tv.with({width:i,height:o,border:e})}))]}))}}]),t}(_v);hp([k.State],Ay.prototype,"view",void 0),hp([k.State],Ay.prototype,"ignore",void 0),hp([k.State],Ay.prototype,"rg",void 0),hp([k.State],Ay.prototype,"borderStyle",void 0),hp([k.State],Ay.prototype,"state$",void 0);var Oy=function(e){function t(e){var n;return(0,h.Z)(this,t),(n=(0,f.Z)(this,(0,p.Z)(t).call(this))).state$=(0,j.aj)(e.pipe((0,ce.w)((function(e){var t,n;return null!==(t=null===(n=Ry(e))||void 0===n?void 0:n.selRange$)&&void 0!==t?t:(0,G.of)(null)}))),e.pipe((0,ce.w)((function(e){var t,n;return null!==(t=null===(n=Ry(e))||void 0===n?void 0:n.selectionDashBorderStyle$)&&void 0!==t?t:(0,G.of)(null)})))).pipe((0,le.map)((function(e){var t=(0,c.Z)(e,2);return{rg:t[0],borderStyle:t[1]}}))).pipe((0,de.R)(n.dispose$)),n}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"render",value:function(e){return Ay.with({key:"AutoFillSelections",view:e,state$:this.state$})}}]),t}(gv);function My(e){return new Oy(e.worksheet$)}function ky(e){return null==e?void 0:e.inject(x.Wph)}var Iy=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).key="ToolTips",e.ignore=!0,e.view=null,e.toolTips=new I.FLabel(null),e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"initState",value:function(){var e=this;return this.toolTips.updateByCfg(Object.assign({},Md,{zindex:Ff})),this.state$.subscribe((function(t){var n=t.text,r=t.toolTipsCellPosition;e.text=n;var i=(0,c.Z)(r,2),o=i[0],a=i[1];e.row=o,e.col=a}))}},{key:"describe",value:function(){var e,t=null===(e=this.view)||void 0===e?void 0:e.sheet();if(!this.view||!t||-1===this.row||-1===this.col||!this.text)return null;var n=this.view.getNotExpendCellRect(this.row,this.col),r=n.x,i=n.y,o=t.getRowCount(),a=t.getColumnCount();this.row+1>=o&&(i-=40),this.col+1>=a&&(r-=40);var s=this.view.mapFromGlobal(new k.FPoint(r,i));return this.toolTips.updateByCfg({hidden:!Boolean(this.text),x:s.x+3,y:s.y+3,text:this.text}),(0,ye.widget2State)(this.toolTips)}}]),t}(_v);hp([k.State],Iy.prototype,"key",void 0),hp([k.State],Iy.prototype,"ignore",void 0),hp([k.State],Iy.prototype,"state$",void 0),hp([k.State],Iy.prototype,"view",void 0),hp([k.State],Iy.prototype,"text",void 0),hp([k.State],Iy.prototype,"row",void 0),hp([k.State],Iy.prototype,"col",void 0);var xy=function(e){function t(e){var n;return(0,h.Z)(this,t),(n=(0,f.Z)(this,(0,p.Z)(t).call(this))).state$=(0,j.aj)(e.pipe((0,ce.w)((function(e){var t,n;return null!==(t=null===(n=ky(e))||void 0===n?void 0:n.toolTipsCellPosition$)&&void 0!==t?t:(0,G.of)([-1,-1])}))),e.pipe((0,ce.w)((function(e){var t,n;return null!==(t=null===(n=ky(e))||void 0===n?void 0:n.toolTipsText$)&&void 0!==t?t:(0,G.of)("")})))).pipe((0,le.map)((function(e){var t=(0,c.Z)(e,2),n=t[0];return{text:t[1],toolTipsCellPosition:n}}))).pipe((0,de.R)(n.dispose$)),n}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"render",value:function(){return Iy.with({key:"ToolTips",view:this.host,state$:this.state$})}}]),t}(mv);function Ny(e){return new xy(e.worksheet$)}var Py=(0,U.getCurrentThemeType)()===U.ThemeType.DARK?"var(--Y500)":"var(--Y350)",Ly={width:10,height:10,border:{color:"var(--N00-FG)",width:2},borderRadius:2,background:Py,shadow:{offsetX:0,offsetY:0,blur:2,color:(0,N.getAlphaColor)((0,N.getThemeColorByToken)("N900-FG"),.27)}},Dy=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=e.getSheetView();if(!i||t instanceof x.SWH)return null;var o=i.sheet();if(!o)return null;var a=2,s=2,u=nv(e,t,a,s),l=u.x,c=u.y,h=u.width,d=u.height,f=n.width,p=n.height,v=f+2*r,g=p+2*r;if(1===h&&1===d&&l<=0)return null;var _=i.getFrozenArea(),y=_.width,m=_.height,E=o.getRowHeaderHeight(),b=o.getColHeaderWidth(),T=i.tableContainer().width-b-i._rightMargin,C=i.tableContainer().height-E-i._bottomMargin,S=t.rowFrom(),w=t.colFrom(),R=o.getFrozenRowCount(),A=o.getFrozenColumnCount(),O=Kf.injectableStaticConfig.selection.normalSelectionBorderWidth,M=0,k=0,I=0,N=0,P=!0;return t instanceof x.lq$?(M=I=Math.min(T,h)/2-y-v/2,I=M,N=(k=c+s-g/2)+d-O,P=0!==S&&S!==R):t instanceof x.rvb?(M=l+a-v/2,k=N=Math.min(C,d)/2-m-g/2,I=M+h-O,P=0!==w&&w!==A):(I=(M=l+a-v/2)+h-O,N=(k=c-g/2)+d-O,P=0!==S&&0!==w&&S!==R&&w!==A),{size:{width:v,height:g},positions:[{left:M,top:k,enable:P,triggerEvent:!1},{left:I,top:N,enable:!0,triggerEvent:!0}]}},Fy=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).skipSelfEvent=!1,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"press",value:function(e){return!!this.dispatchShellEvent&&(this.dispatchShellEvent("ChangeToFillCorner"),this.dispatchShellEvent("HideCellContextMenu"),e.preventDefault(),e.srcEventPreventDefault(),!0)}},{key:"describe",value:function(){var e=this;return k.SizedBox.with(this.cornerPop).fill((function(){return k.Center.fill((function(){return k.SizedBox.with(e.cornerToken).fill((function(){return by.with({})}))}))}))}}]),t}(k.FBaseWidget);hp([k.State],Fy.prototype,"dispatchShellEvent",void 0),hp([k.State],Fy.prototype,"skipSelfEvent",void 0),hp([k.State],Fy.prototype,"cornerToken",void 0),hp([k.State],Fy.prototype,"cornerPop",void 0);var By=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).rg=null,e.view=null,e.skipSelfEvent=!0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=this.rg,t=this.view;if(!e||!t)return null;var n=sd,r=15/t.getSheetView().zoom,i=Dy(t,e,n,r)||{},o=i.size,a=i.positions;if(!o||!a)return null;return k.Stack.with({clip:!1}).fill((function(){return a.filter((function(e){return e.enable})).map((function(e,r){var i=e.top,a=e.left,s=e.triggerEvent,u="".concat("NormalSelectionCircleCornerV2","-").concat(s,"-").concat(r);return k.Positioned.with({top:i,left:a,key:u}).fill((function(){var e;return Fy.with({dispatchShellEvent:s?null===(e=t.getSheetView())||void 0===e?void 0:e.shellWatcher.dispatch:null,cornerToken:n,cornerPop:o})}))}))}))}}]),t}(k.FBaseWidget);hp([k.State],By.prototype,"rg",void 0),hp([k.State],By.prototype,"view",void 0),hp([k.State],By.prototype,"skipSelfEvent",void 0);var Vy=function(e){function t(){return(0,h.Z)(this,t),(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=Ly.width,t=Ly.height,n=Ly.background;return k.SizedBox.with({width:e,height:t}).fill((function(){return I.FBlock.with({background:n})}))}},{key:"paintSelf",value:function(e){var t=Ly.width,n=Ly.height,r=Ly.borderRadius,i=Ly.shadow,o=Ly.border,a=o.width,s=o.color,u=this.pos.x-a,l=this.pos.y-a,c=2*a+t,h=2*a+n,d=(0,k.convertThemeColor)(this,s,k.ColorThemeType.Background);(0,k.paintRoundedRectangle)(e,u,l,c,h,d,r,i)}}]),t}(k.FBaseWidget),Hy=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).call(this))).dispatchDbTouchEvent=(0,S.default)((function(t){e.dispatchShellEvent("MobileCornerDbTouch",{glbPt:t})}),200),e._addEventFilter(),e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"_addEventFilter",value:function(){var e=this;this.addEventFilter((function(t){var n;if(!e.dispatchShellEvent)return!1;var r=t instanceof k.FPanEvent?null===(n=t.nativeEvent)||void 0===n?void 0:n.srcEvent:t,i=!!(Cy()?null==r?void 0:r.altKey:null==r?void 0:r.ctrlKey);switch(t.type){case k.FEventType.PanStart:e.dispatchShellEvent("MobileFillCornerDragStart",{glbPt:t.globalCenter()});break;case k.FEventType.MouseDown:e.dispatchShellEvent("MobileFillCornerDragStart",{glbPt:t.globalPoint()});break;case k.FEventType.PanMove:e.dispatchShellEvent("MobileFillCornerDragMove",{glbPt:t.globalCenter(),reverseAutoFill:i});break;case k.FEventType.MouseMove:e.dispatchShellEvent("MobileFillCornerDragMove",{glbPt:t.globalPoint(),reverseAutoFill:i});break;case k.FEventType.PanEnd:e.dispatchShellEvent("MobileFillCornerDragEnd",{glbPt:t.globalCenter(),reverseAutoFill:i});break;case k.FEventType.MouseUp:e.dispatchShellEvent("MobileFillCornerDragEnd",{glbPt:t.globalPoint(),reverseAutoFill:i});break;case k.FEventType.PanCancel:e.dispatchShellEvent("MobileFillCornerDragCancel");break;case k.FEventType.DoubleTap:e.dispatchDbTouchEvent(t.globalCenter());break;case k.FEventType.Dblclick:e.dispatchDbTouchEvent(t.globalPoint());break;case k.FEventType.Click:case k.FEventType.Tap:break;default:return!1}return t.preventDefault(),t.srcEventPreventDefault(),!0}))}},{key:"describe",value:function(){return k.SizedBox.with(this.cornerPop).fill((function(){return k.Center.fill((function(){return Vy.with({})}))}))}}]),t}(k.FBaseWidget);hp([k.State],Hy.prototype,"dispatchShellEvent",void 0),hp([k.State],Hy.prototype,"cornerPop",void 0);var Uy=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).rg=null,e.view=null,e.skipSelfEvent=!0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=this.rg,t=this.view;if(!e||!t)return null;var n=Ly.width,r=Ly.height,i=Ly.border.width,o={width:n+2*i,height:r+2*i},a=30/t.getSheetView().zoom,s=Dy(t,e,o,a)||{},u=s.size,l=s.positions,c=null==l?void 0:l[1];if(!u||!c)return null;var h=c.left,d=c.top;return k.Stack.with({clip:!1}).fill((function(){return[k.Positioned.with({left:h,top:d,key:"MobileSelectionFillCorner"}).fill((function(){var e;return Hy.with({dispatchShellEvent:null===(e=t.getSheetView())||void 0===e?void 0:e.shellWatcher.dispatch,cornerPop:u})}))]}))}}]),t}(k.FBaseWidget);hp([k.State],Uy.prototype,"rg",void 0),hp([k.State],Uy.prototype,"view",void 0),hp([k.State],Uy.prototype,"skipSelfEvent",void 0);var Zy=function(e){function t(e,n){var r;return(0,h.Z)(this,t),(r=(0,f.Z)(this,(0,p.Z)(t).call(this,e,"FContainer")))._sheetView=n,r._handleFloatImageSelection(),r}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"_handleFloatImageSelection",value:function(){var e=this,t=new Set([k.FEventType.MouseDown,k.FEventType.Tap,k.FEventType.Press]);this.addEventFilter((function(n){return t.has(n.type)&&[fy,py,dy].every((function(e){return!(n.target instanceof e)}))&&!function(e){return!!e.rNode}(n.target)&&e._sheetView.sheet().floatImageModel.activeFloatImageIds.length?e._sheetView.clearFloatImageSelection():n.type===k.FEventType.Click&&e._sheetView.shellWatcher.dispatch("HideFloatMenu"),!1}))}},{key:"fvgNode",value:function(){var e=(0,l.Z)((0,p.Z)(t.prototype),"fvgNode",this).call(this);return e.type="sheet/container",e}}]),t}(k.FWidget),Wy=function(e){function t(e){var n;(0,h.Z)(this,t),(n=(0,f.Z)(this,(0,p.Z)(t).call(this)))._zoom=1,n._frozenBottomCol=[],n._frozenRightRow=[],n._sheetGrabbing=!1,n._sheetHeaderMouseDown=!1,n._sheet=null,n._domList={},n._indicatorSheetId="",n._updateSelectionsNextTick=!1,n._formatPainterSourceSheetId="",n._formatPainterRanges=[],n._ChartRanges=[],n._floatBlocksRanges={},n._uploadLoadings={},n.overHeight=0,n._horizontalFixed=!1,n._offsetX=0,n._maxWidth=0,n._initOffsetX=!1,n._rightMargin=0,n._bottomMargin=0,n._paintTime=null,n._layerTime=null,n.subscriber=null,n.spreadSubscriber=null,n.gridLineHiddenSubscription=null,n.cornerSubscription=null,n.stateModelSubscription=null,n._halfScrollEnabled=!0,n.isFeed=!1,n.invisible=!1,n.dropStartCell=null,n._shadowWidget=new k.FWidget(null,"shadowWidget"),n.key="SheetView",n.showRowColResizer=!1,n.rowColResizerRect=new k.FRect,n.rowColResizeTipPos=new k.FPoint(0,0),n.dragDropIsRow=!1,n.showRowColDragDrop=!1,n.dragDropWidgetsAreaPos=new k.FPoint(0,0),n.dragDropWidgetsAreaLinePos=new k.FPoint(0,0),n.dragDropWidgetsAreaTrianglePos=new k.FPoint(0,0),n.colWidths=[0,0,0,0],n.rowHeights=[0,0,0,0],n.visible=!0,n.selectionRenderers=[],n.layerRenderers=[],n.sheetViewRenderers=[],n.gridRenderers=[],n.isAutoRowheightScrollPaused=!1,n.setFilterSelVisible=function(e){n.filterSelVisible$.next(e)},n.markDirtyRect=function(e){n.tables().forEach((function(t){t.getViewRect().intersect(e)&&t.contentDoc().reset()}))},n.worksheet$=new W.X(null),n.selections$=new W.X([]),n.collabCursors$=new W.X([]),n.hoverCell$=new W.X(null),n.editingCell$=new W.X(null),n.zoom$=new W.X(1),n.filterSelVisible$=new W.X(!1),n.getRealBRTableWidth=function(){return n.getLogicFrozenLineWidth()-n.fcorner.width-n._leftColumnHeader.width},n.getRealBRTableHeight=function(){return n.getLogicFrozenLineHeight()-n.fcorner.height-n._topRowHeader.height},n.embedBorderWidgetSizePipFunc=function(e){return n.isRowColHeaderHidden?e*n._zoom:(e-1)*n._zoom},n.embedBorderWidgetDisXPipFunc=function(e){return n.getEmbedBorderWidgetDis(e,!0)},n.embedBorderWidgetDisYPipFunc=function(e){return n.getEmbedBorderWidgetDis(e,!1)},n.getEmbedBorderWidgetSize=function(e,t){var r,i;return n.isRowColHeaderHidden?e:e-((t?(null===(r=n.topRowHeader())||void 0===r?void 0:r.width)||24:(null===(i=n.leftColumnHeader())||void 0===i?void 0:i.height)||24)-1)*n._zoom},n.embedBorderWidgetWidthPipFunc=function(e){return n.getEmbedBorderWidgetSize(e,!0)},n.embedBorderWidgetHeightPipFunc=function(e){return n.getEmbedBorderWidgetSize(e,!0)},n._collectHorizontalSlide=(0,S.default)((function(){Z.Ps3.collectSuiteEvent("sheet_opration",{action:"shortcut_horizontal_slide"})}),1e3),n.handlePosChanged=function(){return!!n._sheet&&(n.$shellWatcher.dispatch("PosChanged",{sheet:n._sheet}),!1)},n.triggerEmbedSheetOffsetLeftChanged=function(){return n._sheet&&n._sheet.trigger(Z.zW2.EmbedSheetOffsetLeftChanged,{x:n.appModel.getSheetViewX(),offsetX:n._offsetX,sheetId:n._sheet.id(),width:n.viewModel.getWidth(),height:n.viewModel.getHeight()}),!1},n.getSheetViewRect=function(){return n._getRect()},n.getRealCellRect=function(e,t,r){var i=n.getCellRect(t,r);if(!i)return null;var o=n.drawTableViewRect(t,r).clone(),a=n.getSheetViewRect();o.y+=a.y,o.x+=a.x;var s=function(e,t){var n,r,i=t.x,o=t.y,a=t.x+t.width,s=t.y+t.height,u=e.x,l=e.y,c=e.y+e.height,h=e.x+e.width;if(i>u)n=i;else{if(!(a>u))return null;n=u}if(o>l)r=o;else{if(!(s>l))return null;r=l}return o>c||i>h?null:{x:n,y:r}}(o,i);return s?i.move(s.x-i.x,s.y-i.y):{x:-1e4,y:-1e4,width:0,height:0}},n.unSelectFormateFloatingObjs=function(){return n.setFormatPainterRanges([]),n.unselectFloatingObjects(!1,!1,!0)},n.getDocRect=function(){var e=n._brTable;return{width:e.docWidth(),height:e.docHeight()}},n.getDocOffset=function(){var e=n._brTable.contentDoc();return{offsetX:e.posX,offsetY:e.posY}},n.getDocMaxPosition=function(){var e=n._brTable.contentDoc();return{maxX:e.maxPosX,maxY:e.maxPosY}},n.getSheetViewOffset=function(){return{x:n.appModel.getSheetViewX(),y:n.appModel.getSheetViewY(),offsetX:n._offsetX}},n.getBRViewPort=function(){var e=n._brTable;return{width:e.width,height:e.height}},n.getScrollSize=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e?n.verticalScrollSize:n.horizontalScrollSize},n.getVisibleRange=function(){var e=n._brTable.getViewRect();return new x.e6w(e.y,e.x,e.height,e.width,n._sheet)},n.getVisibleRanges=function(){return n.tables().reduce((function(e,t){var r=t.getViewRect();return null!=r&&r.height&&r.width?(e.push(new x.e6w(r.y,r.x,r.height,r.width,n._sheet)),e):e}),[])},n.onFloatBlocksSelectionChange=function(e,t){n.setFloatBlocksRanges(e,t),n.updateFloatBlocksSelection()},n.getActiveFloatBlocksRanges=function(){var e=Object.values(n._floatBlocksRanges).find((function(e){return e.active}));return e?e.ranges:[]},n.setActiveFloatBlocksRanges=function(e,t){n._floatBlocksRanges[e]&&(n._floatBlocksRanges[e].active=t,n.updateFloatBlocksSelection())},n.setFloatBlocksRanges=function(e,t){var r=n._floatBlocksRanges[e];r?r.ranges=t:n._floatBlocksRanges[e]={active:!1,ranges:t}},n.clearFloatBlocksRanges=function(e){n._floatBlocksRanges[e]&&(delete n._floatBlocksRanges[e],n._sheet&&n._sheet._dataModel&&n.updateFloatBlocksSelection())},n.updateFloatBlocksSelection=function(){var e=n.getActiveFloatBlocksRanges().filter((function(e){return!!e})).map((function(e){var t;return new x.e6w(e.row,e.col,e.rowCount,e.colCount,null===(t=n.spread())||void 0===t?void 0:t.getSheetFromId(e.sheetId))}));n.tables().forEach((function(t){return t.rebuildFloatBlocksSelection(e)})),n.updateFormulaSelection()},n.onChartSelectionChange=function(e){n.setChartRanges(e),n.updateChartSelection()},n.getVisibleRangeWithFrozen=function(){var e=null;return n.tables().forEach((function(t){e?e.union(t.getViewRect()):e=t.getViewRect()})),new x.e6w(e.y,e.x,e.height,e.width,n._sheet)},n.tableViewRect=function(e,t){var r=n.detectTableByCell(e,t);return n.mapWidgetToGlobal(r.rect,r.parent())},n._onNotifyShell=Ky().on(106,(function(e){var t=e.data;return n.vm.typography.cellWidthHint(t.row,t.col)})).on(91,(function(e){var t=e.data;n.updateConditionFormatRanges(t)})).on(107,(function(e){var t=e.data;n.updateAiHighlightArea(t)})).on([44],(function(){n.updateSelection()})).on(40,(function(){n.setFormatPainterRanges(),n.updateFormatPainter()})).on([5,4,10,17],(function(){n._needPaintCutCopyIndicator=!1,n.updatePasteSelection(),n.forceUpdate()})).on(3,(function(){n._updateSelectionsNextTick||(n._updateSelectionsNextTick=!0,setTimeout((function(){n._needPaintCutCopyIndicator=!1,n.updatePasteSelection(),n.forceUpdate(),n._updateSelectionsNextTick=!1})))})).on(38,(function(e){var t=e.data;n.updateHistoryText(t)})).on(29,(function(){n.updateFormulaSelection()})).on(32,(function(){return n.getContentBounds()})).on(30,(function(e){var t=e.data;return n.getCellRect(t.row,t.col)})).on(31,(function(e){var t=e.data;return n.tableViewRect(t.row,t.col)})).on(35,(function(){return n._nextPage()})).on(36,(function(){return n._prePage()})).on(34,(function(e){var t=e.data;return n._scrollColTo(t.col,t.needMoveToCenter)})).on(33,(function(e){var t=e.data;return n._scrollRowTo(t.row,t.needMoveToCenter)})).on(110,(function(e){var t=e.data;return n._scrollRangeTo(t.typedRange,t.needMoveToCenter)})).on(28,(function(){return n.updateFormulaSelection(),n.unselectFloatingObjects(!1,!0,!0)})).on(97,(function(){return n.getCanvasBoundingClientRect()})).on(1,(function(e){e.data;n.invalidateRowHeight(),n.forceUpdate()})).on([9,12],(function(e){e.data;n.viewModel.notifyListeners()})).on(45,(function(e){var t=e.data;n.scrollTo(t.offsetX,t.offsetY)})).on(46,(function(e){var t=e.data;n.setScrollPos({x:t.posX,y:t.posY})})).on(50,(function(e){var t=e.data;n._moveInCommentCard(t.row,t.col)})).on(51,(function(e){e.data;n._moveOutCommentCard()})).on(87,(function(e){var t=e.data;n._addCfSelectionHighlight(t.ranges)})).on(88,(function(e){e.data;n._removeCfSelectionHighlight()})).on(89,(function(e){var t=e.data;n.addProtectionSelectionHighlight(t.ranges)})).on(90,(function(){n.removeProtectionSelectionHighlight()})).on(103,(function(e){var t=e.data;n._addPivotTableSelectionHighlight(t.ranges,t.type)})).on(104,(function(){n._removePivotTableSelectionHighlight()})).on(108,(function(e){var t=e.data;n._addSparklineSelectionHighlight(t.ranges,t.type)})).on(109,(function(e){var t=e.data;n._removeSparklineSelectionHighlight(null==t?void 0:t.type)})).on(111,(function(e){var t=e.data;n.hideInvisibleSheet(t.showInvisibleLayer)})).on(112,(function(){n.showVisibleSheet()})).on(86,(function(e){var t=e.data;n.addFPSLog(t)})).on(94,(function(e){var t=e.data;n.repaint(t)})).on(95,(function(){n.tables().forEach((function(e){e.floatImage&&e.floatImage.rnds.forEach((function(e){return e.moveEnd()}))}))})).on(98,(function(e){var t=e.data;return n.getNotExpendCellRect(t.row,t.col)})).on(101,(function(){n.forceUpdate()})).on(92,(function(e){var t=e.data;if(n.hideRowColHeaderEnable){var r,i=t.selectionState,o=t.style;if("FOCUS_ON_BLOCK"===i){var a,s=o?o.border:bh;null===(a=n._embedHighLightContentBorderWidget)||void 0===a||a.updateByCfg({border:s,hidden:!1})}else null===(r=n._embedHighLightContentBorderWidget)||void 0===r||r.updateByCfg({hidden:!0})}else{var u,l=t.selectionState,c={NONE:gh,FOCUS_ON_BLOCK:bh,COVER_ON_BLOCK:gh}[l];c&&(null===(u=n._embedBorderWidget)||void 0===u||u.updateByCfg({border:c}))}})).on(102,(function(){n.forceUpdate()})).on(105,(function(){n._uiEvent.emit("CanvasOutsideMouseUp")})).default((function(){n.forceUpdate()})).trigger,n.setSheetOffset=function(e){var t=e.x,r=e.y;"number"==typeof t&&t<=n._offsetX&&t>=0&&n.appModel.setSheetViewX(t),"number"!=typeof r||n.isEmbed||n.appModel.setSheetViewY(r)},n._bindCellPosition=function(e){var t=e.key,r=e.col,i=e.row,o=e.cb,a=n.detectTableByCell(i,r).contentDoc(),s=function(e){return o(n._sheet),!1};n._domList[t]&&n._unbindCellPosition({key:t}),n._domList[t]={handler:s,docs:a},a.addListener(k.FEventType.AfterFlush,s)},n._unbindCellPosition=function(e){var t=e.key,r=n._domList[t];r&&(r.docs.removeListener(k.FEventType.AfterFlush,r.handler),delete n._domList[t])},n.showUploadLoading=function(e,t){var r=t.row,i=t.col,o=t.percentage,a=n.detectTableByCell(r,i),s=new x.e6w(r,i,1,1,n._sheet);n._uploadLoadings[e]?n._uploadLoadings[e].updateByCfg({value:o}):n._uploadLoadings[e]=new oy(a,s,o)},n.hideUploadLoading=function(e){n._uploadLoadings[e]&&(n._uploadLoadings[e].destroy(),delete n._uploadLoadings[e])},n.handleScrollBarMouseUp=function(e){return n._uiEvent.emit("ScrollBarMouseUp",e),!1},n.handleActiveSheetChanged=function(e){e.newSheet===n._sheet&&n.reselectFloatingObjects(),n.setFilterSelVisible(!0)},n.getCanvasBoundingClientRect=function(){return k.Faster.findFaster((0,s.Z)(n)).canvas().element().getBoundingClientRect()},n.getCellRect=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!n._sheet)return new k.FRect;var i=n.detectTableByCell(e,t),o=new x.e6w(e,t,1,1,n._sheet),a=r?Gv(o,n._sheet):o,s=i.range2ViewRect(a);return n.mapWidgetToGlobal(s,i)},n.debounceUpdate=(0,S.default)((function(){n.updateSelection(),n.forceUpdate()})),n.checkIsFrozenAreaOverflow=(0,S.default)((function(){Tf.trigger(vc.SHELL.FROZEN_AREA_OVERFLOW,[vc.SHELL.FROZEN_AREA_OVERFLOW,n.parent(),n.isFrozenAreaOverflow()])}),200),n.sheetHitTest=function(e,t){var r,i=100*n._zoom,o=n.getSheetRowHeaderWidth()*i,a=n.getSheetColHeaderHeight()*i,s=null===(r=n._sheet)||void 0===r?void 0:r.inject(U_).state,u=((null==s?void 0:s.rowGroupWidth)||0)*i,l=((null==s?void 0:s.colGroupHeight)||0)*i,c=n.globalPoint2VisibleCell(new k.FPoint(e,t)),h=c.row,d=c.col,f=100*e,p=100*t;return f<=u&&p<=l?{hitTestType:4}:f<=u?{hitTestType:6,row:h}:p<=l?{hitTestType:5,col:d}:f<=u+o&&p<=l+a?{hitTestType:0}:f<=u+o?{hitTestType:2,row:h}:p<=l+a?{hitTestType:1,col:d}:{hitTestType:3,row:h,col:d}},n.getSheetViewVisHeight=function(){var e=n.sheet(),t=n.isHiddenWidget(n._hscroll)?0:n._hscroll.height,r=n.viewModel.getHeight()-t;if(!e)return r;var i=e.getRowCount(),o=n.getSheetColHeaderHeight(),a=(n.blTable().cell2ViewPos({row:i,col:0}).y+o+n.tlTable().height)*n.zoom;return a<r?a:r},n.getSheetViewVisWidth=function(){var e=n.sheet(),t=n.isHiddenWidget(n._vscroll)?0:n._vscroll.width,r=n.viewModel.getWidth()-t;if(!e)return r;var i=e.getColumnCount(),o=n.getSheetRowHeaderWidth(),a=(n.trTable().cell2ViewPos({row:0,col:i}).x+o+n.tlTable().width)*n.zoom;return a<r?a:r},n.getLogicFrozenLineWidth=function(){var e=n.isHiddenWidget(n._vscroll)?0:n._vscroll.width,t=(n.viewModel.getWidth()-e)/n.zoom,r=n.sheet();if(!r)return t;var i=n.trTable().cell2ViewPos({row:0,col:r.getColumnCount()}).x+n.getLogicCornerRect().width+ +n.tlTable().width;return i<t?i:t},n.getLogicFrozenLineHeight=function(){var e=n.isHiddenWidget(n._hscroll)?0:n._hscroll.height,t=(n.viewModel.getHeight()-e)/n.zoom,r=n.sheet();if(!r)return t;var i=n.blTable().cell2ViewPos({row:r.getRowCount(),col:0}).y+n.getLogicCornerRect().height+n.tlTable().height;return i<t?i:t},n.getScrollPos=function(){var e=n._brTable.contentDoc();return{offsetX:e.posX,offsetY:e.posY}};var r=e.p,i=e.options,o=e.Table,a=e.Header,u=e.worksheet;n._app=r,n._options=i,k.Provider.create(ig,(0,s.Z)(n)),n.viewModel=k.Provider.of(ig,(0,s.Z)(n)),n.appModel=k.Provider.of(Fd,n._app);var l=n.appModel.getShellUIConfig();Z.UIE.defaultZoom=l.defaultZoom;var c=(0,N.isShortCut)()?Df:l.padding.bottom,d=(0,N.isShortCut)()?Df:l.padding.right,v=i.isEmbed,g=i.isFeed||!1;n.isEmbed=v,n.isFeed=g,n.hideRowColHeaderEnable=i.hideRowColHeaderEnable,n.viewModelManager=i.viewModelManager,n.viewManager=i.viewManager,n.$shellWatcher=i.shellWatcher,n._uiEvent=new(F());var _=new x.SWH(u);n._tlMeasurer=new Ov(_),n._trMeasurer=new Ov(_),n._blMeasurer=new Ov(_),n._brMeasurer=new Ov(_),n._container=new Zy(null,(0,s.Z)(n));var y=new I.FGridLayout;n._layout=y,n._layoutManager=new Cg(y),n._container.setLayout(n._layout),n.fcorner=n.getFCorner(u),n._sheetCorner=(0,ye.base2Widget)(n.fcorner),n._sheetCorner.setParent(n._container),n._tlTable=new o(n._container,n._tlMeasurer,0,0,n._uiEvent,(0,s.Z)(n),i),n._trTable=new o(n._container,n._trMeasurer,0,d/n._zoom,n._uiEvent,(0,s.Z)(n),i),n._blTable=new o(n._container,n._blMeasurer,c/n._zoom,0,n._uiEvent,(0,s.Z)(n),i),n._brTable=new o(n._container,n._brMeasurer,c/n._zoom,d/n._zoom,n._uiEvent,(0,s.Z)(n),i),n._layoutManager.registerTableViews({tl:n._tlTable,tr:n._trTable,bl:n._blTable,br:n._brTable}),n._rowColResizer=new k.FWidget(null,"rowColResizer"),n._rowColResizeTip=new I.FText(null,"rolColResizeTip"),n._rowColDragDropWidgets={area:new k.FWidget(null,"rowColDragDropWidgetsArea"),line:new k.FWidget(null,"rowColDragDropWidgetsLine"),triangle:new ey(null,10,"var(--text-link-hover)"),dragStartPoint:new k.FPoint(0,0),dragDrawPoint:new k.FPoint(0,0)},n._toolTip=new I.FLabel(null),n.initScrollbar(),n._addHScrollShortCut(),n.stateModelSubscription=new z.w,n.stateModelSubscription.add(n.viewModel.watch((function(){if((0,k.markStateDirty)((0,s.Z)(n)),n._embedBorderWidget){var e,t=n.getEmbedSheetBorderWidth(i.embedRightPadding)();null!==(e=n._embedBorderWidget)&&void 0!==e&&e.updateByCfg({width:t}),n._updateEmbedSheetBorder()}n.hscrollOverHeight=(n.overHeight?n.overHeight:n.viewModel.getHeight())-n._hscroll.height}))),v?(n._initEmbedWidget(i.embedRightPadding),n._vscroll.removeSelf(),n._rightMargin=0,n._bottomMargin=Z.Ps3.getIsDocx()?5:n._hscroll.height,n._hscroll.updateByCfg({snapSide:I.ScrollSnapSide.OutSide}),n.appModel.setSheetViewX(n._offsetX),n._sheetHScrollEventHandler()):Kf.injectableStaticConfig.scrollerTrack.enable&&(n._hscrollerTrack=new k.FWidget(null,"hscrollerTrack"),n._vscrollerTrack=new k.FWidget(null,"vscrollerTrack"),n._hscrollerTrackHeader=new k.FWidget(null,"hscrollerTrackHeader"),n._vscrollerTrackHeader=new k.FWidget(null,"vscrollerTrackHeader"),n._scrollerTrackTail=new k.FWidget(null,"scrollerTrackTail")),n._leftColumnHeader=new a(n._container,!0,new Iv(_),0,(0,s.Z)(n),i),n._rightColumnHeader=new a(n._container,!0,new Iv(_),d,(0,s.Z)(n),i),n._topRowHeader=new a(n._container,!1,new kv(_,(0,s.Z)(n)),0,(0,s.Z)(n),i),n._bottomRowHeader=new a(n._container,!1,new kv(_,(0,s.Z)(n)),c,(0,s.Z)(n),i),n._layoutManager.registerGridShell(1,{corner:n._sheetCorner,rowAreas:[n._topRowHeader,n._bottomRowHeader],colAreas:[n._leftColumnHeader,n._rightColumnHeader]}),n._leftColumnHeaderLine=new k.FWidget(n._leftColumnHeader,"leftColumnHeaderLine"),n._rightColumnHeaderLine=new k.FWidget(n._rightColumnHeader,"rightColumnHeaderLine"),n._topRowHeaderLine=new k.FWidget(n._topRowHeader,"topRowHeaderLine"),n._bottomRowHeaderLine=new k.FWidget(n._bottomRowHeader,"bottomRowHeaderLine"),k.Bind.propBind(n._leftColumnHeaderLine,"y",n._sheetCorner,"height",(function(e){return e-1})),k.Bind.propBind(n._rightColumnHeaderLine,"y",n._sheetCorner,"height",(function(e){return e-1})),k.Bind.propBind(n._topRowHeaderLine,"x",n._sheetCorner,"width",(function(e){return e-1})),k.Bind.propBind(n._bottomRowHeaderLine,"x",n._sheetCorner,"width",(function(e){return e-1})),n._fpsReporter=new tg(u,n.getVisibleRange.bind((0,s.Z)(n))),n.initFeatureRenderers(),n._initUIStates(),n._initBindings(),n._initLayerRenderEvents(),n._initFrozenLine(),n._initHeaderWidgetLine(),n.hideRowColHeaderEnable&&n.hideRowColHeader(!0),null!==u&&n.updateSheet(u),n.ensureViewportRowHeight(),n._initFlushEvents(),n._initTickEvents();var m=(0,N.parseQuery)(window.location.search),E=m.rangeId,b=m.rangeToken;return n.setFilterSelVisible(!E&&!b),n}var n;return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"initFeatureRenderers",value:function(){this.registerRendererFactories([cg,vg,T_,R_,M_]),(0,x.yFL)()||this.registerRendererFactories([Q_,J_])}},{key:"registerRendererFactories",value:function(e){var t=this,n=this.cachedSheetViewProxyObj||(this.cachedSheetViewProxyObj={worksheet$:this.worksheet$,selections$:this.selections$,collabCursors$:this.collabCursors$,hoverCell$:this.hoverCell$,editingCell$:this.editingCell$,shellWatcher:this.shellWatcher,zoom$:this.zoom$,filterSelVisible$:this.filterSelVisible$,layoutManager:this._layoutManager,container:this._container,dispatch:this.$shellWatcher.dispatch.bind(this.$shellWatcher),trTable:this._trTable,tlTable:this._tlTable,brTable:this._brTable,blTable:this._blTable,refresh:this.refresh.bind(this),toggleHeaderDarkTheme:this.toggleHeaderDarkTheme.bind(this),getViewModel:this.getViewModel.bind(this),forceLayout:this.forceLayout.bind(this),forceUpdate:this.forceUpdate.bind(this),sheet:this.sheet.bind(this),initColFrozenUI:this._initColFrozenUI.bind(this),initRowFrozenUI:this._initRowFrozenUI.bind(this),initFrozenEvent:this._initFrozenEvent.bind(this),getCellRect:this.getCellRect,getNotExpendCellRect:this.getNotExpendCellRect.bind(this),mapFromGlobal:this.mapFromGlobal.bind(this),rebuild:this.rebuild.bind(this)});e.forEach((function(e){return t.registerFeatureRenderer(e(n))}))}},{key:"refresh",value:function(){this.forceUpdate(),this._rebuild(),this.viewModel.notifyListeners()}},{key:"registerFeatureRenderer",value:function(e){var t=this;switch(e.type){case 0:this.tables().forEach((function(t){return t.registerRenderer(e)})),this.selectionRenderers.push(e);break;case 1:this.tables().forEach((function(n){n.registerRenderer(e),e.bindRendererHost({refresh:function(e){return e?t.markDirtyRect(e):t.forceUpdate()}})})),this.layerRenderers.push(e);break;case 2:e.bindRendererHost(this.cachedSheetViewProxyObj),this.sheetViewRenderers.push(e);break;case 3:e.bindRendererHost(this.cachedSheetViewProxyObj),e.initBindings(),this.gridRenderers.push(e);break;case 4:break;default:throw new Error("[RendererRegistry]: unknown type of renderer ".concat(e.type,"."))}}},{key:"toggleHeaderDarkTheme",value:function(e){e?this.updateHeader("var(--N00-FG)","var(--N700-BG)",nd,td,Cd.inView):this.updateHeader(hh,this.appModel.getShellUIConfig().header.bgColor,Qh,ed,Cd.normal)}},{key:"initScrollbar",value:function(){var e=this;this._hscroll=new I.FHScrollbar(null),this._vscroll=new I.FVScrollbar(null),this.stateModelSubscription||(this.stateModelSubscription=new z.w),this.stateModelSubscription.add(this.appModel.watch((function(){e._hscroll.updateByCfg({value:e._offsetX-e.appModel.getSheetViewX()+e._brTable.contentDoc().posX}),e.triggerEmbedSheetOffsetLeftChanged()})))}},{key:"getMinSheetViewX",value:function(){return Math.max(0,-this._brTable.contentDoc().maxPosX)}},{key:"describe",value:function(){var e=this,t=this.showRowColResizer,n=this.rowColResizerRect,r=this.rowColResizeTipPos,i=this.dragDropIsRow,o=this.showRowColDragDrop,s=this.dragDropWidgetsAreaPos,u=this.dragDropWidgetsAreaLinePos,l=this.dragDropWidgetsAreaTrianglePos,c=this.colWidths,h=this.rowHeights;if(!this.visible)return null;var d=this.appModel.getSheetViewX(),f=this.appModel.getSheetViewY(),p=this.viewModel.getWidth(),v=this.viewModel.getHeight(),g=null;return this.isEmbed&&(g=this.hideRowColHeaderEnable?nm.with({key:"EmbedBorder",embedBorderWidget:this._embedBorderWidget,embedCommentBorderWidget:this._embedCommentBorderWidget,embedHighLightContentBorderWidget:this._embedHighLightContentBorderWidget,embedHighLightContentWidget:this._embedHighLightContentWidget,hideRowColHeaderEnable:this.hideRowColHeaderEnable}):nm.with({key:"EmbedBorder",embedBorderWidget:this._embedBorderWidget,embedCommentBorderWidget:this._embedCommentBorderWidget})),k.SizedBox.with({width:p,height:v,key:"SizedBox"}).fill((function(){return k.Stack.with({key:"SheetContentStack"}).fill((function(){return[qy.with({container:e._container,key:"container"}),g].concat((0,a.Z)(e.sheetViewRenderers.map((function(e){var t;return(null===(t=e.render)||void 0===t?void 0:t.call(e))||null}))),[Qy.with({key:"ToolTipWrapper",toolTip:e._toolTip}),$y.with({key:"RowColResizerWidget",showRowColResizer:t,rowColResizerRect:n,rowColResizeTipPos:r,rowColResizer:e._rowColResizer,rowColResizeTip:e._rowColResizeTip}),Jy.with({key:"RowColDragDropWidget",sheetViewX:d,sheetViewY:f,dragDropIsRow:i,showRowColDragDrop:o,dragDropWidgetsAreaPos:s,dragDropWidgetsAreaLinePos:u,dragDropWidgetsAreaTrianglePos:l,rowColDragDropWidgetsArea:e._rowColDragDropWidgets.area,rowColDragDropWidgetsLine:e._rowColDragDropWidgets.line,rowColDragDropWidgetsTriangle:e._rowColDragDropWidgets.triangle}),Kf.injectableStaticConfig.scrollerTrack.enable?em.with({key:"ScrollWidget",hscrollerTrackHeader:e._hscrollerTrackHeader,hscrollerTrack:e._hscrollerTrack,vscrollerTrackHeader:e._vscrollerTrackHeader,vscrollerTrack:e._vscrollerTrack,scrollerTrackTail:e._scrollerTrackTail,vscroll:e._vscroll,hscroll:e._hscroll,sheetView:e,isEmbed:e.isEmbed,colWidths:c,rowHeights:h,zoom:e._zoom,offsetX:e._offsetX,width:p,height:v,sheetViewX:d,hscrollOverHeight:e.hscrollOverHeight}):null])}))}))}},{key:"resize",value:function(e,t){var n=this.zoom,r=e/n,i=t/n;this._container.updateByCfg({width:r,height:i}),this.viewModel.getWidth()!==e&&(this.isEmbed||this._hscroll.updateByCfg({width:this._getHScrollWidth(e)})),this.viewModel.setWidth(e),this.viewModel.getHeight()!==t&&this._vscroll.updateByCfg({height:this._getVScrollHeight(t)}),this.viewModel.setHeight(t),this.forceLayout(),this.shellWatcher.dispatch("Resize")}},{key:"scroll",value:function(e){var t=e.x,n=e.y,r=this.brTable().contentDoc();void 0!==n&&r.updateByCfg({posY:n}),void 0!==t&&(this.isEmbed&&this.appModel.getSheetViewX()>0&&this.canHScroll(this.appModel.getSheetViewX()-t)?this.appModel.setSheetViewX(t):r.updateByCfg({posX:t}))}},{key:"dblClick",value:function(e){return!!this._sheet&&(this.shellWatcher.dispatch("CellDoubleClicked",{sheet:this._sheet}),!0)}},{key:"clearFloatImageSelection",value:function(){this.tables().forEach((function(e){return e.clearFloatImageSelection()})),this._sheet.floatImageModel.setActiveId([])}},{key:"getFCorner",value:function(e){return new rg(e,this.$shellWatcher,this,this.isEmbed)}},{key:"_initEmbedWidget",value:function(e){var t=this;this._embedBorderWidget=new k.FWidget(null,"embedBorderWidget"),this._embedCommentBorderWidget=new k.FWidget(null,"embedCommentBorderWidget"),k.Bind.propBind(this._embedCommentBorderWidget,"width",this._embedBorderWidget,"width",(function(e){var n;return t.hideRowColHeaderEnable?t.isRowColHeaderHidden?e:e-((null===(n=t.topRowHeader())||void 0===n?void 0:n.width)||24)+1:e})),k.Bind.propBind(this._embedCommentBorderWidget,"height",this._embedBorderWidget,"height",(function(e){var n;return t.hideRowColHeaderEnable?t.isRowColHeaderHidden?e:e-((null===(n=t.leftColumnHeader())||void 0===n?void 0:n.height)||24)+1:e})),this.hideRowColHeaderEnable&&(this._embedHighLightContentWidget=new k.FWidget(null,"embedHighLightContentWidget"),this._embedHighLightContentBorderWidget=new k.FWidget(null,"embedHighLightContentBorderWidget"),Gy([this._embedHighLightContentWidget,this._embedHighLightContentBorderWidget],"width",this._embedBorderWidget,"width",this.embedBorderWidgetWidthPipFunc),Gy([this._embedHighLightContentWidget,this._embedHighLightContentBorderWidget],"height",this._embedBorderWidget,"height",this.embedBorderWidgetHeightPipFunc))}},{key:"_initUIStates",value:function(){var e=this,t=this.appModel.getShellUIConfig();this.updateState({dropable:!0}),this.isEmbed||this.updateHeader(hh,t.header.bgColor,Qh,ed,Cd.normal),this.tables().forEach((function(e){return e.updateByCfg({zindex:100})})),this._container.updateByCfg({zindex:100}),this.isEmbed?(this._hscroll.updateByCfg({autoHide:!1,color:qh,zindex:Ff}),this._vscroll.updateByCfg({color:qh,zindex:Ff})):(this._hscroll.updateByCfg({thick:8,thin:Kf.injectableStaticConfig.scroller.thin,gap:Kf.injectableStaticConfig.scroller.gap,height:Df,onlyNecessary:!0,autoHide:Kf.injectableStaticConfig.scroller.autoHide,color:qh,zindex:Ff,hoverColor:$h}),this._vscroll.updateByCfg({thick:8,thin:Kf.injectableStaticConfig.scroller.thin,gap:Kf.injectableStaticConfig.scroller.gap,width:Df,onlyNecessary:!0,autoHide:Kf.injectableStaticConfig.scroller.autoHide,color:qh,zindex:Ff,hoverColor:$h})),this._scrollerTrackTail&&this._scrollerTrackTail.updateByCfg({background:Jh,height:Df,width:Df,zindex:999}),this._hscrollerTrackHeader&&this._vscrollerTrackHeader&&(this._hscrollerTrackHeader.updateByCfg({borderTop:gh,borderBottom:gh,borderRight:gh,background:Jh,zindex:999,height:Df}),this._vscrollerTrackHeader.updateByCfg({borderLeft:gh,borderBottom:gh,background:Jh,zindex:999,width:Df})),this._hscrollerTrack&&this._vscrollerTrack&&(this._hscrollerTrack.updateByCfg({borderTop:gh,borderBottom:gh,borderRight:gh,background:Jh,zindex:999,height:Df}),this._vscrollerTrack.updateByCfg({borderBottom:gh,borderLeft:gh,background:Jh,zindex:999,width:Df})),this._rowColResizer.updateByCfg({ignore:!0,hidden:!0}),this._rowColResizeTip.updateByCfg({ignore:!0,hidden:!0}),this._rowColDragDropWidgets.area.updateByCfg({ignore:!0,hidden:!0}),this._rowColDragDropWidgets.line.updateByCfg({ignore:!0,hidden:!0}),this._rowColDragDropWidgets.triangle.updateByCfg({ignore:!0,hidden:!0}),this._toolTip.updateByCfg(Object.assign({hidden:!0},Md,{zindex:Ff})),k.Bind.propBind(this._toolTip,"transform",this._toolTip,"width",(function(t){var n=e._toolTip,r=n.transform;return r.e=e.calcTooltipTranslateX(t,n.x),r})),k.Bind.propBind(this._toolTip,"transform",this._toolTip,"x",(function(t){var n=e._toolTip,r=n.transform;return r.e=e.calcTooltipTranslateX(n.width,t),r})),this._embedBorderWidget&&this._embedBorderWidget.updateByCfg({zindex:Ff,border:gh,ignore:!0}),this._embedCommentBorderWidget&&this._embedCommentBorderWidget.updateByCfg({zindex:Ff,ignore:!0}),this._embedHighLightContentWidget&&this._embedHighLightContentWidget.updateByCfg({hidden:!0,zindex:Ff}),this._embedHighLightContentBorderWidget&&this._embedHighLightContentBorderWidget.updateByCfg({hidden:!0,zindex:Ff}),this._layoutManager.reLayout()}},{key:"calcTooltipTranslateX",value:function(e,t){return e+t>this.viewModel.getWidth()?-e:0}},{key:"_initFrozenLine",value:function(){this._initColFrozenUI(this._leftColumnHeader,k.FWidget);var e=this._initColFrozenUI(this._rightColumnHeader,vy);this._initRowFrozenUI(this._topRowHeader,k.FWidget);var t=this._initRowFrozenUI(this._bottomRowHeader,vy);this._initColFrozenUI(this._tlTable,k.FWidget);var n=this._initColFrozenUI(this._trTable,vy),r=this._initColFrozenUI(this._blTable,k.FWidget,this.getRealBRTableHeight),i=this._initColFrozenUI(this._brTable,vy,this.getRealBRTableHeight);this._initRowFrozenUI(this._tlTable,k.FWidget);var o=this._initRowFrozenUI(this._blTable,vy),a=this._initRowFrozenUI(this._trTable,k.FWidget,this.getRealBRTableWidth),s=this._initRowFrozenUI(this._brTable,vy,this.getRealBRTableWidth);this._frozenBottomCol.push(r),k.Bind.propBind(r,"height",this._blTable.contentDoc().doc,"y",this.getRealBRTableHeight),this._frozenBottomCol.push(i),k.Bind.propBind(i,"height",this._blTable.contentDoc().doc,"y",this.getRealBRTableHeight),this._frozenRightRow.push(a),k.Bind.propBind(a,"width",this._trTable.contentDoc().doc,"x",this.getRealBRTableWidth),this._frozenRightRow.push(s),k.Bind.propBind(s,"width",this._trTable.contentDoc().doc,"x",this.getRealBRTableWidth),this._initFrozenEvent([e,n,i],[t,o,s]),k.Bind.propBind(this._leftColumnHeaderLine,"width",o,"width"),k.Bind.propBind(this._rightColumnHeaderLine,"width",a,"width"),k.Bind.propBind(this._topRowHeaderLine,"height",n,"height"),k.Bind.propBind(this._bottomRowHeaderLine,"height",r,"height")}},{key:"_initColFrozenUI",value:function(e,t,n){var r=new t(e,3);return k.Bind.propBind(r,"hidden",this._tlTable,"width",(function(e){return!e})),k.Bind.propBind(r,"height",e,"height",n),t===k.FWidget&&k.Bind.propBind(r,"x",e,"width",(function(e){return e-Sh/2})),r.updateByCfg({width:Sh/2,zindex:100,background:Ch}),r}},{key:"_initRowFrozenUI",value:function(e,t,n){var r=new t(e,2);return k.Bind.propBind(r,"hidden",this._tlTable,"height",(function(e){return!e})),k.Bind.propBind(r,"width",e,"width",n),t===k.FWidget&&k.Bind.propBind(r,"y",e,"height",(function(e){return e-Sh/2})),r.updateByCfg({height:Sh/2,zindex:100,background:Ch}),r}},{key:"_initFrozenEvent",value:function(e,t){var n=this;this._brTable.contentDoc().addListener(k.FEventType.AfterFlush,(function(r){var i=r.changes,o=e.filter((function(e){return!e.hidden})),a=t.filter((function(e){return!e.hidden}));return void 0!==i.posX&&o.length&&(k.FApp.registerIdleCallback((function(){n._renderFPS.addLog(Z.EEh.HIDE_FREEZE_SHADOW),o.forEach((function(e){return e.updateByCfg({shadow:void 0})}))}),!0),o.forEach((function(e){return e.updateByCfg({shadow:wh})}))),void 0!==i.posY&&a.length&&(k.FApp.registerIdleCallback((function(){n._renderFPS.addLog(Z.EEh.HIDE_FREEZE_SHADOW),a.forEach((function(e){return e.updateByCfg({shadow:void 0})}))}),!0),a.forEach((function(e){return e.updateByCfg({shadow:wh})}))),!1}))}},{key:"_initHeaderWidgetLine",value:function(){var e=this.isEmbed?gh:_h;this._leftColumnHeaderLine.updateByCfg({y:this._sheetCorner.height-1,height:1,background:e.color}),this._rightColumnHeaderLine.updateByCfg({y:this._sheetCorner.height-1,height:1,background:e.color}),this._topRowHeaderLine.updateByCfg({x:this._sheetCorner.width-1,width:1,background:e.color}),this._bottomRowHeaderLine.updateByCfg({x:this._sheetCorner.width-1,width:1,background:e.color})}},{key:"hideInvisibleSheet",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.invisible=!0,this.tables().forEach((function(t){t.disableLayers(Uf),e&&t.enableLayers(["invisible_layer"]),t.clearFloatImageSelection(),t.gridBorderLayer.disabled();var n=t.floatImage;n&&(n.layer.reset(),n.layer.disabled())})),this.hideRowColHeader(!0),this.forceUpdate(),this.rebuild()}},{key:"showVisibleSheet",value:function(){if(this.invisible=!1,this._sheet){var e=this._sheet.inject(x._JP).getGridLine();this.tables().forEach((function(t){var n;t.enableLayers(Uf),t.disableLayers(["invisible_layer"]),null!==(n=t.floatImage)&&void 0!==n&&n.layer.enabled(),t.changeGridLine(e)})),this.hideRowColHeaderEnable||this.hideRowColHeader(!1);var t=this._sheet.id(),n=Z.UIE.getItem(t);this.zoomContent(n)}this.forceUpdate(),this.rebuild()}},{key:"_dependsBind",value:function(e,t,n){return k.Bind.propBind(this._shadowWidget,"_",e,t,n)}},{key:"_initBindings",value:function(){var e=this;this.gridRenderers.forEach((function(e){return e.initBindings()})),k.Bind.propBind(this._vscroll,"page",this._brTable.contentDoc(),"height",(function(e){return Math.max(e,0)})),k.Bind.propBind(this._vscroll,"value",this._brTable.contentDoc(),"posY"),k.Bind.propBind(this._brTable.contentDoc(),"posX",this._trTable.contentDoc(),"posX"),k.Bind.propBind(this._trTable.contentDoc(),"posX",this._brTable.contentDoc(),"posX"),k.Bind.propBind(this._brTable.contentDoc(),"posY",this._vscroll,"value"),k.Bind.propBind(this._brTable.contentDoc(),"posY",this._blTable.contentDoc(),"posY"),k.Bind.propBind(this._blTable.contentDoc(),"posY",this._brTable.contentDoc(),"posY"),this.isEmbed?(k.Bind.propBind(this._hscroll,"page",this._brTable.contentDoc(),"width",(function(t){return Math.max(t+e._offsetX,0)})),k.Bind.propBind(this._hscroll,"max",this._brTable.contentDoc().doc,"width",(function(t){return t+2*e._offsetX})),k.Bind.propBind(this._hscroll,"value",this._brTable.contentDoc(),"posX",(function(t){return t+e._offsetX})),k.Bind.propBind(this._brTable.contentDoc(),"posX",this._hscroll,"value",(function(t){if(e._horizontalFixed){if(!(t-e._offsetX<0))return t-e._offsetX;e._horizontalFixed=!1}return 0})),this._dependsBind(this._hscroll,"value",(function(t){var n=e.getMiniXOffset();if(!e._horizontalFixed){if(!(e._offsetX-t<e.getMiniXOffset())){var r=e._offsetX-t;return e.appModel.setSheetViewX(r),r}e._horizontalFixed=!0}return e.appModel.setSheetViewX(n),n})),k.Bind.propBind(this._hscroll,"width",this._brTable,"width",(function(t){return(t+e._tlTable.width)*e._zoom-e._offsetX})),k.Bind.propBind(this._hscroll,"thick",this._hscroll,"hover",(function(e){return e?8:4})),this.hideRowColHeaderEnable&&this._embedCommentBorderWidget&&this._embedHighLightContentWidget&&this._embedHighLightContentBorderWidget&&(Gy([this._embedHighLightContentWidget,this._embedHighLightContentBorderWidget,this._embedCommentBorderWidget],"x",this._topRowHeader,"width",this.embedBorderWidgetSizePipFunc),Gy([this._embedHighLightContentWidget,this._embedHighLightContentBorderWidget,this._embedCommentBorderWidget],"x",this._topRowHeader,"hidden",this.embedBorderWidgetDisXPipFunc),Gy([this._embedHighLightContentWidget,this._embedHighLightContentBorderWidget,this._embedCommentBorderWidget],"y",this._leftColumnHeader,"height",this.embedBorderWidgetSizePipFunc),Gy([this._embedHighLightContentWidget,this._embedHighLightContentBorderWidget,this._embedCommentBorderWidget],"y",this._leftColumnHeader,"hidden",this.embedBorderWidgetDisYPipFunc))):(k.Bind.propBind(this._hscroll,"page",this._brTable.contentDoc(),"width",(function(e){return Math.max(e,0)})),k.Bind.propBind(this._hscroll,"value",this._brTable.contentDoc(),"posX"),this._initScrollerBind(),k.Bind.propBind(this._brTable.contentDoc(),"posX",this._hscroll,"value"),k.Bind.propBind(this.tlTable().contentDoc(),"posX",this.blTable().contentDoc(),"posX"),k.Bind.propBind(this.tlTable().contentDoc(),"posY",this.trTable().contentDoc(),"posY"),k.Bind.propBind(this.blTable().contentDoc(),"posX",this.tlTable().contentDoc(),"posX"),k.Bind.propBind(this.trTable().contentDoc(),"posY",this.tlTable().contentDoc(),"posY")),jy(this._leftColumnHeader,"posX",this._blTable.contentDoc(),"posX"),jy(this._topRowHeader,"posY",this._trTable.contentDoc(),"posY"),jy(this._rightColumnHeader,"posX",this._brTable.contentDoc(),"posX"),jy(this._bottomRowHeader,"posY",this._brTable.contentDoc(),"posY")}},{key:"getEmbedBorderWidgetDis",value:function(e,t){var n,r,i;return i=t?(null===(n=this._embedBorderWidget)||void 0===n?void 0:n.x)||24*this._zoom:(null===(r=this._embedBorderWidget)||void 0===r?void 0:r.y)||24*this._zoom,e||(i-=this._zoom),i}},{key:"getMiniXOffset",value:function(){return 0}},{key:"_getRect",value:function(){var e=this.viewModel.getWidth(),t=this.viewModel.getHeight(),n=this.appModel.getSheetViewX(),r=this.appModel.getSheetViewY();return new k.FRect(n,r,e,t)}},{key:"_updateEmbedSheetBorder",value:function(){if(this._embedBorderWidget){var e=this._getRect();if(!this.hideRowColHeaderEnable)return void this._embedBorderWidget.updateByCfg({height:Math.floor(e.height-this._bottomMargin*this._zoom)});var t=Math.floor(e.height-this._bottomMargin*this._zoom),n=0,r=0;if(this.isRowColHeaderHidden){var i=this.topRowHeader().width,o=this.leftColumnHeader().height;t-=o*this._zoom,n=i*this._zoom,r=o*this._zoom}this._embedBorderWidget.updateByCfg({height:t,x:n,y:r})}}},{key:"getEmbedSheetBorderWidth",value:function(e){throw new Error("getEmbedSheetBorderWidth is error")}},{key:"canHScroll",value:function(e){var t=this._brTable.docWidth(),n=this._blTable.docWidth()+t+this._bottomRowHeader.width;if(this.viewModel.getWidth()-this._offsetX<n)if(e>0){if(n+this.appModel.getSheetViewX()>this._maxWidth)return!0}else if(e<0)return!0;return!1}},{key:"_shouldCancelHorizontalSwipe",value:function(e,t){return 1.3*e>t}},{key:"_addHScrollShortCut",value:function(){var e=this;this.addEventFilter((function(t){return t.type===k.FEventType.MouseWheel&&t.shiftKey&&t.deltaY&&(t.deltaX=t.deltaY,t.deltaY=0,e._collectHorizontalSlide()),!1}))}},{key:"_sheetHScrollEventHandler",value:function(){var e=this;this._app.addEventFilter((function(t){return t.shiftKey&&t.deltaY&&(t.deltaX=t.deltaY,t.deltaY=0),e._shouldCancelHorizontalSwipe(Math.abs(t.deltaX),Math.abs(t.deltaY))?(t.srcEventPreventDefault(),!1):(window.__GESTURE_BACK_TIMESTAMP__=Date.now(),t.deltaX=0,!1)})),this._app.addEventFilter((function(t){return t.type===k.FEventType.MouseWheel&&e.handleMouseWheelScroll(t.deltaX)}))}},{key:"handleMouseWheelScroll",value:function(e){if(!this.canHScroll(e))return!1;var t=this.appModel.getSheetViewX(),n=this._brTable.contentDoc().posX;if(t>0||this._horizontalFixed&&0===n&&e<0){this._horizontalFixed=!1;var r=Math.min(this._offsetX,Math.max(0,t-e));return this.appModel.setSheetViewX(r),this._updateEmbedSheetBorder(),!0}return this._horizontalFixed=!0,!1}},{key:"setHalfScrollEnabled",value:function(e){this._halfScrollEnabled=e}},{key:"getHalfScrollEnabled",value:function(){return this.isEmbed&&this._halfScrollEnabled}},{key:"_removeBindings",value:function(){var e;this._hscroll&&k.Bind.unBindAll(this._hscroll),this._vscroll&&k.Bind.unBindAll(this._vscroll),null===(e=this._app)||void 0===e||e.unbindCellPosition({key:"sheetView"})}},{key:"_initScrollerBind",value:function(){var e=this;this._hscroll.updateByCfg({y:5}),this._vscroll.updateByCfg({x:5}),this._vscrollerTrack&&this._hscrollerTrack&&this._vscrollerTrackHeader&&this._hscrollerTrackHeader&&(k.Bind.propBind(this._vscrollerTrackHeader,"height",this._rightColumnHeader,"height",(function(t){return t*e._zoom})),k.Bind.propBind(this._hscrollerTrackHeader,"width",this._bottomRowHeader,"width",(function(t){return t*e._zoom})),k.Bind.propBind(this._vscrollerTrack,"height",this._vscroll,"height",(function(e){return e+1})),k.Bind.propBind(this._vscrollerTrack,"y",this._vscroll,"y"),k.Bind.propBind(this._hscrollerTrack,"width",this._hscroll,"width",(function(e){return e+1})))}},{key:"_getHScrollHeight",value:function(e){return e-this._hscroll.height+Kf.injectableStaticConfig.scroller.gap/2+1}},{key:"_getHScrollWidth",value:function(e){var t=this.getSheetRowHeaderWidth()*this._zoom;return e-Df-t}},{key:"_getVScrollWidth",value:function(e){return this._minusScrollerSize(e)+4+1}},{key:"_getVScrollHeight",value:function(e){var t=this.getSheetColHeaderHeight()*this._zoom;return e-Df-t}},{key:"_minusScrollerSize",value:function(e){return e-Df}},{key:"_initTickEvents",value:function(){var e=this;this._paintTime=new Qv((function(e){Z.PxA.collectSheetEvent("faster_performance_paint_time",e)}),Kv,qv,$v);var t=k.Faster.findFaster(this._app);t&&t.addListener(k.FEventType.BeforeTick,(function(){var n=performance.now();return t.addOnceListener(k.FEventType.AfterTick,(function(){var t=performance.now()-n;return e._paintTime&&e._paintTime.add(t),!1})),!1}))}},{key:"_initLayerRenderEvents",value:function(){var e=this;this._layerTime=new Jv((function(e){Z.PxA.collectSheetEvent("faster_performance_layer_time",e)}),Kv,$v);var t=function(t){var n=t.name;return e._layerTime&&e._layerTime.start(n),!1},n=function(t){var n=t.name;return e._layerTime&&e._layerTime.end(n),!1};[this._tlTable.contentDoc().doc,this._trTable.contentDoc().doc,this._blTable.contentDoc().doc,this._brTable.contentDoc().doc].forEach((function(e){e.addListener(k.FEventType.BeforeLayerRender,t),e.addListener(k.FEventType.AfterLayerRender,n)}))}},{key:"_initFlushEvents",value:function(){var e,t=this,n=k.Faster.findFaster(this._app);this._renderFPS=new me.FPS(n,this._fpsReporter.reportFps),this._brTable.contentDoc().addListener(k.FEventType.BeforeFlush,(function(e){var n=t._sheet,r=e.changes;return void 0!==r.posX&&n&&t.$shellWatcher.dispatch("LeftPosChanged",{posX:r.posX}),void 0!==r.posY&&n&&t.$shellWatcher.dispatch("TopPosChanged",{posY:r.posY}),void 0===r.posX&&void 0===r.posY||(n&&t.$shellWatcher.dispatch("LeftTopPosChanged",{posX:r.posX,posY:r.posY,sheetId:n.id()}),t._renderFPS.addLog(Z.EEh.SCROLL)),!1})),this._tlTable.contentDoc().addListener(k.FEventType.BeforeFlush,(function(e){var n=e.changes;return void 0===n.posX&&void 0===n.posY||t._renderFPS.addLog(Z.EEh.SCROLL),!1})),null===(e=this._app)||void 0===e||e.bindCellPosition({key:"sheetView",cb:this.handlePosChanged})}},{key:"_updateLayout",value:function(e,t){if(this._sheet){var n=this.getSheetRowHeaderWidth(),r=this.getSheetColHeaderHeight(),i=this.viewModel.getHeight()/this._zoom-this._bottomMargin,o=this.viewModel.getWidth()/this._zoom-this._rightMargin;t=Math.min(i-r,t),e=Math.min(o-n,e);var s=this.gridRenderers.map((function(e){return e.updateLayout()})),u=new Array(s.length).fill(0),l=this.invisible?u:s.map((function(e){return e.height})),c=this.invisible?u:s.map((function(e){return e.width}));if(this._layout.changeContainerParams({rows:[].concat((0,a.Z)(l),[r,t,(0,I.Fraction)(1),this._bottomMargin]),columns:[].concat((0,a.Z)(c),[n,e,(0,I.Fraction)(1),this._rightMargin])}),this.rowHeights=[r,t,(0,I.Fraction)(1).value,this._bottomMargin],this.colWidths=[n,e,(0,I.Fraction)(1).value,this._rightMargin],this._embedBorderWidget){var h,d=this.getEmbedSheetBorderWidth(this._options.embedRightPadding)();null!==(h=this._embedBorderWidget)&&void 0!==h&&h.updateByCfg({width:d}),this._updateEmbedSheetBorder()}}}},{key:"_handleFrozenChange",value:function(e){var t=e.propertyName,n=this._brTable.contentDoc();"frozenRowCount"===t?(n.updateByCfg({posY:0}),this._topRowHeader.updateByCfg({posY:0})):(this._leftColumnHeader.updateByCfg({posX:0}),n.updateByCfg({posX:0}))}},{key:"getSheetRowHeaderWidth",value:function(){var e=this._sheet;if(!e)return 0;var t=e.getRowCount();if(t===e.lastCalcRowCount)return e.lastRowHeaderWidth;var n=new I.FontMeasurer((0,Z.BNt)(),I.FontWeight.normal,12),r=Math.round(n.measureWord(String(t))+8),i=Math.max(e._getSheetRowHeaderWidth(),r);return e.lastCalcRowCount=t,e.lastRowHeaderWidth=i,i}},{key:"getSheetColHeaderHeight",value:function(){var e=this._sheet;return e?e._getSheetColHeaderHeight():0}},{key:"setOffsetX",value:function(e){if("number"==typeof e&&this._offsetX!==e)if(!1===this._initOffsetX)this.appModel.setSheetViewX(e),this._initOffsetX=!0,this._offsetX=e;else{var t=this._offsetX-e;if(this._offsetX=e,t>0){var n=t-this.appModel.getSheetViewX();n>0?(this.appModel.setSheetViewX(0),this.scrollTo(n,0)):this.appModel.setSheetViewX(-n)}else{var r=this._brTable.contentDoc(),i=r.posX+t;if(i>0)this.scrollTo(t,0);else{var o=Math.min(e,this.appModel.getSheetViewX()-i);this.scrollTo(-r.posX,0),this.appModel.setSheetViewX(o)}}}}},{key:"setMaxWidth",value:function(e){"number"==typeof e&&this._maxWidth!==e&&(this._maxWidth=e)}},{key:"highlightContentView",value:function(e,t){var n;null===(n=this._embedHighLightContentWidget)||void 0===n||n.updateByCfg(Object.assign({},t,{hidden:!e}))}},{key:"setSelect",value:function(e,t){var n;if(this._embedBorderWidget)if(e)if(this.hideRowColHeaderEnable){var r,i=t?t.border:bh;null===(r=this._embedHighLightContentBorderWidget)||void 0===r||r.updateByCfg({border:i,hidden:!1})}else this._embedBorderWidget.updateByCfg({border:bh});else this.hideRowColHeaderEnable?null===(n=this._embedHighLightContentBorderWidget)||void 0===n||n.updateByCfg({hidden:!0}):this._embedBorderWidget.updateByCfg({border:gh})}},{key:"setCommentActionType",value:function(e){if(this._embedCommentBorderWidget)switch(e){case 0:this._embedCommentBorderWidget.updateByCfg({border:gh,hidden:!0});break;case 1:this._embedCommentBorderWidget.updateByCfg({border:gh});break;case 2:this._embedCommentBorderWidget.updateByCfg({border:Eh,hidden:!1})}}},{key:"updateHeader",value:function(e,t,n,r,i){this._leftColumnHeader.setColors(e,t,n,r),this._rightColumnHeader.setColors(e,t,n,r),this._topRowHeader.setColors(e,t,n,r),this._bottomRowHeader.setColors(e,t,n,r),this.fcorner.updateBorder(i),this.forceUpdate()}},{key:"updateChartSelection",value:function(){var e=this,t=(this.getChartRanges()||[]).map((function(t){var n;return new x.e6w(t.row,t.col,t.rowCount,t.colCount,null===(n=e.spread())||void 0===n?void 0:n.getSheetFromId(t.sheetId))}));this.tables().forEach((function(e){return e.rebuildChartSelection(t)})),this.updateFormulaSelection()}},{key:"setChartRanges",value:function(e){this._ChartRanges=e}},{key:"getChartRanges",value:function(){return this._ChartRanges}},{key:"getDepends",value:function(){var e=this,t=function(t){"init"!==t.source&&e.setFilterSelVisible(!0),e.updateSelection()},n=function(){return e.forceUpdate()},r=function(){e._rebuild(),e._needPaintCutCopyIndicator=!1,e.updatePasteSelection(),e.updateFrozenDoc(),e.forceUpdate(),e.viewModel.notifyListeners()};return{SelectionChanged:t,ShortcutRangeChanged:t,SpanChanged:t,ProtectedRangeChanged:n,PermissionChanged:function(){var t;null!==(t=e.spread())&&void 0!==t&&t.updatePermissionVersion(),e.forceUpdate()},FrozenChanged:function(t){e._handleFrozenChange(t),e._rebuild()},RangeChanged:function(t){0!==t.type?(e.updateSelection(),e.forceUpdate()):e.debounceUpdate()},CommentChanged:n,NoteChanged:n,RowSizeChanged:r,ColumnSizeChanged:r,RowAdded:r,RowDeleted:r,RowVisible:r,ColumnAdded:r,ColumnDeleted:r,ColumnVisibleChanged:r,AutoRowSizeChanged:r,CoverSheet:function(){e._rebuild(),e.forceUpdate()},OutlineStateChanged:function(){return e.forceUpdate()}}}},{key:"updateConditionFormatRanges",value:function(e){this.tables().forEach((function(t){return t.rebuildConditionFormatSelection(e)})),this.selections$.next(e),this.updateFormulaSelection()}},{key:"updateAiHighlightArea",value:function(e){this.tables().forEach((function(t){return t.rebuildAiHighlightArea(e)}))}},{key:"getCellIndexByDocPos",value:function(e){return this._brTable.docPos2Cell(e.x,e.y)}},{key:"drawTableViewRect",value:function(e,t){var n=this._container.transform,r=this.detectTableByCell(e,t).rect;return n.mapRect(r)}},{key:"indicateRange",value:function(e){this._needPaintCutCopyIndicator=!0,this.indicatedRanges=e,this.updatePasteSelection()}},{key:"repaint",value:function(e){if(this._sheet){var t=Math.max(0,e.y),n=Math.min(this._sheet.frozenRowCount()-1,e.y+e.height-1);if(t<=n){var r=[],i=this.getViewModel().fitRowCalc;return this._sheet._getRowInfos().iterEachActualVisible(t,n).forEach((function(e){return r.push(e)})),r.forEach((function(e){i.calcRow(e)})),this.forceLayout(),void this.forceUpdate()}this.tables().some((function(t){return t.getViewRect().intersect(e)}))&&this.forceUpdate()}}},{key:"_moveInCommentCard",value:function(e,t){this.tables().forEach((function(n){n.moveInCommentCard(e,t)}))}},{key:"_moveOutCommentCard",value:function(){this.tables().forEach((function(e){e.moveOutCommentCard()}))}},{key:"_addCfSelectionHighlight",value:function(e){this.tables().forEach((function(t){t.addCfSelectionHighlight(e)}))}},{key:"_removeCfSelectionHighlight",value:function(){this.tables().forEach((function(e){e.removeCfSelectionHighlight()}))}},{key:"addProtectionSelectionHighlight",value:function(e){this.tables().forEach((function(t){t.addProtectionHighlight(e)}))}},{key:"removeProtectionSelectionHighlight",value:function(){this.tables().forEach((function(e){e.removeProtectionHighlight()}))}},{key:"_addPivotTableSelectionHighlight",value:function(e,t){this.tables().forEach((function(n){n.addPivotTableHighlight(e,t)}))}},{key:"_removePivotTableSelectionHighlight",value:function(){this.tables().forEach((function(e){e.removePivotTableHighlight()}))}},{key:"_addSparklineSelectionHighlight",value:function(e,t){this.tables().forEach((function(n){n.addSparklineHighlight(e,t)}))}},{key:"_removeSparklineSelectionHighlight",value:function(e){this.tables().forEach((function(t){t.removeSparklineHighlight(e)}))}},{key:"show",value:function(){this.updateState({visible:!0})}},{key:"hide",value:function(){this.updateState({visible:!1})}},{key:"getFaster",value:function(){return k.Faster.findFaster(this)}},{key:"getViewModel",value:function(){return this.vm}},{key:"setScrollPos",value:function(e){var t=e.x,n=e.y,r=this.brTable().contentDoc();"number"==typeof t&&r.updateByCfg({posX:t}),"number"==typeof n&&r.updateByCfg({posY:n})}},{key:"pauseAutoRowheightScroll",value:function(e){this.isAutoRowheightScrollPaused=e}},{key:"ensureViewportRowHeight",value:function(){var e=this,t=this._brTable.contentDoc();this._bottomRowHeader.addListener(k.FEventType.BeforeFlush,(function(n){var r=e._brTable.ensureRowHeight(t.posY,t.height);return!1!==r&&(!0===r||e.isAutoRowheightScrollPaused||t.updateByCfg({posY:t.posY+r}),[e._blTable,e._brTable].forEach((function(e){e.reset()})),e._bottomRowHeader.reset()),!1})),this._topRowHeader.addListener(k.FEventType.BeforeFlush,(function(t){return[e._trTable,e._tlTable].forEach((function(e){e.reset()})),e._topRowHeader.reset(),!1}))}},{key:"invalidateRowHeight",value:function(){if(!this.isEmbed){var e=this._brTable.contentDoc(),t=this._brTable.invalidateRowHeight(e.posY);e.updateByCfg({posY:e.posY+t})}this.getViewModel().fitRowCalc.flushCacheHeight()}},{key:"forceLayout",value:function(){if(this._sheet){var e=this.getFrozenArea(),t=e.width,n=e.height,r=this._getFrozenRowCol(this._sheet),i=r.frozenRow,o=r.frozenCol,a=this._tlTable,s=t>=0?Math.min(t,a.docWidth()):a.docWidth(),u=o>0?s:0,l=n>=0?Math.min(n,a.docHeight()):a.docHeight(),c=i>0?l:0;this._updateLayout(u,c)}}},{key:"_updateScroll",value:function(){this.isEmbed?this._hscroll.updateByCfg({max:this._brTable.docWidth()+2*this._offsetX}):this._hscroll.updateByCfg({max:this._brTable.docWidth()}),this._vscroll.updateByCfg({max:this._brTable.docHeight()});var e=this.getContentBounds(),t=this.viewModel.getWidth()-this._offsetX<(this._blTable.docWidth()+this._brTable.docWidth())*this._zoom,n=e.height<(this._trTable.docHeight()+this._brTable.docHeight())*this._zoom;this._hscroll.updateByCfg({hidden:this.invisible||!t}),this._vscroll.updateByCfg({hidden:this.invisible||!n})}},{key:"rebuild",value:function(){this._rebuild()}},{key:"_rebuild",value:function(e){if(this._sheet){var t=this._getFrozenRowCol(this._sheet),n=t.frozenRow,r=t.frozenCol,i=this._sheet.getRowCount(),o=this._sheet.getColumnCount();this._checkTableChange(this._sheet,n,r,i,o)&&(this._tlMeasurer.updateRange(new x.e6w(0,0,n,r,this._sheet)),this._trMeasurer.updateRange(new x.e6w(0,r,n,o,this._sheet)),this._blMeasurer.updateRange(new x.e6w(n,0,i,r,this._sheet)),this._brMeasurer.updateRange(new x.e6w(n,r,i,o,this._sheet)),this._tlTable.rebuild(this._sheet,0,0,n,r),this._tlTable.reset(),this._trTable.rebuild(this._sheet,0,r,n,o),this._trTable.reset(),this._blTable.rebuild(this._sheet,n,0,i,r),this._blTable.reset(),this._brTable.rebuild(this._sheet,n,r,i,o),this._brTable.reset(),this._leftColumnHeader.reset(),this._topRowHeader.reset(),this._rightColumnHeader.reset(),this._bottomRowHeader.reset(),this._updateMeasurer(this._leftColumnHeader,new x.e6w(0,0,1,r,this._sheet)),this._updateMeasurer(this._rightColumnHeader,new x.e6w(0,r,1,o-r,this._sheet)),this._updateMeasurer(this._topRowHeader,new x.e6w(0,0,n,1,this._sheet)),this._updateMeasurer(this._bottomRowHeader,new x.e6w(n,0,i-n,1,this._sheet)),this.updateSelection(),this.updatePasteSelection(),this.updateFormulaSelection(),this.updateFormatPainter(),this.removeTooltip(),this.onRebuild()),this.forceLayout(),this._updateScroll(),this._updateEmbedSheetBorder(),this.triggerRebuild(e),this.updateFrozenWidget()}}},{key:"_getFrozenRowCol",value:function(e){if(this.invisible)return{frozenRow:0,frozenCol:0};for(var t=e.frozenRowCount(),n=e.frozenColumnCount(),r=n,i=t-1;i>=0;i--){if(zy(e,i)){t=i+1;break}t--}for(var o=r-1;o>=0;o--){if(e.getColumnVisible(o)){n=o+1;break}n--}return{frozenRow:t,frozenCol:n}}},{key:"_checkTableChange",value:function(e,t,n,r,i){return e!==this._brTable.sheet()||t!==this._brTable.fromRow()||n!==this._brTable.fromCol()||r!==this._brTable.toRow()||i!==this._brTable.toCol()}},{key:"triggerRebuild",value:function(e){this._sheet&&this._sheet.trigger(Z.zW2.OnRebuild,{isResize:e})}},{key:"_updateMeasurer",value:function(e,t){e.measurer().updateRange(t)}},{key:"calcCell2DocPos",value:function(e,t){var n=this.detectTableByCell(e,t),r=Gv(new x.e6w(e,t,1,1,this._sheet),this._sheet),i=this._container.mapToGlobal(n.cell2DocPos({row:r.rowFrom(),col:r.colFrom()})),o=this._leftColumnHeader.height;return n.height!==this._tlTable.height&&(o=this._tlTable.height),i.y+=o,i.y-=this.appModel.getSheetViewY(),this.transform&&(i.x*=this.transform.scaleX,i.y*=this.transform.scaleY),i}},{key:"scrollRangeToCenter",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20,i=2,o=(0,N.isShortCut)(),a=e.rowFrom(),s=e.colFrom(),u=t._getRowInfos(),l=t._getColInfos(),c=this.detectTableByCell(a,s);if(e.rgType===Z.xj7.ALL)return null;var h=Yy(e),d=this.calcFrozenSize(t,c),f=d.frozenWidth,p=d.frozenHeight;c.ensureBeforeRow(a+Math.min(e.rowCount(),r),2*c.height);var v={x:l.getDistance(0,s)-f-(o||f>0?i:0),y:u.getDistance(0,a)-p-(o||p>0?i:0)},g=l.getDistance(s,s+e.colCount()),_=u.getDistance(a,a+e.rowCount()),y=v.x+g/2,m=v.y+_/2,E=c.contentDoc(),b=E.posX,T=E.posY,C=c.contentDoc(),S=C.maxPosX,w=C.maxPosY;return 1&h&&(b=g>c.width-Df?this.scrollHorizontal(v.x,e,2):this.scrollHorizontal(y,e,0)),2&h&&(T=n?this.scrollVertical(v.y,e,3,n):_>c.height-Df?this.scrollVertical(v.y,e,1):this.scrollVertical(m,e,0)),{posX:Math.min(b,S),posY:Math.min(T,w),rangeTopY:v.y}}},{key:"adjustScrollToRange",value:function(e,t,n,r){var i=this;this.pauseAutoRowheightScroll(!0);var o=t,a=!1,s=n.subscribe("AutoRowSizeChanged",(function(){a||(o=i.scrollRangeToCenter(e,n,t))})),u=r.subscribe("LeftTopPosChanged",(function(e){var t=e.posX,n=e.posY;(!o||t&&Math.abs(o.posX-t.current)>2||n&&Math.abs(o.posY-n.current)>2)&&(a=!0,i.pauseAutoRowheightScroll(!1),s.unsubscribe(),u.unsubscribe())}))}},{key:"scrollHorizontal",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=t.rowFrom(),i=t.colFrom(),o=this.detectTableByCell(r,i),a=0;if(0===n){var s=new k.FPoint(Math.floor((o.width-Df)/2),Math.floor((o.height-Df)/2)),u=o.viewPos2Doc(s.clone());a=Math.max(e,s.x)-u.x}else if(2===n){var l=new k.FPoint(0,0),c=o.viewPos2Doc(l.clone());a=Math.max(e,l.x)-c.x}var h=o.contentDoc().posX;return a&&(h=this.scrollTableX(o,a)),h}},{key:"scrollVertical",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0,i=t.rowFrom(),o=t.colFrom(),a=this.detectTableByCell(i,o),s=a.contentDoc().posY,u=0;if(0===n){var l=new k.FPoint(Math.floor((a.width-Df)/2),Math.floor((a.height-Df)/2)),c=a.viewPos2Doc(l.clone());u=Math.max(e,l.y)-c.y}else if(1===n){var h=new k.FPoint(0,0),d=a.viewPos2Doc(h.clone());u=Math.max(e,h.y)-d.y}else if(3===n&&r){var f=new k.FPoint(0,0),p=a.viewPos2Doc(f.clone()),v=r.rangeTopY-r.posY;u=Math.max(e,f.y)-p.y-v}return u&&a.contentDoc().updateByCfg({posY:s+u}),s+u}},{key:"calcDocsScrollOffset",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;if(!this._sheet)return{offsetX:0,offsetY:0};for(var s=this.detectTableByCell(e,t),u=s.cell2DocPos({row:e,col:t}),l=s.cell2DocPos({row:e+o,col:t+a}),c=this.isEmbed?0:10,h=this.isEmbed?Math.min(this.parent().size.width-this.appModel.getSheetViewX()-s.x,s.width):s.width,d=s.height,f=0,p=0,v=0;v<o;v++)f+=this._sheet.getCellHeight(e+v,t,i);for(var g=0;g<a;g++)p+=this._sheet.getCellWidth(e,t+g,i);var _=0,y=0;if(n&&(d-=n),r){var m=new k.FPoint(Math.floor(h/2),Math.floor(d/2)),E=new k.FPoint(Math.floor((u.x+l.x)/2),Math.floor((u.y+l.y)/2)),b=s.viewPos2Doc(m.clone());_=Math.max(E.x,m.x)-b.x,y=Math.max(E.y,m.y)-b.y}else{var T=s.viewPos2Doc(new k.FPoint(0,0)),C=this.isEmbed?0:Df,S=s.viewPos2Doc(new k.FPoint(h-C,d-C));if(u.x<T.x)_=u.x-T.x-10;else if(S.x<l.x)if(p<h-C){var w=S.x-p,R=w-120;_=R>T.x?u.x-R:u.x-w}else{var A=T.x+c;_=u.x-A}if(u.y<T.y)y=u.y-T.y-10;else if(S.y<l.y)if(f<d-C){var O=S.y-f,M=O-120;y=M>T.y?u.y-M:u.y-O}else{var I=T.y+c;y=u.y-I}}return{offsetX:_,offsetY:y}}},{key:"_bindEvents",value:function(){var e,t,n=this;if(this._sheet){this.registerShell(),this.subscriber=this._sheet.subscribe(this.getDepends()).add(this.getViewModel().onChange((function(e){n.repaint(e)}))),this.spreadSubscriber=null!==(e=null===(t=this.spread())||void 0===t?void 0:t.subscribe({ActiveSheetChanged:this.handleActiveSheetChanged}))&&void 0!==e?e:null;var r=this._sheet.inject(x._JP);this.gridLineHiddenSubscription=r.gridLineHidden$.subscribe((function(e){n.tables().forEach((function(t){t.changeGridLine(e)})),n.forceUpdate()})),this._unsubscribeUIState=(0,U.onUIStateChange)((function(){return n.forceUpdate()})),this._hscroll.addListener(k.FEventType.MouseUp,this.handleScrollBarMouseUp),this._vscroll.addListener(k.FEventType.MouseUp,this.handleScrollBarMouseUp),Z.P_e&&!this.isEmbed&&this._bindCornerSubscription()}}},{key:"_bindCornerSubscription",value:function(){var e=this;if(this._sheet){var t=this._sheet.inject(x.Wph),n=this._sheet.inject(x.uTF);this.cornerSubscription=(0,j.aj)(n.cornerType$,t.selRange$).subscribe((function(t){var n=(0,c.Z)(t,2),r=n[0],i=n[1],o=function(e){switch(e){case Z.LN0.NORMAL_CORNER:return Ty;case Z.LN0.NORMAL_CORNER_V2:return wy;case Z.LN0.CIRCLE_CORNER:return Ey;case Z.LN0.CIRCLE_CORNER_V2:return By;case Z.LN0.MOBILE_FILL_CORNER:return Uy;default:return null}}(r);e.tables().forEach((function(e){e.rebuildFillCornerCfg(o,i)})),e.forceUpdate()}))}}},{key:"_unbindEvents",value:function(){var e,t,n;this._sheet&&(this._sheet.unRegisterShell(),this.subscriber&&this.subscriber.unsubscribe(),null!==(e=this.spreadSubscriber)&&void 0!==e&&e.unsubscribe(),this.gridLineHiddenSubscription&&this.gridLineHiddenSubscription.unsubscribe(),null!==(t=this.cornerSubscription)&&void 0!==t&&t.unsubscribe(),null!==(n=this._unsubscribeUIState)&&void 0!==n&&n.call(this),this._hscroll.removeListener(k.FEventType.MouseUp,this.handleScrollBarMouseUp),this._vscroll.removeListener(k.FEventType.MouseUp,this.handleScrollBarMouseUp))}},{key:"sheet",value:function(){return this._sheet}},{key:"spread",value:function(){var e;return null===(e=this._sheet)||void 0===e?void 0:e.parent}},{key:"hideRowColHeader",value:function(e){var t={hidden:e};if(this.isRowColHeaderHidden=e,this._sheetCorner.updateByCfg(t),this._leftColumnHeader.updateByCfg(t),this._topRowHeader.updateByCfg(t),this._rightColumnHeader.updateByCfg(t),this._bottomRowHeader.updateByCfg(t),this._embedBorderWidget){var n,r=this.getEmbedSheetBorderWidth(this._options.embedRightPadding)();null!==(n=this._embedBorderWidget)&&void 0!==n&&n.updateByCfg({width:r}),this._updateEmbedSheetBorder()}this.tables().forEach((function(t){var n=t.getLayer("cell_border_layer"),r=t.getLayer("stroke_layer");n&&n.firstLine(e),r&&r.firstLine(e)}))}},{key:"updateOverHeight",value:function(e){this.overHeight!==e&&(this.overHeight=e),this.hscrollOverHeight!==e&&(this.hscrollOverHeight=(e||this.viewModel.getHeight())-this._hscroll.height)}},{key:"contentDoc",value:function(){return this._brTable.contentDoc()}},{key:"toggleBuffer",value:function(e){this.tables().forEach((function(t){t.toggleBuffer(e)}))}},{key:"detectTable",value:function(e){var t=this._container.mapFromGlobal(e.clone()),n=this._tlTable.width,r=this._tlTable.height,i=this._tlTable.x+n,o=this._tlTable.y+r;return t.x<=i&&n>0?t.y<=o?this._tlTable:this._blTable:t.y<=o&&r>0?this._trTable:this._brTable}},{key:"detectTableByCell",value:function(e,t){var n=this._brTable;return e>=n.fromRow()?t>=n.fromCol()?this._brTable:this._blTable:t>=n.fromCol()?this._trTable:this._tlTable}},{key:"getLogicCellRect",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this._container.transform,i=this.getCellRect(e,t,n);return r.inverseRect(i)}},{key:"getNotExpendCellRect",value:function(e,t){var n=this.detectTableByCell(e,t),r=new x.e6w(e,t,1,1,this._sheet),i=n.range2ViewRect(r);return this.mapWidgetToGlobal(i,n)}},{key:"getCornerRect",value:function(){var e=this._sheetCorner.paintedRect();return this.mapWidgetToGlobal(e,this._container)}},{key:"getLogicCornerRect",value:function(){var e=this._container.transform,t=this.getCornerRect();return e.inverseRect(t)}},{key:"mapWidgetToGlobal",value:function(e,t){if(!t)return e.clone();var n=t.mapToGlobal(new k.FPoint(e.x,e.y)),r=t.mapToGlobal(new k.FPoint(e.x+e.width,e.y+e.height));return new k.FRect(n.x,n.y,r.x-n.x,r.y-n.y)}},{key:"getContentBounds",value:function(){var e=this._container.transform.mapPoint(new k.FPoint(this._topRowHeader.width,this._leftColumnHeader.height));return new k.FRect(e.x,e.y,this.viewModel.getWidth()-e.x-this._rightMargin,this.viewModel.getHeight()-e.y-this._bottomMargin)}},{key:"getContentLogicBounds",value:function(){var e=this._container.transform,t=this.getContentBounds();return e.inverseRect(t)}},{key:"isFrozenAreaOverflow",value:function(){if(!this._sheet)return!1;var e=this._sheet.frozenRowCount();if(!(this._sheet.frozenColumnCount()>0||e>0))return!1;var t=this.isFeed,n=this.isEmbed,r=t?.3*this.viewModel.getWidth():this.viewModel.getWidth()-(n?0:Df),i=t?.6*this.viewModel.getHeight():this.viewModel.getHeight()-(n?0:Df);return r>0&&(this._tlTable.docWidth()+(n?0:this._sheet._getSheetRowHeaderWidth()))*this._zoom>=r||i>0&&(this._tlTable.docHeight()+(n?0:this._sheet._getSheetColHeaderHeight()))*this._zoom>=i}},{key:"isFrozenAreaChange",value:function(){if(!this._sheet)return!1;var e=this.getFrozenArea(),t=e.width,n=e.height;return(t!==this._frozenX||n!==this._frozenY)&&(this._frozenX=t,this._frozenY=n,!0)}},{key:"getFrozenArea",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.sheet();if(!t||this.invisible)return{width:0,height:0};var n=this.getCustomFrozenArea(),r=n.width,i=n.height,o=t.frozenRowCount(),a=t.frozenColumnCount(),s=this.getViewModel(),u=r>=0?Math.min(r,s.getFrozenX()):s.getFrozenX(),l=a>0?u:0,c=i>=0?Math.min(i,s.getFrozenY()):s.getFrozenY(),h=o>0?c:0;return e&&(l*=this.zoom,h*=this.zoom),{width:l,height:h}}},{key:"getResizerStatus",value:function(){return this.showRowColResizer?0===this.rowColResizerRect.x?"row":0===this.rowColResizerRect.y?"col":"":""}},{key:"getRowColDragDropWidgetStatus",value:function(){return this._rowColDragDropWidgets?this._rowColDragDropWidgets.line.hidden?"":0===this._rowColDragDropWidgets.line.x?"row":0===this._rowColDragDropWidgets.line.y?"col":"":""}},{key:"getFormularSelectionModel",value:function(){return this._formulaRgModel}},{key:"setRightMargin",value:function(e){this._rightMargin=e?2:0}},{key:"setBottomMargin",value:function(e,t){Z.Ps3.getIsDocx()||(this._bottomMargin=e?this._hscroll.height:2,void 0!==t&&0!==t&&(this._bottomMargin+=5))}},{key:"getWidthCompensation",value:function(){return this.isEmbed&&!Z.Ps3.getIsDocx()?2:0}},{key:"destroy",value:function(){this._unbindEvents(),this._removeBindings(),this._renderFPS&&this._renderFPS.destroy(),this._layerTime&&this._layerTime.destroy(),this._paintTime&&this._paintTime.destroy(),this.releaseHitTest(),this.worksheet$.complete(),this.selections$.complete(),this.collabCursors$.complete(),this.hoverCell$.complete(),this.editingCell$.complete(),this.stateModelSubscription&&this.stateModelSubscription.unsubscribe(),this.stateModelSubscription=null,this.layerRenderers.forEach((function(e){return null==e?void 0:e.dispose()})),this.layerRenderers=[],this.selectionRenderers.forEach((function(e){return null==e?void 0:e.dispose()})),this.selectionRenderers=[],this.sheetViewRenderers.forEach((function(e){return null==e?void 0:e.dispose()})),this.sheetViewRenderers=[],this.gridRenderers.forEach((function(e){return null==e?void 0:e.dispose()})),this.gridRenderers=[],this.debounceUpdate.cancel(),this._sheet=null,(0,l.Z)((0,p.Z)(t.prototype),"destroy",this).call(this)}},{key:"updateSheet",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._sheet!==e||r){if(this._fpsReporter.updateSheet(e),this._unbindEvents(),"history"!==(this.spread()||e.parent).options.situation){var i=e.parent.permissionManager;!i.existPerm(e.id()||"")||i.curSheetVisiblePerm?this.showVisibleSheet():this.hideInvisibleSheet(!1)}var o=e.parent.permissionManager;!o.findPerm(e.id()||"").length||o.curSheetVisiblePerm?this.showVisibleSheet():this.hideInvisibleSheet(o.userPerm.isReady);var a=this.getViewModel();if(a){var s=this._brTable.contentDoc();a.setScrollPosition(s.posX,s.posY)}this.releaseHitTest(),this._sheet=e,this.vm=this.viewModelManager.creatViewModel(e),this._sheet.hitTest=this.sheetHitTest,this.worksheet$.next(e),this.measures().forEach((function(e){e.updateRange(new x.SWH(n._sheet))})),this.tables().forEach((function(t){t.updateSheet(),t.rebuild(e,0,0,0,0)})),this.headers().forEach((function(t){return t.updateSheet(e)})),this.fcorner.updateSheet(e);var u=this.getViewModel().fitRowCalc;this.isEmbed||u.calcSelfOnly(),u.flushCacheHeight(),(0,l.Z)((0,p.Z)(t.prototype),"forceUpdate",this).call(this),this._bindEvents(),this._formulaRgModel||(this._formulaRgModel=new ty);var c=e.id(),h=Z.UIE.getItem(c);this.zoomContent(h),this._rebuild(),this._brTable.contentDoc().updateByCfg(this.getViewModel().getScrollPosition()),this.$shellWatcher.dispatch("ActiveSheetViewChange",{formulaSelectionModel:this._formulaRgModel})}}},{key:"updateFormulaSelection",value:function(){this._blTable.rebuildFormulaSelection(this._formulaRgModel),this._brTable.rebuildFormulaSelection(this._formulaRgModel),this._tlTable.rebuildFormulaSelection(this._formulaRgModel),this._trTable.rebuildFormulaSelection(this._formulaRgModel)}},{key:"updateSelection",value:function(){var e=this._sheet;if(e){var t=e.selectionType,n=e._selectionModel.toArray(),r=e._activeRowIndex,i=e._activeColIndex,o=new x.e6w(r,i,1,1,e),a=kd(this._sheet,r,i);a&&(o=a),this.selections$.next(3===t?[]:n),this.tables().forEach((function(e){return e.rebuildSelection(n,o)})),t&&1!==t?this.unselectHeaderSelections(n):this.rebuildHeaderSelections(n)}}},{key:"updateFrozenWidget",value:function(){var e=this;this._frozenBottomCol.forEach((function(t){t.updateByCfg({height:e.getRealBRTableHeight()})})),this._frozenRightRow.forEach((function(t){t.updateByCfg({width:e.getRealBRTableWidth()})}))}},{key:"rebuildHeaderSelections",value:function(e){this.headers().forEach((function(t){t.updateSelections(e)}))}},{key:"unselectHeaderSelections",value:function(e){this.headers().forEach((function(e){e.unselectFloatingObjects()}))}},{key:"getFormatPainterRanges",value:function(){return this._sheet&&this._sheet.id()===this._formatPainterSourceSheetId?this._formatPainterRanges:[]}},{key:"setFormatPainterRanges",value:function(e){void 0!==e?this._formatPainterRanges=e:this._sheet&&(this._formatPainterSourceSheetId=this._sheet.id(),this._formatPainterRanges=this._sheet.getSelections())}},{key:"updateFormatPainter",value:function(){var e=this.getFormatPainterRanges();this.tables().forEach((function(t){return t.rebuildFormatPainterRange(e)}))}},{key:"unselectFloatingObjects",value:function(e,t,n){this._sheet&&(this._needPaintCutCopyIndicator=!1,this.tables().forEach((function(r){return r.unselectFloatingObjects(e,t,n)})),e&&this.headers().forEach((function(e){return e.unselectFloatingObjects()})))}},{key:"reselectFloatingObjects",value:function(){this.tables().forEach((function(e){return e.reselectFloatingObjects()})),this.headers().forEach((function(e){return e.reselectFloatingObjects()}))}},{key:"updateDistrictCursor",value:function(e){this.collabCursors$.next(e)}},{key:"updateEditingCursor",value:function(e){this.editingCell$.next(e)}},{key:"updatePasteSelection",value:function(){var e=[],t=this.isEmbed,n=this._sheet;n&&(t&&n!==n.parent.getActiveSheet()||(this._needPaintCutCopyIndicator&&this.indicatedRanges&&(e=this.indicatedRanges),this.tables().forEach((function(t){return t.rebuildPasteSelection(e)}))),this.updateFormulaSelection())}},{key:"updateHistoryText",value:function(e){this._sheet&&(this._tlTable.rebuildHistoryText(e),this._trTable.rebuildHistoryText(e),this._blTable.rebuildHistoryText(e),this._brTable.rebuildHistoryText(e))}},{key:"globalPoint2Cell",value:function(e){return this.detectTable(e).glbPt2AbsCell(e)}},{key:"globalPoint2VisibleCell",value:function(e){return this.detectTable(e).glbPt2VisibleAbsCell(e)}},{key:"setDropStartCell",value:function(e){this.dropStartCell=e}},{key:"getDropStartCell",value:function(){return this.dropStartCell}},{key:"showTooltip",value:function(e,t,n,r){var i=this.getCellRect(t,n),o=i.x,a=i.y,s=new k.FPoint(o,a);s=this.mapFromGlobal(s),this._toolTip.updateByCfg({x:s.x+3,y:s.y+3,text:r,hidden:!r})}},{key:"headerHeight",value:function(){return this._sheetCorner.height+this._tlTable.height}},{key:"removeTooltip",value:function(){this._toolTip.updateByCfg({hidden:!0})}},{key:"contentSizeHint",value:function(){if(this.forceUpdate(),!this._sheet)return{width:0,height:0};var e=this._brTable,t=this._trTable,n=this._blTable,r=this.getSheetRowHeaderWidth(),i=this.getSheetColHeaderHeight(),o=e.docHeight()+t.docHeight()+i+this._bottomMargin,a=e.docWidth()+n.docWidth()+r+this._rightMargin,s=this._zoom;return 1!==s&&(o*=s,a*=s),{width:a,height:o}}},{key:"registerShell",value:function(){var e=this.viewManager;e&&e.addShellEventHandler("SHEET_VIEW",this._onNotifyShell),this._sheet&&this._sheet.registerShell(this._onNotifyShell)}},{key:"updateHitTest",value:function(){this._sheet&&(this._sheet.hitTest=this.sheetHitTest)}},{key:"releaseHitTest",value:function(){this._sheet&&this._sheet.hitTest===this.sheetHitTest&&(this._sheet.hitTest=w.default)}},{key:"getZoomContentPadding",value:function(){return{bottomPadding:this.isEmbed?Hf:72,rightPadding:this.isEmbed?Vf:Df+8+72}}},{key:"zoomContent",value:function(e){if(!this.invisible&&this._zoom!==e){this._zoom=e,this.zoom$.next(e);var t=this.parent().size.width/e,n=this.parent().size.height/e,r=this.transform,i=r.b,o=r.c,a=r.e,s=r.f,u=new k.TMatrix(1,i,o,1,a,s);if(this._container.updateByCfg({transform:u.scale(e,e),width:t,height:n}),this._hscroll.updateByCfg({width:this._getHScrollWidth(this.viewModel.getWidth()),max:this._brTable.docWidth()}),this._vscroll.updateByCfg({height:this._getVScrollHeight(this.viewModel.getHeight()),max:this._brTable.docHeight()}),this._hscrollerTrackHeader&&this._hscrollerTrackHeader.updateByCfg({width:this._bottomRowHeader.width*e}),this._vscrollerTrackHeader&&this._vscrollerTrackHeader.updateByCfg({height:this._rightColumnHeader.height*e}),this.hideRowColHeaderEnable){var l,c,h,d,f=(this.topRowHeader().width||24)*this._zoom,p=(this.leftColumnHeader().height||24)*this._zoom;null!==(l=this._embedBorderWidget)&&void 0!==l&&l.updateByCfg({x:f,y:p}),null!==(c=this._embedCommentBorderWidget)&&void 0!==c&&c.updateByCfg({x:f,y:p}),null!==(h=this._embedHighLightContentBorderWidget)&&void 0!==h&&h.updateByCfg({x:f,y:p}),null===(d=this._embedHighLightContentWidget)||void 0===d||d.updateByCfg({x:f,y:p})}var v=this.getZoomContentPadding(),g=v.bottomPadding,_=v.rightPadding/e,y=g/e;this._brTable.setPadding(y,_),this._blTable.setPadding(y,0),this._trTable.setPadding(0,_),this._rightColumnHeader.setPadding(_),this._bottomRowHeader.setPadding(y),this.forceLayout(),Tf.trigger(vc.SHEET_VIEW.ZOOM,[vc.SHEET_VIEW.ZOOM,this,e]),this.checkIsFrozenAreaOverflow()}}},{key:"scrollToActiveComment",value:function(){var e,t,n=null!==(e=null===(t=this._sheet)||void 0===t?void 0:t.getActiveComments())&&void 0!==e?e:[];if(n.length>0){var r=n[0].col;this._scrollColTo(r)}}},{key:"headers",value:function(){return[this._leftColumnHeader,this._topRowHeader,this._rightColumnHeader,this._bottomRowHeader]}},{key:"tables",value:function(){return[this._tlTable,this._trTable,this._blTable,this._brTable]}},{key:"measures",value:function(){return[this._tlMeasurer,this._trMeasurer,this._blMeasurer,this._brMeasurer]}},{key:"tableContainer",value:function(){return this._container}},{key:"vscroll",value:function(){return this._vscroll}},{key:"hscroll",value:function(){return this._hscroll}},{key:"trTable",value:function(){return this._trTable}},{key:"blTable",value:function(){return this._blTable}},{key:"brTable",value:function(){return this._brTable}},{key:"tlTable",value:function(){return this._tlTable}},{key:"toolTip",value:function(){return this._toolTip}},{key:"rowColResizer",value:function(){return this._rowColResizer}},{key:"rowColResizeTip",value:function(){return this._rowColResizeTip}},{key:"rowColDragDropWidgets",value:function(){return this._rowColDragDropWidgets}},{key:"leftColumnHeader",value:function(){return this._leftColumnHeader}},{key:"rightColumnHeader",value:function(){return this._rightColumnHeader}},{key:"topRowHeader",value:function(){return this._topRowHeader}},{key:"bottomRowHeader",value:function(){return this._bottomRowHeader}},{key:"embedHighLightContentBorderWidget",value:function(){return this._embedHighLightContentBorderWidget}},{key:"embedBorderWidget",value:function(){return this._embedBorderWidget}},{key:"afterFlush",value:function(e){(0,l.Z)((0,p.Z)(t.prototype),"afterFlush",this).call(this,e);var n=!1,r=e.changes;void 0===r.width&&void 0===r.height||(n=!0),(n||void 0!==r._phantom)&&this._rebuild(n)}},{key:"forceUpdate",value:function(){(0,l.Z)((0,p.Z)(t.prototype),"forceUpdate",this).call(this),this._container.children().forEach((function(e){e.detectLifetimeOnce()})),this.tables().forEach((function(e){return e.reset()})),this.headers().forEach((function(e){return e.reset()})),this._updateScroll(),this._updateEmbedSheetBorder()}},{key:"onRebuild",value:function(){}},{key:"_nextPage",value:function(){var e=this._brTable,t=e.viewPos2Doc(new k.FPoint(0,e.height)),n=this._bottomRowHeader.width,r=this._rightColumnHeader.height;t.y=Math.min(t.y+r,e.docHeight()),e.contentDoc().updateByCfg({posY:t.y});var i=e.docPos2Cell(t.x,t.y),o=e.docPos2Cell(t.x+n-1,t.y+r-1);return{row:i.row,rowCount:o.row-i.row+1}}},{key:"_prePage",value:function(){var e=this._brTable,t=e.viewPos2Doc(new k.FPoint(0,0)),n=this._bottomRowHeader.width,r=this._rightColumnHeader.height,i=Math.max(0,t.y-r);e.contentDoc().updateByCfg({posY:i});var o=e.docPos2Cell(t.x,t.y),a=e.docPos2Cell(t.x+n-1,t.y+r-1);return{row:o.row,rowCount:a.row-o.row+1}}},{key:"scrollTo",value:function(e,t){var n=this._brTable.contentDoc(),r=n.posX,i=n.posY;n.updateByCfg({posX:r+e,posY:i+t})}},{key:"_scrollColTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.detectTableByCell(0,e),r=!this.isEmbed||!this._hscroll.hidden,i=this.calcDocsScrollOffset(0,e,void 0,t&&r);i&&this.scrollTableX(n,i.offsetX);var o=n.glbPt2AbsCell(new k.FPoint(0,0)),a=n.glbPt2AbsCell(new k.FPoint(n.width-this.appModel.getSheetViewX(),n.height));return{col:o.col,colCount:a.col-o.col+1}}},{key:"scrollTableX",value:function(e,t){var n=this.appModel.getSheetViewX(),r=e.contentDoc().posX;if(n>0){if((n-=t)>0)return this.appModel.setSheetViewX(n),r;t=-n,this.appModel.setSheetViewX(0)}return e.contentDoc().updateByCfg({posX:r+t}),r+t}},{key:"_scrollRowTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.detectTableByCell(e,0);this.isEmbed||n.ensureBeforeRow(e,n.height);var r=this.calcDocsScrollOffset(e,0,void 0,t),i=n.contentDoc().posY;r&&n.contentDoc().updateByCfg({posY:i+r.offsetY});var o=n.glbPt2AbsCell(new k.FPoint(0,0)),a=n.glbPt2AbsCell(new k.FPoint(n.width,n.height));return{row:o.row,rowCount:a.row-o.row+1}}},{key:"_scrollRangeTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._sheet){var n=(0,x.eTC)(e),r=Math.min((0,x.Thf)(e,n),this._sheet.getRowCount()),i=(0,x.QKf)(e),o=Math.min((0,x.nL$)(e,i),this._sheet.getColumnCount()),a=this.detectTableByCell(n,i);this.isEmbed||a.ensureBeforeRow(n,a.height);var s=this.calcDocsScrollOffset(n,i,void 0,t,!1,r-n+1,o-i+1),u=a.contentDoc().posX,l=a.contentDoc().posY;s&&a.contentDoc().updateByCfg({posX:u+s.offsetX,posY:l+s.offsetY})}}},{key:"scrollRangeToTopLeft",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=e.rowFrom(),i=e.colFrom(),o=this.tlTable(),a=this.trTable(),s=this.blTable(),u=this.brTable();u.contentDoc().updateByCfg({posX:0,posY:0});var l=x.ipL._defaultRowHeaderColWidth,c=x.ipL._defaultColHeaderRowHeight,h=this.getLogicCellRect(r,i,!1),d=h.x,f=h.y,p=this.detectTableByCell(r,i),v=o.contentDoc().height,g=o.contentDoc().width,_=d-l-t,y=f-c-n;p===o?o.contentDoc().updateByCfg({posX:_,posY:y}):p===a?a.contentDoc().updateByCfg({posX:_-g,posY:y}):p===s?s.contentDoc().updateByCfg({posX:_,posY:y-v}):u.contentDoc().updateByCfg({posX:_-g,posY:y-v})}},{key:"hasChange",value:function(e){return!0}},{key:"waitSourceReady",value:function(){var e=this.tables().map((function(e){return e.getImageLayer().imageLoaded()}));return Promise.all(e)}},{key:"waitFloatImageReady",value:function(){var e=this.tables().map((function(e){var t;return null===(t=e.floatImage)||void 0===t?void 0:t.layer.imageLoaded()}));return Promise.all(e)}},{key:"changeSheetColorForPrint",value:function(e,t){(0,k.registerColorTheme)(e,"restore"===t?mf:bf),this.forceUpdate()}},{key:"currentScreenShot",value:function(){this.unselectFloatingObjects(!0,!0,!0);var e=this._vscroll.hidden,t=this._hscroll.hidden,n=k.Faster.findFaster(this);(0,N.isShortCut)()&&this.changeSheetColorForPrint(n),this._vscroll.updateByCfg({hidden:!0}),this._hscroll.updateByCfg({hidden:!0}),n.tick();var r=n.canvas(),i=k.FCanvasPool.borrowCanvas(null,void 0,!0),o=i.ctx(),a=this.viewModel.getWidth()-this.appModel.getSheetViewX(),s=this.viewModel.getHeight(),u=new k.FRect(this.appModel.getSheetViewX(),this.appModel.getSheetViewY(),a,s),l=new k.FRect(0,0,a,s);i.resize(a,s);var c=u.x,h=u.y,d=u.width,f=u.height;if(this.hideRowColHeaderEnable){var p=this.getSheetRowHeaderWidth(),v=this.getSheetColHeaderHeight();c=c+p-1,h=h+v-1,d=d-p+1,f=f-v+1}Xy(o,r,c,h,d,f,l.x,l.y,l.width,l.height);var g=i.element().toDataURL("image/png");return k.FCanvasPool.backCanvas(i),(0,N.isShortCut)()&&this.changeSheetColorForPrint(n,"restore"),this.reselectFloatingObjects(),this._vscroll.updateByCfg({hidden:e}),this._hscroll.updateByCfg({hidden:t}),g}},{key:"exportImage",value:(n=(0,o.Z)(i().mark((function e(t){var n,r,o,a,s,u,l,c,h,d,f,p,v,g,_,y,m,E,b,T,C,S,w=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(n=this._sheet)){e.next=3;break}return e.abrupt("return");case 3:r=k.Faster.findFaster(this),o=n.getRowCount(),n._getRowInfos().iterEachActualVisible(0,o-1).forEach((function(e){w.getViewModel().fitRowCalc.calcRow(e)})),this.changeSheetColorForPrint(r),a=r.canvas(),s=r.size.width,u=r.size.height,l=this._brTable.contentDoc(),c=this._brTable.docHeight(),h=this._trTable.docHeight(),d=this._rightColumnHeader.height,f=this._bottomMargin,p=k.FCanvasPool.borrowCanvas(null,void 0,!0),v=p.ctx(),g=s,_=h+c+d,p.resize(g,_),y=u-d-h-f,m=Math.floor(c/y),E=m,b=c%y,this.isEmbed&&b>0&&(y-=1),T=0,l.updateByCfg({posY:T}),r.tick(),Xy(v,a,0,0,s,C=d+h,0,0,s,C);case 14:if(!(m-- >0)){e.next=25;break}return l.updateByCfg({posY:T}),r.tick(),e.next=19,this.waitSourceReady();case 19:if(l.posY===T){e.next=22;break}return m++,e.abrupt("continue",23);case 22:Xy(v,a,0,d+h,s,y,0,T+d+h,s,y),T+=y;case 23:e.next=14;break;case 25:if(!(b>0)){e.next=31;break}return l.updateByCfg({posY:T}),r.tick(),e.next=30,this.waitSourceReady();case 30:Xy(v,a,0,d+h+y-b-1*E+1,s,b+f+1*E,0,T+d+h,s,b+f+1*E);case 31:if(this.changeSheetColorForPrint(r,"restore"),this.tables().forEach((function(e){return e.renderEnv="preview"})),!t){e.next=33;break}return e.abrupt("return",new Promise((function(e){p.element().toBlob((function(t){e(t),k.FCanvasPool.backCanvas(p)}))})));case 33:return S=p.element().toDataURL("image/png"),e.abrupt("return",(k.FCanvasPool.backCanvas(p),S));case 35:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"getCustomFrozenArea",value:function(){return{width:-1,height:-1}}},{key:"updateFrozenDoc",value:function(){}},{key:"setDragDropStatus",value:function(e){this._sheetGrabbing=e}},{key:"getDragDropStatus",value:function(){return this._sheetGrabbing}},{key:"setMouseDownStatus",value:function(e){this._sheetHeaderMouseDown=e}},{key:"getMouseDownStatus",value:function(){return this._sheetHeaderMouseDown}},{key:"isHiddenWidget",value:function(e){return null===e.rootId()||null===e.parent()||e.hidden||!!e.autoHide}},{key:"addFPSLog",value:function(e){this._renderFPS.addLog(e)}},{key:"getVisibleRangeInfo",value:function(){var e=this.tableMap,t=e.tl,n=e.bl,r=e.br,i=e.tr;return{tl:t.visibleArea(),bl:n.visibleArea(),tr:i.visibleArea(),br:r.visibleArea()}}},{key:"scrollTableDistance",value:function(e){this.tables().forEach((function(t){return t.scrollPosx(e)}))}},{key:"tableScrollToPos",value:function(e){this.tables().forEach((function(t){return t.contentDoc().updateByCfg({posX:e})}))}},{key:"calcFrozenSize",value:function(e,t){var n=e.frozenRowCount(),r=e.frozenColumnCount(),i=e._getRowInfos(),o=e._getColInfos(),a=0,s=0;return n>0&&(a=i.getDistance(0,n)),r>0&&(s=o.getDistance(0,r)),t===this.tlTable()?(a=0,s=0):t===this.blTable()?s=0:t===this.trTable()&&(a=0),{frozenWidth:s,frozenHeight:a}}},{key:"shellWatcher",get:function(){return this.$shellWatcher}},{key:"tableMap",get:function(){return{tl:this._tlTable,tr:this._trTable,bl:this._blTable,br:this._brTable}}},{key:"horizontalScrollSize",get:function(){var e=this._hscroll,t=e.width,n=e.height;return t>0?n:0}},{key:"verticalScrollSize",get:function(){var e=this._vscroll,t=e.width;return e.height>0?t:0}},{key:"_needPaintCutCopyIndicator",get:function(){var e;return(null===(e=this._sheet)||void 0===e?void 0:e.id())===this._indicatorSheetId},set:function(e){var t,n,r;!0===e?this._indicatorSheetId=null!==(t=null===(n=this._sheet)||void 0===n?void 0:n.id())&&void 0!==t?t:"":(null===(r=this._sheet)||void 0===r?void 0:r.id())===this._indicatorSheetId&&(this._indicatorSheetId="")}},{key:"editable",get:function(){return this.viewModel.getEditable()}},{key:"rowEditable",get:function(){return this.viewModel.getRowEditable()}},{key:"colEditable",get:function(){return this.viewModel.getColEditable()}},{key:"isDocumentReadonly",get:function(){return this.viewModel.getIsDocumentReadonly()}},{key:"isOverDoc",get:function(){return this.viewModel.getIsOverDoc()}},{key:"mobileFilling",get:function(){var e;return!(null===(e=this._sheet)||void 0===e||!e.inject(x.uTF).mobileFilling)}},{key:"rect",get:function(){var e=this.appModel.getSheetViewX(),t=this.appModel.getSheetViewY();return new k.FRect(e,t,this.viewModel.getWidth(),this.viewModel.getHeight())}},{key:"zoom",get:function(){return this._zoom},set:function(e){this._zoom=e}}]),t}(k.FBaseWidget);function jy(e,t,n,r){k.Bind.propBind(e,t,n,r),k.Bind.propBind(n,r,e,t)}function Gy(e,t,n,r,i){var o,a=cc(e);try{for(a.s();!(o=a.n()).done;){var s=o.value;k.Bind.propBind(s,t,n,r,i)}}catch(e){a.e(e)}finally{a.f()}}function zy(e,t){return e.getRowVisible(t)||!e.filterModel.isVisible(t)}function Yy(e){var t=3;return e.rgType===Z.xj7.ROW?t=2:e.rgType===Z.xj7.COL&&(t=1),t}function Xy(e,t,n,r,i,o,a,s,u,l){var c=new k.FRect(n,r,i,o);(0,k.transformMatrix)(t.ctx()).mapRect(c).rounds();try{e.drawImage(t.element(),c.x,c.y,c.width,c.height,a,s,u,l)}catch(e){return console.error(e),!1}return!0}hp([k.State],Wy.prototype,"key",void 0),hp([k.State],Wy.prototype,"showRowColResizer",void 0),hp([k.State],Wy.prototype,"rowColResizerRect",void 0),hp([k.State],Wy.prototype,"rowColResizeTipPos",void 0),hp([k.State],Wy.prototype,"dragDropIsRow",void 0),hp([k.State],Wy.prototype,"showRowColDragDrop",void 0),hp([k.State],Wy.prototype,"dragDropWidgetsAreaPos",void 0),hp([k.State],Wy.prototype,"dragDropWidgetsAreaLinePos",void 0),hp([k.State],Wy.prototype,"dragDropWidgetsAreaTrianglePos",void 0),hp([k.State],Wy.prototype,"colWidths",void 0),hp([k.State],Wy.prototype,"rowHeights",void 0),hp([k.State],Wy.prototype,"visible",void 0),hp([k.State],Wy.prototype,"hscrollOverHeight",void 0);var Ky=function(){var e,t=new Map,n={on:function(e,r){return(Array.isArray(e)?e:[e]).forEach((function(e){return t.set(e,r)})),n},trigger:function(n,r){var i=t.get(n);return i?i({eventName:n,data:r}):e?e({eventName:n,data:r}):void 0},default:function(t){return e=t,n}};return n},qy=function(e){function t(){return(0,h.Z)(this,t),(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){return(0,ye.widget2State)(this.container)}}]),t}(k.FBaseWidget);hp([k.State],qy.prototype,"container",void 0);var $y=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).key="RowColResizerWidget",e.showRowColResizer=!1,e.rowColResizerRect=new k.FRect(0,0,0,0),e.rowColResizeTipPos=new k.FPoint(0,0),e.ignore=!0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=this;return this.showRowColResizer?k.Stack.with({key:"resizerStack"}).fill((function(){return[k.Positioned.with({key:"rowcolresizer",top:e.rowColResizerRect.y,left:e.rowColResizerRect.x}).fill((function(){return(0,ye.widget2State)(e.rowColResizer)})),k.Positioned.with({key:"rowcolresizertip",top:e.rowColResizeTipPos.y,left:e.rowColResizeTipPos.x}).fill((function(){return(0,ye.widget2State)(e.rowColResizeTip)}))]})):null}}]),t}(k.FBaseWidget);hp([k.State],$y.prototype,"key",void 0),hp([k.State],$y.prototype,"showRowColResizer",void 0),hp([k.State],$y.prototype,"rowColResizerRect",void 0),hp([k.State],$y.prototype,"rowColResizeTipPos",void 0),hp([k.State],$y.prototype,"rowColResizer",void 0),hp([k.State],$y.prototype,"rowColResizeTip",void 0),hp([k.State],$y.prototype,"ignore",void 0);var Jy=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).key="RowColDragDropWidget",e.sheetViewX=0,e.sheetViewY=0,e.dragDropIsRow=!1,e.showRowColDragDrop=!1,e.dragDropWidgetsAreaPos=new k.FPoint(0,0),e.dragDropWidgetsAreaLinePos=new k.FPoint(0,0),e.dragDropWidgetsAreaTrianglePos=new k.FPoint(0,0),e.ignore=!0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=this;return this.showRowColDragDrop?k.Stack.with({key:"rowColDragDropStack"}).fill((function(){return[k.Positioned.with({key:"dragDropWidgetsArea",top:e.dragDropWidgetsAreaPos.y,left:e.dragDropWidgetsAreaPos.x}).fill((function(){return(0,ye.widget2State)(e.rowColDragDropWidgetsArea)})),k.Positioned.with({key:"dragDropWidgetsAreaLine",top:e.dragDropWidgetsAreaLinePos.y,left:e.dragDropWidgetsAreaLinePos.x}).fill((function(){return(0,ye.widget2State)(e.rowColDragDropWidgetsLine)})),k.Positioned.with({key:"dragDropWidgetsAreaTriangle",top:e.dragDropWidgetsAreaTrianglePos.y,left:e.dragDropWidgetsAreaTrianglePos.x}).fill((function(){return(0,ye.widget2State)(e.rowColDragDropWidgetsTriangle)}))]})):null}}]),t}(k.FBaseWidget);hp([k.State],Jy.prototype,"key",void 0),hp([k.State],Jy.prototype,"sheetViewX",void 0),hp([k.State],Jy.prototype,"sheetViewY",void 0),hp([k.State],Jy.prototype,"dragDropIsRow",void 0),hp([k.State],Jy.prototype,"showRowColDragDrop",void 0),hp([k.State],Jy.prototype,"dragDropWidgetsAreaPos",void 0),hp([k.State],Jy.prototype,"dragDropWidgetsAreaLinePos",void 0),hp([k.State],Jy.prototype,"dragDropWidgetsAreaTrianglePos",void 0),hp([k.State],Jy.prototype,"rowColDragDropWidgetsArea",void 0),hp([k.State],Jy.prototype,"rowColDragDropWidgetsLine",void 0),hp([k.State],Jy.prototype,"rowColDragDropWidgetsTriangle",void 0),hp([k.State],Jy.prototype,"ignore",void 0);var Qy=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).key="ToolTipWrapper",e.ignore=!0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){return(0,ye.widget2State)(this.toolTip)}}]),t}(k.FBaseWidget);hp([k.State],Qy.prototype,"key",void 0),hp([k.State],Qy.prototype,"ignore",void 0),hp([k.State],Qy.prototype,"toolTip",void 0);var em=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).key="ScrollWidget",e.isEmbed=!1,e.sheetViewX=0,e.colWidths=[0,0,0,0],e.rowHeights=[0,0,0,0],e.zoom=1,e.offsetX=0,e.width=0,e.height=0,e.skipSelfEvent=!0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=this,t=[];return this.isEmbed||(t=[k.Positioned.with({key:"hscrollerTrackHeader",bottom:0,left:0}).fill((function(){return(0,ye.widget2State)(e.hscrollerTrackHeader)})),k.Positioned.with({key:"hscrollerTrack",bottom:0,left:this.colWidths[0]*this.zoom}).fill((function(){return(0,ye.widget2State)(e.hscrollerTrack)})),k.Positioned.with({key:"vscrollerTrackHeader",right:0,top:0}).fill((function(){return(0,ye.widget2State)(e.vscrollerTrackHeader)})),k.Positioned.with({key:"vscrollerTrack",right:0,top:this.rowHeights[0]*this.zoom}).fill((function(){return(0,ye.widget2State)(e.vscrollerTrack)})),k.Positioned.with({key:"scrollerTrackTail",right:-1,bottom:-1}).fill((function(){return(0,ye.widget2State)(e.scrollerTrackTail)}))]),k.Stack.with({key:"ScrollWidgetStack",skipSelfEvent:!0}).fill((function(){return[].concat((0,a.Z)(t),[Z.Ps3.getIsDocx()&&e.isEmbed?null:k.Positioned.with({key:"hscroll",top:e.hscrollOverHeight,left:e.colWidths[0]*e.zoom+(e.isEmbed?e.offsetX-e.sheetViewX:0)}).fill((function(){return(0,ye.widget2State)(e.hscroll)})),e.isEmbed?null:k.Positioned.with({key:"vscroll",right:0,top:e.rowHeights[0]*e.zoom}).fill((function(){return(0,ye.widget2State)(e.vscroll)}))])}))}}]),t}(k.FBaseWidget);hp([k.State],em.prototype,"key",void 0),hp([k.State],em.prototype,"hscrollerTrackHeader",void 0),hp([k.State],em.prototype,"hscrollerTrack",void 0),hp([k.State],em.prototype,"vscrollerTrackHeader",void 0),hp([k.State],em.prototype,"vscrollerTrack",void 0),hp([k.State],em.prototype,"scrollerTrackTail",void 0),hp([k.State],em.prototype,"vscroll",void 0),hp([k.State],em.prototype,"hscroll",void 0),hp([k.State],em.prototype,"hscrollOverHeight",void 0),hp([k.State],em.prototype,"sheetView",void 0),hp([k.State],em.prototype,"isEmbed",void 0),hp([k.State],em.prototype,"sheetViewX",void 0),hp([k.State],em.prototype,"colWidths",void 0),hp([k.State],em.prototype,"rowHeights",void 0),hp([k.State],em.prototype,"zoom",void 0),hp([k.State],em.prototype,"offsetX",void 0),hp([k.State],em.prototype,"width",void 0),hp([k.State],em.prototype,"height",void 0),hp([k.State],em.prototype,"skipSelfEvent",void 0);var tm,nm=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).key="EmbedBorder",e.ignore=!0,e.hideRowColHeaderEnable=!1,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=this;return this.hideRowColHeaderEnable?k.Stack.fill((function(){return[(0,ye.widget2State)(e.embedBorderWidget),(0,ye.widget2State)(e.embedCommentBorderWidget),(0,ye.widget2State)(e.embedHighLightContentBorderWidget),(0,ye.widget2State)(e.embedHighLightContentWidget)]})):k.Stack.fill((function(){return[(0,ye.widget2State)(e.embedBorderWidget),(0,ye.widget2State)(e.embedCommentBorderWidget)]}))}}]),t}(k.FBaseWidget);hp([k.State],nm.prototype,"key",void 0),hp([k.State],nm.prototype,"ignore",void 0),hp([k.State],nm.prototype,"embedBorderWidget",void 0),hp([k.State],nm.prototype,"embedCommentBorderWidget",void 0),hp([k.State],nm.prototype,"embedHighLightContentBorderWidget",void 0),hp([k.State],nm.prototype,"embedHighLightContentWidget",void 0),hp([k.State],nm.prototype,"hideRowColHeaderEnable",void 0),function(e){e[e.Create=0]="Create",e[e.Update=1]="Update",e[e.Delete=2]="Delete"}(tm||(tm={}));var rm=function(e){function t(e,n,r,i){var o;return(0,h.Z)(this,t),(o=(0,f.Z)(this,(0,p.Z)(t).call(this,kf.DragDropEvent,e))).target=e,o._status=n,o._point=r,o._horizontal=i,o}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"point",value:function(){return this._point}},{key:"status",value:function(){return this._status}},{key:"isRow",value:function(){return!1===this._horizontal}}]),t}(k.FEvent),im=function(e){function t(e,n,r,i,o,a){var s;return(0,h.Z)(this,t),(s=(0,f.Z)(this,(0,p.Z)(t).call(this,e,n,r,i,o))).horizontal=n,s.$shellWatcher=a.shellWatcher,s}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"mouseDown",value:function(e){var t,n=this._sheet;if(!n)return!1;if(2===e.buttons)return!1;if(this._isGrabbingRowOrCol())return k.ListenersControl.sendEvent(this._sheetView,new rm(this,0,e.globalPoint(),this.horizontal)),!1;this.setSelEditMode(zv(e.shiftKey,e.metaKey,e.ctrlKey));var r=this.selEditMode(),i=this._getHeaderType(e,n);if(1===r)t=0===i?new x.lq$(n._activeRowIndex,1,n):new x.rvb(n._activeColIndex,1,n);else if(2===r){var o;o=0===i?new x.lq$(0,1,n):new x.rvb(0,1,n),n.addSelection(o)}var a=e.globalPoint();return this.startSelAtPoint(a.x,a.y,{shiftKey:e.shiftKey,triggerFrom:"mouseDownEvent",preStart:t}),!0}},{key:"mouseMove",value:function(e){var t=e.globalPoint();return this._isGrabbingRowOrCol()?(this.updateByCfg({cursor:"grabbing"}),this.tryOverScroll(t.x,t.y),k.ListenersControl.sendEvent(this._sheetView,new rm(this,1,t,this.horizontal)),!1):(e.buttons!==k.FMouseButtons.None&&this.continueSelAtPoint(e.globalPoint().x,e.globalPoint().y,{shiftKey:e.shiftKey,triggerFrom:"mouseMoveEvent"}),!1)}},{key:"mouseUp",value:function(e){return this._sheetView.setMouseDownStatus(!1),this._isGrabbingRowOrCol()?(this.updateByCfg({cursor:"default"}),k.ListenersControl.sendEvent(this._sheetView,new rm(this,2,e.globalPoint(),this.horizontal)),this._sheetView.setDragDropStatus(!1),!1):(this.endSelAtPoint(e.globalPoint().x,e.globalPoint().y,{triggerFrom:"mouseUPEvent",shiftKey:e.shiftKey}),this.$shellWatcher.dispatch("HeaderScrollMouseUp"),!1)}},{key:"click",value:function(e){if(!this._sheet)return!1;var t=this._sheet,n=this.pointToVisibleRange(new k.FPoint(e.globalPoint().x,e.globalPoint().y)),r={sheet:t,sheetName:t.name(),row:n.rowFrom(),col:n.colFrom()};return this.$shellWatcher.dispatch("CellClicked",r),!1}},{key:"_isGrabbingRowOrCol",value:function(){return this._sheetView.getDragDropStatus()}},{key:"updateSelections",value:function(e){(0,l.Z)((0,p.Z)(t.prototype),"updateSelections",this).call(this,e)}},{key:"unselectFloatingObjects",value:function(){(0,l.Z)((0,p.Z)(t.prototype),"unselectFloatingObjects",this).call(this)}},{key:"reselectFloatingObjects",value:function(){(0,l.Z)((0,p.Z)(t.prototype),"reselectFloatingObjects",this).call(this)}},{key:"_getHeaderType",value:function(e,t){var n=e.target;return n instanceof Bv?n.type():1}}]),t}(Xv),om=Ff,am=2,sm="var(--text-title, 0.1)",um="var(--text-link-hover)",lm=10;function cm(e,t,n){switch(n.status()){case 0:!function(e,t,n){var r,i=n.point(),o=n.isRow(),a=e.sheet(),s=dm(e,i),u=n.target,l=e.zoom;if(null===a)return;var c=a.getSelections(),h=c[c.length-1],d=null===(r=e.sheet())||void 0===r?void 0:r.inject(U_),f=null==d?void 0:d.state,p=(null==f?void 0:f.rowGroupWidth)||0,v=(null==f?void 0:f.colGroupHeight)||0,g=0,_=0,y=0,m=0,E=p*l,b=v*l,T=0,C=0,S=am;if(t.dragStartPoint=i,o){for(var w=pm(u,s.row),R=e.getSheetViewVisWidth(),A=0;A<h.rowCount();A++)m+=a.getRowHeight(h.rowFrom()+A);for(var O=0,M=h.rowFrom();M<s.row;M++)O+=a.getRowHeight(M)*l;b=_=w-O,t.dragDrawPoint.y=_,g=E+e.getCornerRect().width,y=Math.max(0,p+R-g),T=R,C=S*l,m*=l}else{for(var I=fm(u,s.col),x=e.getSheetViewVisHeight(),N=0;N<h.colCount();N++)y+=a.getColumnWidth(h.colFrom()+N);for(var P=0,L=h.colFrom();L<s.col;L++)P+=a.getColumnWidth(L)*l;g=E=I-P,t.dragDrawPoint.x=g,_=b+e.getCornerRect().height,m=Math.max(0,v+x-_),C=x,T=S*l,y*=l}e.showRowColDragDrop=!0,t.area.updateByCfg({width:y,height:m,hidden:!1,background:sm,zindex:om}),e.dragDropWidgetsAreaPos=new k.FPoint(g,_),t.line.updateByCfg({width:T,height:C,hidden:!1,background:um,zindex:om});var D=lm*Math.sin(Math.PI/3);e.dragDropWidgetsAreaLinePos=new k.FPoint(E,b),e.dragDropIsRow=o,e.dragDropWidgetsAreaTrianglePos=o?new k.FPoint(E,b-D/2):new k.FPoint(E-D/2,b),t.triangle.updateByCfg({hidden:!1,type:o?0:1})}(e,t,n);break;case 1:!function(e,t,n){var r=n.point(),i=n.isRow(),o=e.sheet(),a=n.target;if(t.area.hidden||null===o)return;var s=t.dragStartPoint,u=t.dragDrawPoint,l=o.getSelections(),c=l[l.length-1],h=e.dragDropWidgetsAreaPos;e.dragDropWidgetsAreaPos=i?new k.FPoint(h.x,r.y-s.y+u.y):new k.FPoint(r.x-s.x+u.x,h.y);var d=lm*Math.sin(Math.PI/3),f=e.dragDropWidgetsAreaLinePos;if(e.dragDropIsRow=i,i){var p=dm(e,r).row,v=c.rowFrom(),g=c.rowTo();vm(e,p,g,"row");var _=0;_=pm(a,p<v?p:p>g?p+1:v),e.dragDropWidgetsAreaLinePos=new k.FPoint(f.x,_),e.dragDropWidgetsAreaTrianglePos=new k.FPoint(f.x,_-d/2)}else{var y=dm(e,r).col,m=c.colFrom(),E=c.colTo();vm(e,y,E,"col");var b=0;b=fm(a,y<m?y:y>E?y+1:m),e.dragDropWidgetsAreaLinePos=new k.FPoint(b,f.y),e.dragDropWidgetsAreaTrianglePos=new k.FPoint(b-d/2,f.y)}}(e,t,n);break;case 2:hm(e,t,n)}}function hm(e,t,n){if(e.showRowColDragDrop){e.showRowColDragDrop=!1;var r=e.sheet();if(null!==r){var i,o=r.getSelections(),a=o[o.length-1],s=n.isRow(),u=n.point();if(s){var l=dm(e,u).row;if(l<a.rowFrom())i=new x.lq$(l,a.rowCount(),r);else{if(!(l>a.rowTo()))return;i=new x.lq$(l+1,a.rowCount(),r)}}else{var h=dm(e,u).col;if(h<a.colFrom())i=new x.rvb(h,a.colCount(),r);else{if(!(h>a.colTo()))return;i=new x.rvb(h+1,a.colCount(),r)}}var d=r.getColumnCount(),f=r.getRowCount();if(!(i.rowFrom()>=f&&i.setRowFrom(f),i.colFrom()>=d&&i.setColFrom(d),a instanceof x.lq$&&a.rowTo()+1>=f&&i.rowFrom()+1>=f||a instanceof x.rvb&&a.colTo()+1>=d&&i.colFrom()+1>=d)){var p=function(e,t){var n,r=[],i=cc(e.getPivotTableManager().getPivotInfoMap());try{for(i.s();!(n=i.n()).done;){var o=(0,c.Z)(n.value,2),a=o[0],s=o[1],u=s.pageRange,l=s.contentRange,h=!1;if(u&&t.isIntersect(u)){if(!t.contain(u))return!1;h=!0}if(l&&t.isIntersect(l)){if(!t.contain(l))return!1;h=!0}h&&r.push(a)}}catch(e){i.e(e)}finally{i.f()}return r}(r,a),v=!p||function(e,t,n){var r,i=e.getPivotTableManager(),o=t.toJSON(),a=o.row,s=o.col,u=cc(i.getPivotInfoMap());try{for(u.s();!(r=u.n()).done;){var l,h,d,f,p=(0,c.Z)(r.value,2),v=p[0],g=p[1];if(null==n||!n.includes(v)){var _=g.pageRange,y=g.contentRange,m=(null!==(l=null==_?void 0:_.rowCount())&&void 0!==l?l:0)+(null!==(h=null==y?void 0:y.rowCount())&&void 0!==h?h:0)+(_&&y?1:0),E=Math.max(null!==(d=null==_?void 0:_.colCount())&&void 0!==d?d:0,null!==(f=null==y?void 0:y.colCount())&&void 0!==f?f:0);if(a>g.row&&a<g.row+m)return!0;if(s>g.col&&s<g.col+E)return!0}}}catch(e){u.e(e)}finally{u.f()}return!1}(r,i,p);if(p&&!v){if(p.length){var g=i.rowFrom()-a.rowFrom(),_=i.colFrom()-a.colFrom();g>0&&(g-=a.rowCount()),_>0&&(_-=a.colCount());var y,m=cc(p);try{for(m.s();!(y=m.n()).done;){var E=y.value;Z.Ps3.pivotTableHelper.movePivotTable(r,E,g,_,!1)}}catch(e){m.e(e)}finally{m.f()}}r.moveRowCol(a,i)}else Z.Ps3.Toast.warning({key:"toast-paste-in-pivot-area",content:lc("CreationDoc_Sheets_PivotTable_Failed_CanNotEditPivot")})}}}}function dm(e,t){return e.globalPoint2Cell(t)}function fm(e,t){var n=e.getSheetView();return n.getNotExpendCellRect(0,t).x-2*n.zoom-n.appModel.getSheetViewX()}function pm(e,t){var n=e.getSheetView();return n.getNotExpendCellRect(t,0).y-2*n.zoom-n.appModel.getSheetViewY()}function vm(e,t,n,r){var i=e.sheet();if(null!==i){var o=e.brTable().contentDoc();if("row"===r){var a=i.frozenRowCount();n<a&&t>=a&&0!==o.posY&&o.updateByCfg({posY:0}),n>=a&&t<a&&0!==o.posY&&o.updateByCfg({posY:0})}else{var s=i.frozenColumnCount();n<s&&t>=s&&0!==o.posX&&o.updateByCfg({posX:0}),n>=s&&t<s&&0!==o.posX&&o.updateByCfg({posX:0})}}}var gm=1e3;function _m(e){var t=e.doc,n=e.tableView,r=e.ignoreCellOverflow,i=new u_(t,n,void 0!==r&&r);return i.registerRenderProvider("dataValidate",function(e){var t=e.getViewModel;return{cellDataIterCreator:function(e,n,r,i,o){var a=t();return a.sheet.cellModel.iterVisibleDataValidation(e,n,r,i,o.iterCtx).map((function(e){var t=(0,c.Z)(e,2),n=t[0],r=t[1],i=r.row,o=r.col,s=function(e,t,n,r){if(!(0,x.TuQ)(e.sheet,n,r))return"checkbox"===t.type?function(e,t,n,r){var i,o=e.cache.getDVResult(t,n,r),a=e.sheet,s=null===(i=o.getSpecialInfo())||void 0===i?void 0:i.checkboxInfo;if(!s)return null;if(s.visible){var u=s.checked,l=!a.options.isProtected&&!!a.protectionModel.getRangePermissions([new x.e6w(t,n,1,1,a)]).hasPermission&&!a.getVar(t,n).isFormula();return{priority:gm,type:$g,props:{disabled:!l,checked:u,onClick:function(){var e=(0,c.Z)(r.formulas,2),i=e[0],o=e[1],s=a._commandManager();if(i&&s&&l){var h=u?o:i;Z.Ps3.collectSuiteEvent("sheet_opration",{action:"edit_valid_value",valid_type:"checkbox",op_item:u?"uncheck":"check"}),Z.Ps3.ccmEventTracking&&(Z.Ps3.ccmEventTracking("ccm_sheet_content_page_click",Object.assign({},(0,Z.dK5)(),{click:"click_checkbox",target:"none",sub_click:u?"uncheck":"check"})),(0,x.rMO)(r,t,n,"click_checkbox")),a.setCellValue(t,n,String(h))}return!1}}}}}(e,n,r,t):void 0}(a,n,i,o);if(s)return[s,r]}))}}}({getViewModel:e.getViewModel})),i}var ym=new Set,mm=new Map,Em=function(e,t,n,r){if((0,N.isShortCut)()||!e)return!0;var i,o=t.getService(H.Qh).checkAttachment(e,{onPermissionFetched:r,onDlpCheckFinished:function(e){"attachment_not_sensitive"===e.result&&ym.add(e.attachmentToken)}});return"preview"===n?{renderPermission:o.previewable&&1!==i,previewResultCode:i=o.previewResultCode}:"export"===n?o.exportable?Boolean(o.previewable):o.exportable:"print"===n&&(o.printable?Boolean(o.previewable):o.printable)},bm=function(e,t,n){var r,i=Kf.injectableStaticConfig.image.isFetchImage,o=t(e,n._context.getToken(),i),a=null!==(r=n._imageWorker)&&void 0!==r&&r.isImageWorkerEffective?(0,x.EIf)(o):o;return a=Sm(a,e)},Tm=function(e,t,n,r){var i=e.fileToken,o=e.link,a=!i||n?o:bm(i,Z.Ps3.imageHelper.getDriveImageUrl,t),s=function(e,t){if(!t)return new I.FDomImage(e,"use-credentials");var n=mm.get(e);if(n)return new I.FDomImage(n,"use-credentials");Z.Ps3.opendoc.getBlobImageUrl(e).then((function(t){return mm.set(e,t)}))}(a=Sm(a,i),n);if(t._imageWorker){var u=a.replace("bdDriveImg://","https://");t._imageWorker.prioritize(u,r)}return s},Cm=function(e,t){return!(e||t!==H.j6.CHECKING&&t!==H.j6.DELETED)},Sm=function(e,t){if(t&&ym.has(t)){var n=new URL(e);return n.searchParams.append("dlp_checked","true"),n.toString().replace(/^bddriveimg:\/\//,"bdDriveImg://")}return e},wm=function(e){function t(e,n){var r;return(0,h.Z)(this,t),(r=(0,f.Z)(this,(0,p.Z)(t).call(this,e,null)))._tableView=n,r._ids=new Set,r._dataInfo=new Map,r.toggleEntitesHidden=function(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=null===(e=r._tableView.floatImage)||void 0===e?void 0:e.rnds;Array.isArray(n)&&n.forEach((function(e){var n;e.updateByCfg({hidden:t}),null===(n=e.content())||void 0===n||n.updateByCfg({hidden:t})}))},r.updateResizeDragWhenMoveEnd=function(){var e,t=null===(e=r._tableView.floatImage)||void 0===e?void 0:e.rnds;Array.isArray(t)&&t.forEach((function(e){var t=new k.FPoint(e.x,e.y);r._tableView.mapFromParent(t),r._tableView.viewPos2Doc(t),e.content()&&r._tableView.floatImage&&(e.content().setParent(r._tableView.floatImage.content.doc),e.setParent(r._tableView.floatImage.content.doc),e.updateByCfg({x:t.x,y:t.y}))}))},r.updateImageRender=function(e){var t,n=null===(t=r._tableView.floatImage)||void 0===t?void 0:t.rnds;if(Array.isArray(n)){var i=e.dw,o=e.dh,a=e.dx,s=e.dy;n.forEach((function(e){var t=e.content();1===n.length&&i&&o&&(null==t?void 0:t.width)&&(null==t?void 0:t.height)&&(o=i<o?o:i*t.height/t.width,i=o<i?i:o*t.width/t.height);var r={x:e.x+a,y:e.y+s,width:e.width+i,height:e.height+o};e.validateCfg(r)&&e.updateByCfg(r)}))}},r.throttleForceUpdateSheetView=(0,C.default)((function(){r._getSheetView().forceUpdate()}),200,{trailing:!1}),r}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"updateContentData",value:function(){var e=this,t=this._tableView.sheet(),n=t.id(),r=this._tableView.floatImage.rnds,i=(0,T.Z)(r.map((function(r){if(!r.content())return null;var i=r.content(),o=ay(t,e._getSheetView(),i),a=o.row,s=o.col,u=o.x,l=o.y,c=o.width,h=o.height;return{sheetId:n,floatImageId:r.contentId(),floatImageSetting:{row:a,col:s,x:u<0?0:u,y:l<0?0:l,width:c,height:h,zIndex:i.getZindex(),imageToken:i.token()}}})));t.setFloatImage(i)}},{key:"updateViewRect",value:function(e,t,n,r){var a=this,s=this._tableView.sheet().parent,l=this._measure.toRow(),c=this._measure.toCol();(l<0||c<0)&&(e=e.clone()).reset();var h=this._findIntersect(e),d=this._getSheet().getFloatImageMap(),f=[];h.forEach((function(e){a._ids.has(e)||f.push(e)})),f.forEach((function(e){var t=a._dataInfo.get(e);t&&(t.destroy(),a._dataInfo.delete(e));var r,l,c=d[e].floatImageSetting,h=c.x,f=c.y,p=c.row,v=c.col,g=c.width,_=c.height,y=c.zIndex,m=c.imageToken,E=new py(n,e,m,a._tableView),b=a._tableView.cell2ViewPos({row:p,col:v}).move(h,f),T=a._tableView.viewPos2Doc(b),C=Em(m,s,a._tableView.renderEnv,a.throttleForceUpdateSheetView);"object"==(0,u.Z)(C)?(r=C.renderPermission,l=C.previewResultCode):r=C;var S=void 0===r?"":r?bm(m,Z.Ps3.imageHelper.getDriveOriginalImageUrl,s):Z.Ps3.getNoPermissionPlaceHolderImgUrl(a._tableView.renderEnv,l),w=r?"use-credentials":"anonymous";if(E.updateByCfg({x:T.x,y:T.y,width:g,height:_,imgUrl:S,zindex:y,crossOrigin:w}),S&&s._imageWorker){var R=S.replace("bdDriveImg://","https://");s._imageWorker.prioritize(R,{row:p,col:v})}E.setZindex(y),E.updateDisableStatus(!a.editable),E.setPreviewable(!!r),E.onError((0,o.Z)(i().mark((function e(){var t,n,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.getService(H.Qh).getAttachmentCheckResult(m);case 2:t=e.sent,n=t.previewable,r=t.previewResultCode,Cm(n,r)&&a.throttleForceUpdateSheetView();case 6:case"end":return e.stop()}}),e)})))),a.updateImageEditableStatus(E,e),a._dataInfo.set(e,E)}));var p=[];this._ids.forEach((function(e){h.has(e)||p.push(e)})),p.forEach((function(e){var t=a._dataInfo.get(e);t&&(t.exitEdit(),t.isReady()?t.destroy():t.onLoaded((function(){t.destroy()}))),a._dataInfo.delete(e)}));var v=[];this._ids.forEach((function(e){h.has(e)&&v.push(e)})),v.forEach((function(e){var t=d[e].floatImageSetting,n=t.x,r=t.y,i=t.row,o=t.col,l=t.width,c=t.height,h=t.imageToken,f=a._dataInfo.get(e);if(f){var p,v,g=a._tableView.cell2ViewPos({row:i,col:o}).move(n,r),_=a._tableView.viewPos2Doc(g),y=Em(h,s,a._tableView.renderEnv,a.throttleForceUpdateSheetView);"object"==(0,u.Z)(y)?(p=y.renderPermission,v=y.previewResultCode):p=y;var m=void 0===p?"":p?bm(h,Z.Ps3.imageHelper.getDriveOriginalImageUrl,s):Z.Ps3.getNoPermissionPlaceHolderImgUrl(a._tableView.renderEnv,v),E=p?"use-credentials":"anonymous";if(f.updateByCfg({x:_.x,y:_.y,width:l,height:c,imgUrl:m,crossOrigin:E}),m&&s._imageWorker){var b=m.replace("bdDriveImg://","https://");s._imageWorker.prioritize(b,{row:i,col:o})}f.updateDisableStatus(!a.editable),f.setPreviewable(!!p),a.updateImageEditableStatus(f,e)}})),this._ids=h}},{key:"updateImageEditableStatus",value:function(e,t){this.activeIds.some((function(e){return t===e}))?e.enterEdit():e.isActive()&&e.exitEdit()}},{key:"getImageById",value:function(e){return this._dataInfo.get(e)}},{key:"getImages",value:function(){return this._dataInfo}},{key:"reset",value:function(){this._ids.clear(),this._dataInfo.forEach((function(e){e.destroy()})),this._dataInfo.clear()}},{key:"imageLoaded",value:function(){var e=this.getUnReadyImages();return 0===e.length?Promise.resolve(!0):new Promise((function(t){var n=e.length;e.forEach((function(e){e.onLoaded((function(){0===--n&&setTimeout((function(){return t(!0)}),100)}))}))}))}},{key:"getUnReadyImages",value:function(){var e=[];return this.getImages().forEach((function(t){t&&!t.isReady()&&e.push(t)})),e}},{key:"_getSheetView",value:function(){return this._tableView.getSheetView()}},{key:"_getSheet",value:function(){return this._tableView.sheet()}},{key:"destroy",value:function(){(0,l.Z)((0,p.Z)(t.prototype),"destroy",this).call(this),this._dataInfo.forEach((function(e){return e.destroy()})),this._dataInfo.clear(),this._ids.clear()}},{key:"_findIntersect",value:function(e){var t=this,n=this._getSheet().getFloatImageMap(),r=this._getSheet().floatImageModel.activeFloatImageIds,i=this._getSheet().filterModel.getAllFilteredOutRows(),o=new Set;return Object.keys(n).forEach((function(a){var s=n[a].floatImageSetting,u=s.x,l=s.y,c=s.row,h=s.col,d=s.width,f=s.height;if(!i.has(c)){var p=t._tableView.cell2ViewPos({row:c,col:h}).move(u,l),v=t._tableView.viewPos2Doc(p),g=new k.FRect(v.x,v.y,d,f);(e.intersect(g)||e.containRect(g)||r.includes(a))&&o.add(a)}})),o}},{key:"activeIds",get:function(){return this._getSheet().floatImageModel.activeFloatImageIds}},{key:"editable",get:function(){var e=this._getSheetView();if(!Kf.injectableStaticConfig.floatImage.editable)return!1;var t=this._getSheet();return(!e||!e.viewModel.getIsDocumentReadonly())&&t.parent.permissionManager.hasPermission(t.id())}}]),t}(I.FLayer),Rm=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).rect=new k.FRect(0),e.cover=new k.FRect(0),e.borderWidth=0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"paintSelf",value:function(e){var t=this.cover,n=this.rect.sub(t),r=e.fillType;e.save(),e.fillStyle=(0,k.convertThemeColor)(this,(0,U.getCurrentThemeType)()===U.ThemeType.LIGHT?kh:"var(--B500-FG, 0.3)"),e.fillType=k.ColorThemeType.Color,n.forEach((function(t,n){t.width>2&&t.height>2&&(e.beginPath(),e.rect(t.x,t.y,t.width,t.height),e.fill())})),e.restore(),e.fillType=r}}]),t}(k.FBaseWidget);hp([k.State],Rm.prototype,"rect",void 0),hp([k.State],Rm.prototype,"cover",void 0),hp([k.State],Rm.prototype,"borderWidth",void 0);var Am=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).width=0,e.height=0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=this.width,t=this.height,n=this.border;return k.SizedBox.with({width:e,height:t}).fill((function(){return k.BorderBox.with({border:n})}))}}]),t}(k.FBaseWidget);hp([k.State],Am.prototype,"border",void 0),hp([k.State],Am.prototype,"width",void 0),hp([k.State],Am.prototype,"height",void 0);var Om=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).width=0,e.height=0,e.borderWidth=1,e.drawActiveRect=!1,e.draggable=!0,e.cursor="default",e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=this,t=this.borderWidth,n=this.width,r=this.height,i=this.coverRect,o=this.activeRect,a={color:Bc,width:t};return k.Stack.with({onDragStart:function(t){return e.onDragStart(t)}}).fill((function(){return[k.SizedBox.with({width:n,height:r}).fill((function(){return k.BorderBox.with({border:a})})),Rm.with({cover:i,rect:o,borderWidth:t})]}))}},{key:"mouseDown",value:function(e){return Im(new k.FPoint(e.x,e.y),new k.FRect(e.target.pos.x,e.target.pos.y,e.target.size.width,e.target.size.height))}},{key:"mouseMove",value:function(e){if(!this.selectionController.sheetView)return!1;var t=Im(new k.FPoint(e.x,e.y),new k.FRect(e.target.pos.x,e.target.pos.y,e.target.size.width,e.target.size.height));return this.selectionController.sheetView.viewModel.getEditable()&&!this.selectionController.sheet.tabType.isConnectorTab()&&t?(this.cursor="grab",this.draggable=!0):this.cursor="default",!1}},{key:"mouseUp",value:function(e){return this.draggable=!1,!1}},{key:"createDragDefaultImage",value:function(){return this.dragDefaultImage||(this.dragDefaultImage=new Image,this.dragDefaultImage.style.opacity="0",this.dragDefaultImage.style.height="1px",this.dragDefaultImage.style.width="1px",document.body.appendChild(this.dragDefaultImage)),this.dragDefaultImage}},{key:"dragStart",value:function(e){var t,n,r,i=e.dataTransfer;i&&(i.setData("sheet/cell-value",""),i.setDragImage(this.createDragDefaultImage(),10,10)),null===(t=this.selectionController.sheetView)||void 0===t||t.shellWatcher.dispatch("NormalSelectionDragStart");var o=new k.FPoint(e.globalPoint().x,e.globalPoint().y),a=null===(n=this.selectionController.sheetView)||void 0===n?void 0:n.globalPoint2VisibleCell(o);return null!==(r=this.selectionController.sheetView)&&void 0!==r&&r.setDropStartCell(a),this.selectionController.scrollStart(e.globalPoint().x,e.globalPoint().y),!1}},{key:"dragEvent",value:function(e){var t,n,r=!!Z.Ps3.browser.isSafari||e.buttons!==k.FMouseButtons.None,i=null===(t=this.selectionController.sheetView)||void 0===t||null===(n=t.getCanvasBoundingClientRect())||void 0===n?void 0:n.top;if(this.selectionController._scrollHelper&&r&&!function(e,t){return!!t&&(e.x<0||e.y<=-t||e.x>window.innerWidth||e.y>window.innerHeight-t)}(e.globalPoint(),i)){var o=e.globalPoint();this.selectionController._scrollHelper.continueSel(o.x,o.y,{shiftKey:e.shiftKey,triggerFrom:"dragEvent"})}return!1}},{key:"dragEnd",value:function(e){this.selectionController.destroyScroll(e.x,e.y);var t=this.selectionController.sheetView;return null!==t&&t.removeDropAnchor(),!1}},{key:"onDragStart",value:function(e){return!1}}]),t}(k.FBaseWidget);hp([k.State],Om.prototype,"rg",void 0),hp([k.State],Om.prototype,"acRg",void 0),hp([k.State],Om.prototype,"width",void 0),hp([k.State],Om.prototype,"height",void 0),hp([k.State],Om.prototype,"borderWidth",void 0),hp([k.State],Om.prototype,"coverRect",void 0),hp([k.State],Om.prototype,"activeRect",void 0),hp([k.State],Om.prototype,"acCellRect",void 0),hp([k.State],Om.prototype,"drawActiveRect",void 0),hp([k.State],Om.prototype,"draggable",void 0),hp([k.State],Om.prototype,"selectionController",void 0),hp([k.State],Om.prototype,"cursor",void 0),hp([k.State],Om.prototype,"dragDefaultImage",void 0);var Mm=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).hidden=!1,e.rgs=[],e.view=null,e.rects=[],e.selectionController=null,e.ignore=!0,e.activeRange=null,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=this;if(!1===this.hidden&&this.view&&this.selectionController){var t=!1,n=new k.FRect;return k.Stack.with({clip:!1}).fill((function(){var r=e.rgs.map((function(r,i){var o=e.activeRange,a=1,s=1,u=1;1===e.rgs.length&&(u=s=2,a=e.getUIConfig().selection.normalSelectionBorderWidth);var l=nv(e.view,r,s,u),c=l.x,h=l.y,d=l.width,f=l.height;e.rects.push(new k.FRect(c,h,d,f));var p=nv(e.view,o,s,u);p.move(-c,-h),p.move(a,a),p.width=p.width-2*a,p.height=p.height-2*a,t=0!==i&&i===e.rgs.length-1,n=nv(e.view,o,1,1);var v=new k.FRect(a,a,d-2*a,f-2*a),g="NormalSelection_".concat(i);return k.Positioned.with({left:c,top:h,key:g}).fill((function(){return Om.with({key:g,rg:r,acRg:o,borderWidth:a,width:d,height:f,coverRect:p,activeRect:v,acCellRect:n,drawActiveRect:t,selectionController:e.selectionController,ignore:e.ignore})}))}));if(t){var i=n,o=i.width,a=i.height,s="NormalSelectionAc_"+(e.rgs.length-1);r.push(k.Positioned.with({key:s,left:n.x,top:n.y}).fill((function(){return tv.with({width:o,height:a,border:{width:2,color:Bc}})})))}return r}))}return null}},{key:"getUIConfig",value:function(){return Kf.injectableStaticConfig}}]),t}(k.FBaseWidget);hp([k.State],Mm.prototype,"hidden",void 0),hp([k.State],Mm.prototype,"rgs",void 0),hp([k.State],Mm.prototype,"view",void 0),hp([k.State],Mm.prototype,"rects",void 0),hp([k.State],Mm.prototype,"selectionController",void 0),hp([k.State],Mm.prototype,"ignore",void 0),hp([k.State],Mm.prototype,"activeRange",void 0);var km=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).rg=null,e.view=null,e.ignore=!0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){if(this.rg&&this.view){var e=nv(this.view,this.rg,1,1,ev.dashLine),t=e.x,n=e.y,r=e.width,i=e.height,o=Ih.width,a=Ih.color,s=Object.assign({},ev,{color:a,width:o});return k.Stack.fill((function(){return[k.Positioned.with({left:t,top:n,key:"DropAnchorSelection"}).fill((function(){return Am.with({width:r,height:i,border:s})}))]}))}return null}}]),t}(k.FBaseWidget);function Im(e,t){var n=t.width,r=t.height,i=new k.FRect(0,0,n,r),o=new k.FRect(8,8,n-15,r-15);return!(!i.containPoint(e)||o.containPoint(e))}hp([k.State],km.prototype,"rg",void 0),hp([k.State],km.prototype,"view",void 0),hp([k.State],km.prototype,"ignore",void 0);var xm=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).hidden=!1,e.rgs=[],e.view=null,e.ignore=!0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"describe",value:function(){var e=this;if(!1===this.hidden&&this.view){var t=Td;return k.Stack.fill((function(){return e.rgs.map((function(n,r){var i=nv(e.view,n,0,0,t.dashLine),o=i.x,a=i.y,s=i.width,u=i.height;return k.Positioned.with({left:o,top:a,key:"PasteSelection".concat(r)}).fill((function(){return k.Stack.fill((function(){return[k.SizedBox.with({width:s,height:u}).fill((function(){return k.BorderBox.with({border:t})}))]}))}))}))}))}return null}}]),t}(k.FBaseWidget);hp([k.State],xm.prototype,"hidden",void 0),hp([k.State],xm.prototype,"rgs",void 0),hp([k.State],xm.prototype,"view",void 0),hp([k.State],xm.prototype,"ignore",void 0);var Nm,Pm=function(){function e(t,n,r){(0,h.Z)(this,e),this.tableView=t,this.sheetView=n,this._sheet=r,this._fillHandler=new my(this.tableView,this._sheet)}return(0,d.Z)(e,[{key:"scrollStart",value:function(e,t){var n=this;if(!this._scrollHelper){var r=this.tableView;this._scrollHelper=new jv(r.contentDoc(),r.getSheetView(),!0,(function(e,t,r){var i=n.sheetView;null!==i&&i.syncDropAnchor(r)}))}this._scrollHelper.start(e,t)}},{key:"destroyScroll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._scrollHelper&&(this._scrollHelper.end(e,t),this._scrollHelper=null)}},{key:"getActiveSelectedRange",value:function(){return this._sheet._getActiveSelectedRange()}},{key:"isCurrentSelectionIntersectPivotTable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getActiveSelectedRange();return(0,x.MUL)(this._sheet,e.rowFrom(),e.colFrom(),e.rowCount(),e.colCount())}},{key:"executeFill",value:function(e,t,n,r,i,o){var a,s;Tf.trigger(vc.LOG.EDIT_CELL_CONTENT,[vc.LOG.EDIT_CELL_CONTENT,this.tableView,{action:"auto_fill"}]),Tf.trigger(vc.SHEET_OPRATION,[vc.SHEET_OPRATION,this.tableView,{action:"auto_fill",source:"body",eventType:"click",op_item:o,object_id:this._sheet.id()}]),t=this._fixFillRange(e,t);var u=this._getDragAutoFillType(n,r,i);null!==(a=this._sheet._commandManager())&&void 0!==a&&a.execute({cmd:Z.rvF.FILL,sheetId:this._sheet.id(),startRange:e,fillRange:t,autoFillType:u,fillDirection:r}),this._sheet.setSelection(n),this._showDragFillSmartTag(u,e,t,r);var l=n,c=l.rowCount(),h=l.colCount(),d=this._sheet.getRowCount(),f=this._sheet.getColumnCount(),p=1===c&&h===f,v=1===h&&c===d;null===(s=Z.Ps3.collectSheetEvent)||void 0===s||s.call(Z.Ps3,"ccm_sheet_content_page_click",{click:"fill_cell",target:"none",toward:p?"row":v?"col":"area"})}},{key:"_getDragAutoFillType",value:function(e,t,n){var r=this._sheet.parent.options.defaultDragFillType,i=this._sheet._getActiveSelectedRange();return i.contain(e)&&2===t?4:5!==r?r:1!==i.rowCount()||1!==i.colCount()||i instanceof x.rvb||i instanceof x.lq$?n?0:1:n?1:0}},{key:"_showDragFillSmartTag",value:function(e,t,n,r){var i,o,a,s=this._sheet,u=this._sheet._getActiveSelectedRange(),l=u.rowTo(),c=u.colTo();if(this.sheetView){var h=this.sheetView.detectTableByCell(l,c),d=h.cell2ViewPos({row:l,col:c}),f={x:(d=h.mapToGlobal(d)).x,y:d.y,fillType:e,startRange:t,fillRange:n,fillDirection:r},p=x.deh._FillDialog,v=null===(i=s.parent.options._ps)||void 0===i?void 0:i.getHost(s.id());p&&(s._fillDialog=new p(v,s,f,h,null===(o=s.parent.options._ps)||void 0===o?void 0:o.setFocus,null===(a=s.parent.options._ps)||void 0===a?void 0:a.resetFocus),s._fillDialog._open())}}},{key:"_fixFillRange",value:function(e,t){var n=this._sheet,r=new x.e6w(t.rowFrom(),t.colFrom(),t.rowCount(),t.colCount(),n);if(n._getSpanModel().find(e.rowFrom(),e.colFrom())){if(0!==Math.floor(r.rowCount()%e.rowCount())){var i=Math.ceil(r.rowCount()/e.rowCount())*e.rowCount();r.rowFrom()+i<=n.getRowCount()&&r.setRowCount(i)}if(0!==Math.floor(r.colCount()%e.colCount())){var o=Math.ceil(r.colCount()/e.colCount())*e.colCount();r.colFrom()+o<=n.getColumnCount()&&r.setColCount(o)}}return r}},{key:"_fillTipContent",value:function(e,t){var n=this._sheet,r=this._sheet._getActiveSelectedRange(),i=this._fillHandler.direction();if(null==i)return null;var o=this._getDragAutoFillType(e,i,t);if(1===o){var a;a=0===i||1===i?1:0;var s=this.clipFillRange(e,i);if(this._validateFillRange(r,s)){var u=new x.$3z(n).fillAuto(e,r,a,!0),l=this._getAvailableRange(i,e,r),c=l.rowFrom(),h=l.colFrom(),d=n.getReminder(c,h);if(u instanceof x.b5y)return n.getText(c,h);var f=null,p=n.getActualStyle(c,h);if(f=d?n.getReminderFormatter(c,h):p.formatter||p.autoFormatter||null,u instanceof Date){var v=this.sheet.formatterService.i18n.getDateTimeFormat().shortDatePattern;f=(0,wl.createFormatter)(this.sheet.formatterService,v+" hh:mm:ss AM/PM;@")}return function(e,t,n){return(0,x.lep)(e)||""===e?"":!t&&n?(0,wl.getPreferredFormatter)(n.formatterService,e).formatter.format(e).toString():t instanceof wl.Formatter?t.format(e):(console.error("celldata.ts format method param is not XFormatter"),e.toString())}(u,f,n)}return null}if(0===o){var g=this._getAvailableRange(i,e,r);return n.getFormula(g.rowFrom(),g.colFrom())?null:n.getText(g.rowFrom(),g.colFrom())}return null}},{key:"showTooltip",value:function(e,t){var n=this._fillHandler.direction();if(null!==n){var r=this._sheet._getActiveSelectedRange();if(!(4===this._getDragAutoFillType(e,n,t)||r instanceof x.rvb||r instanceof x.lq$)){var i,o=e.rowFrom()+e.rowCount(),a=e.colFrom()+e.colCount(),s=this._fillTipContent(e,t);if(null!==s)return 0===n?a=e.colFrom():2===n&&(o=e.rowFrom()),void(null===(i=this.sheetView)||void 0===i||i.showTooltip(this.tableView,o,a,s))}}this.removeTooltip()}},{key:"removeTooltip",value:function(){var e;null===(e=this.sheetView)||void 0===e||e.removeTooltip()}},{key:"_validateFillRange",value:function(e,t,n){function r(e,t,n,r,i){for(var o=0;o<n.rowCount();o++){for(var a=0;a<n.colCount();a++){var s=e.getSpan(n.rowFrom()+o,n.colFrom()+a);if(!s||s.rowCount()!==t.rowCount()||s.colCount()!==t.colCount())return!1;r&&(a+=t.colCount())}i&&(o+=t.rowCount())}return!0}var i=this._sheet,o=!0,a=2,s="";return i._getSpanModel().hasSpans(t.rowFrom(),t.colFrom(),t.rowCount(),t.colCount())&&!function(e,t,n){var i=t.rowFrom()===n.rowFrom()&&t.rowCount()===n.rowCount(),o=t.colFrom()===n.colFrom()&&t.colCount()===n.colCount();if(!i&&!o)return!1;var a=e.getSpan(t.rowFrom(),t.colFrom());return!(!a||!r(e,a,t,i,o))&&(!e._getSpanModel().hasPartSpans(n.rowFrom(),n.colFrom(),n.rowCount(),n.colCount())&&!(0,x.MUL)(e,n.rowFrom(),n.colFrom(),n.rowCount(),n.colCount())&&r(e,a,n,i,o))}(i,e,t)&&(o=!1,s=lc("CreationDoc_Sheets_ContainsMergedCell")),o&&i.options.isProtected&&i._isAnyCellInRangeLocked(t)&&(o=!1,s=lc("CreationDoc_Sheets_CellIsProtected")),i.checkRangesProtected(t)&&(o=!1,a=8,s="drag_fill"),o&&(0,x.MUL)(i,t.rowFrom(),t.colFrom(),t.rowCount(),t.colCount())&&(o=!1,a=10),n&&!o&&i._raiseInvalidOperation(a,s),o}},{key:"_getAvailableRange",value:function(e,t,n){var r=n.rowFrom(),i=n.colFrom(),o=n.rowCount(),a=n.colCount(),s=new x.e6w(r,i,1,1,this._sheet);if(3===e){var u=t.rowCount()%o;u=0===u?r+o-1:r+u-1,s.setRowFrom(u),s.setColFrom(i)}else if(1===e){var l=t.colCount()%a;l=0===l?i+a-1:i+l-1,s.setRowFrom(r),s.setColFrom(l)}else if(0===e){var c=t.colCount()%a;c=0===c?i:i+a-c,s.setRowFrom(r),s.setColFrom(c)}else if(2===e){var h=t.rowCount()%o;h=0===h?r:r+o-h,s.setRowFrom(h),s.setColFrom(i)}return s}},{key:"validateFillRange",value:function(e,t,n){function r(e,t,n,r,i){for(var o=0;o<n.rowCount();o++){for(var a=0;a<n.colCount();a++){var s=e.getSpan(n.rowFrom()+o,n.colFrom()+a);if(!s||s.rowCount()!==t.rowCount()||s.colCount()!==t.colCount())return!1;r&&(a+=t.colCount())}i&&(o+=t.rowCount())}return!0}var i=this._sheet,o=!0,a=2,s="";return i._getSpanModel().hasSpans(t.rowFrom(),t.colFrom(),t.rowCount(),t.colCount())&&!function(e,t,n){var i=t.rowFrom()===n.rowFrom()&&t.rowCount()===n.rowCount(),o=t.colFrom()===n.colFrom()&&t.colCount()===n.colCount();if(!i&&!o)return!1;var a=e.getSpan(t.rowFrom(),t.colFrom());return!(!a||!r(e,a,t,i,o))&&(!e._getSpanModel().hasPartSpans(n.rowFrom(),n.colFrom(),n.rowCount(),n.colCount())&&!(0,x.MUL)(e,n.rowFrom(),n.colFrom(),n.rowCount(),n.colCount())&&r(e,a,n,i,o))}(i,e,t)&&(o=!1,s=lc("CreationDoc_Sheets_ContainsMergedCell")),o&&i.options.isProtected&&i._isAnyCellInRangeLocked(t)&&(o=!1,s=lc("CreationDoc_Sheets_CellIsProtected")),o&&(0,x.MUL)(i,t.rowFrom(),t.colFrom(),t.rowCount(),t.colCount())&&(o=!1,a=10),i.checkRangesProtected(t)&&(o=!1,a=8,s="drag_fill"),n&&!o&&i._raiseInvalidOperation(a,s),o}},{key:"clipFillRange",value:function(e,t){var n=e.clone(),r=this._sheet._getActiveSelectedRange();if(!r.contain(n))switch(t){case 2:n.setRowCount(n.rowCount(!0)-r.rowCount());break;case 3:n.setRowFrom(n.rowFrom()+r.rowCount()),n.setRowCount(n.rowCount(!0)-r.rowCount());break;case 0:n.setColCount(n.colCount(!0)-r.colCount());break;case 1:n.setColFrom(n.colFrom()+r.colCount()),n.setColCount(n.colCount(!0)-r.colCount())}return n}},{key:"sheet",get:function(){return this._sheet},set:function(e){this._sheet=e,this._fillHandler&&this._fillHandler.updateSheet(e)}}]),e}(),Lm=function(e){function t(e,n,r){var i;return(0,h.Z)(this,t),(i=(0,f.Z)(this,(0,p.Z)(t).call(this))).selectionRenderers=[],i.normalRanges=[],i.activeRange=null,i.normalIgnore=!0,i.normalHidden=!1,i.formulaRanges=[],i.progressPercent=0,i.pasteRanges=[],i.pasteHidden=!1,i.conditionFormatRanges=[],i.conditionFormatHidden=!1,i.aiHighlightArea=[],i.conditionHighLightRanges=[],i.chartRanges=[],i.floatBlocksRanges=[],i.painterRanges=[],i.importRangeRanges=[],i.enableDrag=!1,i.posXBuffer=0,i.posYBuffer=0,i.skipSelfEvent=!0,i.protectHighlightRanges=[],i.pivotTableHighlightRanges=[],i.pivotTableHighlightType=0,i.sparklineSourceRanges=[],i.sparklineGroupRanges=[],i.selectionType=1,i.viewPos=new k.FPoint(0,0),i.rects=[],i.view=e,i.sheet=r,i.sheetView=n,i.selectionController=new Pm(i.view,i.sheetView,i.sheet),i.cornerWidgetType=Kf.injectableStaticConfig.selection.cornerWidgetType,i}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"registerSelectionRenderer",value:function(e){this.selectionRenderers.push(e)}},{key:"destroy",value:function(){this.selectionRenderers=[],(0,l.Z)((0,p.Z)(t.prototype),"destroy",this).call(this)}},{key:"renderTree",value:function(e,t){e.save();var n=this.pos;e.translate(n.x,n.y),t&&t.move(-n.x,-n.y),this.children().length>0?(this.paintSelf(e),this.renderChildren(e)):this.paintSelf(e),e.translate(-n.x,-n.y),e.restore()}},{key:"paintSelf",value:function(e){var t=this.isScrollXAtBegin(),n=this.isScrollYAtBegin(),r=this.isScrollXAtEnd()?4:t?2:0,i=this.isScrollAtEdgeY()?4:n?2:0,o=new k.FRect(t?-2:0,n?-2:0,this.size.width+r,this.size.height+i);e.rect(o.x,o.y,o.width,o.height),e.clip()}},{key:"isScrollXAtBegin",value:function(){return 0===this.view.contentDoc().posX}},{key:"isScrollXAtEnd",value:function(){var e=this.view.contentDoc();return e.posX===e.maxPosX}},{key:"isScrollYAtBegin",value:function(){return 0===this.view.contentDoc().posY}},{key:"isScrollAtEdgeY",value:function(){var e=this.view.contentDoc();return 0===e.posY||e.posY===e.maxPosY}},{key:"describe",value:function(){var e=this;if(!this.sheetView)return null;var t=this.sheetView;this.selectionController.sheetView=t,this.selectionController.sheet=this.sheet,this.rects.length=0;var n=this.view,r=[],i=[];this.selectionRenderers.forEach((function(e){e.zIndex===fv.HIGH?i.push(e):r.push(e)}));var o=r.map((function(e){return e.render(n)})).flat(),s=i.map((function(e){return e.render(n)})).flat();return k.Stack.with({clip:!1}).fill((function(){if(t.invisible)return[];var r=[].concat((0,a.Z)(o),[xm.with({rgs:e.pasteRanges,view:n,hidden:e.pasteHidden,key:"PasteSelections"}),ry.with({rgs:e.formulaRanges,sheet:e.sheet,view:n,key:"FormulaSelections"}),rv.with({rgs:e.conditionFormatRanges,view:n,hidden:e.conditionFormatHidden,key:"ConditionalFormatSelections"}),iv.with({rgs:e.aiHighlightArea,view:n,key:"AiHighlightArea"}),ov.with({rgs:e.conditionHighLightRanges,view:e.view,key:"ConditionHighlightSelections"}),av.with({rgs:e.protectHighlightRanges,view:e.view,key:"ProtectionHighlightSelections"}),sv.with({rgs:e.pivotTableHighlightRanges,view:e.view,key:"PivotTableHighlightSelections",colorType:e.pivotTableHighlightType}),vv.with({rgs:e.sparklineSourceRanges,view:e.view,key:"SparklineSourceHighlightSelections",type:0}),vv.with({rgs:e.sparklineGroupRanges,view:e.view,key:"SparklineGroupHighLightSelections",type:1}),uv.with({rgs:e.chartRanges,view:e.view,key:"ChartSelections"}),lv.with({rgs:e.floatBlocksRanges,view:e.view,key:"FloatBlocksSelections"}),cv.with({rg:e.autoFillRange,view:e.view,key:"AutoFillSelectionsLegacy"}),hv.with({rgs:e.painterRanges,view:e.view,key:"PainterSelections"}),km.with({rg:e.dropAnchorRange,view:e.view,key:"DropAnchorSelections"}),iy.with({rgs:e.importRangeRanges,view:e.view,key:"ImportRangeHighlightSelections"}),Mm.with({key:"NormalSelections",rgs:e.normalRanges,view:n,rects:e.rects,selectionController:e.selectionController,ignore:e.normalIgnore,activeRange:e.activeRange,hidden:e.normalHidden})],(0,a.Z)(s));if(1===e.normalRanges.length){var i,u=e.cornerWidgetType;null===(i=e.sheetView)||void 0===i||!i.editable||e.sheet.parent.isRangeSelecting||e.sheet.tabType.isConnectorTab()||r.push(u.with({key:"CornerWidgetType",rg:e.cornerPositionRange||e.normalRanges[0],view:n,selectionController:e.selectionController}))}return r}))}},{key:"isAtNormalSelectionBorder",value:function(e){var t,n=e.target,r=new k.FPoint(e.x,e.y).move(n.x,n.y),i=cc(this.rects);try{for(i.s();!(t=i.n()).done;){var o=t.value;if(this.isAtSelectionBorder(r,o))return!0}}catch(e){i.e(e)}finally{i.f()}return!1}},{key:"isAtSelectionBorder",value:function(e,t){var n=t.width,r=t.height,i=t.x,o=t.y,a=new k.FRect(i,o,n,r),s=new k.FRect(i+8,o+8,n-15,r-15);return!(!a.containPoint(e)||s.containPoint(e))}},{key:"onDoDrop",value:function(e){this.selectionController.destroyScroll(e.x,e.y)}}]),t}(k.FBaseWidget);function Dm(e,t,n,r){e.save();var i=t.element(),o=r.maxX-r.x,a=r.maxY-r.y,s=Math.min(i.width,o),u=Math.min(i.height,a),l=document.createElement("canvas");l.width=s,l.height=u;var c=l.getContext("2d");c?(c.drawImage(i,0,0,s,u),"repeat-x"===n?function(e,t,n,r,i,o,a,s){for(var u=Math.ceil(i/a),l=0;l<u;l++){var c=n+l*a;e.drawImage(t,0,0,a,s,c,r,a,s)}}(e,l,r.x,r.y,o,0,s,u):"repeat-y"===n?function(e,t,n,r,i,o,a,s){for(var u=Math.ceil(o/s),l=0;l<u;l++){var c=r+l*s;e.drawImage(t,0,0,a,s,n,c,a,s)}}(e,l,r.x,r.y,0,a,s,u):"repeat"===n&&function(e,t,n,r,i,o,a,s){for(var u=Math.ceil(i/a),l=Math.ceil(o/s),c=0;c<u;c++)for(var h=n+c*a,d=0;d<l;d++){var f=r+d*s;e.drawImage(t,0,0,a,s,h,f,a,s)}}(e,l,r.x,r.y,o,a,s,u),e.restore()):console.error("Failed to get 2D context for offscreen canvas")}hp([k.State],Lm.prototype,"normalRanges",void 0),hp([k.State],Lm.prototype,"activeRange",void 0),hp([k.State],Lm.prototype,"normalIgnore",void 0),hp([k.State],Lm.prototype,"normalHidden",void 0),hp([k.State],Lm.prototype,"formulaRanges",void 0),hp([k.State],Lm.prototype,"progressRange",void 0),hp([k.State],Lm.prototype,"progressPercent",void 0),hp([k.State],Lm.prototype,"pasteRanges",void 0),hp([k.State],Lm.prototype,"pasteHidden",void 0),hp([k.State],Lm.prototype,"conditionFormatRanges",void 0),hp([k.State],Lm.prototype,"conditionFormatHidden",void 0),hp([k.State],Lm.prototype,"aiHighlightArea",void 0),hp([k.State],Lm.prototype,"conditionHighLightRanges",void 0),hp([k.State],Lm.prototype,"chartRanges",void 0),hp([k.State],Lm.prototype,"floatBlocksRanges",void 0),hp([k.State],Lm.prototype,"dropAnchorRange",void 0),hp([k.State],Lm.prototype,"autoFillRange",void 0),hp([k.State],Lm.prototype,"painterRanges",void 0),hp([k.State],Lm.prototype,"importRangeRanges",void 0),hp([k.State],Lm.prototype,"enableDrag",void 0),hp([k.State],Lm.prototype,"posXBuffer",void 0),hp([k.State],Lm.prototype,"posYBuffer",void 0),hp([k.State],Lm.prototype,"skipSelfEvent",void 0),hp([k.State],Lm.prototype,"protectHighlightRanges",void 0),hp([k.State],Lm.prototype,"pivotTableHighlightRanges",void 0),hp([k.State],Lm.prototype,"pivotTableHighlightType",void 0),hp([k.State],Lm.prototype,"sparklineSourceRanges",void 0),hp([k.State],Lm.prototype,"sparklineGroupRanges",void 0),hp([k.State],Lm.prototype,"selectionType",void 0),hp([k.State],Lm.prototype,"viewPos",void 0),hp([k.State],Lm.prototype,"cornerWidgetType",void 0),hp([k.State],Lm.prototype,"cornerPositionRange",void 0),function(e){e.REPEAT="repeat",e.REPEATX="repeat-x",e.REPEATY="repeat-y"}(Nm||(Nm={}));var Fm,Bm="data:image/svg+xml;base64,"+btoa('\n  <svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><g opacity="1"><path d="M1 0L0 1V0H1ZM7 8L8 7V8H7Z" fill="#DEE0E3"/><path d="M0 8V7L7 0H8V1L1 8H0Z" fill="#DEE0E3"/></g></svg>\n'),Vm=function(e){function t(e){var n;return(0,h.Z)(this,t),(n=(0,f.Z)(this,(0,p.Z)(t).call(this,"invisible_layer",null))).view=e,n.bgImg=new I.FDomImage(Bm,"anonymous"),n}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"render",value:function(e,t){if(this.view.getSheetView().invisible){if(!this.bgImg)throw Error("render fail because watermark is load error");var n=new k.FRect(0,0,t.maxX,t.maxY);Dm(e,this.bgImg,"repeat",n)}}}]),t}(I.FLayer);!function(e){e[e.Content=101]="Content",e[e.UserCursor=104]="UserCursor",e[e.Selection=105]="Selection",e[e.CommentHoverBorder=106]="CommentHoverBorder",e[e.FloatContent=201]="FloatContent"}(Fm||(Fm={}));(0,N.getThemeColorByToken)("illustration-yellow"),(0,N.getAlphaColor)((0,N.getThemeColorByToken)("illustration-yellow"),.3);var Hm={padding:6,fontSize:16,fontWeight:500,height:28,hAlign:I.HorizontalAlign.Right,vAlign:I.VerticalAlign.Center},Um=function(e){function t(e,n,r,a,l,d,v){var g;(0,h.Z)(this,t),(g=(0,f.Z)(this,(0,p.Z)(t).call(this,e)))._measurer=n,g.uiEvent=l,g._sheetView=d,g.options=v,g._historyTexts=[],g._selEditMode=0,g._rowFrom=0,g._colFrom=0,g._rowTo=0,g._colTo=0,g._commentBorder={widget:new k.FWidget((0,s.Z)(g)),offsetX:0,offsetY:0},g._skipLayers=[],g._layers=new Map,g.floatImage=null,g.renderEnv="preview",g._idleCallback=function(){if(g._skipLayers.length>0){var e=!1;!g._sheetView.invisible&&g._skipLayers.forEach((function(t){!1===t.isEnabled()&&(e=!0,t.enabled())})),e&&(g._content.doc.reset(),g._content.detectLifetimeOnce(!0))}},g.refresh=function(){g._content.doc.reset(),g._content.detectLifetimeOnce(!0)},g.moveOutCommentCard=function(){g._commentBorder.widget.updateByCfg({hidden:!0}),g._commentBorder.offsetX=0,g._commentBorder.offsetY=0},g.moveInCommentCard=function(e,t){var n=new x.e6w(e,t,1,1,g._sheet),r=kd(g._sheet,e,t);r&&r.rowFrom()===e&&r.colFrom()===t&&(n=r);var i=n.rowCount(),o=n.colCount(),a=g.cell2ViewPos({row:e,col:t}),s=g.cell2ViewPos({row:e+i,col:t+o});g._commentBorder.offsetX=g._content.posX,g._commentBorder.offsetY=g._content.posY,g._commentBorder.widget.updateByCfg({x:a.x,y:a.y,width:s.x-a.x,height:s.y-a.y,hidden:!1,zindex:Fm.CommentHoverBorder})},g.removeCfSelectionHighlight=function(){g._selectionLayer.conditionHighLightRanges=[]},g.addPivotTableHighlight=function(e,t){g._selectionLayer.pivotTableHighlightRanges=e,void 0!==t&&(g._selectionLayer.pivotTableHighlightType=t)},g.removePivotTableHighlight=function(){g._selectionLayer.pivotTableHighlightRanges=[],g._selectionLayer.pivotTableHighlightType=0},g.addSparklineHighlight=function(e,t){0===t?g._selectionLayer.sparklineSourceRanges=e:1===t&&(g._selectionLayer.sparklineGroupRanges=e)},g.removeSparklineHighlight=function(e){1===e?g._selectionLayer.sparklineGroupRanges=[]:0===e?g._selectionLayer.sparklineSourceRanges=[]:e||(g._selectionLayer.sparklineGroupRanges=[],g._selectionLayer.sparklineSourceRanges=[])},g.addCfSelectionHighlight=function(e){g._selectionLayer.conditionHighLightRanges=e},g.addProtectionHighlight=function(e){g._selectionLayer.protectHighlightRanges=e},g.removeProtectionHighlight=function(){g._selectionLayer.protectHighlightRanges=[]},g._doSelection=function(e,t,n,r){g._sheet&&g._selectRange(e,t,n,r)},g._selectRange=function(e,t,n,r){if(g._sheet){var i=g._sheet,o={row:i.getActiveRowIndex(),col:i.getActiveColumnIndex()};if(1!==g._selEditMode){var a=g._selHandler.startCell();null!==a&&(o.row=a.row,o.col=a.col)}2===g._selEditMode?(i.setActiveCell(o.row,o.col,{triggerEvent:!1,clearSelection:!1,setSelection:!1}),i._expandSelectedRange(e)):3===g._selEditMode?(i.setActiveCell(o.row,o.col,{triggerEvent:!1,setSelection:!1,clearSelection:!1}),r?i._extractSelectedRange(e):i._expandSelectedRange(e)):r||i.setSelection(e,o,void 0,!0,t,n?g._sheetView.globalPoint2VisibleCell(n):void 0,g._selEditMode)}},g.reset=function(){g._content.reset()},g.throttledRefresh=(0,C.default)(g.reset,200,{trailing:!1}),g.$shellWatcher=v.shellWatcher;var _=new ag("highlight_layer",(function(e,t,n,r,i){return g._sheet.cellModel.iterVisibleCellSpan(e,t,n,r,i).map((function(e){var t=e.row,n=e.col,r=g._sheet.getHighlightCell(t,n),i=g._sheet.getApply2AllHighlightCell(t,n);if(r||i)return[Object.assign({value:r&&r.backColor||"var(--B500-FG, 0.2)"},Id(g._sheet,t,n)),e]})).filter((function(e){return!!e}))}),!1,void 0,(function(){return!g._sheet.hasHighLightCell()&&!g._sheet.hasApply2AllHighlightCell()})),y=new ag("comment_layer",(function(e,t,n,r,i){return g._sheet.cellModel.iterVisibleCellSpan(e,t,n,r,i).map((function(e){var t=e.row,n=e.col;return g._sheet.getActiveComment(t,n)?[Object.assign({value:Kh},Id(g._sheet,t,n)),e]:void 0})).filter((function(e){return!!e}))}),void 0,void 0,(function(){return 0===g._sheet.getActiveComments().length}));g._imageLayer=new g_("image_layer",(function(e,t,n,r,a){return g._sheet.cellModel.iterVisibleImage(e,t,n,r,a).map((function(e){var t,n,r=(0,c.Z)(e,2),a=r[0],s=r[1],l=g._sheet.getCellWidth(s.row,s.col,!0),h=g._sheet.getCellHeight(s.row,s.col,!0),d=g._sheet.getStyle(s.row,s.col),f=d.hAlign,p=d.vAlign,v=a.fileToken,_=a.mode,y=a.customWidth,m=a.customHeight,E=v?Z.OCe:Z.j5Q,b=L().isOpendoc,T=g._sheet.parent,C=Em(v,T,g.renderEnv,g.throttledRefresh);if("object"==(0,u.Z)(C)?(t=C.renderPermission,n=C.previewResultCode):t=C,void 0===t)return null;var S=Date.now(),w=t?Tm(a,T,b,s):new I.FDomImage(Z.Ps3.getNoPermissionPlaceHolderImgUrl(g.renderEnv,n),"anonymous");return w?(w.onceLoaded((function(){var e=Date.now()-S;E.onImageResolve({timeCost:e})})),w.onceError((0,o.Z)(i().mark((function e(){var t,n,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!v){e.next=7;break}return e.next=3,T.getService(H.Qh).getAttachmentCheckResult(v);case 3:t=e.sent,n=t.previewable,r=t.previewResultCode,Cm(n,r)&&g.throttledRefresh();case 7:E.onImageReject({ex:"onerror"});case 8:case"end":return e.stop()}}),e)})))),[{image:w,cellWidth:l,cellHeight:h,cellPadding:g._sheet.getCellPadding(),hAlign:f,vAlign:p,mode:_,customWidth:y,customHeight:m},s]):null}))}));var m=new Sg((function(e,t,n,r){return g._sheet.cellModel.iterVisibleSpanIntersectRange(e,t,n,r)}),(0,s.Z)(g));g._gridBorderLayer=m;var E=new ag("conditional_format_layer",(function(e,t,n,r,i){return g._sheet.cellModel.iterVisibleCellSpan(e,t,n,r,i).map((function(e){var t=g._sheet.conditionalFormatModel.getCellStyle(e.row,e.col);return t&&g._sheet.conditionalFormatModel.isConditionalFormatStyle(t)&&t.backColor?[Object.assign({value:t.backColor},Id(g._sheet,e.row,e.col)),e]:void 0})).filter((function(e){return!!e}))}),void 0,void 0,(function(){return 0===g._sheet.conditionalFormatModel.getAllRules().length})),b=new __("data_bar",(function(e,t,n,r,i){return g._sheet.cellModel.iterVisibleCellSpan(e,t,n,r,i).map((function(e){var t=g._sheet.conditionalFormatModel.getCellStyle(e.row,e.col);if(t&&g._sheet.conditionalFormatModel.isDataBarStyleInfo(t))return[Object.assign({},t,{},Id(g._sheet,e.row,e.col)),e]})).filter((function(e){return!!e}))}),void 0,(function(){return 0===g._sheet.conditionalFormatModel.getAllRules().length})),T=new ag("color_scale_layer",(function(e,t,n,r,i){return g._sheet.cellModel.iterVisibleCellSpan(e,t,n,r,i).map((function(e){var t=g._sheet.conditionalFormatModel.getCellStyle(e.row,e.col);if(t&&g._sheet.conditionalFormatModel.isConditionalFormatStyle(t)&&t.backColor)return[Object.assign({value:t.backColor},Id(g._sheet,e.row,e.col)),e]})).filter((function(e){return!!e}))}),void 0,void 0,(function(){return 0===g._sheet.conditionalFormatModel.getAllRules().length})),S=new Xg((function(e,t,n,r,i){return g._sheet.cellModel.iterVisibleStyle(e,t,n,r,i).map((function(e){var t=(0,c.Z)(e,2),n=t[0],r=t[1],i=n.borderRight,o=n.borderBottom,a=n.borderTop,s=n.borderLeft,u=n.diagonal,l=n.diagonalUp,h=n.diagonalDown,d=g._sheet._getSpanModel().find(r.row,r.col);if(d){var f=d.rowTo(),p=d.colTo(),v=g._sheet.getStyle(f,p);i=i||v.borderRight,o=o||v.borderBottom}if(a||i||o||s||u){var _=Id(g._sheet,r.row,r.col);return _.borderTop=a,_.borderBottom=o,_.borderLeft=s,_.borderRight=i,_.diagonal=u,_.diagonalUp=l,_.diagonalDown=h,[_,r]}})).filter((function(e){return!!e}))}));g._content=new I.FDocView((0,s.Z)(g),n,(function(e){return g._sheet.cellModel.generatorIterCtx(e)})),g.options.isEmbed||(g.floatImage={},g.floatImage.rnds=[],g.floatImage.content=new I.FDocView((0,s.Z)(g),n),g.floatImage.content.setIgnoreBuffer(!0),g.options.ignoreFloatImageOverflow||(g.floatImage.content.doc.docSize=function(){var e=n.size(),t=e.width,i=e.height;if(g._sheetView){var o=g._sheetView.zoom,s=g._sheetView.getZoomContentPadding(),u=s.bottomPadding;t+=s.rightPadding/o,i+=u/o}else t+=a,i+=r;return{width:t=Math.max(t,g.floatImage.content.width),height:i=Math.max(i,g.floatImage.content.height)}}),k.Bind.propBind(g.floatImage.content,"x",g._content,"x"),k.Bind.propBind(g.floatImage.content,"y",g._content,"y"),k.Bind.propBind(g.floatImage.content,"width",g._content,"width"),k.Bind.propBind(g.floatImage.content,"height",g._content,"height"),k.Bind.propBind(g.floatImage.content,"posX",g._content,"posX"),k.Bind.propBind(g._content,"posX",g.floatImage.content,"posX"),k.Bind.propBind(g._content,"posY",g.floatImage.content,"posY"),k.Bind.propBind(g.floatImage.content,"posY",g._content,"posY"),k.Bind.propBind(g.floatImage.content,"minPosX",g._content,"minPosX"),k.Bind.propBind(g.floatImage.content,"minPosY",g._content,"minPosY"),k.Bind.propBind(g.floatImage.content,"maxPosX",g._content,"maxPosX"),k.Bind.propBind(g.floatImage.content,"maxPosY",g._content,"maxPosY"),k.Bind.propBind(g.floatImage.content,"docWidth",g._content,"docWidth"),k.Bind.propBind(g.floatImage.content,"docHeight",g._content,"docHeight"),g.floatImage.content.updateByCfg({skipSelfEvent:!0,zindex:Fm.FloatContent}),g.floatImage.content.doc.updateByCfg({skipSelfEvent:!0}),g.floatImage.layer=new wm("float_image",(0,s.Z)(g)),(0,x.yFL)()||g.floatImage.content.addLayer(g.floatImage.layer)),g.options.contentSwapCanvasDisabled&&g._content.disableSwapCanvas();var R=_m({getViewModel:function(){return g._sheetView.getViewModel()},doc:g._content.doc,tableView:(0,s.Z)(g),ignoreCellOverflow:g.options.ignoreCellOverflow});g.setPadding(r,a),g.addLayer(E,1),g.addLayer(T,2),g.addLayer(b,3),g.addLayer(y,4),(0,x.yFL)()||g.addLayer(g._imageLayer,9),g.addLayer(R,10),g.addLayer(_,11);var A=new Vm((0,s.Z)(g));if(A.disabled(),g.addLayer(A,17),[{func:Vg,name:"filter_sort_icon_layer",isEmptyLayer:function(e){return!e.getPivotTableManager().hasPivotTable()}},{func:Ug,name:"dropdown_icon_layer"},L().isH5?null:{func:zg,name:"cell_note_icon"},(0,x.yFL)()?null:{func:Gg,name:"invalidate_icon"},{func:Zg,name:"comment_icon_layer",isEmptyLayer:function(e){return e._getModel().isEmpytComment()}},{func:Wg,name:"tip_icon_layer"},{func:jg,name:"icon_set_layer"},{func:Hg,name:"collapse_cion_layer",isEmptyLayer:function(e){return!e.getPivotTableManager().hasPivotTable()}}].filter(Boolean).forEach((function(e){if(Z.Ps3.shouldTipRender(e.name)){var t=new xv(e.name,g._content.doc,(function(t,r,i,o,a,s){var u;return e.func({viewModel:g._sheetView.getViewModel(),sheet:g._sheet,measurer:n,rowFrom:t,colFrom:r,rowTo:i,colTo:o,context:a,iterCtx:s,ignoreCellOverflow:g.options.ignoreCellOverflow,dispatchShellEvent:(null===(u=g.getSheetView())||void 0===u?void 0:u.shellWatcher.dispatch)||w.default})}),e.isEmptyLayer?function(){return e.isEmptyLayer(g._sheet)}:void 0,g.options.ignoreCellOverflow);g.addLayer(t,12),"tip_icon_layer"!==e.name||g.options.skipLayersAsyncRenderDisabled||(g._skipLayers.push(t),t.disabled())}})),g.addLayer(m,13),g.addLayer(S,14),g._content.addListener(k.FEventType.AfterFlush,(function(e){return(e.changes.posX||e.changes.posY)&&(g.options.skipLayersAsyncRenderDisabled||(g._skipLayers.forEach((function(e){return e.disabled()})),k.FApp.registerIdleCallback(g._idleCallback,!0)),g._selectionLayer&&(g._selectionLayer.viewPos=g.getContentPos())),!1})),(g.options.isEmbed||g.options.contentBufferEnabled)&&g.toggleBuffer(!1),k.Bind.propBind(g._content,"width",(0,s.Z)(g),"width"),k.Bind.propBind(g._content,"height",(0,s.Z)(g),"height"),g.bindHighlightBorderOffset(g._commentBorder),g.updateHighlightBorders(g._commentBorder,2,"var(--illustration-yellow)"),g._selHandler=new jv(g._content,g._sheetView,!0,g._doSelection),g._selectionLayer=new Lm((0,s.Z)(g),g._sheetView,g.sheet()),!g.options.isPureRender){g._selectionLayer.state=new k.FState(Lm,{});var O=(0,ye.base2Widget)(g._selectionLayer);O.updateByCfg({zindex:Fm.Selection,shadow:{offsetX:-2,offsetY:-2,blur:4}}),O.setParent((0,s.Z)(g)),g._selections=O,k.Bind.propBind(g._selections,"width",(0,s.Z)(g),"width"),k.Bind.propBind(g._selections,"height",(0,s.Z)(g),"height")}return g.initBackgroundLayer(),g.uiEvent.addListener("ScrollBarMouseUp",(function(e){var t=e.globalPoint();g.endSelAtPoint(t.x,t.y,{shiftKey:e.shiftKey,triggerFrom:"mouseUPEvent"})})),g.uiEvent.addListener("CanvasOutsideMouseUp",(function(){g.endSelAtPoint()})),g}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"initBackgroundLayer",value:function(){var e=this,t=new ag("background_layer",(function(t,n,r,i,o){return e._sheet.cellModel.iterVisibleStyle(t,n,r,i,o).filter((function(e){return!!e[0].backColor})).map((function(t){var n=t[0],r=t[1],i=r.row,o=r.col;return[Object.assign({value:n.backColor},Id(e._sheet,i,o)),t[1]]}))}));this.addLayer(t,0)}},{key:"getSelection",value:function(){return this._selectionLayer}},{key:"addLayer",value:function(e,t){this._content.addLayer(e,t),this._layers.set(e.name,e)}},{key:"getLayer",value:function(e){return this._layers.get(e)}},{key:"disableLayers",value:function(e){var t=this;e.forEach((function(e){var n=t._layers.get(e);n&&n.disabled()}))}},{key:"enableLayers",value:function(e){var t=this;e.forEach((function(e){var n=t._layers.get(e);n&&n.enabled()}))}},{key:"setPadding",value:function(e,t){this._content.doc.setPadding([0,t,e,0])}},{key:"getImageLayer",value:function(){return this._imageLayer}},{key:"bindHighlightBorderOffset",value:function(e){var t=this,n=e;Array.isArray(n)||(n=[n]),n.forEach((function(e){k.Bind.propBind(e.widget,"x",t._content,"posX",(function(t){var n=e.widget.x+e.offsetX-t;return e.offsetX=t,n})),k.Bind.propBind(e.widget,"y",t._content,"posY",(function(t){var n=e.widget.y+e.offsetY-t;return e.offsetY=t,n}))}))}},{key:"updateHighlightBorders",value:function(e,t,n){var r=e;Array.isArray(r)||(r=[r]),r.forEach((function(e){e.widget.updateByCfg({ignore:!0,hidden:!0,border:{width:t,color:n}})}))}},{key:"dblClick",value:function(e){return this._selHandler.end(e.globalPoint().x,e.globalPoint().y,{shiftKey:e.shiftKey,triggerFrom:"dblClickEvent"}),!1}},{key:"clearFloatImageSelection",value:function(){var e,t=this;this.floatImage&&null!==(e=this._sheet)&&void 0!==e&&e.floatImageModel&&this._sheet.floatImageModel.activeFloatImageIds.forEach((function(e){var n=t.floatImage.layer.getImageById(e);n&&n.exitEdit()}))}},{key:"_isAtTableView",value:function(e,t){return new x.e6w(this._rowFrom,this._colFrom,this._rowFrom+this._rowTo,this._colFrom+this._colTo,this._sheet).intersect(new x.e6w(e,t,1,1,this._sheet))}},{key:"getExpandRange",value:function(e,t){return Gv(new x.e6w(e,t,1,1,this._sheet),this._sheet)}},{key:"_labelBindPosition",value:function(e,t,n){var r=n.isLeft,i=void 0!==r&&r,o=this.getExpandRange(e.row,e.col),a=this.range2ViewRect(o),s=this.contentDoc(),u=this.cell2DocPos({row:o.rowFrom(),col:o.colFrom()}),l=this;function c(e){var t=e.posX,n=e.labelWidth;return i?a.x+a.width>n?u.x-t-2:u.x-t:a.x+a.width>n?u.x-t+a.width-n-2:u.x-t}function h(e){var n=e.posY,r=e.labelHeight;return a.y>r?(i&&t.updateByCfg({radius:[6,6,6,0]}),u.y-n-r-2):(i&&t.updateByCfg({radius:[0,6,6,6]}),u.y-n+a.height+r>l.height?u.y-n:u.y-n+a.height)}k.Bind.propBind(t,"x",s,"posX",(function(e){return c({posX:e,labelWidth:t.width})})),k.Bind.propBind(t,"x",t,"width",(function(e){return c({posX:s.posX,labelWidth:e})})),k.Bind.propBind(t,"y",s,"posY",(function(e){return h({posY:e,labelHeight:t.height})})),k.Bind.propBind(t,"y",t,"height",(function(e){return h({posY:s.posY,labelHeight:e})}))}},{key:"getContentPos",value:function(){return new k.FPoint(this._content.posX,this._content.posY)}},{key:"getContent",value:function(){return this._content}},{key:"toggleBuffer",value:function(e){this._content.setIgnoreBuffer(!e)}},{key:"setSelEditState",value:function(e){this._selEditMode=e}},{key:"selEditState",value:function(){return this._selEditMode}},{key:"updateSheet",value:function(){this.floatImage&&(this.floatImage.layer.reset(),this.floatImage.rnds=[]);var e=this._sheet.inject(x._JP).getGridLine();this.changeGridLine(e),this._selectionLayer.sheet=this._sheet}},{key:"sheet",value:function(){return this._sheet}},{key:"contentDoc",value:function(){return this._content}},{key:"cell2ViewPos",value:function(e){var t=this.cell2DocPos(e);return this.docPos2View(t)}},{key:"docPos2View",value:function(e){return this._content.doc2View(e).move(this._content.x,this._content.y)}},{key:"viewPos2Doc",value:function(e){return e.move(-this._content.x,-this._content.y),this._content.view2Doc(e)}},{key:"getViewRect",value:function(){var e=this.contentDoc();if(0===e.width||0===e.height)return new k.FRect(0,0,0,0);var t=this.docPos2Cell(e.posX,e.posY),n=this.docPos2Cell(e.posX+e.width,e.posY+e.height);return new k.FRect(t.col,t.row,n.col-t.col+1,n.row-t.row+1)}},{key:"range2ViewRect",value:function(e){var t=e.rowFrom(),n=e.colFrom(),r={row:t,col:n},i={row:t+e.rowCount(),col:n+e.colCount()},o=this.cell2ViewPos(r),a=this.cell2ViewPos(i);return new k.FRect(o.x,o.y,a.x-o.x,a.y-o.y)}},{key:"docPos2Cell",value:function(e,t){return this._content.docPos2Cell(new k.FPoint(e,t))}},{key:"cell2DocPos",value:function(e){return this._content.cell2DocPos(e)}},{key:"glbPt2AbsCell",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e;t&&(n=this.mapFromGlobal(e.clone()));var r=this.viewPos2Doc(n);return this.docPos2Cell(r.x,r.y)}},{key:"glbPt2VisibleAbsCell",value:function(e){var t,n,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.glbPt2AbsCell(e,r),o=this._sheet,a=i.col,s=i.row,u=o.iterVisibleRow(0,s,!0);return{col:null!==(t=o.iterVisibleCol(0,a,!0).next())&&void 0!==t?t:a,row:null!==(n=u.next())&&void 0!==n?n:s}}},{key:"getSheetView",value:function(){return this._sheetView}},{key:"paintedRect",value:function(){var e=(0,l.Z)((0,p.Z)(t.prototype),"paintedRect",this).call(this);if(e.isEmpty())return e;var n=this._sheetView;if(!n)return e;var r=e.x,i=e.y,o=e.width,a=e.height,s=n.getContentLogicBounds(),u=this.frame;return u.x===s.x&&(r-=2,o+=2),u.y===s.y&&(i-=2,a+=2),u.maxX===s.maxX&&(o+=2),u.maxY===s.maxY&&(a+=2),new k.FRect(r,i,o,a)}},{key:"setSelCustomData",value:function(e){this._selHandler.customData(e)}},{key:"startSelAtPoint",value:function(e,t,n){this._selHandler.start(e,t,n)}},{key:"continueSelAtPoint",value:function(e,t,n){this._selHandler.continueSel(e,t,n)}},{key:"endSelAtPoint",value:function(e,t,n){this._selHandler.end(e,t,n)}},{key:"isAtSelBorder",value:function(e){return this._selectionLayer.isAtNormalSelectionBorder(e)}},{key:"getImportRangeHighlightRanges",value:function(e){var t=this._sheet.getVar(e.rowFrom(),e.colFrom());return(0,x.E42)(t)&&(t=t.formula),(0,x.sMb)(t)&&1===t.canArrayExpand().arrayFormulaCanExpand&&((0,x.Unk)(t)||(0,x.mkm)(t))?[t.getArrayRef()]:[]}},{key:"rebuildImportRangeHighlight",value:function(e,t){if(0!==e.length){var n=this.getImportRangeHighlightRanges(t);this._selectionLayer.importRangeRanges=n}}},{key:"rebuildSelection",value:function(e,t){var n=this._sheet.selectionType;3===n?(this._selectionLayer.normalRanges=[],this._selectionLayer.activeRange=null):(this._selectionLayer.normalRanges=e,this._selectionLayer.activeRange=t),this._selectionLayer.selectionType=n,this._selectionLayer.viewPos=this.getContentPos(),this.rebuildImportRangeHighlight(e,t)}},{key:"unselectFloatingObjects",value:function(e,t,n){e&&(this._selectionLayer.normalHidden=!0),t&&(this._selectionLayer.pasteRanges=[]),n&&(this._selectionLayer.painterRanges=[])}},{key:"visibleArea",value:function(){var e=this.contentDoc(),t=e.posX,n=e.posY;return{rowFrom:this._measurer.measureRow(n),rowTo:this._measurer.measureRow(n+this.height),colFrom:this._measurer.measureCol(t),colTo:this._measurer.measureCol(t+this.width)}}},{key:"reselectFloatingObjects",value:function(){this._selectionLayer.normalHidden=!1,this._selectionLayer.pasteHidden=!1,this._selectionLayer.conditionFormatHidden=!1}},{key:"rebuildFormatPainterRange",value:function(e){this._selectionLayer.painterRanges=e}},{key:"rebuildPasteSelection",value:function(e){this._selectionLayer.pasteRanges=e}},{key:"rebuildFloatBlocksSelection",value:function(e){e||(e=[]),this._selectionLayer.floatBlocksRanges=e}},{key:"rebuildChartSelection",value:function(e){e||(e=[]),this._selectionLayer.chartRanges=e}},{key:"rebuildConditionFormatSelection",value:function(e){this._selectionLayer.conditionFormatRanges=e}},{key:"rebuildAiHighlightArea",value:function(e){this._selectionLayer.aiHighlightArea=e}},{key:"rebuildHistoryText",value:function(e){var t=this;this._historyTexts.forEach((function(e){e.destroy()})),this._historyTexts=[],e&&(Array.isArray(e)||(e=[e]),e.forEach((function(e){var n=new I.FLabel(t),r=e.row,i=e.col,o=e.isLeft,a=o?Hm:{};t._isAtTableView(r,i)&&(n.updateByCfg(Object.assign({background:e.backColor,color:e.color,text:e.text},a)),t._labelBindPosition({row:r,col:i},n,{isLeft:o})),t._historyTexts.push(n)})))}},{key:"getCornerBtnPosition",value:function(e){return null}},{key:"isShowFormulaSelection",value:function(){return 0===this._selectionLayer.chartRanges.length&&0===this._selectionLayer.floatBlocksRanges.length&&0===this._selectionLayer.pasteRanges.length&&0===this._selectionLayer.conditionFormatRanges.length}},{key:"rebuildFormulaSelection",value:function(e){if(this.isShowFormulaSelection()){this._selectionLayer.sheet=this._sheet;for(var t=[],n=0,r=e.count();n<r;n++){var i=e.getFormular(n);i.rg&&(i.rg.rowFrom()>=this._sheet.getRowCount()||i.rg.colFrom()>=this._sheet.getColumnCount()||t.push(i))}this._selectionLayer.formulaRanges=t}}},{key:"rebuildFillCornerCfg",value:function(e,t){e&&this._selectionLayer.cornerWidgetType!==e&&(this._selectionLayer.cornerWidgetType=e);var n=this._sheetView.mobileFilling;this._selectionLayer.normalHidden!==n&&(this._selectionLayer.normalHidden=n),this._selectionLayer.cornerPositionRange!==t&&(this._selectionLayer.cornerPositionRange=t)}},{key:"scrollPosx",value:function(e){this.contentDoc().updateByCfg({posX:this.contentDoc().posX+e})}},{key:"afterSelectionChanged",value:function(e){return!1}},{key:"selHandler",value:function(){return this._selHandler}},{key:"ensureRowHeight",value:function(e,t){var n=this;if(!this._sheet)return!1;var r=this._sheetView.getViewModel().fitRowCalc;if(!r.hasDirty())return!1;var i=Math.max(0,e-100),o=this._measurer.measureRow(i),a=this._measurer.measureRow(e),s=e-this._measurer.rowPos(a),u=0,l=[];this._sheet._getRowInfos().iterEachActualVisible(o,a-1).forEach((function(e){return l.push(e)})),l.forEach((function(e){if(r.isDirty(e)){var t=n._sheet.getRowHeight(e);r.calcRow(e),e>0&&(u+=n._sheet.getRowHeight(e)-t)}}));var c=!1,h=t+100+s,d=[];return this._sheet._getRowInfos().iterEachActualVisible(a,this._rowTo).exitWhen((function(e){return h<=0})).forEach((function(e){var t=r.getDirtyAutoRowHeight(e);"number"!=typeof t?(c=r.calcRow(e)||c,t=n._sheet.getRowHeight(e)):(d.push(e),r.cacheFitRow(e,t),c=!0),h-=t})),r.flushRowHeight(d),d.forEach((function(e){return n._sheetView.getViewModel().typography.recalcRowClipInfo(e)})),u||c}},{key:"ensureBeforeRow",value:function(e,t){if(!(e<=0)){var n=this._sheetView.getViewModel().fitRowCalc;if(n.hasDirty()){t+=100;for(var r=this._sheet._getRowInfos().iterEachActualVisible(0,e-1,!0),i=0,o=!1,a=r.next();null!==a&&a>=0&&i<t;a=r.next())n.hasDirty()&&(o=n.calcRow(a)||o),i+=this._sheet.getRowHeight(a);o&&this.reset()}}}},{key:"invalidateRowHeight",value:function(e){if(!this._sheet)return 0;var t=this._sheetView.getViewModel().fitRowCalc;if(!t.hasDirty())return 0;for(var n=this._measurer.measureRow(e),r=this._rowFrom,i=0;r<n;){if(t.isDirty(r)){var o=this._sheet.getRowHeight(r);t.calcRow(r),i+=this._sheet.getRowHeight(r)-o}r++}return i}},{key:"fromRow",value:function(){return this._rowFrom}},{key:"fromCol",value:function(){return this._colFrom}},{key:"toCol",value:function(){return this._colTo}},{key:"toRow",value:function(){return this._rowTo}},{key:"docWidth",value:function(){return this._content.doc.docSize().width}},{key:"docHeight",value:function(){return this._content.doc.docSize().height}},{key:"rebuild",value:function(e,t,n,r,i){this._rowFrom=t,this._colFrom=n,this._rowTo=r,this._colTo=i,this._selectionLayer.sheet=e}},{key:"changeGridLine",value:function(e){if(!this._sheetView.invisible){var t=this._gridBorderLayer;t&&(e?t.disabled():t.enabled())}}},{key:"destroy",value:function(){(0,l.Z)((0,p.Z)(t.prototype),"destroy",this).call(this),this._skipLayers.length=0,this._layers.clear(),{},ym.clear()}},{key:"registerRenderer",value:function(e){switch(e.type){case 0:this._selectionLayer.registerSelectionRenderer(e);break;case 1:this.addLayer(e.render(this,this._content.doc,this._measurer,this.options),e.zIndex);break;default:return}}},{key:"_sheet",get:function(){return this._sheetView.sheet()}},{key:"gridBorderLayer",get:function(){return this._gridBorderLayer}},{key:"selections",get:function(){return this._selections}}]),t}(k.FWidget);hp([Bd],Um.prototype,"appModel",void 0);var Zm,Wm,jm=function(e){function t(e,n,r,i,o,a,s){var u;return(0,h.Z)(this,t),(u=(0,f.Z)(this,(0,p.Z)(t).call(this,e,n,r,i,o,a,Object.assign({},s,{skipLayersAsyncRenderDisabled:(0,N.isShortCut)()})))).singleClickTimer=null,u.doubleClickDuration=300,u._dragArea=null,u.isHovered=!1,u}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"mouseDown",value:function(e){var t,n=this;if(console.log("[tableView] mouseDown"),Z.Ps3.eventHelper.preventMouseDown)return!1;var r=this.sheet();if(!r||this._sheetView.invisible)return!1;if(2===e.buttons)return!1;Tf.trigger(vc.LOG.BEFORE_CELL_ACTIVE,[vc.LOG.BEFORE_CELL_ACTIVE,this]);var i,o=this.glbPt2AbsCell(e.globalPoint());this.setSelEditState(zv(e.shiftKey,e.metaKey,e.ctrlKey,r,o));var a=this.selEditState();if(1===a)i=new x.e6w(r._activeRowIndex,r._activeColIndex,1,1,r);else if(2===a||3===a){var s=new x.e6w(o.row,o.col,1,1,r);r.setActiveCell(o.row,o.col,{triggerEvent:!1,clearSelection:!1,setSelection:!1}),r.addSelection(s)}if((null===(t=e.target.parent())||void 0===t?void 0:t.parent())instanceof Um){var u,l=null===(u=this.textLayer)||void 0===u?void 0:u._segInfo(new k.FPoint(e.x,e.y),e);if(null!=l&&l.seg){var c=l.seg.seg.type;c===Z.K6s.ATTACHMENT&&Object.assign(e.target,{type:c})}else Object.assign(e.target,{type:Z.ned.ONLY_CEEL})}this.setSelCustomData(e.target);var h=e.globalPoint();return this.startSelAtPoint(h.x,h.y,{preStart:i,triggerFrom:"mouseDownEvent",shiftKey:e.shiftKey}),setTimeout((function(){Tf.trigger(vc.LOG.AFTER_CELL_ACTIVE,[vc.LOG.AFTER_CELL_ACTIVE,n])}),0),!0}},{key:"mouseMove",value:function(e){return L().isIE?(this.updateByCfg({cursor:"default",draggable:!1}),e.buttons!==k.FMouseButtons.None&&this.continueSelAtPoint(e.globalPoint().x,e.globalPoint().y),!1):this.getSheetView().viewModel.getEditable()&&this.isAtSelBorder(e)?(this.updateByCfg({cursor:"grab"}),this._selectionLayer.normalIgnore=!1,!0):(this._selectionLayer.normalIgnore=!0,0!==this.width&&0!==this.height&&e.buttons!==k.FMouseButtons.None&&this.continueSelAtPoint(e.globalPoint().x,e.globalPoint().y),e.buttons===k.FMouseButtons.None&&this.endSelAtPoint(),this.handleMouseMoveEmbedImage(e),!1)}},{key:"mouseUp",value:function(e){var t=e.globalPoint();return this.endSelAtPoint(t.x,t.y,{shiftKey:e.shiftKey,triggerFrom:"mouseUPEvent"}),this.updateByCfg({cursor:"default"}),this.$shellWatcher.dispatch("MouseUp"),!1}},{key:"mouseEnter",value:function(e){return this.isHovered=!0,this.$shellWatcher.dispatch("MouseEnterTableView"),!1}},{key:"mouseLeave",value:function(e){return this.isHovered=!1,!1}},{key:"click",value:function(e){var t,n,r=this.sheet();t=this.glbPt2VisibleAbsCell(new k.FPoint(e.globalPoint().x,e.globalPoint().y));var i=r._getSpanModel(),o=t,a=o.row,s=o.col,u=i.find(a,s);return u&&(a=u.rowFrom(),s=u.colFrom()),n={sheet:r,sheetName:r.name(),row:a,col:s},this.$shellWatcher.dispatch("CellClicked",n),this.handleClickEmbedImage(e),!1}},{key:"dblClick",value:function(e){return this.clearTimer(),(0,l.Z)((0,p.Z)(t.prototype),"dblClick",this).call(this,e)}},{key:"handleClickEmbedImage",value:function(e){var t,n,r=this;if(e.type===k.FEventType.Click){this.clearTimer();var i=this.sheet(),o=this.glbPt2AbsCell(new k.FPoint(e.globalPoint().x,e.globalPoint().y)),a=null!==(t=null===(n=i.getSpans(new x.e6w(o.row,o.col,1,1,i))[0])||void 0===n?void 0:n.toJSON())&&void 0!==t?t:o,s=a.row,u=a.col,l=(0,x.Pq3)(i,s,u),c=Nd(i),h=i.parent;if(!Ld(h)&&(null==l||!l.fileToken||h.getService(H.Qh).checkAttachment(l.fileToken).previewable)){var d;if(l&&!i.getLockClickEmbedImage()&&"zoom-in"===this.contentDoc().doc.cursor&&(null===(d=this.floatImage)||void 0===d||!d.rnds.length)){var f=i.isCellEditable(s,u),p=(0,x.rwT)(i,s,u),v=i.isProxyArrayFormula(s,u);!p||v&&!f?this.previewEmbedImage(l,o):this.singleClickTimer=window.setTimeout((function(){r.previewEmbedImage(l,o,p),r.showZoomInIcon()}),this.doubleClickDuration)}i.setLockClickEmbedImage(!1),c&&l&&this.showZoomInIcon()}}}},{key:"previewEmbedImage",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.$shellWatcher.dispatch("OpenImgFullScreen",{seg:e,eventType:"click",cell:t}),this.contentDoc().doc.updateByCfg({cursor:"default"}),null===(n=Z.Ps3.collectSheetEvent)||void 0===n||n.call(Z.Ps3,"ccm_sheet_content_page_click",{click:"view_image",target:"ccm_drive_page_view ",image_type:r?"formula":"in_cell",action_type:"click"})}},{key:"clearTimer",value:function(){this.singleClickTimer&&clearTimeout(this.singleClickTimer)}},{key:"handleMouseMoveEmbedImage",value:function(e){var t;if(null===(t=this.floatImage)||void 0===t||!t.rnds.length){var n=this.glbPt2AbsCell(new k.FPoint(e.globalPoint().x,e.globalPoint().y));if(Pd(this.sheet(),n)){var r=this.sheet().parent;Ld(r)||this.showZoomInIcon()}}}},{key:"showZoomInIcon",value:function(){this.contentDoc().doc.updateByCfg({cursor:"zoom-in"})}},{key:"updateDropAnchor",value:function(e){this.getSelection().dropAnchorRange=e}},{key:"removeDropAnchor",value:function(){this.getSelection().dropAnchorRange=null}},{key:"rebuildDragArea",value:function(e){this.getSelection().autoFillRange=e}},{key:"isShowFormulaSelection",value:function(){return!(this._dragArea&&!this._dragArea.hidden)&&(0,l.Z)((0,p.Z)(t.prototype),"isShowFormulaSelection",this).call(this)}},{key:"textLayer",get:function(){return this._layers.get("typography_layer")}}]),t}(Um),Gm=function(e){function t(){var e,n;(0,h.Z)(this,t);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(n=(0,f.Z)(this,(e=(0,p.Z)(t)).call.apply(e,[this].concat(i))))._addEventFilter(),n}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"_addEventFilter",value:function(){var e=this;this.addEventFilter((function(t){return t.type===k.FEventType.PanStart?e.handlePanStart(t):t.type===k.FEventType.PanMove?e.handlePanMove(t):t.type===k.FEventType.PanEnd&&e.handlePanEnd(t)}))}},{key:"handlePanStart",value:function(e){var t=this.sheet();if(!t||this._sheetView.invisible)return!1;var n=e.globalCenter(),r=n.x,i=n.y,o=t.getSelections()[0];if(this._sheetView.mobileFilling||!o)return!1;var a=30/this._sheetView.zoom;if(!this.pointInsideSelection(n,o,a)){var s=Dy(this,o,sd,a);if(!s)return!1;var u=s.size,l=s.positions,c=this.mapFromGlobal(n.clone()),h=c.x,d=c.y,f=u.width,p=u.height,v=l.filter((function(e){return e.enable})).some((function(e){var t=e.left,n=e.top;return h>=t&&d>=n&&h<=t+f&&d<=n+p}));if(!v)return!1}return this.setSelCustomData(e.target),this.startSelAtPoint(r,i,{preStart:o,triggerFrom:"panEvent"}),this.continueSelAtPoint(r,i),e.srcEventPreventDefault(),e.preventDefault(),!0}},{key:"handlePanMove",value:function(e){if(!this.selHandler().startCell())return!1;var t=e.globalCenter(),n=t.x,r=t.y;return this.continueSelAtPoint(n,r),e.srcEventPreventDefault(),e.preventDefault(),!0}},{key:"handlePanEnd",value:function(e){if(!this.selHandler().startCell())return!1;var t=e.globalCenter(),n=t.x,r=t.y;return this.endSelAtPoint(n,r),e.srcEventPreventDefault(),e.preventDefault(),!0}},{key:"pointInsideSelection",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.sheet();if(!r)return!1;var i=r.getSelections()[0];if(!i)return!1;var o=this.mapFromGlobal(e.clone()),a=nv(this,i,n,n);return o.x>=a.x&&o.y>=a.y&&o.x<=a.x+a.width&&o.y<=a.y+a.height}}]),t}(jm),zm=function e(){Date.now()-window.__GESTURE_BACK_OR_FORWARD_TIMESTAMP__<=2500&&Z.Ps3.moirae.teaLog({key:"client_sheet_faster_gesture_back_or_forward"}),window.removeEventListener("popstate",e)},Ym=function(e){function t(e){var n;(0,h.Z)(this,t),(n=(0,f.Z)(this,(0,p.Z)(t).call(this,{p:e.p,Table:Z.P_e&&!e.options.isEmbed?Gm:jm,Header:im,worksheet:e.worksheet,options:e.options})))._imgSeg=null,n.loadedFirstTick=!1,n._fullScreenHandler=function(e){var t;if(n._imgSeg&&null!==(t=n.spread())&&void 0!==t&&t._context.isEmbed()){var r=n._imgSeg,i=r.imgSeg,o=r.cell;n.shellWatcher.dispatch("OpenImgFullScreen",{seg:i,eventType:"click",cell:o})}return!1},n.getRealResizeTipPosition=function(e,t,n,r){return e+t>n?e-(t+2*r):e};var r=e.options,i=r.isEmbed,o=r.embedRightPadding;return n._setFrozenTableScrollDisabled(),n._addEventListeners(),n._addEventFilters(),i&&(n.initPanMove(),n.initEmbedWidget(o),L().isIPad&&n.addListenerBeforeChange(),n.hideRowColHeaderEnable?(n.tables().forEach((function(e){e.updateByCfg({background:M.N00})})),n.headers().forEach((function(e){e.updateByCfg({background:M.N00})}))):n._container.updateByCfg({background:M.N00})),n}var n,r;return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"initFeatureRenderers",value:function(){(0,l.Z)((0,p.Z)(t.prototype),"initFeatureRenderers",this).call(this),this.registerRendererFactories([wv,Av])}},{key:"dragOver",value:function(e){if(!e.dataTransfer)return!1;if(e.dataTransfer.types.some((function(e){return"sheet/cell-value"===e}))){var n=e.ctrlKey?"copy":"move";e.dataTransfer.dropEffect=n}return(0,l.Z)((0,p.Z)(t.prototype),"dragOver",this).call(this,e)}},{key:"pinchStart",value:function(e){return e.srcEventPreventDefault(),!0}},{key:"pinchMove",value:function(e){return e.srcEventPreventDefault(),!0}},{key:"pinchEnd",value:function(e){return e.srcEventPreventDefault(),!0}},{key:"dropEvent",value:function(e){return!!e.dataTransfer&&((0,l.Z)((0,p.Z)(t.prototype),"dropEvent",this).call(this,e),this.destroyScroll(e.globalPoint()),e.dataTransfer.types.some((function(e){return"sheet/cell-value"===e}))&&this._doDrop(e),this.removeDropAnchor(),window.removeEventListener("popstate",zm),!0)}},{key:"dblClick",value:function(e){var t;if(!this._imgSeg||null===(t=this.spread())||void 0===t||!t._context.isEmbed()){var n;if(null===this._sheet)return!1;var r=null===(n=e.target.parent().state)||void 0===n?void 0:n.data.key;if("vscroll"===r||"hscroll"===r)return!0;(0,Z.FPR)("start","dbClick");var i=this.sheetHitTest(e.x,e.y).hitTestType;return![4,6,5].includes(i)&&(this.shellWatcher.dispatch("CellDoubleClicked",{sheet:this._sheet}),!0)}return this._fullScreenHandler(e),!1}},{key:"mouseUp",value:function(e){return this._deleteRowColDragDropWidget(),!1}},{key:"mouseMove",value:function(e){var t=this.sheet();if(null===t)return!1;var n=this.globalPoint2Cell(new k.FPoint(e.globalPoint().x,e.globalPoint().y)),r=t.getSpans(new x.e6w(n.row,n.col,1,1,this.sheet())),i=this.hoverCell$.getValue()||{row:-1,col:-1};if(r.length||i.row!==n.row||i.col!==n.col){var o={sheet:t,sheetName:t.name(),row:n.row,col:n.col};this.shellWatcher.dispatch("CellHover",o),r.length&&(n.row=r[0].rowFrom(),n.col=r[0].colFrom()),this.hoverCell$.next({row:n.row,col:n.col})}return!1}},{key:"mouseLeave",value:function(e){var n=this.sheet();if(null===n)return!1;var r={sheet:n,sheetName:n.name(),col:-1,row:-1};return this.shellWatcher.dispatch("CellHover",r),this.hoverCell$.next(null),(0,l.Z)((0,p.Z)(t.prototype),"mouseLeave",this).call(this,e)}},{key:"initEmbedWidget",value:function(e){if(!this._embedBorderWidget)throw new Error("initEmbedWidget error");k.Bind.propBind(this._embedBorderWidget,"width",this._hscroll,"value",this.getEmbedSheetBorderWidth(e))}},{key:"_updateRowColDragDropWidget",value:function(e){return cm(this,this.rowColDragDropWidgets(),e),!1}},{key:"_deleteRowColDragDropWidget",value:function(){this.showRowColDragDrop=!1}},{key:"_updateRowColResizer",value:function(e){var t=this.zoom,n={width:1*this.zoom,color:"var(--text-placeholder)",style:k.borderDash.dash},r={width:0,color:"var(--N00-FG)"},i={width:1,color:"var(--line-border-card)"},o=Math.ceil(this.rowColResizeTip().width),a=Math.ceil(this.rowColResizeTip().height),s=e.from()*t,u=e.size()*t;if(u<=0)return!1;var l=e.target,c=this.mapFromGlobal(l.mapToGlobal(new k.FPoint(0,0))),h=e.size()<0?0:Math.ceil(e.size()),d=c.y+s+u+10,f=this.getRealResizeTipPosition(d,a,this.viewModel.getHeight(),10),p=c.x+s+u+10,v=this.getRealResizeTipPosition(p,o,this.viewModel.getWidth(),10),g=0===s&&0===u,_=dd,y=fd,m={x:ud,y:ld,width:u,height:u,zindex:1e3,hidden:g},E={x:cd,y:hd,padding:[6,8],border:i,zindex:1e3,hAlign:I.HorizontalAlign.Center,vAlign:I.VerticalAlign.Center,fontSize:_,background:"var(--bg-body)",color:"var(--text-title)",radius:y,text:"".concat(h," ").concat(lc("CreationDoc_Sheets_Hyperlink_HeightHoverTooltip")),hidden:g};return 0===l.type()?(m=Object.assign(m,{y:c.y+s-1*t,width:this.viewModel.getWidth()-this.verticalScrollSize,border:[n,r]}),E.y=f):(m=Object.assign(m,{x:c.x+s-1*t,height:this.viewModel.getHeight()-this.horizontalScrollSize,border:[r,n]}),E.x=v),this.showRowColResizer=!g,this.rowColResizerRect=new k.FRect(m.x,m.y,m.width,m.height),this.rowColResizeTipPos=new k.FPoint(E.x,E.y),m.x=0,m.y=0,E.x=0,E.y=0,this.rowColResizer().updateByCfg(m),this.rowColResizeTip().updateByCfg(E),!1}},{key:"_setFrozenTableScrollDisabled",value:function(){this.tlTable().contentDoc().addListener(k.FEventType.BeforeChange,(function(e){var t=e.changes;return void 0!==t.posX&&(t.posX.current=0),void 0!==t.posY&&(t.posY.current=0),!1})),this.trTable().contentDoc().addListener(k.FEventType.BeforeChange,(function(e){var t=e.changes;return void 0!==t.posY&&(t.posY.current=0),!1})),this.blTable().contentDoc().addListener(k.FEventType.BeforeChange,(function(e){var t=e.changes;return void 0!==t.posX&&(t.posX.current=0),!1}))}},{key:"_addEventFilters",value:function(){var e=this;this.addEventFilter((function(t){if(t.target instanceof Bv){if(t.type===kf.PreResize)return e._updateRowColResizer(t)}else if(t.target instanceof Xv&&t.type===kf.DragDropEvent)return e._updateRowColDragDropWidget(t);return t.target instanceof Bv&&t.type===kf.PreResize||e.showRowColResizer&&(e.showRowColResizer=!1,e.rowColResizerRect=new k.FRect(0,0,0,0)),!1}))}},{key:"addListenerBeforeChange",value:function(){var e=this.handleMouseWheelScroll.bind(this);this.tables().forEach((function(t){t.contentDoc().addListener(k.FEventType.BeforeChange,(function(t){var n=t.changes,r=n&&n.posX;if(r&&void 0!==r.before){var i=r.current-r.before;e(i)}return!1}))}))}},{key:"initPanMove",value:function(){var e=this;this.tables().forEach((function(t){t.contentDoc().panMove=function(t){var n=this._startPanAnchor,r=n.x-t.deltaX,i=n.y-t.deltaY;if(Math.abs(1.3*r)<Math.abs(i))return!1;i=0;var o=e.handleMouseWheelScroll(r);return this._wheelStep(o?0:r,i),t.srcEventPreventDefault(),this._startPanAnchor=new k.FPoint(t.deltaX,t.deltaY),!1}}))}},{key:"_addEventListeners",value:function(){var e=this;this.addListener(xf.DragFilling,(function(t){var n=t.range;return e.tables().forEach((function(e){e.rebuildDragArea(n)})),e.updateFormulaSelection(),!1})),this.addListener(xf.DragFilled,(function(t){return e.tables().forEach((function(e){e.rebuildDragArea(null)})),!1})),window.__GESTURE_BACK_OR_FORWARD_TIMESTAMP__=0,window.removeEventListener("popstate",zm),window.addEventListener("popstate",zm)}},{key:"isInRange",value:function(e,t){var n=e.rowFrom(),r=e.colFrom(),i=t.rowFrom(),o=t.colFrom(),a=t.rowCount(),s=t.colCount();return(-1===i||i<=n&&n<i+a)&&(-1===o||o<=r&&r<o+s)}},{key:"isDropCopyRangeValid",value:function(e,t,n){if(!Array.isArray(e)||!t||!n)return!0;for(var r=0;r<e.length;r++){var i=e[r];if((this.isInRange(i,n)||!this.isInRange(i,t))&&e[r].isIntersect(t))return!1}return!0}},{key:"isDropRangeProtected",value:function(e){var t=this.sheet();return!!t&&t.checkRangesProtected(e)}},{key:"_doDrop",value:(r=(0,o.Z)(i().mark((function e(t){var n,r,o,a,s,u,l,c,h,d,f,p,v,g,_,y,m,E,b,T,C,S,w,R,A,O,M,I;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.sheet()){e.next=3;break}return e.abrupt("return");case 3:if(r=this.globalPoint2Cell(new k.FPoint(t.globalPoint().x,t.globalPoint().y)),o=t.ctrlKey,a=!1,s="",u=3,l=null,c=n._getActiveSelectedRange(),l=c&&(c.rowCount()>0||c.colCount()>0)?new x.e6w(c.rowFrom(),c.colFrom(),c.rowCount(),c.colCount(),n):new x.e6w(n._activeRowIndex,n._activeColIndex,1,1,n),h=n.getColumnCount(),d=n.getRowCount(),f=this.calcOffsetRange(this.getDropStartCell(),c,r),p=f.row,v=f.col,p+l.rowCount()>d&&(p=d-l.rowCount()),v+l.colCount()>h&&(v=h-l.colCount()),g=l.rowFrom(),_=l.colFrom(),y=l.rowCount(),m=l.colCount(),E=l instanceof x.rvb?0:p,b=l instanceof x.lq$?0:v,(s=(T={fromRow:g,fromColumn:_,rowCount:y,columnCount:m,toRow:E,toColumn:b,isDragCopy:o}).invalidMessage)&&0!==s.length||E===g&&b===_){e.next=24;break}if(C=new x.e6w(g,_,y,m,n),S=new x.e6w(E,b,y,m,n),o&&!this.isDropCopyRangeValid(n.getSpans(),S,C)&&(a=!0,s=lc("CreationDoc_Sheets_CannotChangeMergedCellDrag")),(n._hasPartSpans(g,_,y,m,!0)||n._hasPartSpans(E,b,y,m,!0))&&(a=!0,s=lc("CreationDoc_Sheets_CannotChangeMergedCellDrag")),!a&&n.options.isProtected&&(!o&&n._isAnyCellInRangeLocked(new x.e6w(g,_,y,m,n))||n._isAnyCellInRangeLocked(new x.e6w(E,b,y,m,n)))&&(a=!0,s=lc("CreationDoc_Sheets_CellIsProtected")),this.isDropRangeProtected(S)&&(a=!0,u=8,s="drag_drop"),w=n.getPivotTableManager(),a||!w.hasPivotTable()){e.next=23;break}return e.next=19,this.handlePivotTableMove(T,C);case 19:if(R=e.sent){e.next=22;break}return e.abrupt("return");case 22:s=R.invalidMessage,a=R.isInvalid;case 23:a||(A=n._getActiveSelectedRange(),O=new x.e6w(E,b,1,1,n),M=(0,x.dOv)(A,O),I=(0,x.UJ4)(A,O),n.moveRange({row:g,col:_,rowCount:y,colCount:m},{row:E,col:b},{isRowMove:M,isColMove:I}),this.setDropStartCell(null),Z.Ps3.collectSuiteEvent("sheet_opration",{action:"drag_drop",source:"body",eventType:"click",object_id:n.id()}));case 24:this.toolTip().updateByCfg({hidden:!0}),a&&n._raiseInvalidOperation(u,s);case 25:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"handlePivotTableMove",value:(n=(0,o.Z)(i().mark((function e(t,n){var r,o,a,s,u,l,c,h,d,f,p,v,g,_,y,m,E,b,T,C,S,w,R,A,O,M,k,I,N;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.fromRow,o=t.fromColumn,a=t.rowCount,s=t.columnCount,u=t.toRow,l=t.toColumn,c=this.sheet(),h=!1,d="",c){e.next=4;break}return e.abrupt("return");case 4:f=c.getPivotTableManager(),p=[],v=(0,x.SrO)(c,r,o,a,s),g=!1,_=cc(v),e.prev=7,_.s();case 9:if((y=_.n()).done){e.next=18;break}if(m=y.value,E=f.getPositionCell(m),b=E.row,T=E.col,n.containCell(b,T)){e.next=15;break}return h=!0,d=lc("CreationDoc_Sheets_PivotTable_Failed_CanNotEditPivot"),e.abrupt("break",18);case 15:p.push(m);case 16:e.next=9;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(7),_.e(e.t0);case 23:return e.prev=23,_.f(),e.finish(23);case 26:if(!h&&(0,x.dCY)(c,u,l,a,s,v)&&(h=!0,d=lc("CreationDoc_Sheets_PivotTable_Failed_CanNotEditPivot")),h||!p.length){e.next=52;break}C=cc(p),e.prev=28,C.s();case 30:if((S=C.n()).done){e.next=37;break}if(R=S.value,null===(w=c.parent.getPivotDataSourceManager().getSourceRange(R))||void 0===w||!w.isIntersect(new x.e6w(u,l,a,s,c))){e.next=35;break}return h=!0,d=lc("CreationDoc_Sheets_PivotTable_PositionOverlapWithDataSource_Toast"),e.abrupt("break",37);case 35:e.next=30;break;case 37:e.next=42;break;case 39:e.prev=39,e.t1=e.catch(28),C.e(e.t1);case 42:return e.prev=42,C.f(),e.finish(42);case 45:if(h||!c.iterContent(u,l,a,s,!0).next()){e.next=51;break}return e.next=48,Z.Ps3.modalHelper.showCoverSheetContentConfirmModel().promise;case 48:if(e.sent){e.next=50;break}return e.abrupt("return");case 50:g=!0;case 51:if(!h){A=u-r,O=l-o,M=cc(p);try{for(M.s();!(k=M.n()).done;)N=k.value,Z.Ps3.pivotTableHelper.movePivotTable(c,N,A,O,g).then((function(e){g=e})).catch((function(e){c._raiseInvalidOperation(3,e.message||e.toastText)})),null===(I=Z.Ps3.collectSheetEvent)||void 0===I||I.call(Z.Ps3,"ccm_sheet_content_page_click",{click:"change_pivotd_position",target:"none",change_method:"drag"})}catch(e){M.e(e)}finally{M.f()}}case 52:return e.abrupt("return",{isInvalid:h,invalidMessage:d});case 53:case"end":return e.stop()}}),e,this,[[7,20,23,26],[28,39,42,45]])}))),function(e,t){return n.apply(this,arguments)})},{key:"_scrollRowTo",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.isEmbed){var r=this.detectTableByCell(e,0);this.shellWatcher.dispatch("EmbedSheetScrollRowTo",{row:e});var i=r.glbPt2AbsCell(new k.FPoint(0,0)),o=r.glbPt2AbsCell(new k.FPoint(r.width,r.height));return{row:i.row,rowCount:o.row-i.row+1}}return(0,l.Z)((0,p.Z)(t.prototype),"_scrollRowTo",this).call(this,e,n)}},{key:"getEmbedSheetBorderWidth",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Bf;return function(){var n=e.contentSizeHint().width;Z.Ps3.getIsDocx()&&(n-=t);var r=Math.min(n,e.viewModel.getWidth()-e.appModel.getSheetViewX());if(e.isRowColHeaderHidden&&(r-=(e.topRowHeader().width||24)*e.zoom),!e.viewModel.getIsOverDoc())return r+6*(e.zoom-1);var i=e._hscroll.value,o=e._hscroll.max-e._hscroll.page-(t-Vf);return r-(o>0&&i>o?i-o:0)+6*(e.zoom-1)}}},{key:"scroll",value:function(e){void 0!==e.y&&(this.isEmbed?this.shellWatcher.dispatch("ScrollDoc",e):(0,l.Z)((0,p.Z)(t.prototype),"scroll",this).call(this,{y:e.y})),void 0!==e.x&&(0,l.Z)((0,p.Z)(t.prototype),"scroll",this).call(this,{x:e.x})}},{key:"updateDragArea",value:function(){this.tables().forEach((function(e){e.rebuildDragArea(null)}))}},{key:"updateDropAnchor",value:function(e){this.tables().forEach((function(t){return t.updateDropAnchor(e)}))}},{key:"removeDropAnchor",value:function(){this.tables().forEach((function(e){return e.removeDropAnchor()}))}},{key:"destroyScroll",value:function(e){this.tables().forEach((function(t){t.getSelection().onDoDrop(e)}))}},{key:"calcOffsetRange",value:function(e,t,n){var r=this.sheet();if(!r||!e)return{col:n.col,row:n.row};if(r.getSelections().length>1&&!(e.col>=t.colFrom()&&e.col<t.colFrom()+t.colCount()&&e.row>=t.rowFrom()&&e.row<t.rowFrom()+t.rowCount()))return{col:t.colFrom(),row:t.rowFrom()};var i=r.getColumnCount(),o=r.getRowCount(),a=e.col-t.colFrom(),s=e.row-t.rowFrom(),u=t.colFrom()+t.colCount()===e.col?1:e.col<t.colFrom()?-1:0,l=t.rowFrom()+t.rowCount()===e.row?1:e.row<t.rowFrom()?-1:0,c={col:n.col-(a-u),row:n.row-(s-l)};return c.col<0&&(c.col=0),c.row<0&&(c.row=0),c.col>i-t.colCount()&&(c.col=i-t.colCount()),c.row>o-t.rowCount()&&(c.row=o-t.rowCount()),c}},{key:"syncDropAnchor",value:function(e){var t=this.sheet();if(t){var n=this.mapFromGlobal(e);if(n.move(this.appModel.getSheetViewX(),this.appModel.getSheetViewY()),this.getSheetViewRect().containPoint(n)){var r=this.globalPoint2Cell(e),i=t._getActiveSelectedRange(),o=this.calcOffsetRange(this.getDropStartCell(),i,r),a=o.col,s=o.row,u=new x.e6w(s,a,i.rowCount(),i.colCount(),t),l=t.getColumnCount(),c=t.getRowCount();i instanceof x.lq$&&(u.setColFrom(0),u.setColCount(l)),i instanceof x.rvb&&(u.setRowFrom(0),u.setRowCount(c)),u.rowFrom()+u.rowCount()>c&&u.setRowFrom(c-u.rowCount()),u.colFrom()+u.colCount()>l&&u.setColFrom(l-u.colCount()),this.updateDropAnchor(u)}else this.removeDropAnchor()}}},{key:"destroy",value:function(){(0,l.Z)((0,p.Z)(t.prototype),"destroy",this).call(this)}},{key:"onRebuild",value:function(){this.updateDragArea()}}]),t}(Wy);!function(e){e[e.BACKGROUND_LAYER=0]="BACKGROUND_LAYER",e[e.CONDITIONAL_FORMAT_LAYER=1]="CONDITIONAL_FORMAT_LAYER",e[e.COLOR_SCALE_LAYER=2]="COLOR_SCALE_LAYER",e[e.DATA_BAR_LAYER=3]="DATA_BAR_LAYER",e[e.COMMENT_LAYER=4]="COMMENT_LAYER",e[e.DATA_CLEAN_BACKGROUND_LAYER=5]="DATA_CLEAN_BACKGROUND_LAYER",e[e.PROTECTED_4_EDITABLE_LAYER=6]="PROTECTED_4_EDITABLE_LAYER",e[e.PROTECTED_LAYER=7]="PROTECTED_LAYER",e[e.SPARK_LINE_LAYER=8]="SPARK_LINE_LAYER",e[e.IMAGE_LAYER=9]="IMAGE_LAYER",e[e.TEXT_LAYER=10]="TEXT_LAYER",e[e.HIGHLIGHT_LAYER=11]="HIGHLIGHT_LAYER",e[e.ICON_LAYER=12]="ICON_LAYER",e[e.BORDER_LAYER=13]="BORDER_LAYER",e[e.CUSTOM_BORDER_LAYER=14]="CUSTOM_BORDER_LAYER",e[e.IFLOAT_IMAGE_LAYER=15]="IFLOAT_IMAGE_LAYER",e[e.IFLOAT_BLOCK_IMAGE_LAYER=16]="IFLOAT_BLOCK_IMAGE_LAYER",e[e.INVISIBLE_LAYER=17]="INVISIBLE_LAYER",e[e.IWATER_MARK_LAYER=18]="IWATER_MARK_LAYER"}(Zm||(Zm={}));!function(e){e.SHEET_VIEW="SHEET_VIEW",e.CARD_VIEW="CARD_VIEW",e.REFERENCE_VIEW="REFERENCE_VIEW"}(Wm||(Wm={}));var Xm=function(){function e(){var t=this;(0,h.Z)(this,e),this._sheet=null,this._views=new Map,this._shellEventMap=new Map,this.onShellEvents=function(e,n){var r={};return t._shellEventMap.forEach((function(i,o){t._views.get(o)&&(r[o]=i(e,n))})),r[t.activeViewName]}}return(0,d.Z)(e,[{key:"destroy",value:function(){this.views.clear(),this._shellEventMap.clear(),this._sheet=null}},{key:"registerShell",value:function(){this._sheet&&this._sheet.registerShell(this.onShellEvents)}},{key:"addShellEventHandler",value:function(e,t){this._shellEventMap.set(e,t)}},{key:"unregisterShell",value:function(){this._sheet&&this._sheet.unRegisterShell()}},{key:"activeView",value:function(){return this._views.get(this.activeViewName)}},{key:"addView",value:function(e,t){this._views.set(e,t)}},{key:"removeView",value:function(e){this._views.delete(e)}},{key:"hasView",value:function(e){return this._views.has(e)}},{key:"hideView",value:function(e){this._views.forEach((function(t,n){(0,b.Z)(e,n)||t.hide()}))}},{key:"switchView",value:function(e,t){this._activeView=e;var n=(0,E.default)(t,"retainViews",[]);this.hideView([].concat((0,a.Z)(n),[e]));var r=this._views.get(e);r&&r.show(t)}},{key:"updateSheet",value:function(e){this.unregisterShell(),this._sheet=e,this.registerShell(),this._views.forEach((function(t,n){null==t||t.updateSheet(e)}))}},{key:"activeViewName",get:function(){return this._activeView}},{key:"views",get:function(){return this._views}}]),e}(),Km=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments)))._view=null,e.key="SheetApp",e._bindDomList=new Map,e.bindCellPosition=function(t){var n=t.key,r=t.cb;e._bindDomList.has(n)&&e.unbindCellPosition({key:n}),e._bindDomList.set(n,(function(){return r(e._data.worksheet),!1}))},e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"initAppModel",value:function(e){var t=this;k.Provider.create(Fd,this),this.appModel=k.Provider.of(Fd,this),this.appModel.setShellUIConfig(e.uiConfig),this.appModel.watch((function(){(0,k.markStateDirty)(t)}))}},{key:"setView",value:function(e,t,n){this._view=e,this._data=t,this._shell=n}},{key:"describe",value:function(){var e=this,t=k.Faster.findFaster(this),n=this.appModel.getSheetViewX(),r=this.appModel.getSheetViewY();if(this._view&&t){var i=t._size.width,o=t._size.height;return k.Stack.with({key:"AppStack"}).fill((function(){return[k.Positioned.with({key:"SheetViewPos",left:n,top:r}).fill((function(){return e._view.with(Object.assign({},e._data,{key:"SheetView",width:i,height:o}))})),k.Positioned.with({key:"mobileCompatibleWidget",left:0,top:0}).fill((function(){return(0,ye.widget2State)(e._shell.mobileCompatibleWidget)}))]}))}return null}},{key:"unbindCellPosition",value:function(e){var t=e.key;this._bindDomList.delete(t)}},{key:"afterLayout",value:function(){this._bindDomList.forEach((function(e){return e()}))}},{key:"destroy",value:function(){this._bindDomList.clear(),this._data={},this._shell={},this.state=null,(0,l.Z)((0,p.Z)(t.prototype),"destroy",this).call(this)}},{key:"rect",get:function(){return new k.FRect(this.pos.x,this.pos.y,this.size.width,this.size.height)}}]),t}(k.FBaseWidget);hp([k.State],Km.prototype,"key",void 0);var qm=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).dispatch=function(n,r){(0,l.Z)(((0,s.Z)(e),(0,p.Z)(t.prototype)),"dispatch",(0,s.Z)(e)).call((0,s.Z)(e),n,r),(0,l.Z)(((0,s.Z)(e),(0,p.Z)(t.prototype)),"dispatch",(0,s.Z)(e)).call((0,s.Z)(e),Z.MSA,{type:n,props:r})},e}return(0,v.Z)(t,e),t}(Z.CPL);I.FontMeasurer.canvas.fakeHide();var $m,Jm=function(){function e(t,n,r){var i=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(0,h.Z)(this,e),this._container=n,this.viewModelManager=r,this._eventTypeSet=new Set,this._isActive=!1,this.$watcher=new qm,this.updateSheetIdle=function(e){return function(t){return i.sheet&&(i.sheet.parent.sheetIdle.isIdle=e),!1}},this._doResize=function(){var e=i._container.clientHeight,t=i._container.clientWidth;i.sheet&&(i._faster.resize(t,e),i._sheetView.resize(t,e),i._faster._dirtyWidgets.insert({uid:i._app.UID})),Tf.trigger(vc.SHELL.RESIZE,[vc.SHELL.RESIZE,i._app,{width:t,height:e}])},this.eventHandler=function(e,t,n){var r=k.Faster.findFaster(t);i.ui()===r&&i._eventEmitter.trigger(e,[n])},this.getFloatBlockSetting=function(e){return Dd(i,e)},this._teaLogInited=!1,this._eventEmitter=new(F());var a=o.isEmbed||!1,s=o.isFeed||!1,u=o.hideRowColHeaderEnable||!1;this.mobileCompatibleWidget=new k.FWidget(null),this.mobileCompatibleWidget.updateByCfg({skipSelfEvent:!0});var l={alpha:!0,defaultBackground:"var(--bg-body)"};if(o.canvasReuseSwitcher)this._faster=o.canvasReuseSwitcher.createFaster(k.Faster,n,l),this._faster.resize(n.clientWidth,n.clientHeight);else{var c,d=(null===(c=n.querySelectorAll)||void 0===c?void 0:c.call(n,'canvas[role="faster"]'))||[],f=d.length>0?d[0]:n,p=new k.Faster(f,l);p.eventDom().setAttribute("role","faster"),p.resize(f.clientWidth,f.clientHeight),this._faster=p}this.registerCustomThemeColors(),(0,k.registerColorTheme)(this._faster,mf);var v=function(e){return e.srcEventPreventDefault(),a};this._faster.runApp(Km.with({onPinchStart:v,onPinchMove:v})),this._app=this._faster.app(),this.trunOnSheetIdle=this.updateSheetIdle(!0),this.trunOffSheetIdle=this.updateSheetIdle(!1),this._faster.addListener(k.FEventType.BeforeTick,this.trunOffSheetIdle),this._faster.addListener(k.FEventType.EmptyTick,this.trunOnSheetIdle),this._configId=this._app.UID,this._viewManager=new Xm,this._app.setRootId(this._faster.UID),this._app.initAppModel({uiConfig:this.getUIConfig(a)}),this._app.setView(t,{p:this._app,worksheet:null,options:{isEmbed:a,isFeed:s,hideRowColHeaderEnable:u,shellWatcher:this.$watcher,viewManager:this._viewManager,embedRightPadding:o.embedRightPadding,viewModelManager:this.viewModelManager}},this),this._app.build(),this._sheetView=this._app.children()[0].children()[0].children()[0],this._viewManager.addView("SHEET_VIEW",this._sheetView),this._viewManager.switchView("SHEET_VIEW"),a||this._sheetView.addListener(k.FEventType.MouseWheel,(function(e){var t=e;return i._isHorizontalSwipe(Math.abs(t.deltaX),Math.abs(t.deltaY))&&(window.__GESTURE_BACK_OR_FORWARD_TIMESTAMP__=Date.now()),!1})),this.activate(),this._sheetView.tlTable().addListener(k.FEventType.BeforeFlush,(function(e){return(e.changes.height||e.changes.width)&&Tf.trigger(vc.SHELL.FROZEN_AREA_OVERFLOW,[vc.SHELL.FROZEN_AREA_OVERFLOW,i._app,i._sheetView.isFrozenAreaOverflow()]),!1})),this._sheetView.tableContainer().addListener(k.FEventType.AfterFlush,(function(){return i._sheetView.isFrozenAreaChange()&&Tf.trigger(vc.SHELL.FROZEN_AREA_CHANGE,[vc.SHELL.FROZEN_AREA_CHANGE,i._app]),!1})),pf(),this.themeStateSubscription=(0,U.onUIStateChange)(pf)}var t;return(0,d.Z)(e,[{key:"subscribe",value:function(e,t){return this.$watcher.subscribe(e,t)}},{key:"unsubscribe",value:function(e,t){return this.$watcher.unsubscribe(e,t)}},{key:"registerCustomThemeColors",value:function(){[["#f5f6f7","#1a1a1a"],["#f0f4ff","#151f33"],["#1c4cba","#99bbff"]].forEach((function(e){var t=(0,c.Z)(e,2),n=t[0],r=t[1];return tf(n,r)}))}},{key:"getUIConfig",value:function(e){var t=(0,R.default)(Wf);return t.header.bgColor=e?uh:sh,e&&Object.assign(t,jf),t}},{key:"configId",value:function(){return this._configId}},{key:"getScrollPos",value:function(){return this._sheetView.getScrollPos()}},{key:"subscribePropagation",value:function(e){return this.$watcher.subscribe(Z.MSA,e)}},{key:"_isHorizontalSwipe",value:function(e,t){return 1.3*e>t}},{key:"getVisibleRange",value:function(){return this._sheetView.getVisibleRangeInfo()}},{key:"updateDPI",value:function(){k.FCanvasPool.updateDPI()}},{key:"exec",value:function(){var e=this;this._isActive||(this._isActive=!0,k.ShadowCtl.enableShadow({appState:function(){var t;return JSON.stringify(null===(t=e.sheet)||void 0===t?void 0:t.parent.toJSON())},tree2Frame:function(){var e=[],t=(0,Rl.getFxs)();return console.log("this._apps",t),t.forEach((function(t){if(t){var n=(0,Rl.export2FvgTree)(t);n&&e.push(n)}})),e}}),this._faster.exec())}},{key:"tick",value:function(){this._faster.tick()}},{key:"exit",value:function(){var e;this._viewManager.destroy(),this._faster.removeListener(k.FEventType.BeforeTick,this.trunOffSheetIdle),this._faster.removeListener(k.FEventType.EmptyTick,this.trunOnSheetIdle),this._faster.exit(),this.deactive(),k.ShadowCtl.disableShadow(),k.Provider.clear(),this._app.destroy(),this._eventEmitter.removeAllListeners();var t,n=cc(this._eventTypeSet);try{for(n.s();!(t=n.n()).done;){var r=t.value;Tf.off(r,this.eventHandler)}}catch(e){n.e(e)}finally{n.f()}this._eventTypeSet.clear(),I.DomImagePool.gcCheck(),null!==(e=this.themeStateSubscription)&&void 0!==e&&e.call(this),this.sheet=void 0}},{key:"deactive",value:function(){this._isActive=!1}},{key:"activate",value:function(){this._isActive=!0}},{key:"fx",value:function(){return this._app}},{key:"ui",value:function(){return this._faster}},{key:"isSheetMounted",value:function(){return void 0!==this.sheet}},{key:"sheetView",value:function(){return this._sheetView}},{key:"screenShot",value:(t=(0,o.Z)(i().mark((function e(){var t,n,r=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!(r.length>0&&void 0!==r[0])||r[0],this._sheetView.unselectFloatingObjects(!0,!0,!0),this._sheetView.tables().forEach((function(e){return e.renderEnv="print"})),e.next=4,this._sheetView.exportImage(t);case 4:return n=e.sent,e.abrupt("return",(this._sheetView.tables().forEach((function(e){return e.renderEnv="preview"})),this._sheetView.reselectFloatingObjects(),n));case 6:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"setEditable",value:function(e){this._sheetView.viewModel.setEditable(e)}},{key:"setRowEditable",value:function(e){this._sheetView.viewModel.setRowEditable(e)}},{key:"setColEditable",value:function(e){this._sheetView.viewModel.setColEditable(e)}},{key:"setResizeEditable",value:function(e){this._sheetView.viewModel.setResizeEditable(e)}},{key:"setDocumentReadonly",value:function(e){this._sheetView.viewModel.setIsDocumentReadonly(e)}},{key:"monitorNextTickTime",value:function(e){var t;this.onBeforeTick((function(){t=Date.now()})),this.onAfterTick((function(){var n=Date.now();e(n-t,n)}))}},{key:"addTickListener",value:function(e,t){this._faster.addOnceListener(t,(function(){return e(),!1}))}},{key:"onBeforeTick",value:function(e){this.addTickListener(e,k.FEventType.BeforeTick)}},{key:"onAfterTick",value:function(e){this.addTickListener(e,k.FEventType.AfterTick)}},{key:"updateSheet",value:function(e){this.sheet=e,this._viewManager.updateSheet(e),this._sheetView.updateSheet(e)}},{key:"container",value:function(){return this._container}},{key:"bind",value:function(e,t){var n=this,r=Tf.getListeners(e);r&&r.length&&r.find((function(e){return n.eventHandler===e}))||(this._eventTypeSet.add(e),Tf.on(e,this.eventHandler)),this._eventEmitter.on(e,t)}},{key:"unbind",value:function(e,t){this._eventEmitter.off(e,t);var n=this._eventEmitter.getListeners(e);n&&n.length||(this._eventTypeSet.delete(e),Tf.off(e,this.eventHandler))}},{key:"addView",value:function(e,t){this._viewManager.addView(e,t)}},{key:"removeView",value:function(e){this._viewManager.removeView(e)}},{key:"viewManager",value:function(){return this._viewManager}},{key:"activeViewName",value:function(){return this._viewManager.activeViewName}},{key:"activeView",value:function(){return this.viewManager().activeView()}},{key:"beforeSwitch",value:function(e,t,n){}},{key:"getViewInstance",value:function(e,t){return null}},{key:"switchView",value:function(e,t){if(!this._viewManager.hasView(e)){var n=this.getViewInstance(e,t);n&&this.addView(e,n)}this.beforeSwitch(this.activeViewName(),e,t),this._viewManager.switchView(e,t)}},{key:"initTeaEvents",value:function(e){var t=this;this._teaLogInited||(this._teaLogInited=!0,[vc.LOG.CLICK_SHEET_HIDE,vc.LOG.CLICK_SHEET_HIDE_CANCEL,vc.LOG.CLICK_FULL_SHEET_BTN,vc.LOG.CLIENT_ADJUST_RANGE_SIZE,vc.LOG.EDIT_CELL_CONTENT,vc.LOG.CLICK_SHEET_VIEW,vc.SHEET_OPRATION].forEach((function(n){t.bind(n,(function(t){null==e||e(n,t)}))})))}},{key:"destroy",value:function(){this.$watcher.destroy()}},{key:"active",get:function(){return this._isActive}}]),e}(),Qm=(0,m.Z)((function(e){var t=e.isEmbed,n=wy;Z.P_e&&!t&&(n=By),Kf.injectableStaticConfig.selection.cornerWidgetType=n})),eE=function(e){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,h.Z)(this,t),Qm({isEmbed:!!r.isEmbed}),(0,f.Z)(this,(0,p.Z)(t).call(this,Ym,e,n,r))}return(0,v.Z)(t,e),t}(Jm);!function(e){e.START="START",e.END="END"}($m||($m={}));var tE=x.iw5,nE=x.kff,rE=function(){function e(t,n){(0,h.Z)(this,e),this.capacity=t,this.overSizeCb=n,this.cache=new Z.z6B(1/0),this.size=0}return(0,d.Z)(e,[{key:"updatePriority",value:function(e){this.cache.get(e)}},{key:"updateCell",value:function(e,t,n){var r=this.cache.get(e);void 0===r&&(r=new Z.z6B(1/0),this.cache.set(e,r));var i=r.size();r.set(tE(t,n),void 0);var o=r.size();this.size+=o-i,this.size>this.capacity&&this.overSizeCb(this.size-this.capacity)}},{key:"removeCount",value:function(e,t){var n=this.cache.getOldest(),r=(0,c.Z)(n,2),i=r[0],o=r[1];if(void 0!==i&&void 0!==o)for(e>this.size&&(e=this.size),this.size-=e;e--;){var a=o.removeOldest();if(void 0!==a){var s=nE(a);t&&t(i,s.row,s.col)}else{var u,l;if(this.cache.remove(i),e++,u=this.cache.getOldest(),i=(l=(0,c.Z)(u,2))[0],o=l[1],void 0===i||void 0===o)return void(this.size+=e)}}}},{key:"clear",value:function(){this.cache.clear(),this.size=0}},{key:"removeSheet",value:function(e){var t=this.cache.get(e,!1);t&&(this.size-=t.size()),this.cache.remove(e)}},{key:"removeCell",value:function(e,t,n,r,i){var o=this.cache.get(e,!1);if(o)for(var a=0;a<r;a++)for(var s=0;s<i;s++)o.remove(tE(t+a,n+s))&&(this.size-=1)}},{key:"length",get:function(){return this.size}}]),e}(),iE=function(){function e(t){var n=this;(0,h.Z)(this,e),this._idle=t,this._active=!1,this._calcArr=[],this._lastActiveTime=0,this._rafHandler=function(){var e=Date.now(),t=e-n._lastActiveTime;n._lastActiveTime=e,t<20&&n._doSlice(),n._active&&n._idle.registerIdleCallback(n._rafHandler,0)}}return(0,d.Z)(e,[{key:"addCalc",value:function(e){e.calculating=!0,this._calcArr.push(e),this._activate()}},{key:"removeCalcs",value:function(){this._calcArr.forEach((function(e){e.calculating=!1})),this.dispose()}},{key:"removeCalc",value:function(e){var t=this._calcArr.indexOf(e);-1!==t&&this._calcArr.splice(t,1),e.calculating=!1}},{key:"dispose",value:function(){this._calcArr.length=0,this._active=!1,this._idle.unRegisterIdleCallback(this._rafHandler)}},{key:"_activate",value:function(){this._active||(this._active=!0,this._lastActiveTime=Date.now(),this._idle.registerIdleCallback(this._rafHandler,0))}},{key:"_doSlice",value:function(){for(;this._calcArr.length>0&&Date.now()<this._lastActiveTime+20;){var e=this._calcArr[0];e.doSlice(),e.isCalcFinished()&&this.removeCalc(e)}0===this._calcArr.length&&(this._active=!1)}}]),e}();function oE(e,t){return e<t.start?-1:e>t.end?1:0}var aE=function(){function e(t,n){(0,h.Z)(this,e),this.viewModel=t,this.scheduler=n,this._dirtyRows=[],this._cacheRows=new Map,this.calculating=!1,this.addDirtyRows(0,this.viewModel.sheet.getRowCount())}return(0,d.Z)(e,[{key:"needToAdd",value:function(){if(this.calculating)return!1;var e=this.viewModel.sheet.parent;return!(!e||!e._context)&&(e._context.isEmbed&&e._context.isEmbed()||e.getActiveSheet()===this.viewModel.sheet)}},{key:"addDirtyRow",value:function(e){this.addDirtyRows(e,e+1)}},{key:"addDirtyRows",value:function(e,t){var n={start:e,end:t-1},r=(0,x.ry4)(this._dirtyRows,e,oE,!0);if(-1===r)this._dirtyRows[0]&&this._dirtyRows[0].start<=n.end+1?(this._dirtyRows[0].start=n.start,this._dirtyRows[0].end=Math.max(this._dirtyRows[0].end,n.end),this.mergeDirtyRow(0)):this._dirtyRows.unshift(n);else{var i=this._dirtyRows[r];if(i.start<=n.start&&i.end>=n.end)return;n.start<=i.end+1?(i.start=Math.min(i.start,n.start),i.end=Math.max(i.end,n.end),this.mergeDirtyRow(r)):(this._dirtyRows.splice(r+1,0,n),this.mergeDirtyRow(r+1))}this.needToAdd()&&this.scheduler.addCalc(this)}},{key:"mergeDirtyRow",value:function(e){for(var t=this._dirtyRows[e],n=e+1,r=this._dirtyRows.length;n<r;n++){if(this._dirtyRows[n].start>t.end){this._dirtyRows[n].start===t.end+1&&(t.end=this._dirtyRows[n].end,this._dirtyRows.splice(n,1));break}t.end=Math.max(t.end,this._dirtyRows[n].end),this._dirtyRows.splice(n,1),n--,r--}}},{key:"deleteDirtyRow",value:function(e){var t=(0,x.ry4)(this._dirtyRows,e,oE,!1);if(!(t<0)){var n=this._dirtyRows[t];n.start===e?n.start++:n.end===e?n.end--:(this._dirtyRows.splice(t+1,0,{start:e+1,end:n.end}),n.end=e-1),n.start>n.end&&this._dirtyRows.splice(t,1)}}},{key:"onDeleteRows",value:function(e,t){var n={start:e,end:e+t-1},r=(0,x.ry4)(this._dirtyRows,n.start,oE,!0),i=this._dirtyRows[r],o=this._dirtyRows[r+1]||{start:1/0,end:1/0};o.start<=n.end&&(o.start=n.end+1,o.start>o.end&&this._dirtyRows.splice(r+1,1)),i&&(n.end<=i.end?i.end-=t:i.end=n.start-1,(i.start>i.end||i.start<0&&i.end<0)&&(this._dirtyRows.splice(r,1),r--));for(var a=this._dirtyRows[r],s=r+1,u=this._dirtyRows.length;s<u;s++){var l=this._dirtyRows[s];l.start-=t,l.end-=t,l.start<0&&(l.start=0),l.start>l.end?(this._dirtyRows.splice(s,1),s--,u--):a&&a.end===l.start-1?(a.end=l.end,this._dirtyRows.splice(s,1),s--,u--):a=l}var c=new Map;this._cacheRows.forEach((function(n,r){r>=e?r>=e+t&&c.set(r-t,n):c.set(r,n)})),this._cacheRows=c}},{key:"onAddRows",value:function(e,t){var n=(0,x.ry4)(this._dirtyRows,e,oE,!0),r=this._dirtyRows[n];r&&(r.start===e?n--:r.end>=e&&(this._dirtyRows.splice(n+1,0,{start:e,end:r.end}),r.end=e-1));for(var i=n+1,o=this._dirtyRows.length;i<o;i++){var a=this._dirtyRows[i];a.start+=t,a.end+=t}var s=new Map;this._cacheRows.forEach((function(n,r){r>=e?s.set(r+t,n):s.set(r,n)})),this._cacheRows=s}},{key:"isCalcFinished",value:function(){return 0===this._dirtyRows.length}},{key:"hasDirty",value:function(){return 0!==this._dirtyRows.length||0!==this._cacheRows.size}},{key:"doSlice",value:function(){for(var e=1,t=this._dirtyRows.length>0;e--&&this._dirtyRows.length;){var n=this._dirtyRows[0];this._cacheFitRow(n.start),this.viewModel.typography.clearRowClipInfo(n.start),n.start++,n.start>n.end&&this._dirtyRows.shift()}t&&0===this._dirtyRows.length&&this.viewModel.sheet.invalidateRowHeight()}},{key:"isInDirtyRows",value:function(e){return(0,x.ry4)(this._dirtyRows,e,oE,!1)>-1}},{key:"isDirty",value:function(e){return this.isInDirtyRows(e)||this._cacheRows.has(e)}},{key:"getDirtyAutoRowHeight",value:function(e){if(this.isDirty(e)&&this.viewModel.sheet.needAutoRowHeight(e)){var t=this._cacheRows.get(e);return this.isInDirtyRows(e)&&(t=this.viewModel.getRowHeightHint(e)),t}}},{key:"calcRow",value:function(e){if(!this.isDirty(e))return!1;var t=!1;if(this.viewModel.sheet.needAutoRowHeight(e)){var n=this._cacheRows.get(e);this.isInDirtyRows(e)&&(n=this.viewModel.getRowHeightHint(e)),t=this.viewModel.sheet.setAutoRowHeight(e,n)}else t=!1;return this.viewModel.typography.clearRowClipInfo(e),this.deleteDirtyRow(e),this._cacheRows.delete(e),t}},{key:"cacheFitRow",value:function(e,t){t?(this._cacheRows.set(e,t),this.deleteDirtyRow(e)):(this._cacheFitRow(e),this.deleteDirtyRow(e))}},{key:"_cacheFitRow",value:function(e){if(this.viewModel.sheet.needAutoRowHeight(e)){var t=this.viewModel.getRowHeightHint(e);this._cacheRows.set(e,t)}}},{key:"calcSelf",value:function(){this.calculating||this.isCalcFinished()||this.scheduler.addCalc(this)}},{key:"calcSelfOnly",value:function(){this.calculating||this.isCalcFinished()||(this.scheduler.removeCalcs(),this.scheduler.addCalc(this))}},{key:"flushRowHeight",value:function(e){var t,n=!1,r=cc(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,o=this._cacheRows.get(i);"number"==typeof o&&(this.viewModel.sheet.setAutoRowHeight(i,o),this._cacheRows.delete(i),n=!0)}}catch(e){r.e(e)}finally{r.f()}n&&this.viewModel.sheet.dispatch("AutoRowSizeChanged")}},{key:"flushCacheHeight",value:function(){var e=this;this._cacheRows.forEach((function(t,n){e.viewModel.sheet.setAutoRowHeight(n,t)})),this.viewModel.sheet._getRowInfos().clearCache(),this._cacheRows.clear()}},{key:"dispose",value:function(){this.scheduler.removeCalc(this),this._dirtyRows.length=0,this._cacheRows.clear()}}]),e}(),sE="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0wLjU3NTE1OCAyLjY5NjcyQzAuMzc5ODk1IDIuODkxOTggMC4zNzk4OTUgMy4yMDg1NyAwLjU3NTE1OCAzLjQwMzgzQzAuNzcwNDIgMy41OTkwOSAxLjA4NyAzLjU5OTA5IDEuMjgyMjYgMy40MDM4M0wzLjQwMzU4IDEuMjgyNTFDMy41OTg4NSAxLjA4NzI1IDMuNTk4ODUgMC43NzA2NjQgMy40MDM1OCAwLjU3NTQwMkMzLjIwODMyIDAuMzgwMTQgMi44OTE3NCAwLjM4MDE0IDIuNjk2NDggMC41NzU0MDJMMC41NzUxNTggMi42OTY3MlpNMTIuNTk2IDAuNTc1NDAyQzEyLjc5MTIgMC4zODAxNCAxMy4xMDc4IDAuMzgwMTQgMTMuMzAzMSAwLjU3NTQwMkwxNS40MjQ0IDIuNjk2NzJDMTUuNjE5NyAyLjg5MTk4IDE1LjYxOTcgMy4yMDg1NyAxNS40MjQ0IDMuNDAzODNDMTUuMjI5MSAzLjU5OTA5IDE0LjkxMjYgMy41OTkwOSAxNC43MTczIDMuNDAzODNMMTIuNTk2IDEuMjgyNTFDMTIuNDAwNyAxLjA4NzI1IDEyLjQwMDcgMC43NzA2NjQgMTIuNTk2IDAuNTc1NDAyWk0wLjk5OTc3OSA5LjAwMDAyQzAuOTk5Nzc5IDEyLjg2NiA0LjEzMzc5IDE2IDcuOTk5NzggMTZDMTEuODY1OCAxNiAxNC45OTk4IDEyLjg2NiAxNC45OTk4IDkuMDAwMDJDMTQuOTk5OCA1LjEzNDAzIDExLjg2NTggMi4wMDAwMiA3Ljk5OTc4IDIuMDAwMDJDNC4xMzM3OSAyLjAwMDAyIDAuOTk5Nzc5IDUuMTM0MDMgMC45OTk3NzkgOS4wMDAwMlpNMTAuNDk5OCA4LjAwMDAySDcuOTk5NzhWNS41MDAwMkM3Ljk5OTc4IDUuMjIzODggNy43NzU5MiA1LjAwMDAyIDcuNDk5NzggNS4wMDAwMkM3LjIyMzY0IDUuMDAwMDIgNi45OTk3OCA1LjIyMzg4IDYuOTk5NzggNS41MDAwMlY5LjAwMDAySDEwLjQ5OThDMTAuNzc1OSA5LjAwMDAyIDEwLjk5OTggOC43NzYxNyAxMC45OTk4IDguNTAwMDJDMTAuOTk5OCA4LjIyMzg4IDEwLjc3NTkgOC4wMDAwMiAxMC40OTk4IDguMDAwMDJaIiBmaWxsPSIjMzM3MEZGIi8+Cjwvc3ZnPgo=",uE="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjQgNCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMTMuNTYgOC4zOGEuNzUuNzUgMCAwMTEuMDYgMS4wNkwxMCAxNC4wOGEuNzIuNzIgMCAwMDEuMDIgMS4wMmw1LjI3LTUuMjhhMi4xOSAyLjE5IDAgMTAtMy4xLTMuMDlMNy43IDEyLjIxYTMuNTYgMy41NiAwIDEwNS4wNCA1LjA0bDMuOTgtMy45OGEuNzUuNzUgMCAxMTEuMDYgMS4wNmwtMy45OCAzLjk4YTUuMDYgNS4wNiAwIDAxLTcuMTYtNy4xNmw1LjQ5LTUuNDhhMy42OSAzLjY5IDAgMTE1LjIgNS4yMWwtNS4yNiA1LjI4YTIuMjIgMi4yMiAwIDAxLTMuMTQtMy4xNGw0LjYzLTQuNjR6IiBmaWxsPSIjMzM3MGZmIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD48L3N2Zz4=",lE=function(){function e(t,n){(0,h.Z)(this,e),this.idx=t,this.linkColor="var(--B500)",this.linkVisitedColor="var(--B600)",this.mentionColor="var(--B500)",this.seg=n}return(0,d.Z)(e,[{key:"color",value:function(){switch(this.seg.type){case Z.K6s.URL:return this.seg.visited?this.linkVisitedColor:this.linkColor;case Z.K6s.MENTION:case Z.K6s.PANO:case Z.K6s.ATTACHMENT:return this.mentionColor}return""}},{key:"fontInfo",value:function(){}},{key:"imageInfo",value:function(){return"embed-image"===this.seg.type?{width:this.seg.width,height:this.seg.height,link:this.seg.link}:{width:0,height:0,link:""}}},{key:"type",value:function(){return this.seg.type}},{key:"textDecoration",value:function(){var e=this;return["url","attachment"].some((function(t){return t===e.seg.type}))?I.TextDecoration.Bottom:I.TextDecoration.None}},{key:"setIconPadding",value:function(e){this._iconPadding=e}},{key:"getIconPadding",value:function(){return this._iconPadding}},{key:"setPaddingIcon",value:function(e){this._paddingIcon=e}},{key:"paddingIcon",value:function(){if(this._paddingIcon)return this._paddingIcon;if(this.seg.type===Z.K6s.MENTION){if(Z.Ps3.getIsSheetCustomIconEnabled()){var e=Z.Ps3.getMentionIconSource(this.seg).resource;return this.setPaddingIcon(e),e}return Z.Ps3.getSuiteUrlConfig().icons[this.seg.mentionType]||""}return this.seg.type===Z.K6s.REMINDER?sE:this.seg.type===Z.K6s.ATTACHMENT?uE:""}},{key:"fallbackIcon",value:function(){switch(this.seg.type){case Z.K6s.MENTION:return Z.Ps3.getSuiteUrlConfig().icons[this.seg.mentionType]||"";case Z.K6s.REMINDER:return sE;case Z.K6s.ATTACHMENT:return uE}return""}},{key:"style",get:function(){return this.seg.style||null}},{key:"texts",get:function(){return this.seg.texts||null}}]),e}(),cE=M.N600,hE=function(e){function t(e,n,r){var i;return(0,h.Z)(this,t),(i=(0,f.Z)(this,(0,p.Z)(t).call(this,e,n)))._sheet=r,i}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"getEmbedPermissionManager",value:function(){return this._sheet.parent.getEmbedPermissionManager()}},{key:"color",value:function(){var e=(0,l.Z)((0,p.Z)(t.prototype),"color",this).call(this);return this.hasPermission()||(e=cE),e}},{key:"paddingIcon",value:function(){var e=this.getEmbedPermissionManager();if(!e)return(0,l.Z)((0,p.Z)(t.prototype),"paddingIcon",this).call(this);var n=this.seg.mentionType;return e.getIcon(n,this.hasPermission())}},{key:"hasPermission",value:function(){var e=this.getEmbedPermissionManager();if(!e)return true;var t=this.seg,n=t.token,r=t.mentionType,i=e.getPermission(n);return i?i.readable:(e.addEmbedObj(n,r),true)}}]),t}(lE),dE=M.N600,fE=function(e){function t(e,n,r){var i;return(0,h.Z)(this,t),(i=(0,f.Z)(this,(0,p.Z)(t).call(this,e,n)))._sheet=r,i}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"color",value:function(){var e=(0,l.Z)((0,p.Z)(t.prototype),"color",this).call(this);return this.hasPermission()||(e=dE),e}},{key:"fontInfo",value:function(){return this.hasPermission()?(0,l.Z)((0,p.Z)(t.prototype),"fontInfo",this).call(this):{fontWeight:500}}},{key:"hasPermission",value:function(){var e=this._sheet.parent,t=e.getUserPermissionManager(),n=e._context.userId;return!t||!n||!Z.Ps3.getMentionOptimizeEnabled()&&!t.hasPermission(n,"shareable")||t.hasPermission(this.seg.token,"readable")}}]),t}(lE);function pE(e,t,n,r){var i=e.visualInfo(),o=new k.FRect(i.x,t.y,i.width,i.height);return r&&(o.x-=ep[3],o.width+=ep[1]+ep[3]),i.x>=0&&(o.x+=t.x),null!==n&&!n.containRect(o)&&n}function vE(e,t,n){return t=Object.assign({},t),(0,x.LSy)(t)?new fE(e,t,n):(0,x.PHR)(t)?new hE(e,t,n):new lE(e,t)}function gE(e,t,n){for(var r=n.sheet,i=n.insets,o=n.styleAttrs,a=n.justOneLine,s="",u=0;u<e.length&&(!a||0!==e[u].text.length&&8629!==e[u].text.charCodeAt(0));u++){var l=EE(vE(u,e[u],r),t,n);t+=l.text.length,s+=l.text}return{insets:i,text:s,styleAttrs:o}}function _E(e,t,n,r){var i=r.insets,o=r.styleAttrs,a=r.defaultFontStyle,s=mE(e,r),u=function(e,t){var n=e.fontFamily||(null==t?void 0:t.fontFamily)||"Arial",r=e.fontWeight||(null==t?void 0:t.fontWeight)||I.FontWeight.normal,i=e.fontSize||(null==t?void 0:t.fontSize)||12;return null===yE?yE=new I.FontMeasurer(n,r,i):yE.update(n,r,i),yE}(s.fontInfo,a),l=Math.ceil(u.measureWord(n)),c=u.lineHeight(),h={text:n,style:s};return o.push({rg:{from:t,to:t+1},style:s}),i.push({pos:t+1,width:l,height:c,inline:!0,wrapText:!0,customData:h}),{insets:i,text:"​​",styleAttrs:o}}var yE=null;function mE(e,t){var n=t.row,r=t.col,i=t.sheet,o=t.ignoreFontSize,a=t.context,s=a.style,u=i.getStyle(n,r),l=a.reminder?Z.nn5:M.N900,c=i.getLineHeightFactor(),h=e.type(),d=function(e,t,n){var r=e.color();if(r)return r;var i=t.foreColor,o=n.foreColor;if(e.style&&e.style.foreColor){var a=e.style.foreColor;return a!==i?a:o}return o}(e,u,s)||l,f=function(e,t,n){var r=e.textDecoration(),i=t.textDecoration||Z.aBM.none,o=n.textDecoration||Z.aBM.none,a=(i&Z.aBM.underline)===Z.aBM.underline,s=(o&Z.aBM.underline)===Z.aBM.underline,u=(i&Z.aBM.lineThrough)===Z.aBM.lineThrough,l=(o&Z.aBM.lineThrough)===Z.aBM.lineThrough;if(e.style&&void 0!==e.style.textDecoration){var c=e.style.textDecoration,h=(c&Z.aBM.underline)===Z.aBM.underline,d=(c&Z.aBM.lineThrough)===Z.aBM.lineThrough;return h!==a?h?r|=Z.aBM.underline:r&=~Z.aBM.underline:s&&(r|=Z.aBM.underline),d!==u?d?r|=Z.aBM.lineThrough:r&=~Z.aBM.lineThrough:l&&(r|=Z.aBM.lineThrough),r}return r|o}(e,u,s)||Z.aBM.none,p=Object.assign({},CE(e,u,s)||{},{},e.fontInfo()||{});return o&&delete p.fontSize,{color:d,decoration:f,cursor:TE(h,t.isSegmentInteractionDisabled),fontInfo:p,lineHeight:o?void 0:Math.ceil(c*(p.fontSize||x.OvR)),customData:e}}function EE(e,t,n){var r=n.sheet,i=n.insets,o=n.styleAttrs,s=n.needTrim,u=n.userMentionRenderAsText,l=r.parent.userLanguage,c=s?(0,x.dbt)(e.seg,l).trim():(0,x.dbt)(e.seg,l);if((0,Z.tMY)(e.seg)&&!u&&!n.roadsterRichTextEnable)return _E(e,t,c,n);if(n.roadsterRichTextEnable&&((0,Z.TZl)(e.seg)||(0,Z.IXt)(e.seg)||(0,Z.S3_)(e.seg)))return o.push({rg:{from:t,to:t+c.length-1},style:mE(e,n)}),{insets:i,text:c,styleAttrs:o};if(function(e,t,n){var r=n.row,i=n.col,o=n.sheet,a=n.insets,s=n.ignoreFontSize,u=n.customIconSize,l=n.getImgShowSizeFn,c=n.context,h=e.paddingIcon(),d=e.type();if(h){var f,p,v=c.style,g=CE(e,o.getStyle(r,i),v);if(s&&delete g.fontSize,u)f=u,p=u;else{var _,y=1*(null!==(_=null==g?void 0:g.fontSize)&&void 0!==_?_:16),m=tp[d]||np;e.setIconPadding(m),f=y+m[1]+m[3],p=y+m[0]+m[2]}a.push({pos:t,width:f,height:p,inline:!0,wrapText:!0,customData:e})}if(d===Z.K6s.EMBED_IMAGE){var E,b,T=e.imageInfo();if(l){var C=l(T);E=C.width,b=C.height}else{var S=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=0,o=0;if((e=e-1-t[1]-t[3])>n||0===n)i=n,o=r;else{var a=r/n;i=e,o=Math.ceil(i*a)}return{showImgWidth:i,showImgHeight:o}}(o.getCellWidth(r,i,!0),o.getCellPadding(),T.width,T.height),w=S.showImgHeight;E=S.showImgWidth,b=w}a.push({pos:t,width:E,height:b,inline:!0,wrapText:!1,customData:e})}}(e,t,n),e.texts){var h=gE(e.texts,t,Object.assign({},n,{insets:[],styleAttrs:[]}));i.push.apply(i,(0,a.Z)(h.insets)),o.push.apply(o,(0,a.Z)(function(e,t,n){var r=e.type();switch(r){case Z.K6s.URL:case Z.K6s.MENTION:case Z.K6s.PANO:case Z.K6s.ATTACHMENT:return t.map((function(t){return t.style.color=e.color(),t.style.customData=e,t.style.cursor=TE(r,n.isSegmentInteractionDisabled),t.style.decoration=(t.style.decoration||0)|e.textDecoration(),t}));default:return t.map((function(t){return t.style.customData=e,t.style.cursor=TE(r,n.isSegmentInteractionDisabled),t}))}}(e,h.styleAttrs,n)))}else if(c){var d=mE(e,n);o.push({rg:{from:t,to:t+c.length-1},style:d})}return{insets:i,text:c,styleAttrs:o}}var bE=[Z.K6s.TEXT,Z.K6s.REMINDER];function TE(e,t){return t||bE.includes(e)?k.Cursor.Default:k.Cursor.Pointer}function CE(e,t,n){var r=t.fontInfo,i=n.fontInfo||{},o={fontStyle:i.fontStyle,fontWeight:i.fontWeight,fontSize:i.fontSize,fontFamily:i.fontFamily};if(e.style instanceof x.bgS){var a=e.style.fontInfo||{};a.fontWeight!==r.fontWeight&&(o.fontWeight=a.fontWeight),a.fontStyle!==r.fontStyle&&(o.fontStyle=a.fontStyle),a.fontSize!==r.fontSize&&(o.fontSize=a.fontSize),a.fontFamily!==r.fontFamily&&(o.fontFamily=a.fontFamily)}return o}var SE=function(e,t){if(!e||!t)return-1;for(var n=e.toString().split("."),r=t.toString().split(".");n.length&&r.length;){var i=Number(n.shift()),o=Number(r.shift());if(Number.isNaN(i)||Number.isNaN(o))return-1;if(i>o)return 1;if(i<o)return-1}return n.length?n.every((function(e){return 0===Number(e)}))?0:1:r.length?r.every((function(e){return 0===Number(e)}))?0:-1:0},wE=function(){var e=L().isSafari&&(SE(L().version,"15")>-1||SE(L().osversion,"15")>-1),t=!1;try{if(L().isIPad){var n="undefined"!=typeof window&&window.User&&window.User.userAgent||navigator.userAgent||"",r=/os (\d+([_\s]\d+)*) like mac os x/i.exec(n);r&&r.length>1&&SE(r[1].replace(/[_\s]/g,"."),15)>-1&&(t=!0)}}catch(e){console.log(e)}return e||t}();function RE(e){return wE&&(e=e.replace(/-apple-system,?/g,"").replace(/,$/,"")),e}var AE=!1,OE=!1;function ME(e){var t;return null===(t=e.style)||void 0===t?void 0:t.customData}var kE={name:"svg",type:"element",value:"",parent:null,attributes:{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},children:[{name:"path",type:"element",value:"",parent:null,attributes:{d:"M0.575158 2.69672C0.379895 2.89198 0.379895 3.20857 0.575158 3.40383C0.77042 3.59909 1.087 3.59909 1.28226 3.40383L3.40358 1.28251C3.59885 1.08725 3.59885 0.770664 3.40358 0.575402C3.20832 0.38014 2.89174 0.38014 2.69648 0.575402L0.575158 2.69672ZM12.596 0.575402C12.7912 0.38014 13.1078 0.38014 13.3031 0.575402L15.4244 2.69672C15.6197 2.89198 15.6197 3.20857 15.4244 3.40383C15.2291 3.59909 14.9126 3.59909 14.7173 3.40383L12.596 1.28251C12.4007 1.08725 12.4007 0.770664 12.596 0.575402ZM0.999779 9.00002C0.999779 12.866 4.13379 16 7.99978 16C11.8658 16 14.9998 12.866 14.9998 9.00002C14.9998 5.13403 11.8658 2.00002 7.99978 2.00002C4.13379 2.00002 0.999779 5.13403 0.999779 9.00002ZM10.4998 8.00002H7.99978V5.50002C7.99978 5.22388 7.77592 5.00002 7.49978 5.00002C7.22364 5.00002 6.99978 5.22388 6.99978 5.50002V9.00002H10.4998C10.7759 9.00002 10.9998 8.77617 10.9998 8.50002C10.9998 8.22388 10.7759 8.00002 10.4998 8.00002Z","fill-rule":"evenodd","clip-rule":"evenodd"},children:[]}]};function IE(e,t,n){var r,i=ME(e);if(null!=i&&null!==(r=i.seg)&&void 0!==r&&r.type)switch(function(e){n_||(r_[e]="true")}(i.seg.type),i.seg.type){case Z.K6s.TEXT:case Z.K6s.URL:return function(e,t){return el(Ru,{segment:e,content:e.text,style:t})}(e,t);case Z.K6s.MENTION:return function(e,t,n){var r,i,o=ME(e);if((0,Z.tMY)(o.seg))return Object.assign(t,{paddingBottom:"0px"}),el(ec,{segment:e,lineWrap:!1,dir:Eu.NONE,wrapperStyle:t,children:el(Tu,{children:el(Ru,{content:(null!==(r=e.text)&&void 0!==r?r:"").replace(/^@/,"")})})});var a=o.paddingIcon();return el(Bl,{segment:e,wrapperStyle:t,icon:Zl({data:n.addImage(a,o.fallbackIcon())}),children:el(Ru,{content:null!==(i=e.text)&&void 0!==i?i:""})})}(e,t,n);case Z.K6s.REMINDER:return function(e,t){var n,r=ME(e),i=r.seg;return el(Bl,{segment:e,wrapperStyle:t,iconStyle:{fontColor:null!=i&&null!==(n=i.notifyUsers)&&void 0!==n&&n.length?t.fontColor:Yf("reminder","icon-default")},icon:rc(kE),children:el(Ru,{content:r.seg.text})})}(e,t);case Z.K6s.ATTACHMENT:return function(e,t,n){var r=ME(e),i=r.paddingIcon();return el(Bl,{segment:e,wrapperStyle:t,icon:Zl({data:n.addImage(i,r.fallbackIcon())}),children:el(Ru,{content:r.seg.text,style:{underline:!0}})})}(e,t,n);default:return null}return null}function xE(e,t,n){return IE(e,t,n)}var NE,PE=new I.FTextPainter,LE=Qf[3]+14+Qf[1],DE=function(){function e(t,n){var r;(0,h.Z)(this,e),this.sheet=t,this.cache=n,ml.enableRenderIcon(!0),ml.useCustomRenderer({segment:xE}),OE||(OE=!0,null===(r=Z.Ps3.collectSheetEvent)||void 0===r||r.call(Z.Ps3,"ccm_sheet_rtl_usage_dev",{is_edit:"false"}))}return(0,d.Z)(e,[{key:"typographyInfo",value:function(e,t){var n=this.cache.getTypographyInfo(e,t);if(n)return void 0===n.clip&&this.recalcClipInfo(e,t,n),n;var r=this.getTypherContext(e,t),i=r.style,o=new k.FPoint(0,0),a=this.getTypography(e,t,r),s={type:a instanceof I.FTextPainter?1:0,typher:a,offset:o};if(a===PE)return s;if(a.lines().length>0){var u=a.visualInfo(),l=this.sheet.getCellHeight(e,t,!0)-1,c=this.sheet.getCellPadding(),h=c[0];h=i.vAlign===Z.g$I.Bottom?l-u.height-c[2]:i.vAlign===Z.g$I.Center?(l-u.height)/2:c[0];var d=r.dataValidation;if(o.x=c[3],d&&(0,x.b_9)(d)){var f;d.options.shouldHighlightValidData&&(o.x=ep[3]+c[3]);var p=null===(f=this.cache.getDVResult(e,t,d).getSpecialInfo())||void 0===f?void 0:f.listValidateInfo;p&&p.value[0]&&p.value[0][0]&&p.value[0][0].color&&(s.background=p.value[0][0].color)}o.y=h,o.x+=this.getLeftIconsWidth(e,t),o.x+=this.getPivotCellIndent(e,t);var v=this.clipRect(e,t,r),g=Boolean(d&&(0,x.Ju9)(d)&&d.options.shouldHighlightValidData);s.clip=pE(a,o,v,g)}return this.sheet.getIsCellVisible(e,t)&&this.cache.setTypographyInfo(e,t,s),s}},{key:"clipRect",value:function(e,t,n){var r=this,i=this.getLeftIconsWidth(e,t),o=n.dataValidation,a=this.getRightIconsWidth(e,t,o),s=Boolean(o&&(0,x.Ju9)(o)),u=this.sheet.getCellHeight(e,t,!0)-ph,l=this.sheet.getCellWidth(e,t,!0)-ph,c=new k.FRect(0,0,l,u),h=this.sheet.getCellPadding(),d=!1,f=!1;if(s&&(d=!0),this.isMergeCell(e,t))0!==i&&(f=!0);else{var p=n.style;if(0===p.wordWrap){var v=this.getTypography(e,t,n),g=!0,_=0,y=v.visualInfo(),m=l-i-a-h[1];if(y.width>m&&(g=!0,_=y.width),g){var E=function(e,t,n){var o=r.getLeftEmptySpace(t,n,_);0===i?(e.x-=o,e.width+=o):f=!0},b=function(e,t,n){var i=r.getRightEmptySpace(t,n,_);0===a?e.width+=i:d=!0};switch(this.getCellHAlign(n)){case I.HorizontalAlign.Left:b(c,e,t);break;case I.HorizontalAlign.Right:E(c,e,t);break;case I.HorizontalAlign.Center:E(c,e,t),b(c,e,t)}}}else 2===p.wordWrap&&(0!==a&&(d=!0),0!==i&&(f=!0))}return d&&(c.width-=a+h[1]),f&&(c.width-=i,c.x+=i),c}},{key:"getTypography",value:function(e,t,n,r){var i,o=this.cache.getTypography(e,t,r);return o||(n||(n=this.getTypherContext(e,t)),(i=this.canUseFTextPainter(n)?this.getTextPainter(e,t,n,r):this.getTypographer(e,t,n,r))!==PE&&this.cache.setTypography(e,t,i,r),i)}},{key:"getTextPainter",value:function(e,t,n,r){var i=n.style,o=this.getText(n);if(!o)return PE;var a=this.getTypographyOptions(e,t,n,r),s=a.defaultStyle,u=a.inlineAlign,l=s.color,c=s.lineHeight,h=s.decoration,d=function(e){if(e&&e.fontInfo){var t=e.fontInfo;return{fontFamily:t.fontFamily||I.TEXT_DEFAULT_FONT_STYLE.fontFamily,fontSize:t.fontSize||I.TEXT_DEFAULT_FONT_STYLE.fontSize,fontStyle:t.fontStyle||I.TEXT_DEFAULT_FONT_STYLE.fontStyle,fontWeight:t.fontWeight||I.TEXT_DEFAULT_FONT_STYLE.fontWeight}}return I.TEXT_DEFAULT_FONT_STYLE}(s),f=d.fontStyle,p=d.fontWeight,v=d.fontSize,g=d.fontFamily,_=this.getCellHAlign(n),y=this.sheet.getCellPadding();if(void 0===a.width)throw new Error("no width");var m=a.width,E=a.width+y[1]+y[3];return new I.FTextPainter({text:o,fontSize:v,fontFamily:g,fontStyle:f,fontWeight:p,color:l,hAlign:_,vAlign:i.vAlign,textDecoration:h||I.TextDecoration.None,width:E,contentWidth:m,lineHeight:c,firstLineTrim:I.TextTrim.Right,trim:I.TextTrim.All,inlineAlign:u})}},{key:"getTypographer",value:function(e,t,n,r){var i=n.style,o=n.dataValidation,a=this.getTypographyOptions(e,t,n,r),s=ml.createTypographer(a);if(o&&(0,x.Xfg)(o)){var u=this._handleMultipleValues(o,e,t,s,n);if(u)return u}var l,c=this.getSegmentArrays(n),h="";if(null!==c){var d=gE(c,0,{context:n,sheet:this.sheet,row:e,col:t,insets:[],styleAttrs:[],isSegmentInteractionDisabled:Ld(this.sheet.parent),roadsterRichTextEnable:!0}),f=d.text,p=d.insets,v=d.styleAttrs;h=f;var g=s.stream();p.forEach((function(e){return g.addInset(e)})),v.forEach((function(e){var t=e.style.fontInfo;t&&t.fontFamily&&(t.fontFamily=RE(t.fontFamily)),g.addStyleAttr(e)}))}else h=this.getText(n)||"";return c||h?(h&&s.stream().updateStr(h),s.stream().addAlignAttr({rg:{from:0,to:h.length},hAlign:this.getCellHAlign(n),vAlign:i.vAlign}),s.typography(),s.hasRTL&&(AE||(AE=!0,null===(l=Z.Ps3.collectSheetEvent)||void 0===l||l.call(Z.Ps3,"ccm_sheet_rtl_usage_dev",{is_rtl:"true",is_edit:"false"}))),s):PE}},{key:"getSegmentArrays",value:function(e){var t;if(null!==(t=e.content)&&void 0!==t&&t.segmentArray)return e.content.segmentArray;var n=this.createReminderSegment(e);if(n)return n;var r=(0,x.wYj)(e.content);if(r){var i,o=null===(i=e.style)||void 0===i?void 0:i.hideLink;return r&&1===r.length&&r[0].type===Z.K6s.URL&&o?null:r}return(0,x.BEd)(e.content)||null}},{key:"getTypographyOptions",value:function(e,t,n,r){var i=n.style,o=n.dataValidation,a=n.reminder?Z.nn5:M.N900,s={defaultStyle:{color:i.foreColor||a},ellipsis:null,inlineAlign:this.sheet.getInlineAlign()},u=s.defaultStyle;if(i&&i.fontInfo){var l=i.fontInfo;u.fontInfo=l,l.fontFamily=l.fontFamily&&RE(l.fontFamily),u.lineHeight=Math.ceil(this.sheet.getLineHeightFactor()*(l.fontSize||x.OvR))}i&&i.textDecoration&&(u.decoration=i.textDecoration),s.wordWrap=i&&1===i.wordWrap;var c=0,h=Boolean(o&&(0,x.Ju9)(o));if(r||0===i.wordWrap&&this.getCellHAlign(n)===Z.KqL.Left&&!this.isMergeCell(e,t)&&!h)c=Number.MAX_VALUE;else{var d=this.getRightIconsWidth(e,t,n.dataValidation),f=this.sheet.getCellPadding();c=this.sheet.getCellWidth(e,t,!0)-f[1]-f[3],c-=ph,d>0&&(c-=d,o&&(0,x.b_9)(o)&&o.options.shouldHighlightValidData&&(c-=ep[1]+ep[3]))}return c-=this.getLeftIconsWidth(e,t),c-=this.getPivotCellIndent(e,t),s.width=c,s}},{key:"_handleMultipleValues",value:function(e,t,n,r,i){var o,a=this,s=this.cache.getDVResult(t,n,e),u=s.getValue(),l=null===(o=s.getSpecialInfo())||void 0===o?void 0:o.listValidateInfo;if(!l)return null;var c=l.size();if(c<=0)return null;if(1===c&&!u)return null;for(var h=i.style,d=r._newMeasurer(h),f=d.lineHeight(),p=[],v=null,g=l.rowCount(),_=l.colCount(),y=0;y<g;y++)for(var m=0;m<_;m++){var E=l.value[y][m];if(v)if(E.color)p.push(v),p.push(E),v=null;else{var b=Object.assign({},v);b.delimiter=",",p.push(b),v=E}else E.color?(p.push(E),v=null):v=E;m+1===_&&v&&(p.push(v),v=null)}var T=f+2*Z.Y_J.padding[0],C=p.length;p.forEach((function(e,t){var n={},o="",s=e.color,u=[],l=0,c=e.segmentArray;if(c||(c=a.createReminderSegment(i)),c||(c=(0,x.wYj)(i.content)),c){var p=0,v=c.length;c.forEach((function(n,i){var o=vE(t,n,a.sheet),s=(0,x.dbt)(o.seg,a.sheet.parent.userLanguage);i===v-1&&e.delimiter&&(s+=e.delimiter);var c=o.type(),g=r.stream().defaultStyle(),_=o.color()||g.color||"",y=o.fontInfo(),m=y?Object.assign({},g.fontInfo,{},y):void 0;m&&m.fontFamily&&(m.fontFamily=RE(m.fontFamily));var E={color:_,decoration:o.textDecoration()|(h.textDecoration||I.TextDecoration.None),cursor:c===Z.K6s.TEXT||c===Z.K6s.REMINDER?"":"pointer",fontInfo:m};r.stream().addStyleAttr({rg:{from:0,to:v},style:E});var b=o.paddingIcon();if(b){var T=h.fontSizePx,C=1*(void 0!==T?T:16),S=tp[c]||np;o.setIconPadding(S);var w=C+S[1]+S[3],R=C+S[0]+S[2];u.push({x:p,width:w,height:R,icon:b,seg:o}),l+=w,p+=w}var A=Math.ceil(d.measureWord(s));u.push({x:p,width:A,height:f,style:E,text:s,seg:o}),l+=A,p+=A}))}else e.text&&(o=e.delimiter?e.text+e.delimiter:e.text,l=Math.ceil(d.measureWord(o)));n.text=o,n.style=h,n.customSegs=u,s&&(n.background=s,l=Math.max(Z.Y_J.minWidth,l+2*Z.Y_J.padding[1]),l+=Z.Y_J.margin[1]+Z.Y_J.margin[3],f=Math.max(Z.Y_J.minHeight,T),f+=Z.Y_J.margin[0]+Z.Y_J.margin[2]),r.stream().addInset({pos:t,width:l,height:f,inline:!0,wrapText:!0,customData:n})}));var S=Array(g).fill(" ".repeat(_-1)).join("\n");return r.stream().updateStr(S),r.stream().addAlignAttr({rg:{from:0,to:C},hAlign:this.getCellHAlign(i),vAlign:h.vAlign}),r.typography(Number.MAX_VALUE),r}},{key:"createReminderSegment",value:function(e){var t;return e.reminder&&null!==(t=e.content)&&void 0!==t&&t.variant?[{type:Z.K6s.REMINDER,text:(0,x.mWC)(e.style,this.sheet).format(e.content.variant.getValue()),notifyUsers:e.reminder.getNotifyUsers()}]:null}},{key:"getText",value:function(e,t){var n=e.reminder,r=e.content,i=e.style,o=null==r?void 0:r.segmentArray,a=null==r?void 0:r.variant;if(this.sheet.options.showFormulaText&&r&&r.variant&&r.variant.isFormula())return"=".concat(function(e,t){return(0,x.Vqk)(e,t||{ref:e.getRef()})}(r.variant));if(null!=r&&r.multipleValues){if(r.multipleValues.length>1){var s=i.formatter||null;return r.multipleValues.mergeToString({formatter:s})}var u=r.multipleValues.getFirstItem();o=u.segmentArray,a=u.variant}if(o)return new x.JG4(this.sheet.parent,o).getText(this.sheet.parent.userLanguage);if(a){var l=a.getValue();if("number"==typeof l&&(l=x.ITp._parseFloat(l)),t)return l;var c=(0,x.C7Q)(n,i,r,this.sheet);return c instanceof x.Formatter?c.format(l):(0,wl.createFormatter)(this.sheet.formatterService).format(l)}return""}},{key:"getTypherContext",value:function(e,t){var n=this.sheet,r=n.getStyleWithConditionalFormat(e,t),i=n.getImmutableContent(e,t),o=n.getReminder(e,t);return{style:r,content:i,dataValidation:n.getDataValidation(e,t),reminder:o}}},{key:"canUseFTextPainter",value:function(e){var t,n,r=e.style,i=e.content,o=e.dataValidation,a=e.reminder;if(1===r.wordWrap)return!1;if(i&&i.segmentArray)return!1;if(i&&i.variant){var s=i.variant.getVar();if(s){var u,l;if(s.type===El.VAR_TYPE.CUSTOM_PRIMITIVE&&!this.sheet.options.showFormulaText)return!1;if("function"==typeof s.getSpecialInfo&&null!==(u=s.getSpecialInfo())&&void 0!==u&&null!==(l=u.linkInfo)&&void 0!==l&&l.link)return!1}var c=s.getValue();if(c&&(0,y.Z)(c)){var h=Math.min(10,c.length);if(wr(c.slice(0,h)))return!1;for(var d=0;d<h;d++)if(t=c[d],n=void 0,(n=Hr(t))&(Jr|li)||!(n&(ii|$r))&&void 0)return!1}}return!(o&&(0,x.Xfg)(o)||a)}},{key:"clearRowClipInfo",value:function(e){for(var t=this.sheet.getColumnCount(),n=0;n<t;++n){var r=this.cache.getTypographyInfo(e,n);r&&r.typher!==PE&&(r.clip=void 0)}}},{key:"recalcRowClipInfo",value:function(e){for(var t=this.sheet.getColumnCount(),n=0;n<t;++n)this.recalcClipInfo(e,n)}},{key:"recalcClipInfo",value:function(e,t,n){if((n=n||this.cache.getTypographyInfo(e,t))&&n.typher!==PE&&this.sheet.getIsCellVisible(e,t)){var r=this.getTypherContext(e,t),i=this.clipRect(e,t,r),o=n,a=o.typher,s=o.offset,u=r.dataValidation,l=Boolean(u&&(0,x.Ju9)(u)&&u.options.shouldHighlightValidData);n.clip=pE(a,s,i,l)}}},{key:"getCellHAlign",value:function(e){var t=e.style,n=e.content,r=e.reminder;if(this.sheet.options.showFormulaText&&n&&n.variant&&n.variant.isFormula())return I.HorizontalAlign.Left;var i=t.hAlign;return(0,_.Z)(i)||i===Z.KqL.General?r?I.HorizontalAlign.Left:(0,x._d$)(t.hAlign,this.getText(e,!0),t.formatter):i}},{key:"isMergeCell",value:function(e,t){return!!this.sheet._spanModel.find(e,t)}},{key:"getRightIconsWidth",value:function(e,t,n){var r=0;return this.sheet.filterModel.getFilterButton(e,t)&&(r+=18),this.sheet.getPivotTableManager().getFilterSort(e,t)&&(r+=18),n&&(0,x.Ju9)(n)&&(n&&(0,x.Ju9)(n)&&n.options.isDropdownIconHiddenInCell||!this.sheet.isCellEditable(e,t)?r+=2:r+=$f+2),r}},{key:"getLeftIconsWidth",value:function(e,t){var n=0,r=this.sheet.conditionalFormatModel.getCellStyle(e,t);return r&&this.sheet.conditionalFormatModel.isIconsStyle(r)&&(n+=Jf[3]+24+Jf[1]),Z.Ps3.pivotTableHelper.getCollapse(this.sheet,e,t)&&(n+=LE),n}},{key:"getRightEmptySpace",value:function(e,t,n){for(var r=this.sheet.getColumnCount(),i=0;t++<r&&i<n&&(!this._hasContentOrIcon(e,t)||!this.sheet.getColumnVisible(t))&&!this.isMergeCell(e,t);)i+=this.sheet.getColumnWidth(t);return i}},{key:"getLeftEmptySpace",value:function(e,t,n){for(var r=0;t-- >0&&r<n&&(!this._hasContentOrIcon(e,t)||!this.sheet.getColumnVisible(t))&&!this.isMergeCell(e,t);)r+=this.sheet.getColumnWidth(t);return r}},{key:"getPivotCellIndent",value:function(e,t){var n=this.sheet.getPivotTableManager().getRepeatLabelInfo(e,t);return n.isRepeatLabel&&"col"!==n.dim?LE:0}},{key:"_hasContentOrIcon",value:function(e,t){if(this.sheet.hasContent(e,t))return!0;var n=this.sheet.getDataValidation(e,t);return!(!n||!(0,x.NgA)(n))||0!==this.getRightIconsWidth(e,t,n)}},{key:"cellOverflow",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.sheet.getCellHeight(e,t,!0),i=this.sheet.getCellWidth(e,t,!0),o=this.getTypherContext(e,t),a=o.style,s=o.dataValidation,u=(1===a.wordWrap?this.getTypography(e,t,o):this.getTypography(e,t,o,!0)).visualInfo(),l=r<u.height||i<u.width;if(n&&l&&0===a.wordWrap){var c,h=u.width-i,d=this.getCellHAlign(o);if(d===I.HorizontalAlign.Left){if(s&&(0,x.Ju9)(s))return l;c=this.getRightEmptySpace(e,t,h)+i<u.width}else if(d===I.HorizontalAlign.Right)c=this.getLeftEmptySpace(e,t,h)+i<u.width;else{var f=this.getLeftEmptySpace(e,t,h/2),p=this.getRightEmptySpace(e,t,h/2);c=f+i/2<u.width/2||p+i/2<u.width/2}return c||r<u.height}return l}},{key:"cellWidthHint",value:function(e,t){var n=this.sheet.getCellPadding();if(null===this.sheet._dataModel.getImmutableContent(e,t))return n[1]+n[3];var r=this.getTypherContext(e,t),i=this.getTypography(e,t,r,!0).visualInfo().width+n[1]+n[3],o=r.dataValidation;if(o&&(0,x.b_9)(o)){var a,s=null===(a=this.cache.getDVResult(e,t,o).getSpecialInfo())||void 0===a?void 0:a.listValidateInfo;s&&s.value[0]&&s.value[0][0]&&s.value[0][0].color&&(i+=ep[1]+ep[3])}return i+=this.getRightIconsWidth(e,t,r.dataValidation)+this.getLeftIconsWidth(e,t)+ph}}]),e}(),FE=function(){function e(t,n,r){var i=this;(0,h.Z)(this,e),this.sheet=t,this.changeSubject=new BE((function(e,t){return e[0]=Math.min(e[0],t[0]),e[1]=Math.max(e[1],t[1]),e})),this.scrollPos={posX:0,posY:0},this.measurer=new Ov(new x.SWH(t)),this.cache=new yp(t,r),this.typography=new DE(t,this.cache),this.fitRowCalc=new aE(this,n),this.sheet._rowInfos.onAutoSizeChange((function(e){i.cache.removeTypography(e,0,1,t.getColumnCount()),i.sheet._spanModel.getSpansByRow(e).forEach((function(e){return i.cache.removeTypography(e.rowFrom(),e.colFrom(),1,1)}))}))}return(0,d.Z)(e,[{key:"getMeasurer",value:function(){return this.measurer}},{key:"getFrozenX",value:function(){var e=this.sheet.frozenColumnCount();return 0===e?0:this.measurer.colPos(e)}},{key:"getFrozenY",value:function(){var e=this.sheet.frozenRowCount();return this.fitRowCalc.hasDirty()&&this.sheet._getRowInfos().iterEachActualVisible(0,e-1).forEach(this.fitRowCalc.calcRow.bind(this.fitRowCalc)),this.measurer.rowPos(e)}},{key:"measureRowPos",value:function(e){return this.sheet._getSheetColHeaderHeight()+this.measurer.rowPos(e)}},{key:"getColumnsWidthHint",value:function(e){var t=this;return e.map((function(e){return t.getColWidthHint(e)}))}},{key:"getColWidthHint",value:function(e){for(var t=0,n=0;n<this.sheet.getRowCount();n++)if(this.sheet.getRowVisible(n)){var r=n,i=this.sheet._spanModel.find(r,e);if(i&&i.colCount()>1)n=i.rowTo();else if(this.sheet.getRowHeight(r)>0){var o=this.typography.cellWidthHint(r,e);t=Math.max(t,o)}}var a=this.sheet.getCellPadding();return t=t===a[1]+a[3]?this.sheet.defaults.colWidth:t,Math.ceil(t)}},{key:"getRowHeightHint",value:function(e,t,n,r){t=void 0!==t?t:this.sheet.defaults.rowHeight,r=void 0!==r?r:this.sheet.getColumnCount()-1;var i=t;if(this.sheet._dataModel.isRowContentEmpty(e))return i;for(var o=0;o<this.sheet.getColumnCount();o++)if(this.sheet.getColumnVisible(o)){var a=o,s=this.sheet._spanModel.find(e,a);s&&s.rowCount()>1?o=s.colTo():i=Math.max(i,this.cellHeightHint(e,a))}return i}},{key:"cellHeightHint",value:function(e,t){if(null===this.sheet._dataModel.getImmutableContent(e,t))return 0;var n=this.sheet.getDataValidation(e,t),r=this.typography.getTypography(e,t),i=Math.ceil(r.visualInfo().height);if(!n||!(0,x.Xfg)(n)){var o=this.sheet.getCellPadding();i+=o[0]+o[2]}return i}},{key:"removeRangeCache",value:function(e,t,n,r){void 0!==e&&void 0!==t&&void 0!==n&&void 0!==r?this.cache.removeAllCache(e,t,n,r):(this.cache.resetCache(),e=0,n=this.sheet.getRowCount());var i=e+n;this.fitRowCalc.addDirtyRows(e,i),this.sheet._rowInfos.iterActualVisible(e,i-1).first()&&this.notifyChange(e,i)}},{key:"notifyChange",value:function(e,t){void 0===e||void 0===t?this.changeSubject.next([0,this.sheet.getRowCount()]):this.changeSubject.next([e,t])}},{key:"onChange",value:function(e){var t=this;return this.changeSubject.pipe((0,le.map)((function(e){return new k.FRect(0,e[0],t.sheet.getColumnCount(),e[1])}))).subscribe(e)}},{key:"getScrollPosition",value:function(){return this.scrollPos}},{key:"setScrollPosition",value:function(e,t){this.scrollPos.posX=e,this.scrollPos.posY=t}},{key:"destroy",value:function(){this.fitRowCalc.dispose(),this.cache.destroy()}}]),e}(),BE=function(e){function t(e){var n;return(0,h.Z)(this,t),(n=(0,f.Z)(this,(0,p.Z)(t).call(this))).aggregation=e,n.value=null,n}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"next",value:function(e){var n=this;null!==this.value?this.value=this.aggregation(this.value,e):(this.value=e,Promise.resolve().then((function(){null!==n.value&&(0,l.Z)((0,p.Z)(t.prototype),"next",n).call(n,n.value),n.value=null})))}}]),t}(K.xQ),VE=function(){function e(t){var n=this;(0,h.Z)(this,e),this.spread=t,this.sheetsMap=new Map,this.overCount=0,this.hasOverSizeCb=!1,this.cacheManager=new rE(1e4,(function(e){n.hasOverSizeCb||n.spread.sheetIdle.registerIdleCallback((function(){n.cacheManager.removeCount(n.overCount,n.removeCache),n.overCount=0,n.hasOverSizeCb=!1})),n.overCount=e,n.hasOverSizeCb=!0})),this.removeCache=function(e,t,n){e.removeTypography(t,n,1,1)},this.subscription=t.subscribe("SheetRemoved",(function(e){var t=e.sheet,r=n.getViewModel(t);r&&(n.sheetsMap.delete(t),n.cacheManager.removeSheet(r.cache),r.destroy())})),this.scheduler=new iE(t.sheetIdle)}return(0,d.Z)(e,[{key:"getViewModel",value:function(e){return this.sheetsMap.get(e)}},{key:"creatViewModel",value:function(e){var t=this.sheetsMap.get(e);return t||(t=new FE(e,this.scheduler,this.cacheManager),this.sheetsMap.set(e,t)),this.cacheManager.updatePriority(t.cache),t}},{key:"destroy",value:function(){this.cacheManager.clear(),this.sheetsMap.forEach((function(e){e.destroy()})),this.sheetsMap.clear(),this.subscription.unsubscribe()}}]),e}();function HE(e,t,n){function r(t,n){var r,i=t.range;null===(r=e.getViewModel(n))||void 0===r||r.removeRangeCache(i.rowFrom(),i.colFrom(),i.rowCount(!0),i.colCount(!0))}function i(t,n){var r=t.changes,i=t.type,o=e.getViewModel(n);if(o&&n._spanModel.forEach((function(e){o.cache.removeTypography(e.rowFrom(),e.colFrom(),1,1)})),0!==i&&1!==i)for(var a=0,s=r.length;a<s;a++)for(var u=r[a],l=u.row,c=l,h=l+u.count;c<h;c++)n._rowInfos.updateCache(c)}function o(t,n){var r=e.getViewModel(n);r&&(r.fitRowCalc.addDirtyRows(0,n.getRowCount()),n._spanModel.forEach((function(e){r.cache.removeTypography(e.rowFrom(),e.colFrom(),1,1)})))}function a(t,n,r){for(var i=0,o=n.length;i<o;i++){var a,s,u=n[i],l=u.target,c=u.count;t?null===(a=e.getViewModel(r))||void 0===a||a.fitRowCalc.onDeleteRows(l,c):null===(s=e.getViewModel(r))||void 0===s||s.fitRowCalc.onAddRows(l,c)}}function s(t,n,r){if(t){var i=e.getViewModel(r);if(!i)return;i.fitRowCalc.addDirtyRows(0,r.getRowCount()),i.notifyChange()}}function u(t,n){var r=n.getColumnCount(),i=e.getViewModel(n);if(i){for(var o=0,a=t.length;o<a;o++){var s=t[o],u=s.row,l=s.count,c=u+l;i.cache.removeTypography(u,0,l,r),i.fitRowCalc.addDirtyRows(u,c),i.notifyChange(u,c)}n._spanModel.forEach((function(e){i.cache.removeTypography(e.rowFrom(),e.colFrom(),1,1)}))}}function l(t,n){var r=n.getRowCount(),i=e.getViewModel(n);if(i){for(var o=0,a=t.length;o<a;o++){var s=t[o],u=s.col,l=s.count;i.cache.removeTypography(0,u,r,l)}n._spanModel.forEach((function(e){i.cache.removeTypography(e.rowFrom(),e.colFrom(),1,1)})),i.fitRowCalc.addDirtyRows(0,n.getRowCount()),i.notifyChange()}}var c={StyleChanged:r,RangeChanged:r,PivotTableRangeChanged:r,Sort:function(t,n){var r,i=t.range,o=i.rowFrom(),a=i.colFrom(),s=i.rowCount(!0),u=i.colCount(!0);null===(r=e.getViewModel(n))||void 0===r||r.removeRangeCache(o,a,s,u)},MoveRange:function(t,n){var r,i,o=t.fromRange,a=t.toRange,s=n.getColumnCount();null!==(r=e.getViewModel(o.sheet()))&&void 0!==r&&r.removeRangeCache(o.rowFrom(),o.colFrom(),o.rowCount(!0),s),null===(i=e.getViewModel(a.sheet()))||void 0===i||i.removeRangeCache(a.rowFrom(),a.colFrom(),a.rowCount(!0),s)},RowVisible:i,ColumnVisibleChanged:o,RowDeleted:a.bind(void 0,!0),ColumnDeleted:s.bind(void 0,!0),DataValidationRefChanged:function(t,n){for(var r=0,i=t.length;r<i;r++){var o,a=t[r];null===(o=e.getViewModel(n))||void 0===o||o.removeRangeCache(a.rowFrom(),a.colFrom(),a.rowCount(!0),a.colCount(!0))}},RowSizeChanged:u,ColumnSizeChanged:l,RowAdded:a.bind(void 0,!1),ColumnAdded:s.bind(void 0,!1),SpanRemoved:function(t,n){var r=e.getViewModel(n);r&&r.cache.removeTypography(t.rowFrom(),t.colFrom(),1,1)},DimensionPropertiesChanged:function(e,t){var n=e.rowDimensionInfo,r=e.colDimensionInfo;n&&n.forEach((function(e){var n=e.info,r=e.range;if(r){var o=n.size,a=n.hidden,s=n.customSize,l=[{row:r.start,count:r.end-r.start+1}];"number"!=typeof s&&"number"!=typeof o||u(l,t),"boolean"==typeof a&&i({changes:l,type:0},t)}})),r&&r.forEach((function(e){var n=e.info,r=e.range;if(r){var i=n.size,a=n.hidden,s=n.customSize,u=[{col:r.start,count:r.end-r.start+1}];"number"!=typeof s&&"number"!=typeof i||l(u,t),"boolean"==typeof a&&o(0,t)}}))},DataValidationFormulaMarkDirty:function(t,n){var r=e.getViewModel(n);r&&r.cache.iterDVCacheCells(t).forEach((function(e){r.removeRangeCache(e[1].row,e[1].col,1,1)}))}};return t.subscribe(c)}function UE(e,t){var n=[],r=null,i=new Set,o=t.calcEngine,a=o.formulaSpace,s=o.formulaService;function u(){l(t.calcEngine.formulaSpace.dirtyFormulas)}function l(e){ZE(n,e),c()}function c(){null===r&&(r=setTimeout((function(){r=null,WE(n,e),n.length=0})))}return a.addListener(El.FormulaSpaceEvents.onBatchFormulasDirty,l),s.addListener(El.FormulaEvents.onResumed,u),function(){a.removeListener(El.FormulaSpaceEvents.onBatchFormulasDirty,l),s.removeListener(El.FormulaEvents.onResumed,u),n.length=0,i.clear(),r&&(clearTimeout(r),r=null)}}function ZE(e,t){var n,r=cc(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;(0,x.sMb)(i)?e.push(i.getArrayRef()):(0,x.v4_)(i)||e.push(i.getRef())}}catch(e){r.e(e)}finally{r.f()}}function WE(e,t){for(var n=0;n<e.length;n++){var r,i=e[n],o=i.sheet();if(o&&i.isValidRefInSheet()){for(var a=i.rowFrom(),s=i.colFrom(),u=i.rowCount(),l=i.colCount(),c=0;c<u;c++)for(var h=a+c,d=0;d<l;d++){var f=s+d;o.chartModel.setValue(h,f)}null===(r=t.getViewModel(o))||void 0===r||r.removeRangeCache(a,s,u,l)}}}function jE(e,t){return t.subscribe("FormulaCacheApplied",(function(t){var n=[];ZE(n,t),WE(n,e)}))}!function(e){e[e.Typography=0]="Typography",e[e.TextPainter=1]="TextPainter"}(NE||(NE={}));var GE=function(e){function t(e){var n;(0,h.Z)(this,t),(n=(0,f.Z)(this,(0,p.Z)(t).call(this))).host=e,n.type=4;var r=e.worksheet$;return n.initSubscription(r),n}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"initSubscription",value:function(e){var t=this,n=e.pipe((0,de.R)(this.dispose$),(0,fe.h)((function(e){return Boolean(e)})),(0,le.map)((function(e){return e}))),r=n.pipe((0,le.map)((function(e){return e.outlineGroupModel}))).pipe((0,ce.w)((function(e){return e.hiddenSetChangedVersion$})),S_());(0,j.aj)(n,r).subscribe((function(e){var n=(0,c.Z)(e,1)[0];n.updateExcludedCols(),n.updateExcludedRows();var r=t.host.getViewModel(n);n.getSpans(new x.lq$(0,n.getRowCount(),n)).forEach((function(e){null==r||r.cache.removeTypography(e.rowFrom(),e.colFrom(),1,1)})),t.host.forceUpdate()}))}}]),t}(Z.JTr);function zE(e){return new GE(e)}var YE=function(e){function t(e){var n;return(0,h.Z)(this,t),(n=(0,f.Z)(this,(0,p.Z)(t).call(this))).worksheet$=e,n.data=null,n.zIndex=5,n.sub=new z.w,n.sub.add(e.pipe((0,fe.h)((function(e){return Boolean(e)}),(0,de.R)(n.dispose$))).subscribe((function(e){n.data=e.inject(x.bA2),n.sheet=e}))),n}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"render",value:function(e){var t=this;this.sub.add((0,X.T)(this.worksheet$.pipe((0,ce.w)((function(e){return(null==e?void 0:e.inject(x.bA2).visibleRanges$)||(0,G.of)([])}))),this.worksheet$.pipe((0,ce.w)((function(e){return(null==e?void 0:e.inject(x.bA2).primaryRanges$)||(0,G.of)([])})))).pipe(C_()).subscribe((function(){return e.getSheetView().forceUpdate()})));var n=this;return new ag("data_clean_background",(function(e,r,i,o,a){return t.sheet.cellModel.iterVisibleCellSpan(e,r,i,o,a).map((function(e){var r=e.row,i=e.col;if(n.data.cellInHighlightedRange(r,i))return[Object.assign({value:n.data.getIsFirstDuplicationItem()?eh:Qc},Id(t.sheet,r,i)),e]})).filter((function(e){return!!e}))}),!1,void 0,(function(){var e;return!(null!==(e=n.data)&&void 0!==e&&e.hasHighlightedRange())}))}},{key:"dispose",value:function(){(0,l.Z)((0,p.Z)(t.prototype),"dispose",this).call(this),this.sub.unsubscribe()}}]),t}(yv);function XE(e){return new YE(e.worksheet$)}var KE={color:"transparent",width:0},qE=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).view=null,e.rgs=[],e.ignore=!0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"initState",value:function(){var e=this;return this.rg$.subscribe((function(t){return e.rgs=t?[t]:[]}))}},{key:"describe",value:function(){var e=this;if(!this.view)return null;var t=_d;return k.Stack.fill((function(){return e.rgs.map((function(n){var r=nv(e.view,n,1,1),i=r.x,o=r.y,a=r.width,s=r.height;return k.Positioned.with({left:i,top:o,key:"data-clean-range"}).fill((function(){return k.Stack.fill((function(){return[k.SizedBox.with({width:a,height:s}).fill((function(){return k.BorderBox.with({border:t})}))]}))}))}))}))}}]),t}(_v);hp([k.State],qE.prototype,"view",void 0),hp([k.State],qE.prototype,"rgs",void 0),hp([k.State],qE.prototype,"ignore",void 0),hp([k.State],qE.prototype,"rg$",void 0);var $E=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).view=null,e.rgs=[],e.primaryRgs=[],e.ignore=!0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"initState",value:function(){var e=this,t=new z.w;return t.add(this.rgs$.subscribe((function(t){return e.rgs=t}))),t.add(this.primaryRgs$.subscribe((function(t){return e.primaryRgs=t}))),t}},{key:"describe",value:function(){var e=this;if(!this.view)return null;var t=this.primaryRgs.length>0,n=yd,r=t?Ed:md;return k.Stack.fill((function(){return(t?e.primaryRgs:e.rgs).map((function(t,i){var o=nv(e.view,t,1,1),a=o.x,s=o.y,u=o.width,l=o.height;return k.Positioned.with({left:a,top:s,key:"data-clean-visible-selection-".concat(i)}).fill((function(){return k.Stack.fill((function(){return[k.SizedBox.with({width:u,height:l}).fill((function(){return k.BorderBox.with({border:n})})),k.SizedBox.with({width:u,height:l}).fill((function(){return k.BorderBox.with({border:r})}))]}))}))}))}))}}]),t}(_v);hp([k.State],$E.prototype,"view",void 0),hp([k.State],$E.prototype,"rgs",void 0),hp([k.State],$E.prototype,"primaryRgs",void 0),hp([k.State],$E.prototype,"ignore",void 0),hp([k.State],$E.prototype,"rgs$",void 0),hp([k.State],$E.prototype,"primaryRgs$",void 0);var JE=function(e){function t(){var e;return(0,h.Z)(this,t),(e=(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))).view=null,e.rgs=[],e.ignore=!0,e}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"initState",value:function(){var e=this;return this.rgs$.subscribe((function(t){return e.rgs=t}))}},{key:"describe",value:function(){var e=this;if(!this.view)return null;var t=yd,n=bd;return k.Stack.fill((function(){return e.rgs.map((function(r,i){var o=nv(e.view,r,0,1,n.dashLine),a=o.x,s=o.y,u=o.width;return k.Positioned.with({left:a,top:s,key:"data-clean-invisible-selection-".concat(i)}).fill((function(){return k.Stack.fill((function(){return[k.SizedBox.with({width:u,height:2}).fill((function(){return k.BorderBox.with({border:[t,KE,KE,KE]})})),k.SizedBox.with({width:u,height:2}).fill((function(){return k.BorderBox.with({border:[n,KE,KE,KE]})}))]}))}))}))}))}}]),t}(_v);hp([k.State],JE.prototype,"view",void 0),hp([k.State],JE.prototype,"rgs",void 0),hp([k.State],JE.prototype,"ignore",void 0),hp([k.State],JE.prototype,"rgs$",void 0);var QE=function(e){function t(e){var n;return(0,h.Z)(this,t),(n=(0,f.Z)(this,(0,p.Z)(t).call(this))).zIndex=fv.HIGH,n.dataCleanModel$=e.pipe((0,le.map)((function(e){return null==e?void 0:e.inject(x.bA2)})),(0,de.R)(n.dispose$)),n}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"render",value:function(e){return[qE.with({key:"DataCleanRange",view:e,rg$:this.dataCleanModel$.pipe((0,ce.w)((function(e){return(null==e?void 0:e.range$)||(0,G.of)(null)})))}),$E.with({key:"DataCleanVisible",view:e,rgs$:this.dataCleanModel$.pipe((0,ce.w)((function(e){return(null==e?void 0:e.visibleRanges$)||(0,G.of)([])}))),primaryRgs$:this.dataCleanModel$.pipe((0,ce.w)((function(e){return(null==e?void 0:e.primaryRanges$)||(0,G.of)([])})))}),JE.with({key:"DataCleanInvisible",view:e,rgs$:this.dataCleanModel$.pipe((0,ce.w)((function(e){return(null==e?void 0:e.invisibleRanges$)||(0,G.of)([])})))})]}}]),t}(gv);function eb(e){return new QE(e.worksheet$)}var tb=function(){function e(t){(0,h.Z)(this,e),this.axisY=void 0,this.setDrawerConfig(t)}return(0,d.Z)(e,[{key:"updateVisibleExtremumValue",value:function(){var e=this.value,t=(0,c.Z)(e.extremum,2),n=t[0],r=t[1],i=e.config.getExtremumMax(),o=i.type,a=i.value,s=e.config.getExtremumMin(),u=s.type,l=s.value;this.visibleMaxValue=o===Z.yre.custom&&void 0!==a?a:r,this.visibleMinValue=u===Z.yre.custom&&void 0!==l?l:n}},{key:"updateData",value:function(e,t,n,r){this.value=e,this.row=t,this.col=n,this.rect=r;var i=r.height,o=r.width,a=r.y,s=this.drawerConfig,u=s.paddingHorizontal,l=s.paddingVertical;this.visibleMaxY=a+l,this.visibleMinY=a+i-l,this.updateVisibleExtremumValue(),this.contentWidth=o-2*u,this.contentHeight=i-2*l,this.calcAxisY()}},{key:"checkExtremumValid",value:function(){return this.visibleMaxValue>=this.visibleMinValue}},{key:"clip",value:function(e){var t=this.drawerConfig,n=this.contentHeight,r=this.contentWidth,i=this.visibleMaxY,o=t.paddingHorizontal,a=this.rect.x;e.save(),e.beginPath(),e.rect(a+o,i,r,n),e.clip()}},{key:"isAxisOutOfView",value:function(){var e=this.axisY,t=this.visibleMaxY,n=this.visibleMinY;return void 0===e||e>n||e<t}},{key:"drawAxis",value:function(e){var t=this.drawerConfig,n=this.contentHeight,r=this.value,i=this.axisY,o=r.config.getAxisConfig(),a=o.visible,s=o.color;if(a&&void 0!==i){var u=t.paddingHorizontal,l=t.paddingVertical,c=t.axisOverflow,h=t.axisWeight,d=this.rect,f=d.width,p=d.x,v=d.y;this.isAxisOutOfView()||(e.save(),e.beginPath(),e.rect(p,v+l-h/2,f,n+h),e.clip(),e.beginPath(),e.moveTo(p+u-c,i),e.lineTo(p+f-u+c,i),e.strokeStyle=(0,N.getThemeColorByToken)(s||""),e.lineWidth=h,e.stroke(),e.closePath(),e.restore())}}},{key:"resetClip",value:function(e){e.restore()}},{key:"drawSparkline",value:function(e){this.checkExtremumValid()&&this.draw(e)}},{key:"setDrawerConfig",value:function(e){this.drawerConfig=e}},{key:"checkSpecialPointsVisible",value:function(){var e,t,n,r,i,o,a=this.value.config;return!!(null!==(e=a.getPoint("highPoint"))&&void 0!==e&&e.visible||null!==(t=a.getPoint("lowPoint"))&&void 0!==t&&t.visible||null!==(n=a.getPoint("firstPoint"))&&void 0!==n&&n.visible||null!==(r=a.getPoint("lastPoint"))&&void 0!==r&&r.visible||null!==(i=a.getPoint("negativePoint"))&&void 0!==i&&i.visible||null!==(o=a.getPoint("markersPoint"))&&void 0!==o&&o.visible)}},{key:"getValueColor",value:function(e){var t=this.value,n=t.data,r=t.config,i=(0,c.Z)(t.selfExtremum,2),o=i[0],a=i[1],s=n[e],u=r.getPoint("highPoint");if(null!=u&&u.visible&&s===a)return u.color;var l=r.getPoint("lowPoint");if(null!=l&&l.visible&&s===o)return l.color;var h=r.getPoint("firstPoint");if(null!=h&&h.visible&&0===e)return h.color;var d=r.getPoint("lastPoint");if(null!=d&&d.visible&&e===n.length-1)return d.color;var f=r.getPoint("negativePoint");if(null!=f&&f.visible&&s&&s<0)return f.color;var p=r.getPoint("markersPoint");return r.getType()===Z.bPy.Line&&null!=p&&p.visible?p.color:void 0}}]),e}(),nb=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";if(n<=0||!r)return!1;var i=t.x,o=t.y;return e.beginPath(),e.arc(i,o,n,0,2*Math.PI),e.fillStyle=r,e.fill(),e.closePath(),!0},rb=function(e,t,n,r,i,o){var a,s=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"";return!(r<0||i<0||!u)&&(e.beginPath(),e.moveTo(t,n),s?(a=n-i+o,e.lineTo(t,a),e.arc(t+o,a,o,Math.PI,1.5*Math.PI),e.lineTo(t+r-o,n-i),e.arc(t+r-o,a,o,1.5*Math.PI,0),e.lineTo(t+r,n),e.lineTo(t,n)):(a=n+i-o,e.lineTo(t+r,n),e.lineTo(t+r,a),e.arc(t+r-o,a,o,0,Math.PI/2),e.lineTo(t+o,n+i),e.arc(t+o,a,o,Math.PI/2,Math.PI),e.lineTo(t,n)),e.closePath(),e.fillStyle=u,e.fill(),!0)};function ib(e,t,n){var r=e/((n+1)*t-1);return{divideWidth:r,columnWidth:n*r}}function ob(e,t,n,r,i){return(r*(e-n)+i*(t-e))/(t-n)}function ab(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return n?"rgba(".concat(parseInt(n[1],16),", ").concat(parseInt(n[2],16),", ").concat(parseInt(n[3],16),", ").concat(t,")"):e}var sb=function(e){function t(){return(0,h.Z)(this,t),(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"updateData",value:function(e,n,r,i){(0,l.Z)((0,p.Z)(t.prototype),"updateData",this).call(this,e,n,r,i);var o=e.data;this.divide=this.contentWidth/(o.length-1)}},{key:"updateVisibleExtremumValue",value:function(){var e=this.value,t=(0,c.Z)(e.extremum,2),n=t[0],r=t[1],i=e.config.getExtremumMax(),o=i.type,a=i.value,s=e.config.getExtremumMin(),u=s.type,l=s.value;n===r&&(0===n?(n=-1,r=1):n>0?n=0:r=0),this.visibleMaxValue=o===Z.yre.custom&&void 0!==a?a:r,this.visibleMinValue=u===Z.yre.custom&&void 0!==l?l:n}},{key:"calcAxisY",value:function(){this.axisY=ob(0,this.visibleMaxValue,this.visibleMinValue,this.visibleMaxY,this.visibleMinY)}},{key:"clip",value:function(e){var t=this.drawerConfig,n=this.contentHeight,r=this.contentWidth,i=this.visibleMaxY,o=this.value,a=t.paddingHorizontal,s=o.config.getLineWidth(),u=this.rect.x;e.save(),e.beginPath(),e.rect(u+a,i-s/2,r,n+s),e.clip()}},{key:"draw",value:function(e){this.calcPointPositions(),this.drawAxis(e),this.clip(e),this.drawGradient(e),this.drawLine(e),this.resetClip(e),this.drawSpecialPoint(e)}},{key:"calcPointPositions",value:function(){var e=this.divide,t=this.rect,n=this.value,r=this.contentHeight,i=this.contentWidth,o=this.drawerConfig,a=this.visibleMaxValue,s=this.visibleMinValue,u=t.x,l=t.y,c=o.paddingHorizontal,h=o.paddingVertical,d=n.data;this.pointPosition=[];for(var f=0;f<d.length;f++){var p=d[f];void 0===p?this.pointPosition.push(void 0):p===x.mMO?this.pointPosition.push(p):Number.isFinite(e)?this.pointPosition.push({x:u+c+e*f,y:l+r*((a-p)/(a-s))+h}):this.pointPosition.push({x:u+i/2,y:l+r*((a-p)/(a-s))+h})}}},{key:"drawSpecialPoint",value:function(e){if(this.checkSpecialPointsVisible())for(var t=this.value,n=this.drawerConfig,r=this.visibleMaxY,i=this.visibleMinY,o=t.data,a=0,s=this.pointPosition.length;a<s;a++){var u=o[a],l=this.pointPosition[a];if(void 0!==u&&u!==x.mMO&&l&&!(l.y<r||l.y>i)){var c=this.getValueColor(a);c&&nb(e,l,n.pointRadius,(0,N.getThemeColorByToken)(c))}}}},{key:"drawLine",value:function(e){var t=this.value,n=this.pointPosition,r=t.config,i=(0,N.getThemeColorByToken)(r.getSeriesColor()),o=r.getLineWidth();e.beginPath(),e.lineJoin="round",e.lineCap="round";for(var a=0;a<n.length;a++){var s=n[a];if(void 0===s)e.lineWidth=o,e.strokeStyle=i,e.stroke(),e.closePath(),e.beginPath();else{if(s===x.mMO)continue;e.lineTo(s.x,s.y)}}e.lineWidth=o,e.strokeStyle=i,e.stroke(),e.closePath()}},{key:"drawGradient",value:function(e){var t=this.rect,n=this.value,r=this.drawerConfig,i=this.pointPosition,o=this.visibleMinY,a=n.data,s=n.config;if(s.getShowGradient()&&!(a.length<=1)){var u=t.height,l=t.width,h=t.x,d=t.y,f=r.paddingHorizontal,p=r.paddingVertical,v=r.gradient;v=void 0===v?[0,0]:v;var g,_=(0,c.Z)(v,2),y=_[0],m=_[1],E=(0,N.getThemeColorByToken)(s.getSeriesColor()),b=!1;e.beginPath(),e.moveTo(h+f,d+u-p);for(var T=0;T<a.length;T++){var C=i[T-1],S=i[T];S!==x.mMO&&(void 0!==S?void 0!==S&&(g=S,b&&e.lineTo(S.x,o),e.lineTo(S.x,S.y),b=!1):(b=!0,C?e.lineTo(C.x,o):C===x.mMO&&g&&(e.lineTo(g.x,o),g=void 0)))}e.lineTo(h+l-f,d+u-p),e.closePath();try{var w=e.createLinearGradient(h,d,h,d+u);w.addColorStop(0,ab(E,y)),w.addColorStop(1,ab(E,m)),e.fillStyle=w}catch(e){console.log("[SparklineLineDrawer]: Gradient Color error")}e.fill()}}}]),t}(tb),ub=function(e){function t(){return(0,h.Z)(this,t),(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"updateData",value:function(e,n,r,i){(0,l.Z)((0,p.Z)(t.prototype),"updateData",this).call(this,e,n,r,i),this.visibleMaxValue=1,this.visibleMinValue=-1}},{key:"calcAxisY",value:function(){this.axisY=this.rect.y+this.contentHeight/2+this.drawerConfig.paddingVertical}},{key:"draw",value:function(e){this.clip(e),this.drawColumns(e),this.resetClip(e),this.drawAxis(e)}},{key:"drawColumns",value:function(e){for(var t=this.rect,n=this.value,r=this.drawerConfig,i=this.contentHeight,o=this.contentWidth,a=this.axisY,s=r.paddingHorizontal,u=r.ratio,l=void 0===u?1:u,c=r.columnRadius,h=void 0===c?0:c,d=t.x,f=n.data,p=n.config,v=ib(o,f.length,l),g=v.divideWidth,_=v.columnWidth,y=this.checkSpecialPointsVisible(),m=0;m<f.length;m++){var E=f[m];if(E){var b=d+s+m*(_+g),T=a,C=i/2,S=Math.min(C,_),w=p.getShowRadius()?S<2*h?S/2:h:0,R=(0,N.getThemeColorByToken)(p.getSeriesColor()),A=this.getValueColor(m);y&&A&&(R=(0,N.getThemeColorByToken)(A)),rb(e,b,T,_,C,w,E>0,R)}}}}]),t}(tb),lb=function(e){function t(){return(0,h.Z)(this,t),(0,f.Z)(this,(0,p.Z)(t).apply(this,arguments))}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"updateData",value:function(e,n,r,i){(0,l.Z)((0,p.Z)(t.prototype),"updateData",this).call(this,e,n,r,i);var o=e.valueType,a=(0,c.Z)(e.extremum,2),s=a[0],u=a[1],h=e.config.getExtremumMax(),d=h.type,f=h.value,v=e.config.getExtremumMin(),g=v.type,_=v.value;d===Z.yre.custom&&void 0!==f?this.visibleMaxValue=f:o===x.I5U.Negative||o===x.I5U.NegativeAndZero?this.visibleMaxValue=0:this.visibleMaxValue=u,g===Z.yre.custom&&void 0!==_?this.visibleMinValue=_:o===x.I5U.Positive||o===x.I5U.PositiveAndZero?this.visibleMinValue=0:this.visibleMinValue=s}},{key:"calcAxisY",value:function(){var e,t,n=this.visibleMaxY,r=this.visibleMinY,i=this.visibleMaxValue,o=this.visibleMinValue,a=this.value,s=this.rect,u=this.contentHeight,l=this.drawerConfig,c=o===i;switch(a.valueType){case x.I5U.Null:t=e=s.y+u/2+l.paddingVertical;break;case x.I5U.Mix:t=e=ob(0,i,o,n,r);break;case x.I5U.Positive:o<=0?t=e=ob(0,i,o,n,r):(e=r,t=c?r:void 0);break;case x.I5U.PositiveAndZero:t=e=o<=0?ob(0,i,o,n,r):r;break;case x.I5U.Negative:i>=0?t=e=ob(0,i,o,n,r):(e=n,t=c?n:void 0);break;case x.I5U.NegativeAndZero:t=e=i>=0?ob(0,i,o,n,r):n;break;default:e=s.y+u/2+l.paddingVertical,t=void 0}this.columnBase=e,this.axisY=t}},{key:"draw",value:function(e){this.clip(e),this.drawColumns(e),this.resetClip(e),this.drawAxis(e)}},{key:"drawColumns",value:function(e){for(var t=this.rect,n=this.value,r=this.drawerConfig,i=this.contentHeight,o=this.contentWidth,a=this.visibleMaxValue,s=this.visibleMinValue,u=this.columnBase,l=t.x,c=r.paddingHorizontal,h=r.columnRadius,d=void 0===h?0:h,f=n.data,p=n.config,v=a-s,g=ib(o,f.length,3),_=g.divideWidth,y=g.columnWidth,m=this.checkSpecialPointsVisible(),E=0;E<f.length;E++){var b=f[E];if(b){var T=l+c+E*(y+_),C=u,S=Math.abs(b)*i/v,w=Math.min(S,y),R=p.getShowRadius()?w<2*d?w/2:d:0,A=(0,N.getThemeColorByToken)(p.getSeriesColor()),O=this.getValueColor(E);m&&O&&(A=(0,N.getThemeColorByToken)(O)),rb(e,T,C,y,S,R,b>0,A)}}}}]),t}(tb),cb={paddingVertical:4,paddingHorizontal:6,axisOverflow:4,axisWeight:1},hb=Object.assign({},cb,{pointRadius:2.5,gradient:[.2,0]}),db=Object.assign({},cb,{columnRadius:2,ratio:3}),fb=function(e){function t(e,n,r){var i;return(0,h.Z)(this,t),(i=(0,f.Z)(this,(0,p.Z)(t).call(this,"sparkline_layer",e,n,r))).name="sparkline_layer",i}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"_renderCell",value:function(e,t,n,r){if(t){var i=t.cell,o=i.rowCount,a=i.colCount,s=this.cell2Rect(n,r,o,a),u=t.config.getType(),l=this.getDrawerByType(u);l&&(l.updateData(t,n,r,s),l.drawSparkline(e))}}},{key:"getDrawerByType",value:function(e){switch(e){case Z.bPy.Line:return this.lineSparklineDrawer||(this.lineSparklineDrawer=new sb(hb)),this.lineSparklineDrawer;case Z.bPy.Column:return this.columnSparklineDrawer||(this.columnSparklineDrawer=new lb(db)),this.columnSparklineDrawer;case Z.bPy.WinLoss:return this.winLossSparklineDrawer||(this.winLossSparklineDrawer=new ub(db)),this.winLossSparklineDrawer;default:return null}}},{key:"cell2Rect",value:function(e,t,n,r){var i=this._measure.cell2DocPos(e,t),o=this._measure.measureHeight(e,e+n),a=this._measure.measureWidth(t,t+r);return new k.FRect(i.x,i.y,a,o)}}]),t}(I.FIterLayer),pb=function(e){function t(e){var n;(0,h.Z)(this,t),(n=(0,f.Z)(this,(0,p.Z)(t).call(this))).zIndex=8;var r=e.worksheet$.pipe((0,fe.h)((function(e){return Boolean(e)})),(0,de.R)(n.dispose$),(0,le.map)((function(e){return e}))).pipe((0,le.map)((function(e){return null==e?void 0:e.inject(x.hms)}))).pipe((0,ce.w)((function(e){return(null==e?void 0:e.dirtyRect$)||(0,G.of)(void 0)})));return(0,j.aj)(r).subscribe((function(e){var t,r=(0,c.Z)(e,1)[0];null===(t=n.host)||void 0===t||t.refresh(r)})),n}return(0,v.Z)(t,e),(0,d.Z)(t,[{key:"render",value:function(e){return new fb((function(t,n,r,i,o){return e.sheet().cellModel.iterVisibleSparkline(t,n,r,i,o).map((function(t){var n=(0,c.Z)(t,2),r=n[0],i=n[1],o=e.sheet(),a=o.getSparklineModel().dataMgr.getDataById(r.getId()),s=o.getSparklineGroupByGroupId(r.getGroupId());if(!a||!s)return[null,i];var u=a.data,l=a.selfExtremum;return[{data:u,extremum:a.extremum,selfExtremum:l,valueType:a.valueType,config:s,cell:Id(o,i.row,i.col)},i]}))}),void 0)}}]),t}(yv);function vb(e){return new pb(e)}},vsh_56314:function(e,t,n){"use strict";n.d(t,{_q:function(){return a},PG:function(){return s},ZK:function(){return u},vU:function(){return l}});var r=n("vsh_98652"),i="Roadster";function o(e,t,n){return[n?"[".concat(i," ").concat(n," ").concat(e,"]: "):"[".concat(i," ").concat(e,"]: ")].concat((0,r.Z)(t))}var a=function(e){var t=function(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];console[t].apply(console,o(n,i,e))};return{custom:t,log:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.apply(void 0,["log","log"].concat(n))},warn:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.apply(void 0,["warn","warn"].concat(n))},info:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.apply(void 0,["info","info"].concat(n))},error:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.apply(void 0,["error","error"].concat(n))}}};function s(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];console[e].apply(console,o(t,r))}function u(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];s.apply(void 0,["warn","warn"].concat(t))}function l(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];s.apply(void 0,["error","error"].concat(t))}},vsh_6114:function(e,t,n){"use strict";n.d(t,{Vf:function(){return c},EF:function(){return z},J_:function(){return p},r$:function(){return v},eJ:function(){return I},d4:function(){return x},sO:function(){return D},I4:function(){return F},bY:function(){return ie},hp:function(){return ee},RV:function(){return oe}});var r=n("vsh_19264"),i=n("vsh_4175"),o=n("vsh_1139"),a=n("vsh_403"),s=n("vsh_83675"),u=n("vsh_50398"),l=n("vsh_25098");function c(){return{current:null}}function h(e){var t=e.props.ref;if(t){var n=(0,s.F8u)(e);"function"==typeof t?t(n):t.current=n}}function d(e){var t=e.props.ref;t&&("function"==typeof t?t(null):t.current=null)}var f=(0,s.Oup)(),p=function(e,t){var n=t.builder;return(0,s.guc)((function(){return n(e,t)}),e)},v=function(e,t){(0,s.ZHw)(["mutate"]);var n=t.elementPool;(0,t.patcher)(e.filter((function(e){return f.has(e)&&!!n.get(e._id)})),t)},g=null,_=[],y=new WeakMap;function m(e){g&&_.push(g),g=e}function E(){g=_.pop()}
/*!
 * The file references the implementation of Preact Hooks
 * <https://github.com/preactjs/preact/blob/master/hooks/src/index.js>
 *
 * Copyright (c) 2015-present Jason Miller
 * Released under the MIT License.
 */
var b=0,T=null,C=0,S="pendingEffects",w="pendingLayoutEffects",R=0,A=function(e){return e===w},O=function(){return s.P6Y.isDevToolsEnabled()&&!b};function M(e){C=0,R=0,G();var t=e.hook;t&&(t.pendingEffects=[],t.pendingLayoutEffects=[])}function k(e){try{var t,n=j(),r=null!==(t=n.hook)&&void 0!==t?t:n.hook={list:[],pendingEffects:[],pendingLayoutEffects:[]};return e>=r.list.length&&r.list.push({}),s.vqx.addHookLog(n,T,e,b),r.list[e]}finally{G()}}function I(e){return O()&&G(1,new Error),function(e,t,n){O()&&G(2,new Error);var r=k(C++);r.reducer=e,r.element||(r.value=[n?n(t):W(void 0,t),function(e){var t=(0,o.Z)(r.value,1)[0],n=r.reducer(t,e);t!==n&&(r.value[0]=n,(0,s.p0Y)(r.element))}],r.element=g);return r.value}(W,e)}function x(e,t){O()&&G(3,new Error),N(S,e,t)}function N(e,t,n){var r=k(C++);if(!r.debuted||Z(r.args,n)){r.value=t,r.args=n;var i=g.hook[e];A(e)&&!R++&&(i.length=0),i.push(r)}}var P=new WeakMap;function L(e,t){O()&&G(7,new Error);var n=k(C++);if(Z(n.args,t)){var r=e();n.value=r,n.args=t,n.factory=e,(0,s.kKo)(r)&&P.set(r,!1)}return n.value}function D(e){return O()&&G(5,new Error),L((function(){return{current:e}}),[])}function F(e,t){return O()&&G(8,new Error),L((function(){return e}),t)}function B(e){V(e,S)}function V(e,t){if(e.hook){var n=e.hook[t];try{n.forEach(H),n.forEach(U)}catch(e){console.error("RunLayoutEffects has error: ",e)}finally{A(t)||(n.length=0)}}}function H(e){var t=e.cleanup;(0,l.mf)(t)&&(e.cleanup=void 0,t())}function U(e){e.cleanup=e.value(),e.debuted=!0}function Z(e,t){return!e||!t||!(0,l.fq)(e,t)}function W(e,t){return(0,l.mf)(t)?t(e):t}function j(){var e;return null!==(e=g)&&void 0!==e?e:(0,s._yM)("Hook can only be invoked from render methods.")}function G(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;b=e,T=t}var z=function(){function e(){(0,r.Z)(this,e),this.operationSet=void 0,this.operationSet=[]}return(0,i.Z)(e,[{key:"addOp",value:function(e,t){void 0!==t?this.operationSet.splice(t,0,e):this.operationSet.push(e)}},{key:"insert",value:function(e,t,n,r){n===t.length?this.append(e,r):this.insertBefore(r,t[n]),t.splice(n,0,r)}},{key:"delete",value:function(e,t){var n=e.splice(t,1)[0];this.remove(n)}},{key:"move",value:function(e,t,n){var r=e.splice(t,1)[0];0===n?this.moveToHead(r):this.moveAfter(e[n-1],r),e.splice(n,0,r)}},{key:"update",value:function(e,t){this.operationSet.push({el:e,type:"update",changes:t})}},{key:"preappend",value:function(e,t){this.operationSet.push({type:"preappend",parent:e,el:t})}},{key:"append",value:function(e,t){this.operationSet.push({type:"append",parent:e,el:t})}},{key:"insertBefore",value:function(e,t){this.operationSet.push({type:"insertBefore",target:t,el:e})}},{key:"insertAfter",value:function(e,t){this.operationSet.push({type:"insertAfter",target:t,el:e})}},{key:"remove",value:function(e){(0,s.GIx)(e)||this.operationSet.push({type:"remove",el:e})}},{key:"moveBefore",value:function(e,t){this.operationSet.push({type:"moveBefore",target:e,el:t})}},{key:"moveAfter",value:function(e,t){this.operationSet.push({type:"moveAfter",target:e,el:t})}},{key:"moveToHead",value:function(e){this.operationSet.push({type:"moveToHead",el:e})}},{key:"moveToTail",value:function(e){this.operationSet.push({type:"moveToTail",el:e})}},{key:"getOperationSet",value:function(){return this.operationSet}},{key:"clear",value:function(){this.operationSet=[]}}]),e}();function Y(e,t,n){return(0,s.guc)((function(){var r,i,o,a,u=(null!==(r=n)&&void 0!==r?r:{}).hooksInstance;t&&(0,s.jHw)(t)||(0,s.jHw)(e)?(null==u||u.resetHookStatus(e),i=(null!==(o=null==t?void 0:t.renderFunction)&&void 0!==o?o:e.renderFunction)(null!==(a=null==t?void 0:t.props)&&void 0!==a?a:e.props,{get element(){return(0,s.F8u)(e)}}),e.hook&&s.vqx.addHookLog(e,new Error,-1)):i=e.instance.render();return(0,l.kJ)(i)||(i=[i]),i.filter((function(e){return e}))}),e,{tagName:"renderChildren"})}function X(e){var t,n=e.element,r=e.hooksInstance,i=e.mountCallback,o=void 0===i?function(){}:i,a=n.type,u=n.props,c=n.children,h=null;u.provides=(0,s.PH7)(n),(0,s.jHw)(n)||(h=n.instance=new a((0,l.f0)({},{children:c},u,{element:n})),(0,s.I8j)(n,h,"componentWillMount")),t=Y(n,null,{hooksInstance:r});for(var d=0;d<t.length;d++){var f=t[d];(0,s.q1k)(f,"parent",n),(0,s.q1k)(f,"status",8)}(0,s.q1k)(n,"children",t),n.instance&&(0,s.I8j)(n,n.instance,"componentDidCreate"),o(n,{completed:0===t.length})}function K(e){var t=e.element,n=e.reconcile,r=e.unmountCallback;if(!(0,s.GIx)(t)){var i=t.instance;i&&(0,s.I8j)(t,i,"componentWillUnmount"),(0,s.q1k)(t,"status",32|t.status),null==r||r(t),null==i||i.unmount(),t.children.forEach((function(e){K({element:e,reconcile:n,unmountCallback:r})})),null==n||n.eventEmitter.trigger("AfterUnmount",[t])}}function q(e){var t,n,r=e.element,i=e.nextElement,o=e.reconcile,a=null!==(t=e.updateCallback)&&void 0!==t?t:function(){};if((0,s.kKo)(r,u.j2.SuperList)&&null!==(n=r.props.list[l.Ts])&&void 0!==n&&n.length){var c,h;o.dirtyMap.consumeElement(r),null===(c=(h=(0,s.qMZ)(r).reconcile).updateChildren)||void 0===c||c.call(h,o,{parent:r}),a(r,{completed:!0})}else{var d,f,p={props:[],style:[],hoverState:!1},v=r.instance,g=r.props;if(i){var _=(0,s.PH7)(i,r.parent);f=(0,l.f0)({},i.props,{provides:_,element:r}),i.props.provides=_}else f=g;var y=null==v?void 0:v.state,m=null!=v&&v.nextState?(0,l.f0)({},v.state,v.nextState):y,E=function(){v&&(v.props=(0,l.f0)(f,{element:r}),v.state=(0,l.f0)(m,v.nextState)),o.dirtyMap.consumeElement(r),a(r,{completed:!0,skipLifecycle:!0})};if(i&&o.hooksInstance.isSkipUpdate(i))return E();if(v){if(!1===v.shouldComponentUpdate(f,m))return E();(0,s.I8j)(r,v,"componentWillUpdate",f,m)}if(i){var b=(0,s.FS1)(r);if(b===(0,s.FS1)(i)){var T=(0,s.jJi)(r.style,i.style);null!=T&&T.length&&(Array.prototype.push.apply(p.style,T),(0,s.q1k)(r,"style",i.style));var C=(0,s.Kbf)(r.props,i.props,{whiteList:u._t[b]});null!=C&&C.length&&(p.props=C),(p.style.length>0||p.props.length>0)&&o.operator.update(r,p),(0,s.q1k)(r,"props",i.props)}else(0,s.r$v)(r,{style:i.style,props:i.props}),o.operator.update(r)}v&&(v.props=(0,l.f0)(f,{element:r}),v.state=(0,l.f0)(m,v.nextState),o.dirtyMap.consumeElement(r)),null!==(d=r.parent)&&void 0!==d&&d.unit?(0,s.q1k)(r,"unit",r.parent.unit):(0,s.i6c)(i||r)&&(0,s.q1k)(r,"unit",r._id);var S=Y(r,i,{hooksInstance:o.hooksInstance}),w=r.children;o.updateChildren({lhs:w,rhs:S,parent:r}),a(r,{completed:!0,prevProps:g,prevState:y})}}var $=function(){function e(t){var n,i,o,u;(0,r.Z)(this,e),this.eventEmitter=void 0,this.operator=void 0,this.dirtyMap=void 0,this.hooksInstance=void 0,this.elementTree=void 0,this.mounting=void 0,this.handlers=void 0,this.patching=void 0,this.handlers=new Map,this.patching=new Map,this.mounting=new Map,this.elementTree=t.elementTree,this.operator=null!==(n=t.operator)&&void 0!==n?n:new z,this.eventEmitter=null!==(i=t.eventEmitter)&&void 0!==i?i:new a.v,this.dirtyMap=null!==(o=t.dirtyMap)&&void 0!==o?o:(0,s.Oup)(),this.hooksInstance=null!==(u=t.hooksInstance)&&void 0!==u?u:{runEffects:B,resetHookStatus:M,isSkipUpdate:function(e){if(e&&P.has(e)){if(P.get(e))return!0;P.set(e,!0)}return!1}}}return(0,i.Z)(e,[{key:"handleUpdateCallback",value:function(e,t){var n=this,r=t.skipLifecycle,i=t.prevProps,o=t.prevState,a=this.patching.get(e._id);if(r&&(a.isSkipLifecycle=!0,a.counter=0,a.children.clear()),a.counter<=0){var u=(0,s.lEK)(this.patching);!function(e,t){for(var n=t.prevProps,r=t.prevState,i=t.isSkipLifecycle,o=t.hooksInstance,a=t.next,u=t.callback,l=e;l&&!(0,s.TO7)(l);){l.shadow&&(0,s.F8u)(l),i||(l.instance&&(0,s.I8j)(l,l.instance,"componentDidUpdate",n,r),null==o||o.runEffects(l)),null==u||u(l);var c=a(l);l=c.nextElement,n=c.prevProps,r=c.prevState,i=c.isSkipLifecycle}}(e,{prevProps:i,prevState:o,isSkipLifecycle:r,hooksInstance:this.hooksInstance,next:function(e){var t,r=u(e),i={};r&&(i=null!==(t=n.patching.get(r._id))&&void 0!==t?t:{});return(0,l.f0)(i,{nextElement:r})},callback:function(e){if(n.patching.delete(e._id),e.status=(0,s.Epq)(e.status,[2097152],!1),e.parent&&!(0,s.WFc)(e)){var t=n.patching.get(e.parent._id);null!=t&&t.children.has(e._id)&&(t.counter-=1,t.children.delete(e._id))}}})}else a.prevProps||(a.prevProps=i),a.prevState||(a.prevState=o)}},{key:"updateChildren",value:function(e){!function(e,t){for(var n,r,i=t.parent,o=null!==(n=t.lhs)&&void 0!==n?n:[],a=null!==(r=t.rhs)&&void 0!==r?r:[],u=o,l=a,c=0,h=0,d=u.length-1,f=l.length-1;c<=d&&h<=f;)if((0,s.L23)(o[c],l[h]))e.patch(u[c],l[h]),c++,h++;else if((0,s.L23)(u[d],l[f]))e.patch(u[d],l[f]),d--,f--;else if((0,s.L23)(u[c],l[f]))e.patch(u[c],l[f]),e.operator.move(u,c,d),d--,f--;else if((0,s.L23)(u[d],l[h]))e.patch(u[d],l[h]),e.operator.move(u,d,c),c++,h++;else{var p=u.slice(c,d+1).reduce((function(e,t,n){return e[t.key]=n,e}),{}),v=l[h++],g=p[v.key];if(void 0!==g){var _=u[g+c];(0,s.L23)(_,v)?(e.patch(_,v),e.operator.move(u,g+c,c)):(e.unmount(_)(),e.operator.delete(u,g+c),e.mount(v,i,!0)(),e.operator.insert(i,u,c,v))}else e.mount(v,i,!0)(),e.operator.insert(i,u,c,v),d++;c++}c<=d&&u.splice(c,d-c+1).forEach((function(t){e.unmount(t)(),e.operator.remove(t)})),h<=f&&l.slice(h,f+1).forEach((function(t,n){e.mount(t,i,!0)();var r=c+n-1;r>=u.length-1?e.operator.append(t.parent,t):r<0?e.operator.preappend(t.parent,t):e.operator.insertAfter(t,u[r]),u.splice(r+1,0,t)}))}(this,e)}},{key:"handleMountCallback",value:function(e,t){var n=this;t.completed?function(e,t){for(var n=t.hooksInstance,r=t.next,i=t.callback,o=e;o;)o.shadow&&(0,s.F8u)(o),o.instance&&(0,s.I8j)(o,o.instance,"componentDidMount"),null==n||n.runEffects(o),null==i||i(o),o=r(o)}(e,{hooksInstance:this.hooksInstance,next:(0,s.lEK)(this.mounting),callback:function(e){n.mounting.delete(e._id),(0,s.q1k)(e,"status",(0,s.Epq)(e.status,[1048576],!1));var t=e.parent;if(t){var r=n.mounting.get(t._id);null!=r&&r.children.has(e._id)&&(r.counter-=1,r.children.delete(e._id))}}}):this.mounting.set(e._id,{children:new Set,counter:e.children.length})}},{key:"mount",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.eventEmitter.trigger("InitElement",[e]),this.mounting.set(e._id,{counter:0,children:new Set}),(0,s.q1k)(e,"status",(0,s.Epq)(e.status,[1048576],!0)),(0,s.q1k)(e,"status",(0,s.Epq)(e.status,[2097152,16],!1)),n=n||e.parent){var i=this.mounting.get(n._id);i&&(r&&(i.counter+=1),i.children.has(e._id)||i.children.add(e._id))}var o=function(){(0,s.q1k)(e,"status",(0,s.Epq)(e.status,[8],!1)),t.eventEmitter.trigger("BeforeMount",[e,n]),X({parent:n,element:e,elementTree:t.elementTree,hooksInstance:t.hooksInstance,mountCallback:t.handleMountCallback.bind(t)}),t.eventEmitter.trigger("AfterMount",[e,n])};return o}},{key:"handleUnmountCallback",value:function(e){this.mounting.delete(e._id),this.patching.delete(e._id),this.handlers.delete(e._id)}},{key:"unmount",value:function(e){var t=this;return function(){if(e.parent){var n=t.mounting.get(e.parent._id);if(n&&((0,s.GIx)(e)?n.counter-=1:n.children.has(e._id)&&(n.counter-=1,n.children.delete(e._id)),n.counter<1&&t.handleMountCallback(e.parent,{completed:!0})),!(0,s.GIx)(e)){K({element:e,reconcile:t,unmountCallback:t.handleUnmountCallback.bind(t)});var r=t.patching.get(e.parent._id);null!=r&&r.children.has(e._id)&&((0,s.WFc)(e)||(r.counter-=1),r.children.delete(e._id),r.counter<1&&t.handleUpdateCallback(e.parent,{completed:!0}))}}}}},{key:"patch",value:function(e){var t,n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!(0,s.hHR)(e)){if((0,s.GIx)(e)){if(e.parent&&r){var i=e.parent.children.indexOf(e);(0,s.yWV)(e.parent,i,r),(0,s.q1k)(r,"parent",e.parent)}return function(){}}var o=this.patching.get(e._id);this.patching.set(e._id,(0,l.f0)(null!==(t=o)&&void 0!==t?t:{},{counter:0,children:new Set}));var a=e.parent;if(a&&!(0,s.WFc)(e)){var u=this.patching.get(a._id);u&&!u.children.has(e._id)&&(u.children.add(e._id),u.counter+=1)}(0,s.q1k)(e,"status",(0,s.Epq)(e.status,[16,2097152],!0));var c=function(){(0,s.q1k)(e,"status",(0,s.Epq)(e.status,[16],!1)),n.eventEmitter.trigger("BeforePatching",[e,r]),q({reconcile:n,element:e,nextElement:r,updateCallback:n.handleUpdateCallback.bind(n)}),n.eventEmitter.trigger("AfterPatching",[e]),n.handlers.delete(e._id)};return this.handlers.set(e._id,c),c}}},{key:"execute",value:function(e){var t;return(null!==(t=this.handlers.get(e._id))&&void 0!==t?t:function(){})()}},{key:"isPatching",get:function(){return this.patching.size>0}},{key:"isReconciling",get:function(){return this.patching.size>0||this.mounting.size>0}}]),e}();function J(e,t,n){var r=new Set,i=null==t?void 0:t._id;if(!i&&n&&(i=n._id),t&&(0,l.kJ)(t.props.className)&&t.props.className.length&&ee(t.props.className,(function(t){var n=e.get(t);n||(n=[],e.set(t,n)),r.add(t),n.includes(i)||n.push(i)})),n&&(0,l.kJ)(n.props.className)&&n.props.className.length){if(t&&n&&i!==n._id)return;ee(n.props.className,(function(t){if(!r.has(t)){var i=e.get(t);if(i){var o=i.indexOf(n._id);o<0||(i.splice(o,1),i.length||e.delete(t))}}}))}}function Q(e,t){return t.length?[].concat(t.slice(0,e),t.slice(e+1,t.length-e)):[]}function ee(e,t){for(var n=function e(n,r){for(var i=0;i<r.length;i+=1){var o=n+":"+r[i];t(o),e(o,Q(i,r))}},r=0;r<e.length;r+=1)t(e[r]),n(e[r],Q(r,e))}function te(e,t){var n;if((0,s.kKo)(e,u.j2.HalfFullscreen)){var r=null!==(n=t)&&void 0!==n?n:(0,s.$bs)(e).halfFullscreenElementList,i=r.indexOf(e);return i>-1&&(r.splice(i,1),!0)}}function ne(e,t){te(e,t),function(e,t){var n;if((0,s.kKo)(e,u.j2.HalfFullscreen)){var r=null!==(n=t)&&void 0!==n?n:(0,s.$bs)(e).halfFullscreenElementList,i=(0,s.hZ6)(e,r);i>=r.length?r.push(e):r[i]!==e&&r.splice(i,0,e)}}(e,t)}var re=function(e){if((0,s.FFi)(e))return!1;if(!!(0,s.aO6)(e))return!1;var t=e.instance;if(!(e.hook||t&&(0,s.Kp3)(t,"componentDidLayout")))return!0;var n=(0,s.Kas)(e);return(null==n||!n.didCallLayout)&&(n&&(n.didCallLayout=!0),t&&(0,s.I8j)(e,t,"componentDidLayout"),function(e){V(e,w)}(e),!0)},ie=function e(t){t&&(re(t)&&t.parent&&(0,s.kiv)(t.parent)&&e(t.parent))};function oe(e){var t=e.$contextInternal,n=new $({operator:e.operator,elementTree:t.elementTree,eventEmitter:e.eventEmitter}),r=n.eventEmitter;return r.on("InitElement",(function(e){var n=t.elementPool;e._id||(0,s.q1k)(e,"_id",n.genIndex())})),r.on("BeforeMount",(function(e,n){var r=t.elementPool,i=t.classifying;(0,s.r$v)(e,{root:t.id,parent:n}),r.set(e._id,e),J(i,e),m(e),P.has(e)&&P.set(e,!0)})),r.on("AfterMount",(function(e,t){h(e),E(),null!=t&&t.unit?(0,s.q1k)(e,"unit",t.unit):(0,s.i6c)(e)&&(0,s.q1k)(e,"unit",e._id),ne(e)})),r.on("AfterUnmount",(function(e){var n=t.elementPool,r=t.classifying;!function(e){var t;null===(t=e.hook)||void 0===t||t.list.forEach((function(e){try{H(e)}catch(e){console.error("cleanupEffects has error: ",e)}})),s.vqx.removeHookLog(e)}(e),P.delete(e),te(e),t.layoutEntryCollector.removeEntryByElement(e),t.layerManager.deleteLayers(e._id),J(r,null,e),n.delete(e._id),function(e){var t=y.get(e);t&&(t.forEach((function(t){t.delete(e)})),t.length=0)}(e),d(e),e.parent&&!n.get(e.parent._id)&&(e.renderObjects=[])})),r.on("BeforePatching",(function(e,n){n&&J(t.classifying,n,e),m(e)})),r.on("AfterPatching",(function(e){var t=e.props.ref;((0,l.mf)(t)||null==t||!t.current||(0,s.kKo)(t.current))&&h(e),E()})),r.on("rolayout",(function(e){ie(e.element)})),n}},vsh_92256:function(e,t,n){"use strict";n.d(t,{at:function(){return r},UE:function(){return i},nO:function(){return u}});var r=["click","contextmenu","dblclick","mousedown","mousemove","mouseup","wheel","touchcancel","touchstart","touchmove","touchend","pointerdown","pointermove","pointerleave","pointerup","pointercancel","drag","dragend","dragenter","dragstart","dragleave","dragover","drop","scroll","copy"],i=["mouseleave","mousemove","mouseup","touchmove","touchend"],o=["click","dblclick","contextmenu","mousedown","mouseenter","mouseleave","mousemove","mouseup"],a=["touchcancel","touchstart","touchmove","touchend"],s=["pointerdown","pointermove","pointerenter","pointerleave","pointerup","pointercancel","lostpointercapture"],u=([].concat(o,a,["drag","dragend","dragenter","dragstart","dragleave","dragover","drop"],s,["scroll"],["wheel"]),[].concat(o,s,a))},vsh_25098:function(e,t,n){"use strict";n.d(t,{rk:function(){return i},xw:function(){return o},n5:function(){return a},P3:function(){return s},RD:function(){return u},F0:function(){return l},FP:function(){return c},Ts:function(){return h},fw:function(){return d},HM:function(){return f},FE:function(){return p},RT:function(){return v},fJ:function(){return g},Ng:function(){return _},nK:function(){return r},ZT:function(){return y},m4:function(){return m},PO:function(){return b},kJ:function(){return T},HD:function(){return C},hj:function(){return S},o8:function(){return w},Rw:function(){return R},mf:function(){return A},Z$:function(){return O},tt:function(){return M},FB:function(){return k},ei:function(){return I},fq:function(){return x},f0:function(){return N}});var r,i="Microsoft YaHei",o="black",a=16,s=400,u="normal",l="alphabetic",c=function(e){return e.SELECTION_CHANGE="selectionchange",e.COPY="copy",e.WILL_PATCH="willpatch",e.RENDERTREE_COMPLETED="rendertreecompleted",e.IDLE_LAYOUT_TASK_DONE="idlelayouttaskdone",e.WILL_BUILD="willbuild",e.BUILD="build",e.WILL_LAYOUT="willlayout",e.SCROLL="scroll",e.ERROR="error",e.LAYOUT="layout",e.WILL_PAINT="willpaint",e.PAINT="paint",e.LOST_POINTER_CAPTURE="lostpointercapture",e.RESIZE="resize",e.DESTROY="destroy",e.ELEMENT_UPDATE="elementupdate",e.ELEMENT_MOUNT="elementmount",e.ELEMENT_UMMOUNT="elementunmount",e.RO_LAYOUT="rolayout",e.ADD_POSITIONED_LAYOUT_ENTRY="addpositionedlayoutentry",e}(c||{}),h="__internal_proxy_operations__",d="roadster-placeholder",f=100,p={PC:5,MOBILE:30},v={PC:10,MOBILE:30},g="EMBED-PRERENDER-CONTAINER",_={selectionColor:"#70c4ff99",selectionControlBarColor:"#126fe0",alignVertical:"baseline",alignHorizontal:"left",borderColor:"black",borderStyle:"solid",border:"1px solid black"};try{r=JSON.parse('{"@byted-roadster/engine":"1.0.7","@byted-roadster/lite":"1.2.0","@byted-roadster/scheduler":"1.0.0","shared":"1.0.0","@byted-roadster/unicode":"1.0.0","@byted-roadster/animation":"1.0.0","@byted-roadster/roadster-redux":"1.0.0","@byted-roadster/ui":"1.2.0"}')}catch(e){}function y(){}function m(e){return e}function E(e){return Object.prototype.toString.call(e)}function b(e){return"[object Object]"===E(e)}function T(e){return Array.isArray(e)}function C(e){return"string"==typeof e||"[object String]"===E(e)}function S(e){return("number"==typeof e||"[object Number]"===E(e))&&!Number.isNaN(e)}function w(e){return void 0===e}function R(e){return null==e}function A(e){return"function"==typeof e}function O(e){var t=e.length;if(t>0)return e[t-1]}function M(e){return Array.from(new Set(e))}function k(e,t){for(var n={},r=e.length,i=0;i<r;i++)t(n,e[i],i,e);return n}function I(e,t){for(var n={},r=t.length,i=0;i<r;i++){var o=t[i];o in e&&(n[o]=e[o])}return n}function x(e,t){var n=e.length;if(n!==t.length)return!1;for(var r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}var N=Object.assign},vsh_403:function(e,t,n){"use strict";n.d(t,{v:function(){return s}});var r=n("vsh_19264"),i=n("vsh_4175"),o=n("vsh_56314"),a=function(e){return e.toLowerCase()},s=function(){function e(){(0,r.Z)(this,e),this.listenersMap={}}return(0,i.Z)(e,[{key:"addEventListener",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=a(e);t||(0,o.ZK)("bind event with invalid cb, event: ".concat(r)),this.listenersMap[r]||(this.listenersMap[r]=[]);var i="boolean"==typeof n?n:n.isOnce||!1,s="boolean"==typeof n?0:n.priority||0;this.listenersMap[r].find((function(e){return e.listener===t}))||(this.listenersMap[r].push({listener:t,isOnce:i,priority:s}),this.listenersMap[r].sort((function(e,t){return t.priority-e.priority})))}},{key:"removeEventListener",value:function(e,t){var n=a(e),r=(this.listenersMap[n]||[]).findIndex((function(e){return e.listener===t}));r>-1&&this.listenersMap[n].splice(r,1)}},{key:"triggerEvent",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=a(e),i=this.listenersMap[r]||[],o=i.slice(0);o.forEach((function(e){var i=e.listener,o=e.isOnce;try{o&&t.removeEventListener(r,i),i.apply(i,n)}catch(e){console.error(e)}}))}},{key:"on",value:function(e,t,n){this.addEventListener(e,t,n)}},{key:"once",value:function(e,t,n){this.addEventListener(e,t,Object.assign({},n,{isOnce:!0}))}},{key:"off",value:function(e,t){this.removeEventListener(e,t)}},{key:"trigger",value:function(e,t){this.triggerEvent(e,t)}},{key:"reset",value:function(){this.listenersMap={}}},{key:"removeListener",value:function(e,t){this.removeEventListener(e,t)}},{key:"getListeners",value:function(e){return Array.from(this.listenersMap[a(e)]||[])}}]),e}()},vsh_36204:function(e,t,n){"use strict";n.d(t,{zs:function(){return d},Jb:function(){return v},Af:function(){return g},Dh:function(){return _},tV:function(){return y}});var r=n("vsh_19264"),i=n("vsh_4175"),o=n("vsh_83675"),a=n("vsh_25098"),s=function(e){return e.BOTTOM="BOTTOM",e.UPPER="UPPER",e}(s||{}),u=function(e){return e.LOWER="LOWER",e.MIDDLE="MIDDLE",e.TOP="TOP",e}(u||{}),l={BOTTOM:0,LOWER:1,MIDDLE:2,UPPER:3,TOP:4,TOPMOST:5},c=function(e,t,n,r){var i=t.style.transform.replace(/(translate\()|\)|px/g,"").split(",").map((function(e){return Number(e)})),o=i[1]||0,a=i[0]||0;e.updatePos(t,{left:a+r,top:o+n})},h=[],d=function(){function e(t){(0,r.Z)(this,e),this._$context=void 0,this._layersMap=new Map,this._$context=t}return(0,i.Z)(e,[{key:"_initEmbedLayer",value:function(e,t,n){var r=n.zIndex,i=n.elementId,o=document.createElement("div");return o.style.position="absolute",o.style.left="0px",o.style.top="0px",o.style.zIndex=r.toString(),o.style.pointerEvents="none",o.style.userSelect="text",o.style.cursor="default",o.style.overflow="hidden",this._$context.rPainter.updateRect(o,n),e.appendChild(o),this._getLayers(i,t).push(o),o}},{key:"_initCanvasLayer",value:function(e,t,n){var r,i,s=this._rPainter,u=this._getLayers(n.elementId,t);if(h.length>0)r=h.shift(),i=(0,o.IUU)(r),s.updateRect(i,n);else{var l=this._$context.rPainter.createPainter(e,(0,a.f0)({},n,{needListenEvent:!1}));l.setColorMap(this._$context.colorToken),r=l.canvas,i=(0,o.IUU)(r)}return i.isConnected||e.appendChild(i),u.push(r),o.vS7&&(r.style.imageRendering="unset"),r}},{key:"_getLayers",value:function(e,t){var n=this._layersMap,r=n.get(e);r||(r=new Map,n.set(e,r));var i=r.get(t);return i||(i=[],r.set(t,i)),i}},{key:"getLayer",value:function(e,t){var n,r=this._layersMap.get(null!==(n=t)&&void 0!==n?n:this._rootId);if(!r)return null;var i=r.get(e);return i?i[0]:null}},{key:"updateLayersScrollStatus",value:function(e){var t=e.diffScrollTop,n=e.diffScrollLeft,r=this._rPainter;this._layersMap.forEach((function(e){e.forEach((function(e){e.forEach((function(e){return c(r,e,t,n)}))}))}))}},{key:"updateRootLayers",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["BOTTOM","UPPER","MIDDLE"],r=this._DPR,i=e.scrollLeft,o=e.scrollTop,a=e.paddingLeft,s=void 0===a?0:a,l=e.paddingTop,c=void 0===l?0:l,h=this._$context.rNode.getRenderTree(),d=h.height,f=e.width,p=e.height;o+e.height>d&&(p=Math.max(0,d-o));var v=i+s,g=o+c,_=this._$context.rPainter;null===(t=this._layersMap.get(this._rootId))||void 0===t||t.forEach((function(e,t){if(n.includes(t)){var i=t in u;e.forEach((function(e){_.updateRect(e,{DPR:r,left:i?s:v,top:i?c:g,width:f,height:i?d:p})}))}}))}},{key:"updateLayerByType",value:function(e,t){var n,r=this,i=null===(n=this._layersMap.get(this._rootId))||void 0===n?void 0:n.get(t);i&&i.forEach((function(t){return r.updateLayer(e,t)}))}},{key:"updateLayer",value:function(e,t){var n=this._DPR,r=e.scrollLeft,i=e.scrollTop,o=e.paddingLeft,a=void 0===o?0:o,s=e.paddingTop,u=void 0===s?0:s,l=this._$context.rNode.getRenderTree().height,c=e.width,h=e.height;i+e.height>l&&(h=Math.max(0,l-i));var d=r+a,f=i+u,p=this._$context.rPainter;return t instanceof HTMLCanvasElement?p.updateRect(t,{DPR:n,left:d,top:f,width:c,height:h}):p.updateRect(t,{DPR:n,left:a,top:u,width:c,height:l})}},{key:"initLayer",value:function(e,t,n){var r=function(e,t,n,r){return(0,a.f0)({DPR:n,elementId:e,zIndex:l[t]},r)}(this._rootId,t,this._DPR,n);return t in u?this._initEmbedLayer(e,t,r):this._initCanvasLayer(e,t,r)}},{key:"deleteLayers",value:function(e,t){var n=this._layersMap.get(e);n&&((t?[t]:Array.from(n.keys())).forEach((function(e){var t=n.get(e);null==t||t.forEach((function(t){t.remove(),e in s&&h.push(t)})),n.delete(e)})),n.size<=0&&this._layersMap.delete(e))}},{key:"clearLayersRect",value:function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["UPPER","BOTTOM"],i=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0;i=null!==(e=i)&&void 0!==e?e:this._rootId,o=null!==(t=o)&&void 0!==t?t:this._DPR,null===(n=this._layersMap.get(i))||void 0===n||n.forEach((function(e,t){r.includes(t)&&e.forEach((function(e){e instanceof HTMLCanvasElement&&f(e,o)}))}))}},{key:"clearLayerRect",value:function(e,t,n){var r;t=null!==(r=t)&&void 0!==r?r:this._DPR,e instanceof HTMLCanvasElement&&f(e,t,n)}},{key:"clearLayers",value:function(){this._layersMap.forEach((function(e){e.forEach((function(e){e.forEach((function(e){return e.remove()}))}))})),this._layersMap.clear()}},{key:"setLayerVisible",value:function(e,t){e.style.visibility=t?"unset":"hidden"}},{key:"_rootId",get:function(){return this._$context.elementTree._id}},{key:"_DPR",get:function(){return this._$context.DPR}},{key:"_rPainter",get:function(){return this._$context.rPainter}}]),e}();function f(e,t,n){var r,i,o,a,s=e.getContext("2d");s.setTransform(t,0,0,t,0,0),s.clearRect(null!==(r=null==n?void 0:n.left)&&void 0!==r?r:0,null!==(i=null==n?void 0:n.top)&&void 0!==i?i:0,null!==(o=null==n?void 0:n.width)&&void 0!==o?o:e.width,null!==(a=null==n?void 0:n.height)&&void 0!==a?a:e.height)}var p=new WeakMap;function v(e){return p.get(e)}function g(e){var t;return!(null===(t=p.get(e))||void 0===t||!t.isDirty)}var _=function(){function e(t){(0,r.Z)(this,e),this.painter=void 0,this._dirtyStatus=1,this._dirtyLine=0,this.isReady=!1,this._collectingDirtyLine=0,this.idx=void 0,this.painter=t.painter,this.idx=t.idx,p.set(t.painter,this)}return(0,i.Z)(e,null,[{key:"getInstance",value:function(t,n){var r,i=null!==(r=n.rNodeContext)&&void 0!==r?r:(0,o.$bs)(t),a=n.idx,s=void 0===a?0:a,u=i.paintStatePool,l=t?t.element._id:1,c="".concat(l,"-").concat(s),h=u.get(c);return h?h.setPainter(n.painter):(h=new e(n),u.set(c,h)),h}}]),(0,i.Z)(e,[{key:"setPainter",value:function(e){this.painter=e}},{key:"setCollectingDirtyLine",value:function(e){this._collectingDirtyLine=e}},{key:"getCollectingDirtyLine",value:function(){return this._collectingDirtyLine}},{key:"commit",value:function(e,t){var n=y(this),r=n.scrollTop;t=Math.min(n.height+r,t),this._dirtyLine=Math.min(Math.max(e,r),t),this._dirtyStatus=this._dirtyLine>=t?0:2}},{key:"markDirty",value:function(){this._dirtyLine=y(this).scrollTop,this._dirtyStatus=1}},{key:"reset",value:function(){this.markDirty()}},{key:"setColorToken",value:function(e){this.painter.setColorMap(e)}},{key:"getPainter",value:function(){return this.painter}},{key:"readyToPaint",value:function(e){if(!this.isReady){var t=(0,o.Pve)(e),n=this.painter;n.save(),n.beginPath(),n.rect(t.x,t.y,t.width,t.height),n.clip(),this.isReady=!0}}},{key:"completePaint",value:function(){this.isReady&&(this.painter.restore(),this.isReady=!1)}},{key:"dirtyLine",get:function(){return this._dirtyLine}},{key:"isDirty",get:function(){return 1===this._dirtyStatus}},{key:"isPartialDirty",get:function(){return 2===this._dirtyStatus}},{key:"isCompleted",get:function(){return 0===this._dirtyStatus}}]),e}();function y(e){return(0,o.Wln)(e.getPainter())}},vsh_47928:function(e,t,n){"use strict";n.d(t,{o:function(){return r}});var r=function(e){return e.LTR="ltr",e.RTL="rtl",e.AUTO="auto",e.NONE="none",e}(r||{})},vsh_85684:function(e,t,n){"use strict";n.d(t,{Xp:function(){return a},Lr:function(){return s},Mq:function(){return u},od:function(){return l},Yc:function(){return c},xU:function(){return h},Cb:function(){return d},fM:function(){return f},bK:function(){return p}});var r=n("vsh_42410"),i=n("vsh_83675"),o=n("vsh_25098");function a(e,t){var n,r,a,s,u=t.constraint,l=t.utils,c=null!==(n=e.runtime)&&void 0!==n?n:(0,i.KfJ)(e),h=null===(r=(0,i.iY3)(e.type))||void 0===r?void 0:r.layout,d=e.parent;if(d){var f,p,v,g=d.runtime;if(g&&u)(0,i.DSN)(g,"context",(0,o.f0)({},u,null!==(v=g.context)&&void 0!==v?v:{}));var _=null===(f=(0,i.iY3)(d.type))||void 0===f||null===(p=f.layout)||void 0===p?void 0:p.createChildConstraint;null==_||_(d,e,l)}else u.inheritedStyle=(0,i.CLs)((0,i.R3e)(e),u.inheritedStyle),(0,i.DSN)(c,"constraint",u);!0===t.disableComputeStyle||c.isComputedStyle||(null==h||null===(s=h.computeStyle)||void 0===s||s.call(h,e,c.constraint),c&&(c.isComputedStyle=!0));null==h||null===(a=h.buildContext)||void 0===a||a.call(h,e,l)}function s(e,t){for(var n=[],r=e;r;){var i=r.runtime;if(null!=i&&i.context)break;n.push(r),r=r.parent}for(;n.length;)a(n.pop(),t)}function u(e,t,n){var r=n.childrenProperty,i=void 0===r?"children":r,o=n.parentProperty,a=void 0===o?"parent":o,s=n.getNext,u=[],l=[];u.push({renderObject:e,index:0,isBackward:!1});for(var c=1;u.length;){var h=u.pop(),d=h.renderObject;c=t(h)||1,h.isBackward=!0,l.push(h);var f=d[i];if(null!=f&&f.length&&c<=1){var p,v=null!==(p=null==s?void 0:s(d))&&void 0!==p?p:0,g=null==f?void 0:f[v];if(g){u.push({renderObject:g,index:v,isBackward:!1});continue}}for(;l.length;){var _=l.pop(),y=_.renderObject,m=_.index;if(c<=1&&t(_),3!==c&&y!==e){var E=y[a];if(E){var b,T,C=null!==(b=null==s?void 0:s(E,m))&&void 0!==b?b:m+1,S=null===(T=E[i])||void 0===T?void 0:T[C];if(S){u.push({renderObject:S,index:C,isBackward:!1});break}}}c=1}}}var l=function(e,t){var n,r,o=e.runtime;if((0,i.z7X)(o)){var a=t.utils,s=t.index;null===(n=(r=(0,i.r8s)(e).layout).wrapup)||void 0===n||n.call(r,e,o.context,a),(0,i.cUS)(e);var u,l,c,h=e.parent;if(h&&(0,i.HSn)(e))null===(u=(l=(0,i.r8s)(h).layout).transition)||void 0===u||u.call(l,h,e,h.runtime.context,a,null!==(c=s)&&void 0!==c?c:(0,i.cq5)(e))}};var c=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=e.measureText(t,Object.assign({},n,{fontSize:n.fontSize/r})),o=i.width,a=i.actualBoundingBoxAscent,s=i.actualBoundingBoxDescent,u=i.actualBoundingBoxLeft,l=i.actualBoundingBoxRight,c=i.fontBoundingBoxAscent,h=i.fontBoundingBoxDescent;return{width:o*r,actualBoundingBoxAscent:a&&a*r,actualBoundingBoxDescent:s&&s*r,actualBoundingBoxLeft:u&&u*r,actualBoundingBoxRight:l&&l*r,fontBoundingBoxAscent:c&&c*r,fontBoundingBoxDescent:h&&h*r}},h=function(e,t,n,r,i,a){if("italic"!==i.fontStyle)return n;n=(0,o.f0)({},n);var s,u=c(e,r,i,a),l=u.actualBoundingBoxLeft,h=u.actualBoundingBoxRight,d=u.width;if(void 0===l||void 0===h){var f=e.measureFont(i.fontFamily,i.fontSize).slope;h=d-(l=-t.height*(s=f*Math.PI/180,Math.tan(s))/2)}return n.left-t.left<=0&&(n.left+=l,n.width-=l),n.left+n.width>=t.left+t.width&&(n.width+=h-d),n};function d(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=new Map,o=function e(n){var o,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!(0,i.WAP)(n)||!a){if(r.set(n,n),n.sourceRo&&(0,i.z0l)(n)){for(var s=r.get(n.sourceRo);null!==(u=s)&&void 0!==u&&u.sourceRo;){var u;s=r.get(s.sourceRo)}s&&(0,i.ryg)(s,{width:s.width+n.width,lineBreakerPosition:void 0,graphemeBreakerPosition:void 0,props:Object.assign({},s.props,{content:s.props.content+n.props.content})})}var l=null!==(o=n.children)&&void 0!==o?o:[];(0,i.oFe)(n,!0);for(var c=0;c<l.length;c++){var h=l[c];h.sourceRo&&(t.destroyRo(h),c--),e(h,a)}return n}};o(e,n)}var f=function(e,t){var n=t.eventEmitter,r=t.painter;return{getRootConstraint:function(){return(0,i.yjm)(e).runtime.constraint},cloneRo:function(e){var t=(0,i.xgX)(e);return null==n||n.trigger("cloneRenderObject",[e,t]),t},destroyRo:function(e){var t=e.parent;if(t){var r=t.children.indexOf(e);t.children.splice(r,1),(0,i.ENg)(e,(function(e){var t=e.refPosRo;if(t){var n=t.posRos.indexOf(e);t.posRos.splice(n,1)}}))}null==n||n.trigger("destroyRenderObject",[e])},measureText:function(e,t){return r.measureText(e,t)},measureFont:function(e,t){return r.measureFont(e,t)},measureTextWithZoom:function(e,t,n){return c(r,e,t,n)}}},p=function(e,t){var n;(0,i.h$_)(["layout"]);var o=t.eventEmitter,a=t.onInterceptRenderObject,c=t.painter,h=t.maxHeight,d=t.maxWidth,p=t.disableComputeStyle,v=f(e,{eventEmitter:o,painter:c}),g=(0,r.tw)(null!==(n=a)&&void 0!==n?n:[]);u(e,(function(t){var n,r=t.renderObject,a=t.index,u=t.isBackward,c=g(r,u);if(c&&c>1)return c;var f=null!==(n=r.runtime)&&void 0!==n?n:(0,i.KfJ)(r),_=f.isSkipLayout,y=f.context;if(u){if((0,i.QqA)(r))return 1;f.status=(0,i.Epq)(f.status,[65536],!0),l(r,{utils:v,index:a}),f.status=(0,i.Epq)(f.status,[65536],!1),null==o||o.trigger("rolayout",[r])}else{var m,E;if(s(r,{utils:v,constraint:r===e&&void 0!==d&&void 0!==h?{maxWidth:d,maxHeight:h}:void 0,disableComputeStyle:p}),!((0,i.mqG)((0,i.gOt)(r,["display"]))&&!_&&0!==(null==y?void 0:y.maxHeight)&&0!==(null==y?void 0:y.maxWidth))||!(0,i.z7X)(f))return 2;null===(m=(0,i.r8s)(r).layout)||void 0===m||null===(E=m.willLayout)||void 0===E||E.call(m,r,f.context,v)}return 1}),{getNext:function(e,t){return(0,i.r8s)(e).layout.getNext(e,t)}}),(0,i.wpy)(["layout"])}},vsh_42410:function(e,t,n){"use strict";n.d(t,{NY:function(){return o},h1:function(){return a},Hj:function(){return s},OM:function(){return u},tw:function(){return l}});var r=n("vsh_83675"),i=n("vsh_25098"),o=function(){var e=(0,r.ip0)({check:function(e){var t;return!1===(null===(t=e.style)||void 0===t?void 0:t.display)},initValue:!0,cbk:function(){return!1},scopes:["mutate"]});return function(t){return e(t,!0)}}();function a(e){var t,n;return null!==(t=(0,r.z0l)(e)?e.props.content.length:null===(n=e.children)||void 0===n?void 0:n.length)&&void 0!==t?t:0}function s(e){var t,n,r,o,a=null!==(t=e.fontWeight)&&void 0!==t?t:i.P3,s=null!==(n=e.fontStyle)&&void 0!==n?n:i.RD,u=null!==(r=e.fontFamily)&&void 0!==r?r:i.rk;return{fontWeight:a,fontSize:null!==(o=e.fontSize)&&void 0!==o?o:i.n5,fontFamily:u,fontStyle:s}}function u(e){var t=s(e),n=t.fontWeight,r=t.fontStyle,i=t.fontSize,o=t.fontFamily;return"".concat(n," ").concat(r," ").concat(i,"px ").concat(o)}function l(e){var t=e;return function(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(var o=0;o<t.length;o++)if(e=t[o].apply(null,r))return e}}},vsh_50398:function(e,t,n){"use strict";n.d(t,{j2:function(){return a},V0:function(){return s},tB:function(){return u},_L:function(){return l},kz:function(){return c},q8:function(){return h},Rq:function(){return d},BR:function(){return f},Rf:function(){return p},zh:function(){return v},Tl:function(){return g},Nn:function(){return m},yT:function(){return S},be:function(){return R},X2:function(){return x},zb:function(){return P},oe:function(){return F},Fp:function(){return j},$L:function(){return z},gG:function(){return J},lB:function(){return Q},in:function(){return ee},BN:function(){return te},pF:function(){return re},qG:function(){return ie},_t:function(){return ae},Y8:function(){return ce},Ex:function(){return he},TZ:function(){return de},vi:function(){return fe},HZ:function(){return pe},AX:function(){return ve},e8:function(){return ge},m9:function(){return _e},u9:function(){return ye},k0:function(){return me},mm:function(){return Ee},ql:function(){return be}});var r=n("vsh_98652"),i=n("vsh_25098"),o=[].concat(["Div","Text","EmbedDOM","EmbedRNode","BlockFlow","InlineFlow","Absolute","Fixed","FlexRow","FlexColumn","Table","TableRow","TableCell","Bitmap","Drawing"],["SuperList","Component","HalfFullscreen"]),a=(0,i.FB)(o,(function(e,t){return e[t]=t})),s=(a.Text,a.EmbedDOM,a.EmbedRNode,a.Drawing,[a.Div,a.BlockFlow,a.InlineFlow,a.FlexRow,a.FlexColumn,a.HalfFullscreen]),u=[a.Absolute,a.Fixed],l=[a.FlexRow,a.FlexColumn],c=[a.TableRow,a.FlexRow,a.InlineFlow],h=[a.BlockFlow,a.FlexColumn,a.SuperList],d=[a.TableRow,a.FlexRow,a.FlexColumn,a.InlineFlow],f=[a.Text,a.EmbedDOM,a.Bitmap,a.Div,a.Drawing],p=[a.Div,a.InlineFlow,a.Component,a.Text],v=["Top","Right","Bottom","Left"],g=["fontFamily","fontSize","fontColor","fontStyle","fontWeight"],_=["alignSelf","flexGrow","flexShrink"],y=["alignMainAxis","alignCrossAxis","stretchDeep"],m=[].concat(g,["lineHeight","forceLineHeight","leading","textIndent","overflowEllipsis","maxLines","weakWidth"],["underline","lineThrough","zoom","cursor"]),E=[].concat((0,r.Z)(m),_,["display","opacity"]),b=[].concat(g,["underline","lineThrough","cursor","zoom","display","opacity"]),T=["width","minWidth","maxWidth"],C=[].concat(T,["height","minHeight","maxHeight"]),S=v.map((function(e){return"margin".concat(e)})),w=["margin"].concat((0,r.Z)(S)),R=v.map((function(e){return"padding".concat(e)})),A=["padding"].concat((0,r.Z)(R)),O=v.map((function(e){return"outline".concat(e)})),M=["outline"].concat((0,r.Z)(O)),k=v.map((function(e){return"outline".concat(e,"Width")})),I=["outlineWidth"].concat((0,r.Z)(k)),x=v.map((function(e){return"outline".concat(e,"Style")})),N=["outlineStyle"].concat((0,r.Z)(x)),P=v.map((function(e){return"outline".concat(e,"Color")})),L=["outlineColor"].concat((0,r.Z)(P)),D=[].concat((0,r.Z)(O),(0,r.Z)(k),(0,r.Z)(x),(0,r.Z)(P)),F=[].concat((0,r.Z)(M),(0,r.Z)(I),(0,r.Z)(N),(0,r.Z)(L)),B=[].concat((0,r.Z)(I),(0,r.Z)(M)),V=[].concat((0,r.Z)(P),(0,r.Z)(x),(0,r.Z)(k)),H=v.map((function(e){return"border".concat(e)})),U=["border"].concat((0,r.Z)(H)),Z=v.map((function(e){return"border".concat(e,"Width")})),W=["borderWidth"].concat((0,r.Z)(Z)),j=v.map((function(e){return"border".concat(e,"Style")})),G=["borderStyle"].concat((0,r.Z)(j)),z=v.map((function(e){return"border".concat(e,"Color")})),Y=["borderColor"].concat((0,r.Z)(z)),X=[].concat((0,r.Z)(H),(0,r.Z)(Z),(0,r.Z)(j),(0,r.Z)(z)),K=[].concat((0,r.Z)(W),(0,r.Z)(U)),q=[].concat((0,r.Z)(z),(0,r.Z)(j),(0,r.Z)(Z)),$=[].concat((0,r.Z)(U),(0,r.Z)(W),(0,r.Z)(G),(0,r.Z)(Y)),J={border:{allSide:X,allWidth:K,allDirection:q,widthSide:Z,styleSide:j,colorSide:z},outline:{allSide:D,allWidth:B,allDirection:V,widthSide:k,styleSide:x,colorSide:P}},Q=["TopLeft","TopRight","BottomRight","BottomLeft"].map((function(e){return"border".concat(e,"Radius")})),ee=["bTLR","bTRR","bBRR","bBLR"],te=ee.flatMap((function(e){return["".concat(e,"H"),"".concat(e,"V")]})),ne=["borderRadius"].concat((0,r.Z)(Q)),re=[].concat((0,r.Z)(C),(0,r.Z)(w),(0,r.Z)(A),(0,r.Z)(U),(0,r.Z)(W),["weakWidth","overflowScrollX","overflowScrollY"]),ie=["alignHorizontal","marginCollapse","alignVertical","zIndex","display","lineHeight","forceLineHeight","leading","baselineOffset"].concat(y,_),oe=["lineWrap","asOneChar","selectable"],ae={Text:["content"].concat(oe),EmbedDOM:["mount","unmount","keepDOMAlive"].concat(oe),Table:["overlap","columnWidths","rowHeights"].concat(oe),Component:oe,Div:["draw","asRelative"].concat(oe),SuperList:oe,HalfFullscreen:["extraLeft","extraRight","asRelative"].concat(oe),EmbedRNode:["rNode","RNode","RNodeProps"],BlockFlow:["asRelative"].concat(oe),InlineFlow:["asRelative"].concat(oe),Absolute:oe,Fixed:oe,FlexRow:["asRelative"].concat(oe),FlexColumn:["asRelative"].concat(oe),TableRow:oe,TableCell:oe,Bitmap:["source","crop"].concat(oe),Drawing:[].concat(oe,["draw"])},se=["left","right","top","bottom"],ue=["width","alignHorizontal","marginCollapse"].concat((0,r.Z)(E)),le=[].concat(y,(0,r.Z)(C),(0,r.Z)(E)),ce={Component:E,SuperList:ue,HalfFullscreen:[].concat((0,r.Z)(C),(0,r.Z)(E)),Div:["backgroundColor","cursor","overflowScrollX","overflowScrollY","outlineOffset","baselineOffset"].concat((0,r.Z)(C),(0,r.Z)(w),(0,r.Z)(A),(0,r.Z)($),(0,r.Z)(ne),(0,r.Z)(E),(0,r.Z)(F),["transform"]),Text:[].concat((0,r.Z)(b),(0,r.Z)(E)),EmbedDOM:["cursor","baselineOffset","zIndex","overflowVisible"].concat((0,r.Z)(C),(0,r.Z)(E)),EmbedRNode:["cursor"].concat((0,r.Z)(C),(0,r.Z)(E)),BlockFlow:ue,InlineFlow:["alignHorizontal","alignVertical"].concat(T,(0,r.Z)(E)),Absolute:["zIndex"].concat(se,(0,r.Z)(E)),Fixed:["zIndex"].concat(se,(0,r.Z)(E)),FlexRow:le,FlexColumn:le,Table:["backgroundColor","border"].concat((0,r.Z)(E)),TableRow:(0,r.Z)(E),TableCell:["backgroundColor"].concat((0,r.Z)(E)),Bitmap:[].concat((0,r.Z)(E),["baselineOffset","fit","width","height"]),Drawing:[].concat((0,r.Z)(E),["width","baselineOffset","height"])},he=new Set(["Div"]),de=new Set(["Div","Table"]),fe=[a.SuperList,a.Div,a.Text,a.BlockFlow,a.InlineFlow,a.Absolute,a.Fixed,a.FlexRow,a.FlexColumn,a.Table,a.TableRow,a.TableCell],pe=new Set([a.BlockFlow,a.FlexRow,a.FlexColumn,a.Table,a.EmbedRNode,a.SuperList]),ve={width:{Div:"auto",Bitmap:"auto",EmbedDOM:"auto",EmbedRNode:"auto",HalfFullscreen:"auto",InlineFlow:"auto",BlockFlow:"100%",FlexRow:"100%",FlexColumn:"100%",SuperList:"100%"},height:{Div:"auto",Bitmap:"auto",EmbedDOM:"auto",EmbedRNode:"auto",HalfFullscreen:"auto",FlexRow:"auto",FlexColumn:"auto"}},ge=new Set([a.InlineFlow,a.FlexRow]),_e=["minWidth","maxWidth","left","right","marginLeft","marginRight","paddingLeft","paddingRight","borderLeftWidth","borderRightWidth","outlineLeftWidth","outlineRightWidth","minHeight","maxHeight","top","bottom","marginTop","marginBottom","paddingTop","paddingBottom","borderTopWidth","borderBottomWidth","outlineTopWidth","outlineBottomWidth","fontSize","textIndent","width","height","weakWidth","outlineOffset"].concat((0,r.Z)(te)),ye={fontColor:"color",underline:"textDecoration",lineThrough:"textDecoration"},me=Object.assign({},ye,{fontFamily:"fontFamily",fontSize:"fontSize",fontStyle:"fontStyle",cursor:"cursor"}),Ee=([].concat((0,r.Z)(C),["textIndent","fontSize"]),{flexWidth:void 0,flexHeight:void 0,stretchWidth:void 0,stretchHeight:void 0}),be={fragments:void 0}},vsh_98713:function(e,t,n){"use strict";n.d(t,{es:function(){return w},cJ:function(){return R},cO:function(){return O},tw:function(){return C},Fg:function(){return W},Qj:function(){return h},UW:function(){return d},mW:function(){return f},wX:function(){return j},vt:function(){return z},Vi:function(){return Y},Nx:function(){return X},lf:function(){return ee},n9:function(){return te},Gi:function(){return ne},uM:function(){return re},f6:function(){return ie},EQ:function(){return ue},PT:function(){return le},WG:function(){return M},mk:function(){return N},mZ:function(){return L},V0:function(){return D},oS:function(){return F},tZ:function(){return B},MJ:function(){return V},BC:function(){return H},rj:function(){return U},IN:function(){return Z},Kf:function(){return Ce}});var r=n("vsh_1139"),i=n("vsh_55042"),o=n("vsh_42410"),a=n("vsh_83675"),s=n("vsh_50398"),u=n("vsh_25098");function l(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var h=function(e){return(0,a.mqG)(e.renderObject.style)?void 0:2},d=function(e){var t=(0,a.gOt)(e.renderObject).opacity;if((0,u.hj)(t)&&t<=0)return 2};var f=[h,d,function(e){var t=e.area,n=e.rect;return n.left+n.width<t.x?2:void 0},function(e){var t=e.area;return e.rect.left>t.x+t.width?2:void 0},function(e){var t=e.renderObject,n=e.area,r=e.rect;if(r.height+r.top<n.y&&!function(e){if(!(0,a.ijY)(e,s.j2.TableRow))return!1;var t=e.parent,n=e.children,r=e.height,i=(0,a.cq5)(e);if(!n||i<0)return!1;for(var o=0;o<n.length;o++){var u=n[o];if(r!==u.height+2*u.top){var l=t.children[i+1];if(l&&!l.children[o].height)return!0}}return!1}(t))return 2},function(e,t){var n=e.area;if(e.rect.top>n.y+n.height)return null!=t&&t.isInHorizontalRo?2:3}];function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f;return function(t,n){var r;return e.find((function(e){return r=e(t,n)})),r}}var v=new WeakMap;function g(e){return(0,a.WAP)(e)||(0,a.ijY)(e,s.j2.HalfFullscreen)||(0,a.ijY)(e,s.j2.TableRow)}function _(e,t){var n,i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=t.painter,l=t.area,c=t.colorConverter,h=s.globalAlpha,d=null!==(n=o)&&void 0!==n?n:{},f=d.eventEmitter,v=d.relativeTo,g=d.interceptors,_=d.origin,b=d.others,T=d.flushAll,C=void 0===T||T;(0,a.$4I)(s);for(var S=l.scrollTop,w=l.scrollLeft,R=p(g),A=[[e,{origin:_}]],O=function(e,t){A.push([e,(0,u.f0)({globalAlpha:s.globalAlpha,isInHorizontalRo:!!i&&e!==i},t)])},M=function(){var e=A.pop(),t=(0,r.Z)(e,2),n=t[0],h=t[1],d=h.globalAlpha,p=h.origin,g=h.rectContainer,_=h.isInHorizontalRo,E=void 0;(0,u.hj)(d)&&(E=s.globalAlpha,s.globalAlpha=d),(0,a.Mq$)(n,(function(e){var t,r,h,d,p=e.left,v=e.top,E=e.renderObject,T=e.isBackward;p-=w,v-=S;var C=E.width,A=E.height,M=null!==(t=null===(r=o.translate)||void 0===r?void 0:r.x)&&void 0!==t?t:0,k=null!==(h=null===(d=o.translate)||void 0===d?void 0:d.y)&&void 0!==h?h:0,I={left:p+M,top:v+k,width:C,height:A},x={colorConverter:c,renderObject:E,area:(0,u.f0)({},l,{x:l.x+M,y:l.y+k}),rect:I,asRoot:n===E,painter:s,pushPaintQueue:O,rectContainer:g,others:b};if(T)i===E&&(i=void 0),m(x,f);else{var N,P,L=!_&&!i,D=null!==(N=R(x,{isInHorizontalRo:!L}))&&void 0!==N?N:null===(P=(0,a.V5j)(E,"paintInterceptor"))||void 0===P?void 0:P(x);if(D&&D>1)return D;L&&(0,a.NSX)(E)&&(i=E),y(x,f)}return 1}),{relativeTo:v,origin:p}),(0,u.hj)(E)&&(s.globalAlpha=E)};A.length;)M();C&&E(),(0,a.SFv)(s),s.globalAlpha!==h&&(s.globalAlpha=h)}function y(e,t){var n=e.renderObject,i=e.painter,o=e.rect,s=e.area,l=e.asRoot;!function(e,t){var n=(0,a.gOt)(t).opacity;if((0,u.hj)(n)&&n<1){var r=n<=0?a.IAC:n;e.globalAlpha*=r,v.set(t,(function(){e.globalAlpha/=r}))}}(i,n),null==t||t.trigger("iwillpaintro",[e]);var c=(0,a.V5j)(n,"willPaint");null==c||c(e),function(e,t,n,i,o){var s,u;if(a.p5R.has(5)&&null!==(s=t.children)&&void 0!==s&&s.length&&!g(t)){var l=(0,a.gOt)(t);if((0,a.s7M)(l)||(0,a.N9q)(t)||o){var c=null!==(u=(0,a.mhq)(e,t))&&void 0!==u?u:[],h=(0,r.Z)(c,1)[0];a.p5R.push({type:5,subType:"clip",painter:e,renderObject:t,parentArea:h,area:i,rect:n,needSetPaintArea:!0})}}}(i,n,o,s,l)}function m(e,t){var n=e.renderObject,r=e.painter,i=(0,a.V5j)(n,"didPaint");null==i||i(e),null==t||t.trigger("ididpaintro",[e]),function(e){var t=v.get(e);t&&(t(),v.delete(e))}(n),function(e,t){a.p5R.has(5)&&!g(t)&&(0,a.ha2)(e,t)&&a.p5R.push({type:5,subType:"restore",painter:e})}(r,n)}function E(){a.p5R.flush(1,"backgroundColor"),a.p5R.flush(7),a.p5R.flush(1,"selection"),a.p5R.flush(2),a.p5R.flush(3),a.p5R.flush(6),a.p5R.flush(4)}var b=new Set(s.BN),T=new Set(s.m9);function C(e,t,n,r,i){(0,u.kJ)(e)||(e=[e]);for(var o=0;o<e.length;o++)S(e[o],t,n,r,i)}function S(e,t,n,r,i){var o,s=(0,a.gOt)(t,["zoom"]).zoom;n&&e in n?o=n[e]:i&&e in i&&(o=i[e]);var l=(0,a.d89)(r,null==i?void 0:i.fontSize),c=o;if(T.has(e)){if(c=(0,a.jFX)(o,l,s),!(0,u.hj)(c))return void(0,a.Jt)(t,e);b.has(e)&&(c=Math.min(c,r/2),(0,u.HD)(o)&&o.endsWith("%")||(c=Math.min(c,Math.min(t.width,t.height)/2)))}(0,a.WXx)(t,e,c)}var w=function(e){var t=e.props;return[t.extraLeft,t.extraRight]},R=function(e,t){var n=e.left,r=e.width;return[Math.max(n,0),Math.max(t-n-r,0)]},A=function(e){var t,n,r,i,o,s=w(e);if(void 0!==s[0]&&void 0!==s[1])return s;i=s[0],o=s[1];var u,l,c=(0,a.$bs)(e);if(!c)return[null!==(u=i)&&void 0!==u?u:0,null!==(l=o)&&void 0!==l?l:0];var h,d,f=(0,a.LSh)(e);if(!f)return[null!==(h=i)&&void 0!==h?h:0,null!==(d=o)&&void 0!==d?d:0];var p=F(f),v=p.left+(null!==(t=f.scrollLeft)&&void 0!==t?t:0);return[i=null!==(n=i)&&void 0!==n?n:v,o=null!==(r=o)&&void 0!==r?r:Math.max(c.viewport.getViewportArea().width-(v+p.width),0)]},O=function(e){var t,n,r=e.element,i=null!==(t=e.scrollWidth)&&void 0!==t?t:0;return Math.max(i-(null!==(n=A(r)[1])&&void 0!==n?n:0),e.width)};function M(e,t){var n,r;return{x:e.x-t.left+(null!==(n=t.scrollLeft)&&void 0!==n?n:0),y:e.y-t.top+(null!==(r=t.scrollTop)&&void 0!==r?r:0)}}function k(e,t){var n,r;return{x:e.x+t.left-(null!==(n=t.scrollLeft)&&void 0!==n?n:0),y:e.y+t.top-(null!==(r=t.scrollTop)&&void 0!==r?r:0)}}var I=(0,a.WG0)((function(e,t){var n=(0,a.DWu)(e,t);return n.pop(),n.reduce((function(e,t){return k(e,t)}),{x:0,y:0})}),["mutate","layout"]);function x(e,t){var n=function(e){var t=0,n=0,r=(0,a.DWu)(e),i=(0,u.Z$)(r),o=r.findIndex((function(e){return(0,a.sPR)(e)}));o>-1&&(i=r[o],ye(i),t+=i.x,n+=i.y);var s=I(e,i);return{x:t+s.x,y:n+s.y}}(t),r=n.x,i=n.y;return{x:e.x+r,y:e.y+i}}function N(e,t,n){var r=I(t,n),i=r.x,o=r.y;return{x:e.x+i,y:e.y+o}}function P(e,t){var n=x(e,t);n=k(n,(0,a.yjm)(t));var r=(0,a.$bs)(t).scroll;if(r){var i=r.scrollStatus,o=i.scrollLeft,s=i.scrollTop;n.x-=o,n.y-=s}return n}function L(e,t){var n=x({x:0,y:0},t),r=n.x,i=n.y;return{x:e.x-r,y:e.y-i}}function D(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,u.f0)(t,(0,a.fWv)());return n.left=e.x,n.top=e.y,n.width=e.width,n.height=e.height,n}function F(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{left:0,top:0,width:e.width,height:e.height},n=t.left,r=t.top,i=x({x:n,y:r},e),o=i.x,a=i.y;return(0,u.f0)({},t,{left:o,top:a})}function B(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{left:0,top:0,width:e.width,height:e.height},n=t.left,r=t.top,i=P({x:n,y:r},e),o=i.x,a=i.y;return(0,u.f0)({},t,{left:o,top:a})}function V(e){var t,n=(0,a.WGj)(e);if(!n||null===(t=n.renderObjects)||void 0===t||!t.length){if(n&&(0,a.kiv)(n)){var i=(0,a.CXA)(n),o=[];return i.forEach((function(e){o=o.concat(H(e))})),o}return[]}var u=(0,a.kKo)(n,s.j2.HalfFullscreen);return n.renderObjects.map((function(e){var t=B(e);if(u){var i=e.width,o=e.scrollLeft,a=void 0===o?0:o,s=A(n),l=(0,r.Z)(s,2),c=l[0],h=l[1];t.left+=Math.max(0,a-c),t.width=i+Math.min(c,a)+h}return t}))}function H(e){return(0,a.GZ0)(V(e))}function U(e){var t,n=(0,a.WGj)(e);if(!n)return{width:0,height:0};var r=null!==(t=n.renderObjects)&&void 0!==t?t:[];if(!n.renderObjects)for(var i=(0,a.CXA)(n),o=0;o<i.length;o++){var s=i[o].renderObjects;if(s)for(var u=0;u<s.length;u++)r.push(s[u])}var l=(0,a.GZ0)(r);return{width:l.width,height:l.height}}function Z(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(0,a.fWv)(),r=t.bTLRH,i=void 0===r?0:r,o=t.bTLRV,s=void 0===o?0:o,u=t.bTRRH,l=void 0===u?0:u,c=t.bTRRV,h=void 0===c?0:c,d=t.bBLRH,f=void 0===d?0:d,p=t.bBLRV,v=void 0===p?0:p,g=t.bBRRH,_=void 0===g?0:g,y=t.bBRRV,m=void 0===y?0:y,E=Math.max(i,f),b=Math.max(l,_),T=Math.max(s,h),C=Math.max(v,m);return n.left=e.left+E,n.width=e.width-E-b,n.top=e.top+T,n.height=e.height-T-C,n}function W(e){var t,n,r=e.top,i=e.height;"lineOffsetTop"in e&&"lineOuterHeight"in e&&(r=null!==(t=e.lineOffsetTop)&&void 0!==t?t:r,i=null!==(n=e.lineOuterHeight)&&void 0!==n?n:i);return{top:r,height:i}}function j(e,t){var n,i;return(0,a.bXR)(e)?null!==(n=null!==(i=function(e,t,n){var r=(0,a.$bs)(e),i=Te(e,{area:r.getVisibleArea(),interceptor:function(e){var n={left:e.x,top:e.y,width:e.width,height:e.height};return(0,a.fGt)(t,n)&&(0,o.NY)(e)&&(0,a.bXR)(e)?1:2}}),s=i.zIndexRos,u=i.negativeZIndexRos,l=n?u:s,c=Object.keys(l).map((function(e){return Number(e)})).sort((function(e,t){return e-t}));if(!c.length)return null;var h=n?c[0]:c[c.length-1],d=l[h],f=d[d.length-1],p={x:t.x-f.x,y:t.y-f.y};return G(f,p)}(e,t,!1))&&void 0!==i?i:function(e,t){for(var n=(0,a.$bs)(e).halfFullscreenElementList,i=n.length-1;i>=0;i--){var s=(0,a.LSh)(n[i]);if(!s)return;var u=s.width,l=s.height,c=s.scrollLeft,h=void 0===c?0:c,d=s.element;if(d){var f=F(s,{left:0,top:0,width:u,height:l}),p=A(d),v=(0,r.Z)(p,2),g=v[0],_=v[1];f.width=Math.ceil(Math.min(g,h)+u+_);var y=f.left;if(f.left+=Math.max(0,h-g),(0,a.fGt)(t,f)&&(0,o.NY)(s)&&(0,a.bXR)(s))return G(s,{x:t.x-y,y:t.y-f.top})}}return null}(e,t))&&void 0!==n?n:(0,a.fGt)(t,e)&&(0,o.NY)(e)?G(e,t):null:null}function G(e,t){for(var n=!1,r=e,i=e;null!==(o=r)&&void 0!==o&&o.children;){var o;(r=$(r,t,n=n||!!r.runtime&&(0,a.Ud)(r.runtime)))&&(t=M(t,r),i=r)}return(0,a.DWu)(i)}function z(e,t){var n=W(e),r=n.top,i=n.height,o=(0,a.gOt)(e),s=o.leadingTop,u=void 0===s?0:s,l=o.leadingBottom,c=void 0===l?0:l,h=t.x,d=t.y,f=e.left,p=e.width;return d<r-u?"left":d>=r+i+c?"right":h<f?"left":h>=f+p?"right":"found"}function Y(e,t){var n=t.x,r=e.left,i=e.width;return n<r?"left":n>=r+i?"right":"found"}function X(e,t){var n=t.y,r=e.top,i=e.height;return n<r?"left":n>=r+i?"right":"found"}function K(e){return function(t,n){return function(e,t,n){var r,i=e.children;if(null===(r=i)||void 0===r||!r.length)return null;i=i.filter(a.BJ0);var o=(0,a.ry4)(i,(function(e){return n(e,t)}));if(o>=i.length)return null;var s=i[o];if((0,a.fGt)(t,s))return s;return null}(t,n,e)}}s.j2.InlineFlow,s.j2.BlockFlow,s.j2.FlexRow,s.j2.FlexColumn,s.j2.SuperList;var q={InlineFlow:K(z),BlockFlow:K(X),FlexRow:K(Y),FlexColumn:K(X),SuperList:K(X)};function $(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=J;return(0,a.ijY)(e,s.j2.TableRow)?r=Q:(0,a.ijY)(e,s.j2.InlineFlow)&&e.hasRTL?r=J:n&&e.type in q&&(r=q[e.type]),r(e,t)}function J(e,t){var n,r=e.children;if(null===(n=r)||void 0===n||!n.length)return null;for(var i=(r=r.filter(a.BJ0)).length-1;i>=0;i--){var o=r[i];if((0,a.fGt)(t,o)&&(0,a.bXR)(o))return o}return null}function Q(e,t){if(!(0,a.bXR)(e))return null;var n=e.parent.children,i=e.runtime.context.tpu,o=null==i?void 0:i.getRelatedCellsByRowIndex(null==i?void 0:i.getRowIndex(e));if(null!=o&&o.length)for(var s=k(t,e),u=0;u<o.length;u++){var l=(0,r.Z)(o[u],2),c=l[0],h=l[1],d=n[c],f=M(s,d),p=d.children[h];if((0,a.fGt)(f,p)&&(0,a.BJ0)(p))return t.y=f.y,p}return J(e,t)}function ee(e,t){var n=e.scroll,r=e.elementPool;if(t){var i,o,s=r.get(t.eid),u=(0,a.cay)(s);return{scrollLeft:null!==(i=null==u?void 0:u.scrollLeft)&&void 0!==i?i:0,scrollTop:null!==(o=null==u?void 0:u.scrollTop)&&void 0!==o?o:0}}return n.scrollStatus}function te(e,t,n,r,i){if(!n)return null;var o=j(n,e);if(null!=o&&o.length)for(var u=0;u<o.length;u++){var l=o[u],c=l.scrollLeft,h=void 0===c?0:c,d=l.scrollTop,f=void 0===d?0:d,p=l.scrollWidth,v=void 0===p?0:p,g=l.scrollHeight,_=void 0===g?0:g,y=l.width,m=l.height,E=(0,a.gOt)(o[u],["overflowScrollX","overflowScrollY"]),b=E.overflowScrollX,T=E.overflowScrollY;if((b||(0,a.ijY)(o[u],s.j2.HalfFullscreen)&&!i)&&(t.x<=-2&&h>=2||t.x>=2&&h+y<=v-2))return o[u];if(T&&(t.y<=-2&&f>=2||t.y>=2&&f+m<=_-2))return o[u]}if(!i)return null;if(r){var C=window.getComputedStyle(r,null),S=/(auto|scroll)/.test(["overflow","overflow-y","overflow-x"].map((function(e){return C.getPropertyValue(e)})).join("")),w=r===document.documentElement;if(S||w){var R=r.scrollLeft,A=r.scrollTop,O=r.scrollWidth,M=r.scrollHeight,k=r.offsetWidth,I=r.offsetHeight,x=parseInt(C.getPropertyValue("border-left-width"))+parseInt(C.getPropertyValue("border-right-width")),N=parseInt(C.getPropertyValue("border-top-width"))+parseInt(C.getPropertyValue("border-bottom-width")),P=w?O:O-k+x,L=w?M:M-I+N;if(P>0&&0!==t.x&&R<=P||L>0&&0!==t.y&&A<=L)return r}}return null}function ne(e){for(var t,n=(0,a.WGj)(e);n;){var r;if((0,a.kKo)(n,s.j2.HalfFullscreen)||((t=n).style.overflowScrollX||t.style.overflowScrollY))return null!==(r=n.shadow)&&void 0!==r?r:(0,a.F8u)(n);n=n.parent}return null}var re=function(e){var t;return null!==(t=e.maxContentWidth)&&void 0!==t?t:window.innerWidth},ie=function(e){var t;return null!==(t=e.maxContentHeight)&&void 0!==t?t:1/0},oe=function(e){return Math.min(re(e),function(e,t){var n=e.container;return!t&&(t=(0,i.$r)(n)),Math.max(0,n.offsetWidth-t.paddingLeft-t.paddingRight)}(e))},ae=function(e){return Math.min(ie(e),function(e){var t=e.scroller,n=e.container,r=e.hasRendered,i=function(e){return Math.min(window.innerHeight,e)},o=t&&(t.style.height||t.style.maxHeight);if("string"==typeof o&&o.length>0&&o.includes("px"))return i(parseFloat(o));if(!r||!t){var a,s=(null!==(a=t)&&void 0!==a?a:n).getBoundingClientRect();return i(Math.max(0,window.innerHeight-s.top))}return i(t.offsetHeight)}(e))},se=function(e,t,n){var r,i,o=0,a=0;-e.top!==n.scrollTop&&(o=e.top-(null!==(r=null==t?void 0:t.top)&&void 0!==r?r:0)+n.scrollTop);-e.left!==n.scrollLeft&&(a=e.left-(null!==(i=null==t?void 0:t.left)&&void 0!==i?i:0)+n.scrollLeft);return{top:o,left:a}},ue=function(e){var t,n,r,o,a=e.container,s=e.rNode,u=e.scroller,l=(0,i.$r)(a),c=s.getRenderTree(),h=a.getBoundingClientRect(),d=Math.min(Math.max(0,h.width-l.paddingLeft-l.paddingRight),null!==(t=null==c?void 0:c.width)&&void 0!==t?t:1/0),f=Math.min(Math.max(0,h.height-l.paddingTop-l.paddingBottom),null!==(n=null==c?void 0:c.height)&&void 0!==n?n:1/0),p=null==u?void 0:u.getBoundingClientRect(),v=null!==(r=null==p?void 0:p.width)&&void 0!==r?r:1/0,g=null!==(o=null==p?void 0:p.height)&&void 0!==o?o:1/0,_=Math.min(v,d),y=Math.min(g,f),m=ee(e),E=m.scrollTop,b=m.scrollLeft,T=h.top,C=h.left,S=E,w=b;if(a!==u){var R=se(h,p,m),A=R.top,O=R.left;S=Math.max(0,E-A),w=Math.max(0,b-O),T+=E,C+=b}return{x:0,y:0,left:C,top:T,width:_,height:y,scrollTop:S,scrollLeft:w,paddingLeft:l.paddingLeft,paddingTop:l.paddingTop}},le=function(e){var t=e.container,n=e.scroller,r=null==n?void 0:n.getBoundingClientRect(),i=t.getBoundingClientRect(),o=ee(e),a=o.scrollTop,s=o.scrollLeft,u=se(i,r,o),l=u.top,c=u.left;return{x:0,y:0,top:Math.min(l,a),left:Math.min(c,s),width:oe(e),height:ae(e),scrollLeft:Math.max(s-c,0),scrollTop:Math.max(a-l,0)}},ce=function(e){return e&&parseInt(e)||0},he=function(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{left:null!==(n=t.x)&&void 0!==n?n:0,top:null!==(r=t.y)&&void 0!==r?r:0,width:t.width,height:t.height},o=i.width,s=i.height,l=i.left,c=i.top,h=(0,a.R3e)(e);C(["left","right"],e,h,o),C(["top","bottom"],e,h,s);var d=(0,a.gOt)(e,["top","right","bottom","left"]),f=(0,a.gOt)(t,["borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth"]);if((0,u.Rw)(d.right)){var p=ce(d.left),v=ce(null==f?void 0:f.borderLeftWidth);l+=p+v}else{var g=ce(d.right),_=ce(null==f?void 0:f.borderRightWidth);l+=o-g-_-e.width}if((0,u.Rw)(d.bottom)){var y=ce(d.top),m=ce(null==f?void 0:f.borderTopWidth);c+=y+m}else{var E=ce(d.bottom),b=ce(null==f?void 0:f.borderBottomWidth);c+=s-E-b-e.height}return{x:l,y:c}},de=function(e,t){return he(e,t)},fe=function(e,t){var n,r,i=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{left:0,top:0,width:e.width,height:e.height},r=n.left,i=n.top,o=N({x:r,y:i},e,t),a=o.x,s=o.y;return(0,u.f0)({},n,{left:a,top:s})}(e,t,{left:null!==(n=t.x)&&void 0!==n?n:0,top:null!==(r=t.y)&&void 0!==r?r:0,width:e.width,height:e.height});return{x:i.left,y:i.top}},pe=["mutate","layout"],ve=function(e){return(0,a.WG0)((function(){for(var e=1;e<arguments.length;e++){var t=e<0||arguments.length<=e?void 0:arguments[e],n=e-1<0||arguments.length<=e-1?void 0:arguments[e-1],r=0,i=0;if((0,a.ijY)(t,s.j2.Absolute)){var o=de(t,n);r=o.x,i=o.y}else{var u=fe(t,n);r=u.x,i=u.y}t.x=r,t.y=i}}),pe,e)},ge=ve(),_e=(0,a.DfN)(["mutate"],null,{willClear:function(e){var t,n=l(e.keys());try{for(n.s();!(t=n.n()).done;){var r=t.value;(0,a.OdJ)(pe,r)}}catch(e){n.e(e)}finally{n.f()}}}),ye=function(e){var t,n,r,i,o,u,l,c=(0,a.kKo)(e)?e:e.element,h=(0,a.uYS)(c).reverse(),d=h.findIndex((function(e){return(0,a.kKo)(e,s.j2.Fixed)}));if(d>0){var f=h[d],p="".concat((0,a.$bs)(c).id,"-").concat(f._id);(t=_e.get(p))||(t=ve(p),_e.set(p,t));var v=(0,a.LSh)(f),g=(0,a.LSh)(h[d-1]);g.x=0,g.y=0;var _=(n=v,r=g,o=(0,a.$bs)(n),u=null!==(i=o.rNode.paintArea)&&void 0!==i?i:ue(o),l={left:u.scrollLeft,top:u.scrollTop,width:u.width,height:u.height},he(n,r,l)),y=_.x,m=_.y;v.x===y&&v.y===m||(v.x=y,v.y=m,(0,a.ZHw)(["layout"],p)),h=h.slice(d)}else{t=ge;var E=(0,a.LSh)(h[0]);E.x=0,E.y=0}var b=h.map((function(e){return(0,a.LSh)(e)}));t.apply(void 0,b)};function me(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=be(e,t,n);if(r.length){var i,o=t.painter,s=t.area,c=n.relativeTo,h=void 0===c?{left:0,top:0}:c,d=(0,u.f0)({},t),f=l(r);try{for(f.s();!(i=f.n()).done;){var p,v=i.value,g=l(v);try{for(g.s();!(p=g.n()).done;){var y=p.value,m=Ee(y,s,h);(0,a.NqN)(o,y,m),d.area=m,_(y,d,n)}}catch(e){g.e(e)}finally{g.f()}}}catch(e){f.e(e)}finally{f.f()}(0,a.SFv)(o)}}function Ee(e,t,n){var r=t.scrollLeft,i=t.scrollTop,o=e.x,a=e.y,s=e.width,u=e.height;return{x:o-r-n.left,y:a-i-n.top,width:s,height:u,scrollLeft:r,scrollTop:i}}function be(e,t,n){var r=t.painter,i=t.area;i=(0,u.f0)({},i,{x:i.x-1*i.width,y:i.y-1*i.height,width:3*i.width,height:3*i.height});var o=n.relativeTo,s=n.interceptors,l=n.origin,c=n.others,h=p(s),d=Te(e,{relativeTo:o,origin:l,area:i,interceptor:function(t,n){if(!(0,a.QB3)(t))return h({renderObject:t,area:i,rect:n,asRoot:e===t,painter:r,others:c})}}),f=d.negativeZIndexRos,v=d.zIndexRos;return Object.values(f).reverse().concat(Object.values(v))}function Te(e,t){var n=t.area,r=t.interceptor,i=t.origin,s=t.relativeTo,u=n.scrollLeft,l=n.scrollTop,c={},h={};return(0,a.Mq$)(e,(function(e){var t=e.renderObject;if(e.isBackward||!(0,a.WAP)(t))return 1;ye(t);var n=t.x-u,i=t.y-l,s=t.width,d=t.height,f=r(t,{left:n,top:i,width:s,height:d});if(f&&f>1)return f;if(!(0,o.NY)(t))return 2;if((0,a.WAP)(t)){var p,v=null!==(p=(0,a.gOt)(t,["zIndex"]).zIndex)&&void 0!==p?p:0,g=v<0?h:c,_=g[v=Math.abs(v)];_||(g[v]=_=[]),_.push(t)}return 1}),{relativeTo:s,origin:i,childrenProperty:"posRos",parentProperty:"refPosRo"}),{zIndexRos:c,negativeZIndexRos:h}}function Ce(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0,i=n.eventEmitter,o=[t],s=t.painter,u=t.area;(0,a.zsN)(s,u),null==i||i.trigger("iwillpaint",o),_(e,t,n),r&&me(e,t,r),null==i||i.trigger("ididpaint",o)}},vsh_96098:function(e,t,n){"use strict";n.d(t,{o:function(){return o}});var r=n("vsh_65498"),i=Object.defineProperty,o=function(e,t,n){return function(e,t,n){t in e?i(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!==(0,r.Z)(t)?t+"":t,n),n}},vsh_57506:function(e,t,n){"use strict";n.d(t,{$p:function(){return c},NC:function(){return d},dK:function(){return p},tq:function(){return v},Yw:function(){return g},Dv:function(){return _},Vd:function(){return y}});var r=n("vsh_98652"),i=n("vsh_36204"),o=n("vsh_98713"),a=n("vsh_83675"),s=n("vsh_50398"),u=n("vsh_25098");function l(e,t){if(function(e,t){var n;return!!(0,a.ijY)(e,s.j2.TableCell)&&!(null==t||null===(n=t.context)||void 0===n||!n.tpu)}(e,t)){var n=t.context.tpu,r=n.getRowIndex(e.parent),i=n.getColumnIndex(e);if(!(r<0||i<0))return n.getCellOverlap([r,i])}}function c(e,t){var n=l(e,t);return!(null==n||!n.overlap||n.isMainCell)}var h=[function(e){var t=e.renderObject.runtime;if(t&&(0,a.Lki)(t))return 2}].concat((0,r.Z)(o.mW));function d(e,t,n){var r=n.rNode;return(0,a.zsN)(e,f(r.paintArea,t)),i.Dh.getInstance(r.getRenderTree(),{painter:e,idx:t,rNodeContext:n})}function f(e,t){var n=e.width,r=e.height,i=e.scrollTop,o=e.scrollLeft;return(0,u.f0)({},e,{scrollTop:i+t*r,scrollLeft:o,width:n,height:r})}var p=function(e){var t=e.renderObject,n=e.painter,r=e.rect,o=e.area;if(!(0,a.WAP)(t)){var u=t.runtime;if(!(!u||(0,a.ijY)(t,s.j2.TableCell)&&c(t,u)||!(0,a.eTE)(u)&&!(0,a.Vfo)(t.element))){var l=(0,i.Jb)(n),h=l.getCollectingDirtyLine();l.setCollectingDirtyLine(Math.min(r.top+o.scrollTop,h))}}};function v(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=t.layerManager,l=t.rNode.eventEmitter,c=e.getPainter(),d=(0,a.Wln)(c),f=c.canvas;if(s.updateLayer(d,f)&&e.markDirty(),e.isCompleted)return d;var p=e.dirtyLine,v=d.scrollTop,g=v+d.height,_=p-v,y=(0,u.f0)({},d,{y:_,height:d.height-_});p=Math.min(n.height,g),e.setCollectingDirtyLine(p),s.setLayerVisible(f,!0);var m=(0,o.V0)(y);s.clearLayerRect(f,void 0,m),e.readyToPaint(y);var E={eventEmitter:l,interceptors:h,others:r};return(0,o.Kf)(n,{painter:c,area:y},E,i?E:void 0),y}function g(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=t[r+n];i.reset(),(0,a.zsN)(i.getPainter(),n?f(e,n):e)}function _(e,t){var n=Math.floor(t.length/2);g(e,t,0,n);for(var r=1;r<=n;r++)g(e,t,r,n),g(e,t,-r,n)}function y(e,t){var n=t.height,r=e.filter((function(e){return e.isPartialDirty})).reduce((function(e,t){return Math.min(t.dirtyLine,e)}),t.height);e.filter((function(e){return!e.isDirty})).forEach((function(e){return e.commit(r,n)}))}},vsh_55042:function(e,t,n){"use strict";n.d(t,{$r:function(){return r},SZ:function(){return i},Bp:function(){return o}});var r=function(e){var t=window.getComputedStyle(e),n=t.paddingLeft,r=t.paddingTop,i=t.paddingRight,o=t.paddingBottom;return{paddingLeft:parseInt(n,10)||0,paddingTop:parseInt(r,10)||0,paddingRight:parseInt(i,10)||0,paddingBottom:parseInt(o,10)||0}},i=function(e){e.style.visibility="unset"},o=function(e){e.style.visibility="hidden",e.style.transform="translate(-100%, -100%)"}},vsh_7799:function(e,t,n){"use strict";n.d(t,{MC:function(){return $e},Gp:function(){return Je},fD:function(){return it},jx:function(){return at},vj:function(){return st},HV:function(){return gt},Ky:function(){return Ct},Oo:function(){return Ot},IC:function(){return Mt},a5:function(){return Pt},r$:function(){return Lt},$3:function(){return Ht},Lu:function(){return zt},UP:function(){return Yt},MT:function(){return Xt},R:function(){return Kt},SK:function(){return qt},_T:function(){return $t},CU:function(){return Jt},Ps:function(){return fn},TK:function(){return vn},Zu:function(){return _n},VV:function(){return P},xN:function(){return L},Pj:function(){return Tn},Tj:function(){return Cn},ZC:function(){return le},xv:function(){return Oe},d:function(){return Be},eY:function(){return si},us:function(){return li},MG:function(){return hi},hk:function(){return Wi},e2:function(){return zi},gq:function(){return so},VB:function(){return Rn},gh:function(){return zn},m5:function(){return er},ah:function(){return tr},ST:function(){return rr},Ft:function(){return ir},Dx:function(){return or},u9:function(){return sr},RR:function(){return lr},UZ:function(){return cr},cG:function(){return dr},X8:function(){return gr},sW:function(){return _r},$t:function(){return yr},I5:function(){return Tr},Hw:function(){return wr},RL:function(){return Ir},r6:function(){return Hr},r1:function(){return Wr},Dz:function(){return zr},wW:function(){return Yr},Zt:function(){return Kr},kr:function(){return Jr}});var r=n("vsh_74561"),i=n("vsh_56589"),o=n("vsh_65498"),a=n("vsh_93035"),s=n("vsh_26278"),u=n("vsh_12064"),l=n("vsh_22462"),c=n("vsh_73455"),h=n("vsh_19264"),d=n("vsh_4175"),f=n("vsh_1139"),p=n("vsh_98652"),v=n("vsh_85684"),g=n("vsh_6114"),_=n("vsh_403"),y=n("vsh_57506"),m=n("vsh_36204"),E=n("vsh_98713"),b=n("vsh_55042"),T=n("vsh_42410"),C=n("vsh_83675"),S=n("vsh_50398"),w=n("vsh_56314"),R=n("vsh_25098"),A=n("vsh_96098"),O=n("vsh_94596"),M=n.n(O),k=n("vsh_75119"),I=["commandList"];function x(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var P=function(e){return!!(0,C.gOt)(e,["overflowScrollX"]).overflowScrollX||(0,C.ijY)(e,S.j2.HalfFullscreen)},L=function(e){return!!(0,C.gOt)(e,["overflowScrollY"]).overflowScrollY};function D(e,t,n,r){var i=(0,C.gOt)(e,["zoom"]).zoom,o=void 0===i?1:i,a=t.width;if(void 0===a){var s,u=e.parent;if(u&&(S.e8.has(u.type)||P(u)||(0,C.ijY)(u,S.j2.BlockFlow)&&"auto"===u.style.width))a="auto";else a=null!==(s=S.AX.width[e.type])&&void 0!==s?s:"auto"}if("auto"!==a){var l=(0,C.d89)(n,null==r?void 0:r.fontSize),c=(0,C.jFX)(a,l,o);(0,C.WXx)(e,"width",(0,R.hj)(c)?c:"auto")}else(0,C.WXx)(e,"width","auto")}function F(e,t,n,r){var i,o,a=(0,C.gOt)(e,["zoom"]).zoom,s=void 0===a?1:a,u=t.height;if("auto"!==(u=null!==(i=null!==(o=u)&&void 0!==o?o:S.AX.height[e.type])&&void 0!==i?i:"auto")){var l=(0,C.d89)(n,null==r?void 0:r.fontSize),c=(0,C.jFX)(u,l,s);(0,C.WXx)(e,"height",(0,R.hj)(c)?c:"auto")}else(0,C.WXx)(e,"height","auto")}function B(e,t){var n=t.opacity;(0,R.hj)(n)&&(n=n>1?1:n<0?0:n),(0,C.WXx)(e,"opacity",n)}var V=function(e){return(0,C.TpM)(e)},H=function(e,t,n){var r,i,o=t.baselineOffset;if(o){var a=null==n?void 0:n.fontSize,s=(0,C.gOt)(e,["zoom","fontSize"]),u=s.zoom,l=void 0===u?1:u,c=null!==(r=null!==(i=s.fontSize)&&void 0!==i?i:a)&&void 0!==r?r:R.n5,h=(0,C.d89)(c,c),d=(0,C.jFX)(o,h,l);(0,C.WXx)(e,"baselineOffset",d)}},U={buildContext:V,createChildConstraint:function(e,t){var n=t.runtime;(0,C.gRG)(n,(0,C.iDd)(e)),(0,C.gRG)(n,(0,C.hPv)(e)||!1===e.props.lineWrap?S.ql:{})},wrapup:function(e,t){var n,r,i,o,a=t.maxWidth,s=t.minWidth,u=t.maxHeight,l=t.minHeight,c=t.isWeakWidth,h=(0,C.S1Q)(e),d=h.paddingLeft,f=h.paddingRight,p=h.paddingTop,v=h.paddingBottom,g=h.borderTop,_=h.borderLeft,y=h.borderBottom,m=h.borderRight,E=d+_,b=p+g,T=(0,C.IhD)(e,E,b),S=E+f+m+T[0],w=b+v+y+T[1],A=(0,C.gOt)(e);((0,C.ryg)(e,{width:(0,C.PuD)(null!==(n=A.width)&&void 0!==n?n:"auto",S,s,a,c),height:(0,C.PuD)(null!==(r=A.height)&&void 0!==r?r:"auto",w,l,u)}),P(e))&&(0,C.ryg)(e,{scrollLeft:null!==(i=e.scrollLeft)&&void 0!==i?i:0,scrollWidth:S});L(e)&&(0,C.ryg)(e,{scrollTop:null!==(o=e.scrollTop)&&void 0!==o?o:0,scrollHeight:w});G(e,(0,R.f0)({},(0,C.R3e)(e)))}},Z=Object.assign({computeStyle:function(e,t){var n=(0,R.f0)({},(0,C.R3e)(e));(0,C.XiT)(n);var r=(0,C.j2w)(t),i=r.maxWidth,o=r.maxHeight,a=r.inheritedStyle;(0,E.tw)("zoom",e,n,void 0,a),D(e,n,i,a),(0,E.tw)(["minWidth","maxWidth"],e,n,i,a),F(e,n,o,a),(0,E.tw)(["minHeight","maxHeight"],e,n,o,a),(0,E.tw)("display",e,n),function(e,t,n,r,i){var o=t.transform;if(o){var a=o.rotate,s=o.origin;if(a&&"number"==typeof a)if(void 0!==(null==s?void 0:s.x)&&void 0!==(null==s?void 0:s.y)){var u=(0,C.gOt)(e).zoom,l=void 0===u?1:u,c=(0,C.d89)(r,null==i?void 0:i.fontSize),h=(0,C.d89)(n,null==i?void 0:i.fontSize),d=(0,C.jFX)(s.x,h,l),f=(0,C.jFX)(s.y,c,l);(0,C.WXx)(e,"transform",{rotate:a,origin:{x:d,y:f}})}else(0,C.WXx)(e,"transform",{rotate:a,origin:void 0});else(0,C.WXx)(e,"transform",void 0)}}(e,n,i,o,a),(0,E.tw)(["borderLeftWidth","borderRightWidth","outlineLeftWidth","outlineRightWidth"].concat((0,p.Z)(S.be),(0,p.Z)(S.yT),["outlineOffset"]),e,n,i,a),(0,E.tw)(["borderTopWidth","borderBottomWidth","outlineTopWidth","outlineBottomWidth"],e,n,o),(0,E.tw)(["backgroundColor","cursor","overflowScrollX","overflowScrollY"].concat((0,p.Z)(S.$L),(0,p.Z)(S.Fp),(0,p.Z)(S.zb),(0,p.Z)(S.X2)),e,n),B(e,n),H(e,n,a)}},U),W=S.in.map((function(e){return"".concat(e,"H")})),j=S.in.map((function(e){return"".concat(e,"V")}));function G(e,t){(0,C.Kkw)(t),(0,E.tw)(W,e,t,e.width),(0,E.tw)(j,e,t,e.height)}var z=.5*Math.PI,Y=.25*Math.PI,X={TOP:0,RIGHT:1,BOTTOM:2,LEFT:3},K=[[1,1],[-1,1],[-1,-1],[1,-1]],q=function(e){return Math.sin(e)},$=function(e){return Math.cos(e)},J={TOP:[q,$],RIGHT:[$,q],BOTTOM:[q,$],LEFT:[$,q]};function Q(e){return K[e%K.length]}function ee(e,t,n){var r=e.rect,i=r.left,o=r.top,a=e.renderObject,s=e.boxMetrics,u=e.painter,l=(0,C.gOt)(a),c="outline"===t,h=c?C.o6v:C.$vv,d=l["".concat(h[n],"Width")];if((0,R.hj)(d)&&!(d<=0)){var v,g,_,y,m,E,b,T,S=a.height,w=a.width;if(c)v=[null!==(_=l.outlineTopWidth)&&void 0!==_?_:0,null!==(y=l.outlineRightWidth)&&void 0!==y?y:0,null!==(m=l.outlineBottomWidth)&&void 0!==m?m:0,null!==(E=l.outlineLeftWidth)&&void 0!==E?E:0],g=v.map((function(e){var t;return e?e+(null!==(t=l.outlineOffset)&&void 0!==t?t:0):e}));else v=[s.borderTop,s.borderRight,s.borderBottom,s.borderLeft];switch(n){case"TOP":b=[[i,o],[i+w,o]],g&&(b[0][0]-=g[3],b[0][1]-=g[0],b[1][0]+=g[1],b[1][1]-=g[0]);break;case"RIGHT":b=[[i+w,o],[i+w,o+S]],g&&(b[0][0]+=g[1],b[0][1]-=g[0],b[1][0]+=g[1],b[1][1]+=g[2]);break;case"BOTTOM":b=[[i+w,o+S],[i,o+S]],g&&(b[0][0]+=g[1],b[0][1]+=g[2],b[1][0]-=g[3],b[1][1]+=g[2]);break;case"LEFT":b=[[i,o+S],[i,o]],g&&(b[0][0]-=g[3],b[0][1]+=g[2],b[1][0]-=g[3],b[1][1]-=g[0])}if(c){var A=function(e,t){return e>0?e+g[t]:e},O=l.bTLRH,M=void 0===O?0:O,k=l.bTLRV,I=void 0===k?M:k,x=l.bTRRH,N=void 0===x?0:x,P=l.bTRRV,L=void 0===P?N:P,D=l.bBRRH,F=void 0===D?0:D,B=l.bBRRV,V=void 0===B?F:B,H=l.bBLRH,U=void 0===H?0:H,Z=l.bBLRV,W=void 0===Z?U:Z;T={bTLRH:A(M,3),bTLRV:A(I,0),bTRRH:A(N,1),bTRRV:A(L,0),bBRRH:A(F,1),bBRRV:A(V,2),bBLRH:A(U,3),bBLRV:A(W,2)}}else T=l;var j=function(e){var t,n,r,i,o,a=e.path,s=e.side,u=e.widths,l=e.radius,c=(0,f.Z)(u,4),h=c[0],d=c[1],v=c[2],g=c[3],_=l.bTLRH,y=void 0===_?0:_,m=l.bTLRV,E=void 0===m?y:m,b=l.bTRRH,T=void 0===b?0:b,C=l.bTRRV,S=void 0===C?T:C,w=l.bBRRH,R=void 0===w?0:w,A=l.bBRRV,O=void 0===A?R:A,M=l.bBLRH,k=void 0===M?0:M,I=l.bBLRV,x=void 0===I?k:I,N=(0,f.Z)(a,2),P=N[0],L=N[1],D=X[s],F=Q(D),B=Q(D+1),V=J[s],H=0,U=[Y,Y];switch(s){case"TOP":t=[g,h],n=[d,h],r=[y,E],i=[T,S],H=1.5*Math.PI,!g&&(U[0]=z),!d&&(U[1]=z),o=[0,1];break;case"RIGHT":t=[d,h],n=[d,v],r=[T,S],i=[R,O],H=0,!h&&(U[0]=z),!v&&(U[1]=z),o=[1,0];break;case"BOTTOM":t=[d,v],n=[g,v],r=[R,O],i=[k,x],H=.5*Math.PI,!d&&(U[0]=z),!g&&(U[1]=z),o=[0,1];break;case"LEFT":t=[g,v],n=[g,h],r=[k,x],i=[y,E],H=Math.PI,!v&&(U[0]=z),!h&&(U[1]=z),o=[1,0]}var Z=i.map((function(e,t){return Math.max(0,e-n[t])})),W=r.map((function(e,n){return Math.max(0,e-t[n])}));Z.includes(0)&&(Z=[0,0]),W.includes(0)&&(W=[0,0]);var j=F.map((function(e,t){return P[t]+e*r[t]})),G=B.map((function(e,t){return L[t]+e*i[t]})),K=B.map((function(e,t){return L[t]+e*(Z[t]+n[t])})),q=F.map((function(e,n){return P[n]+e*(W[n]+t[n])})),$=[],ee=[],te=F.map((function(e,t){return j[t]-e*V[t](U[0])*r[t]})),ne=B.map((function(e,t){return G[t]-e*o[t]*i[t]})),re=B.map((function(e,t){return K[t]-e*V[t](U[1])*Z[t]})),ie=F.map((function(e,t){return q[t]-e*o[t]*W[t]}));return r.includes(0)||$.push(["ellipse",[].concat((0,p.Z)(j),(0,p.Z)(r),[0,H-U[0],H,!1])]),$.push(["lineTo",(0,p.Z)(ne)]),i.includes(0)||$.push(["ellipse",[].concat((0,p.Z)(G),(0,p.Z)(i),[0,H,H+U[1],!1])]),Z.includes(0)||ee.push(["ellipse",[].concat((0,p.Z)(K),(0,p.Z)(Z),[0,H+U[1],H,!0])]),ee.push(["lineTo",(0,p.Z)(ie)]),W.includes(0)||ee.push(["ellipse",[].concat((0,p.Z)(q),(0,p.Z)(W),[0,H,H-U[0],!0])]),{pA:te,pE:re,outerPath:$,innerPath:ee}}({path:b,side:n,widths:v,radius:T}),G=c?C.jF8:C.uRb,K=(0,R.f0)({type:7,fill:l[G[n]]||R.Ng.borderColor,path:b,painter:u},j);C.p5R.push(K),C.p5R.flush(7)}}function te(e){var t=e.rect,n=t.top,r=t.left,i=e.renderObject,o=e.boxMetrics,a=e.painter,s=(0,C.gOt)(i);if(s.backgroundColor){var u=o.borderTop,l=o.borderRight,c=o.borderBottom,h=o.borderLeft,d=o.paddingTop,f=o.paddingRight,p=o.paddingBottom,v=o.paddingLeft,g=o.contentWidth,_=o.contentHeight;if(!(g+v+f===0||_+d+p===0)){var y=r+h,m=r+h+g+v+f-y,E=n+u,b=n+u+_+d+p-E,T={type:1,left:y,top:E,width:m,height:b,fill:s.backgroundColor,opacity:a.globalAlpha,radius:(0,C.KwJ)(y,E,m,b,(0,R.f0)({borderTopWidth:u,borderRightWidth:l,borderBottomWidth:c,borderLeftWidth:h},s))};C.p5R.push(T,"backgroundColor"),C.p5R.flush(1,"backgroundColor")}}}var ne=";",re="_",ie=function(){function e(){(0,h.Z)(this,e),this.cmds={}}return(0,d.Z)(e,[{key:"onPush",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:re,n=this.cmds[t];n||(this.cmds[t]=n=new Map);var r=e.fill,i=void 0===r?"":r,o=e.stroke,a=void 0===o?"":o,s=e.lineWidth,u=void 0===s?0:s,l=e.opacity,c="".concat(i).concat(ne).concat(a).concat(ne).concat(u).concat(ne).concat(l),h=n.get(c);if(!h)return n.set(c,h=[]),void h.push(e);var d=e.left,f=e.top,p=e.width,v=e.height,g=(0,C.ry4)(h,(function(e){var t=e.left,n=e.top;return f<n||f===n&&d<t?"left":f>n||f===n&&d>t?"right":"found"})),_=h[Math.max(0,g-1)];_&&((f===_.top&&v===_.height||d===_.left&&p===_.width)&&(0,C.SXw)(_,e)||(0,C.xuz)(_,e)||(0,C.xuz)(e,_))?(0,R.f0)(_,(0,C.GZ0)([_,e])):h.splice(g,0,e)}},{key:"onFlush",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:re,n=this.cmds[t];if(n){var r=e.fillType,i=e.strokeType;e.strokeType=1,e.fillType="backgroundColor"===t?0:2,n.forEach((function(t,n){var r=n.split(ne),i=(0,f.Z)(r,4),o=i[0],a=i[1],s=i[2],u=i[3];(0,C.qrK)(e,{fill:o,stroke:a,lineWidth:+s,opacity:+u});var l,c=x(t);try{for(c.s();!(l=c.n()).done;){var h=l.value;(0,C.Mui)(e,h)}}catch(e){c.e(e)}finally{c.f()}})),n.clear(),e.fillType=r,e.strokeType=i}}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re;delete this.cmds[e]}},{key:"clearAll",value:function(){this.cmds={}}}],[{key:"type",get:function(){return 1}}]),e}();function oe(e,t){e.lineWidth=t.lineWidth,e.strokeStyle=t.stroke,e.globalAlpha=t.opacity}function ae(e,t){var n,r=x(t);try{for(r.s();!(n=r.n()).done;){var i,o=(0,f.Z)(n.value,2),a=o[0],s=o[1];null===(i=e[a])||void 0===i||i.call.apply(i,[e].concat((0,p.Z)(s)))}}catch(e){r.e(e)}finally{r.f()}}var se={willPaint:function(e){var t,n,r,i,o,a,s,u,l=e.painter,c=e.renderObject,h=e.rect,d=c.width,f=c.height;if(0!==c.width&&0!==c.height){var p=h.left,v=h.top;(0,C.$vD)(l,c,h),null===(t=l.setKeepSaveNum)||void 0===t||t.call(l);var g={painter:l,rect:h,renderObject:c,boxMetrics:(0,C.idt)(c)};te(g),["border","outline"].forEach((function(e){["TOP","RIGHT","BOTTOM","LEFT"].forEach((function(t){ee(g,e,t)}))})),null===(n=(r=c.props).draw)||void 0===n||n.call(r,{ctx:l,fontColor:null!==(i=c.style.fontColor)&&void 0!==i?i:null===(o=c.runtime)||void 0===o||null===(a=o.context)||void 0===a||null===(s=a.inheritedStyle)||void 0===s?void 0:s.fontColor,left:p,top:v,width:d,height:f}),null===(u=l.restoreIfNeed)||void 0===u||u.call(l)}},didPaint:function(e){var t=e.painter,n=e.renderObject;0!==n.width&&0!==n.height&&(0,C.S3r)(t,n)},commandPlugins:[ie,function(){function e(){(0,h.Z)(this,e)}return(0,d.Z)(e,[{key:"onPush",value:function(e){!function(e){var t=e.pA,n=e.pE,r=e.outerPath,i=e.innerPath,o=e.fill,a=e.painter;a.beginPath(),a.moveTo.apply(a,(0,p.Z)(t)),ae(a,r),a.lineTo.apply(a,(0,p.Z)(n)),ae(a,i),a.closePath();var s=a.fillType;a.fillType=1,a.fillStyle=o,a.fill(),a.fillType=s}(e)}}],[{key:"type",get:function(){return 7}}]),e}()]},ue={update:function(e,t){var n={lineWrap:C.LBn,asOneChar:C.LBn,selectable:C.K0Q,draw:C.EZo,asRelative:C.K0Q},r=(0,C.NT5)(n,e,t.props),i=(0,C.eQi)(e,t);return i.collectToTempEntry=i.collectToTempEntry||r,i}},le=function(e){function t(){return(0,h.Z)(this,t),(0,u.Z)(this,(0,l.Z)(t).apply(this,arguments))}return(0,c.Z)(t,e),(0,d.Z)(t,null,[{key:"composeRenderSideEffects",value:function(){(0,C.UaJ)(S.j2.Div,{layout:Z,paint:se,mutate:ue})}},{key:"key",get:function(){return S.j2.Div}}]),t}(C.wA2),ce={wrapup:function(e,t,n){var r=t.isWeakWidth,i=e.runtime.constraint,o=i.maxWidth,a=void 0===o?1/0:o,s=i.maxHeight,u=void 0===s?1/0:s,l=i.minWidth,c=void 0===l?0:l,h=i.minHeight,d=void 0===h?0:h,f=(0,C.IJD)(e),p=(0,C.gOt)(e,["zoom"]).zoom,v=n.measureTextWithZoom(e.props.content,f,p).width,g=(0,C.IJD)(e),_=g.fontFamily,y=g.fontSize,m=n.measureFont(_,y),E=m.fontHeight,b=m.fontAscent;(0,C.R_0)(e,"textWidth",v),(0,C.R_0)(e,"textHeight",E),(0,C.R_0)(e,"baseline",b),(0,C.R_0)(e,"width",r?v:Math.max(c,Math.min(v,a))),(0,C.R_0)(e,"height",Math.max(d,Math.min(E,u)))},computeStyle:function(e,t){var n=t.inheritedStyle,r=(0,C.R3e)(e);(0,E.tw)(["zoom","fontFamily","fontColor","fontStyle","fontWeight","underline","lineThrough","cursor"],e,r,void 0,(0,R.f0)({fontSize:R.n5,fontFamily:R.rk},n)),(0,E.tw)("display",e,r),(0,C.p7o)(e,r,n),B(e,r),H(e,r,n)},buildContext:function(e){(0,C.ER$)(e)}};function he(e,t){for(var n=(0,C.DWu)(e,t),r=Math.max(0,n.length-((0,C.dh0)(t)?2:1)),i=n[r],o=(0,E.Fg)(i),a=o.top,s=o.height,u=(0,E.mk)({x:0,y:0},e,i).y+i.top-a,l=s-e.height-u,c=0,h=0,d=[],f=3,p=0;p<r;p++){var v=n[p],g=v.parent,_=g.children.filter(C.HSn);if(v!==_[0]&&(f&=-2),v!==(0,R.Z$)(_)&&(f&=-3),0===f)break;(0,C.HLQ)(g.type)&&d.push({ro:g,position:f})}for(var y=e,m=0,b=0,T=0,S=d;T<S.length;T++){var w=S[T],A=w.ro,O=w.position;1&O&&(c-=m),2&O&&(h-=b);var M=(0,E.mk)({x:0,y:0},y,A).x,k=(0,C.gOt)(A),I=k.marginLeft;m=void 0===I?0:I;var x=k.marginRight;b=void 0===x?0:x,1&O&&(c+=M+m),2&O&&(h+=A.width-y.width-M+b),y=A}return{outerTop:u,outerBottom:l,outerLeft:c,outerRight:h,marginLeft:m,marginRight:b}}function de(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e.charCodeAt(t);return n>1536&&n<1632||n>1641&&n<1791||n>1872&&n<1919||n>2160&&n<2207||n>2208&&n<2303||n>64336&&n<65023||n>65136&&n<65279}function fe(e){return e.ligatureStatus?pe(e.props.content,e.ligatureStatus):e.props.content}function pe(e,t){return 1&t&&(e="‮‍"+e),2&t&&(e+="‍‏‬"),e}function ve(e,t,n,r){var i,o,a=e.props.content;if("rtl"!==e.dir)return a.slice(t,n);n=null!==(i=n)&&void 0!==i?i:a.length;var s=null!==(o=e.ligatureStatus)&&void 0!==o?o:0,u=0;return" "!==a[t-1]&&"start"!==r&&(u|=1)," "!==a[n]&&"end"!==r&&(u|=2),0===t&&(u&=-2|s),n>=a.length&&(u&=-3|s),pe(a.slice(t,n),u)}function ge(e,t,n){var r=(0,C.gOt)(e).zoom,i=(0,f.Z)(t,2),o=i[0],a=i[1],s=(0,C.IJD)(e),u=e.props.content,l="rtl"===e.dir?(0,v.Yc)(n,ve(e,0,o),s,r).width:(0,v.Yc)(n,u.slice(a),s,r).width,c=o<a?"rtl"===e.dir?(0,v.Yc)(n,ve(e,0,a),s,r).width-l:(0,v.Yc)(n,u.slice(o),s,r).width-l:0;return{textRight:l,textLeft:e.textWidth-l-c,textWidth:c}}function _e(e,t,n){var r,i=e.renderObject,o=e.painter,a=e.rect,s=a.top,u=a.left,l=e.colorConverter,c=(0,C.gOt)(i);if(c[n]){var h,d=i.width,f=i.baseline,p=i.height,v=(0,C.IJD)(i),g=v.fontFamily,_=v.fontSize,y=v.fontColor,m=o.measureFont(g,_),E=m.xHeight,b=m.emDescent,T=l?l(y):y,S=Math.max(1*(null!==(r=c.zoom)&&void 0!==r?r:1),_/R.n5);switch(n){case"underline":h=s+f+b,h=Math.min(h,s+p-S);break;case"lineThrough":h=s+f-E/2-_/R.n5}if(!(0,R.o8)(h)){var w={left:u,top:h,width:d,height:S},A=t?(0,C.AQ7)([w,t]):w;if(A.height&&A.width){var O=A.left,M=A.top,k=A.height,I=A.width;(0,C.Tab)(o,{renderObject:i,lineWidth:k,strokeStyle:T,path:[[O,M],[O+I,M]],opacity:o.globalAlpha})}}}}function ye(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t.clip&&C.p5R.push(t.clip),r&&me(e,t);var i=null!==(n=t.zoom)&&void 0!==n?n:1;e.scale(i,i),e.fillText(t.text,t.x,t.y,t.maxWidth),e.scale(1/i,1/i),t.clip&&C.p5R.push({type:5,painter:t.clip.painter,subType:"restore"})}function me(e,t){var n;e.textBaseline=null!==(n=t.textBaseline)&&void 0!==n?n:R.F0,e.font=t.font,e.fillStyle=t.color,e.globalAlpha=t.opacity}var Ee=function(){function e(){(0,h.Z)(this,e),this.cmds={}}return(0,d.Z)(e,[{key:"onPush",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:re,i=this.cmds[r];i||(this.cmds[r]=i=new Map),e.textBaseline=null!==(t=e.textBaseline)&&void 0!==t?t:R.F0;var o=e.font,a=e.color,s=e.textBaseline,u=void 0===s?"":s,l=e.opacity,c=e.zoom,h="".concat(o).concat(ne).concat(a).concat(ne).concat(u).concat(ne).concat(l).concat(ne).concat(null!==(n=c)&&void 0!==n?n:1),d=i.get(h);d||i.set(h,d=[]),d.push(e)}},{key:"onFlush",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:re,n=e.fillType;e.fillType=2;var r=this.cmds[t];null==r||r.forEach((function(t,n){var r=n.split(ne),i=(0,f.Z)(r,5),o=i[0],a=i[1],s=i[2],u=i[3],l=i[4];me(e,{font:o,color:a,textBaseline:s,opacity:+u,zoom:+l});var c,h=x(t);try{for(h.s();!(c=h.n()).done;){var d=c.value;ye(e,d)}}catch(e){h.e(e)}finally{h.f()}})),null==r||r.clear(),e.fillType=n}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re;delete this.cmds[e]}},{key:"clearAll",value:function(){this.cmds={}}}],[{key:"type",get:function(){return 3}}]),e}(),be=function(){function e(){(0,h.Z)(this,e),this.cmds={}}return(0,d.Z)(e,[{key:"onPush",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:re,n=e.lineWidth,r=e.stroke,i=e.path,o=e.opacity;if(2===i.length){var a=this.cmds[t];a||(this.cmds[t]=a=new Map);var s="".concat(n).concat(ne).concat(r).concat(ne).concat(o),u=a.get(s);u||a.set(s,u=[]),u.push(e)}}},{key:"onFlush",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:re,n=this.cmds[t];if(n){var r=e.strokeType;e.strokeType=2;var i=function(e,t,n,r){if(e!==t){var i=e<t?[e,t]:[t,e];if(r.has(n)){var o=r.get(n),a=Math.min(o[0],i[0]),s=Math.max(o[1],i[1]);return s-a<=o[1]-o[0]+i[1]-i[0]?(o[0]=a,void(o[1]=s)):(r.set(n,i),o)}r.set(n,i)}},o=function(t,n,r,i){e.moveTo(t,n),e.lineTo(r,i)};n.forEach((function(t,n){e.beginPath();var r=n.split(ne),a=(0,f.Z)(r,3),s=a[0],u=a[1],l=a[2];oe(e,{lineWidth:+s,stroke:u,opacity:+l});var c,h=new Map,d=new Map,p=x(t);try{for(p.s();!(c=p.n()).done;){var v=c.value,g=(0,f.Z)(v.path,2),_=(0,f.Z)(g[0],2),y=_[0],m=_[1],E=(0,f.Z)(g[1],2),b=E[0],T=E[1];if(m===T){var C=i(y,b,m,d);C&&o(C[0],m,C[1],m)}else if(y===b){var S=i(m,T,y,h);S&&o(y,S[0],y,S[1])}else o(y,m,b,T)}}catch(e){p.e(e)}finally{p.f()}h.forEach((function(e,t){return o(t,e[0],t,e[1])})),d.forEach((function(e,t){return o(e[0],t,e[1],t)})),e.stroke()})),n.clear(),e.strokeType=r}}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re;delete this.cmds[e]}},{key:"clearAll",value:function(){this.cmds={}}}],[{key:"type",get:function(){return 2}}]),e}(),Te=function(e){var t,n=e.rect,r=e.renderObject,i=e.painter,o={colorConverter:e.colorConverter,painter:i,rect:n,originRect:n,renderObject:r};if(C.p5R.has(5)){var a=(0,C.mhq)(i,r),s=(0,f.Z)(a,1)[0],u=(0,C.idt)(r),l=(0,C.Rb9)(s,u,n);t={left:l.x,top:l.y,width:l.width,height:l.height}}if(n.height<r.textHeight){var c=(0,R.f0)({},n),h=r.textHeight-c.height;c.top-=h/2,o.rect=c}!function(e,t){var n,r=e.painter,i=e.renderObject,o=e.rect,a=e.colorConverter,s=i.props,u=i.textWidth,l=i.baseline,c=null!==(n=(0,C.gOt)(i,["zoom"]).zoom)&&void 0!==n?n:1,h=s.content;if(h){i.ligatureStatus&&(h=fe(i)),"rtl"===i.dir&&(h="‮"+h+"‏");var d=(0,C.IJD)(i);d.fontSize=d.fontSize/c;var p=o.left,g=o.top,_=o.height,y={type:3,font:(0,T.OM)(d),color:a?a(d.fontColor):d.fontColor,text:h,x:p/c,y:(g+l)/c,opacity:r.globalAlpha,zoom:c};if(t){var m=t.left,b=t.top,S=t.width,w=t.height;if(p<m||g<b||p+u>m+S||g+_>b+w){var R=(0,v.xU)(r,o,{left:m,top:b,width:S,height:w},h,d,c);y.clip={type:5,subType:"clip",rect:R,renderObject:i,painter:r,needSetPaintArea:!1};var A=(0,C.mhq)(r,i),O=(0,f.Z)(A,2),M=O[0],k=O[1],I=M.style;if(I&&(0,C.s7M)(I)){var x=(0,C.fWv)();if((0,E.V0)(M,x),(0,E.IN)(x,I,x),!(0,C.xuz)(x,R)){var N,P,L=null!==(N=null==k?void 0:k.width)&&void 0!==N?N:M.width,D=null!==(P=null==k?void 0:k.height)&&void 0!==P?P:M.height;y.clip.radius=(0,C.KwJ)(M.x,M.y,L,D,I)}}}}C.p5R.push(y)}}(o,t),_e(o,t,"underline"),_e(o,t,"lineThrough")},Ce={didPaint:Te,paintSelection:function(e){var t=e.painter,n=e.renderObject,r=e.rect,i=e.range,o=e.nodePosition,a=(0,f.Z)(i,2),s=a[0],u=a[1],l=n.props.content,c=(0,C.kSo)(n),h=he(n,c),d=h.outerTop,p=h.outerBottom,v=h.outerLeft,g=h.outerRight,_=h.marginLeft,y=h.marginRight,m=0===s?v-(1&o?_:0):0,E=u===l.length?g-(2&o?y:0):0,b=ge(n,i,t),T=b.textLeft,S=b.textWidth,w={left:r.left+T,top:r.top,width:S,height:r.height},A=(0,C.AQ7)([w,r]),O={left:A.left-m,top:A.top-d,width:m+A.width+E,height:d+A.height+p};if(O.width&&O.height){var M=(0,C.mhq)(t,c),k=(0,f.Z)(M,1)[0],I=(0,C.AQ7)([O,{left:k.x,top:k.y,width:k.width,height:k.height}]),x=(0,R.f0)({type:1,fill:C.oV2.color,opacity:t.globalAlpha},I);C.p5R.push(x,"selection")}},commandPlugins:[Ee,be,ie]};var Se=function(e){var t=e.runtime;t&&((0,C.Ud)(t)&&(0,C.DSN)(t,"status",4|t.status),(0,C.dFd)(t)),function(e){(0,C.ijY)(e,S.j2.Text)&&"none"!==e.dir&&(0,C.R_0)(e,"dir",void 0)}(e)};function we(e){var t,n,r=e,i=e.element,o=e.runtime;if(null==i||null===(t=i.renderObjects)||void 0===t||!t.length)return!1;for(var a=i.renderObjects.findIndex((function(t){return e===t})),s=a;s<i.renderObjects.length;s++){var u,l,c=i.renderObjects[s];null==o||null===(u=o.constraint)||void 0===u||null===(l=u.fragments)||void 0===l||l.remove(c)}if(a<0)return!1;var h=i.renderObjects.slice(a+1),d=h.length,f=i.renderObjects.slice(0,a).reduce((function(e,t){return(0,C.z0l)(t)&&(e+=t.props.content.length),e}),0);if((0,C.z0l)(e)&&(0,C.kKo)(i,S.j2.Text)&&((0,C.R_0)(e,"props",(0,R.f0)(e.props,{content:i.props.content?i.props.content.slice(f):""})),e.lineBreakerPosition=void 0,e.graphemeBreakerPosition=void 0),d>0){var p=(0,R.Z$)(h);(0,C.jeH)(e,{paddingBottom:p.style.paddingBottom,paddingRight:p.style.paddingRight,marginBottom:p.style.marginBottom,marginRight:p.style.marginRight,borderRightWidth:p.style.borderRightWidth,bTRRH:p.style.bTRRH,bTRRV:p.style.bTRRV,bBRRH:p.style.bBRRH,bBRRV:p.style.bBRRV});for(var v=0;v<d;v++){var g,_,y,m=h[v];null===(g=m.children)||void 0===g||g.forEach((function(t){(0,C.LVC)(e,t)})),m.children=[],(0,C.rXK)(m);var E,b=m.parent,T=null!==(_=null===(y=b.children)||void 0===y?void 0:y.indexOf(m))&&void 0!==_?_:-1;if(T>-1)null===(E=b.children)||void 0===E||E.splice(T,1)}}var w=null==o||null===(n=o.constraint)||void 0===n?void 0:n.fragments;return null!=w&&w.isFragmentValid&&w.update(e),Se(r),!0}function Re(e,t){var n,r=e.el,i=(0,f.Z)(t,2),o=i[0],a=i[1];return!(!(0,C.kKo)(r,S.j2.Text)||"content"!==o||null===(n=r.renderObjects)||void 0===n||!n.length)&&(2!==a.flag?!!(0,C.oBy)(r):we(function(e){var t=e.renderObjects;return t&&t.length?t[0]:null}(r)))}var Ae={update:function(e,t){var n={lineWrap:C.LBn,asOneChar:C.LBn,selectable:C.K0Q,content:Re},r=(0,C.NT5)(n,e,t.props),i=(0,C.eQi)(e,t);return i.collectToTempEntry=i.collectToTempEntry||r,i}},Oe=function(e){function t(){return(0,h.Z)(this,t),(0,u.Z)(this,(0,l.Z)(t).apply(this,arguments))}return(0,c.Z)(t,e),(0,d.Z)(t,null,[{key:"composeRenderSideEffects",value:function(){(0,C.UaJ)(S.j2.Text,{reconcile:{renderFunction:function(){return null}},layout:ce,paint:Ce,mutate:Ae})}},{key:"key",get:function(){return S.j2.Text}}]),t}(C.wA2);var Me={buildContext:function(e){(0,C.TpM)(e);var t=e.runtime,n=t.context;if(n){var r=n.maxWidth,i=n.originMaxWidth;(0,R.hj)(r)&&(0,R.hj)(i)&&r>i&&(0,C.W_L)(t,{maxWidth:i})}},wrapup:function(e,t){var n,r,i,o,a,s=t.maxWidth,u=t.minWidth,l=t.maxHeight,c=t.minHeight,h=t.isWeakWidth,d=(0,C.gOt)(e),f=d.width,p=d.height,v=d.zoom,g=void 0===v?1:v,_=d.fontSize,y=void 0===_?R.n5:_,m={maxWidth:s,maxHeight:l},E=(a=document.getElementById(R.fJ))||((a=document.createElement("div")).id=R.fJ,a.style.position="absolute",a.style.left="-10000px",a.style.width="100%",a.style.opacity="0",a.style.overflow="hidden",document.body.appendChild(a),a),b=null===(n=e.element)||void 0===n?void 0:n.instance;b.prerender(E,m,g,y);var T=b.getSize(),S=T.width,w=T.height;e.height=(0,C.PuD)(null!==(r=p)&&void 0!==r?r:"auto",w,c,l),(0,C.ryg)(e,{width:(0,C.PuD)(null!==(i=f)&&void 0!==i?i:"auto",S,u,s,h),height:(0,C.PuD)(null!==(o=p)&&void 0!==o?o:"auto",w,c,l)})},computeStyle:function(e,t){var n=(0,C.j2w)(t),r=n.maxWidth,i=n.maxHeight,o=n.inheritedStyle,a=(0,C.R3e)(e);(0,E.tw)("zoom",e,a,void 0,o),D(e,a,r,o),(0,E.tw)(["minWidth","maxWidth"],e,a,r,o),F(e,a,i,o),(0,E.tw)(["minHeight","maxHeight"],e,a,i,o),(0,E.tw)(["cursor","zIndex","display"],e,a),(0,C.p7o)(e,a,o),B(e,a),H(e,a,o)}},ke=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"remove";return!0===e?"alive":!1===e?"remove":e};function Ie(e,t,n,r){var i,o=n.runtime,a=null==o||null===(i=o.context)||void 0===i?void 0:i.inheritedStyle;for(var s in e){var u=e[s],l=n.style[s];void 0===l&&a&&(l=a[s]),s.toLocaleLowerCase().includes("color")?t.style[u]=r.colorToken[l]:"underline"===s?l&&(t.style.textDecoration+=" underline"):"lineThrough"===s?l&&(t.style.textDecoration+=" line-through"):void 0!==l&&(t.style[u]="number"==typeof l?"".concat(l,"px"):l)}}var xe=function(e){var t,n=e.renderObject,r=e.rect,i=e.area,o=e.rectContainer,a=e.painter,s=(0,C.$bs)(n),u=s.elementTree;C.p5R.push({type:6,rectContainerId:null!==(t=null==o?void 0:o.id)&&void 0!==t?t:u.root,getLayer:function(){return function(e){var t,n,r,i=e.renderObject,o=e.area,a=o.paddingLeft,s=void 0===a?0:a,u=o.paddingTop,l=void 0===u?0:u,c=o.width,h=o.scrollTop,d=o.scrollLeft,p=e.rectContainer,v=e.others;if(null!=v&&v.embedDOMLayer)return{node:v.embedDOMLayer,x:s,y:l};var g,_=(0,C.$bs)(i),y=_.DPR,m=_.rPainter,b=_.layerManager,T=_.container;if(!p){var S=b.getLayer("MIDDLE");if(!S){var w=(0,E.EQ)(_),R=w.width,A=w.height;S=b.initLayer(T,"MIDDLE",{width:R,height:A,left:0,top:0})}return{node:S,x:s,y:l}}var O=p.id,M=p.rect,k=(0,C.rI8)(_,O),I=(0,C.LSh)(k),x=(0,E.es)(k),N=(0,f.Z)(x,2),P=N[0],L=N[1],D=(0,E.cJ)(M,c),F=(0,f.Z)(D,2),B=F[0],V=F[1];P=Math.min(null!==(t=null==I?void 0:I.scrollLeft)&&void 0!==t?t:0,null!==(n=P)&&void 0!==n?n:B),L=null!==(r=L)&&void 0!==r?r:V;var H=Math.ceil(P+L+M.width),U=Math.ceil(M.height);g=b.getLayer("TOP",O);var Z=d+M.left-P,W=h+M.top,j={elementId:O,left:Z,top:W,width:H,height:U,DPR:y};return g?m.updateRect(g,j):g=b.initLayer(T,"TOP",j),{node:g,x:Z,y:W}}(e)},cb:function(e){var t,o=e.fragment,u=e.layer,l=u.node,c=u.x,h=u.y,d=null===(t=n.element)||void 0===t?void 0:t.instance;d.setPosition({left:r.left-c,top:r.top+i.scrollTop-h});var f=d.getMountNodeWrapper();if(f){f.style.opacity=String(a.globalAlpha),d.show();var p=d.getMountNode();p&&function(e,t,n){Ie(S.u9,e,t,n)}(p,n,s),l.contains(f)||(f.parentElement&&f.parentElement.id!==R.fJ?o.appendChild(f.cloneNode(!0)):o.appendChild(f))}}})},Ne=function(e){var t=e.renderObject,n=e.rect,r=e.range,i=e.nodePosition,o=e.painter,a=(0,f.Z)(r,2);if(!(a[0]>=a[1])){var s=(0,C.kSo)(t),u=he(t,s),l=u.outerTop,c=u.outerBottom,h=u.outerLeft,d=u.outerRight,p=u.marginLeft,v=u.marginRight,g=h-(1&i?p:0),_=d-(2&i?v:0),y={left:n.left-g,top:n.top-l,width:g+n.width+_,height:l+n.height+c};if(y.width&&y.height){var m=(0,C.mhq)(o,s),E=(0,f.Z)(m,1)[0],b=(0,C.AQ7)([y,{left:E.x,top:E.y,width:E.width,height:E.height}]),T=(0,R.f0)({type:1,fill:C.oV2.color,opacity:o.globalAlpha},b);C.p5R.push(T,"selection")}}},Pe=function(){function e(t){var n=this;(0,h.Z)(this,e),this.domSizeMap=new Map,this.callbackMap=new WeakMap,this.callbackList=[],this.observer=new(M())((function(e){for(var t=0,r=e.length;t<r;t++){var i=e[t],o=i.target;if(o.isConnected){var a=i.contentRect,s=n.domSizeMap.get(o);if(!(Math.abs(s.width-a.width)<.1&&Math.abs(s.height-a.height)<.1)){n.domSizeMap.set(o,{width:a.width,height:a.height});var u=n.callbackMap.get(o);u&&n.callbackList.push(u)}}}n.schedule()})),this.rNodeContext=t,this.rNodeContext=t}return(0,d.Z)(e,[{key:"schedule",value:function(){for(var e=0,t=this.callbackList.length;e<t;e++){(0,this.callbackList[e])()}this.callbackList=[]}},{key:"initDomSize",value:function(e){if(!this.domSizeMap.get(e)){var t=e.getBoundingClientRect();this.domSizeMap.set(e,{width:t.width,height:t.height})}}},{key:"addListener",value:function(e,t){this.initDomSize(e),this.observer.observe(e),this.callbackMap.set(e,t)}},{key:"removeListener",value:function(e){this.domSizeMap.delete(e),this.callbackMap.delete(e),this.observer.unobserve(e)}}]),e}(),Le=new Map;function De(e){var t=Le.get(e.id);return t||(t=new Pe(e),Le.set(e.id,t)),t}var Fe=function(){function e(){(0,h.Z)(this,e),this.cmds={}}return(0,d.Z)(e,[{key:"onPush",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:re,n=e.rectContainerId,r=e.getLayer,i=this.cmds[t];i||(this.cmds[t]=i=new Map);var o=i.get(n);if(!o){var a=r();o={commandList:[],fragment:new DocumentFragment,layer:a},(0,b.SZ)(a.node),i.set(n,o)}var u=o,l=u.commandList,c=(0,s.Z)(u,I);l.push(e),e.cb(c)}},{key:"onFlush",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:re,n=this.cmds[t];null==n||n.forEach((function(e){var t=e.fragment;return e.layer.node.appendChild(t)})),null==n||n.clear()}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re;delete this.cmds[e]}},{key:"clearAll",value:function(){this.cmds={}}}],[{key:"type",get:function(){return 6}}]),e}(),Be=function(e){function t(e){var n;(0,h.Z)(this,t),(n=(0,u.Z)(this,(0,l.Z)(t).call(this,e)))._mountNode=null,n._mounted=!1,n._mountNodeWrapper=null,n._sizeLimit={minWidth:0,maxWidth:0,minHeight:0,maxHeight:0,zoom:1,fontSize:R.n5},n._hidden=!1,n.size={width:0,height:0};var r=(0,C.$bs)(e.element),i=r.rNode,o=r.keyedEmbedDOMPool,s=r.elementPool;(0,C.hu8)(!(null==i||!i.isHost),"EmbedDOM component can only be used in Roadster");var c=s.get(n.element.eid).key;if(c){var d=o.get(c);d?(n._mountNodeWrapper=d.embedDOM.getMountNodeWrapper(),n._mountNode=d.embedDOM.getMountNode(),n._mounted=!!n._mountNodeWrapper,d.count++,d.embedDOM=(0,a.Z)(n)):(n.initMountNodeWrapper(),o.set(c,{count:1,embedDOM:(0,a.Z)(n),mounted:!0}))}return n}return(0,c.Z)(t,e),(0,d.Z)(t,null,[{key:"key",get:function(){return S.j2.EmbedDOM}}]),(0,d.Z)(t,[{key:"initMountNodeWrapper",value:function(){this._mountNodeWrapper||(this._mountNodeWrapper=document.createElement("div"),this._mountNodeWrapper.innerHTML='<span style="font-size: 0; display: inline-block; width: 0;">A</span>',this._mountNodeWrapper.style.position="absolute",this._mountNodeWrapper.style.lineHeight="0",this._mountNodeWrapper.style.pointerEvents="auto",this._mountNodeWrapper.style.left="0px",this._mountNodeWrapper.style.top="0px",this._mountNode=document.createElement("div"),this._mountNode.style.display="inline-block",this._mountNode.style.lineHeight="1",this._mountNodeWrapper.appendChild(this._mountNode))}},{key:"show",value:function(){this._hidden=!1,(0,b.SZ)(this._mountNodeWrapper)}},{key:"hide",value:function(){this._hidden=!0,(0,b.Bp)(this._mountNodeWrapper)}},{key:"applySizeLimit",value:function(){var e=this._sizeLimit,t=e.minWidth,n=e.minHeight,r=e.maxWidth,i=e.maxHeight,o=e.zoom,a=[t,n,r,i,e.fontSize].map((function(e){return isNaN(e)||e===1/0?"":"".concat(e/o,"px")})),s=(0,f.Z)(a,5),u=s[0],l=s[1],c=s[2],h=s[3],d=s[4];this._mountNode.style.minWidth=u,this._mountNode.style.minHeight=l,this._mountNode.style.maxWidth=c,this._mountNode.style.maxHeight=h,this._mountNode.style.fontSize=d,this._mountNode.style.zoom=o.toString(),this._mountNodeWrapper.style.minWidth=u,this._mountNodeWrapper.style.minHeight=l,this._mountNodeWrapper.style.maxWidth=c,this._mountNodeWrapper.style.maxHeight=h;var p=(0,C.g24)(this.element);this._mountNodeWrapper.style.overflow=p.overflowVisible?"visible":"hidden",((0,C.mqG)(p)&&!this._hidden?b.SZ:b.Bp)(this._mountNodeWrapper);var v=this.element.style.zIndex;this._mountNodeWrapper.style.zIndex=(0,R.Rw)(v)?"":v.toString()}},{key:"prerender",value:function(e,t,n,r){var i,o;this._sizeLimit={minWidth:null!==(i=t.minWidth)&&void 0!==i?i:0,minHeight:null!==(o=t.minHeight)&&void 0!==o?o:0,maxWidth:t.maxWidth,maxHeight:t.maxHeight,zoom:n,fontSize:r},this._mounted?this._update():(this.initMountNodeWrapper(),this.connectToEmbedDOMContainer(e),this._mountDOM());var a=this._mountNodeWrapper,s=this.element,u=(0,C.$bs)(s),l=u.elementPool,c=u.viewport,h=(0,C.LSh)(l.get(s.eid));this.connectToEmbedDOMContainer(e);var d=a.getBoundingClientRect(),f=d.width,p=d.height;h&&(h.baseline=a.firstElementChild.offsetTop),this.size={width:f,height:p},"alive"!==ke(this.props.keepDOMAlive)&&h&&!c.getBufferObjects().includes(h)&&this._unmountDOM()}},{key:"connectToEmbedDOMContainer",value:function(e){this._mountNodeWrapper.isConnected||e.appendChild(this._mountNodeWrapper)}},{key:"setPosition",value:function(e){var t=e.left,n=e.top;if(this._mountNodeWrapper){this._mountDOM();var r="translate(".concat(t.toFixed(3),"px, ").concat(n.toFixed(3),"px)");this._mountNodeWrapper.style.transform!==r&&(this._mountNodeWrapper.style.transform=r)}}},{key:"getSize",value:function(){return this.size}},{key:"getMountNode",value:function(){return this._mountNode}},{key:"getMountNodeWrapper",value:function(){return this._mountNodeWrapper}},{key:"forceRender",value:function(){var e=(0,C.$bs)(this.element),t=e.elementPool;this.setState({});var n=t.get(this.element.eid);e.rNode.operator.update(n,{embedDOMForceUpdate:!0,style:[],props:[]})}},{key:"unmount",value:function(){var e=(0,C.$bs)(this.element),t=e.embedDOMUnmountCountSet,n=e.keyedEmbedDOMPool,r=e.elementPool.get(this.element.eid).key;if(r){var i=n.get(r);if(i)return i.count--,t.add(r),void this.removeResizeObserver()}this._unmountDOM(!0)}},{key:"_update",value:function(){this.applySizeLimit()}},{key:"_mountDOM",value:function(){var e=this;if(!this._mounted){this.initMountNodeWrapper(),this.applySizeLimit();var t=(0,C.$bs)(this.element),n=this.element,r=(0,C.LSh)(t.elementPool.get(n.eid));r&&this._mountNode&&function(e,t,n){Ie(S.k0,e,t,n)}(this._mountNode,r,t),(0,C.guc)((function(){e.props.mount(e._mountNode)}),this._element,{tagName:"_mountDOM",throw:!1}),De(t).addListener(this._mountNode,this.forceRender.bind(this)),this._mounted=!0}}},{key:"_unmountDOM",value:function(){var e,t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=ke(this.props.keepDOMAlive);if(n||"alive"!==r){var i=this.getMountNodeWrapper();null==i||null===(e=i.parentElement)||void 0===e||e.removeChild(i),(n||"remove"!==r)&&(this._mounted=!1,this.removeResizeObserver(),this._mountNode&&"function"==typeof this.props.unmount&&(0,C.guc)((function(){var e,n;null===(e=(n=t.props).unmount)||void 0===e||e.call(n,t._mountNode)}),this._element,{tagName:"_unmountDOM",throw:!1}))}}},{key:"render",value:function(){return null}},{key:"removeResizeObserver",value:function(){var e=De((0,C.$bs)(this.element));this._mountNode&&e.removeListener(this._mountNode)}}],[{key:"composeRenderSideEffects",value:function(){(0,C.UaJ)(S.j2.EmbedDOM,{reconcile:{renderFunction:void 0},layout:Me,paint:{willPaint:xe,paintSelection:Ne,commandPlugins:[Fe]}})}}]),t}(C.wA2);function Ve(e,t,n){var r=(0,C.jFX)(e);if(!r)return e;var i="number"==typeof n?Math.max(r,n):r;return i="number"==typeof t?Math.min(i,t):i}var He={buildContext:V,wrapup:function(e,t){var n,r,i,o=t.maxWidth,a=t.minWidth,s=t.maxHeight,u=t.minHeight,l=null===(n=e.element)||void 0===n?void 0:n.instance;(0,C.hu8)(!!l,"Roadster EmbedRNode instance is not exist");var c=(0,C.gOt)(e,["zoom","maxWidth","maxHeight","minWidth","minHeight"]).zoom,h=void 0===c?1:c,d={maxWidth:o/h,maxHeight:s/h,minWidth:null!==(r=a)&&void 0!==r?r:0,minHeight:null!==(i=u)&&void 0!==i?i:0},f=l.rNode.layout(d),p=f.width,v=f.height;(0,C.ryg)(e,{width:Ve(p,o,a)*h,height:Ve(v,s,u)*h})},computeStyle:function(e,t){var n=(0,C.j2w)(t),r=n.maxWidth,i=n.maxHeight,o=n.inheritedStyle,a=(0,C.R3e)(e);(0,E.tw)("zoom",e,a,void 0,o),D(e,a,r,o),(0,E.tw)(["minWidth","maxWidth"],e,a,r,o),F(e,a,i,o),(0,E.tw)(["minHeight","maxHeight"],e,a,i,o),(0,E.tw)(["cursor","display"],e,a),B(e,a)}},Ue=function(e){var t,n=e.painter,r=e.renderObject,i=e.rect,o=(0,C.$bs)(r),a=null===(t=r.element)||void 0===t?void 0:t.instance,s=(0,C.gOt)(r,["zoom"]).zoom,u=void 0===s?1:s,l=n.getTransform(),c=l.e,h=l.f,d=o.DPR;n.setTransform(u*d,0,0,u*d,c,h);var f={x:i.left/u,y:i.top/u,width:i.width/u,height:i.height/u};a.paint(n,f)};function Ze(e,t){e&&((0,C.pd9)(e)||(0,C.ijY)(e,S.j2.TableRow)||(0,C.sdd)(e))&&(t.length=0,t.push([e]))}function We(e,t,n){var r=(0,C.Yae)(e);if(r){var i=(0,C.Kas)(r);i&&!(0,C.ZMy)(i)&&t.positionedLayoutEntries.push(r)}else t.layoutEntries=n?[[n,!0]]:[]}function je(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,i={layoutEntries:[],positionedLayoutEntries:[]};if(t){for(var o=t,a=(0,C.SvU)(o);a;){var s,u,l,c=void 0;if(null!==(s=o.renderObjects)&&void 0!==s&&s.length&&(c=o.renderObjects.find((function(e){var t=e.runtime;return!t||!(0,C.Ud)(t)}))),c=null!==(u=c)&&void 0!==u?u:(0,C.LSh)(o),(0,C.WFc)(o))return i.positionedLayoutEntries.push(o),i.layoutEntries=[],i;(0,C.zBZ)(c);var h=c.parent,d=h.runtime;if(!(0,C.ZMy)(d)){var f,p,v=(0,C.qMZ)(a),g=null===(f=(p=v.mutate).markDirty)||void 0===f?void 0:f.call(p,e,a,o,n,r,t);if(1===g)break;if(0===g)continue;if(2===g)return}if(Ze(h,i.layoutEntries),null!==(l=d.context)&&void 0!==l&&l.isRelayoutBoundary)return(0,C.WFc)(a)&&h.parent&&(0,C.UQj)(h.parent),We(a,i,h),i;o=a,a=(0,C.SvU)(a)}return i}}function Ge(e,t){var n;if((0,C.kiv)(e)){var r=(0,C.CXA)(e);if(!r.length)return null;for(var i=0,o=r[t?i:r.length-1-i];i<r.length;){var a;if(null!==(a=o.renderObjects)&&void 0!==a&&a.length)return o;i++,o=r[t?i:r.length-1-i]}return(o=t?(0,C.d9l)(e):(0,C.FT5)(e))?Ge(o,t):null}if(null!==(n=e.renderObjects)&&void 0!==n&&n.length)return e;for(var s=t?(0,C.d9l)(e):(0,C.FT5)(e);s;){var u;if(!(0,C.kiv)(s)&&null!==(u=s.renderObjects)&&void 0!==u&&u.length)return s;if((0,C.kiv)(s)){var l=(0,C.CXA)(s),c=0;for(s=l[t?c:l.length-1-c];c<l.length-1;){var h;if(null!==(h=s.renderObjects)&&void 0!==h&&h.length)return s;c++,s=l[t?c:l.length-1-c]}}s=Ge(s,t)}return s}function ze(e){return Ge(e,!1)}function Ye(e){return(0,R.kJ)(e)?function(e){var t=e[0].el.parent;if(t){var n,r={els:[],parent:t,indices:[]},i={},o=new Map,a=x(e);try{for(a.s();!(n=a.n()).done;){var s=n.value.el,u=s.parent;if(!o.has(u)){var l=(0,C.LSh)(u);if(!l)continue;l.children||(l.children=[]),o.set(u,l)}var c=(0,C.cq5)(s),h=i[c];h||(i[c]=h=[]),h.push(s)}}catch(e){a.e(e)}finally{a.f()}for(var d=0,f=Object.keys(i);d<f.length;d++){var p=f[d],v=+p;r.indices.push(v);var g,_=x(i[p]);try{for(_.s();!(g=_.n()).done;){var y=g.value,m=o.get(y.parent);r.els.push({element:y,parentRo:m,index:v})}}catch(e){_.e(e)}finally{_.f()}}return r}}(e):function(e){var t=e.el,n=e.type,r=(0,C.SvU)(t),i=r===t.parent;if(r){for(var o={els:[],parent:r},a=(0,C.LSh)(r),s=(0,C.CXA)(t),u=0;u<s.length;u++){var l,c=s[u];if((0,C.GIx)(c)||null!==(l=c.renderObjects)&&void 0!==l&&l.length)break;var h=0;switch(n){case"preappend":if(!e.parent)return;if(t.parent&&!i){var d=(0,C.CXA)(t.parent);h=(0,C.m0w)(r).indexOf(d[0])}else h=0;break;case"append":if(!e.parent)return;if(t.parent&&!i){var f=(0,C.CXA)(t.parent);h=(0,C.m0w)(r).indexOf(f[f.length-1])}else{var p,v,g;h=null!==(p=null===(v=a)||void 0===v||null===(g=v.children)||void 0===g?void 0:g.length)&&void 0!==p?p:0}break;case"insertBefore":var _,y,m,E,b,T,S=u===s.length-1?Ge(e.target,!0):s[u+1],w=(0,C.LSh)(S);a=null!==(_=null==w?void 0:w.parent)&&void 0!==_?_:a,h=null!==(y=w?null===(m=a)||void 0===m||null===(E=m.children)||void 0===E?void 0:E.indexOf(w):null===(b=a)||void 0===b||null===(T=b.children)||void 0===T?void 0:T.length)&&void 0!==y?y:0;break;case"insertAfter":var R,A,O,M,k=0===u?ze(e.target):s[u-1],I=(0,C.aXI)(k);a=null!==(R=null==I?void 0:I.parent)&&void 0!==R?R:a,h=I?(null!==(A=null===(O=a)||void 0===O||null===(M=O.children)||void 0===M?void 0:M.indexOf(I))&&void 0!==A?A:0)+1:0}if(!a)return;a.children||(a.children=[]),o.els.push({element:c,parentRo:a,index:h})}return o}}(e)}function Xe(e){var t=(0,C.aXI)(e);if(!t)return null;var n=(0,C.d9l)(t);return n?n.element:null}var Ke=function(e){switch((0,R.kJ)(e)?e[0].type:e.type){case"preappend":case"append":case"insertBefore":case"insertAfter":return function(e){var t={layoutEntries:[],positionedLayoutEntries:[]},n=Ye(e);if(n){if((0,R.kJ)(e)){for(var r,i,o,a,s,u,l=0;l<n.els.length;l++)(0,C.RXD)(n.els[l].element,n.els[l].parentRo,n.els[l].index);if(!n.els.length)return;var c=(0,C.LSh)(n.parent),h=null===(r=(i=(0,C.qMZ)(n.parent).mutate).add)||void 0===r?void 0:r.call(i,c,e[0].el,n.indices);t.layoutEntries.push([null!==(o=null==h?void 0:h.boundaryRo)&&void 0!==o?o:c]);var d=je(e[0],null!==(a=null==h?void 0:h.element)&&void 0!==a?a:n.els[0].element);return Array.prototype.push.apply(t.layoutEntries,null!==(s=null==d?void 0:d.layoutEntries)&&void 0!==s?s:[]),Array.prototype.push.apply(t.positionedLayoutEntries,null!==(u=null==d?void 0:d.positionedLayoutEntries)&&void 0!==u?u:[]),t}for(var f=(0,C.LSh)(n.parent),p=0;p<n.els.length;p++){var v,g,_,y,m,E;(0,C.RXD)(n.els[p].element,n.els[p].parentRo,n.els[p].index);var b=null===(v=(g=(0,C.qMZ)(n.parent).mutate).add)||void 0===v?void 0:v.call(g,f,e.el,n.indices);t.layoutEntries.push([null!==(_=null==b?void 0:b.boundaryRo)&&void 0!==_?_:f]);var T=je(e,null!==(y=null==b?void 0:b.element)&&void 0!==y?y:n.els[p].element);Array.prototype.push.apply(t.layoutEntries,null!==(m=null==T?void 0:T.layoutEntries)&&void 0!==m?m:[]),Array.prototype.push.apply(t.positionedLayoutEntries,null!==(E=null==T?void 0:T.positionedLayoutEntries)&&void 0!==E?E:[])}return t}}(e);case"moveBefore":case"moveAfter":case"moveToHead":case"moveToTail":return function(e){var t=e.el,n=e.type,r=(0,C.SvU)(t);if(r){for(var i=[],a={layoutEntries:[],positionedLayoutEntries:[]},s=(0,C.CXA)(t),u=function(t){var o,u,l,c,h,d=["moveBefore","moveToHead"].includes(n)?s.length-t-1:t,f=s[d];if(null===(o=f.renderObjects)||void 0===o||!o.length)return"break";var p=void 0,v=void 0,g=function(e,t){var n,r;v=(0,C.Br9)(f),Se(v),p=t=null!==(n=t)&&void 0!==n?n:v.parent;var i=t.children,o=void 0===i?[]:i,a=o.indexOf(v);null==o||o.splice(a,1);var s="function"==typeof e?e(t):null!==(r=e)&&void 0!==r?r:o.length;(0,C.LVC)(t,v,s);for(var u=Math.min(a,s),l=Math.max(a,s)+1;u<l;u++){var c,h,d,g=o[u];if(void 0!==(null===(c=g.runtime)||void 0===c||null===(h=c.constraint)||void 0===h?void 0:h.fragments)){for(;null!==(_=g)&&void 0!==_&&null!==(y=_.children)&&void 0!==y&&y.length;){var _,y;g=g.children[0]}var m=g.runtime,E=null==m||null===(d=m.constraint)||void 0===d?void 0:d.fragments;E&&E.update(g)}}},_=void 0;switch(n){case"moveBefore":var y=d===s.length-1?e.target:s[d+1],m=(0,C.GDB)(y)[0];g((function(e){return e.children.indexOf(m)}),m.parent);break;case"moveAfter":var E;_=null!==(E=Xe(f))&&void 0!==E?E:r.children[0];var b=0===d?e.target:s[d-1],T=(0,C.GDB)(b),S=T[T.length-1];g((function(e){return e.children.indexOf(S)+1}),S.parent),(0,C.Br9)(_);break;case"moveToHead":g(0);break;case"moveToTail":var w;_=null!==(w=Xe(f))&&void 0!==w?w:r.children[0],g(),(0,C.Br9)(_);break;default:return{v:void 0}}null===(u=(l=(0,C.qMZ)(r).mutate).move)||void 0===u||u.call(l,p),i.push([p]);var R=je(e,f,!1,_);Array.prototype.push.apply(a.layoutEntries,null!==(c=null==R?void 0:R.layoutEntries)&&void 0!==c?c:[]),Array.prototype.push.apply(a.positionedLayoutEntries,null!==(h=null==R?void 0:R.positionedLayoutEntries)&&void 0!==h?h:[])},l=0;l<s.length;l++){var c=u(l);if("break"===c)break;if("object"===(0,o.Z)(c))return c.v}return Array.prototype.push.apply(a.layoutEntries,i),a}}(e);case"update":return function(e){for(var t=e.el,n=e.changes,r=(0,C.CXA)(t),i=[],o={layoutEntries:[],positionedLayoutEntries:[]},a=0;a<r.length;a++){var s,u,l,c=r[a];if(null===(s=c.renderObjects)||void 0===s||!s.length)return;var h=!1,d=void 0,f=!1;if(n){var p,v,g,_=!1,y=(0,C.OwD)(c,n),m=(0,R.f0)({flag:y},e),E=null===(p=(v=(0,C.qMZ)(c).mutate).update)||void 0===p?void 0:p.call(v,m,n);_=_||!(null==E||!E.collectToTempEntry),d=null!==(g=d)&&void 0!==g?g:null==E?void 0:E.boundaryRo,f=f||!(null==E||!E.resetLayoutContext);var b=(0,C.LSh)(c);(null==b?void 0:b.element)&&(0,C.R_0)(b,"props",(0,R.f0)(Object.assign({},b.props,{sourceStyle:(0,C.g24)(b.element)}))),_&&b&&(h=!0,i.push([b]))}else{var T=(0,C.y3M)(c);T&&(h=!0,i.push([T]))}if(!h){var S;(0,C.WFc)(c)&&null!==(S=d)&&void 0!==S&&S.parent&&(0,C.UQj)(d.parent),We(c,o,d);break}var w=je(e,c,f);Array.prototype.push.apply(o.layoutEntries,null!==(u=null==w?void 0:w.layoutEntries)&&void 0!==u?u:[]),Array.prototype.push.apply(o.positionedLayoutEntries,null!==(l=null==w?void 0:w.positionedLayoutEntries)&&void 0!==l?l:[])}return Array.prototype.push.apply(o.layoutEntries,i),o}(e);case"remove":return function(e){var t=(0,R.kJ)(e),n=(t?e:[e]).map((function(e){return e.el})),r=n[0],i=(0,C.SvU)(r);if(i){var o=[];n.forEach((function(e){(0,C.CXA)(e).forEach((function(e){var t;null===(t=e.renderObjects)||void 0===t||t.forEach((function(e){return o.push(e)}))}))})),o.length||n.forEach((function(e){(0,C.Ate)(e).forEach((function(e){o.push(e)}))}));for(var a=[],s=0,u=o;s<u.length;s++){var l=u[s],c=l.parent;c&&!l.isDestructed&&a.push({parent:c,target:l,index:(0,C.cq5)(l)})}for(var h=[],d=function(){var n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];a.forEach((function(i){var o=i.parent,a=i.index,s=i.target;if(!(0,C.WAP)(s)){var u=o.children;if(!a||r)return(null==u?void 0:u[a])&&(0,C.oFe)(u[a]),(0,C.oFe)(o,n),void h.push([o]);if(u){var l=u.length-1-(t?e.length:1),c=u[Math.min(a,l)];(0,C.oFe)(c,n),h.push([c])}}}))},f=(0,C.CXA)(r),p={layoutEntries:[],positionedLayoutEntries:[]},v=0;v<f.length;v++){var g,_,y,m,E,b,T=f[v];if(null===(g=T.renderObjects)||void 0===g||!g.length)break;var S=null===(_=(y=(0,C.qMZ)(i).mutate).remove)||void 0===_?void 0:_.call(y,i,T,a);(null==S||!S.noRemoveAndSetDirty)&&d(null==S?void 0:S.resetLayoutContext,null==S?void 0:S.collectToTempEntry),(null==S?void 0:S.boundaryRo)&&h.push([S.boundaryRo]);var w=je((0,R.kJ)(e)?e[0]:e,null!==(m=null==S?void 0:S.element)&&void 0!==m?m:T);Array.prototype.push.apply(p.layoutEntries,null!==(E=null==w?void 0:w.layoutEntries)&&void 0!==E?E:[]),Array.prototype.push.apply(p.positionedLayoutEntries,null!==(b=null==w?void 0:w.positionedLayoutEntries)&&void 0!==b?b:[])}return Array.prototype.push.apply(p.layoutEntries,h),a.forEach((function(e){var t=e.target;(0,C.rXK)(t)})),(0,R.kJ)(e)?e.forEach((function(e){(0,C.CXA)(e.el).forEach((function(e){(0,C.Wmi)(e)}))})):f.forEach((function(e){(0,C.Wmi)(e)})),p}}(e)}};function qe(e){var t={layoutEntries:[],positionedLayoutEntries:[]};(0,C.v76)();for(var n=function(e){e=function(e){for(var t=new Set,n=e.length,r=0;r<n;r++){var i=e[r],o=i.el;switch(i.type){case"preappend":case"append":case"insertBefore":case"insertAfter":case"remove":t.add(o)}}if(!t.size)return e;var a,s=[],u=x(e);try{for(u.s();!(a=u.n()).done;){var l=a.value,c=l.el,h=l.type,d=void 0;switch(h){case"preappend":case"append":d=l.parent;break;case"insertBefore":case"insertAfter":d=l.target.parent;break;case"remove":d=c.parent}d&&t.has(d)||s.push(l)}}catch(e){u.e(e)}finally{u.f()}return s}(e);for(var t=-1,n=[],r=new Map,i=0,o=e.length;i<o;i++){var a=e[i],s=a.el,u=a.type,l=(0,C.FS1)(s);switch(l){case S.j2.Table:n.push(a),"update"===u&&t<0&&(t=i);break;case S.j2.TableRow:case S.j2.TableCell:var c;t<0&&(t=i);var h=(0,C.kKo)(s,S.j2.TableRow)?s.parent:null===(c=s.parent)||void 0===c?void 0:c.parent;if(h){var d=void 0;switch(u){case"preappend":case"append":case"insertBefore":case"insertAfter":d="add";break;case"remove":d="remove"}if(d){var f,p=r.get(h);!p&&r.set(h,p={}),p[d]=null!==(f=p[d])&&void 0!==f?f:{TableRow:[],TableCell:[]},p[d][l].push(a);break}}n.push(a);break;default:n.push(a)}}return r.forEach((function(e){var r=function(r){var i=e[r];i&&Object.keys(i).forEach((function(e){if(i[e].length){var r=i[e];n.splice(t,0,r),t++}}))};e.remove&&(r("remove"),delete e.remove),Object.keys(e).forEach(r)})),n}(e),r=n.length,i=0;i<r;i++){var o,a,s=n[i];if((0,R.kJ)(s)||(0,C.nTq)(s.el)){var u=Ke(s);Array.prototype.push.apply(t.layoutEntries,null!==(o=null==u?void 0:u.layoutEntries)&&void 0!==o?o:[]),Array.prototype.push.apply(t.positionedLayoutEntries,null!==(a=null==u?void 0:u.positionedLayoutEntries)&&void 0!==a?a:[])}}return(0,C.rgL)(),t}function $e(e,t){var n=qe(e);n.layoutEntries.forEach((function(e){return t.layoutEntryCollector.collectEntriesInOperation(e[0],e[1])})),n.positionedLayoutEntries.forEach((function(e){return t.rNode.eventEmitter.trigger("addpositionedlayoutentry",[e])}))}function Je(e){var t,n=e.reconcile,r=e.layoutEntryCollector,i=e.elementTree,o=e.pipeline.positionedCollector;return!(n.isReconciling||null!=o&&o.size)&&(!(0,C.PpG)(i)&&(null===(t=r.peek())||void 0===t||!t.length))}function Qe(e){var t=e.element;if(!(0,C.tG8)(t))return e;var n=(0,C.TJ2)(t.root,t.unit);return(0,C.LSh)(n)}var et=function(e){return(0,C.HSn)(e)&&0!==e.height};function tt(e,t,n){var r,i,o;if(t<0)return e;for(var a,s,u=null!==(r=null==n?void 0:n.preferVerticalFlowChildren)&&void 0!==r?r:"start",l=null!==(i=null==n?void 0:n.preferOverlayChildren)&&void 0!==i?i:u,c=null!=n&&n.startFrom?(0,C.r1x)(n.startFrom):null,h=null!=n&&n.endTo?(0,C.r1x)(n.endTo):null,d=null!==(o=null==n?void 0:n.isValidChild)&&void 0!==o?o:et,f=(0,C.$bs)(e),p="end"===u,v="end"===l,g=function(e){var t,n=null!==(t=e.children)&&void 0!==t?t:[];return null!=c&&c.has(e)?n=n.slice(c.get(e)):null!=h&&h.has(e)&&(n=n.slice(0,h.get(e)+1)),n},_=function(e,t,n,r){for(var i,o={hitted:null,up:null,next:null},a=f.layoutBuffer,s=[o],u=0;u<e.length;u+=1){var l,c=e[u];if(d(c)){var h=(0,C.WAP)(c)?null!==(l=c.y)&&void 0!==l?l:0:c.top+n,p=h+c.height;if(void 0!==i){h-i<-.01&&(o={hitted:null,up:null,next:null},s.push(o))}if(!(h-t>a.top)){var v;if(h<=t&&t<=p)o.next={ro:c,pendingOffsetY:h-(null!==(v=null==c?void 0:c.scrollTop)&&void 0!==v?v:0)};else h>t?o.hitted||(o.hitted=c):p<t&&(!o.up||o.up.y<p)&&(o.up={y:p,ro:c});if(r&&(o.next||o.hitted))return o;i=p}}}return r?s[0]:(0,R.Z$)(s)},y=0,m=e;m;){var E=(a=m,s=void 0,!((s=(0,C.xC0)(a))&&p||!s&&v)),b=g(m);if(!b.length)return m;var T=_(b,t,y,E),S=T.next,w=T.hitted,A=T.up;if(!S)return w||(A?A.ro:m);m=S.ro,y=S.pendingOffsetY}return e}function nt(e,t,n,r){var i=tt(e,t,{startFrom:n,endTo:r,preferVerticalFlowChildren:"end",preferOverlayChildren:"start",isValidChild:function(e){return!(!(0,C.bXR)(e)||!(0,C.qGP)(e))&&et(e)}});return i=Qe(i)}function rt(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"start",i=tt(e,t,{startFrom:n,preferVerticalFlowChildren:"start",preferOverlayChildren:r,isValidChild:function(e){return!(e.runtime&&(0,C.eTE)(e.runtime)||(0,C.TO7)(e.element))&&et(e)}});return i=Qe(i)}function it(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"start",o=tt(e,t,{startFrom:n,endTo:r,preferVerticalFlowChildren:i,preferOverlayChildren:i,isValidChild:function(e){return!(e.runtime&&(0,C.eTE)(e.runtime)||(0,C.TO7)(e.element))&&((0,C.mqG)((0,C.gOt)(e,["display"]))&&0!==e.height)}});return o=Qe(o),"end"!==i&&(o=(0,C.oJW)(o)),o}var ot=function(){function e(){(0,h.Z)(this,e),this.renderTree=void 0,this.previousFactors={area:{scrollTop:0,scrollLeft:0,paddingLeft:0,paddingTop:0,left:0,top:0,width:0,height:0},buffer:{top:0,bottom:0}},this.currentFactors={area:{scrollTop:0,scrollLeft:0,paddingLeft:0,paddingTop:0,left:0,top:0,width:0,height:0},buffer:{top:0,bottom:0}},this.flushing=!1,this.bufferStartObjects=void 0,this.currentBufferStartObject=void 0,this.currentBufferEndObject=void 0,this.viewportStartObject=void 0,this.viewportEndObject=void 0,this.bufferObjects=[],this.bufferObjectsDirty=!1,this.viewportObjects=[],this.viewportObjectsDirty=!1,this.bufferStartObjects=[],this.currentBufferStartObject={},this.currentBufferEndObject={},this.viewportStartObject={},this.viewportEndObject={}}return(0,d.Z)(e,[{key:"updateBoundaryObject",value:function(e,t){t?(e.renderObject=t,e.element=t.element):(e.renderObject=void 0,e.element=void 0)}},{key:"getViewportPreviousArea",value:function(){return this.previousFactors.area}},{key:"getViewportArea",value:function(){return this.currentFactors.area}},{key:"initWithRenderTree",value:function(e){this.renderTree||(this.renderTree=e)}},{key:"getViewportObjects",value:function(){if(this.updateBoundaryObjects(),this.viewportObjectsDirty){var e=this.viewportStartObject.renderObject,t=this.viewportEndObject.renderObject;this.viewportObjects=e&&t?(0,C.jhR)((0,C.m6N)(e),(0,C.ojQ)(t)):[],this.viewportObjectsDirty=!1}return this.viewportObjects}},{key:"getBufferObjects",value:function(){if(this.updateBoundaryObjects(),this.bufferObjectsDirty){var e=this.bufferStartObject.renderObject,t=this.bufferEndObject.renderObject;this.bufferObjects=e&&t?(0,C.jhR)((0,C.m6N)(e),(0,C.ojQ)(t)):[],this.bufferObjectsDirty=!1}return this.bufferObjects}},{key:"updateCalculateFactors",value:function(e){this.previousFactors=this.currentFactors,this.currentFactors=e,this.flushing=!0}},{key:"updateCurrentBufferStartObject",value:function(e){this.updateBoundaryObject(this.currentBufferStartObject,e),this.flushing=!0,this.enqueueBufferStartObject(e)}},{key:"enqueueBufferStartObject",value:function(e){if(2!==this.bufferStartObjects.length){for(var t={renderObject:e,element:e.element},n=!1,r=this.bufferStartObjects.length,i=0;i<this.bufferStartObjects.length;i+=1){var o=this.bufferStartObjects[i];if(o.renderObject===e)return;var a=(0,E.oS)(o.renderObject),s=(0,E.oS)(e);a.top>s.top&&!n&&(r=i,n=!0)}this.bufferStartObjects.splice(r,0,t),this.bufferStartObjects.length>5&&this.bufferStartObjects.pop()}}},{key:"removeInvalidBufferStartObjects",value:function(){for(var e=0;e<this.bufferStartObjects.length;){var t;null!==(t=this.bufferStartObjects[e].renderObject)&&void 0!==t&&t.isDestructed?this.bufferStartObjects.splice(e,1):e+=1}return this.bufferStartObjects.length}},{key:"isCurrentBufferStartObjectAlive",value:function(){var e;return!!this.bufferStartObjects.length&&!(null!==(e=this.bufferStartObjects[0].renderObject)&&void 0!==e&&e.isDestructed)}},{key:"getFirstBufferStartObject",value:function(){return this.bufferStartObjects.length?this.bufferStartObjects[0]:null}},{key:"updateBoundaryObjects",value:function(){if(this.isScrollTopChanged||this.flushing){var e=this.currentFactors,t=e.area,n=e.buffer,r=rt(this.renderTree,t.scrollTop,this.bufferStartObject.renderObject,"start");this.updateBoundaryObject(this.viewportStartObject,r);var i=rt(this.renderTree,t.scrollTop+t.height,this.viewportStartObject.renderObject,"end");this.updateBoundaryObject(this.viewportEndObject,i);var o=rt(this.renderTree,t.scrollTop+t.height+n.bottom,this.viewportEndObject.renderObject,"end");this.updateBoundaryObject(this.currentBufferEndObject,o),this.bufferObjectsDirty=!0,this.viewportObjectsDirty=!0,this.flushing=!1,this.previousFactors=this.currentFactors}}},{key:"getBoundaryObjects",value:function(){return this.updateBoundaryObjects(),{bufferStartObject:this.bufferStartObject,bufferEndObject:this.bufferEndObject,viewportStartObject:this.viewportStartObject,viewportEndObject:this.viewportEndObject}}},{key:"isScrollTopChanged",get:function(){var e,t;return(null===(e=this.currentFactors.area)||void 0===e?void 0:e.scrollTop)!==(null===(t=this.previousFactors.area)||void 0===t?void 0:t.scrollTop)}},{key:"bufferStartObject",get:function(){return this.currentBufferStartObject}},{key:"bufferEndObject",get:function(){return this.currentBufferEndObject}}]),e}(),at=function(e){var t;return function(){return t||(t=function(e){var t=(0,R.f0)(e.getBoundaryObjects(),{bufferStartObject:e.bufferStartObject});return{bufferStartObject:{element:(0,C.F8u)(t.bufferStartObject.element)},bufferEndObject:{element:(0,C.F8u)(t.bufferEndObject.element)},viewportStartObject:{element:(0,C.F8u)(t.viewportStartObject.element)},viewportEndObject:{element:(0,C.F8u)(t.viewportEndObject.element)}}}(e)),t}};function st(e,t){var n,r=0,i=function i(){if(void 0===n){var o=Math.min(t-Math.min(performance.now()-r,t),t);n=window.setTimeout((function(){n=void 0,performance.now()-r>=t?e():i()}),o)}},o=function(){r=performance.now(),i()};return o.cancel=function(){void 0!==n&&(window.clearTimeout(n),n=void 0)},o}var ut=function(){function e(t){var n,r,i,o,a;(0,h.Z)(this,e),this.$context=void 0,this.paintSettings={},this.states=void 0,this.viewPortStates=void 0,this.area=void 0,this.paintRAF=(n=this.handlePaint.bind(this),r=function(e,t){var n=(0,f.Z)(e,1)[0],r=(0,f.Z)(t,1)[0],i=n.useCache&&r.useCache;return[(0,R.f0)({},r,{useCache:i})]},a=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];var s=i=r&&i?r(i,t):t;void 0===o&&(o=window.requestAnimationFrame((function(){var e;o=void 0,n.apply(void 0,(0,p.Z)(null!==(e=i)&&void 0!==e?e:s)),i=void 0})))},a.cancel=function(){void 0!==o&&(window.cancelAnimationFrame(o),o=void 0,i=void 0)},a);var s=t.$context,u=s.rNode,l=u.paintArea,c=u.eventEmitter,d=s.painter;this.$context=s;var v=(0,y.NC)(d,0,s);this.states=[v],this.viewPortStates=[v],this.area=l,c.on("iwillpaintro",(function(e){var t=e.renderObject.runtime;t&&(t.status=(0,C.Epq)(t.status,[131072],!0),(0,y.dK)(e))})),c.on("ididpaintro",(function(e){var t=e.renderObject.runtime;t&&(t.status=(0,C.Epq)(t.status,[131072,2],!1))}))}return(0,d.Z)(e,[{key:"paint",value:function(e){var t=this.$context,n=t.rNode,r=t.destroyed,i=t.layerManager,o=this.states;!r&&n.getRenderTree()&&(this.isSingleState&&(e.useCache=!1),e.useCache||function(){for(var e=Math.floor(o.length/2),t=1;t<=e;t++)[t,-t].forEach((function(t){var n=o[e+t];n.markDirty(),i.setLayerVisible(n.getPainter().canvas,!1)}))}(),this.paintRAF(e))}},{key:"handlePaint",value:function(e){var t=this.$context,n=this.viewPortStates;t.destroyed||(this.willPaint(e),this.performPaint(n),this.didPaint())}},{key:"performPaint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.$context,r=n.rNode,i=r.eventEmitter,o=r.getRenderTree();if(o){var a=[{viewPortStates:this.viewPortStates,area:this.area,isIdle:t}];i.trigger("ibeforepaint",a);for(var s=0;s<e.length;s++){var u=e[s];if(u.isDirty){(0,y.tq)(u,n,o,this.paintSettings,this.isSingleState);var l=u.getCollectingDirtyLine();(0,C.SFv)(u.getPainter()),u.completePaint(),u.commit(l,o.height)}}(0,y.Vd)(this.viewPortStates,o),i.trigger("iafterpaint",a)}}},{key:"willPaint",value:function(e){var t=e.area,n=e.useCache;this.area=t,n||(0,y.Dv)(t,this.states);var r=this.$context,i=r.layerManager;r.rNode.eventEmitter.trigger("willpaint",[]),i.updateLayerByType(t,"MIDDLE"),this.isSingleState&&(0,y.Yw)(t,this.states,0)}},{key:"didPaint",value:function(){this.$context.rNode.eventEmitter.trigger("paint",[])}},{key:"setColorToken",value:function(e){this.states.forEach((function(t){return t.setColorToken(e)}))}},{key:"setPaintSettings",value:function(e){(0,R.f0)(this.paintSettings,e)}},{key:"isSingleState",get:function(){return 1===this.states.length}}]),e}(),lt={x:0,y:0,left:0,top:0,scrollTop:0,scrollLeft:0,width:0,height:0},ct=function(e){return e?(0,R.f0)({},lt,e):(0,R.f0)({},lt)};function ht(e){return(0,R.f0)({isEdge:!1},e,{node:(0,C.F8u)(e.node)})}function dt(e){return(0,C.kKo)(null==e?void 0:e.node)}function ft(e){return(0,C.$wM)(null==e?void 0:e.node)}function pt(e,t){return e===t||!(!e||!t)&&(e.offset===t.offset&&e.atEnd===t.atEnd&&e.isEdge===t.isEdge&&(dt(e)&&dt(t)?e.node===t.node:!(!ft(e)||!ft(t))&&e.node.eid===t.node.eid))}function vt(e){if(ft(e)){var t=(0,C.WGj)(e.node);return t?(0,R.f0)({},e,{node:t}):null}return e}function gt(e,t){var n=t.startPoint,r=t.endPoint;if(t.isBackward){var i=[r,n];n=i[0],r=i[1]}var o=n,a=o.node,s=o.offset,u=r,l=u.node,c=u.offset,h=e.node,d=e.offset,f=(0,C.DWu)(a).reverse(),p=(0,C.DWu)(l).reverse(),v=(0,C.DWu)(h).reverse(),g=(0,C.a6z)(f,p)+1,_=f.splice(0,g);p.splice(0,g);for(var y=0;y<_.length;y++)if(_[y]!==v[y])return!1;if(v.splice(0,g),!f.length||!p.length){var m=v.length?v[0].parent.children.indexOf(v[0]):d;return s<=m&&m<=c}var E=f[0].parent,b=E.children.indexOf(f[0]),T=E.children.indexOf(p[0]),S=E.children.indexOf(v[0]);return b<=S&&S<=T}var _t=1,yt=[.5,.75,.85,1,1.15,1.25,1.5,1.75,2,2.5,3];function mt(){if(C.vS7){var e=window.top;try{e.innerWidth}catch(t){e=window}_t=Math.min(bt(yt,e.outerWidth/e.innerWidth),bt(yt,(e.outerHeight-52)/e.innerHeight))||1}else _t=1}function Et(e,t){return Math.abs(e-t)<.01}function bt(e,t){var n=function(e,t){var n=0,r=e.length,i=!1;for(;n<r;){var o=n+(r-n>>>1);t>e[o]?n=o+1:(r=o,i=Et(t,e[o]))}return i?n:-n-1}(e,t);return n<0&&(n=-n-1)>0&&t-e[n-1]<e[n]-t&&--n,e[n]||e[e.length-1]}function Tt(){var e,t;return null!==(e=null===(t=function(){try{var e,t;return null===(e=window.top)||void 0===e||e.document.body,null!==(t=window.top)&&void 0!==t?t:window}catch(e){return window}}().visualViewport)||void 0===t?void 0:t.scale)&&void 0!==e?e:1}function Ct(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&mt();var t=window.devicePixelRatio*_t*Tt();return t}mt();var St={},wt=function(e,t){St[e]=t},Rt=function(e){delete St[e]},At=function(){function e(){var t=this,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,h.Z)(this,e),this.id=void 0,this.operator=new g.EF,this._renderTree=void 0,this.$contextInternal=void 0,this.eventEmitter=void 0,this.getPosition=function(){},this.getTransform=function(){},this._isMount=!1,this._isCompleted=!1,this._patchingPayload=null,this._patchCallback=void 0,this._selection=void 0,this._painter=void 0,this._events=[],this.paintController=void 0,this.prevLayoutArea=void 0,this.paintArea={x:0,y:0,width:0,height:0,scrollLeft:0,scrollTop:0},this.isHost=void 0,this.setContext=function(e){t.$contextInternal=e,t.paintController=new ut({$context:t.$contextInternal})},this.patch=function(e){t._patchingPayload=e,"function"==typeof t._patchCallback&&t._patchCallback(),t.clearUselessEmbedDOM()},this.build=function(){t.eventEmitter.trigger("willbuild",[]);var e=t.$contextInternal,n=e.reconcile,r=e.viewport,i=e.layoutEntryCollector,o=[];if(t._patchingPayload||t._renderTree){if(t._patchingPayload){var a=t.$contextInternal.elementTree;i.isCollecting=!0;var s=t._patchingPayload.elements;t._patchingPayload=null,t._isCompleted=!1,(0,C.guc)((function(){return(0,g.r$)(s,t.$contextInternal)}),a),s&&i.collectEntriesWithPayloadElements(s.filter(C.Ri8)),o=n.operator.getOperationSet(),n.operator.clear(),o&&o.length>0&&(0,C.guc)((function(){return $e(o,t.$contextInternal)}),a,{tagName:"markDirtyToRenderTree"}),i.isCollecting=!1}}else{var u=t.$contextInternal.elementTree;(0,g.J_)(u,t.$contextInternal),t._renderTree=(0,C.oU2)(u),null==n||n.operator.clear(),t._isMount=!0,r.initWithRenderTree(t._renderTree)}t.eventEmitter.trigger("build",[])},this.layout=function(e,n){var r,i;n||(n=ct({width:e.maxWidth,height:e.maxHeight})),C.rvU.reset("SyncLayout"),t.eventEmitter.trigger("willlayout",[]);var o=e.anchorKey,a=e.maxHeight,s=e.maxWidth,u=(null!==(r=null===(i=t.paintArea)||void 0===i?void 0:i.scrollTop)&&void 0!==r?r:0)-t.$contextInternal.layoutBuffer.top,l=function(e){t.$contextInternal.layoutBuffer={top:e.height/2,bottom:e.height/2},t.$contextInternal.viewport.updateCalculateFactors({area:e,buffer:t.$contextInternal.layoutBuffer})};l(n);var c=n.scrollTop-t.$contextInternal.layoutBuffer.top,h=t.$contextInternal.viewport.bufferStartObject.renderObject;t.$contextInternal.viewport.removeInvalidBufferStartObjects();var d=nt(t._renderTree,n.scrollTop-t.$contextInternal.layoutBuffer.top,h&&!h.isDestructed&&c>=u?h:void 0,h&&!h.isDestructed&&c<u?h:void 0);if(t.$contextInternal.viewport.updateCurrentBufferStartObject(d),Je(t.$contextInternal))return t.$contextInternal.scroll.scrollTo(n),l(n),{area:n,width:t._renderTree.width,height:t._renderTree.height};C.HTH.start("SyncLayout");var f=(0,C.guc)((function(){var e;return t.$contextInternal.layoutStrategy({elementTree:t.$contextInternal.elementTree,renderTree:t._renderTree,config:{area:n},maxHeight:a,maxWidth:s,anchor:o,eventEmitter:t.eventEmitter,scrollHeight:null===(e=t.$contextInternal.scroller)||void 0===e?void 0:e.scrollHeight})}),t.$contextInternal.elementTree,{tagName:"layout"});t.$contextInternal._updateScrollerPlaceholder(),t.$contextInternal.scroll.scrollTo(f.area);var p=(0,E.EQ)(t.$contextInternal);if(f.shouldCorrectBufferStart){var v=nt(t._renderTree,p.scrollTop,void 0,d);v!==d&&t.$contextInternal.viewport.updateCurrentBufferStartObject(v)}return l(p),f.keepLayout?t.layout(e,n):(C.HTH.stop("SyncLayout"),C.rvU.add("SyncLayout",C.HTH.get("SyncLayout")),C.HTH.reset("SyncLayout"),t.eventEmitter.trigger("layout",[{getViewportMeta:at(t.$contextInternal.viewport)}]),(0,C.zTE)(),!t._isCompleted&&Je(t.$contextInternal)&&(t._isCompleted=!0,t.eventEmitter.trigger("rendertreecompleted",[t._renderTree,!1])),{area:p,width:t._renderTree.width,height:t._renderTree.height})},this.paint=function(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=Ct();t.$contextInternal.DPR=o,t.paintArea=n,t._painter=e,null===(r=t._selection)||void 0===r||r.setOffset(n.x,n.y),"number"!=typeof t.paintArea.scrollTop&&(t.paintArea.scrollTop=0,t.paintArea.scrollLeft=0),t.paintController.paint({area:t.paintArea,painter:t._painter,useCache:i})},this.isDirty=function(){return!t._isMount||!!t._patchingPayload},this.subscribeDirty=function(e){t._patchCallback=e,wt(t.id,e)},this.dispatchEvent=function(e,t,n){},this.createNativeEvent=function(e,t,n){},this.updatePaintArea=function(e){t.paintArea=e},this.isHost=n,this.id=(0,C.q3z)(),this.eventEmitter=new _.v}return(0,d.Z)(e,[{key:"isMount",get:function(){return this._isMount}},{key:"events",get:function(){return this._events}}]),(0,d.Z)(e,[{key:"setColorToken",value:function(e){this.paintController.setColorToken(e)}},{key:"defineGetPosition",value:function(e){this.getPosition=e}},{key:"defineGetTransform",value:function(e){this.getTransform=e}},{key:"onSelectionChange",value:function(e){var t=e.range,n=e.prevRange;this.paintArea&&(t&&!pt(t.startPoint,t.endPoint)||n&&!pt(n.startPoint,n.endPoint))&&this.paint(this._painter,this.paintArea,!1)}},{key:"clearUselessEmbedDOM",value:function(){var e=this.$contextInternal,t=e.embedDOMUnmountCountSet,n=e.keyedEmbedDOMPool;t.forEach((function(e){var t=n.get(e);t&&t.count<=0&&(n.delete(e),t.embedDOM._unmountDOM(!0))})),t.clear()}},{key:"initEnv",value:function(e){var t=this;this.eventEmitter.on("selectionchange",(function(e){t.onSelectionChange(e)}))}},{key:"unsubscribeDirty",value:function(){this._patchCallback=void 0,Rt(this.id)}},{key:"registerEvent",value:function(e){this._events.includes(e)||this._events.push(e)}},{key:"getRenderTree",value:function(){return this._renderTree}},{key:"destroy",value:function(){Rt(this.id),this.clearUselessEmbedDOM()}}]),e}();function Ot(e,t,n){return e.on(t,n),function(){e.off(t,n)}}var Mt=function(){function e(t){var n=t.rNode,r=t.rNodeContext;(0,h.Z)(this,e),this.rNode=void 0,this.rNodeContext=void 0,this._destoryFunList=[],this.rNode=n,this.rNodeContext=r,r.pipeline=this}return(0,d.Z)(e,[{key:"initListener",value:function(){var e=this,t=this.rNode,n=this.rNodeContext,r=n.getRContext();if(t&&n){var i=Ot(r,"rendertreecompleted",(function(){var e;null===(e=window.__ROADSTER_DEVTOOLS_MANAGER__)||void 0===e||e.sendElementTreeToChromeExtension(n.elementTree._id,n.elementTree),n.isRenderTreeCompleted||(n.isRenderTreeCompleted=!0)}));t.subscribeDirty((function(){t.build(),t.layout({maxWidth:(0,E.uM)(n),maxHeight:(0,E.f6)(n)},(0,E.PT)(n)),t.paint(n.painter,(0,E.EQ)(n))})),this._destoryFunList.push(t.unsubscribeDirty.bind(t));var o=Ot(r,"addpositionedlayoutentry",(function(t){e.rNodeContext.layoutEntryCollector.addPositionEntryByElement(t)}));this._destoryFunList.push(i,o)}}},{key:"destroy",value:function(){var e=this.rNode,t=this.rNodeContext;e&&t&&(t.pipeline=void 0,this._destoryFunList.forEach((function(e){e()})),this._destoryFunList=[])}},{key:"render",value:function(e,t){var n=this.rNode,r=this.rNodeContext;n&&r&&(n.build(),n.layout({maxWidth:(0,E.uM)(r),maxHeight:(0,E.f6)(r),anchorKey:null==t?void 0:t.anchorKey},(0,E.PT)(r)),n.paint(r.painter,(0,E.EQ)(r)),r.hasRendered=!0)}}]),e}(),kt=function(e){for(;e.parent&&((0,C.Vfo)(e.parent)||(0,C.SNT)(e.parent));)e=e.parent;return e},It=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!(0,C.mNQ)(t)){var r,i=n?t:null!==(r=(0,C.vIA)(e,t))&&void 0!==r?r:t;return kt(i)}},xt=function(){function e(t){(0,h.Z)(this,e),this.cache=new Map,this.$context=void 0,this._sessions=[],this._isCollecting=!1,this.$context=t}return(0,d.Z)(e,[{key:"_addEntryByElement",value:function(e){var t=(0,R.Z$)(this.sessions);if(t&&e&&!this.cache.has(e._id)){var n={element:e,anchor:null};t.entries.push(n),this.cache.set(e._id,{session:t,entry:n})}}},{key:"addEntryByElement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(0,C.v0)(e)){var n=It(this.$context,e,t);return this._addEntryByElement(n)}}},{key:"addPositionEntryByElement",value:function(e){if(!(0,C.v0)(e))return this._addEntryByElement(e)}},{key:"insertSession",value:function(){this.sessions.push({entries:[]})}},{key:"removeSession",value:function(e){var t=this.sessions.indexOf(e);t>-1&&this.sessions.splice(t,1)}},{key:"removeEntryByElementId",value:function(e){if(this.cache.has(e)){var t=this.cache.get(e),n=t.session;if(t.entry&&(this.cache.delete(e),n)){var r=n.entries.findIndex((function(t){return t.element._id===e}));n.entries.splice(r,1),n.entries.length||this.removeSession(n)}}}},{key:"isEntry",value:function(e){return this.cache.has(e._id)}},{key:"getEntryByElement",value:function(e){return this.isEntry(e)?this.cache.get(e._id).entry:null}},{key:"peek",value:function(){return this.sessions.length?this.sessions[0].entries:null}},{key:"collectEntriesInOperation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.isCollecting){var n=e.element;n&&this.addEntryByElement(n,t)}}},{key:"collectEntriesWithPayloadElements",value:function(e){var t=this;e.forEach((function(e){t.addEntryByElement(e)}))}},{key:"removeEntryByElement",value:function(e){this.removeEntryByElementId(e._id)}},{key:"isCollecting",set:function(e){if(this._isCollecting=e,this._isCollecting)this.insertSession();else{var t=(0,R.Z$)(this.sessions);t&&0===t.entries.length&&this.removeSession(t)}},get:function(){return this._isCollecting}},{key:"sessions",get:function(){return this._sessions}}]),e}(),Nt=function(e){var t=e.elementTree,n=e.renderTree,r=e.config,i=e.anchor,o=e.maxWidth,a=e.maxHeight,s=(0,C.$bs)(n),u=s.layoutEntryCollector,l=r.area,c=(0,R.f0)({},l),h=[],d=[];(0,v.Mq)(n,(function(e){var t=e.renderObject;return e.isBackward||((0,C.ijY)(t,S.j2.Absolute)?h.push(t):(0,C.ijY)(t,S.j2.Fixed)&&d.push(t)),1}),{childrenProperty:"posRos",parentProperty:"refPosRo"});var f=u.sessions.map((function(e){return e.entries.map((function(e){return(0,C.LSh)(e.element)}))})).flat().filter((function(e){return!!e}));u.sessions.forEach((function(e){return e.entries.forEach((function(e){u.removeEntryByElement(e.element)}))}));var p=function(e){var t,n=x(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;r&&(0,v.bK)(r,{maxWidth:o,maxHeight:a,painter:s.painter,eventEmitter:s.rNode.eventEmitter})}}catch(e){n.e(e)}finally{n.f()}};if(p([].concat(f.length?f:[n],d)),f.length)for(var _=function(e){var t,n=new Map,r=[],i=function(e){for(var t=[],i=e,o=0;i;){if(n.has(i)){o+=n.get(i);break}o++,t.push(i),i=i.parent}for(var a=0,s=t.length;a<s;a++){var u;n.set(t[a],o--),(r[o]=null!==(u=r[o])&&void 0!==u?u:[]).push(t[a])}},o=x(e);try{for(o.s();!(t=o.n()).done;){i(t.value.parent)}}catch(e){o.e(e)}finally{o.f()}return r}(f),y=_.length-1;y>=0;y--){var m,b=x(_[y]);try{var T=function(){var e,t=m.value,n=null!==(e=t.runtime)&&void 0!==e?e:(0,C.KfJ)(t);(0,C.z7X)(n)&&((0,v.bK)(t,{maxWidth:o,maxHeight:a,painter:s.painter,onInterceptRenderObject:[function(e){if(t!==e)return 2}]}),(0,C.cUS)(t),(0,g.bY)(t.element))};for(b.s();!(m=b.n()).done;)T()}catch(e){b.e(e)}finally{b.f()}}if(p(h),i){var w=(0,C.GWw)(t,i);w&&(c.scrollTop=(0,E.oS)(w).top)}return{area:c,renderTree:n,lastCompletedAnchor:null}};function Pt(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.isInMountingChain,i=n.skipRoot,o=[{el:t,parent:t.parent,index:0,isInMountingChain:r}];o.length;){var a=o.pop(),s=a.isInMountingChain,u=a.el,l=a.index,c=a.parent;i&&u===t||((0,C.GIx)(u)?(e.mount(u,c)(),s||(l<=0?e.operator.preappend(c,u):e.operator.insertAfter(u,c.children[l-1]),s=!0)):(0,C.TO7)(u)&&e.execute(u));for(var h=[],d=u.children,f=d.length-1;f>=0;f--){var p=d[f];h.push({el:p,index:f,isInMountingChain:s,parent:u})}Array.prototype.push.apply(o,h)}}function Lt(e,t){(0,C.hHR)(t)||(((0,C.aCk)(t)||(0,C.nMf)(t))&&((0,C.vYn)(t)||(0,C.QX0)(t))?Pt(e,t):(0,C.TO7)(t)&&e.execute(t))}var Dt=function(e,t){Pt(t.reconcile,e)},Ft=function(e,t){(0,C.ZHw)(["mutate"]);for(var n=t.reconcile,r=0;r<e.length;r++){var i=e[r];n.patch(i,null),Pt(n,i)}};function Bt(e){return ft(null==e?void 0:e.startPoint)}function Vt(e){if(Bt(e)){var t=vt(e.startPoint),n=vt(e.endPoint);return t&&n?(0,R.f0)({},e,{startPoint:t,endPoint:n}):null}return e}function Ht(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0},r=t.scroll.scrollStatus,i=e.clientX,o=e.clientY,a=(0,E.EQ)(t),s=a.left,u=a.top,l=i-s-n.x+r.scrollLeft,c=o-u-n.y+r.scrollTop;return{x:l,y:c}}function Ut(e){return pt(e.startPoint,e.endPoint)}function Zt(e){var t=Vt(e),n=t.startPoint;return function(e,t){if(e=vt(e),t=vt(t),!e||!t)return!1;var n=e,r=n.node,i=n.offset,o=t,a=o.node,s=o.offset;if(r===a)return i<s||i===s&&!!e.atEnd&&!t.atEnd;var u=(0,C.DWu)(r).reverse(),l=(0,C.DWu)(a).reverse(),c=(0,C.a6z)(u,l),h=u[c],d=c+1<u.length?h.children.indexOf(u[c+1]):i,f=c+1<l.length?h.children.indexOf(l[c+1]):s;return d<f||d===f&&c+1===u.length}(t.endPoint,n)}function Wt(e){var t,n=e.node,r=e.offset,i=Math.max(1,(0,C.xPU)(n,1/0));return t=i===1/0&&n.parent?{node:n.parent,offset:(0,C.cq5)(n)+(r?1:0)}:{node:n,offset:Math.max(0,Math.min(i,r))},(0,R.f0)({},e,t)}function jt(e){var t=e=Wt(e),n=t.node.children,r=t.offset;if(null==n||!n.length)return e;for(var i=r>=n.length,o=n[i?n.length-1:r];null!==(a=o.children)&&void 0!==a&&a.length;){var a;o=o.children[i?o.children.length-1:0]}var s=i?(0,C.xPU)(o,1):0;return Wt((0,R.f0)({},e,{node:o,offset:s}))}function Gt(e){return Wt(function(e){var t,n,r=e.node,i=e.offset,o=r.element,a=null!==(t=o.renderObjects)&&void 0!==t?t:[],s=r.children;if((0,C.z0l)(r)){for(var u=a.indexOf(r)-1,l=i;u>=0;)l+=a[u--].props.content.length;n={node:o,offset:l,atEnd:i===r.props.content.length}}else if(null!=s&&s.length){var c=i>=s.length,h=s[c?s.length-1:i].element;n={node:o,offset:(0,C.cq5)(h)+(c?1:0),atEnd:c}}else n={node:o,offset:i};return void 0!==e.isEdge&&(n.isEdge=e.isEdge),n}(e))}function zt(e){var t=function(e){var t,n,r=e.node,i=e.offset,a=e.atEnd,s=(0,C.CXA)(r);if(s&&1===s.length)n=s[0];else{var u=(0,C.SvU)(r);if(!u)return null;n=u}var l=n.renderObjects;if(null==l||!l.length)return null;var c=l[0];if(0===c.width){var h=function(){var e=(0,C.yjm)(c),t=(0,C.kSo)(c),n=(0,C.ZX6)(c);if(!t||!n)return{v:null};for(var r=[],i=t.children,o=0;o<i.length;o++)i[o].lineOffsetTop===(null==n?void 0:n.lineOffsetTop)&&(0,C.ENg)(i[o],(function(e){(0,C.z0l)(e)&&r.push(e)}));var s=c===r[0],u=c===r[r.length-1];if(!1===a&&u){var l=(0,C.C3d)(c,e);if(l)return{v:{node:l,offset:0}}}else if(a&&s){var h,d,f=(0,C.gN5)(c,e);if(f)return{v:{node:f,offset:null!==(h=null===(d=f.props.content)||void 0===d?void 0:d.length)&&void 0!==h?h:0}}}}();if("object"===(0,o.Z)(h))return h.v}if(0===i)return{node:c,offset:0};if((0,C.kKo)(n,S.j2.Text)){for(var d=0,f=0,p=0,v=0;p<l.length&&!(f+(v=(c=l[p]).props.content.length)>=i);p++)f+=v;return f+v===i&&!a&&p+1<l.length?(c=l[p+1],d=0):d=i-f,{node:c,offset:d}}var g=(0,C.m0w)(n);if(null==g||!g.length)return{node:c,offset:i};var _=i>=g.length,y=g[_?g.length-1:i];if(null===(t=y.renderObjects)||void 0===t||!t.length)return null;var m=y.renderObjects[_?y.renderObjects.length-1:0];return{node:m.parent,offset:(0,C.cq5)(m)+(_?1:0)}}(e);return t&&Wt(t)}function Yt(e,t){return e===t||!(!e||!t)&&(e.node===t.node&&e.offset===t.offset)}function Xt(e){var t=Vt(e);return t&&(0,R.f0)({},t,{isCollapsed:Ut(t),isBackward:Zt(t)})}function Kt(e){return(t=e)&&(0,R.f0)({},t,{startPoint:ht(t.startPoint),endPoint:ht(t.endPoint)});var t}function qt(e,t){return e===t||!(!e||!t)&&(function(e,t){if(e===t)return!0;if(!e||!t)return!1;var n=e.startPoint,r=e.endPoint,i=t.startPoint,o=t.endPoint;return pt(n,i)&&pt(r,o)}(e,t)&&e.isBackward===t.isBackward&&e.isCollapsed===t.isCollapsed)}var $t=Vt;function Jt(e){if(!e||e.isCollapsed)return null;var t=e.startPoint,n=e.endPoint,r=e.isBackward,i=r?n:t,o=r?t:n,a=(0,C.WGj)(i.node),s=(0,C.WGj)(o.node);if(!a||!s)return null;var u=Qt((0,C.yjm)(a),(0,C.DWu)(a),(0,C.DWu)(s)),l=(0,C.ojQ)(u);(0,C.kKo)(l,S.j2.Text)&&(l.props.content=l.props.content.slice(0,o.offset));var c=(0,C.m6N)(u);return(0,C.kKo)(c,S.j2.Text)&&(c.props.content=c.props.content.slice(i.offset)),en(u)}function Qt(e,t,n){for(var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=(0,R.f0)({},e,{props:(0,R.f0)({},e.props)},{children:[]}),o=!r,a=0;a<e.children.length;a++){var s=e.children[a],u=t.includes(s),l=n.includes(s);if(u&&(o=!0),o){var c=Qt(s,t,n,u);i.children.push(c)}if(l){o=!1;break}}return i}function en(e,t){var n=(0,C.F8u)(e);if(t)t.set(n.eid,n);else{var r=(0,C.nq)(n.root).fragmentPool;t=new Map,r.set(n,t)}var i,o=x(e.children);try{for(o.s();!(i=o.n()).done;){en(i.value,t)}}catch(e){o.e(e)}finally{o.f()}return n}function tn(e){return{value:e,prev:null,next:null}}function nn(e){return 0===e.type}var rn=function(){function e(){(0,h.Z)(this,e),this.chainStartNode=void 0,this.chainEndNode=void 0,this.chainMap=void 0,this.cacheChainToArray=null,this.type=0,this.init()}return(0,d.Z)(e,[{key:"init",value:function(){this.chainStartNode=tn(null),this.chainEndNode=tn(null),this.chainStartNode.next=this.chainEndNode,this.chainEndNode.prev=this.chainStartNode,this.chainMap=new Map,this.cacheChainToArray=null}},{key:"reset",value:function(){this.init()}},{key:"insertAfter",value:function(t,n){var r;if((0,C.ijY)(n)){if(!(r=this.chainMap.get(n)))return}else r=n;var i=e.createTextFragmentNode(t),o=r,a=i,s=r.next;o.next=a,a.prev=o,a.next=s,s.prev=a,this.chainMap.set(t,i),this.cacheChainToArray=null}},{key:"push",value:function(e){if(!this.chainMap.get(e)){var t=this.chainEndNode.prev;this.insertAfter(e,t)}}},{key:"remove",value:function(e){var t=this.chainMap.get(e);if(t){var n=t.prev,r=t.next;n.next=r,r.prev=n,this.chainMap.delete(e),this.cacheChainToArray=null}}},{key:"cutTextFragment",value:function(t){var n=this.chunks.indexOf(t),r=this.chunks.slice(0,n+1),i=this.chunks.slice(n+1);this.reset();for(var o=0;o<r.length;o++)this.push(r[o]);for(var a=e.createTextFragment(),s=0;s<i.length;s++)a.push(i[s]);return[this,a]}},{key:"concatTextFragment",value:function(e){for(var t=e.chunks,n=0;n<t.length;n++)this.push(t[n])}},{key:"head",get:function(){return this.chainStartNode}},{key:"tail",get:function(){return this.chainEndNode}},{key:"chunks",get:function(){if(this.cacheChainToArray)return this.cacheChainToArray;var t=e.transformChainToArray(this.chainStartNode);return t=t.slice(1,t.length-1),this.cacheChainToArray=t,t}}],[{key:"createTextFragmentNode",value:function(e){return tn(e)}},{key:"transformChainToArray",value:function(e){for(var t=[],n=e;n;)t.push(n.value),n=n.next;return t}},{key:"createTextFragment",value:function(){return new e}}]),e}(),on=function(){function e(t){var n=t.inlineFlow;(0,h.Z)(this,e),this.inlineFlow=void 0,this.data=[],this.renderObjectToFragmentMap=new Map,this.cachePlainFragments=[],this.inlineFlow=n}return(0,d.Z)(e,[{key:"compute",value:function(){for(var e=0;e<this.length;e++){var t=this.data[e];if(nn(t))for(var n=0;n<t.chunks.length;n++){var r=t.chunks[n];(0,C.m2Z)(r)}}}},{key:"findPreviousFragmentByRenderTree",value:function(e){for(var t=[e];t.length;){var n=t.length>1?"down":"up",r=t.pop();if(r===this.inlineFlow)return{type:1,data:null};if(this.hasFragmentByRenderObject(r)&&r!==e)return{type:0,data:r};var i,o=(0,C.cq5)(r),a=r.parent;if("up"===n)t.push(a),Array.prototype.push.apply(t,a.children.slice(0,o));else Array.prototype.push.apply(t,null!==(i=r.children)&&void 0!==i?i:[])}return{type:2,data:null}}},{key:"add",value:function(t){if(null!==(0,C.xbV)(t)&&!this.hasFragmentByRenderObject(t))if(this.length){var n=this.findPreviousFragmentByRenderTree(t);if(2!==n.type)if(1!==n.type)this.insertAfter(t,n.data);else{if(!(0,C.z0l)(t)){var r=e.createBlock({renderObject:t});return this.data.splice(0,0,r),void this.renderObjectToFragmentMap.set(t,r)}if(nn(this.firstFragment))this.firstFragment.insertAfter(t,this.firstFragment.head),this.renderObjectToFragmentMap.set(t,this.firstFragment);else{var i=e.createTextFragment();i.push(t),this.data.splice(0,0,i),this.renderObjectToFragmentMap.set(t,i)}}}else this.push(t)}},{key:"push",value:function(t){var n=(0,C.xbV)(t);if(null!==n)if(0===n){var r=this.getFragmentByRenderObject(t);r||(this.lastFragment&&nn(this.lastFragment)||this.data.push(e.createTextFragment()),r=this.lastFragment),r.push(t),this.renderObjectToFragmentMap.set(t,r)}else{var i=e.createBlock({renderObject:t});this.data.push(i),this.renderObjectToFragmentMap.set(t,i)}}},{key:"update",value:function(e){this.inlineFlow.isDestructed||(this.remove(e),this.add(e))}},{key:"hasFragmentByRenderObject",value:function(e){return this.renderObjectToFragmentMap.has(e)}},{key:"getFragmentByRenderObject",value:function(e){return this.renderObjectToFragmentMap.get(e)}},{key:"insertAfter",value:function(t,n){var r=this.getFragmentByRenderObject(n);if(r)if(nn(r))if((0,C.z0l)(t))r.insertAfter(t,n),this.renderObjectToFragmentMap.set(t,r);else{var i=e.createBlock({renderObject:t}),o=r.cutTextFragment(n),a=(0,f.Z)(o,2)[1],s=this.data.indexOf(r);this.data.splice(s+1,0,i,a),this.renderObjectToFragmentMap.set(t,i);for(var u=0;u<a.chunks.length;u++)this.renderObjectToFragmentMap.set(a.chunks[u],a)}else{var l=this.data.indexOf(r),c=l+1;if(c>=this.length)return void this.push(t);var h=this.data[c];if((0,C.z0l)(t))if(nn(h))h.insertAfter(t,h.head),this.renderObjectToFragmentMap.set(t,h);else{var d=e.createTextFragment();d.push(t),this.data.splice(l+1,0,d),this.renderObjectToFragmentMap.set(t,d)}else{var p=e.createBlock({renderObject:t});this.data.splice(l+1,0,p),this.renderObjectToFragmentMap.set(t,p)}}else this.push(t)}},{key:"remove",value:function(e){var t=this.getFragmentByRenderObject(e);if(t){if((0,C.z0l)(e)){var n=t;if(n.remove(e),0===n.chunks.length){var r=this.data.indexOf(n);this.data.splice(r,1)}}else{var i=this.data.indexOf(t);this.data.splice(i,1);var o=this.data[i-1],a=this.data[i];if(o&&a&&nn(o)&&nn(a)){this.concatTextFragment(o,a),this.data.splice(i,1);for(var s=0;s<a.chunks.length;s++)this.renderObjectToFragmentMap.set(a.chunks[s],o)}}this.renderObjectToFragmentMap.delete(e)}}},{key:"concatTextFragment",value:function(e,t){e.concatTextFragment(t)}},{key:"findInlineFlowChildByLeaf",value:function(e){for(var t=e;t;){var n;if(t.parent===this.inlineFlow)return t;t=null!==(n=t.parent)&&void 0!==n?n:null}return null}},{key:"length",get:function(){return this.data.length}},{key:"lastFragment",get:function(){return this.data[this.length-1]}},{key:"firstFragment",get:function(){return this.data[0]}},{key:"isFragmentValid",get:function(){return!this.inlineFlow.isDestructed}}],[{key:"createTextFragment",value:function(){return new rn}},{key:"createBlock",value:function(e){return{type:1,renderObject:e.renderObject}}}]),e}();function an(e){if(!ln(e))return e;var t=dn(e);if(t){var n=t.renderPoint,r=t.renderPoint.node,i=t.fragments.inlineFlow,o=i.dir;if(!sn(i,r)){var a=t.chunks,s=cn(t),u=s.index,l=s.isStartEdge,c=s.isEndEdge,h=(0,C.ZX6)(r);if(u<0)return e;if(l)for(var d=u,f=a.length;d<f;d++){if(un(o,a[d])){var p,v;n.node=a[d-1],n.offset=null!==(p=null===(v=a[d-1].props.content)||void 0===v?void 0:v.length)&&void 0!==p?p:1/0;break}var g,_;if(d===f-1)n.node=a[d],n.offset=null!==(g=null===(_=a[d].props.content)||void 0===_?void 0:_.length)&&void 0!==g?g:1/0}else if(c)for(var y=u;y>=0;y--){var m=(0,C.ZX6)(a[y]);if(un(o,a[y])||(null==m?void 0:m.lineOffsetTop)!==(null==h?void 0:h.lineOffsetTop)){n.node=a[y+1],n.offset=0;break}}n.node.dir===k.oZ.NONE&&(n.node=jt(n).node,n.offset=0)}return n}return e}function sn(e,t){return t.dir===k.oZ.NONE?e.dir===k.oZ.LTR:e.dir===t.dir}function un(e,t){return e===k.oZ.LTR?t.dir!==k.oZ.RTL:t.dir===k.oZ.RTL}function ln(e){var t;if(0===e.offset)return!0;var n=e.node;return(0,C.z0l)(n)?n.props.content.length===e.offset:n.dir===k.oZ.NONE||(null===(t=n.children)||void 0===t?void 0:t.length)===e.offset}function cn(e){var t=e.renderPoint,n=e.fragments.inlineFlow.dir,r=e.chunks,i=e.renderPoint.node,o=r.indexOf(i),a=!r[o-1]||un(n,r[o-1]),s=!r[o+1]||un(n,r[o+1]);return i.dir===k.oZ.NONE?{index:o,isStartEdge:((0,C.z0l)(i)||0===e.renderPoint.offset)&&a,isEndEdge:((0,C.z0l)(i)||0!==e.renderPoint.offset)&&s}:{index:o,isStartEdge:0===t.offset&&a,isEndEdge:(!(0,C.z0l)(i)||t.offset===i.props.content.length)&&s}}function hn(e){for(var t=[],n=e.data,r=0;r<n.length;r++){var i=n[r];nn(i)?t=t.concat(i.chunks):t.push(i.renderObject)}return t}function dn(e){var t,n,r,i,o,a=(t=e.node,null!==(n=null===(r=t.runtime)||void 0===r?void 0:r.fragments)&&void 0!==n?n:null===(i=t.runtime)||void 0===i||null===(o=i.constraint)||void 0===o?void 0:o.fragments);if(a){var s=Object.assign({},e);if(a.inlineFlow.dir===k.oZ.NONE)for(var u=hn(a).indexOf(e.node),l=a.inlineFlow;l;){var c,h,d,f=null===(c=l)||void 0===c||null===(h=c.runtime)||void 0===h||null===(d=h.constraint)||void 0===d?void 0:d.fragments;if(null!=f&&f.inlineFlow.dir&&[k.oZ.LTR,k.oZ.RTL].includes(f.inlineFlow.dir)){a=f,s={node:l,offset:u};break}l=f?f.inlineFlow:l.parent}var p=hn(a);return p=p.filter((function(e){return e.dir})),{fragments:a,chunks:p,renderPoint:s}}}function fn(e,t){return(0,C.YkQ)(e,t,(function(e){return(0,C.xPU)(e,1)}))}function pn(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e=$t(e),r=n.startPoint,i=n.endPoint,o=n.isBackward;if(o){var a=[i,r];r=a[0],i=a[1]}var s=zt(r),u=zt(i);if(!s||!u)return[];var l=an(s),c=yn({startPoint:s=Yt(s,u)?u=l:l,endPoint:u}),h=(0,C.$bs)(s.node),d=h.painter;return t&&(c=c.flatMap((function(e){return(0,C.hUA)(e,(function(e){return(0,C.xPU)(e,1)}))}))),c.flatMap((function(e){return mn(e,d)}))}function vn(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=pn(e,t);return(0,C.GZ0)(n)}function gn(e){if(!(e=vt(e)))return null;if((0,C.kiv)(e.node))return(0,E.MJ)(e.node).flat();var t=zt(e),n=(0,C.$bs)(e.node).painter;return t&&function(e,t){var n=e.node,r=e.offset;return mn({node:n,start:r,end:r},t).flat()}(t,n)}function _n(e){var t=gn(e);return t&&(0,C.GZ0)(t)}function yn(e){var t=e.startPoint,n=e.endPoint,r=[];return t&&n&&Array.prototype.push.apply(r,fn(t,n)),r.length||(t&&r.push({node:t.node,start:t.offset,end:t.offset}),n&&!Yt(t,n)&&r.push({node:n.node,start:n.offset,end:n.offset})),r}function mn(e,t){var n,r=e.node,i=e.start,o=e.end,a=[Math.min(i,o),Math.max(i,o)];if(i=a[0],o=a[1],(0,C.z0l)(r)){var s=r.height,u=ge(r,[i,o],t),l=u.textLeft,c=u.textWidth;return[(0,E.tZ)(r,{left:l,top:0,width:c,height:s})]}if(null!==(n=r.children)&&void 0!==n&&n.length){if(i<o)return r.children.slice(i,o).map((function(e){return(0,E.tZ)(e)}));if(i>=r.children.length){var h=(0,R.Z$)(r.children),d=h.width,f=h.height;return[(0,E.tZ)(h,{left:d,top:0,width:0,height:f})]}var p=r.children[i],v=p.height;return[(0,E.tZ)(p,{left:0,top:0,width:0,height:v})]}return[(0,E.tZ)(r)]}function En(e,t,n){var r,i,o=e.scroller,a=e.scroll,s=n&&(0,C.mTK)(e,n.eid)||o,u=t,l={scrollLeft:0,scrollTop:0};if((0,C.$wM)(t)){var c=(0,C.WGj)(t);u=(0,E.BC)(c),l=a.scrollStatus,s=o}else if(Bt(t)){u=vn(Xt(Vt(t))),l=a.scrollStatus,s=o}a.scrollTo({scrollLeft:(null!==(r=u.left)&&void 0!==r?r:0)+l.scrollLeft,scrollTop:(null!==(i=u.top)&&void 0!==i?i:0)+l.scrollTop},s,!1)}function bn(e,t){var n,r,i;(0,C.$wM)(t)?i=(0,C.WGj)(t):Bt(t)&&(i=Vt(t).startPoint.node);var o=(0,C.LSh)(i);if(o){for(;o.parent;){var a=o.parent;P(a)&&(a.scrollLeft=Math.min(a.scrollWidth-a.width,o.left)),L(a)&&(a.scrollTop=Math.min(a.scrollHeight-a.height,o.top)),o=a}var s=(0,E.BC)(i),u=e.scroller,l=e.scroll,c=l.scrollStatus,h=l.offsetWidth,d=l.offsetHeight;l.scrollTo({scrollLeft:(null!==(n=s.left)&&void 0!==n?n:0)+c.scrollLeft-h/2,scrollTop:(null!==(r=s.top)&&void 0!==r?r:0)+c.scrollTop-d/2},u,!1)}}function Tn(e,t){var n=Math.max(0,e.scrollTop),r=Math.max(0,e.scrollLeft);return(n!==t.scrollTop||r!==t.scrollLeft)&&(t.scrollTop=n,t.scrollLeft=r,!0)}function Cn(e){return function(t){e.rNode.layout({maxWidth:(0,E.uM)(e),maxHeight:(0,E.f6)(e)},(0,E.PT)(e));var n=!t||(null==t?void 0:t.scrollElement)instanceof HTMLElement;e.rNode.paint(e.painter,(0,E.EQ)(e),n)}}var Sn=function(){function e(t,n){var r,i,o=this;(0,h.Z)(this,e),this.scrollEnhancement=void 0,this.getScrollState=void 0,this._scrollStatus=void 0,this._config={enableGlobalWheel:!0},this.unBindDefaultScrollEvent=void 0,this.unBindScrollEvent=void 0,this.scrollTo=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.scrollElement,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];n&&(null===(t=o.scrollEnhancement)||void 0===t||t.scroll(n,e,r))},this.destroy=function(){var e,t;null===(e=o.unBindDefaultScrollEvent)||void 0===e||e.call(o),null===(t=o.unBindScrollEvent)||void 0===t||t.call(o)},this.scrollElement=n,this._scrollStatus={scrollTop:null!==(r=null==n?void 0:n.scrollTop)&&void 0!==r?r:0,scrollLeft:null!==(i=null==n?void 0:n.scrollLeft)&&void 0!==i?i:0},this.unBindDefaultScrollEvent=this.bindDefaultScrollEvent(t),this.unBindScrollEvent=this.bindEvent(t)}return(0,d.Z)(e,[{key:"setConfig",value:function(e){(0,R.f0)(this._config,e)}},{key:"bindDefaultScrollEvent",value:function(e){var t,n=this,r=Cn(e),i=function(){Tn(n.scrollElement,n._scrollStatus)&&r()};return null===(t=this.scrollElement)||void 0===t||t.addEventListener("scroll",i,{passive:!0}),function(){var e;null===(e=n.scrollElement)||void 0===e||e.removeEventListener("scroll",i)}}},{key:"bindEvent",value:function(e){var t=this,n=function(){var e;null===(e=t.scrollEnhancement)||void 0===e||e.handleScroll()},r=function(){var e;null===(e=t.scrollEnhancement)||void 0===e||e.handleMousedown()},i=function(e){var n;null===(n=t.scrollEnhancement)||void 0===n||n.handleMousemove(e)},o=function(){var e;null===(e=t.scrollEnhancement)||void 0===e||e.handleMouseup()},a=function(e){var n;null===(n=t.scrollEnhancement)||void 0===n||n.handleWheel(e)};return e.rNode.eventEmitter.on("SCROLL_SCROLL",n),e.rNode.eventEmitter.on("SCROLL_START",r),e.rNode.eventEmitter.on("SCROLL_MOVING",i),e.rNode.eventEmitter.on("SCROLL_END",o),e.rNode.eventEmitter.on("SCROLL_WHEEL",a),function(){e.rNode.eventEmitter.off("SCROLL_SCROLL",n),e.rNode.eventEmitter.off("SCROLL_START",r),e.rNode.eventEmitter.off("SCROLL_MOVING",i),e.rNode.eventEmitter.off("SCROLL_END",o),e.rNode.eventEmitter.off("SCROLL_WHEEL",a)}}},{key:"scrollStatus",get:function(){return this._scrollStatus}},{key:"offsetWidth",get:function(){var e,t;return null!==(e=null===(t=this.scrollElement)||void 0===t?void 0:t.offsetWidth)&&void 0!==e?e:1/0}},{key:"offsetHeight",get:function(){var e,t;return null!==(e=null===(t=this.scrollElement)||void 0===t?void 0:t.offsetHeight)&&void 0!==e?e:1/0}},{key:"offsetLeft",get:function(){var e,t;return null!==(e=null===(t=this.scrollElement)||void 0===t?void 0:t.offsetLeft)&&void 0!==e?e:0}},{key:"offsetTop",get:function(){var e,t;return null!==(e=null===(t=this.scrollElement)||void 0===t?void 0:t.offsetTop)&&void 0!==e?e:0}},{key:"isScrolling",get:function(){var e;return null===(e=this.scrollEnhancement)||void 0===e?void 0:e.isScrolling}},{key:"config",get:function(){return this._config}}]),e}(),wn=function(e){function t(){return(0,h.Z)(this,t),(0,u.Z)(this,(0,l.Z)(t).apply(this,arguments))}return(0,c.Z)(t,e),(0,d.Z)(t,null,[{key:"_displayName",get:function(){return"RoadsterRoot"}}]),t}(C.wA2),Rn=function(){function e(t){var n;(0,h.Z)(this,e),this._array=[],this._initSize=0,this.size=0;var r=(null!==(n=t)&&void 0!==n?n:{}).initSize,i=void 0===r?1e3:r;this._initSize=i,this.init()}return(0,d.Z)(e,[{key:"init",value:function(){this._array=new Array(this._initSize),this.size=0}},{key:"get",value:function(e){return this._array[e]}},{key:"set",value:function(e,t){return this.has(e)||(this.size=this.size+1,this._array[e]=t),this}},{key:"has",value:function(e){return void 0!==this._array[e]}},{key:"delete",value:function(e){return this.has(e)&&(this.size=this.size-1,delete this._array[e]),!0}},{key:"clear",value:function(){this.init()}},{key:"keys",value:function(){for(var e=this._array,t=[],n=0,r=e.length;n<r;n++)void 0!==e[n]&&t.push(n);return t}},{key:"values",value:function(){for(var e=this._array,t=[],n=0,r=e.length;n<r;n++)void 0!==e[n]&&t.push(e[n]);return t}},{key:"forEach",value:function(e){for(var t=this._array,n=0,r=t.length;n<r;n++)void 0!==t[n]&&e(t[n],n,t)}}]),e}(),An=function(e){function t(){var e,n;(0,h.Z)(this,t);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(n=(0,u.Z)(this,(e=(0,l.Z)(t)).call.apply(e,[this].concat(i))))._reuseArray=[],n._genIndex=(0,C.X1O)(),n._pendingReuseArray=[],n._timer=null,n}return(0,c.Z)(t,e),(0,d.Z)(t,[{key:"init",value:function(){(0,i.Z)((0,l.Z)(t.prototype),"init",this).call(this),this._reuseArray=[],this._genIndex=(0,C.X1O)()}},{key:"_commitReuse",value:function(){Array.prototype.push.apply(this._reuseArray,this._pendingReuseArray),this._pendingReuseArray.length=0}},{key:"reuse",value:function(e){var t=this;this._pendingReuseArray.push(e),this._timer||(this._timer=setTimeout((function(){t._commitReuse(),t._timer=null})))}},{key:"reuseRange",value:function(e,t){if(!(e>=t))for(var n=e;n<t;n++)this._reuseArray.push(n)}},{key:"genIndex",value:function(e){return this._reuseArray.length?this._reuseArray.shift():this._genIndex(e)}},{key:"set",value:function(e,n){var r=this._array.length;return this.reuseRange(r,e),(0,i.Z)((0,l.Z)(t.prototype),"set",this).call(this,e,n)}},{key:"delete",value:function(e){return this.reuse(e),(0,i.Z)((0,l.Z)(t.prototype),"delete",this).call(this,e)}}]),t}(Rn);function On(e,t){var n=e,r=t.cloneRo(e);if((0,C.z0l)(r)){var i,o,a=r.runtime=(0,C.KfJ)(r),s=n.runtime;a.isComputedStyle=!(null==s||!s.isComputedStyle),a.fragments=null!==(i=s.fragments)&&void 0!==i?i:null===(o=s.constraint)||void 0===o?void 0:o.fragments,(0,C.DSN)(a,"status",(0,C.Epq)(a.status,[1],!1))}return(0,C.pK0)(n,{paddingRight:0,marginRight:0,borderRightWidth:0,bTRRH:0,bTRRV:0,bBRRH:0,bBRRV:0}),(0,C.pK0)(r,{paddingLeft:0,marginLeft:0,borderLeftWidth:0,bTLRH:0,bTLRV:0,bBLRH:0,bBLRV:0}),r.props.sourceStyle=(0,R.f0)(Object.keys(r.props.sourceStyle).filter((function(e){return!e.startsWith("__")})).reduce((function(e,t){return e[t]=r.props.sourceStyle[t],e}),{}),{marginLeft:0,paddingLeft:0,borderLeftWidth:0}),r}var Mn=function(e,t){if(e.length<2)return[void 0,void 0];var n=e.lastIndexOf(t);if(n>-1)e.splice(n,0,t),n++;else{for(var r=0,i=e.length-1;i-r>1;){var o=Math.floor((r+i)/2);if(t===e[o]){e.splice(o+1,0,t,t),n=o+2;break}t<e[o]?i=o:r=o}e[r]<t&&t<e[i]&&(e.splice(r+1,0,t,t),n=r+2)}return[e.slice(0,n),e.slice(n).map((function(e){return e-t}))]},kn=function(e,t,n){var r,i,o=t.pos,a=t.target,s=a.props.content,u=a.lineBreakerPosition,l=a.graphemeBreakerPosition,c=s.slice(0,o),h=s.slice(o),d=Mn(null!==(r=u)&&void 0!==r?r:[],o),p=(0,f.Z)(d,2),v=p[0],g=p[1],_=Mn(null!==(i=l)&&void 0!==i?i:[],o),y=(0,f.Z)(_,2),m=y[0],E=y[1],b=(0,C.gOt)(a,["zoom"]).zoom,T=(0,C.IJD)(a),S=n.measureTextWithZoom(ve(a,0,o,"end"),T,b).width,w=n.measureTextWithZoom(ve(a,o,s.length,"start"),T,b).width,A=a.width-S-w;(0,C.ryg)(a,{width:S,textWidth:S,props:(0,R.f0)({},a.props,{content:c}),lineBreakerPosition:v,graphemeBreakerPosition:m});var O=On(a,n),M=O;(0,C.ryg)(O,{width:w,textWidth:w,props:(0,R.f0)({},a.props,{content:h}),left:0,lineBreakerPosition:g,graphemeBreakerPosition:E});for(var k=a,I=0,x=a.parent,N=function(){var t=x.children;if(I=t.indexOf(k),x===e)return"break";var r=On(x,n),i=t.slice(0,I+1),o=t.slice(I+1),a=x.width;S+=k.left,(0,C.$BO)(x),i.forEach((function(e){(0,C.LVC)(x,e)})),x.runtime&&(0,C.DSN)(x.runtime,"status",2),(0,C.R_0)(x,"width",S),o.forEach((function(e){(0,C.R_0)(e,"left",e.left-S-A),(0,C.LVC)(r,e)})),r.runtime&&(0,C.DSN)(r.runtime,"status",2),(0,C.R_0)(r,"width",a-S-A),(0,C.R_0)(r,"left",0),(0,C.LVC)(r,O,0),O=r,k=x,x=x.parent};x;){if("break"===N())break}return(0,C.pK0)(k,{marginBottom:0}),(0,C.pK0)(O,{marginTop:0}),{leafRightRo:M,rightRo:O,rightRoIndex:I}},In=function(e,t,n){for(var r,i=t.target,o=i,a=0,s=i.parent;s;){var u=s.children;if(a=u.indexOf(o),s===e)break;var l=s.width;(r||a>0)&&function(){r&&a++;var e=u.slice(0,a),t=u.slice(a),i=On(s,n),o=0,c=0;(0,C.$BO)(s),e.forEach((function(t,n){if((0,C.LVC)(s,t),o=t.left+t.width,c=o,n===e.length-1){var r=(0,C.gOt)(t).marginRight;o+=void 0===r?0:r}})),(0,C.R_0)(s,"width",c),t.forEach((function(e){(0,C.R_0)(e,"left",e.left-o),(0,C.LVC)(i,e)})),r&&((0,C.R_0)(r,"left",0),(0,C.LVC)(i,r,0)),(0,C.R_0)(i,"width",l-o),r=i}(),o=s,s=s.parent}return r&&(0,C.R_0)(r,"left",0),{rightRo:r,lastTargetIndex:a}};function xn(e,t,n){var r=n.maxWidth,i=n.isDomain,o=n.lineIndex,a=void 0===o?0:o,s=(0,C.gOt)(e,["textIndent"]).textIndent;if(void 0===i||void 0===r){var u,l,c,h=e.runtime;r=null!==(u=null==h||null===(l=h.context)||void 0===l?void 0:l.maxWidth)&&void 0!==u?u:0,i=(null==h||null===(c=h.context)||void 0===c?void 0:c.maxWidth)!==1/0}if(!i||a||!s)return 0;var d=(0,C.S1Q)(t);return d.marginLeft+d.borderLeft+d.paddingLeft+s<r?s:0}function Nn(e){var t,n,r,i=e.runtime;return null!==(t=null==i||null===(n=i.context)||void 0===n?void 0:n.fragments)&&void 0!==t?t:null==i||null===(r=i.constraint)||void 0===r?void 0:r.fragments}function Pn(e){return e%2?"rtl":"ltr"}function Ln(e,t,n,r,i,o){for(var a=0,s=t,u=0,l=r.length;u<l;u++){var c=kn(e,{pos:r[u]-a,target:s},n),h=c.leafRightRo,d=c.rightRo,f=c.rightRoIndex;(0,C.R_0)(s,"dir",null==i?void 0:i[u]),s=h,a=r[u],(0,C.LVC)(e,d,f+1),null==o||o.add(h)}(0,C.R_0)(s,"dir",null==i?void 0:i[r.length])}function Dn(e,t,n){if(t.dir)for(var r=t,i=t;;){var o;if(!(r=r.parent))return;if(r===e)return;if(null!==(o=r)&&void 0!==o&&o.children&&r.children.length>1){var a=In(e,{target:i},n),s=a.rightRo,u=a.lastTargetIndex;s&&(0,C.LVC)(e,s,u+1)}i=r}}function Fn(e,t,n){if("none"!==e.dir){for(var r=t.data,i=!1,o="",a=[],s=0,u=r.length;s<u;s++){var l=r[s];if(nn(l))for(var c=l.chunks,h=0,d=c.length;h<d;h++){var f=c[h];f.textWidth<=0||"none"===f.dir||(a.push(f),o+=f.props.content)}}for(var p=(0,C.rbG)(o),v=p.levels,g=[],_=[],y=v[0],m=1,E=v.length;m<E;m++){if(v[m]!==y){var b=v[m];b!==y&&(g.push(m),_.push(Pn(y)),y=b,i=!0),y=b}}_.push(Pn(y)),(0,C.R_0)(e,"dir",Pn(p.paragraphs[0].level)),(0,C.R_0)(e,"hasRTL","rtl"===e.dir||i);for(var T=0,S=0,w=0,R=a.length;w<R;w++){for(var A=a[w],O=A.props.content.length,M=g[S],k=A.dir?void 0:{breakpointList:[],directionList:[]};T<M&&M<T+O;)null==k||k.breakpointList.push(M-T),null==k||k.directionList.push(_[S]),M=g[++S];null==k||k.directionList.push(_[S]),k&&k.directionList.length>0&&Ln(e,A,n,k.breakpointList,k.directionList,t),M===T+O&&S++,T+=O}for(var I=e.dir,x=0,N=r.length;x<N;x++){var P=r[x];if(nn(P))for(var L=P.chunks,D=0,F=L.length;D<F;D++){var B=L[D];!I||"none"===B.dir||B.dir===I&&"rtl"!==B.dir||(Dn(e,B,n),I=B.dir)}}}}var Bn;function Vn(e,t){for(var n=0,r=t.inlineFlowRo,i=t.utils,o=0,a=e.length;o<a;o++){var s=e[o];if((0,C.ijY)(s,S.j2.Text)&&((0,C.R_0)(s,"ligatureStatus",0),s.width>0&&"rtl"===s.dir)){var u=e[o-1],l=e[o+1];u&&(0,C.ijY)(u,S.j2.Text)&&"rtl"===u.dir&&de(u.props.content,u.props.content.length-1)&&(0,C.R_0)(s,"ligatureStatus",s.ligatureStatus+1),l&&(0,C.ijY)(l,S.j2.Text)&&"rtl"===l.dir&&de(l.props.content)&&(0,C.R_0)(s,"ligatureStatus",s.ligatureStatus+2);var c=(0,C.gOt)(s,["zoom"]).zoom,h=(0,C.IJD)(s),d=fe(s),f=i.measureTextWithZoom(d,h,c).width;if(s.textWidth===f)continue;var p=s.textWidth-f;s.textWidth=f;for(var v=s;v&&v!==r;)v.width-=p,v=v.parent;n+=p}}return n}function Hn(e,t){var n,r=t.utils,i=t.direction,o=t.fragments;i||(i=e.dir);for(var a=(0,C.gOt)(e,["alignHorizontal"]).alignHorizontal,s=function(e,t){if(!e.children)return{parent2index:new Map,parent2children:new Map};var n="",r=t.data,i=[],o=new Map,a=new Map;function s(t,n){i.push({index:t,renderObject:n});for(var r=n;r&&r.parent!==e;)r=r.parent;if(r){var s=o.get(r);s?s.push(n):o.set(r,[n]),a.set(n,r)}}for(var u=0,l=r.length;u<l;u++){var c=r[u];if(nn(c))for(var h=c.chunks,d=0,f=h.length;d<f;d++){var v=h[d];v.textWidth<=0||(s(n.length,v),n+="none"===v.dir?"LTR":v.props.content)}else{var g=c.renderObject;s(n.length,g),g.dir?n+="LTR":n+=" "}}for(var _=(0,C.rbG)(n,e.dir),y=(0,C.BAw)(n,_),m=0,E=y.length;m<E;m++){for(var b=y[m],T=[],S=0,w=0,R=i.length;w<R;w++){var A=i[w];b[0]<=A.index&&A.index<=b[1]&&(0===T.length&&(S=w),T.push(A))}T.length>1&&i.splice.apply(i,[S,T.length].concat((0,p.Z)(T.reverse())))}for(var O=new Map,M=0,k=i.length;M<k;M++){var I=i[M].renderObject,x=a.get(I);x&&!O.has(x)&&O.set(x,M)}return{parent2index:O,parent2children:o}}(e,o),u=s.parent2index,l=s.parent2children,c=0,h=null!==(n=e.children)&&void 0!==n?n:[],d=new Map,f=e.runtime.context.tempData.childStates,v=e.width,g=0,_=h.length;g<_;g++){var y=h[g],m=f.get(y),E=(0,C.S1Q)(y);if(d.set(y,E),c+=E.outerWidth,m){var b=m.lineStart,T=v-c,S=0;if("center"===a?S=.5*T:"right"===a&&(S=T),0===b&&("left"===a&&"ltr"===e.dir||"right"===a&&"rtl"===e.dir)){var w=xn(e,h[b],{lineIndex:b});S="ltr"===e.dir?S+w:S-w}for(var R=[],A=[],O=b,M=g+1;O<M;O++){var k,I=h[O],x=l.get(I);x&&A.push.apply(A,(0,p.Z)(x)),R.push({index:null!==(k=u.get(I))&&void 0!==k?k:O,renderObject:I})}R.sort((function(e,t){return e.index-t.index}));var N=Vn(A,{inlineFlowRo:e,utils:r});"center"===a?S+=.5*N:"right"===a&&(S+=N);for(var P=0,L=R.length;P<L;P++){var D,F=R[P].renderObject;if(F&&!(0,C.WAP)(F)){var B=null!==(D=d.get(F))&&void 0!==D?D:(0,C.S1Q)(F);(0,C.R_0)(F,"left",S+B.marginLeft),S=F.left+F.width+B.marginRight}}c=0}}}function Un(e){return!1===Bn?function(){return null}:e}var Zn=Fn,Wn=Hn;function jn(e,t){var n,r=e.rNode.getRenderTree();(0,C.hu8)(r,"Render tree does not exist!");var i=(0,E.wX)(r,t),o=null==i?void 0:i.reduce((function(e,t){var n=t.element;return n&&e.push((0,C.F8u)(n)),e}),[]);return{target:o?o[0]:null,path:null!==(n=o)&&void 0!==n?n:[]}}function Gn(e,t){var n=e.getVisibleArea();if(!(0,C.fGt)(t,n))return{target:null,path:[]};var r=function(e,t,n){var r=e.getScrollStatus();return{x:t+r.scrollLeft,y:n+r.scrollTop}}(e.getRContext(),t.x,t.y);return jn(e,r)}function zn(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,C.ijY)(e)||(e=e.rNode.getRenderTree());var r=(0,C.$bs)(e),i=Yn(e,t,r.painter,n);return i&&Gt(i)}function Yn(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=(0,E.wX)(e,t),o=(0,C.kSo)(null!=i&&i.length?i[0]:e),a=(0,E.mZ)(t,o),s=Xn(o,a,n,r),u=jt(s);return u}function Xn(e,t,n,r){var i=e.height;return t.y<0?{node:e,offset:0}:t.y>=i?{node:e,offset:Math.max(1,(0,T.h1)(e))}:Qn(e,t,n,r)}function Kn(e,t,n,r){var i,o,a,s=null===(i=e.children)||void 0===i?void 0:i.filter(C.BJ0);if(null===(o=s)||void 0===o||!o.length)return{node:e,offset:0};var u=0,l=t.y,c=!(0,C.KhP)(l,0,e.height),h=c?E.Vi:E.vt;if(c){for(var d=l<0,f=s[d?0:s.length-1],p=(0,E.Fg)(f).top,v=[],g=0;g<s.length;g++){var _=s[d?g:s.length-g-1];if(p!==(0,E.Fg)(_).top)break;v.push(_)}d||v.reverse(),s=v}if(e.hasRTL&&(s=Array.from(s).filter((function(e){return e.width>0})).sort((function(e,t){var n,r;return(null!==(n=e.lineOffsetTop)&&void 0!==n?n:e.top)-(null!==(r=t.lineOffsetTop)&&void 0!==r?r:t.top)||e.left-t.left}))),u=(0,C.ry4)(s,(function(e){return h(e,t)})),a=s[u],(u===s.length||u>0&&"found"!==h(a,t))&&(a=s[--u]),u+1<s.length){var y=(0,E.Fg)(a);l>=y.top+y.height&&(a=s[u+1])}return r.isNotFirstInlineFlow=!0,function(e,t){if(!ln(e))return e;var n=dn(e);if(n){var r=n.renderPoint,i=n.fragments.inlineFlow.dir,o=n.chunks,a=n.renderPoint.node;if(!sn(t,a)){var s=cn(n),u=s.index,l=s.isStartEdge,c=s.isEndEdge,h=(0,C.ZX6)(a);if(u<0||!l&&!c)return e;if(l)for(var d=u,f=o.length;d<f;d++){if(un(i,o[d])){r.node=o[d],r.offset=0;break}var p,v;d===f-1&&(r.node=o[d],r.offset=null!==(p=null===(v=o[d].props.content)||void 0===v?void 0:v.length)&&void 0!==p?p:1/0)}else if(c)for(var g=u;g>=0;g--){var _=(0,C.ZX6)(o[g]);if(un(i,o[g])||(null==_?void 0:_.lineOffsetTop)!==(null==h?void 0:h.lineOffsetTop)){var y,m;r.node=o[g],r.offset=null!==(y=null===(m=o[g].props.content)||void 0===m?void 0:m.length)&&void 0!==y?y:1/0;break}}return r.node.dir===k.oZ.NONE&&(r.node=jt(r).node,r.offset=0),r}cn(n).isStartEdge}return e}(Qn(a,(0,E.WG)(t,a),n,r),e)}function qn(e){return function(t,n,r,i){var o,a=null===(o=t.children)||void 0===o?void 0:o.filter(C.BJ0);if(null==a||!a.length)return{node:t,offset:0};var s=(0,C.ry4)(a,(function(t){return e(t,n)})),u=a[s];return(s===a.length||s>0&&"found"!==e(u,n))&&(u=a[s-1]),Qn(u,(0,E.WG)(n,u),r,i)}}var $n=qn(E.Vi),Jn=qn(E.Nx);function Qn(e,t,n,r){var i;return null!==(i=e.children)&&void 0!==i&&i.length?(0,C.dh0)(e)&&!r.isNotFirstInlineFlow?Kn(e,t,n,r):(0,C.xC0)(e)?Jn(e,t,n,r):(0,C.NSX)(e)?$n(e,t,n,r):function(e,t,n,r){var i,o=null===(i=e.children)||void 0===i?void 0:i.filter(C.BJ0);if(null==o||!o.length)return{node:e,offset:0};for(var a=t.x,s=o[0],u=o.length-1;u>=0;u--){var l=o[u];if(a>=l.left){s=l;break}}return Qn(s,(0,E.WG)(t,s),n,r)}(e,t,n,r):(0,C.z0l)(e)?function(e,t,n,r){var i=t.x,o=e.textWidth,a=e.props.content;if((i="rtl"===e.dir?o-i:i)<=0)return{node:e,offset:0};if(i>=o)return{node:e,offset:a.length};for(var s=(0,C.gOt)(e,["zoom"]).zoom,u=(0,C.IJD)(e),l=new C.pcb(a),c=0,h=null,d=0,f=0;null!==(h=l.nextBreak())&&(f=o-(0,v.Yc)(n,a.slice(h),u,s).width,!(d<=i&&i<=f));)c=h,d=f;if(!h)return{node:e,offset:a.length};var p=f-d,g=r.align;switch(void 0===g?"auto":g){case"left":h=c;break;case"right":break;default:i<d+p/2&&(h=c)}return{node:e,offset:h}}(e,t,n,r):function(e,t,n){var r=n.align,i=0;switch(void 0===r?"auto":r){case"left":i=0;break;case"right":i=1;break;default:i=t.x<e.width/2?0:1}return{node:e,offset:i}}(e,t,r)}function er(e,t){var n=(0,C.$bs)(t).classifying,r=[];(0,g.hp)(e,(function(t){t.split(":").length===e.length&&r.push(t)}));var i=new Set;r.forEach((function(e){var t;(null!==(t=n.get(e))&&void 0!==t?t:[]).forEach((function(e){i.add(e)}))}));for(var o=Array.from(i),a=[],s=[t.eid];o.length&&s.length;){var u=s.pop(),l=(0,C.qxF)(t.root,u);if(l){var c=o.indexOf(u);if(c>-1&&(a.push(l),o.splice(c,1)),!o.length)break;for(var h=l.children,d=void 0===h?[]:h,f=d.length-1;f>=0;f-=1)s.push(d[f])}}return a}function tr(e,t){if(!t.length)return e;var n=(0,C.$bs)(e).classifying,r=(0,C.WGj)(e),i=[];(0,g.hp)(t,(function(e){e.split(":").length===t.length&&i.push(e)}));var o=[];i.forEach((function(e){var t,r=null!==(t=n.get(e))&&void 0!==t?t:[];o.push(r)}));for(var a=new Set(o.flat()),s=r;s&&a.size>0;){if(a.has(s._id))return(0,C.F8u)(s);s=s.parent}return null}var nr={};function rr(e){var t=(0,C.nq)(e.root);return null==t?void 0:t.getRContext()}function ir(e,t){var n=e.node,r=e.offset,i=(0,C.nq)(t.root),o=(0,C.rI8)(i,n.eid),a=(0,C.rI8)(i,t.eid),s=(0,C.pPf)(a),u=zt({node:o,offset:r});if(!s||!u)return!1;for(var l=u.node,c=(0,C.ZX6)(l),h=s.map((function(e){return(0,C.ZX6)(e)})),d=0;d<h.length;d++){var f=h[d];if((null==c?void 0:c.lineOffsetTop)===(null==f?void 0:f.lineOffsetTop)&&(null==c?void 0:c.parent)===(null==f?void 0:f.parent))return!0}return!1}function or(e){var t,n,r=(0,C.WGj)(e);if(!r)return null;var i=(0,C.LSh)(r);if(!i)return null;var o=i.runtime,a=null==o||null===(t=o.constraint)||void 0===t?void 0:t.inheritedStyle,s=(0,C.gOt)(i),u=(0,R.f0)({},null!==(n=a)&&void 0!==n?n:{});if(Object.keys(s).forEach((function(e){e.startsWith("__")||(u[e]=s[e])})),(0,C.ijY)(i,S.j2.Div))for(var l=0;l<S.BN.length;l++)delete u[S.BN[l]];return u}function ar(e,t){var n=(0,C.jJi)(e.style,t);n&&(e.style=(0,R.f0)({},t),(0,C.$bs)(e).rNode.operator.update(e,{style:n,props:[]}));var r=(0,C.yjm)(e);(0,C.TBD)(r)}["push","pop","shift","unshift","splice"].forEach((function(e){var t=Array.prototype[e];nr[e]=function(){var n;!1;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];null===(n=this[R.Ts])||void 0===n||n.push({type:e,args:i});var a=t.apply(this,i);return!0,a}}));var sr=function(){return window.PointerEvent},ur=function(e){return{clientX:e.clientX,clientY:e.clientY,screenX:e.screenX,screenY:e.screenY,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,altKey:e.altKey,metaKey:e.metaKey,button:e.button,buttons:e.buttons}};function lr(e,t){return new MouseEvent(e,ur(t))}function cr(e,t){var n=t.pointerId,r=t.pointerType,i=t.width,o=t.height,a=t.pressure,s=t.tangentialPressure,u=t.tiltX,l=t.tiltY,c=t.twist,h=t.isPrimary,d=sr();return d||(0,C._yM)(new TypeError),new d(e,(0,R.f0)({pointerId:n,pointerType:r,width:i,height:o,pressure:a,tangentialPressure:s,tiltX:u,tiltY:l,twist:c,isPrimary:h},ur(t)))}var hr=new Map,dr=function(e){return hr.get(e)},fr=function(e){hr.set(e.pointerId,e)},pr=new Map,vr=function(e,t){var n=pr.get(t);return!!n&&n.elementId===e.eid},gr=function(e){var t=pr.get(e);if(t){var n=(0,C.nq)(t.rootId).elementPool.get(t.elementId);if(n)return(0,C.F8u)(n)}};function _r(e,t){var n=pr.get(t);return!!n&&n.rootId===e.id}var yr=function(e,t){pr.set(e,{elementId:t.eid,rootId:t.root})},mr=function(e){return(0,C.nq)(e.root).rNode},Er=function(e){var t=e.pointerId,n=gr(t);n&&Cr(n,t)},br=function(e){sr()||(0,C._yM)(new Error("Do not support pointer events.")),mr(e).isHost||(0,C._yM)(new Error("Embed RNode does not support pointer capture."))};function Tr(e,t){var n,r;if(br(e),!vr(e,t)){Er({pointerId:t}),yr(t,e);var i=(0,C.$bs)(e);try{var o;null===(o=i.container)||void 0===o||o.setPointerCapture(t)}catch(e){(0,C._yM)(e)}!function(e){hr.delete(e)}(t),null===(n=i.container)||void 0===n||n.addEventListener("pointermove",fr),null===(r=i.container)||void 0===r||r.addEventListener("lostpointercapture",Er)}}function Cr(e,t){if(br(e),vr(e,t)){var n,r;!function(e){pr.delete(e)}(t);var i=mr(e),o=i.$contextInternal;null===(n=o.container)||void 0===n||n.removeEventListener("lostpointercapture",Er),null===(r=o.container)||void 0===r||r.removeEventListener("pointermove",fr);try{var a;null===(a=o.container)||void 0===a||a.releasePointerCapture(t)}catch(e){(0,C._yM)(e)}var s=function(e,t){var n=dr(e),r=n?cr("lostpointercapture",n):new(sr())("lostpointercapture",{pointerId:e});return t.createNativeEvent(r.type,r)}(t,i);o.getRContext().dispatchEvent(e,s),i.eventEmitter.trigger("lostpointercapture",[s])}}var Sr=new WeakMap,wr=function(e){var t=document.createElement("iframe"),n=document.createElement("div");t.style.position="absolute",t.style.top="-9999px",t.style.left="-9999px",t.onload=function(){var r;Sr.set(e,{iframe:t,textContainer:n}),e.once("destroy",(function(){document.body.removeChild(t),Sr.delete(e)})),null===(r=t.contentDocument)||void 0===r||r.body.appendChild(n)},document.body.appendChild(t)},Rr=function(e,t,n,r){var i,o,a=e.iframe,s=e.textContainer;if(0===t.length)return n;var u=null===(i=a.contentWindow)||void 0===i?void 0:i.getSelection();if(!u||!u.modify)return n;var l=null===(o=a.contentWindow)||void 0===o?void 0:o.document;if(!l)return n;s.textContent="1".concat(t,"1");var c=l.createRange();c.setStart(s.firstChild,n+1),c.setEnd(s.firstChild,n+1),u.removeAllRanges(),u.addRange(c),u.modify("move",r,"word");var h=u.anchorOffset;return Math.max(0,Math.min(s.textContent.length-2,h-1))};function Ar(e,t,n,r){var i=n,o=n;return"left"===r?(i=Rr(e,t,o,"left"),o=Rr(e,t,i,"right")):(o=Rr(e,t,i,"right"),i=Rr(e,t,o,"left")),[i,o]}function Or(e,t){for(var n=[e],r=!0,i="";n.length;){var o,a,s=n.pop();if(!(0,C.u9X)(s,[S.j2.Component,S.j2.Div,S.j2.Text,S.j2.InlineFlow])||((null===(o=s.children)||void 0===o?void 0:o.length)||0)>1){r=!1;break}(0,C.kKo)(s,S.j2.Text)&&(i=t?i+s.props.content:s.props.content+i),null!=s&&null!==(a=s.children)&&void 0!==a&&a.length&&n.push.apply(n,(0,p.Z)(t?s.children.slice().reverse():s.children))}return[i,r]}function Mr(e){for(;null!==(t=e.children)&&void 0!==t&&t.length;){var t;e=e.children[0]}return e}function kr(e,t){for(var n=0,r=0;r<e.length;r++){var i=e[r],o=i.node,a=i.offset;if(t<=(n+=a))return{node:Mr(o),offset:a-n+t}}return{node:Mr(e[0].node),offset:e[0].offset}}function Ir(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"right",r=t.node,i=t.offset;if(!(0,C.kKo)(r,S.j2.Text))return[t,t];for(var o=r,a=r.props.content,s=!0,u=!0,l=[{node:r,offset:a.length}];null!==(c=o)&&void 0!==c&&c.parent;){var c;if((0,C.kKo)(o.parent,S.j2.InlineFlow)){var h=o.parent.children,d=h.indexOf(o);if(s)for(var p=d+1;p<h.length;p++){var v=h[p],g=Or(v,!0),_=(0,f.Z)(g,2),y=_[0],m=_[1];if(a+=y,l.push({node:v,offset:y.length}),!m)break}if(u)for(var E=d-1;E>=0;E--){var b=h[E],T=Or(b,!1),w=(0,f.Z)(T,2),R=w[0],A=w[1];if(a=R+a,l.unshift({node:b,offset:R.length}),i+=R.length,!A)break}break}if(!(0,C.u9X)(o.parent,[S.j2.Component,S.j2.Div]))break;if(o.parent){var O=o.parent.children.indexOf(o);s=O===o.parent.children.length-1&&s,u=0===O&&u}o=o.parent}var M=Sr.get(e);if(!M)return[t,t];var k=Ar(M,a,i,n),I=(0,f.Z)(k,2),x=I[0],N=I[1];return[kr(l,x),kr(l,N)]}function xr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.props.content.length,n=(0,C.hb3)(e.props.content,t);return null!==n?n:Math.max(t-1,0)}function Nr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=new C.pcb(e.props.content.slice(t)),r=n.nextBreak();return t+(null!==r?r:1)}function Pr(e,t,n){var r,i=jt(e.endPoint),o=null===(r=zt(i))||void 0===r?void 0:r.node;if("boolean"==typeof(null==n?void 0:n.isFixedForward))t=n.isFixedForward;else if(o)for(var a=o;a;)if(a=a.parent,(0,C.six)(a,[S.j2.InlineFlow])&&![void 0,"none"].includes(a.dir)){"rtl"===a.dir&&(t=!t),n&&(n.isFixedForward=t);break}var s=Wt(Ur(i,!t));return Xt({startPoint:s,endPoint:s})}function Lr(e,t){for(var n,r=jt(e.endPoint),i=(0,C.$bs)(r.node),a=i.scroll,s=vn((0,R.f0)({},e,{startPoint:r,endPoint:r})),u=null===(n=zt(r))||void 0===n?void 0:n.node,l=a.scrollStatus,c=l.scrollLeft,h=l.scrollTop,d=u;d;){if(d.parent){if((0,C.dh0)(d.parent)){var f=d.parent,p=Zr(f,d),v=p.lines,g=p.targetLine+(t?1:-1),_=(0,E.BC)(f.element);if(g>=0&&g<v.length){var y=zn(i,{x:s.left+c,y:v[g].lineOffsetTop+_.top+h+1});if(y)return Xt({startPoint:y,endPoint:y})}}if((0,C.six)(d.parent,[S.j2.BlockFlow,S.j2.SuperList])){var m=function(){for(var e=d.parent.children.indexOf(d),n=null,r=null,o=null,a=t?e+1:e-1;a>=0&&a<d.parent.children.length;){var u=d.parent.children[a];if((0,C.mqG)((0,C.gOt)(u,["display"]))){var l=u.element;if((0,E.BC)(l).height>0){var f=t?C.ENg:C.ZvQ;if(r=f(l,(function(e){return(0,T.NY)(e)&&(0,C.kKo)(e,S.j2.Text)})),f(l,(function(e){if((0,T.NY)(e))if((0,C.kKo)(e.parent,S.j2.InlineFlow)){var t=(0,C.LSh)(e),n=(0,C.LSh)(e.parent);if(t&&n){var r=Zr(n,t).lines[0].renderObjects;r.length&&r.forEach((function(e){var t=(0,E.tZ)(e,e);if(o){var n=Math.min(o.left,t.left),r=Math.min(o.top,t.top),i=Math.max(t.width+t.left,o.width+t.left)-n,a=Math.max(t.height+t.top,o.height+t.top)-r;o={left:n,top:r,width:i,height:a}}else o=t}))}}else(0,C.kKo)(e,S.j2.BlockFlow)&&e.children.length&&(o=(0,E.BC)(e.children[0]));return!!o})),r){n=l;break}}}t?a++:a--}if(n&&r&&o){var p=(0,E.BC)(r),v=o,g=zn(i,{x:(s.left>v.left+v.width?v.left+Math.max(v.width-1,0):s.left)+c,y:p.top+h+(t?1:Math.max(p.height-1,0))});if(g)return(0,C.kKo)(g.node,S.j2.Text)||(g.node=r,g.offset=t?0:r.props.content.length),{v:{startPoint:g,endPoint:g,isCollapsed:!0,isBackward:!1}}}}();if("object"===(0,o.Z)(m))return m.v}}d=d.parent}return e}function Dr(e,t){var n=e.startPoint.node,r=(0,C.yjm)(n),i=(t?C.ZvQ:C.ENg)(r,(function(e){return(0,C.kKo)(e,S.j2.Text)&&(0,T.NY)(e)}));if(!i)return e;var o={node:i,offset:t?i.props.content.length:0};return{startPoint:o,endPoint:o,isCollapsed:!0,isBackward:!1}}function Fr(e,t){var n=e.startPoint,r=e.endPoint;if(e.isBackward){var i=[n,r];r=i[0],n=i[1]}var o=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=zt(jt(e));if(!n)return e;var r=n.node,i=(0,C.kSo)(r),o=[];if((0,C.dh0)(i)){var a=Zr(i,r),s=a.lines,u=a.targetLine;if(u<0)return e;o=s[u].renderObjects}else{var l;o=null!==(l=i.children)&&void 0!==l&&l.length?i.children:[i]}var c=o[t?0:o.length-1];return Gt(jt({node:c,offset:t?0:(0,C.xPU)(c,1)}))}(t?r:n,!t);return Xt({startPoint:t?n:r,endPoint:o})}function Br(e,t){var n=Pr(e,t);if(Ir){var r=e.endPoint;t&&(r=n.startPoint);var i=Ir((0,C.$bs)(r.node).getRContext(),r,t?"right":"left"),o=(0,f.Z)(i,2),a=o[0],s=o[1],u=t?s:a;return{startPoint:u,endPoint:u,isCollapsed:!0,isBackward:!1}}return n}function Vr(e,t){var n=Wr(e.endPoint,!t);return Xt({startPoint:n,endPoint:n})}function Hr(e,t){if(!e)return null;var n=t.mode,r=t.isRange,i=t.forward,o=$t(e);if(!o)return null;var a=(0,{char:Pr,word:Br,inline:Fr,line:Lr,para:Vr,doc:Dr}[n])(o,i,t);return o.endPoint=a.endPoint,r?a.isCollapsed||(o.startPoint=a.startPoint):o.startPoint=a.endPoint,o.isBackward=Zt(o),o.isCollapsed=Ut(o),Kt(o)}function Ur(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=jt(e),r=n.node,i=n.offset,o=(0,C.kKo)(r,S.j2.Text);if(o){if(!t&&i+1<r.props.content.length)return{node:r,offset:Nr(r,i)};if(t&&i>0)return{node:r,offset:xr(r,i)}}for(var a=i>=(0,C.xPU)(r,1),s=r.children.length?r.children[Math.min(i,r.children.length-1)]:r,u=t?C.YfM:C.aE1,l=a?(0,C.ojQ)(s):s,c=t&&a?l:u(l);c&&(!(0,C.u9X)(c,[S.j2.Text,S.j2.EmbedDOM,S.j2.Drawing])||!(0,T.NY)(c));)c=u(c);if(c){var h={node:c,offset:0},d=(0,C.kSo)(r);if((0,C.DWu)(c).includes(d)){if(!t&&a)return Ur(h,!1);if(t){if((0,C.kKo)(c,S.j2.Text))return h.offset=c.props.content.length,Ur(h,!0);h.offset=Math.max(0,c.children.length-1)}return h}if(0===i||a)return t&&(h.offset=(0,C.xPU)(c,1)),h}return{node:r,offset:t?0:(0,C.xPU)(r,1)}}function Zr(e,t){var n=e.children,r=void 0===n?[]:n;if(!r.length)return{lines:[],targetLine:-1};for(var i=[],o=[],a=t&&(0,C.DWu)(t,e),s=null==a?void 0:a[a.length-2],u=-1,l=r[0].lineOffsetTop,c=0;c<r.length;c++){var h=r[c];l!==h.lineOffsetTop&&(o.push({renderObjects:i,lineOffsetTop:l}),i=[],l=h.lineOffsetTop),i.push(h),u<0&&h===s&&(u=o.length)}return o.push({renderObjects:i,lineOffsetTop:l}),{lines:o,targetLine:u}}function Wr(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=zt(jt(e));if(!n)return e;var r=n.node,i=(0,C.kSo)(r);return Gt(jt({node:i,offset:t?0:(0,C.xPU)(i,1)}))}var jr={};function Gr(e){console.warn("[Roadster deprecated warn]: ".concat(e))}function zr(e){return jr.getRect||(Gr("getRect 已过时，请使用 getRectByElement 或 getRectByRange 替代"),jr.getRect=!0),(0,C.$wM)(e)||(0,C.kKo)(e)?(0,E.BC)(e):vn(e)}function Yr(e){var t=(0,C.WGj)(e);if(!t)return null;var n=(0,C.LSh)(t);if(!n)return null;var r=!1;return(0,C.ENg)(n,(function(e){if((0,C.dh0)(e)&&e.hasRTL)return r=!0,!0}),(function(e){if(!e.parent||(0,C.dh0)(e.parent))return!0})),r}function Xr(e){var t,n=function(e){return function(){function t(){(0,h.Z)(this,t),this.render=function(t,n){var r;return e.setElementTree(t),null===(r=e.pipeline)||void 0===r?void 0:r.render(t,n)},this.setColorToken=function(t){e.colorToken=t;var n=e.paintStatePool;n.size?(n.forEach((function(e){e.setColorToken(t)})),e.rNode.setColorToken(t)):e.painter.setColorMap(t)},this.use=function(){}}return(0,d.Z)(t,[{key:"renderToHtml",value:function(){return""}},{key:"dispatchEvent",value:function(){}},{key:"refresh",value:function(){e._destroyed||e.rNode.paint(e.painter,(0,E.EQ)(e))}},{key:"id",get:function(){return e.id}},{key:"elementTree",get:function(){return e.elementTree&&(0,C.F8u)(e.elementTree)}},{key:"root",get:function(){return e.elementTree&&(0,C.F8u)(e.elementTree)}},{key:"env",get:function(){return e.env}},{key:"canvas",get:function(){return e.canvas}},{key:"destroyed",get:function(){return e.destroyed}},{key:"container",get:function(){return e.container}},{key:"scroller",get:function(){return e.scroller}},{key:"destroy",get:function(){return e.destroy}},{key:"version",get:function(){return e.version}}]),t}()}(e),r=function(e,t){return function(e){function t(){return(0,h.Z)(this,t),(0,u.Z)(this,(0,l.Z)(t).apply(this,arguments))}return(0,c.Z)(t,e),(0,d.Z)(t,[{key:"devtools",get:function(){if(C.P6Y.isDevToolsEnabled())return{hitTest:E.wX,toRaw:C.IUU,setElementStyle:ar}}}]),t}(e)}(function(e,t){return function(e){function n(){var e,r;(0,h.Z)(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(r=(0,u.Z)(this,(e=(0,l.Z)(n)).call.apply(e,[this].concat(o)))).getVisibleArea=t.getVisibleArea.bind(t),r.resize=function(e,n){var r=t.config,i=t.elementTree;i.instance||(0,C._yM)("Call resize before render!"),e===r.maxContentWidth&&n===r.maxContentHeight||(r.maxContentWidth=e,r.maxContentHeight=n,i.instance.setStyle({maxWidth:e,maxHeight:n},(function(){t.rNode.eventEmitter.trigger("resize",[{width:e,height:n}])})))},r}return(0,c.Z)(n,e),n}(e)}(function(e,t){var n=t.rNode.eventEmitter,r=0;return function(e){function t(){var e,r;(0,h.Z)(this,t);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(r=(0,u.Z)(this,(e=(0,l.Z)(t)).call.apply(e,[this].concat(o)))).on=n.on.bind(n),r.off=n.off.bind(n),r.once=n.once.bind(n),r}return(0,c.Z)(t,e),(0,d.Z)(t,[{key:"isPointerEventsDisabled",value:function(){return(r&(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1))>0}},{key:"enablePointerEvents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.isPointerEventsDisabled(e)&&(r^=e)}},{key:"disablePointerEvents",value:function(){r|=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1}}]),t}(e)}(function(e,t){return function(e){function n(){var e,r;(0,h.Z)(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(r=(0,u.Z)(this,(e=(0,l.Z)(n)).call.apply(e,[this].concat(o)))).getElementByContentPoint=jn.bind(null,t),r.getElementByCanvasPoint=Gn.bind(null,t),r.getElementByEid=C.qxF.bind(null,t.id),r.getRectByElement=E.BC,r}return(0,c.Z)(n,e),(0,d.Z)(n,[{key:"hitTest",value:function(e){var n=zn(t,e);return n&&ht(n)}}]),n}(e)}((t=function(e,t){return function(e){function n(){var e,r;(0,h.Z)(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(r=(0,u.Z)(this,(e=(0,l.Z)(n)).call.apply(e,[this].concat(o)))).scrollTo=En.bind(null,t),r.scrollToViewport=bn.bind(null,t),r.getScrollStatus=E.lf.bind(null,t),r}return(0,c.Z)(n,e),n}(e)}(n,e),function(e){function t(){var e,n;(0,h.Z)(this,t);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(n=(0,u.Z)(this,(e=(0,l.Z)(t)).call.apply(e,[this].concat(i)))).getSelection=void 0,n.setSelection=void 0,n}return(0,c.Z)(t,e),t}(t)),e),e),e)),i=new r;return i.use=function e(t,n){var r,o=null!==(r=t(i,n))&&void 0!==r?r:Promise.resolve();return o.use=function(t,r){return e(t,n)},o},i}function Kr(e){var t=document.createElement("div");["relative","fixed","absolute"].includes(e.style.position)||(e.style.position="relative");var n=(0,b.$r)(e),r=n.paddingLeft,i=n.paddingRight;return t.className=R.fw,t.style.width="".concat(e.getBoundingClientRect().width-r-i,"px"),t.style.zIndex="-1",t.style.position="relative",e.prepend(t),t}var qr=0,$r=function(){function e(t){var n=this;(0,h.Z)(this,e),this.uuid=qr++,this.id=void 0,this.DPR=Ct(!0),this.elementTree=void 0,this.canvas=void 0,this.container=void 0,this.scroller=void 0,this.scroll=void 0,this.elementPool=new An,this.halfFullscreenElementList=[],this.paintStatePool=new Map,this.fragmentPool=new WeakMap,this.classifying=new Map,this.keyedEmbedDOMPool=new Map,this.embedDOMUnmountCountSet=new Set,this.rNode=void 0,this.rContext=void 0,this.env=void 0,this.config=void 0,this.rPainter=C.Cki,this.painter=void 0,this.reconcile=void 0,this.viewport=void 0,this.layoutBuffer=void 0,this.layoutEntryCollector=void 0,this.layerManager=void 0,this.isRenderTreeCompleted=!1,this.colorToken={},this.version=void 0,this._destroyed=!1,this.hasRendered=!1,this.unBindBaseEvent=void 0,this.destroy=function(){var e;n._destroyed=!0,n.rNode.eventEmitter.trigger("destroy",[]),n.clearPool(),null===(e=n.unBindBaseEvent)||void 0===e||e.call(n),n.scroll.destroy(),C.nE9.destroy(n.id,!1),n.layerManager.clearLayers(),(0,C.qFc)(),n.rNode.destroy(),n._removeScrollerPlaceholder()},this.clearPool=function(){n.elementPool.clear(),n.halfFullscreenElementList.length=0,n.keyedEmbedDOMPool.clear(),n.embedDOMUnmountCountSet.clear()},this._container=void 0,this._placeholder=void 0,this.layoutStrategy=Nt,this.builder=Dt,this.patcher=Ft,this.pipeline=void 0,this.id=t.id,this.rNode=t,this.version=R.nK,this.layerManager=new m.zs(this),this.viewport=new ot,this.layoutEntryCollector=new xt(this),this.layoutBuffer={top:200,bottom:200},C.nE9.register(this),this.rContext=this.getRContext()}return(0,d.Z)(e,[{key:"initConfig",value:function(e){var t,n=e.container,r=e.scroller,i=e.maxContentWidth,o=e.maxContentHeight;this.config=e,t=this.config.isRTLSupport,Bn=t,Zn=Un(Fn),Wn=Un(Hn),this.container=n,this.scroller=r,this.scroll=new Sn(this,r);var a=(0,C.azq)(wn,{style:{maxWidth:i,maxHeight:o}});a._id=this.elementPool.genIndex(),a.root=this.id,this.elementTree=a,this.reconcile=(0,g.RV)({operator:this.rNode.operator,eventEmitter:this.rNode.eventEmitter,$contextInternal:this}),this.initRender()}},{key:"initRender",value:function(){var e=(0,E.EQ)(this),t=e.width,n=e.height;C.wA2.composeRenderSideEffects();var r=this.layerManager.initLayer(this.container,"BOTTOM",{width:t,height:n,left:0,top:0});this.canvas=r,this.painter=r.getContext("2d"),this.env={browser:{canvas:r},isSSR:!1},this.rNode.initEnv(this.env),this._container=r.parentElement,this.rNode.isHost&&(this._placeholder=Kr(this._container))}},{key:"setElementTree",value:function(e){this.elementTree.props.children=[e],this.hasRendered&&(0,C.p0Y)(this.elementTree)}},{key:"getRContext",value:function(){return this.rContext?this.rContext:Xr(this)}},{key:"_updateScrollerPlaceholder",value:function(){if(this._placeholder){var e=this.rNode;this._placeholder.style.height="".concat(e.getRenderTree().height,"px"),this._placeholder.style.width="".concat(e.getRenderTree().width,"px")}}},{key:"_removeScrollerPlaceholder",value:function(){var e;this._placeholder&&(null===(e=this._placeholder.parentElement)||void 0===e||e.removeChild(this._placeholder))}},{key:"getVisibleArea",value:function(){return"left"in this.rNode.paintArea?this.rNode.paintArea:(0,E.EQ)(this)}},{key:"destroyed",get:function(){return this._destroyed}},{key:"maxContentWidth",get:function(){return this.config.maxContentWidth}},{key:"maxContentHeight",get:function(){return this.config.maxContentHeight}}]),e}();function Jr(e){var t=new At,n=new $r(t);return n.initConfig(e),t.setContext(n),new Mt({rNode:t,rNodeContext:n}).initListener(),n.getRContext()}var Qr={update:function(e,t){var n={rNode:C.kRo,RNode:C.kRo,RNodeProps:C.kRo},r=(0,C.NT5)(n,e,t.props),i=(0,C.eQi)(e,t);return i.collectToTempEntry=i.collectToTempEntry||r,i}},ei=(C.wA2,[0,0,1,1]),ti=function(e){return!e||e.every((function(e){return!e}))?ei:e};var ni={buildContext:function(e){return(0,C.TpM)(e)},computeStyle:function(e,t){var n=(0,C.j2w)(t),r=n.maxWidth,i=n.maxHeight,o=n.inheritedStyle,a=(0,C.R3e)(e);(0,E.tw)(["zoom"],e,a,void 0,o),D(e,a,r,o),F(e,a,i,o),H(e,a,o),function(e,t){(0,C.WXx)(e,"fit",t.fit)}(e,a),function(e,t){(0,C.WXx)(e,"position",t.position)}(e,a)},wrapup:function(e,t){var n,r,i=t.maxWidth,o=t.minWidth,a=t.maxHeight,s=t.minHeight,u=e.props,l=u.source,c=u.crop,h=void 0===c?[0,0,1,1]:c,d=(0,R.hj)(null==l?void 0:l.width)?l.width:0,p=(0,R.hj)(null==l?void 0:l.height)?l.height:0,v=ti(h),g=(0,f.Z)(v,4),_=g[0],y=g[1],m=g[2],E=g[3],b=(0,C.gOt)(e),T=b.width,S=b.height;d*=m-_;var w,A,O,M,k=(p*=E-y)?d/p:1;(0,R.hj)(T)&&(w=T,A=null!==(O=A)&&void 0!==O?O:T/k);(0,R.hj)(S)&&(w=null!==(M=w)&&void 0!==M?M:S*k,A=S);w=(0,C.vXR)(null!==(n=w)&&void 0!==n?n:d,o,i),A=(0,C.vXR)(null!==(r=A)&&void 0!==r?r:p,s,a),(0,C.ryg)(e,{width:w,height:A})}};var ri=function(e,t){var n,r=t.clips,i=t.source,o=t.dest,a=t.data,s=t.opacity,u=null!==(n=null!=r&&r.length?r.map((function(t){return function(e,t){var n=t.rect,r=t.radius;if(n||r){if(e.save(),e.beginPath(),n){var i=n.left,o=n.top,a=n.width,s=n.height;e.rect(i,o,a,s),e.clip()}return r&&((0,C.ZyQ)(e,r),e.clip()),function(){return e.restore()}}}(e,t)})).reduce((function(e,t){return function(){null==t||t(),null==e||e()}})):void 0)&&void 0!==n?n:R.ZT;e.globalAlpha=s,e.drawImage(a,i.left,i.top,i.width,i.height,o.left,o.top,o.width,o.height),u()},ii=function(){function e(){(0,h.Z)(this,e),this.cmds={}}return(0,d.Z)(e,[{key:"onPush",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:re,n=this.cmds[t];n||(this.cmds[t]=n=[]),n.push(e)}},{key:"onFlush",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:re,n=this.cmds[t];n&&(e.save(),n.forEach((function(t){0!==t.data.width&&ri(e,t)})),e.restore(),n.length=0)}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re;delete this.cmds[e]}},{key:"clearAll",value:function(){this.cmds={}}}]),e}();(0,A.o)(ii,"type",4);function oi(e,t){var n=e.el,r=(0,C.LSh)(n);return!(!(0,C.kKo)(n,S.j2.Bitmap)||!r||n.props.source===(null==r?void 0:r.props.source))&&(r.props.source=n.props.source,(0,C.kRo)(e,t))}var ai={layout:ni,paint:{didPaint:function(e){var t,n=e.painter,r=e.rect,i=e.renderObject,o=i.props,a=o.source,s=o.crop;if(a){var u=ti(s),l=(0,f.Z)(u,4),c=l[0],h=l[1],d=l[2],p=l[3],v=r.left,g=r.top,_=r.width,y=r.height,m=i.style,b=m.fit,T=void 0===b?"none":b,S=m.position,w=[],R=a.width,A=a.height,O=c*R,M=h*A,k=v,I=g,x=_,N=y,P=(R*=d-c)/(A*=p-h),L=_/y;if("none"!==T?("fill"===T?(x=_,N=y):"contain"===T||"scale-down"===T&&(_<R||y<A)?L>P?(N=y,x=y*P):(x=_,N=_/P):"cover"===T&&(L>P?(x=_,N=_/P):(N=y,x=y*P)),k=v+.5*(_-x),I=g+.5*(y-N)):(x=R,N=A,k=v-(R-_)/2,I=g-(A-y)/2),S)switch(S){case"left":k=v;break;case"top":I=g;break;case"bottom":I=g-(N-y);break;case"right":k=v-(x-_);break;case"bottom left":k=v,I=g-(N-y);break;case"bottom right":I=g-(N-y),k=v-(x-_);break;case"top left":I=g,k=v;break;case"top right":I=g,k=v-(x-_)}var D={left:k,top:I,width:x,height:N};(0,C.xuz)(r,D)||w.push({rect:{left:v,top:g,width:_,height:y}});var F=null!==(t=(0,C.mhq)(n,i))&&void 0!==t?t:[],B=(0,f.Z)(F,1)[0];if(B&&B.style&&(0,C.s7M)(B.style)){var V=(0,E.V0)(B);(0,E.IN)(V,B.style,V),(0,C.xuz)(V,r)||w.push({rect:{left:B.x,top:B.y,width:B.width,height:B.height},radius:(0,C.KwJ)(B.x,B.y,B.width,B.height,B.style)})}C.p5R.push({type:4,data:a,clips:w,source:{left:O,top:M,width:R,height:A},dest:D,opacity:1})}},paintSelection:function(e){var t=e.painter,n=e.renderObject,r=e.rect,i=e.range,o=e.nodePosition,a=(0,f.Z)(i,2);if(!(a[0]>=a[1])){var s=(0,C.kSo)(n),u=he(n,s),l=u.outerTop,c=u.outerBottom,h=u.outerLeft,d=u.outerRight,p=u.marginLeft,v=u.marginRight,g=h-(1&o?p:0),_=d-(2&o?v:0),y={left:r.left-g,top:r.top-l,width:g+r.width+_,height:l+r.height+c};if(y.width&&y.height){var m=(0,C.mhq)(t,s),E=(0,f.Z)(m,1)[0],b=(0,C.AQ7)([y,{left:E.x,top:E.y,width:E.width,height:E.height}]),T=(0,R.f0)({type:1,fill:C.oV2.color,opacity:t.globalAlpha},b);C.p5R.push(T,"selection")}}},commandPlugins:[ii,be,ie]},mutate:{update:function(e,t){var n={lineWrap:C.LBn,asOneChar:C.LBn,selectable:C.K0Q,source:oi,crop:C.EZo},r=(0,C.NT5)(n,e,t.props),i=(0,C.eQi)(e,t);return i.collectToTempEntry=i.collectToTempEntry||r,i}}},si=function(e){function t(){return(0,h.Z)(this,t),(0,u.Z)(this,(0,l.Z)(t).apply(this,arguments))}return(0,c.Z)(t,e),(0,d.Z)(t,null,[{key:"composeRenderSideEffects",value:function(){(0,C.UaJ)(S.j2.Bitmap,ai)}},{key:"key",get:function(){return S.j2.Bitmap}}]),t}(C.wA2),ui={layout:{buildContext:function(e){return(0,C.TpM)(e)},computeStyle:function(e,t){var n=(0,C.j2w)(t),r=n.maxWidth,i=n.maxHeight,o=n.inheritedStyle,a=(0,C.R3e)(e);(0,E.tw)("zoom",e,a,void 0,o),D(e,a,r,o),F(e,a,i,o),H(e,a,o)},wrapup:function(e,t){var n,r,i=t.maxWidth,o=t.minWidth,a=t.maxHeight,s=t.minHeight,u=(0,C.gOt)(e),l=u.width,c=u.height;(0,C.ryg)(e,{width:(0,C.PuD)(null!==(n=l)&&void 0!==n?n:"auto",0,o,i),height:(0,C.PuD)(null!==(r=c)&&void 0!==r?r:"auto",0,s,a)})}},paint:{willPaint:function(e){var t,n,r,i,o,a,s,u,l=e.painter,c=e.renderObject,h=e.rect,d=e.colorConverter,f=c.width,p=c.height;if(0!==c.width&&0!==c.height){var v=h.left,g=h.top;(0,C.$vD)(l,c,h),null===(t=l.setKeepSaveNum)||void 0===t||t.call(l);var _,y=null!==(n=c.style.fontColor)&&void 0!==n?n:null===(r=c.runtime)||void 0===r||null===(i=r.context)||void 0===i||null===(o=i.inheritedStyle)||void 0===o?void 0:o.fontColor,m=y;if(d)m=d(y);else m=null!==(_=l.getColorByToken(y))&&void 0!==_?_:y;null===(a=(s=c.props).draw)||void 0===a||a.call(s,{ctx:l,fontColor:m,left:v,top:g,width:f,height:p}),null===(u=l.restoreIfNeed)||void 0===u||u.call(l)}},didPaint:function(e){var t=e.painter,n=e.renderObject;0!==n.width&&0!==n.height&&(0,C.S3r)(t,n)},paintSelection:function(e){var t=e.painter,n=e.renderObject,r=e.rect,i=e.range,o=e.nodePosition,a=(0,f.Z)(i,2);if(!(a[0]>=a[1])){var s=(0,C.kSo)(n),u=he(n,s),l=u.outerTop,c=u.outerBottom,h=u.outerLeft,d=u.outerRight,p=u.marginLeft,v=u.marginRight,g=h-(1&o?p:0),_=d-(2&o?v:0),y={left:r.left-g,top:r.top-l,width:g+r.width+_,height:l+r.height+c};if(y.width&&y.height){var m=(0,C.mhq)(t,s),E=(0,f.Z)(m,1)[0],b=(0,C.AQ7)([y,{left:E.x,top:E.y,width:E.width,height:E.height}]),T=(0,R.f0)({type:1,fill:C.oV2.color,opacity:t.globalAlpha},b);C.p5R.push(T,"selection")}}},commandPlugins:[ie]},mutate:{update:function(e,t){var n={lineWrap:C.LBn,asOneChar:C.LBn,selectable:C.K0Q,draw:C.EZo},r=(0,C.NT5)(n,e,t.props),i=(0,C.eQi)(e,t);return i.collectToTempEntry=i.collectToTempEntry||r,i}}},li=function(e){function t(){return(0,h.Z)(this,t),(0,u.Z)(this,(0,l.Z)(t).apply(this,arguments))}return(0,c.Z)(t,e),(0,d.Z)(t,null,[{key:"composeRenderSideEffects",value:function(){(0,C.UaJ)(S.j2.Drawing,ui)}},{key:"key",get:function(){return S.j2.Drawing}}]),t}(C.wA2),ci={buildContext:function(e){return(0,C.TpM)(e,["width"],!0)},createChildConstraint:function(e,t){var n=t.runtime;(0,C.gRG)(n,(0,C.iDd)(e)),(0,C.gRG)(n,S.ql)},wrapup:function(e,t){var n,r=t.maxWidth,i=t.minWidth,o=t.maxHeight,a=t.minHeight,s=t.isWeakWidth,u=(0,C.gOt)(e).marginCollapse,l=e.children,c=0,h=0,d=0;if(null!=l&&l.length)for(var f=0;f<l.length;f++){var p=l[f];if(!(0,C.WAP)(p))if((0,C.mqG)((0,C.gOt)(p))){var v=(0,C.idt)(p),g=v.outerWidth,_=v.outerHeight,y=v.marginLeft,m=v.marginTop,E=v.marginBottom;if((0,C.ryg)(p,{left:y,lineOuterHeight:_}),u)h+=Math.max(m,f?c:0),(0,C.R_0)(p,"top",h),h+=p.height,c=E;else(0,C.R_0)(p,"top",h+m),h+=_;d=Math.max(d,g)}else(0,C.ryg)(p,{left:0,lineOuterHeight:0,top:h+c})}u&&(h+=c);var b=(0,C.gOt)(e,["width"]).width;(0,C.ryg)(e,{width:(0,C.PuD)(null!==(n=b)&&void 0!==n?n:r===1/0?"auto":r,d,i,r,s),height:(0,C.PuD)("auto",h,a,o)}),function(e){var t;if(null===(t=e.children)||void 0===t||!t.length)return;var n=(0,C.gOt)(e,["alignHorizontal"]).alignHorizontal;if(n){var r=e.width;"center"===n?e.children.forEach((function(e){(0,C.R_0)(e,"left",r/2-e.width/2)})):"right"===n&&e.children.forEach((function(e){var t=(0,C.S1Q)(e),n=t.outerWidth,i=t.marginLeft;(0,C.R_0)(e,"left",r-n+i)}))}}(e)},computeStyle:function(e,t){var n=(0,C.j2w)(t),r=n.maxWidth,i=n.inheritedStyle,o=(0,C.R3e)(e);(0,E.tw)("zoom",e,o,void 0,i),D(e,o,r,i),(0,E.tw)(["minWidth","maxWidth"],e,o,r,i),(0,E.tw)(["alignHorizontal","marginCollapse","display"],e,o),B(e,o)}};var hi=function(e){function t(){return(0,h.Z)(this,t),(0,u.Z)(this,(0,l.Z)(t).apply(this,arguments))}return(0,c.Z)(t,e),(0,d.Z)(t,null,[{key:"composeRenderSideEffects",value:function(){(0,C.UaJ)(S.j2.BlockFlow,{layout:ci})}},{key:"key",get:function(){return S.j2.BlockFlow}}]),t}(C.wA2);function di(e,t,n,r){var i,o=(0,C.gOt)(t,["zoom"]).zoom,a=function(e,t){var n=(0,R.hj)(e),r=!1;if("string"==typeof e){var i=(e=e.trim())[e.length-1];(n=i>="0"&&i<="9")?e=parseFloat(e):r="%"===i}if(n||r){var o=e;return n&&(o="".concat(100*e,"%")),o}var a,s=(0,C.jFX)(e,{});if((0,R.hj)(s))return s*(null!==(a=t)&&void 0!==a?a:1)}(null!==(i=null==n?void 0:n[e])&&void 0!==i?i:null==r?void 0:r[e],o);void 0!==a&&(0,C.WXx)(t,e,a)}function fi(e,t){var n=e.height,r=e.baseline;switch(t){case"top":return 0;case"bottom":return n;case"middle":return n/2;default:if(!r){var i=(0,C.gOt)(e,["baselineOffset"]).baselineOffset;return"number"==typeof i?n+i:n}return r}}function pi(e,t){var n,r=e.children;return null===(n=r)||void 0===n||!n.length||(0,C.dh0)(e)&&void 0!==e.baseline?fi(e,t):(r=r.filter(C.HSn)).length?vi(r,t).alignLine:fi(e,t)}function vi(e,t){for(var n=0,r=new Array(e.length),i=0;i<e.length;i++){var o=e[i];r[i]=o.top+pi(o,t),n=Math.max(n,r[i])}return{alignLine:n,childAlignLines:r}}function gi(e,t){var n,r=t.lineHeight,i=t.force,o=t.maxFontSize,a=t.contentHeight;(0,R.HD)(r)&&r.endsWith("%")?n=o*(.01*parseFloat(r)):n=(0,R.hj)(r)?r:a;var s=i?n:Math.max(n,a),u=.5*(s-a);!i&&(u=Math.max(u,0));for(var l=0;l<e.length;l++){var c=e[l];(0,C.R_0)(c,"lineOuterHeight",s),(0,C.R_0)(c,"top",c.top+u)}return{lineOuterHeight:s,halfGap:u}}function _i(e){for(var t=0,n=function e(n){if((0,C.dh0)(n)){var r=n.runtime;if(null!=r&&r.context)return void(t=Math.max(r.context.maxFontSize,t))}var i=(0,C.gOt)(n,["fontSize"]).fontSize;(0,R.hj)(i)&&(t=Math.max(i,t));var o=n.children;if(null!=o&&o.length)for(var a=0;a<o.length;a++){var s=o[a];(0,C.HSn)(s)&&e(s)}},r=0;r<e.length;r++){var i=e[r];(0,C.HSn)(i)&&n(i)}return t}function yi(e,t,n){var r=(0,C.IJD)(e),i=r.fontFamily,o=r.fontSize,a=n.measureFont(i,o),s=a.fontHeight,u=a.fontAscent,l=t.map((function(e){return e.top})).reduce((function(e,t){return Math.min(e,t)}),1/0);return{top:l===1/0?0:l,style:r,height:s,baseline:u}}var mi=function(e){var t,n,r,i,o,a,s,u,l;n=(t=e).renderObject,r=t.renderObjectAtLast,i=t.maxWidth,o=t.isWeakWidth,a=n.runtime.context.tempData,s=(0,C.S1Q)(r),u=r.left+r.width+s.marginRight,l=Math.max(a.maxLineWidth,a.leftStart,u),o&&(l=Math.max(l,u)),a.maxLineWidth=!o&&i<l?i:l;var c=(0,C.gOt)(e.renderObject),h=c.leadingTop,d=void 0===h?0:h,f=c.leadingBottom,p={leadingTop:d,leadingBottom:void 0===f?0:f};!function(e,t){var n,r,i=t.leadingTop,o=e.renderObject,a=e.renderObjectAtLast,s=o.runtime.context.tempData,u=s.currLineStartIndex,l=null!==(n=null===(r=a.parent)||void 0===r?void 0:r.children)&&void 0!==n?n:[a],c=l.indexOf(a);if(!(u>c)){for(var h=s.heightSum+i,d=u;d<=c;d++){var f=l[d];(0,C.R_0)(f,"lineOffsetTop",h);var p=(0,C.gOt)(f,["marginTop"]).marginTop,v=void 0===p?0:p;(0,C.R_0)(f,"top",h+v)}var g=o.ellipsisRo;a===(null==g?void 0:g.extra.renderObjectAtLast)&&((0,C.R_0)(g,"lineOffsetTop",h),(0,C.R_0)(g,"top",h))}}(e,p),function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.leadingTop,i=void 0===r?0:r,o=n.leadingBottom,a=void 0===o?i:o,s=e.renderObjectAtLast,u=e.utils,l=e.renderObject,c=l.runtime.context.tempData,h=c.currLineStartIndex,d=null!==(t=l.children)&&void 0!==t?t:[s],f=d.indexOf(s);if(!(h>f)){var p=(0,C.gOt)(l,["alignVertical","forceLineHeight","lineHeight","zoom"]),v=p.alignVertical,g=void 0===v?"baseline":v,_=p.forceLineHeight,y=p.lineHeight,m=(p.zoom,d.slice(h,f+1)),E=l.runtime,b=l.ellipsisRo;s===(null==b?void 0:b.extra.renderObjectAtLast)&&m.push(b);var T=yi(l,m,u);m.push(T);for(var S=vi(m,g),w=S.alignLine,R=S.childAlignLines,A=_i(m),O=1/0,M=0,k=0;k<m.length;k++){var I=m[k];if((0,C.HSn)(I)){(0,C.R_0)(I,"top",I.top+w-R[k]);var x=(0,C.gOt)(I,["marginTop","marginBottom"]),N=x.marginTop,P=void 0===N?0:N,L=x.marginBottom,D=void 0===L?0:L;O=Math.min(O,I.top-P),M=Math.max(M,I.top+I.height+D)}}var F=M-O,B=F,V=0;if((0,C.IV7)(E.context)){var H,U=void 0!==_,Z=gi(m,{lineHeight:null!==(H=U?_:y)&&void 0!==H?H:F,force:U,maxFontSize:A,contentHeight:F});B=Z.lineOuterHeight,V=Z.halfGap}(0,C.W_L)(E,{maxFontSize:A}),(0,C.R_0)(l,"baseline",w+V),c.heightSum+=i+B+a}}(e,p)},Ei=function(e){mi(e),function(e){var t;(0,C.DSN)(e,"completedLinesCount",(null!==(t=e.completedLinesCount)&&void 0!==t?t:0)+1)}(e.renderObject.runtime)};var bi=function(e,t,n){var r=e.runtime.context.tempData;r.currLineStartIndex=t,r.leftStart=0,r.remainingWidth=n};function Ti(e){return!(!1===e.props.lineWrap||!(0,T.h1)(e)||!(0,C.six)(e,S.Rf))}var Ci=C.z0l,Si=function(e,t){for(var n=e;n&&n.parent!==t;)n=n.parent;return n},wi=function(e,t,n){var r,i=Si(e,t);if(i){var o=t.children,a=o.indexOf(i);if(a>0){for(var s,u=i.lineOffsetTop;a>0;){if(!(0,C.WAP)(o[a-1]))if(u!==o[a-1].lineOffsetTop){s=o[a-1];break}a--}if(s){var l=(0,C.ojQ)(s,(function(e){return!Ti(e)||(Ci(t=e)||function(e){var t=e.element;return!!t&&!!t.props.asOneChar}(t))||(0,C.WAP)(e);var t}));l&&(r=l)}}}r&&n(r,t)};function Ri(e){var t;if(!e)return null;if((0,C.z0l)(e))return e;var n=null===(t=e.children)||void 0===t?void 0:t.filter((function(e){return(0,C.HSn)(e)}));return 1===(null==n?void 0:n.length)&&Ti(n[0])?Ri(n[0]):null}function Ai(e,t,n){var r=(0,C.gOt)(e,["zoom"]).zoom,i=(0,R.f0)({},n,(0,C.IJD)(e));return t.measureTextWithZoom("...",(0,T.Hj)(i),r)}function Oi(e,t,n){for(var r=e.width,i=e.props.content,o=(0,C.gOt)(e,["zoom"]).zoom,a=(0,C.IJD)(e),s=(0,T.Hj)(a),u=r-t,l=new C.pcb(i),c=l.nextBreak(),h=0,d=0,f=0,p=0;null!==c;){var v=i.slice(0,c),g=n.measureTextWithZoom(v,s,o);if(g.width>u){h=d,f=p;break}d=c,p=g.width,c=l.nextBreak()}(0,C.ryg)(e,{width:f,textWidth:f}),(0,C.ryg)(e,{props:(0,R.f0)(e.props,{content:i.slice(0,h)})})}function Mi(e){var t=e.rootRenderObject,n=e.style,r=e.ellipsisWidth,i=e.ellipsisHeight,o=e.baseline,a=e.renderObjectAtLast,s=e.cutWith,u=void 0===s?0:s,l={root:t.root,element:t.element,type:S.j2.Text,parent:t,children:[],style:(0,R.f0)({},n),width:r,height:i,props:{selectable:!1,sourceStyle:{},content:"..."},top:a.top,left:a.left+a.width-u,textWidth:r,textHeight:i,baseline:o,extra:{renderObjectAtLast:a,cutWith:u}};t.ellipsisRo=l}function ki(e,t){var n=e.rootRenderObject,r=e.utils,i=e.isWeakWidth,o=e.maxWidth,a=n.runtime.context.tempData,s=Nn(n),u=kn(n,t,r),l=u.rightRo,c=u.leafRightRo;if(l){var h=Si(t.target,n),d=(0,C.cq5)(h);(0,C.LVC)(n,l,d+1),s.add(c),a.leftStart=h.left+h.width,Ei({renderObjectAtLast:h,renderObject:n,utils:r,maxWidth:o,isWeakWidth:i}),bi(n,d+1,o)}return{rightRo:l,leafRightRo:c}}function Ii(e){var t=e.rootRenderObject,n=e.remainingWidth,r=e.remainingHeight,i=void 0===r?0:r,o=e.utils,a=e.maxWidth,s=e.isWeakWidth,u=e.indent,l=void 0===u?0:u,c=t.runtime.context.tempData;c.childStates.clear();for(var h=Nn(t).data.reduce((function(e,t){return nn(t)?t.chunks.forEach((function(t){e.push({ro:t,type:0})})):e.push({ro:t.renderObject,type:1}),e}),[]),d=l,p=-1,v=null,g=null,_=0,y=0,m=function(){p++;var r=h[p],u=r.ro,m=r.type;if((0,C.WAP)(u)||u.isDestructed)return"continue";var b=Si(u,t),S=(0,C.cq5)(b),w=function(e,t){for(var n=(0,C.S1Q)(e),r=n.marginLeft,i=n.marginRight,o=e.parent,a=(0,C.cq5)(e);o&&o!==t&&!(a>0);){a=(0,C.cq5)(o);var s=(0,C.S1Q)(o);r+=s.paddingLeft+s.borderLeft+s.marginLeft,i+=s.paddingRight+s.borderRight+s.marginRight,o=o.parent}return[r,i]}(u,t),A=(0,f.Z)(w,2),O=A[0],M=A[1],k=(0,C.S1Q)(u),I={remainingWidth:n,remainingHeight:i-c.heightSum,committedLine:y,renderObject:b,rootRenderObject:t,utils:o};if(S&&function(e){var t=e.renderObject,n=e.rootRenderObject,r=e.remainingWidth,i=e.remainingHeight,o=e.committedLine;if(i<(0,C.S1Q)(t).outerHeight)return!0;var a=(0,C.gOt)(n,["maxLines"]).maxLines;if(!(0,R.hj)(a)||!a)return!1;var s=a-o;return s<=0||1===s&&r<(0,C.S1Q)(t).outerWidth&&!Ri(t)}(I)){var x,N=t.runtime.context,P=function(e){var t=e.rootRenderObject,n=e.inheritedStyle,r=e.index,i=e.utils,o=(0,C.gOt)(t,["overflowEllipsis","maxLines"]),a=o.overflowEllipsis;if(!o.maxLines&&!a)return!1;for(var s=t.children,u=s[r],l=u.left,c=u.width,h=(0,E.Fg)(s[r]),d=h.top,f=h.height,p=c+l,v=r+1;v<s.length;v++){var g=s[v],_=(0,C.gOt)(g,["marginTop","marginBottom"]),y=_.marginTop,m=_.marginBottom;(0,C.WXx)(g,"display",!1),(0,C.ryg)(g,{left:p,top:d+f,height:0,lineOffsetTop:d+f,lineOuterHeight:0}),y&&(0,C.WXx)(g,"marginTop",0),m&&(0,C.WXx)(g,"marginBottom",0)}if(!a)return!0;for(var b=0,T=null;r>=0;){var S=(T=s[r]).left,w=(0,C.S1Q)(T),A=w.innerWidth,O=w.marginLeft,M=(0,C.IJD)(T),k=M.fontFamily,I=M.fontSize,x=i.measureFont(k,I),N=x.fontHeight,P=x.fontAscent;if(b){var L=Ai(T,i).width;if(p-S-A>=L)return Mi({rootRenderObject:t,style:(0,R.f0)({fontSize:I,fontFamily:k},n,(0,C.gOt)(T)),ellipsisWidth:L,ellipsisHeight:N,baseline:P,renderObjectAtLast:T}),!0}if(A){var D=Ri(T);if(D){var F=Ai(D,i).width;if(F<A){var B=D.width;Oi(D,F,i);var V=T.width!==D.width?B-D.width:0;return Mi({rootRenderObject:t,style:(0,C.gOt)(D),ellipsisWidth:F,ellipsisHeight:N,baseline:P,renderObjectAtLast:T,cutWith:V}),!0}}}if((0,C.WXx)(T,"display",!1),!S||O===S)return!0;b=S,r--}}({rootRenderObject:t,inheritedStyle:null!==(x=null==N?void 0:N.inheritedStyle)&&void 0!==x?x:{},index:S-1,utils:o});if(P)return"break"}if(0===m&&(0,C.z0l)(u)){var L,D=null!==(L=u.props.content)&&void 0!==L?L:"",F=(0,C.gOt)(u,["zoom"]).zoom,B=(0,T.Hj)((0,C.IJD)(u)),V=o.measureTextWithZoom(D,B,F).width,H=v===u,U=!1;if(g!==b||H){var Z=d;(Z+=(0,C.S1Q)(b).marginLeft)>n?U=!0:(0,C.R_0)(b,"left",Z)}var W=O+V+M;if(d+W<n)return d+=W,v=u,g=b,"continue";var j=u.lineBreakerPosition,G=u.graphemeBreakerPosition,z=k.paddingLeft+k.borderLeft,Y=k.paddingRight+k.borderRight;d+=O+z;for(var X=function(r){var i=j[r],a=j[r+1],s=ve(u,i,a),f=o.measureTextWithZoom(s,B,F).width,m=r===j.length-2?Y+M:0;if(d+f+m<=n)return d+=f,K=r,"continue";if(!(O+z+f+m>n||0===y&&l&&l+O+z+f+m>n)||U){var E=0===i&&v,T=E&&v&&(0,C.z0l)(v)?(K=r,{type:1,target:v,pos:v.props.content.length}):E&&v&&!(0,C.z0l)(v)?(K=r,{type:0,target:v,pos:i}):(K=r,{type:1,target:u,pos:i}),S=Si(T.target,t),w=(0,C.cq5)(S);if(E){if(S===g){var R=In(t,{target:u},o),A=R.rightRo,k=R.lastTargetIndex;A&&(0,C.LVC)(t,A,k+1)}!function(e,t,n,r){var i=r.rootRenderObject,o=r.utils,a=r.maxWidth,s=r.isWeakWidth;i.runtime.context.tempData.leftStart=n.target.left+n.target.width,Ei({renderObjectAtLast:e,renderObject:i,utils:o,maxWidth:a,isWeakWidth:s}),bi(i,t+1,a)}(S,w,T,e),!H&&h.splice(p+1,0,{ro:u,type:0})}else{var I=ki(e,T).leafRightRo;h.splice(p+1,0,{ro:I,type:0})}return c.childStates.set(S===g?g:b,{lineStart:_,lineEnd:w}),d=0,_=w+1,y++,K=r,"break"}if(i>0){var x=ki(e,{type:1,target:u,pos:i}).leafRightRo;h.splice(p+1,0,{ro:x,type:0});var N=Si(u,t),P=(0,C.cq5)(N);return c.childStates.set(b,{lineStart:_,lineEnd:P}),d=0,_=P+1,y++,K=r,"break"}G||((0,C.E8)(u),G=u.graphemeBreakerPosition);for(var L=Math.max(0,G.indexOf(i)),D="rtl"===u.dir,V=L;V<G.length-1;V++){var Z=D?i:G[V],W=G[V+1],X=ve(u,Z,W,"end"),q=o.measureTextWithZoom(X,B,F).width,$=V===G.length-2?Y+M:0;if(!(d+q+$<=n||V===L)){var J={type:1,target:u,pos:G[V]},Q=ki(e,J).leafRightRo;h.splice(p+1,0,{ro:Q,type:0});var ee=(0,C.cq5)(b);c.childStates.set(b,{lineStart:_,lineEnd:ee}),d=0,_=ee+1,y++,r=j.length-1;break}(!D||V===L)&&(d+=q)}K=r},K=0;K<j.length-1;K++){var q=X(K);if("continue"!==q&&"break"===q)break}v=u,g=b}else{var $=u.width,J=O+$+M,Q=v===u;if(g!==b||Q){var ee=d;ee+=(0,C.S1Q)(b).marginLeft,(0,C.R_0)(b,"left",ee)}if(d+J<=n)return d+=J,v=u,g=b,"continue";var te,ne=Q?u:null!==(te=v)&&void 0!==te?te:u,re=Si(ne,t),ie=(0,C.cq5)(re);if(re===g){var oe=In(t,{target:u},o),ae=oe.rightRo,se=oe.lastTargetIndex;ae&&(0,C.LVC)(t,ae,se+1)}Ei({renderObjectAtLast:re,renderObject:t,utils:o,maxWidth:a,isWeakWidth:s}),bi(t,ie+1,a),!Q&&h.splice(p+1,0,{ro:u,type:1}),c.childStates.set(re,{lineStart:_,lineEnd:ie}),_=ie+1,y++,d=0,v=u,g=b}};p<h.length-1;){var b=m();if("continue"!==b&&"break"===b)break}}var xi=function(e){var t=e.renderObject,n=e.rootRenderObject,r=e.utils,i=e.indent,o=e.maxWidth,a=e.isWeakWidth,s=n.runtime.context.tempData;Ii({rootRenderObject:n,renderObject:t,indent:i,remainingWidth:s.remainingWidth,remainingHeight:s.remainingHeight,utils:r,maxWidth:o,isWeakWidth:a})},Ni=function(e){var t,n=e.renderObject,r=e.rootRenderObject,i=e.indent,o=(0,C.S1Q)(n),a=r.runtime.context.tempData;a.leftStart+=null!==(t=i)&&void 0!==t?t:0,(0,C.R_0)(n,"left",a.leftStart+o.marginLeft),a.leftStart+=o.outerWidth,a.remainingWidth=Math.max(0,e.maxWidth-a.leftStart)};function Pi(e){(0,w.vU)("".concat(e," 只支持以 px 为单位的字符串类型值"))}function Li(e){return/^\d+(\.\d+)?px$/.test(e)}var Di=new Set([void 0,"auto"]),Fi={buildContext:function(e){var t=e.runtime;(0,C.TpM)(e,["width","minWidth","maxWidth"]),(0,C.IV7)(t.context)&&function(e,t){(0,R.f0)(t.context,{fragments:new on({inlineFlow:e})})}(e,t);var n=t.context;if(null==n||!n.isWeakWidth){var r,i=(0,C.gOt)(e),o=i.weakWidth,a=i.minWidth;if(void 0!==o)(0,C.W_L)(t,{isWeakWidth:!0}),void 0===a&&void 0===(null===(r=t.constraint)||void 0===r?void 0:r.flexWidth)&&(0,C.W_L)(t,{minWidth:0})}var s=(0,C.IJD)(e).fontSize;(0,C.W_L)(t,{maxFontSize:s})},createChildConstraint:function(e,t){var n=e.runtime,r=n.constraint,i=n.context,o=i.maxWidth,a=i.fragments;(0,C.IV7)(i)||(a=null==r?void 0:r.fragments);var s=r.originMaxWidth,u=(0,C.VH$)(o,s),l=(0,f.Z)(u,2);o=l[0],s=l[1];var c=t.runtime;c&&(0,C.gRG)(c,(0,R.f0)({maxWidth:o,originMaxWidth:s,fragments:a,disableRTL:"none"===e.dir},S.mm))},wrapup:function(e,t,n){var r,i,o=t.maxWidth,a=void 0===o?0:o,s=t.minWidth,u=t.maxHeight,l=t.minHeight,c=t.isWeakWidth,h=t.fragments,d={currLineStartIndex:0,leftStart:0,maxLineWidth:0,remainingWidth:a,remainingHeight:u,heightSum:0,isChildrenReady:!0,childStates:new Map};t.tempData=d;var f=(null!==(r=e.children)&&void 0!==r?r:[]).filter((function(e){return(0,C.HSn)(e)}));if(f.length){var p=(0,C.IV7)(t),v=function(t){var r=f[t];p&&null!=h&&h.data.length&&Zn(e,h,n),null==h||h.compute();var i={renderObject:r,rootRenderObject:e,maxWidth:a,isWeakWidth:c,utils:n,isDomain:p,indent:t?0:xn(e,r,{lineIndex:t,maxWidth:a,isDomain:p})},o=r.runtime;if(!d.isChildrenReady||!(0,C.Ud)(o))return d.isChildrenReady=!1,void Ni(i);d.isChildrenReady=!0,(0,C.Drw)(r,"lineOuterHeight"),p?xi(i):Ni(i)};if(v(0),!p)for(var g=1;g<f.length;g++)v(g);f=e.children;var _=(0,R.Z$)(f.filter(C.HSn));if(_){var y=f.indexOf(_);d.currLineStartIndex<=y&&(Ei({renderObjectAtLast:_,utils:n,renderObject:e,maxWidth:a,isWeakWidth:c}),d.childStates.set(_,{lineStart:d.currLineStartIndex,lineEnd:y}))}}var m=d.maxLineWidth,E=d.heightSum,b=(0,C.gOt)(e),T=b.weakWidth,S=b.width;(0,C.ryg)(e,{width:c&&(0,R.hj)(T)?Math.max(m,s):(0,C.PuD)(null!==(i=S)&&void 0!==i?i:"auto",m,s,a,c),height:(0,C.PuD)("auto",E,l,u)}),(0,C.R3e)(e).alignHorizontal||(0,C.WXx)(e,"alignHorizontal","rtl"===e.dir?"right":"left"),e.hasRTL&&!1!==Bn&&(0,C.IV7)(t)&&h&&(null==h?void 0:h.data.length)>0?Wn(e,{utils:n,fragments:h}):function(e){var t,n,r=e.renderObject,i=(0,C.gOt)(r,["width","alignHorizontal","minWidth"]).alignHorizontal;if(i&&"left"!==i&&("center"===i||"right"===i)){var o=null!==(t=null===(n=r.children)||void 0===n?void 0:n.slice(0))&&void 0!==t?t:[],a=0,s=r.runtime.context.tempData.childStates;o.forEach((function(e){var t=s.get(e),n=(0,C.S1Q)(e);if(a+=n.outerWidth,t){var u=r.width-a,l="center"===i?.5*u:u;o.slice(t.lineStart,t.lineEnd+1).forEach((function(e){if(!(0,C.WAP)(e)){var t=(0,C.S1Q)(e);(0,C.R_0)(e,"left",l+t.marginLeft),l=e.left+e.width+t.marginRight}})),a=0}}))}}({renderObject:e,utils:n}),delete t.tempData},computeStyle:function(e,t){var n=(0,C.j2w)(t),r=n.inheritedStyle,i=n.maxWidth,o=(0,C.R3e)(e);(0,E.tw)(["alignHorizontal","alignVertical","zoom","maxLines","textIndent","overflowEllipsis","display"],e,o,void 0,r);var a=o,s=a.width,u=a.weakWidth,l=!1;if(!Di.has(u)&&Di.has(s)?(l=!0,o=(0,R.f0)({width:u},o)):(0,C.Jt)(e,"weakWidth"),D(e,o,i,r),(0,E.tw)(["minWidth","maxWidth"],e,o,i,r),l){var c=(0,C.gOt)(e,["width","maxWidth"]),h=c.width,d=c.maxWidth;(0,R.hj)(h)&&(!(0,R.hj)(d)||d>h?(0,C.WXx)(e,"weakWidth",h):((0,C.Jt)(e,"width"),(0,C.Jt)(e,"weakWidth")))}(0,E.tw)(["fontFamily"],e,o,void 0,(0,R.f0)({fontFamily:R.rk},r)),(0,C.p7o)(e,o,r),function(e,t,n){var r=t.forceLineHeight,i=t.lineHeight;void 0!==r?di("forceLineHeight",e,t,n):void 0!==i?di("lineHeight",e,t,n):n&&(void 0!==n.forceLineHeight?di("forceLineHeight",e,t,n):void 0!==n.lineHeight&&di("lineHeight",e,t,n))}(e,o,r),function(e,t,n){var r,i,o=null!==(r=null==t?void 0:t.leading)&&void 0!==r?r:null==n?void 0:n.leading;if(void 0!==o){if(!(0,R.HD)(o))return(0,C.t3u)(e,["leading"]),Pi("leading");var a=(0,C.nbD)(o),s=(0,f.Z)(a,2),u=s[0],l=s[1];if(l=l||u,!Li(u)||!Li(l))return(0,C.t3u)(e,["leading"]),Pi("leading");var c=null!==(i=(0,C.gOt)(e,["zoom"]).zoom)&&void 0!==i?i:1;(0,C.WXx)(e,"leadingTop",parseFloat(u)),(0,C.WXx)(e,"leadingBottom",parseFloat(l)*c)}}(e,o,r),(0,C.gOt)(e,["alignVertical"]).alignVertical||(0,C.WXx)(e,"alignVertical",R.Ng.alignVertical),B(e,o)}},Bi={didPaint:function(e){var t=e.renderObject,n=e.rect,r=e.painter,i=e.area,o=e.asRoot,a=t.ellipsisRo;if(a){var s={left:n.left+a.left,top:n.top+a.top,width:a.width,height:a.height};Te({rect:s,renderObject:a,painter:r,area:i,asRoot:o})}}},Vi=function(e,t){return function(e,t,n){for(var r=e;r&&r!==t;){var i=r.parent,o=i.children.indexOf(r);if(o<0)break;i.children.slice(o+1).forEach((function(e){n(e)})),r=i}}(e,t,C.Br9)},Hi=function(e,t){return function(e,t,n){for(;e&&e!==t;){n(e);var r=e.parent;if(r){if((0,C.WAP)(r))break;var i=r.runtime;i&&((0,C.eTE)(i)||Se(r)),e=r}}}(e,t,we)};function Ui(e,t){if((0,C.fGr)(t)){var n=(0,C.LSh)(t),r=(0,C.LSh)(e);Vi(e,t),Hi(r,n),wi(r,n,Hi)}}var Zi={markDirty:function(e,t,n,r,i,o){var a,s,u,l;switch(e.type){case"append":case"preappend":case"insertAfter":case"insertBefore":Ui(null!==(a=o)&&void 0!==a?a:n,t);break;case"moveAfter":case"moveBefore":case"moveToHead":case"moveToTail":Ui(null!==(s=i)&&void 0!==s?s:n,t);break;case"remove":!function(e,t){if((0,C.fGr)(t)){var n=(0,C.LSh)(t),r=(0,C.LSh)(e);if(r){var i=(0,C.FT5)(r);if(i){var o=i.element;Vi(o||e.parent,t)}else{var a;r.parent&&(0,C.oFe)(r.parent),null===(a=e.parent)||void 0===a||a.children.forEach((function(t){var n;(0,C.Br9)(t,null!==(n=e.parent)&&void 0!==n?n:void 0)})),Vi(e.parent,t)}Hi((0,C.LSh)(e),n),wi(r,n,Hi)}}}(null!==(u=o)&&void 0!==u?u:n,t);break;case"update":l=t,(0,C.fGr)(l)&&(0,C.oBy)(l)}return 3},update:function(e,t){var n={lineWrap:C.LBn,asOneChar:C.LBn,selectable:C.K0Q,asRelative:C.K0Q},r=(0,C.NT5)(n,e,t.props),i=(0,C.eQi)(e,t);return t.style&&(0,C.oBy)(e.el),{collectToTempEntry:i.collectToTempEntry||r}}},Wi=function(e){function t(){return(0,h.Z)(this,t),(0,u.Z)(this,(0,l.Z)(t).apply(this,arguments))}return(0,c.Z)(t,e),(0,d.Z)(t,null,[{key:"composeRenderSideEffects",value:function(){(0,C.UaJ)(S.j2.InlineFlow,{layout:Fi,paint:Bi,mutate:Zi})}},{key:"key",get:function(){return S.j2.InlineFlow}}]),t}(C.wA2),ji={buildContext:function(e,t){var n=t.getRootConstraint().maxWidth,r=e.runtime;r&&(0,C.W_L)(r,{maxWidth:n||1/0,maxHeight:1/0,minWidth:0,minHeight:0,isRelayoutBoundary:!0,individual:!0})},wrapup:function(e,t){var n=t.maxWidth,r=(0,C.IhD)(e);(0,C.ryg)(e,{width:Math.min(n,r[0]),height:r[1]})},computeStyle:function(e,t){var n=(0,C.j2w)(t),r=n.maxWidth,i=n.maxHeight,o=n.inheritedStyle,a=(0,C.R3e)(e);(0,E.tw)(["zoom","display"],e,a,void 0,o),(0,E.tw)(["left","right"],e,a,r),(0,E.tw)(["top","bottom"],e,a,i),(0,E.tw)("zIndex",e,a,0),(0,E.tw)("display",e,a),B(e,a)}},Gi=function(e){return e.asRoot?void 0:2},zi=function(e){function t(){return(0,h.Z)(this,t),(0,u.Z)(this,(0,l.Z)(t).apply(this,arguments))}return(0,c.Z)(t,e),(0,d.Z)(t,null,[{key:"composeRenderSideEffects",value:function(){(0,C.UaJ)(S.j2.Absolute,{layout:ji,paint:{paintInterceptor:Gi}})}},{key:"key",get:function(){return S.j2.Absolute}}]),t}(C.wA2);C.wA2;function Yi(e){var t=e.flexGrow;return(0,R.hj)(t)?t:0}function Xi(e){var t=e.flexShrink;return(0,R.hj)(t)?t:1}function Ki(e,t){var n,r,i={indices:[],size:[],totalSize:0},o={indices:[],sum:0,size:[],totalSize:0,margin:[],totalMargin:0},a={indices:[],size:[],totalSize:0},s={indices:[],sum:0,size:[],totalSize:0,margin:[],totalMargin:0},u=[],l=[],c=(0,C.gOt)(e,["zoom"]).zoom,h=(0,C.ijY)(e,S.j2.FlexRow),d=t.maxWidth,p=t.maxHeight;h?(n=["marginLeft","marginRight"],r={maxWidth:d}):(n=["marginTop","marginBottom"],r={maxHeight:p});var v=e.children;null==v||v.forEach((function(e,t){if(!(0,C.WAP)(e)){var h=(0,C.R3e)(e),p=Yi(h),v=Xi(h);if(p?(o.indices.push(t),o.sum+=p):(i.indices.push(t),u[t]=r),v?(s.indices.push(t),s.sum+=v):(a.indices.push(t),l[t]=r),(p||v)&&(0,C.HLQ)(e.type)){var g=(0,R.f0)({},h);(0,C.Bwo)(g);var _=h.zoom,y=void 0===_?c:_,m=n.map((function(e){var t;return null!==(t=(0,C.jFX)(g[e],{"%":d},y))&&void 0!==t?t:0})),E=(0,f.Z)(m,2),b=E[0],T=E[1];p&&(o.margin.push([b,T]),o.totalMargin+=b+T),v&&(s.margin.push([b,T]),s.totalMargin+=b+T)}}}));var g={nonGrow:i,grow:o,nonShrink:a,shrink:s,growLimit:u,shrinkLimit:l,originCrossSize:new Map};return o.indices.length?i.indices.length||qi(e,(0,R.f0)({flexCtx:g},t)):s.indices.forEach((function(e){l[e]=r})),g}function qi(e,t){var n=t.maxWidth,r=t.minWidth,i=t.maxHeight,o=t.minHeight,a=t.flexCtx,s=a.nonGrow,u=a.grow,l=a.growLimit,c=a.shrinkLimit;if(!u.indices.length)return!0;var h,d=(0,C.ijY)(e,S.j2.FlexRow),p=d?[n,r]:[i,o],v=(0,f.Z)(p,2),g=v[0],_=v[1],y=g-u.totalMargin-s.totalSize;return y<=0?(u.indices.forEach((function(e){c[e]=d?{maxWidth:n}:{maxHeight:i}})),!1):(h=g===_?function(e){return d?{maxWidth:e,flexWidth:e}:{maxHeight:e,flexHeight:e}}:function(e){return d?{maxWidth:e}:{maxHeight:e}},u.indices.forEach((function(t){var n=Yi((0,C.R3e)(e.children[t]))*y/u.sum;l[t]=h(n)})),!0)}function $i(e){var t,n=null===(t=e.tempData)||void 0===t?void 0:t.type;return 1===n||2===n}var Ji={buildContext:function(e){var t=e.runtime;(0,C.ER$)(e);var n=(0,C.gOt)(e),r=(0,C.snm)(e,n);(0,C.W_L)(t,(0,R.f0)({},r,{flexCtx:Ki(e,r),individual:!0}))},createChildConstraint:function(e,t){var n=e.runtime,r=n.context,i=r.maxWidth,o=r.minWidth,a=r.maxHeight,s=r.minHeight,u=r.flexCtx,l=(0,C.gOt)(e,["alignCrossAxis"]).alignCrossAxis,c=(0,C.R3e)(t).alignSelf||l||"stretch",h=(0,C.cq5)(t),d=(0,C.ijY)(e,S.j2.FlexRow),f=function(e,t){return"stretch"===c&&e===t?e:void 0},p=t.runtime,v=u[$i(n.context)?"growLimit":"shrinkLimit"][h];(0,C.gRG)(p,(0,R.f0)({maxWidth:i,maxHeight:a,minWidth:null==v?void 0:v.flexWidth,minHeight:null==v?void 0:v.flexHeight,originMaxWidth:void 0},S.ql,d?{stretchHeight:f(a,s),stretchWidth:void 0}:{stretchWidth:f(i,o),stretchHeight:void 0},v))},computeStyle:function(e,t){var n=(0,C.j2w)(t),r=n.maxWidth,i=n.maxHeight,o=n.inheritedStyle,a=(0,C.R3e)(e);(0,E.tw)(["zoom","display"],e,a,void 0,o),D(e,a,r,o),(0,E.tw)(["minWidth","maxWidth"],e,a,r,o),F(e,a,i,o),(0,E.tw)(["minHeight","maxHeight"],e,a,i,o),(0,E.tw)(["alignMainAxis","alignCrossAxis","stretchDeep"],e,a,r),B(e,a)},transition:function(e,t,n,i,o){var a=n.tempData;if(a){var s,u=a.type,l=n.maxWidth,c=n.maxHeight,h=n.flexCtx,d=h.nonGrow,f=h.grow,p=h.nonShrink,g=h.shrink,_=h.shrinkLimit,y=Xi((0,C.R3e)(t)),m=(0,C.S1Q)(t),E=m.innerWidth,b=m.innerHeight,T=m.outerWidth,w=m.outerHeight,R={innerWidth:E,innerHeight:b,outerWidth:T,outerHeight:w},A=(0,C.ijY)(e,S.j2.FlexRow),O=l,M=T,k="maxWidth",I="innerWidth",x="flexWidth";switch(A||(O=c,M=w,k="maxHeight",I="innerHeight",x="flexHeight",t.lineOuterHeight=w),u){case 1:var N=Qi(d.indices,o);if(d.totalSize+=M,d.size[N]=R,y){var P=Qi(g.indices,o);g.totalSize+=M,g.size[P]=R}else{var L=Qi(p.indices,o);p.totalSize+=M,p.size[L]=R}break;case 2:var D=Qi(f.indices,o);f.totalSize+=M,f.size[D]=R;break;case 3:if(y){var F=Qi(g.indices,o);g.totalSize+=M,g.size[F]=R}else{var B=Qi(p.indices,o);p.totalSize+=M,p.size[B]=R}if(o===(f.indices.length?(s=f.indices).length?s[s.length-1]:0:e.children.length-1)){var V=O-g.totalSize-p.totalSize;if(V<0&&g.indices.length){var H=V/Math.max(g.sum,1);g.indices.forEach((function(t,n){var o,a=e.children[t],s=Xi((0,C.R3e)(a)),u=g.size[n][I]+s*H;_[t]=(o={},(0,r.Z)(o,k,u),(0,r.Z)(o,x,u),o),(0,v.Cb)(a,i)})),g.totalSize=0}}break;case 4:var U=Qi(g.indices,o);g.totalSize+=M,g.size[U]=R}}},wrapup:function(e,t){var n=t.maxWidth,r=t.minWidth,i=t.maxHeight,o=t.minHeight,a=t.flexCtx;if(t.tempData){var s=a.nonGrow,u=a.grow,l=a.nonShrink,c=a.shrink,h=$i(t),d=(0,C.ijY)(e,S.j2.FlexRow),p=d?[n,r,i,o]:[i,o,n,r],v=(0,f.Z)(p,4),g=v[0],_=v[1],y=v[2],m=v[3],E=0;if(g!==_){var b=0;b=h?s.totalSize+u.totalSize:l.totalSize+c.totalSize,E=Math.min(Math.max(b,_),g)}else E=g;var T=0;if(y!==m){var w=0,A=function(e){w=Math.max(w,d?e.outerHeight:e.outerWidth)};h?(s.size.forEach(A),u.size.forEach(A)):(l.size.forEach(A),c.size.forEach(A)),T=Math.min(Math.max(w,m),y)}else T=y;d?(0,C.ryg)(e,{width:E,height:T}):(0,C.ryg)(e,{width:T,height:E}),function(e,t,n){var r=e.width,i=e.height,o=e.children,a=null==o?void 0:o.length;if(!a)return;var s=t.nonGrow,u=t.grow,l=t.nonShrink,c=t.shrink,h=t.originCrossSize,d=(0,C.gOt)(e,["alignMainAxis","alignCrossAxis","stretchDeep"]),p=d.alignMainAxis,v=d.alignCrossAxis,g=d.stretchDeep,_=(0,C.ijY)(e,S.j2.FlexRow),y=n?s.totalSize+u.totalSize:l.totalSize+c.totalSize,m=(_?r:i)-y,E=function(){var e=0,t=0;if(m&&p&&"flex-start"!==p){var r=n?s.indices.length+u.indices.length:l.indices.length+c.indices.length;switch(p){case"center":e=m/2;break;case"space-between":t=m/(r-1);break;case"space-around":e=(t=m/r)/2;break;case"space-evenly":e=t=m/(r+1);break;case"flex-end":e=m}}return[e,t]}(),b=(0,f.Z)(E,2),T=b[0],w=b[1];h.clear();for(var A=function(e,t,n,r){var i;h.set(e,e[t]),(0,C.R_0)(e,t,e.parent[t]-n),(0,C.ijY)(e,S.j2.Div)&&G(e,null!==(i=r)&&void 0!==i?i:(0,C.R3e)(e))},O=function(t,n){var r,i=n.edge,o=n.innerSize,a=n.outerSize,s=n.sizeField,u=n.positionField,l=(0,C.R3e)(t);switch(l.alignSelf||v||"stretch"){case"center":r=(e[s]-a)/2;break;case"flex-end":r=e[s]-a;break;case"stretch":if(t[s]<=e[s]&&!(0,R.hj)((0,C.gOt)(t,[s])[s])&&(t[s]<e[s]&&A(t,s,a-o,l),g))for(var c=t;1===(null===(h=c.children)||void 0===h?void 0:h.length);){var h,d=c.children[0];if(d[s]>=c[s]||(0,R.hj)((0,C.gOt)(d,[s])[s])||(0,C.WAP)(d))break;var f=(0,C.S1Q)(d),p=f.outerWidth,y=f.outerHeight,m=f.innerWidth,E=f.innerHeight,b=void 0,T=void 0;_?(b=y,T=E):(b=p,T=m),A(d,s,b-T),c=d}r=0;break;default:r=0}t[u]=i+r},M=0,k=0;k<a;k++){var I=o[k];if(!(0,C.WAP)(I)){var x=(0,C.S1Q)(I),N=x.outerWidth,P=x.outerHeight,L=x.innerWidth,D=x.innerHeight,F=x.marginTop,B=x.marginLeft,V=void 0;M+=M?w:T,_?(I.left=M+B,M+=N,V={edge:F,innerSize:D,outerSize:P,sizeField:"height",positionField:"top"}):(I.top=M+F,M+=P,V={edge:B,innerSize:L,outerSize:N,sizeField:"width",positionField:"left"}),O(I,V)}}}(e,a,h),delete t.tempData}},willLayout:function(e,t){var n=t.flexCtx,r=n.nonGrow,i=n.grow,o=n.nonShrink,a=n.shrink;r.totalSize=0,i.totalSize=0,o.totalSize=0,a.totalSize=0},getNext:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=e.runtime,r=n.context,i=r.flexCtx,o=i.nonGrow,a=i.grow,s=i.shrink,u=r.tempData,l=void 0===u?{}:u,c=l.type,h=l.index;t<0&&(c=a.indices.length?o.indices.length?1:2:3,l.type=c,l.index=h=-1,r.tempData=l);var d=l,f=function(e){var t=e.indices;return h<t.length-1?t[++d.index]:-1};switch(c){case 1:(t=f(o))<0&&(t=a.indices[0],d.index=0,d.type=qi(e,r)?2:3);break;case 2:t=f(a);break;case 3:(t=a.indices.length?f(a):h<e.children.length-1?++d.index:-1)<0&&s.indices.length&&!s.totalSize&&(t=s.indices[0],d.index=0,d.type=4);break;case 4:t=f(s)}return t}};function Qi(e,t){return e.findIndex((function(e){return e===t}))}function eo(e,t){var n;if((0,C.pd9)(e)&&e){var r=null===(n=e.runtime)||void 0===n?void 0:n.context;if(r){var i=r.flexCtx.originCrossSize;if(i.size){var o,a=x(i);try{for(a.s();!(o=a.n()).done;){var s=(0,f.Z)(o.value,2),u=s[0],l=s[1];u[t]=l}}catch(e){a.e(e)}finally{a.f()}}}}}function to(e){return function(t,n){return t&&(eo(t,e),(0,C.oFe)(t,!0)),{boundaryRo:t,element:null==n?void 0:n.parent}}}function no(e){return function(t,n,r,i,o){eo((0,C.LSh)(n),e),n.children.forEach((function(e){var t,r=(0,C.LSh)(e);if(r)if(i)e!==n&&(0,C.oBy)(e,!1);else{var o=null===(t=r.runtime)||void 0===t?void 0:t.constraint;null!=o&&o.stretchWidth||null!=o&&o.stretchHeight?(0,C.oFe)(r,!0):Se(r)}}));var a=(0,C.LSh)(n);return i&&(0,C.oFe)(a,!0),3}}function ro(e){(0,C.oFe)(e,!0)}function io(e){return function(t){return eo((0,C.LSh)(t),e),{resetLayoutContext:!0,collectToTempEntry:!0}}}var oo="height",ao={add:to(oo),markDirty:no(oo),move:ro,remove:io(oo)},so=function(e){function t(){return(0,h.Z)(this,t),(0,u.Z)(this,(0,l.Z)(t).apply(this,arguments))}return(0,c.Z)(t,e),(0,d.Z)(t,null,[{key:"composeRenderSideEffects",value:function(){(0,C.UaJ)(S.j2.FlexRow,{layout:Ji,mutate:ao})}},{key:"key",get:function(){return S.j2.FlexRow}}]),t}(C.wA2),uo="width",lo={add:to(uo),markDirty:no(uo),move:ro,remove:io(uo)},co=(C.wA2,function(e,t){var n=e.getCellMeta(t),r=e.getCellLayoutSize(t),i=r.width,o=r.height;return{bordersInfo:n.getData().borders,cellSize:{width:i,height:o}}}),ho=function(e){var t,n=null!==(t=e[0])&&void 0!==t?t:1,r=e[1]||R.Ng.borderStyle,i=e[2]||R.Ng.borderColor;return{top:[n,r,i],right:[n,r,i],bottom:[n,r,i],left:[n,r,i]}},fo=function(e,t){var n=e.cells,r=e.row,i=e.column,o=e.columnWidths,a=e.rowHeights.length,s=o.length,u=(0,f.Z)(t,2),l=u[0],c=u[1];if(!(c>=s)){var h=r[l],d=i[c],p=n[l][c].getData().borders;if(l>=1){var v=n[l-1][c].getData().borders;if(v.bottom[0]>=p.top[0]){var g=(0,f.Z)(v.bottom,3),_=g[0],y=g[1],m=g[2];p.top=[_,y,m]}else{var E=(0,f.Z)(p.top,3),b=E[0],T=E[1],C=E[2];v.bottom=[b,T,C]}}if(c>=1){var S=n[l][c-1].getData().borders;if(S.right[0]>=p.left[0]){var w=(0,f.Z)(S.right,3),A=w[0],O=w[1],M=w[2];p.left=[A,O,M]}else{var k=(0,f.Z)(p.left,3),I=k[0],x=k[1],N=k[2];S.right=[I,x,N]}}var P=function(e,t){return(0,R.hj)(t)?Math.max(t,e[0]):e[0]},L=h.getData(),D=L.thickestTop,F=L.thickestBottom;h.setData({thickestTop:P(p.top,D)}),l===a-1&&h.setData({thickestBottom:P(p.bottom,F)});var B=d.getData(),V=B.thickestLeft,H=B.thickestRight;d.setData({thickestLeft:P(p.left,V)}),c===s-1&&d.setData({thickestRight:P(p.right,H)})}},po=function(e){var t,n={contentHeight:0,borders:ho(null!==(t=e.border)&&void 0!==t?t:[])};return{setData:function(e){return(0,R.f0)(n,e)},getData:function(){return n}}},vo=function(){var e={};return{getData:function(){return e},setData:function(t){return(0,R.f0)(e,t)}}},go=function(){var e={};return{getData:function(){return e},setData:function(t){return(0,R.f0)(e,t)}}},_o=function(){function e(t){(0,h.Z)(this,e),this.el=void 0,this.ro=void 0,this.tpuCtx=void 0,this.ro=t,this.el=t.element,this.tpuCtx={column:[],row:[],cells:[],columnWidths:[],rowHeights:[],overlapCollision:[],totalWidth:0,border:[],rowIndexMap:new WeakMap,columnIndexMap:new WeakMap},this.init()}return(0,d.Z)(e,[{key:"getCtx",value:function(){return this.tpuCtx}},{key:"init",value:function(){this._setRowHeights(),this._setColumnWidths(),this._setOverlap(),this._setBorder();for(var e=this.ro.children,t=this.tpuCtx,n=this._rowAndColSize,r=n.rowSize,i=n.columnSize,o=t.border,a=t.row,s=t.column,u=t.cells,l=t.overlapCollision,c=t.rowIndexMap,h=t.columnIndexMap,d=0;d<r;d++){u[d]=[],a[d]=vo();var f=e[d];c.set(f,d);for(var v=f.children,g=0;g<i;g++){s[g]=go(),u[d][g]=po({border:(0,p.Z)(o)}),fo(t,[d,g]);var _=v[g];h.set(_,g)}}var y,m=x(l);try{for(m.s();!(y=m.n()).done;)for(var E=y.value,b=E.rowStart<E.rowEnd,T=E.rowStart;T<=E.rowEnd;T++){if(b&&T===E.rowStart){var C=a[T].getData().spanRowsOverlap,S=void 0===C?[]:C;S.push(E),a[T].setData({spanRowsOverlap:S})}for(var w=E.colStart;w<=E.colEnd;w++)u[T][w].setData({overlap:E})}}catch(e){m.e(e)}finally{m.f()}}},{key:"_setBorder",value:function(){var e=(0,C.R3e)(this.ro),t=(0,C.nbD)(e.border),n=(0,f.Z)(t,3),r=n[0],i=n[1],o=n[2],a=Math.max(0,r?parseInt(r):0);this.tpuCtx.border=[a,i,o]}},{key:"_setRowHeights",value:function(e){var t;e=null!==(t=e)&&void 0!==t?t:this.el.props.rowHeights;var n=this._rowAndColSize.rowSize;e?e.length!==n&&(0,C._yM)("rowHeights 长度与行数不一致"):e=new Array(n).fill("auto"),this.tpuCtx.rowHeights=e}},{key:"_setColumnWidths",value:function(e){var t;(e=null!==(t=e)&&void 0!==t?t:this.el.props.columnWidths)?e.length!==this._rowAndColSize.columnSize&&(0,C._yM)("columnWidths 长度与列数不一致"):(0,C._yM)("prop columnWidths not exist"),this.tpuCtx.columnWidths=e,this.tpuCtx.totalWidth=e.reduce((function(e,t){return e+t}),0)}},{key:"_setOverlap",value:function(e){var t,n;this.tpuCtx.overlapCollision=null!==(t=e)&&void 0!==t?t:function(e,t){for(var n,r,i=t.rowSize,o=t.columnSize,a=[],s=[],u=0;u<e.length;u+=1){var l=e[u],c=l.startAt,h=l.endAt,d=(0,f.Z)(c,2),p=d[0],v=d[1],g=(0,f.Z)(h,2),_=g[0],y=g[1];if(!(_<p||y<v||p<0||p>=i||_>=i||v<0||v>=o||y>=o)){var m=!1;if(s.length)for(var E=0;E<s.length;E+=1)if(n=s[E],!((r=e[u]).startAt[0]>n.endAt[0]||r.endAt[0]<n.startAt[0]||r.startAt[1]>n.endAt[1]||r.endAt[1]<n.startAt[1])){m=!0;break}m||(s.push(e[u]),a.push({rowStart:p,rowEnd:_,colStart:v,colEnd:y}))}}return a.sort((function(e,t){return e.rowStart===t.rowStart?e.colStart-t.colStart:e.rowStart-t.rowStart}))}(null!==(n=this.el.props.overlap)&&void 0!==n?n:[],this._rowAndColSize)}},{key:"updateBorder",value:function(){var e=(0,f.Z)(this.tpuCtx.border,3),t=e[0],n=e[1],r=e[2];this._setBorder();var i=(0,f.Z)(this.tpuCtx.border,3),o=i[0],a=i[1],s=i[2],u=o!==t,l={isWidthChange:u,hasChanged:u||a!==n||s!==r};if(!l.hasChanged)return l;for(var c=this._rowAndColSize,h=c.rowSize,d=c.columnSize,p=ho(this.tpuCtx.border),v=0;v<h;v++)for(var g=0;g<d;g++)this.tpuCtx.cells[v][g].setData({borders:p}),fo(this.tpuCtx,[v,g]);return l}},{key:"updateRowHeights",value:function(e){if(this._setRowHeights(null==e?void 0:e.rowHeights),e&&"update"!==e.type){var t=e.rowIndices,n=e.type,r=this.tpuCtx,i=this.ro.children,o=r.row,a=r.cells,s=r.border,u=r.rowIndexMap,l=r.columnIndexMap,c=this._rowAndColSize,h=c.rowSize,d=c.columnSize;if("add"===n){var f,v=x(t);try{for(v.s();!(f=v.n()).done;){var g=f.value;o.splice(g,0,vo()),a.splice(g,0,[]);for(var _=0;_<d;_++)a[g][_]=po({border:(0,p.Z)(s)}),fo(r,[g,_])}}catch(e){v.e(e)}finally{v.f()}for(var y=t[0];y<h;y++){var m,E=i[y];if(E)u.set(E,y),null===(m=E.children)||void 0===m||m.forEach((function(e,t){l.set(e,t)}))}}else{var b,T=x(t);try{for(T.s();!(b=T.n()).done;){var C=b.value,S=o[C].getData().thickestBottom;S&&o[C-1].setData({thickestBottom:S}),o.splice(C,1),a.splice(C,1)}}catch(e){T.e(e)}finally{T.f()}for(var w=new Set(t),R=t[t.length-1],A=R;R<h;)if(w.has(A))A++;else{var O=i[A];O&&u.set(O,R),R++,A++}}}}},{key:"updateColumnWidths",value:function(e){if(this._setColumnWidths(null==e?void 0:e.columnWidths),e&&"update"!==e.type){var t=e.colIndices,n=e.type,r=this._rowAndColSize,i=r.rowSize,o=r.columnSize,a=this.tpuCtx,s=a.column,u=a.cells,l=a.border,c=a.columnIndexMap,h=this.ro.children;if("add"===n){var d,f=x(t);try{for(f.s();!(d=f.n()).done;){var v=d.value;s.splice(v,0,go());for(var g=0;g<i;g++){var _=po({border:(0,p.Z)(l)});u[g].splice(v,0,_),fo(this.tpuCtx,[g,v])}}}catch(e){f.e(e)}finally{f.f()}for(var y=0;y<i;y++)for(var m=h[y].children,E=t[0];E<o;E++){var b=m[E];b&&c.set(b,E)}}else{var T,C=x(t);try{for(C.s();!(T=C.n()).done;){var S=T.value,w=s[S].getData().thickestRight;s.splice(S,1);for(var R=0;R<i;R++)u[R].splice(S,1);w&&s[S-1].setData({thickestRight:w})}}catch(e){C.e(e)}finally{C.f()}for(var A=new Set(t),O=t[t.length-1],M=O;O<o;)if(A.has(M))M++;else{for(var k=0;k<i;k++){var I=h[k].children[M];I&&c.set(I,O)}O++,M++}}}}},{key:"getColumnWidth",value:function(e){return this.tpuCtx.columnWidths[e]}},{key:"getColumnMeta",value:function(e){return this.tpuCtx.column[e]}},{key:"getRowMeta",value:function(e){return this.tpuCtx.row[e]}},{key:"getRowIndex",value:function(e){var t;return null!==(t=this.tpuCtx.rowIndexMap.get(e))&&void 0!==t?t:-1}},{key:"getRowWidth",value:function(){return this.tpuCtx.totalWidth}},{key:"getRowHeight",value:function(e){var t=this.tpuCtx.rowHeights[e];return(0,R.hj)(t)?{height:t,isAuto:!1}:{height:this.ro.children[e].height,isAuto:!0}}},{key:"getCellMeta",value:function(e){var t=(0,f.Z)(e,2),n=t[0],r=t[1];return this.tpuCtx.cells[n][r]}},{key:"getColumnIndex",value:function(e){var t;return null!==(t=this.tpuCtx.columnIndexMap.get(e))&&void 0!==t?t:-1}},{key:"getCellLayoutSize",value:function(e){var t=this.tpuCtx,n=t.columnWidths,r=t.cells,i=(0,f.Z)(e,2),o=i[0],a=i[1],s=r[o][a].getData().borders,u=(0,f.Z)(s.left,1)[0],l=(0,f.Z)(s.right,1)[0],c=(0,f.Z)(s.top,1)[0],h=(0,f.Z)(s.bottom,1)[0],d=this.getCellOverlap(e),p=d.isMainCell,v=d.overlap,g=function(e){return Math.max(e-(u+l)/2,0)},_=function(e){return Math.max(e-(c+h)/2,0)};if(!v){var y=this.getRowHeight(o),m=y.height,E=y.isAuto;return{width:g(n[a]),height:_(m),isAuto:E}}if(!p)return{width:0,height:0,isAuto:!1};for(var b=v.colStart,T=v.colEnd,C=v.rowStart,S=v.rowEnd,w=0,R=0,A=!1,O=b;O<=T;O++)w+=n[O];for(var M=C;M<=S;M++){var k=this.getRowHeight(M);R+=k.height,A=A||k.isAuto}return{width:g(w),height:_(R),isAuto:A}}},{key:"getCellOverlap",value:function(e){var t=this.tpuCtx.cells,n=(0,f.Z)(e,2),r=n[0],i=n[1],o=t[r][i].getData().overlap;return{isMainCell:!!o&&o.rowStart===r&&o.colStart===i,overlap:o}}},{key:"getRelatedCellsByRowIndex",value:function(e){return function(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r],o=i.rowStart,a=i.rowEnd,s=i.colStart;o<=t&&a>=t&&n.push([o,s])}return n}(this.tpuCtx.overlapCollision,e)}},{key:"getRelatedRowsByRow",value:function(e){var t=this.getRowIndex(e),n=t,r=t;return this.tpuCtx.overlapCollision.forEach((function(e){var i=e.rowStart,o=e.rowEnd;i<=t&&o>=t&&(n=Math.min(n,i),r=Math.max(r,o))})),this.ro.children.slice(n,r+1)}},{key:"_rowAndColSize",get:function(){var e,t,n,r,i=(null!==(e=this.el)&&void 0!==e?e:{}).children,o=void 0===i?[]:i;return{rowSize:o.length,columnSize:null!==(t=null===(n=o[0])||void 0===n||null===(r=n.children)||void 0===r?void 0:r.length)&&void 0!==t?t:0}}}]),e}(),yo={buildContext:function(e){var t=e.runtime;(0,C.ER$)(e),(0,C.W_L)(t,(0,R.f0)({},(0,C.snm)(e,{}),{tpu:new _o(e),individual:!0}))},createChildConstraint:function(e,t){var n=t.runtime;(0,C.gRG)(n,(0,R.f0)({originMaxWidth:void 0},S.mm,S.ql))},transition:function(e,t,n,r,i){var o=n.tempData;((0,R.o8)(o)||o>i)&&(n.tempData=i)},wrapup:function(e,t){var n=t.tpu,r=e.children,i=null==r?void 0:r.length,o=n.getRowMeta(0).getData().thickestTop,a=0;if(i){var s,u=null!==(s=t.tempData)&&void 0!==s?s:0;if(u){var l=r[u-1];a=l.top+l.height}else a=o/2;for(var c=u;c<i;c++){var h=r[c],d=n.getCellMeta([c,0]).getData().borders.left;(0,C.ryg)(h,{top:a,left:d[0]/2}),a=h.top+h.height}}var f=n._rowAndColSize,p=f.rowSize,v=f.columnSize,g=n.getColumnMeta(0).getData().thickestLeft/2+n.getColumnMeta(v-1).getData().thickestRight/2,_=n.getRowMeta(p-1).getData().thickestBottom;(0,C.ryg)(e,{width:n.getRowWidth()+g,height:a+_/2}),delete t.tempData},computeStyle:function(e){var t,n=(0,C.R3e)(e);(0,E.tw)(["backgroundColor","display"],e,n),(0,C._z)(e,"border",null!==(t=n.border)&&void 0!==t?t:R.Ng.border),B(e,n)}},mo="tableBorder",Eo=function(e,t,n,r){var i=e.height,o=e.width,a=e.left,s=e.top,u=t.top,l=t.right,c=t.bottom,h=t.left;u[0]&&n.push({type:2,lineWidth:u[0],stroke:u[2],path:[[a-h[0],s-u[0]/2],[a+o,s-u[0]/2]],opacity:r}),l[0]&&n.push({type:2,lineWidth:l[0],stroke:l[2],path:[[a+o+l[0]/2,s-u[0]],[a+o+l[0]/2,s+i]],opacity:r}),c[0]&&n.push({type:2,lineWidth:c[0],stroke:c[2],path:[[a,s+i+c[0]/2],[a+o+l[0],s+i+c[0]/2]],opacity:r}),h[0]&&n.push({type:2,lineWidth:h[0],stroke:h[2],path:[[a-h[0]/2,s],[a-h[0]/2,s+i+u[0]]],opacity:r})},bo=function(e){var t=e.painter,n=e.rect,r=e.renderObject,i=e.area;te({painter:t,rect:n,renderObject:r,boxMetrics:(0,C.idt)(r)});for(var o=r.runtime.context.tpu,a=o._rowAndColSize,s=a.rowSize,u=a.columnSize,l=r.scrollLeft,c=void 0===l?0:l,h=r.scrollTop,d=void 0===h?0:h,p=[],v=new Set,g=!1,_=0;_<s;_+=1){var y=r.children[_];if(y){var m=y.top+n.top,E=m+y.height;if(!(m>i.y+i.height||E<i.y)){g=!0,o.getRelatedCellsByRowIndex(_).forEach((function(e){v.add(e.join(","))}));for(var b=!1,T=0;T<u;T+=1){if(!o.getCellOverlap([_,T]).overlap){var S=y.children[T];if(m+S.top<=i.y+i.height){b=!0;var w=co(o,[_,T]),A=w.bordersInfo,O=w.cellSize,M=(0,R.f0)({left:n.left+y.left+S.left-c,top:n.top+y.top+S.top-d},O);Eo(M,A,p,t.globalAlpha)}else if(b)break}}}else if(g)break}}v.forEach((function(e){var i=e.split(",").map(Number),a=(0,f.Z)(i,2),s=a[0],u=a[1],l=r.children[s],h=l.children[u],v=co(o,[s,u]),g=v.bordersInfo,_=v.cellSize,y=(0,R.f0)({left:n.left+l.left+h.left-c,top:n.top+l.top+h.top-d},_);Eo(y,g,p,t.globalAlpha)})),C.p5R.pushQueue(p,mo),C.p5R.flush(2,mo)};function To(e){return(0,C.kKo)(e,S.j2.TableRow)&&!!e.parent&&(0,C.kKo)(e.parent,S.j2.Table)}function Co(e){return(0,C.kKo)(e,S.j2.TableCell)&&!!e.parent&&To(e.parent)}function So(e,t,n){for(var r=!1,i=t;i<=n;i++)if(!(0,R.hj)(e[i])){r=!0;break}return r}var wo=function(e,t){var n=(0,C.XOS)(e,t),r=n.el;return function(e,t,n,r){if(!(0,C.kKo)(e,S.j2.Table)||!(null!=n&&n.length||null!=r&&r.length))return!1;var i=t.runtime;if(null==i||!i.context)return!1;var o=i.context.tpu.getCtx(),a=o.overlapCollision,s=o.cells,u=o.row,l=new Set(a.map((function(e){return"".concat(e.rowStart,",").concat(e.colStart,",").concat(e.rowEnd,",").concat(e.colEnd)}))),c=new Set(null==r?void 0:r.map((function(e){var t=e.startAt,n=e.endAt;return"".concat(t[0],",").concat(t[1],",").concat(n[0],",").concat(n[1])}))),h=function(e,t){e.size&&e.forEach((function(n){t.has(n)&&(e.delete(n),t.delete(n))}))};h(l,c),h(c,l);var d=function(e){return Array.from(e).map((function(e){var t=e.split(","),n=(0,f.Z)(t,4);return{startAt:[+n[0],+n[1]],endAt:[+n[2],+n[3]]}}))},p=e.children.length-1,v=function(n){var r=(0,f.Z)(n.startAt,2),i=r[0],o=r[1],a=(0,f.Z)(n.endAt,2),s=a[0],u=a[1];p=Math.min(p,i);for(var l=i;l<=s;l++){var c=e.children[l];if(c){for(var h=o;h<=u;h++){var d,v=null===(d=c.children)||void 0===d?void 0:d[h];v&&(0,C.oBy)(v)}var g=t.children[l].children[o];g&&(0,C.zBZ)(g)}}};return d(l).forEach((function(e){v(e);var t=(0,f.Z)(e.startAt,2),n=t[0],r=t[1],i=(0,f.Z)(e.endAt,2),l=i[0],c=i[1],h=a.findIndex((function(e){return n===e.rowStart||r===e.colStart}));if(-1!==h){a.splice(h,1);var d=a[h],p=u[n].getData().spanRowsOverlap,g=void 0===p?[]:p;u[n].setData({spanRowsOverlap:1===g.length?void 0:g.filter((function(e){return e!==d}))});for(var _=n;_<=l;_++)for(var y=r;y<=c;y++)s[_][y].setData({overlap:void 0}),fo(o,[_,y])}})),d(c).forEach((function(e){v(e);var t=(0,f.Z)(e.startAt,2),n=t[0],r=t[1],i=(0,f.Z)(e.endAt,2),l=i[0],c=i[1],h={rowStart:n,colStart:r,rowEnd:l,colEnd:c},d=a.findIndex((function(e){return n>e.rowStart||n===e.rowStart&&r>e.colStart}));d>-1?a.splice(d,0,h):a.push(h);var p=u[n].getData().spanRowsOverlap,g=void 0===p?[]:p;g.push(h),u[n].setData({spanRowsOverlap:g});for(var _=n;_<=l;_++)for(var y=r;y<=c;y++)s[_][y].setData({overlap:h}),fo(o,[_,y])})),(0,C.zBZ)(t.children[p]),i.status=(0,C.Epq)(i.status,[2],!0),!0}(r,n.ro,n.prev,r.props.overlap)},Ro=function(e,t){var n=(0,C.XOS)(e,t),r=n.el;return function(e,t,n,r){if(!(0,C.kKo)(e,S.j2.Table))return!1;var i=t.runtime;if(null==i||!i.context)return!1;var o=i.context.tpu,a=t.children;if(n.length!==r.length)return!1;var s=n.findIndex((function(e,t){return e!==r[t]}));return-1!==s&&(e.children.forEach((function(e,t){var n;(0,C.oBy)(e.children[s]);var r=o.getCellOverlap([t,s]).overlap;r?(r.rowStart===t&&(0,C.oBy)(e.children[r.colStart]),n=a[t].children[r.colStart]):n=a[t].children[s],(0,C.zBZ)(n)})),o.updateColumnWidths({colIndices:[s],type:"update"}),(0,C.zBZ)(a[0]),i.status=(0,C.Epq)(i.status,[2],!0),!0)}(r,n.ro,n.prev,r.props.columnWidths)},Ao={add:function(e,t,n){return t&&n&&function(e,t){var n;if(To(e)&&t.length){var r=e.parent,i=(0,C.LSh)(r);if(i){var o=i.runtime;if(null!=o&&null!==(n=o.context)&&void 0!==n&&n.tpu){var a=o.context.tpu,s=a.getCtx(),u=s.rowHeights,l=s.overlapCollision,c=s.cells,h=r.children;if(!(u.length>=h.length)){var d,f=(0,p.Z)(u),v=x(t);try{for(v.s();!(d=v.n()).done;){var g=d.value;f.splice(g,0,"auto")}}catch(e){v.e(e)}finally{v.f()}a.updateRowHeights({rowIndices:t,type:"add",rowHeights:f});var _=i.children;(0,C.zBZ)(_[t[0]]);var y,m=x(t);try{for(m.s();!(y=m.n()).done;){var E,b=y.value,T=x(l);try{for(T.s();!(E=T.n()).done;){var S=E.value,w=S.rowStart,R=S.rowEnd,A=S.colStart,O=S.colEnd;if(!(R<b)){if(w<b){var M=_[w].children[A];So(u,w,R)?(0,C.oFe)(M):(0,C.oBy)(h[w].children[A]),(0,C.zBZ)(M),(0,C.zBZ)(M.parent);for(var k=w+1;k<=R+1;k++)if(k!==b){var I=_[k].children,N=I[I.length-1];(0,C.oFe)(N),(0,C.zBZ)(N)}for(var P=A;P<=O;P++)c[b][P].setData({overlap:S})}else S.rowStart++;S.rowEnd++}}}catch(e){T.e(e)}finally{T.f()}}}catch(e){m.e(e)}finally{m.f()}o.status=(0,C.Epq)(o.status,[2],!0)}}}}}(t,n),{boundaryRo:e,element:null==e?void 0:e.element}},remove:function(e,t,n){!function(e,t){var n;if(To(e)){var r=(0,C.Kas)(e.parent);if(null!=r&&null!==(n=r.context)&&void 0!==n&&n.tpu){var i=new Set;t.forEach((function(e){return i.add(e.index)}));var o,a=e.parent.children,s=r.context.tpu,u=s.getCtx(),l=u.rowHeights,c=u.overlapCollision,h=u.row,d=u.cells;l.length>a.length&&(o=l.filter((function(e,t){return!i.has(t)})));var f=(0,p.Z)(i).sort((function(e,t){return t-e}));f.forEach((function(e){for(var t=function(t){var n=c[t],r=n.rowStart,i=n.rowEnd,o=n.colStart,s=n.colEnd;if(i<e)return"continue";var f=r===e;if(r<=e){if(r>=i)return c.splice(t,1),"continue";var p=a[r].children[o],v=(0,C.LSh)(p);So(l,r,i)?(0,C.oFe)(v):(0,C.oBy)(p),(0,C.zBZ)(v),!f&&(0,C.zBZ)(v.parent);for(var g=v.parent.parent.children,_=r+(f?2:1),y=g[0].children.length;_<=i;_++)if(_!==e){var m=g[_].children[y-1];(0,C.oFe)(m),(0,C.zBZ)(m)}}else n.rowStart--;if(n.rowEnd--,n.rowStart===n.rowEnd){if(o===s&&(c.splice(t,1),d[f?i:r][o].setData({overlap:void 0})),!f){var E=h[r].getData().spanRowsOverlap;E&&h[r].setData({spanRowsOverlap:1===E.length?void 0:E.filter((function(e){return e!==n}))})}}else if(f){var b=h[r+1].getData().spanRowsOverlap,T=void 0===b?[]:b;T.push(n),h[r+1].setData({spanRowsOverlap:T})}if(!f&&e!==i)return"continue";for(var S=f?r+1:i-1,w=o;w<=s;w++)fo(u,[S,w])},n=c.length-1;n>=0;n--)t(n)})),s.updateRowHeights({rowIndices:f,type:"remove",rowHeights:o}),r.status=(0,C.Epq)(r.status,[2],!0)}}}(t,n)},update:function(e,t){var n={lineWrap:C.LBn,asOneChar:C.LBn,selectable:C.K0Q,columnWidths:Ro,overlap:wo,rowHeights:C.DQW},r=(0,C.NT5)(n,e,t.props),i=(0,C.eQi)(e,t);return i.collectToTempEntry=i.collectToTempEntry||r,i}},Oo=(C.wA2,{buildContext:function(e){var t,n=e.runtime;e.parent&&(t=e.parent.runtime.context.tpu)?(0,C.W_L)(n,{tpu:t,individual:!0}):((0,C.DSN)(n,"isSkipLayout",!0),(0,C.WXx)(e,"display",!1))},createChildConstraint:function(e,t){return t.runtime.constraint},wrapup:function(e,t){var n=t.tpu,r=e.children;if(n&&null!=r&&r.length){(0,C.R_0)(e,"width",n.getRowWidth());for(var i=function(e,t){(0,C.ryg)(e,{height:t,lineOuterHeight:t})},o=function(e,t){return e+(t.top[0]+t.bottom[0])/2},a=function(e,t){return e-(t.top[0]+t.bottom[0])/2},s=function(e){e.width=0,i(e,0)},u=n.getRowIndex(e),l=0,c=0,h=[],d=[],f=0;f<r.length;f++){var p=r[f],v=n.getCellMeta([u,f]).getData(),g=v.overlap,_=v.contentHeight,y=v.borders,m=y.top,E=y.left,b=m[0]/2;if((0,C.R_0)(p,"top",b),(0,C.R_0)(p,"left",c+E[0]/2),c+=n.getColumnWidth(f),g){var T=g.rowStart,S=g.rowEnd,w=g.colEnd;u===T?T===S&&(l=Math.max(l,o(_,y)),h.push(f)):(s(r[f]),T!==S&&u===S&&d.push(g));for(var R=f+1;R<=w;R++)c+=n.getColumnWidth(R);for(var A=f+1;A<=w;A++){var O=r[A];s(O),(0,C.R_0)(O,"top",b),(0,C.R_0)(O,"left",c)}f=w}else l=Math.max(l,o(_,y)),h.push(f)}i(e,l);for(var M=0,k=h;M<k.length;M++){var I=k[M];i(r[I],a(l,n.getCellMeta([u,I]).getData().borders))}if(d.length){var N=e.parent.children,P=function(e,t){var r,s=N[e],u=s.height+t;null===(r=s.children)||void 0===r||r.forEach((function(t,r){var l=n.getCellMeta([e,r]).getData(),c=l.borders,h=l.overlap;if(o(t.height,c)===s.height)return i(t,a(u,c));if(h){var d=h.rowStart,f=h.rowEnd,p=h.colStart,v=h.colEnd;if(f===e&&v===r){var g=N[d].children[p];g.height=u;for(var _=d;_<f;_++)g.height+=N[_].height;i(g,a(g.height,n.getCellMeta([d,p]).getData().borders))}}})),i(s,u)};d.sort((function(e,t){var r=n.getCellMeta([e.rowStart,e.colStart]).getData(),i=r.contentHeight,a=r.borders,s=n.getCellMeta([t.rowStart,t.colStart]).getData(),u=s.contentHeight,l=s.borders;return o(u,l)-o(i,a)}));d.forEach((function(e){for(var t=e.rowStart,r=e.rowEnd,s=e.colStart,l=n.getCellMeta([t,s]).getData(),c=l.contentHeight,h=l.borders,d=o(c,h),f=[],p=N[t].height,v=t+1;v<=r;v++){var g=n.getRowMeta(v).getData().spanRowsOverlap;p+=N[v].height,null!=g&&g.length&&f.push(v)}var _=N[t].children[s];if(p<d)if(f.length){i(_,c);var y,m=(d-p)/f.length,E=x(f);try{for(E.s();!(y=E.n()).done;){var b=y.value;P(b,m)}}catch(e){E.e(e)}finally{E.f()}}else for(var T=(d-p)/(r-t+1),C=t;C<=r;C++)P(C,T);else i(_,a(p,h));!function(e){for(var t=e,r=u;t<r;t++){var i=n.getCellMeta([t,0]).getData().borders,o=i.top,a=i.left,s=0;if(t){var l=N[t-1];s=l.top+l.height}N[t].top=s+o[0]/2,N[t].left=a[0]/2}}(t)}))}}},computeStyle:function(e){var t=(0,C.R3e)(e);(0,E.tw)("display",e,t),B(e,t)}});var Mo={add:function(e,t,n){var r;return t&&n&&function(e,t){var n;if(Co(e)&&t.length){var r=e.parent.parent,i=(0,C.LSh)(r);if(i){var o=i.runtime;if(null!=o&&null!==(n=o.context)&&void 0!==n&&n.tpu){var a,s=i.children,u=x(s);try{for(u.s();!(a=u.n()).done;){var l=a.value;(0,C.zBZ)(l.children[t[0]])}}catch(e){u.e(e)}finally{u.f()}var c=r.children,h=o.context.tpu,d=h.getCtx(),f=d.columnWidths,v=d.overlapCollision,g=d.cells;if(!(f.length>=c[0].children.length)){var _,y=(0,p.Z)(f),m=x(t);try{for(m.s();!(_=m.n()).done;){var E=_.value;y.splice(E,0,100)}}catch(e){m.e(e)}finally{m.f()}h.updateColumnWidths({colIndices:t,type:"add",columnWidths:y});var b,T=x(t);try{for(T.s();!(b=T.n()).done;){var S,w=b.value,R=x(v);try{for(R.s();!(S=R.n()).done;){var A=S.value,O=A.rowStart,M=A.rowEnd,k=A.colStart;if(!(A.colEnd<w)){if(k<w){(0,C.oBy)(c[O].children[k]);var I=s[O].children[k];(0,C.zBZ)(I);for(var N=O;N<=M;N++)g[N][w].setData({overlap:A})}else A.colStart++;A.colEnd++}}}catch(e){R.e(e)}finally{R.f()}}}catch(e){T.e(e)}finally{T.f()}(0,C.zBZ)(s[0]),(0,C.DSN)(o,"status",(0,C.Epq)(o.status,[2],!0))}}}}}(t,n),{boundaryRo:null==e?void 0:e.parent,element:null==e||null===(r=e.element)||void 0===r?void 0:r.parent}},remove:function(e,t,n){return function(e,t){var n,r=e.parent,i=null==r?void 0:r.parent;if(Co(e)&&i){var o=(0,C.Kas)(i);if(null!=o&&null!==(n=o.context)&&void 0!==n&&n.tpu){var a=new Set;t.forEach((function(e){var t=e.parent,n=e.index;if(a.add(n),!n)return(0,C.oFe)(t);var r=t.children;if(r){var i=r[Math.min(n,r.length-2)];(0,C.oFe)(i),(0,C.zBZ)(i)}}));var s,u=o.context.tpu,l=u.getCtx(),c=l.columnWidths,h=l.overlapCollision,d=l.row,f=l.cells;c.length>r.children.length&&(s=c.filter((function(e,t){return!a.has(t)})));var v=(0,p.Z)(a).sort((function(e,t){return t-e})),g=i.children;v.forEach((function(e){for(var t=function(t){var n=h[t],r=n.rowStart,i=n.rowEnd,o=n.colStart,a=n.colEnd;if(a<e)return"continue";var s=o===e;if(o<=e){if(o>=a){h.splice(t,1);var u=d[r].getData().spanRowsOverlap;return d[r].setData({spanRowsOverlap:1===u.length?void 0:u.filter((function(e){return e!==n}))}),"continue"}var c=g[r].children[o],p=(0,C.LSh)(c);(0,C.oBy)(c),!s&&(0,C.zBZ)(p)}else n.colStart--;if(n.colEnd--,n.colStart===n.colEnd&&r===i&&(h.splice(t,1),f[r][s?a:o].setData({overlap:void 0})),!s&&e!==a)return"continue";for(var v=s?o+1:a-1,_=r;_<=i;_++)fo(l,[_,v])},n=h.length-1;n>=0;n--)t(n)})),u.updateColumnWidths({colIndices:v,type:"remove",columnWidths:s}),(0,C.zBZ)((0,C.LSh)(g[0])),o.status=(0,C.Epq)(o.status,[2],!0)}}}(t,n),{boundaryRo:(0,C.LSh)(t),element:(0,C.SvU)(e),noRemoveAndSetDirty:!0}},markDirty:function(e,t,n,r,i){var o,a=null===(o=(0,C.Kas)(t))||void 0===o?void 0:o.context;if(null!=a&&a.tpu)for(var s=a.tpu,u=s.getCtx().cells,l=(0,C.LSh)(t),c=s.getRowIndex(l),h=l.parent.children,d=new Set,f=0,p=u[c].length-1;f<=p;f++){var v=u[c][f].getData().overlap;if(v){var g=v.rowStart,_=v.rowEnd,y=v.colStart;f=v.colEnd;var m=h[g].children[y];(0,C.oFe)(m),(0,C.zBZ)(m),(0,C.zBZ)(m.parent),d.has(g);for(var E=g+1;E<=_;E++)if(!d.has(E)){d.add(E);var b=h[E].children[p];(0,C.oFe)(b),(0,C.zBZ)(b)}}}return 3}},ko=(C.wA2,{wrapup:function(e,t){var n=t.tpu;if(n){var r=[n.getRowIndex(e.parent),n.getColumnIndex(e)],i=n.getCellLayoutSize(r),o=i.width,a=i.height,s=i.isAuto;(0,C.ryg)(e,{width:o,lineOuterHeight:0}),n.getCellMeta(r).setData({contentHeight:s?(0,C.IhD)(e)[1]:a})}},computeStyle:function(e){var t=(0,C.R3e)(e);(0,E.tw)(["backgroundColor","display"],e,t),B(e,t)},buildContext:function(e){var t,n=e.runtime;e.parent&&(t=e.parent.runtime.context.tpu)?(0,C.W_L)(n,{tpu:t,individual:!0}):((0,C.DSN)(n,"isSkipLayout",!0),(0,C.WXx)(e,"display",!1))},createChildConstraint:function(e,t){var n=e.runtime.context.tpu,r=n.getRowIndex(e.parent),i=n.getColumnIndex(e),o=n.getCellLayoutSize([r,i]),a=o.width,s=o.height,u=o.isAuto,l=t.runtime;(0,C.gRG)(l,{maxWidth:a,maxHeight:u?1/0:s})},willLayout:function(e){var t=e.runtime,n=t.context.tpu;if(n){var r=[n.getRowIndex(e.parent),n.getColumnIndex(e)],i=n.getCellOverlap(r),o=i.isMainCell;if(!i.overlap||o){var a,s=n.getCellMeta(r);if(s)(0,C.pK0)(e,null!==(a=s.getData().style)&&void 0!==a?a:{});else t&&(t.isSkipLayout=!0)}}}}),Io=function(e){var t=e.painter,n=e.rect,r=e.renderObject;te({painter:t,rect:n,renderObject:r,boxMetrics:(0,C.idt)(r)})},xo=function(e){var t=e.renderObject,n=t.runtime;if(n&&(0,y.$p)(t,n))return 2};C.wA2;var No=function(e){var t,n,r,i=e.renderObject,o=e.rect,a=e.area,s=e.painter,u=(0,E.es)(i),l=(0,f.Z)(u,2),c=l[0],h=l[1],d=(0,E.cJ)(o,a.width),p=(0,f.Z)(d,2),v=p[0],g=p[1],_=null!==(t=i.scrollLeft)&&void 0!==t?t:0;c=Math.min(null!==(n=c)&&void 0!==n?n:v,_),h=null!==(r=h)&&void 0!==r?r:g;var y={scrollLeft:a.scrollLeft,scrollTop:a.scrollTop,x:o.left-c,y:o.top,width:Math.ceil(c+o.width+h),height:Math.ceil(o.height)};(0,C.NqN)(s,i,y),s.save(),s.beginPath(),s.rect(y.x,y.y,y.width,y.height),s.clip()},Po=function(e){e.painter.restore()},Lo=function(e){var t=e.renderObject,n=e.rect,r=e.area,i=e.asRoot,o=e.pushPaintQueue;if(!i)return null==o||o(t,{origin:{left:n.left+r.scrollLeft,top:n.top+r.scrollTop},rectContainer:{id:t.element._id,rect:n}}),2},Do={buildContext:function(e){return(0,C.TpM)(e)},createChildConstraint:function(e,t){var n=t.runtime;(0,C.gRG)(n,(0,R.f0)((0,C.iDd)(e),S.mm,S.ql,{maxWidth:1/0}))},wrapup:function(e,t){var n,r,i=t.minWidth,o=t.maxHeight,a=t.minHeight,s=(0,C.gOt)(e),u=s.width,l=s.height,c=(0,C.IhD)(e);((0,C.ryg)(e,{width:(0,R.hj)(u)?u:Math.max(i,c[0]),height:(0,C.PuD)(null!==(n=l)&&void 0!==n?n:"auto",c[1],a,o)}),P(e)&&(0,C.R_0)(e,"scrollWidth",c[0]),L(e))&&(0,C.ryg)(e,{scrollTop:null!==(r=e.scrollTop)&&void 0!==r?r:0,scrollHeight:c[1]})},computeStyle:function(e,t){var n=(0,C.j2w)(t),r=n.maxWidth,i=n.maxHeight,o=n.inheritedStyle,a=(0,C.R3e)(e);D(e,a,r,o),(0,E.tw)(["minWidth","maxWidth"],e,a,r,o),F(e,a,i,o),(0,E.tw)(["minHeight","maxHeight"],e,a,i,o),B(e,a)}},Fo={update:function(e,t){var n={lineWrap:C.LBn,asOneChar:C.LBn,selectable:C.K0Q,extraLeft:C.EZo,extraRight:C.EZo,asRelative:C.K0Q},r=(0,C.NT5)(n,e,t.props),i=(0,C.eQi)(e,t);return i.collectToTempEntry=i.collectToTempEntry||r,i}};C.wA2},vsh_83675:function(e,t,n){"use strict";n.d(t,{X1O:function(){return m},q3z:function(){return E},vS7:function(){return I},nE9:function(){return N},nq:function(){return P},$bs:function(){return L},guc:function(){return R},hu8:function(){return A},_yM:function(){return O},I8j:function(){return T},Kp3:function(){return C},yjm:function(){return D},DWu:function(){return F},r1x:function(){return B},a6z:function(){return V},ENg:function(){return H},ZvQ:function(){return U},jhR:function(){return W},YkQ:function(){return j},hUA:function(){return G},FT5:function(){return z},d9l:function(){return Y},YfM:function(){return K},aE1:function(){return q},m6N:function(){return $},ojQ:function(){return J},gN5:function(){return Q},C3d:function(){return ee},cq5:function(){return te},j6R:function(){return ne},Oup:function(){return dt},jHw:function(){return ft},L23:function(){return pt},lEK:function(){return vt},PH7:function(){return _t},zTE:function(){return Ct},TBD:function(){return St},p0Y:function(){return wt},R_0:function(){return re},ryg:function(){return ie},Drw:function(){return oe},jeH:function(){return ae},_z:function(){return ue},$BO:function(){return le},kNj:function(){return de},vmh:function(){return fe},WXx:function(){return ge},pK0:function(){return _e},t3u:function(){return ye},Jt:function(){return me},gOt:function(){return Ee},IJD:function(){return be},g24:function(){return Te},s7M:function(){return Ce},kgX:function(){return Se},HTH:function(){return we},rvU:function(){return Re},P6Y:function(){return Ae},vqx:function(){return Oe},p7o:function(){return Me},jFX:function(){return De},mqG:function(){return Fe},d89:function(){return Be},CLs:function(){return Ve},R3e:function(){return He},DSN:function(){return Ue},W_L:function(){return We},gRG:function(){return je},KfJ:function(){return gs},Ud:function(){return _s},z7X:function(){return ys},eTE:function(){return ms},Lki:function(){return Es},ZMy:function(){return Ts},hHR:function(){return Cs},Epq:function(){return Ss},bXR:function(){return ws},qGP:function(){return Rs},cUS:function(){return Os},oFe:function(){return ks},dFd:function(){return Is},DfN:function(){return et},OdJ:function(){return tt},WG0:function(){return nt},ZHw:function(){return it},qFc:function(){return ot},wpy:function(){return st},h$_:function(){return ut},ip0:function(){return ct},ijY:function(){return Ua},six:function(){return Za},WAP:function(){return Wa},sPR:function(){return ja},dh0:function(){return Ga},z0l:function(){return za},QB3:function(){return Ya},pd9:function(){return Xa},NSX:function(){return Ka},xC0:function(){return qa},HSn:function(){return $a},BJ0:function(){return Ja},x$g:function(){return Qa},IV7:function(){return Lt},sdd:function(){return Dt},fGr:function(){return Ft},ry4:function(){return Oi},kSo:function(){return Mi},xPU:function(){return ki},uYS:function(){return Ii},hZ6:function(){return xi},GWw:function(){return es},ZX6:function(){return ts},cay:function(){return ns},LSh:function(){return rs},mTK:function(){return is},pPf:function(){return os},aXI:function(){return as},Ate:function(){return ss},xgX:function(){return us},q1k:function(){return cs},r$v:function(){return hs},yWV:function(){return ds},rXK:function(){return ps},Wmi:function(){return vs},$4I:function(){return At},p5R:function(){return Ot},UaJ:function(){return It},iY3:function(){return xt},r8s:function(){return Nt},qMZ:function(){return Pt},pcb:function(){return un},hb3:function(){return ln},rbG:function(){return Jn},BAw:function(){return Qn},hPv:function(){return er},E8:function(){return tr},m2Z:function(){return nr},xbV:function(){return rr},idt:function(){return or},S1Q:function(){return ar},HLQ:function(){return sr},PuD:function(){return ur},ER$:function(){return lr},TpM:function(){return cr},snm:function(){return hr},iDd:function(){return dr},VH$:function(){return fr},j2w:function(){return pr},IhD:function(){return gr},zsN:function(){return mr},Wln:function(){return Er},ha2:function(){return Tr},NqN:function(){return Cr},SFv:function(){return Sr},mhq:function(){return wr},oV2:function(){return Ar},tEO:function(){return Or},uRb:function(){return Mr},$vv:function(){return kr},jF8:function(){return Ir},o6v:function(){return xr},IAC:function(){return Nr},KhP:function(){return Pr},vXR:function(){return Lr},fGt:function(){return Dr},fWv:function(){return Br},SXw:function(){return Vr},xuz:function(){return Hr},GZ0:function(){return Ur},AQ7:function(){return Zr},Pve:function(){return Wr},oJW:function(){return jr},zB4:function(){return Gr},Mq$:function(){return zr},V5j:function(){return Yr},$vD:function(){return Xr},S3r:function(){return Kr},N9q:function(){return qr},Tab:function(){return $r},Rb9:function(){return Jr},Mui:function(){return Qr},qrK:function(){return ei},ZyQ:function(){return ti},KwJ:function(){return ni},IUU:function(){return Ci},Cki:function(){return wi},Kbf:function(){return Ri},jJi:function(){return Ai},LVC:function(){return Ni},rgL:function(){return Fi},v76:function(){return Bi},nTq:function(){return Hi},oU2:function(){return Zi},RXD:function(){return Wi},zBZ:function(){return ji},QqA:function(){return Gi},oBy:function(){return Yi},y3M:function(){return Ki},Br9:function(){return $i},GDB:function(){return Ji},UQj:function(){return Qi},DT8:function(){return eo},nbD:function(){return no},Bwo:function(){return io},Kkw:function(){return oo},XiT:function(){return ho},DQW:function(){return So},XOS:function(){return wo},LBn:function(){return Ro},K0Q:function(){return Ao},EZo:function(){return Oo},kRo:function(){return Mo},NT5:function(){return Io},OwD:function(){return Uo},eQi:function(){return zo},wA2:function(){return Ko},F8u:function(){return qo},$wM:function(){return $o},kKo:function(){return Jo},u9X:function(){return Qo},WFc:function(){return ea},IGg:function(){return ra},i6c:function(){return ia},tG8:function(){return oa},kiv:function(){return ua},WGj:function(){return la},TJ2:function(){return ca},qxF:function(){return ha},rI8:function(){return da},vIA:function(){return fa},FS1:function(){return pa},SvU:function(){return va},CXA:function(){return ga},m0w:function(){return _a},CKi:function(){return ya},Yae:function(){return ma},mNQ:function(){return Ca},GIx:function(){return Sa},TO7:function(){return wa},QX0:function(){return Ra},vYn:function(){return Aa},FFi:function(){return Oa},Ri8:function(){return Ma},Vfo:function(){return ka},nMf:function(){return Ia},aCk:function(){return xa},v0:function(){return Na},aO6:function(){return Pa},SNT:function(){return La},PpG:function(){return Da},vxn:function(){return Fa},Kas:function(){return Ba},azq:function(){return Ha}});var r,i,o,a=n("vsh_12064"),s=n("vsh_22462"),u=n("vsh_73455"),l=n("vsh_98652"),c=n("vsh_65498"),h=n("vsh_1139"),d=n("vsh_19264"),f=n("vsh_4175"),p=n("vsh_50398"),v=n("vsh_56314"),g=n("vsh_25098");function _(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function m(e){var t,n=(null!==(t=e)&&void 0!==t?t:{}).initNum,r=void 0===n?1:n;return function(e){return r++}}var E=m(),b=(m(),function(){function e(){(0,d.Z)(this,e)}return(0,f.Z)(e,[{key:"componentWillMount",value:function(){}},{key:"componentDidCreate",value:function(){}},{key:"componentDidMount",value:function(){}},{key:"componentDidLayout",value:function(){}},{key:"componentDidPaint",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"componentWillUpdate",value:function(e,t){}},{key:"componentDidUpdate",value:function(e,t){}},{key:"componentWillUnmount",value:function(){}},{key:"componentDidCatch",value:function(e){}}]),e}());function T(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),o=3;o<r;o++)i[o-3]=arguments[o];return R((function(){var e;return null===(e=t[n])||void 0===e?void 0:e.call.apply(e,[t].concat(i))}),e,{tagName:"callLifecycleHook",extraData:{hookName:n}})}function C(e,t){return e[t]!==b.prototype[t]}var S=function(e,t,n,r){var i;if(t){for(var o=L(t).rNode,a={curEl:t,stage:n,error:e,extraData:r};t;){var s=t.instance;if(s)if(T(t,s,"componentDidCatch",a))return;t=t.parent}null==o||null===(i=o.eventEmitter)||void 0===i||i.trigger("error",[a])}};function w(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=r.tagName,o=r.extraData,a=r.disablePrint,s=r.colorType,u=r.throw;try{S(t,n,i,o)}catch(e){}if(a||(i?(0,v._q)(i).custom(s||e,e,t):(0,v.PG)(s||e,e,t)),u)throw t}function R(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{n=e()}catch(e){w("error",e,t,r)}return n}var A=function(e,t){if(!e)throw new Error(t)},O=function(e){throw(0,v.vU)(e),e};function M(){return"undefined"!=typeof window?window:n.g}function k(){var e;return null!==(e=M().navigator)&&void 0!==e?e:{userAgent:"node.js"}}var I=/apple/i.test(null!==(r=k().vendor)&&void 0!==r?r:"")&&/safari/i.test(null!==(i=k().userAgent)&&void 0!==i?i:"")&&!/Mobi|Android/i.test(null!==(o=k().userAgent)&&void 0!==o?o:""),x=new function e(){var t=this;(0,d.Z)(this,e),this._rNodeContextMap=new Map,this.register=function(e){t._rNodeContextMap.has(e.id)&&O(new Error("RNode Context already exists."));try{var n;null===(n=window.__ROADSTER_CONTEXT_MANAGER__)||void 0===n||n.register(e)}catch(e){}t._rNodeContextMap.set(e.id,e)},this.destroy=function(e){var n,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=t._rNodeContextMap.get(e);i&&(r&&i.destroy(),t._rNodeContextMap.delete(e),null===(n=window.__ROADSTER_CONTEXT_MANAGER__)||void 0===n||n.destroy(i.id))},this.getById=function(e){var n=t._rNodeContextMap.get(e);return n||O(new Error("RNode Context does not exist.")),n},this.getAll=function(){return Array.from(t._rNodeContextMap.values())}};M().__ROADSTER_CONTEXT_MANAGER__||(M().__ROADSTER_CONTEXT_MANAGER__=new function e(){var t=this;(0,d.Z)(this,e),this._rNodeContextMap=new Map,this.genId=m(),this.register=function(e){t._rNodeContextMap.set(t.genId(),e)},this.destroy=function(e){t._rNodeContextMap.delete(e)},this.getById=function(e){return t._rNodeContextMap.get(e)},this.getAll=function(){return Array.from(t._rNodeContextMap.values())}});var N=x,P=function(e){return N.getById(e)},L=function(e){return P(e.root)};function D(e){for(var t=e;null!==(n=t)&&void 0!==n&&n.parent;){var n;t=t.parent}return t}function F(e,t){for(var n=[],r=e;r&&(n.push(r),r!==t);)r=r.parent;return n}function B(e){for(var t=new Map,n=e;n;)n.parent&&t.set(n.parent,te(n)),n=n.parent;return t}function V(e,t){for(var n=e.length,r=t.length,i=0;i<n&&i<r&&e[i]===t[i];)i++;return i-1}function H(e,t,n){for(var r=[e];r.length;){var i=r.pop();if(t(i))return i;for(var o=i.children,a=void 0===o?[]:o,s=a.length-1;s>=0;s--)null!=n&&n(a[s])||r.push(a[s])}return null}function U(e,t,n){for(var r=[e];r.length;){var i=r.pop();if(t(i))return i;for(var o=i.children,a=void 0===o?[]:o,s=0;s<a.length;s++)null!=n&&n(a[s])||r.push(a[s])}return null}function Z(e,t){var n=F(e).reverse(),r=F(t).reverse();return{path1:n,path2:r,lcaIndex:V(n,r)}}function W(e,t){var n=Z(e,t);return function(e){var t,n,r=e.startPath,i=e.endPath,o=e.lcaIndex,a=o+1,s=r.slice(0,a);r.length===a||i.length===a?(t=[(0,g.Z$)(s)],s.length--,n=s):(t=function(e){var t=e.startPath,n=e.endPath,r=e.lcaIndex,i=t[r],o=r+1;if(t=t.slice(o),n=n.slice(o),!t.length||!n.length)return[];for(var a=[],s=t.length-1;s>=1;s--){var u=t[s].parent.children,l=u.indexOf(t[s]);Array.prototype.push.apply(a,u.slice(l+1))}var c=i.children.indexOf(t[0]),h=i.children.indexOf(n[0]);Array.prototype.push.apply(a,i.children.slice(c+1,h));for(var d=1;d<n.length;d++){var f=n[d].parent.children,p=f.indexOf(n[d]);Array.prototype.push.apply(a,f.slice(0,p))}return a}({startPath:r,endPath:i,lcaIndex:o}),t.push((0,g.Z$)(r),(0,g.Z$)(i)),n=[].concat(s,r.slice(a,-1),i.slice(a,-1)));var u=t.flatMap((function(e){for(var t=[],n=[e];n.length;){for(var r=[],i=0;i<n.length;i++){var o=n[i];t.push(o);for(var a=o.children,s=void 0===a?[]:a,u=0;u<s.length;u++)r.push(s[u])}n=r}return t}));return[].concat(n,u)}({startPath:n.path1,endPath:n.path2,lcaIndex:n.lcaIndex})}function j(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){var t,n;return null!==(t=null===(n=e.children)||void 0===n?void 0:n.length)&&void 0!==t?t:0},r=Z(e.node,t.node),i=r.path1,o=r.path2,a=r.lcaIndex,s=e.offset,u=t.offset,l=i[a],c=a+1;i=i.slice(c),o=o.slice(c);var h=[];if(i.length){var d=(0,g.Z$)(i),f=n(d);s<=f&&h.push({node:d,start:s,end:f})}for(var p=i.length-2;p>=0;p--){var v=i[p],_=v.children,y=_.indexOf(i[p+1])+1,m=_.length;y<m&&h.push({node:v,start:y,end:m})}var E=i.length?l.children.indexOf(i[0])+1:s,b=o.length?l.children.indexOf(o[0]):u;E<b&&h.push({node:l,start:E,end:b});for(var T=0;T<o.length-1;T++){var C=o[T],S=C.children,w=S.indexOf(o[T+1]);w>0&&h.push({node:C,start:0,end:w})}if(o.length&&u>=0){var R=(0,g.Z$)(o);h.push({node:R,start:0,end:u})}return h}function G(e,t){var n,r=e.node,i=e.start,o=e.end;if(null!==(n=r.children)&&void 0!==n&&n.length){if(i<o)return r.children.slice(i,o).flatMap((function(e){return G({node:e,start:0,end:t(e)},t)}));if(o>=r.children.length){var a=r.children[r.children.length-1],s=t(a);return G({node:a,start:s,end:s},t)}return G({node:r.children[o],start:0,end:0},t)}return[e]}function z(e){var t=e.parent;if(null==t||!t.children)return null;var n=t.children,r=n.indexOf(e);return r>0?n[r-1]:null}function Y(e){var t=e.parent;if(null==t||!t.children)return null;var n=t.children,r=n.indexOf(e);return r+1<n.length?n[r+1]:null}function X(e,t){if(t===e)return null;var n=Y(e);return n||(e.parent?X(e.parent,t):null)}function K(e,t){if(t===e)return null;var n=z(e);return n?J(n):e.parent?e.parent:null}function q(e,t){var n;return null!==(n=e.children)&&void 0!==n&&n.length?e.children[0]:X(e,t)}function $(e,t){if(null!=t&&t(e))return e;var n=e.children;return null!=n&&n.length?$(n[0],t):e}function J(e,t){if(null!=t&&t(e))return e;var n=e.children;return null!=n&&n.length?J(n[n.length-1],t):e}function Q(e,t,n){var r=function(e,t){for(var n=e;n&&t!==n;){var r=z(n);if(r)return r;n=n.parent}return null}(e,t);return r?J(r,n):null}function ee(e,t,n){var r=function(e,t){for(var n=e;n&&t!==n;){var r=Y(n);if(r)return r;n=n.parent}return null}(e,t);return r?$(r,n):null}function te(e){var t,n,r;return null!==(t=null==e||null===(n=e.parent)||void 0===n||null===(r=n.children)||void 0===r?void 0:r.indexOf(e))&&void 0!==t?t:-1}function ne(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:te,r=V(e,t)+1;return e.length===r&&t.length>r?-1:t.length===r&&e.length>r?1:e.length===r&&e.length===t.length?0:n(e[r])<n(t[r])?-2:2}function re(e,t,n){e[t]=n}function ie(e,t){(0,g.f0)(e,t)}function oe(e,t){delete e[t]}function ae(e,t){(0,g.f0)(e.style,t)}function se(e,t){delete e.style[t]}function ue(e,t,n){e.props.sourceStyle[t]=n}function le(e){e.children&&(e.children.length=0)}function ce(e,t){var n=e.children;(void 0===n?[]:n).splice(t,1)}var he={},de=function(e){if(he[e])return he[e];var t=new Set;return he[e]=t,t},fe=function(e,t){he[e]=t},pe=function(e){return Object.values(he).some((function(t){return t.has(e)}))},ve=(0,g.tt)(Object.values(p.Y8).flat()).flatMap((function(e){return[e,"__".concat(e)]}));(0,g.FB)(ve,(function(e,t,n){e[t]=n.toString()}));function ge(e,t,n){!function(e,t,n){e.style[t]=n}(e,t,n)}function _e(e,t){ae(e,t)}function ye(e,t){t.forEach((function(t){se(e,t)}))}function me(e,t){se(e,t)}function Ee(e,t){return e.style}function be(e){return function(e){var t;return{fontFamily:e.fontFamily||g.rk,fontSize:null!==(t=e.fontSize)&&void 0!==t?t:g.n5,fontColor:e.fontColor||g.xw,fontStyle:e.fontStyle||"",fontWeight:e.fontWeight||""}}(Ee(e,p.Tl))}function Te(e){var t=e.style,n=(0,g.f0)({},t);return t.$hover&&pe(e)&&(0,g.f0)(n,t.$hover),n}function Ce(e){return!!e&&p.BN.some((function(t){return e[t]}))}M().__ROADSTER_GET_RENDER_OBJECT_STYLES__=Ee;var Se={log:function(){for(var e,t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];null===(e=window.__ROADSTER_DEVTOOLS_TOOLS__)||void 0===e||(t=e.logger).log.apply(t,r)},warn:function(){for(var e,t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];null===(e=window.__ROADSTER_DEVTOOLS_TOOLS__)||void 0===e||(t=e.logger).warn.apply(t,r)},error:function(){for(var e,t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];null===(e=window.__ROADSTER_DEVTOOLS_TOOLS__)||void 0===e||(t=e.logger).error.apply(t,r)},group:function(){for(var e,t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];null===(e=window.__ROADSTER_DEVTOOLS_TOOLS__)||void 0===e||(t=e.logger).group.apply(t,r)},groupCollapsed:function(){for(var e,t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];null===(e=window.__ROADSTER_DEVTOOLS_TOOLS__)||void 0===e||(t=e.logger).groupCollapsed.apply(t,r)},groupEnd:function(){for(var e,t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];null===(e=window.__ROADSTER_DEVTOOLS_TOOLS__)||void 0===e||(t=e.logger).groupEnd.apply(t,r)}},we={start:function(){for(var e,t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];null===(e=window.__ROADSTER_DEVTOOLS_TOOLS__)||void 0===e||(t=e.timer).start.apply(t,r)},stop:function(){for(var e,t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];null===(e=window.__ROADSTER_DEVTOOLS_TOOLS__)||void 0===e||(t=e.timer).stop.apply(t,r)},get:function(){for(var e,t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return null===(e=window.__ROADSTER_DEVTOOLS_TOOLS__)||void 0===e?void 0:(t=e.timer).get.apply(t,r)},output:function(){for(var e,t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];null===(e=window.__ROADSTER_DEVTOOLS_TOOLS__)||void 0===e||(t=e.timer).output.apply(t,r)},reset:function(){for(var e,t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];null===(e=window.__ROADSTER_DEVTOOLS_TOOLS__)||void 0===e||(t=e.timer).reset.apply(t,r)}},Re={reset:function(){for(var e,t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];null===(e=window.__ROADSTER_DEVTOOLS_TOOLS__)||void 0===e||(t=e.profiler).reset.apply(t,r)},add:function(){for(var e,t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];null===(e=window.__ROADSTER_DEVTOOLS_TOOLS__)||void 0===e||(t=e.profiler).add.apply(t,r)},get:function(){for(var e,t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return null===(e=window.__ROADSTER_DEVTOOLS_TOOLS__)||void 0===e?void 0:(t=e.profiler).get.apply(t,r)},stop:function(){for(var e,t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return null===(e=window.__ROADSTER_DEVTOOLS_TOOLS__)||void 0===e?void 0:(t=e.profiler).stop.apply(t,r)},isStopped:function(){for(var e,t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return null===(e=window.__ROADSTER_DEVTOOLS_TOOLS__)||void 0===e?void 0:(t=e.profiler).isStopped.apply(t,r)}},Ae={isDevToolsEnabled:function(){return!!window.__ROADSTER_DEVTOOLS_MANAGER__||!!window.$devtools}},Oe={addHookLog:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(Ae.isDevToolsEnabled()){var i=window,o=i.__ROADSTER_DEVTOOLS_HOOKS_LOG__;o||((o=i.__ROADSTER_DEVTOOLS_HOOKS_LOG__=new WeakMap).replaceHookLog=Oe.replaceHookLog.bind(null));var a=o.get(e);a&&!Array.isArray(a)||o.set(e,a={hook:[],rootError:null}),-1===n?a.rootError=t:a.hook[n]={type:r,err:t}}},removeHookLog:function(e){var t;null===(t=window.__ROADSTER_DEVTOOLS_HOOKS_LOG__)||void 0===t||t.delete(e)},replaceHookLog:function(e,t){var n;null===(n=window.__ROADSTER_DEVTOOLS_HOOKS_LOG__)||void 0===n||n.set(e,t)}};function Me(e,t,n){var r,i=Ee(e);ge(e,"fontSize",ke(t,n)*(null!==(r=null==i?void 0:i.zoom)&&void 0!==r?r:1))}function ke(e,t){var n,r,i,o,a=null!==(n=null==e?void 0:e.fontSize)&&void 0!==n?n:null==t?void 0:t.fontSize;"string"==typeof a&&a.includes("%")&&(i=null!==(o=null==t?void 0:t.fontSize)&&void 0!==o?o:g.n5);return null!==(r=De(a,Be(i,null==t?void 0:t.fontSize)))&&void 0!==r?r:g.n5}var Ie=/calc\(([^)]+)\)/,xe=/([+\-*/])/,Ne=/(\d+(\.?\d+)?)(px|rem|em|vw|vh|%)/;function Pe(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return Number(e)},n=e.split(xe),r=[],i="+",o=0;o<n.length;++o){var a=n[o];if(xe.exec(a))i=a;else{var s=t(a);if(!(0,g.hj)(s))return null;switch(i){case"+":r.push(s);break;case"-":r.push(-s);break;case"*":r.push(r.pop()*s);break;default:r.push(r.pop()/s)}}}var u=r.reduce((function(e,t){return e+t}),0);return(0,g.hj)(u)?u:null}function Le(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=Ne.exec(e);if(!r)return Number(e);var i=Number(r[1]),o=r[3];switch(o){case"rem":case"em":if(void 0===t[o])return;return i*t[o]*n;case"vw":return i/100*window.innerWidth*n;case"vh":return i/100*window.innerHeight*n;case"%":if(void 0===t[o])return;return i/100*t[o];default:return Number(i)*n}}function De(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if((0,g.hj)(e))return e*n;if(!(0,g.HD)(e)||""===e)return null;if("0"===e)return 0;if(!e.includes("calc(")){var r=Le(e,t,n);return(0,g.hj)(r)?e.startsWith("-")?-r:r:null}var i=Ie.exec(e),o=i[1];return Pe(o,(function(e){return Le(e,t,n)}))}function Fe(e){var t=e.display;return void 0===t||t}function Be(e,t){var n;return{"%":e===1/0?void 0:e,em:null!==(n=t)&&void 0!==n?n:g.n5}}function Ve(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={},r=0;r<p.Nn.length;r++){var i=p.Nn[r];e&&i in e?n[i]=e[i]:i in t&&(n[i]=t[i])}return n.fontSize&&(n.fontSize=ke(n,t)),e&&(void 0!==e.forceLineHeight?delete n.lineHeight:void 0!==e.lineHeight&&delete n.forceLineHeight),n}function He(e){return e.props.sourceStyle}function Ue(e,t,n){e[t]=n}function Ze(e,t){(0,g.f0)(e,t)}function We(e,t){e.context&&(0,g.f0)(e.context,t)}function je(e,t){e.constraint&&(0,g.f0)(e.constraint,t)}var Ge=Symbol("");function ze(e,t){for(var n=0;n<t.length;n++){var r=t[n];if(!e.has(r))return;e=e.get(r)}return e}function Ye(){var e=new Map,t=0;return{set:function(n,r){var i=function(e,t){for(var n=0;n<t.length;n++){var r=t[n],i=e.get(r);i||(i=new Map,e.set(r,i)),e=i}return e}(e,n);return i.has(Ge)||t++,i.set(Ge,r),r},get:function(t){var n=ze(e,t);return null==n?void 0:n.get(Ge)},has:function(t){var n=ze(e,t);return!(null==n||!n.has(Ge))},delete:function(n){var r,i=e,o=[[i,void 0]],a=_(n);try{for(a.s();!(r=a.n()).done;){var s=r.value;if(!i.has(s))return!1;i=i.get(s),o.push([i,s])}}catch(e){a.e(e)}finally{a.f()}var u=i.delete(Ge);u&&t--;for(var l=o.length-1;l>0;l--){var c=(0,h.Z)(o[l],2),d=c[0],f=c[1];if(d.size)break;(0,h.Z)(o[l-1],1)[0].delete(f)}return u},clear:function(){e.clear(),t=0},get size(){return t}}}var Xe={},Ke=function(e){return e.map((function(e){var t=Xe[e];return t||(t=new Map,Xe[e]=t),t}))},qe=function(e){return e.map((function(e){return Xe[e]})).filter((function(e){return e}))},$e=["get","set","has"];function Je(e){var t={};return $e.forEach((function(n){return t[n]=e[n]})),e.toggle=function(n){n?(e.clear(),$e.forEach((function(t){return e[t]=g.ZT}))):$e.forEach((function(n){return e[n]=t[n]}))},e}function Qe(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=Ke(e),o=Je(r?Ye():new Map);return i.forEach((function(e){var r;return e.set(null!==(r=t)&&void 0!==r?r:o,(0,g.f0)(n,{cache:o}))})),o}var et=function(e,t,n){return Qe(e,t,n,!1)};function tt(e,t){var n=qe(e);(0,g.Rw)(t)?n.forEach((function(e){return e.clear()})):n.forEach((function(e){return e.delete(t)}))}function nt(e,t,n,r){var i,o=function(e,t,n){return Qe(e,t,n,!0)}(t,null!==(i=n)&&void 0!==i?i:e,r);return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n.length?n:[this];if(o.has(i))return o.get(i);var a=e.apply(this,n);return o.set(i,a),a}}var rt=function(e,t){var n=qe(e);return(0,g.Rw)(t)?n.map((function(e){return Array.from(e.values())})).flat():n.map((function(e){return e.get(t)})).filter((function(e){return e}))};function it(e,t){new Set(rt(e,t).filter((function(e){return e.cache.size}))).forEach((function(e){var t=e.cache,n=e.willClear;null==n||n(t),t.clear()}))}function ot(){it(Object.keys(Xe))}function at(e,t,n){new Set(rt(t,n)).forEach((function(t){return t.cache.toggle(e)}))}function st(e,t){at(!1,e,t)}function ut(e,t){at(!0,e,t)}var lt=function(e){return e.parent};function ct(e){var t=e.scopes,n=e.check,r=e.initValue,i=e.cbk,o=void 0===i?g.m4:i,a=e.next,s=void 0===a?lt:a,u=e.key,l=e.options,c=et(t,u,l);return function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,i=[],a=e,u=t;a;){if(c.has(a)){u=c.get(a);break}if(i.push(a),n(a)){u=o(a);break}a=s(a)}for(var l=0;l<i.length;l++)c.set(i[l],u);return u}}var ht=new Set;function dt(){return{has:function(e){return function(e){return ht.has(e)}(e)},add:function(e){return ht.add(e)},consumeElement:function(e){ht.delete(e),e.instance&&(e.instance.nextState=null)}}}function ft(e){return!!e.renderFunction}function pt(e,t){return void 0!==e.key||void 0!==t.key?e.key===t.key:e.type===t.type}function vt(e){return function(t){var n=t.parent;return n&&e.has(n._id)&&e.get(n._id).counter<1?n:null}}function gt(e,t){for(var n=t.parent;n;){var r=e.findIndex((function(e){return e===n}));if(-1!==r){e.splice(r+1,0,t);break}n=n.parent}n||e.unshift(t)}function _t(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.parent,r=e.props.provides,i=null!==(t=null==n?void 0:n.props.provides)&&void 0!==t?t:Object.create(null);return r?(0,g.f0)(Object.create(i),r):i}var yt,mt=dt(),Et=new Map,bt=new Map,Tt=new Set;function Ct(){for(var e=0,t=Array.from(bt.keys());e<t.length;e++){for(var n,r=t[e],i=null!==(n=bt.get(r))&&void 0!==n?n:[];i.length;){var o=i.shift();"function"==typeof o&&o()}bt.delete(r)}}function St(e){if(!Tt.has(e)){var t=L(e);Tt.add(e),Promise.resolve().then((function(){t.destroyed||(Tt.delete(e),function(e){var t,n=(null!==(t=Et.get(e))&&void 0!==t?t:[]).filter((function(e){return mt.has(e)})),r=L(e).rNode;if(!(r.operator.getOperationSet().length||null!=n&&n.length))return;Et.set(e,[]),r.patch({elements:n,funcQueue:bt})}(e))}))}}function wt(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.instance;(mt.add(e),r)&&(r.nextState=(0,g.f0)({},r.state,null!==(t=r.nextState)&&void 0!==t?t:{},n));var i=D(e),o=Et.get(i);o||(o=[],Et.set(i,o));var a=o.find((function(t){return t===e}));a||gt(o,e),St(i)}function Rt(e,t){var n=bt.get(e._id);t&&(n||(n=[],bt.set(e._id,n)),n.push(t))}function At(e){yt=e}var Ot=new(function(){function e(){(0,d.Z)(this,e),this.plugins={}}return(0,f.Z)(e,[{key:"use",value:function(e){var t,n=_(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.plugins[r.type]||(this.plugins[r.type]=new r)}}catch(e){n.e(e)}finally{n.f()}}},{key:"has",value:function(e){return!!this.plugins[e]}},{key:"push",value:function(e,t){if(yt){var n,r=this.plugins[e.type];if(r)null===(n=r.onPush)||void 0===n||n.call(r,e,t)}}},{key:"pushQueue",value:function(e,t){var n,r=_(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.push(i,t)}}catch(e){r.e(e)}finally{r.f()}}},{key:"clear",value:function(e,t){var n,r;null===(n=this.plugins[e])||void 0===n||null===(r=n.clear)||void 0===r||r.call(n,t)}},{key:"clearAll",value:function(e){var t,n;null===(t=this.plugins[e])||void 0===t||null===(n=t.clearAll)||void 0===n||n.call(t)}},{key:"flush",value:function(e,t){var n,r;yt&&(null===(n=this.plugins[e])||void 0===n||null===(r=n.onFlush)||void 0===r||r.call(n,yt,t))}}]),e}()),Mt={},kt=new WeakSet;function It(e,t){var n;if(!kt.has(t)){kt.add(t);var r,i,o=null!==(n=Mt[p.j2.Component])&&void 0!==n?n:t,a=Mt[e]||{},s=t.layout,u=t.paint;if(s){var l=s.buildContext,c=s.createChildConstraint;l&&(s.buildContext=(i=l,function(e,t){var n=e.runtime;if(n){n.context={inheritedStyle:null==n?void 0:n.constraint.inheritedStyle};var r=e.parent;if(r){var o,a=r.runtime;if(null==a||null===(o=a.context)||void 0===o?void 0:o.isWeakWidth){var s=n.constraint,u=s.maxWidth,l=s.originMaxWidth,c=s.flexWidth;u=(0,g.hj)(l)?l:u;var h=Ee(e),d=h.width,f=h.maxWidth;void 0===c&&((0,g.hj)(d)&&d<=u||(0,g.hj)(f)&&f<=u)||(n.context.isWeakWidth=!0)}}}i(e,t)})),c&&(s.createChildConstraint=(r=c,function(e,t,n){var i=e.runtime,o=t.runtime,a=i.constraint,s=He(t);o&&(o.constraint=(0,g.f0)({},a,{inheritedStyle:Ve(s,null==a?void 0:a.inheritedStyle)})),Xa(e)||je(o,{minWidth:void 0,minHeight:void 0}),r(e,t,n)}))}if(u){var h=u.commandPlugins;null!=h&&h.length&&Ot.use(h)}Mt[e]=Object.fromEntries(["build","reconcile","layout","paint","mutate"].map((function(e){var n;return[e,(0,g.f0)({},o[e],null!==(n=a[e])&&void 0!==n?n:{},t[e])]}))),e===p.j2.Component&&Object.keys(Mt).forEach((function(e){e!==p.j2.Component&&It(e,{})}))}}function xt(e){return Mt[e]}function Nt(e){return xt(e.type)}function Pt(e){return"getSideEffects"in e.type?e.type.getSideEffects():Mt[p.j2.Component]}function Lt(e){return!(null==e||!e.individual)}function Dt(e){var t;return!!Ua(e,p.j2.InlineFlow)&&Lt(null===(t=e.runtime)||void 0===t?void 0:t.context)}function Ft(e){return!!Jo(e,p.j2.InlineFlow)&&Dt(rs(e))}var Bt=Object.create,Vt=Object.defineProperty,Ht=Object.getOwnPropertyDescriptor,Ut=Object.getOwnPropertyNames,Zt=Object.getPrototypeOf,Wt=Object.prototype.hasOwnProperty,jt=function(e,t){return function(){return t||(0,e[Ut(e)[0]])((t={exports:{}}).exports,t),t.exports}},Gt=function(e,t,n){return n=null!=e?Bt(Zt(e)):{},function(e,t,n,r){if(t&&"object"===(0,c.Z)(t)||"function"==typeof t){var i,o=_(Ut(t));try{var a=function(){var o=i.value;Wt.call(e,o)||o===n||Vt(e,o,{get:function(){return t[o]},enumerable:!(r=Ht(t,o))||r.enumerable})};for(o.s();!(i=o.n()).done;)a()}catch(e){o.e(e)}finally{o.f()}}return e}(!t&&e&&e.__esModule?n:Vt(n,"default",{value:e,enumerable:!0}),e)},zt=jt({"../node_modules/tiny-inflate/index.js":function(e,t){function n(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function r(e,t){this.source=e,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=t,this.destLen=0,this.ltree=new n,this.dtree=new n}var i=new n,o=new n,a=new Uint8Array(30),s=new Uint16Array(30),u=new Uint8Array(30),l=new Uint16Array(30),c=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),h=new n,d=new Uint8Array(320);function f(e,t,n,r){var i,o;for(i=0;i<n;++i)e[i]=0;for(i=0;i<30-n;++i)e[i+n]=i/n|0;for(o=r,i=0;i<30;++i)t[i]=o,o+=1<<e[i]}var p=new Uint16Array(16);function v(e,t,n,r){var i,o;for(i=0;i<16;++i)e.table[i]=0;for(i=0;i<r;++i)e.table[t[n+i]]++;for(e.table[0]=0,o=0,i=0;i<16;++i)p[i]=o,o+=e.table[i];for(i=0;i<r;++i)t[n+i]&&(e.trans[p[t[n+i]]++]=i)}function g(e){e.bitcount--||(e.tag=e.source[e.sourceIndex++],e.bitcount=7);var t=1&e.tag;return e.tag>>>=1,t}function _(e,t,n){if(!t)return n;for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var r=e.tag&65535>>>16-t;return e.tag>>>=t,e.bitcount-=t,r+n}function y(e,t){for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var n=0,r=0,i=0,o=e.tag;do{r=2*r+(1&o),o>>>=1,++i,n+=t.table[i],r-=t.table[i]}while(r>=0);return e.tag=o,e.bitcount-=i,t.trans[n+r]}function m(e,t,n){var r,i,o,a,s,u;for(r=_(e,5,257),i=_(e,5,1),o=_(e,4,4),a=0;a<19;++a)d[a]=0;for(a=0;a<o;++a){var l=_(e,3,0);d[c[a]]=l}for(v(h,d,0,19),s=0;s<r+i;){var f=y(e,h);switch(f){case 16:var p=d[s-1];for(u=_(e,2,3);u;--u)d[s++]=p;break;case 17:for(u=_(e,3,3);u;--u)d[s++]=0;break;case 18:for(u=_(e,7,11);u;--u)d[s++]=0;break;default:d[s++]=f}}v(t,d,0,r),v(n,d,r,i)}function E(e,t,n){for(;;){var r,i,o,c,h=y(e,t);if(256===h)return 0;if(h<256)e.dest[e.destLen++]=h;else for(r=_(e,a[h-=257],s[h]),i=y(e,n),c=o=e.destLen-_(e,u[i],l[i]);c<o+r;++c)e.dest[e.destLen++]=e.dest[c]}}function b(e){for(var t,n;e.bitcount>8;)e.sourceIndex--,e.bitcount-=8;if((t=256*(t=e.source[e.sourceIndex+1])+e.source[e.sourceIndex])!==(65535&~(256*e.source[e.sourceIndex+3]+e.source[e.sourceIndex+2])))return-3;for(e.sourceIndex+=4,n=t;n;--n)e.dest[e.destLen++]=e.source[e.sourceIndex++];return e.bitcount=0,0}!function(e,t){var n;for(n=0;n<7;++n)e.table[n]=0;for(e.table[7]=24,e.table[8]=152,e.table[9]=112,n=0;n<24;++n)e.trans[n]=256+n;for(n=0;n<144;++n)e.trans[24+n]=n;for(n=0;n<8;++n)e.trans[168+n]=280+n;for(n=0;n<112;++n)e.trans[176+n]=144+n;for(n=0;n<5;++n)t.table[n]=0;for(t.table[5]=32,n=0;n<32;++n)t.trans[n]=n}(i,o),f(a,s,4,3),f(u,l,2,1),a[28]=0,s[28]=258,t.exports=function(e,t){var n,a,s=new r(e,t);do{switch(n=g(s),_(s,2,0)){case 0:a=b(s);break;case 1:a=E(s,i,o);break;case 2:m(s,s.ltree,s.dtree),a=E(s,s.ltree,s.dtree);break;default:a=-3}if(0!==a)throw new Error("Data error")}while(!n);return s.destLen<s.dest.length?"function"==typeof s.dest.slice?s.dest.slice(0,s.destLen):s.dest.subarray(0,s.destLen):s.dest}}}),Yt=jt({"../node_modules/unicode-trie/swap.js":function(e,t){var n=18===new Uint8Array(new Uint32Array([305419896]).buffer)[0],r=function(e,t,n){var r=e[t];e[t]=e[n],e[n]=r};t.exports={swap32LE:function(e){n&&function(e){for(var t=e.length,n=0;n<t;n+=4)r(e,n,n+3),r(e,n+1,n+2)}(e)}}}}),Xt=jt({"../node_modules/unicode-trie/index.js":function(e,t){var n=zt(),r=Yt().swap32LE,i=function(){function e(t){(0,d.Z)(this,e);var i="function"==typeof t.readUInt32BE&&"function"==typeof t.slice;if(i||t instanceof Uint8Array){var o;if(i)this.highStart=t.readUInt32LE(0),this.errorValue=t.readUInt32LE(4),o=t.readUInt32LE(8),t=t.slice(12);else{var a=new DataView(t.buffer);this.highStart=a.getUint32(0,!0),this.errorValue=a.getUint32(4,!0),o=a.getUint32(8,!0),t=t.subarray(12)}t=n(t,new Uint8Array(o)),t=n(t,new Uint8Array(o)),r(t),this.data=new Uint32Array(t.buffer)}else{var s=t;this.data=s.data,this.highStart=s.highStart,this.errorValue=s.errorValue}}return(0,f.Z)(e,[{key:"get",value:function(e){var t;return e<0||e>1114111?this.errorValue:e<55296||e>56319&&e<=65535?(t=(this.data[e>>5]<<2)+(31&e),this.data[t]):e<=65535?(t=(this.data[2048+(e-55296>>5)]<<2)+(31&e),this.data[t]):e<this.highStart?(t=this.data[2080+(e>>11)],t=((t=this.data[t+(e>>5&63)])<<2)+(31&e),this.data[t]):this.data[this.data.length-4]}}]),e}();t.exports=i}}),Kt=jt({"../packages/core-unicode/node_modules/base64-js/lib/b64.js":function(e){!function(e){var t="undefined"!=typeof Uint8Array?Uint8Array:Array,n="+".charCodeAt(0),r="/".charCodeAt(0),i="0".charCodeAt(0),o="a".charCodeAt(0),a="A".charCodeAt(0),s="-".charCodeAt(0),u="_".charCodeAt(0);function l(e){var t=e.charCodeAt(0);return t===n||t===s?62:t===r||t===u?63:t<i?-1:t<i+10?t-i+26+26:t<a+26?t-a:t<o+26?t-o+26:void 0}e.toByteArray=function(e){var n,r,i,o,a,s;if(e.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var u=e.length;a="="===e.charAt(u-2)?2:"="===e.charAt(u-1)?1:0,s=new t(3*e.length/4-a),i=a>0?e.length-4:e.length;var c=0;function h(e){s[c++]=e}for(n=0,r=0;n<i;n+=4,r+=3)h((16711680&(o=l(e.charAt(n))<<18|l(e.charAt(n+1))<<12|l(e.charAt(n+2))<<6|l(e.charAt(n+3))))>>16),h((65280&o)>>8),h(255&o);return 2===a?h(255&(o=l(e.charAt(n))<<2|l(e.charAt(n+1))>>4)):1===a&&(h((o=l(e.charAt(n))<<10|l(e.charAt(n+1))<<4|l(e.charAt(n+2))>>2)>>8&255),h(255&o)),s},e.fromByteArray=function(e){var t,n,r,i,o=e.length%3,a="";function s(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)}for(t=0,r=e.length-o;t<r;t+=3)n=(e[t]<<16)+(e[t+1]<<8)+e[t+2],a+=s((i=n)>>18&63)+s(i>>12&63)+s(i>>6&63)+s(63&i);switch(o){case 1:a+=s((n=e[e.length-1])>>2),a+=s(n<<4&63),a+="==";break;case 2:a+=s((n=(e[e.length-2]<<8)+e[e.length-1])>>10),a+=s(n>>4&63),a+=s(n<<2&63),a+="="}return a}}(void 0===e?e.base64js={}:e)}}),qt=Gt(Xt(),1),$t=Gt(Kt(),1).default.toByteArray("AAARAAAAAACA5AAAATMPzPDtnQuMXUUZx2e729u9d+/u9m67LaUUWlpoi9FWEiyighaxSkSkhocYQVArIiJiVUQE1AaiNBQQg4AKlkRqFRFBrUiaRgmQUqFQEyAQeQakSloaGrGp6H9yZ3Jnh3k/zrnQ8yW/zJkzr2++eZy5cx73iV5CngP/Aq+AZh8hk8E+YA44CBwc4L4TvA98CBwHTgCnOKRbBs42hC8HF4AVYCW4ClwHbgRrhHi3gN+Bu8DdYCN4GDwEHgNPgxfBy+BVsJul7RvfdptwJ4PpYAY4ALwVHAIWgSPAEnAsOA6cBD4FzmDh54DzWDj1XwQuBavAleBacCNYw8J/A9aBDcx/H9jMyn8UPAX+wfKn+m2D+2/wP9BTI6QOdve2/S0cT2H+feEeWGuneRvcd4DDwGIWTuNSjmbuR1hczgm1DqcwPgOWMcS4Js5G3K9J8a+Arhd65OHCJUJ+l+P4KnAdWA3W1jr1/S24E/xZKn8j/OsF/yb4/waeENJSnmHptgrndoBdYNyEdr+n0PZ9P9w6zrXANDBrQjvtPOYugLsIHD6hU+4HcPzhCfp68vxjbPUx5P8J8GnwBfAV8E3wXXAZWAWuATeA1WAtuI3ptI65G+DeBzaDR8FT4AUWtg3uTrBbUw/S3zmu4XhIYlg4ngqmg9ngLeBgcBhYDI4GS8HJ4HRwJjgXnA++w8q4BO7l4Grmvx7u6n5/m61laW6Du84j/YaAsu6V0jwo+Gm/pO3/CM49CV7ob4/nbf3ubAevAlJHU4CJYC8wkx3Pq5vTLxTCD7XEraioSAefB8rWo6KioqKioqKi4o3Fu7v0d9uR9bH7ITo+WG/v5dHjY3C8RQg7vm5P/0nE+SyLdxbcM/ra+zXLcXwBy3sF3MvAD+rt/bif0v0DHN/E0v0S7u31sftDlD/h3F8NZf8F4feDTTQeeAA8CDaDh6qwKqwKq8KqsORhj4InwTP19p5pmWytl8uOiooKLbHr2F3IY1yDkFoj/D5dQ5N2BOf3BvuD+eDtUrxD4H8POAocA44HJzfaep0O98xG+fPP9uE2CycScg5YY+A5MKdFyEmt14f9SDq3Gf6JI/h9AC4eaZ+7A+52MG8S1vhgBbgYNlgPXgOHDxByIVgNNoP34twO5heZ1cRvgZ4OpzXbcTnfh38j2AqGBwkZBR8FV4DNYHiIkGPBqqGx+exp3Do01m4VFRUVexLbSp4DyYQ9lwXD5f/+KxvTuvNc9I/zG/rwCxr6/FYgbKWUdhX817Bz52ue+6PPBN6Z+JlAE9dq6neDod6UmxG+FLreooh3Bzt3lyUPG3cr7Gtqw02K8rawc48LYX9vtJ9DPBLHz+P4JebfCfe/oHeg7R+AOwlMZX66773fQGdPe+7AWB0WwH893EUD7edej4C7hB4PqHXeB3meONDR6yhwqiIuj38D+NxAx0/jfwn+r7M8LoJ76UDnudZVOL7GlN+A2u78fsLPEf5rqY6/h389uAdsBA+zPB6D+7QmPx20Pi8izXawE+xSlDWu2T5uNDt1szHS1Je5F8JmGsLLYF6X6VMGC5kNDjXY4l2asMXN7r6OmDg6YdvTZ2KXNjvH9DpyIvOfCndZQf3si5pyljfbz+x+Q2ivbzfz30sNrcf3mJ5XdkH/KpMfOrbRTxDvZ+Bmzzalz2GXXUff8X1rs/MOwp7KHzznk/WIfw94TLFOe+ANdg3cAn0fSaAzteOTrC89D/cl8EoXzTebauZwqvdug760jn2DhDQH3W3SYnGnDZZff585gTNrcGz4/ALqsZDZ7BAPO5s4zEFn27y+GHksGWy/v3QMc5cOtsM+Puh/HT8NaT4Pvgy+KqT/Fo5XgJXgauH8j3F8E/gF+BW4nYX9Ee4GId69OL6f+bfAfXzw9euGZwW7nsXS/ZOde5m5/4G7Rsj3NRzXhtrHQ8ydDHf60Nj8n5VsMRvhc4f0bUPfFVswVOzzaN3GItT/vL7wa1c3zbGhlH1vuEyOQPs/3ttDRgmx0gIHgP0ZcxzSuDIf4BJJ0Byk2X6VkDTYMT1HZZwQhq5LJjKXbsMOONLPaArUJH9uCKvDuALLlMunbdnD/KOkElWfPFBzPgd9TA/a5+sCtH1mMfgxHyMt0mlTno7HHZHSivRKfkLy9rdZmfPv9vK7Dd4/xD7A/a42k/uUmGbEkrYIihq3bwT6AtPoCNEhtB3la7WtbcvudzmhtqBzPhd+vs78ZfezEFpCu40qjmvMtclgFxHavg0BeZ3qY9Oa4HLK7ru552bX9X9DOJZ1ylnnGrHX3WYfOVwVl8dxtUfqdn0z9CkuZY+Tsu3UJOFSRv/LaRM5DZ2b+ZjmQuOJv9uK0FWnv3xeF49L0XbOVa5OfNs3xfgJoYgyYuqfs0+krLstL1/9Wowi5zV5vJTRPlxStY9pjIplyWKzERff9uHrbVXe/Lw4n+vqZdKxqPZJgUlsOqjEtT1U49K1v3Apsz1i7Z1aDy4+46FOzJJi/If2w1zjP6RPi1LmtVOlZyq7m2xgmydESXm95POwTqfQa3yZ49+1TXKPf5O47ueLOhd9D6DIuYhLavv7zj02XXLbOoXdXcvL3f9d8tatE2VEKbpP+o53sR18ZW6XIEs9Mr8mcbcj/13Y7bbx7Rcqm4xIiOf6hOMW89cU9LF08j0J23yQ+ne3fN+Ju1R6BDdmLSFL6FhvOZwv+proOkfx8RE7t4t9S7e24PenVeI7nuW8Y8eha/m69NNKZu+SmV4yudZSpnlDXieZxlFuyiy76PKp8GsAF19dbfNeKK7rwFDdfcrXrX1y6uBT79Tlk4jyU6/ruO3HC37e98T1L5fYfYBU7cfXgVz/Eem83Mf482Y59I9Z26WEEL91VY7fj03Jz9sjdt0S+1uOS6weOdvPZF8ep8zffj7jJxadpKhDLC7jkEvI74UWCbv2p9BdLF+2V1nzWkwbpfq9n2p+lCVVOS7ly/3K5zkEnc6p91Ny4TqWbCL3sRTzh2lsjUrHZY9FCl9rEaLuU5w+yT+Z6b6fUA853iQy9l2QXtJ5b69X4RfjUoYFaH78HUNVO9ByGxZEHWg54xk62/Qz3XqEuKb4pv4q9lvd9WGKIi3R1NfUF7m4vOPE6ye+ryO/w+OSngTYRR6jdQPyO3A+qNI2FMcxZdQd2ifFNcYkol15f5fb0PV+lZjO59lV136T4/07U9mq99hU70Ga0JXnm87VLrLkKM9Hp9C6qPSSz6nCuSu/92prW5Ut5DqYbGfqQy79IaStbeWmGA8m25j8KfpPqvxdbRZru1i9fBlOoAMV8T5lqK5DDJ8yc9h0SCLWNqnF9/qRk2ZgGrlf5NDLZwylKCtUB1db+uSj8ruel/OIrZ+r3V3T5Bjfpnrb7Mbz4eFDinJmkDTzSUgddTZMYcuYdlf1OW4/VZwUOhdlf1u9i0bu8zbksanq07M08VXjQQ4Tx53OTio9VPmo9JlhKFeFylYzJIrqI6K/VwMN4/fFZP2p9AS4Oa7Dof2d61TkGHG1Uxll+rpl2q3IsovqK6n6tYxpH1UU8TkFvodbI273I2y4PjejEqq3bo6yYdr3F/epiVRPcQ4U/VRMY0LOnz/jodoXV9lpEkO3l04UZejqpCuLz+kudeHie21PjSz8e349QpzxUnyXOcw1/njhWExnQ7cXrourOs/vzcj2mM2ObW5uiirHVr5LvW1hs0lHeFuNl+Bt0m32T1V/Vf+bTdT9UOyPPjI7EptNbOvFHO2gs40NF0mxDuDXo9TP6aru1YY+YxCrg3jNE3G1r6yT73MQOeyp00Glvw7Xe6Oh8PdVxLWFSULvEcc8D+RSfuwzMib7uPQfW3k5nrPPfS+fllHGOzyimGzu8gxjaH/j6ct8n0rUI3U/cO0LvvOnnLev/V3b1dUOqnxi6m8b47H1l2Uq2KtAii7PV1K+qydLGe/ryTKvZA4qmZxrnabC3lTot3BHid93c7vtm7yx8D2TosuV17ex67p+0tnr4d8mlvfNholeYsvX/U702Z+X05l+g/YILhX+W1+8/2MrxwZ/DlX1m7eMvsplCnN5PWVdVTbskVyfPQJ5n6DmmUcsJFD3XOVz2/ZIx9xOqfaEisC0R1aEXbnw573FcP6sKRXfa5tKxPlqJmnvq3EpYxyLYtr7KevaKK7nc9XbVXLvYfnYxOX3ZFn6USnjWxCi8PKL2KcK7W8u9yRd+4Isqri6ckxrMlueOdrN1R6+eyqx+wE+9RH3JXzTu7Z5UX04R54pxxEX2/5QUXOSaz8TbSna1rWuZfUjeVy67ueRBDr79Iuc4z30muKjl2r+K2sM8jLF94NtotJTft5G1c/4sc/75yNS/iFj3bctdc8n8XZ2KdN0n7XI8a2Soq6XKeYAVf+JGaNEyFslPmvuWH181jiyjq7rAtVc4ztP8frr2kHVbiZJcb+afw+SP8chf1PUtgYPWY+K5ctxfSS2/vK3WF1IKTnnXrE/6STWfrES+10rV/3l7721AsrKIbmvv6a5Jff1UrduEfPxeZaKSjdcb2OvTzSPESGvIsVH/9xrEpe+IqJav7aIny1926+oPiFfM8Xrjc/4UNU3lpDnHrn4/D4JRRT+rGCqPsoltn1dcBHbeLFJUfNnzNxokpzzT+75Tofqm1up+q2PxO798TxC5woSWb6vXXoE5HjyOR6faOLn1lmnp28+pv+jF+uok9g6xNoidP5KvbfNRXctd5VYPXzWFCp4mKv42D/3uIhtU1l0685UhOgovyOm+18OnfisLVSSq+1cxff5lNQSW8ei9NRJ7PtwNol9tij3HGGaM1X3VnzX4yn10c0Vueej1HOWb52LbHsurtex3ORqW5Vdc123fNpQjKu6VxAjKWwWK0WWpZKYMWHTP+W4SqG3rZ+lkJh5bdRiA9t+i883hF31ib2+2fqHLGXcX4qxl7z/kuv95lAJ+YaVuN5K/V2s1Pk1M+ib45n4fQpCVfYMzfkUqNqgyDJ058Vv2ansoAovmn0VyPqp9LWRQjef8nz0Ueknx3WtywxDnj59S+XqytKlDR0Dpjk/tg1dry05885VN1u/dWm/0Pxdy0xB0XYMKcc01ov6rqj4rT3T/8ik7hO+865vman7VWq75y4/tf6p9Ms1XmPrp1vvuPRfn7WET3/3WSMUuS7LVYZqLRNTnml9FLMmLGMNHLtujZXY/YWi7KSrd1nfMdHJ/wE="),Jt=new qt.default($t);var Qt=Gt(Xt(),1),en=Gt(Kt(),1).default.toByteArray("ABAOAAAAAABAigAAAYkHdvjtmguIVUUYx2fbe/fedXddCYOlDHqCvUCKRAssKhXs/TKiMiJ6kUQPkbQwUVtIM0ipdCUkQ4XoQWX2AqMCKQINyhQMxCK06KGlgZTV/3Dmsl+zM3NmzpmZc1zngx8zd2bOzDcz33wzZ+6Z0s7YVWA6mAFmg3kkrWjYD54Bi8Eyg/IDYI0mfx14HWwEm8BmsAV8Db4l5XaDH8Gv4E/wN6jVGGsHXWAU6AMD4CWwtpY+exIPX0U4FmwAG8EmsBlsAVvBdrAL7AF7wT5wkPw+DOr1tHwPwuPq6fMnInwH4en1tJ1z6mn++fXB+i9E/FJwObge3AjGkfaT525D2tRmGr8L8Zm8voQHEX+U/34c4UIeX4JwORgAY0j5NYi/At4CH5D0hPubg8zizAVPc2hZHS8blnPNJ+jPZ6CNk6RtQfgNj8+q/b/8RKTvFMbg+7q6/p943n6Eh3h8AfiL57d1wO5ANzgWHA9O6UjzzuDhuI6h9Y5H2iRJeot+TtHxmYv+z+djMI2kJ314UdPviH8mC/O/VWIDLtrpJPM8TWNzkUgkEolEIpFIJBKJVIFr8e5aJ/c58wzuL27GM3eQd96fG4xd0WTsPqQ9xNPnIJwPZjbT+8AnEb8B8aU8fznCVWA1/70e4e8I38h4l34X+c+hnufBC2AFWAkGwKpmzIt5MS/mxTzXeQvAU2Bps/w9KxKJDF8+9Px/yrL2wf/VRWZI0uj5eFHNj042rOhJ2QEmGNA3krGxI4em3yukrcDvHaCvl7FretO0RQjfA/tA9yjGLgaXdTE2C3zXydjJIxhrtqXcSuIib3ap8yhP8Dr2o/wGxM/uxjsEWAe2d5vVEYlEIpHhyQHsCzXsD7/hnHAA++Fh8Af/Tmg89udJfI/+BxxC2i14Z/mX59cajE0he3h3I713ovtr8s3I6Mbgd2RjED+tId+Lz0T6uSTvAsQvUZRNmIq8q0n+TYj3En1uJ3nJ91/3aOqaqclLmIZ6rxPOK4/gmcfAQjAdeYt5HTNynGueJe2vRHy1oM9a/L6b1/tahq6Ut1H2ATz3PsKPLZ7zycPg84roQvkFOl0ZsL0lyXeaaPMHyRm9foTeDSTf7/YTZgv0a1hWG1r+aKPI2H+a8a7XK/ilLyr4rd1X0Gm7Qq+Jjr4H3WbZ7128PP2GuIuP5R7PY7iV+8ltFfCXO6HDnfBLu4kueyugl28S33SwkZ6NXNTV00zD0QhPAKceQb7+LOh6HtGXSebf1lY/4mtoQsFxKPq8CWLf5gzTb9QvKjiWX1agD5Pb2xgCI44h8TbDZ0yIUp7E8XdnxyHt3+W81Y5yXEqodqomZc9h3nmnoSo+3KWhwFRsx7zKe04V/UsoG9T1oZFRRqxDVtaHUL3KkirZSpXlaBgHV31zOQZZ/tx0ThoWZV3SlKQxnt5C/E19lk5cjLPYrqg7TW+JTDcbXWz25yxpjZ/OTlTj72p/a0pgQpzqQee4ScKyfYfOhmXrRyaq81jRtWOrcyPjOVdC22tmlA2lS0I7c9//Vp115u7+y/fdmov7DJkfpyLzna050OFif6nq/aXMV8j0F9N15UJJnnZdnxtU/rAsoWuAMf25Qaa3WJ7ujbpnbfQLbSe0bXGvD9m2qINqDEUdaXmbtkzLhpyPmhAva73o1oesrExvsazLcSxav2q907rF868PO/BtX0X9kUs9qD4+1ndef1uGqHxt1vu0ad027ZfxzibbT1vpujNUVp1lzmci4rlAdkaQza+v/rkYkzz7j3hmKlNEe7LRR7Xfyc4otLzsLsX1WhNtLq+vzzr3uhJTfYvYeVl7XYi2RBuTtedyvZnMkQyTs1XR9oro54qiYjpuYn9t9oyiYnr29zEeeetIxPTOtYj4GHvRHnzV73tPNrFpasu6vdL0fsbWdnyuHV0fZemiyPqvqse3D5D5HR9C+2vi+2nIMp4xHUcTm1LVHVKy+qnqL00vS3zsrWXNAxWZLcnWvM91K7Yhm3uZfrZi4rdN1qKPs4P42xTb9yid3jTP9VktlN9XteuqnjzzJatL91uV5lJka9y3Dqr1FkryrC8Xfr7Vdl69fIitj3G9R8n8qW7/UbVflj8x1TnvHJo8o1q3ocT12Mv8KhPSVM/Z6mJqX3nfHVTvguI9emj7lUmZOoRo28anqvZ4k3p9S95zna4uHxJ6XFpC11gZYuqvVM/K9pQyzgYtfVyK7d1F0fc71d5sc8dqo7MPobqLe5Tqt+m42egs1ms6DiHttSVF3uepffgUV/Wr+iDrj2oNlPEeJhNdX1qien8sqw+u28xru3lsVmUbOhuyqdtkH3MtefaYkHPYEnEOaXmxrtBiMm4h1plpGza+vYiY3LO6Wj9ZYjpHMh2z+uHbr5rYkzieTFJGJ7K7fbG+ov4zS0Q79CE6X6cqV+adg67dvDbt2zZdis8+iHadBxvdi+hoKj7XjqmY+HdT+yxi43nq9CUh2shq1zWu2jLpg01/fYlK9zL9cFbdIddNVrs+xFcbHYFwJb78vus9MYSE1KPI2cEFnRWAyoiS6fJMj4CtuOyrKL77boIo3WzomPkkdHui/Ac="),tn=new Qt.default(en);var nn=function(e){return e>=55296&&e<=56319},rn=function(e){return e>=56320&&e<=57343},on=function(e,t){return 1024*(e-55296)+(t-56320)+65536},an=[function(){var e=0;return{next:function(t){var n=1===e&&2===t;return e=t,n?2:0}}},function(){var e=0;return{next:function(t){var n=3===e||1===e||2===e;return e=t,n?1:0}}},function(){return{next:function(e){return 3===e||1===e||2===e?1:0}}},function(){var e=0;return{next:function(t){var n=9===e&&(9===t||10===t||12===t||13===t);return e=t,n?2:0}}},function(){var e=0;return{next:function(t){var n=!(12!==e&&10!==e||10!==t&&11!==t);return e=t,n?2:0}}},function(){var e=0;return{next:function(t){var n=(13===e||11===e)&&11===t;return e=t,n?2:0}}},function(){var e=0;return{next:function(t){var n=function(e,t){return 4===e||8===e||4===e||5===e||8===e||7===t?2:0}(t,e);return e=t,n}}},function(){var e=2;return{next:function(t,n){var r=function(e){return/^(?:[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u2388\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2605\u2607-\u2612\u2614-\u2685\u2690-\u2705\u2708-\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763-\u2767\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC00-\uDCFF\uDD0D-\uDD0F\uDD2F\uDD6C-\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDAD-\uDDE5\uDE01-\uDE0F\uDE1A\uDE2F\uDE32-\uDE3A\uDE3C-\uDE3F\uDE49-\uDFFA]|\uD83D[\uDC00-\uDD3D\uDD46-\uDE4F\uDE80-\uDEFF\uDF74-\uDF7F\uDFD5-\uDFFF]|\uD83E[\uDC0C-\uDC0F\uDC48-\uDC4F\uDC5A-\uDC5F\uDC88-\uDC8F\uDCAE-\uDCFF\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDEFF]|\uD83F[\uDC00-\uDFFD])$/.test(String.fromCodePoint(e))}(n),i=1===e&&r;return e=0===e&&4===t?0:0===e&&5===t?1:r?0:2,i?2:0}}},function(){var e=0;return{next:function(t){var n=!1;return 6===t?(e%2==1&&(n=!0),e+=1):e=0,n?2:0}}}],sn=tn,un=function(){function e(t){(0,d.Z)(this,e),this.content=void 0,this._current=0,this._lastBreak=0,this._rules=void 0,this.content=t,this._rules=an.map((function(e){return e()}))}return(0,f.Z)(e,[{key:"nextBreak",value:function(){for(var e=this._current;e<this.content.length;e++){var t=this.content.charCodeAt(e);if(this._current=e,nn(t)&&e+1<this.content.length&&rn(this.content.charCodeAt(e+1))){var n=this.content.charCodeAt(++e);t=on(t,n)}var r,i=sn.get(t),o=0,a=_(this._rules);try{for(a.s();!(r=a.n()).done;){var s=r.value.next(i,t);0!==s&&0===o&&(o=s)}}catch(e){a.e(e)}finally{a.f()}if(2!==o){var u=this._current;if(this._current=e+1,0!==u)return this._lastBreak=u,u}}return this._current=this.content.length,this._lastBreak>=this.content.length?null:(this._lastBreak=this._current,this._current)}}]),e}(),ln=function(e,t){for(var n=new un(e),r=0,i=n.nextBreak();i&&i<t;)r=i,i=n.nextBreak();return r},cn=41,hn=[[4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,4,4,4,4,4,4,4,4,4,4,4],[0,4,4,1,1,4,4,4,4,1,1,0,0,0,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[0,4,4,1,1,4,4,4,4,1,1,1,1,1,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[4,4,4,1,1,1,4,4,4,1,1,1,1,1,1,1,1,1,1,1,4,2,4,1,1,1,1,1,1,1,1,1,1],[1,4,4,1,1,1,4,4,4,1,1,1,1,1,1,1,1,1,1,1,4,2,4,1,1,1,1,1,1,1,1,1,1],[0,4,4,1,1,1,4,4,4,0,0,0,0,0,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[0,4,4,1,1,1,4,4,4,0,0,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[0,4,4,1,1,1,4,4,4,0,0,1,0,1,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[0,4,4,1,1,1,4,4,4,0,0,1,1,1,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[1,4,4,1,1,1,4,4,4,0,0,1,1,1,1,0,1,1,0,0,4,2,4,1,1,1,1,1,0,1,1,1,0],[1,4,4,1,1,1,4,4,4,0,0,1,1,1,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[1,4,4,1,1,1,4,4,4,1,1,1,1,1,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[1,4,4,1,1,1,4,4,4,1,1,1,1,1,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[1,4,4,1,1,1,4,4,4,1,1,1,1,1,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[0,4,4,1,1,1,4,4,4,0,1,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[0,4,4,1,1,1,4,4,4,0,0,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[0,4,4,1,0,1,4,4,4,0,0,1,0,0,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[0,4,4,1,0,1,4,4,4,0,0,0,0,0,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[1,4,4,1,1,1,4,4,4,1,1,1,1,1,1,1,1,1,1,1,4,2,4,1,1,1,1,1,1,1,1,1,0],[0,4,4,1,1,1,4,4,4,0,0,0,0,0,0,0,1,1,0,4,4,2,4,0,0,0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0],[1,4,4,1,1,1,4,4,4,1,1,1,1,1,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[1,4,4,1,1,1,4,4,4,1,1,1,1,1,1,1,1,1,1,1,4,2,4,1,1,1,1,1,1,1,1,1,1],[0,4,4,1,1,1,4,4,4,0,1,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,1,1,0,0,0,1,0],[0,4,4,1,1,1,4,4,4,0,1,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,0,1,0,0,0,1,0],[0,4,4,1,1,1,4,4,4,0,1,0,0,0,0,1,1,1,0,0,4,2,4,1,1,1,1,0,0,0,0,1,0],[0,4,4,1,1,1,4,4,4,0,1,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,1,1,0,0,0,1,0],[0,4,4,1,1,1,4,4,4,0,1,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,0,1,0,0,0,1,0],[0,4,4,1,1,1,4,4,4,0,0,0,0,0,0,0,1,1,0,0,4,2,4,0,0,0,0,0,1,0,0,1,0],[0,4,4,1,1,1,4,4,4,0,1,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0,0,1,1,0],[0,4,4,1,1,1,4,4,4,0,1,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0],[0,4,4,1,1,1,4,4,4,0,0,0,0,0,1,0,1,1,0,0,4,2,4,0,0,0,0,0,0,1,1,1,0],[0,4,4,1,1,0,4,4,4,0,0,0,0,0,0,0,0,0,0,0,4,2,4,0,0,0,0,0,0,0,0,1,0]];var dn=Jt,fn=function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,d.Z)(this,e),this.position=t,this.required=n},pn=function(e){switch(e){case 33:case 39:case 40:case 42:return 12;case 35:return 5;default:return e}},vn=function(e){switch(e){case 37:case 38:return 34;case cn:return 22;default:return e}},gn=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,d.Z)(this,e),this.breaks=[],this.string=t,this.pos=0,this.lastPos=0,this.curClass=null,this.nextClass=null,this.LB8a=!1,this.LB21a=!1,this.LB30a=0,this.breakSpaces=n.breakSpaces||!1}return(0,f.Z)(e,[{key:"clearBreaks",value:function(){this.breaks.length=0}},{key:"pushBreak",value:function(e,t){this.breaks.push({position:e,required:t})}},{key:"shiftBreak",value:function(){var e=this.breaks.shift(),t=e.position,n=e.required;return new fn(t,n)}},{key:"nextCodePoint",value:function(){var e=this.string.charCodeAt(this.pos++),t=this.string.charCodeAt(this.pos);return nn(e)&&rn(t)?(this.pos++,on(e,t)):e}},{key:"nextCharClass",value:function(){return pn(dn.get(this.nextCodePoint()))}},{key:"getSimpleBreak",value:function(){switch(this.nextClass){case cn:return!1;case 34:case 37:case 38:return this.curClass=34,!1;case 36:return this.curClass=36,!1}return null}},{key:"getPairTableBreak",value:function(e){var t=!1;switch(hn[this.curClass][this.nextClass]){case 0:t=!0;break;case 1:t=e===cn;break;case 2:if(!(t=e===cn))return t=!1;break;case 3:if(e!==cn)return t}return this.LB8a&&(t=!1),!this.LB21a||16!==this.curClass&&17!==this.curClass?this.LB21a=13===this.curClass:(t=!1,this.LB21a=!1),28===this.curClass?(this.LB30a++,2===this.LB30a&&28===this.nextClass&&(t=!0,this.LB30a=0)):this.LB30a=0,this.curClass=this.nextClass,t}},{key:"nextBreak",value:function(){if(this.breaks.length)return this.shiftBreak();if(null===this.curClass){var e=this.nextCharClass();this.curClass=vn(e),this.LB8a=31===e,this.LB30a=0}for(;this.pos<this.string.length;){this.lastPos=this.pos;var t=this.nextClass;if(this.nextClass=this.nextCharClass(),34===this.curClass||36===this.curClass&&37!==this.nextClass)return this.curClass=vn(pn(this.nextClass)),this.pushBreak(this.lastPos,!0),this.shiftBreak();var n=this.getSimpleBreak();if(this.LB8a=31===this.nextClass,null===n){if(null===n&&(n=this.getPairTableBreak(t)),n)return this.pushBreak(this.lastPos),this.shiftBreak();this.clearBreaks()}else this.nextClass===cn?this.breakSpaces&&this.pushBreak(this.pos):this.clearBreaks()}return this.lastPos<this.string.length?(this.lastPos=this.string.length,this.pushBreak(this.string.length),this.shiftBreak()):null}}]),e}(),_n={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},yn={},mn={};yn.L=1,mn[1]="L",Object.keys(_n).forEach((function(e,t){yn[e]=1<<t+1,mn[yn[e]]=e})),Object.freeze(yn);var En=yn.LRI|yn.RLI|yn.FSI,bn=yn.L|yn.R|yn.AL,Tn=yn.B|yn.S|yn.WS|yn.ON|yn.FSI|yn.LRI|yn.RLI|yn.PDI,Cn=yn.BN|yn.RLE|yn.LRE|yn.RLO|yn.LRO|yn.PDF,Sn=yn.S|yn.WS|yn.B|En|yn.PDI|Cn,wn=null;function Rn(e){return function(){if(!wn){wn=new Map;var e=function(e){if(_n.hasOwnProperty(e)){var t=0;_n[e].split(",").forEach((function(n){var r=n.split("+"),i=r[0],o=r[1];i=parseInt(i,36),o=o?parseInt(o,36):0,wn.set(t+=i,yn[e]);for(var a=0;a<o;a++)wn.set(++t,yn[e])}))}};for(var t in _n)e(t)}}(),wn.get(e.codePointAt(0))||yn.L}var An,On,Mn,kn="14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",In="6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye";function xn(e,t){var n,r=0,i=new Map,o=t&&new Map;return e.split(",").forEach((function e(a){if(a.includes("+"))for(var s=+a;s--;)e(n);else{n=a;var u=a.split(">"),l=u[0],c=u[1];l=String.fromCodePoint(r+=parseInt(l,36)),c=String.fromCodePoint(r+=parseInt(c,36)),i.set(l,c),t&&o.set(c,l)}})),{map:i,reverseMap:o}}function Nn(){if(!An){var e=xn(kn,!0),t=e.map,n=e.reverseMap;An=t,On=n,Mn=xn(In,!1).map}}function Pn(e){return Nn(),An.get(e)||null}function Ln(e){return Nn(),On.get(e)||null}function Dn(e){return Nn(),Mn.get(e)||null}var Fn=yn.L,Bn=yn.R,Vn=yn.EN,Hn=yn.ES,Un=yn.ET,Zn=yn.AN,Wn=yn.CS,jn=yn.B,Gn=yn.S,zn=yn.ON,Yn=yn.BN,Xn=yn.NSM,Kn=yn.AL,qn=yn.PDI,$n=new Map;function Jn(e,t){var n="".concat(e,"-").concat(t);if($n.has(n))return $n.get(n);for(var r=new Uint32Array(e.length),i=0;i<e.length;i++)r[i]=Rn(e[i]);var o=new Map;function a(e,t){var n=r[e];r[e]=t,o.set(n,o.get(n)-1),n&Tn&&o.set(Tn,o.get(Tn)-1),o.set(t,(o.get(t)||0)+1),t&Tn&&o.set(Tn,(o.get(Tn)||0)+1)}var s=new Uint8Array(e.length),u=new Map,l=[],c=null;l.push({start:0,end:e.length-1,level:"rtl"===t?1:"ltr"===t?0:function(t,n){for(var i=t;i<e.length;i++){var o=r[i];if(o&(Bn|Kn))return 1;if(o&(jn|Fn)||n&&o===qn)return 0;if(o&En){var a=tt(i);i=-1===a?e.length:a}}return 0}(0,!1)});for(var h=0;h<l.length;h++){var d=[{_level:(c=l[h]).level,_override:0,_isolate:0}],f=void 0;o.clear();for(var p=c.start;p<=c.end;p++){var v=r[p];f=d[d.length-1],o.set(v,(o.get(v)||0)+1),v&Tn&&o.set(Tn,(o.get(Tn)||0)+1),s[p]=f._level,f._override&&v!==Yn&&a(p,f._override)}for(var g=[],_=null,y=c.start;y<=c.end;y++){var m=r[y];if(!(m&Cn)){var E=s[y],b=m&En,T=m===qn;_&&E===_._level?(_._end=y,_._endsWithIsolInit=b):g.push(_={_start:y,_end:y,_level:E,_startsWithPDI:T,_endsWithIsolInit:b})}}for(var C=[],S=0;S<g.length;S++){var w=g[S];if(!w._startsWithPDI||w._startsWithPDI&&!u.has(w._start)){for(var R=[_=w],A=void 0;_&&_._endsWithIsolInit&&null!=(A=u.get(_._end));)for(var O=S+1;O<g.length;O++)if(g[O]._start===A){R.push(_=g[O]);break}for(var M=[],k=0;k<R.length;k++)for(var I=R[k],x=I._start;x<=I._end;x++)M.push(x);for(var N=s[M[0]],P=c.level,L=M[0]-1;L>=0;L--)if(!(r[L]&Cn)){P=s[L];break}var D=M[M.length-1],F=s[D],B=c.level;if(!(r[D]&En))for(var V=D+1;V<=c.end;V++)if(!(r[V]&Cn)){B=s[V];break}C.push({_seqIndices:M,_sosType:Math.max(P,N)%2?Bn:Fn,_eosType:Math.max(B,F)%2?Bn:Fn})}}for(var H=0;H<C.length;H++){var U=C[H],Z=U._seqIndices,W=U._sosType,j=U._eosType;if(o.get(Xn))for(var G=0;G<Z.length;G++){var z=Z[G];if(r[z]&Xn){for(var Y=W,X=G-1;X>=0;X--)if(!(r[Z[X]]&Cn)){Y=r[Z[X]];break}a(z,Y&(En|qn)?zn:Y)}}if(o.get(Vn))for(var K=0;K<Z.length;K++){var q=Z[K];if(r[q]&Vn)for(var $=K-1;$>=-1;$--){var J=-1===$?W:r[Z[$]];if(J&bn){J===Kn&&a(q,Zn);break}}}if(o.get(Kn))for(var Q=0;Q<Z.length;Q++){var ee=Z[Q];r[ee]&Kn&&a(ee,Bn)}if(o.get(Hn)||o.get(Wn))for(var te=1;te<Z.length-1;te++){var ne=Z[te];if(r[ne]&(Hn|Wn)){for(var re=0,ie=0,oe=te-1;oe>=0&&(re=r[Z[oe]])&Cn;oe--);for(var ae=te+1;ae<Z.length&&(ie=r[Z[ae]])&Cn;ae++);re===ie&&(r[ne]===Hn?re===Vn:re&(Vn|Zn))&&a(ne,re)}}if(o.get(Vn))for(var se=0;se<Z.length;se++){var ue=Z[se];if(r[ue]&Vn){for(var le=se-1;le>=0&&r[Z[le]]&(Un|Cn);le--)a(Z[le],Vn);for(var ce=se+1;ce<Z.length&&r[Z[ce]]&(Un|Cn);ce++)a(Z[ce],Vn)}}if(o.get(Un)||o.get(Hn)||o.get(Wn))for(var he=0;he<Z.length;he++){var de=Z[he];if(r[de]&(Un|Hn|Wn)){a(de,zn);for(var fe=he-1;fe>=0&&r[Z[fe]]&Cn;fe--)a(Z[fe],zn);for(var pe=he+1;pe<Z.length&&r[Z[pe]]&Cn;pe++)a(Z[pe],zn)}}if(o.get(Vn))for(var ve=0,ge=W;ve<Z.length;ve++){var _e=Z[ve],ye=r[_e];ye&Vn?ge===Fn&&a(_e,Fn):ye&bn&&(ge=ye)}if(o.get(Tn)){for(var me=Bn|Vn|Zn,Ee=me|Fn,be=[],Te=[],Ce=0;Ce<Z.length;Ce++)if(r[Z[Ce]]&Tn){var Se=e[Z[Ce]],we=void 0;if(null!==Pn(Se)){if(!(Te.length<63))break;Te.push({char:Se,seqIndex:Ce})}else if(null!==(we=Ln(Se)))for(var Re=Te.length-1;Re>=0;Re--){var Ae=Te[Re].char;if(Ae===we||Ae===Ln(Dn(Se))||Pn(Dn(Ae))===Se){be.push([Te[Re].seqIndex,Ce]),Te.length=Re;break}}}be.sort((function(e,t){return e[0]-t[0]}));for(var Oe=0;Oe<be.length;Oe++){for(var Me=be[Oe],ke=Me[0],Ie=Me[1],xe=!1,Ne=0,Pe=ke+1;Pe<Ie;Pe++){var Le=Z[Pe];if(r[Le]&Ee){xe=!0;var De=r[Le]&me?Bn:Fn;if(De===nt(Le)){Ne=De;break}}}if(xe&&!Ne){Ne=W;for(var Fe=ke-1;Fe>=0;Fe--){var Be=Z[Fe];if(r[Be]&Ee){var Ve=r[Be]&me?Bn:Fn;Ne=Ve!==nt(Be)?Ve:nt(Be);break}}}if(Ne){if(r[Z[ke]]=r[Z[Ie]]=Ne,Ne!==nt(Z[ke]))for(var He=ke+1;He<Z.length;He++)if(!(r[Z[He]]&Cn)){Rn(e[Z[He]])&Xn&&(r[Z[He]]=Ne);break}if(Ne!==nt(Z[Ie]))for(var Ue=Ie+1;Ue<Z.length;Ue++)if(!(r[Z[Ue]]&Cn)){Rn(e[Z[Ue]])&Xn&&(r[Z[Ue]]=Ne);break}}}for(var Ze=0;Ze<Z.length;Ze++)if(r[Z[Ze]]&Tn){for(var We=Ze,je=Ze,Ge=W,ze=Ze-1;ze>=0;ze--){if(!(r[Z[ze]]&Cn)){Ge=r[Z[ze]]&me?Bn:Fn;break}We=ze}for(var Ye=j,Xe=Ze+1;Xe<Z.length;Xe++){if(!(r[Z[Xe]]&(Tn|Cn))){Ye=r[Z[Xe]]&me?Bn:Fn;break}je=Xe}for(var Ke=We;Ke<=je;Ke++)r[Z[Ke]]=Ge===Ye?Ge:nt(Z[Ke]);Ze=je}}}for(var qe=c.start;qe<=c.end;qe++){var $e=s[qe],Je=r[qe];if(1&$e?Je&(Fn|Vn|Zn)&&s[qe]++:Je&Bn?s[qe]++:Je&(Zn|Vn)&&(s[qe]+=2),Je&Cn&&(s[qe]=0===qe?c.level:s[qe-1]),qe===c.end||Rn(e[qe])&(Gn|jn))for(var Qe=qe;Qe>=0&&Rn(e[Qe])&Sn;Qe--)s[Qe]=c.level}}var et={levels:s,paragraphs:l};return $n.set(n,et),et;function tt(t){for(var n=1,i=t+1;i<e.length;i++){var o=r[i];if(o&jn)break;if(o&qn){if(0==--n)return i}else o&En&&n++}return-1}function nt(e){return 1&s[e]?Bn:Fn}}function Qn(e,t,n,r){var i=e.length;n=Math.max(0,null==n?0:+n),r=Math.min(i-1,null==r?i-1:+r);var o=[];return t.paragraphs.forEach((function(i){var a=Math.max(n,i.start),s=Math.min(r,i.end);if(a<s){for(var u=t.levels.slice(a,s+1),l=s;l>=a&&Rn(e[l])&Sn;l--)u[l]=i.level;for(var c=i.level,h=1/0,d=0;d<u.length;d++){var f=u[d];f>c&&(c=f),f<h&&(h=1|f)}for(var p=c;p>=h;p--)for(var v=0;v<u.length;v++)if(u[v]>=p){for(var g=v;v+1<u.length&&u[v+1]>=p;)v++;v>g&&o.push([g+n,v+n])}}})),o}function er(e){var t=He(e),n=t.width,r=t.maxWidth,i=t.minWidth;return n&&"auto"!==n||r||i}var tr=function(e){if(void 0===e.graphemeBreakerPosition){for(var t=e.props.content,n=[0],r=new un(t),i=r.nextBreak();i;)n.push(i),i=r.nextBreak();e.graphemeBreakerPosition=n}},nr=function(e){if(void 0===e.lineBreakerPosition){for(var t=e.props.content,n=[0],r=new gn(t,{breakSpaces:!0}),i=r.nextBreak();i;)n.push(i.position),i=r.nextBreak();e.lineBreakerPosition=n}};function rr(e){if(!1===e.props.lineWrap)return 1;if(za(e))return 0;if(er(e))return 1;var t;if(!Ga(e)&&(!Ua(e,p.j2.Div)&&!Ua(e,"Component")||null===(t=e.children)||void 0===t||!t.length))return 1;return Dt(e)?1:e.children&&0!==e.children.length?null:1}function ir(e){var t,n,r;return!!(e.element&&sa(e.element)||1===rr(e))||!Dt(e.parent)&&(null===(t=e.parent)||void 0===t||null===(n=t.runtime)||void 0===n||null===(r=n.context)||void 0===r?void 0:r.individual)}function or(e){var t=e.width,n=e.height,r=0,i=0,o=0,a=0,s=0,u=0,l=0,c=0,h=0,d=0,f=0,p=0,v=t,g=n,_=t,y=n;if(sr(e.type)){var m,E,b,T,C,S,w,R,A,O,M,k,I=Ee(e);r=null!==(m=I.marginLeft)&&void 0!==m?m:0,i=null!==(E=I.marginTop)&&void 0!==E?E:0,o=null!==(b=I.marginRight)&&void 0!==b?b:0,a=null!==(T=I.marginBottom)&&void 0!==T?T:0,s=null!==(C=I.paddingLeft)&&void 0!==C?C:0,u=null!==(S=I.paddingTop)&&void 0!==S?S:0,l=null!==(w=I.paddingRight)&&void 0!==w?w:0,c=null!==(R=I.paddingBottom)&&void 0!==R?R:0,h=null!==(A=I.borderLeftWidth)&&void 0!==A?A:0,d=null!==(O=I.borderTopWidth)&&void 0!==O?O:0,v=t-s-l-h-(f=null!==(M=I.borderRightWidth)&&void 0!==M?M:0),g=n-u-c-d-(p=null!==(k=I.borderBottomWidth)&&void 0!==k?k:0),_=t+r+o,y=n+i+a}return{marginLeft:r,marginTop:i,marginRight:o,marginBottom:a,borderBottom:p,paddingLeft:s,paddingTop:u,paddingRight:l,paddingBottom:c,borderLeft:h,borderTop:d,borderRight:f,contentWidth:v,contentHeight:g,outerWidth:_,outerHeight:y,innerWidth:t,innerHeight:n}}function ar(e){return $a(e)?or(e):{marginLeft:0,marginTop:0,marginRight:0,marginBottom:0,borderLeft:0,borderTop:0,borderRight:0,borderBottom:0,paddingLeft:0,paddingTop:0,paddingRight:0,paddingBottom:0,contentWidth:0,contentHeight:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0}}function sr(e){return p.Ex.has(e)}function ur(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=Math.max(n,t),a=i?o:Math.min(r,o);return"auto"===e?a:r}var lr=function(e){var t,n=e.runtime;if(n){var r=n.constraint;null==r||null===(t=r.fragments)||void 0===t||t.add(e),null!=r&&r.disableRTL&&Za(e,[p.j2.Text])&&(e.dir="none")}};function cr(e,t,n){var r,i=Ee(e),o=t?{}:i;if(t)for(var a=0;a<t.length;a++){var s=t[a];o[s]=i[s]}var u=e.runtime;We(u,hr(e,o)),We(u,{individual:null!==(r=n)&&void 0!==r?r:ir(e)}),lr(e)}function hr(e,t){var n=function(e,t){var n,r,i=e.runtime.constraint,o=i.maxWidth,a=i.stretchWidth,s=i.flexWidth,u=i.originMaxWidth,l=t.maxWidth,c=t.width,h=t.minWidth;if((0,g.hj)(s))return{maxWidth:s,minWidth:s,width:s};var d=null!==(n=o)&&void 0!==n?n:1/0,f=null!==(r=h)&&void 0!==r?r:0,v=c,_=u,y=0,m=0;if(sr(e.type)){var E,b,T,C,S,w,R=t.paddingLeft,A=t.paddingRight,O=t.borderLeftWidth,M=t.borderRightWidth;y=(null!==(E=t.marginLeft)&&void 0!==E?E:0)+(null!==(b=t.marginRight)&&void 0!==b?b:0),m=(null!==(T=R)&&void 0!==T?T:0)+(null!==(C=A)&&void 0!==C?C:0)+(null!==(S=O)&&void 0!==S?S:0)+(null!==(w=M)&&void 0!==w?w:0)}(0,g.hj)(_)&&(p.HZ.has(e.type)&&(d=Math.max(d,_)),_=Ua(e,p.j2.Table)?void 0:Math.max(_-y,0));d=Math.max(d-y,0),(0,g.hj)(l)&&(d=Math.min(d,l));f=Math.max(f,m),(0,g.hj)(v)?d=f=v=Math.min(Math.max(f,v),d):(0,g.hj)(a)&&(f=Math.min(Math.max(a-y,f),d));return{maxWidth:d,minWidth:f,width:v,originMaxWidth:_}}(e,t),r=n.maxWidth,i=n.minWidth,o=n.originMaxWidth,a=function(e,t){var n,r,i=e.runtime.constraint,o=i.maxHeight,a=i.stretchHeight,s=i.flexHeight,u=t.maxHeight,l=t.height,c=t.minHeight;if((0,g.hj)(s))return{maxHeight:s,minHeight:s,height:s};var h=null!==(n=o)&&void 0!==n?n:1/0,d=null!==(r=c)&&void 0!==r?r:0,f=l,p=0,v=0;if(sr(e.type)){var _,y,m,E,b,T,C=t.paddingTop,S=t.paddingBottom,w=t.borderTopWidth,R=t.borderBottomWidth;p=(null!==(_=t.marginTop)&&void 0!==_?_:0)+(null!==(y=t.marginBottom)&&void 0!==y?y:0),v=(null!==(m=C)&&void 0!==m?m:0)+(null!==(E=S)&&void 0!==E?E:0)+(null!==(b=w)&&void 0!==b?b:0)+(null!==(T=R)&&void 0!==T?T:0)}h=Math.max(h-p,0),(0,g.hj)(u)&&(h=Math.min(h,u));d=Math.max(d,v),(0,g.hj)(f)?h=d=f=Math.min(Math.max(d,f),h):(0,g.hj)(a)&&(d=Math.min(Math.max(a-p,d),h));return{maxHeight:h,minHeight:d,height:f}}(e,t),s=a.maxHeight,u=a.minHeight;return{maxWidth:r,minWidth:i,maxHeight:s,minHeight:u,originMaxWidth:o,isRelayoutBoundary:0!==r&&0!==s&&r===i&&s===u}}function dr(e){var t=e.runtime.context,n=t.maxWidth,r=void 0===n?1/0:n,i=t.maxHeight,o=void 0===i?1/0:i,a=t.originMaxWidth,s=e.type;a=function(e,t,n){if(!(0,g.hj)(t)||e>t)return t;if(!p.HZ.has(n))return e}(r,a,s);var u,l=Ee(e);if(sr(s)){var c,d,f,v,_,y,m,E,b=l.borderLeftWidth,T=l.borderRightWidth,C=l.borderTopWidth,S=l.borderBottomWidth,w=(null!==(c=b)&&void 0!==c?c:0)+(null!==(d=T)&&void 0!==d?d:0)+(null!==(f=l.paddingLeft)&&void 0!==f?f:0)+(null!==(v=l.paddingRight)&&void 0!==v?v:0),R=(null!==(_=C)&&void 0!==_?_:0)+(null!==(y=S)&&void 0!==y?y:0)+(null!==(m=l.paddingTop)&&void 0!==m?m:0)+(null!==(E=l.paddingBottom)&&void 0!==E?E:0);r=Math.max(r-w,0),o=Math.max(o-R,0)}if(u=s,p.TZ.has(u)){var A=l.overflowScrollX,O=l.overflowScrollY;if(A){var M=fr(r,a),k=(0,h.Z)(M,2);r=k[0],a=k[1]}O&&(o=1/0)}(0,g.hj)(a)&&(r=1/0);var I={originMaxWidth:a,maxWidth:r,maxHeight:o};return Xa(e)?I:(0,g.f0)(I,p.mm)}function fr(e,t){return t?[e,t]:[1/0,e]}function pr(e){var t=e.maxWidth,n=e.originMaxWidth;return n&&t===1/0?(0,g.f0)({},e,{maxWidth:n}):e}function vr(e,t){var n=e.children;if(null!=n&&n.length){var r,i=_(n);try{for(i.s();!(r=i.n()).done;){var o=r.value;!Wa(o)&&t(o)}}catch(e){i.e(e)}finally{i.f()}}}function gr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=0,i=0;return vr(e,(function(e){var o=ar(e),a=o.outerWidth,s=o.outerHeight,u=o.marginLeft,l=o.marginTop;ie(e,{left:u+t,top:l+n}),r=Math.max(a,r),i=Math.max(s,i)})),[r,i]}var _r={wrapup:function(e,t){var n=t.maxWidth,r=t.minWidth,i=t.maxHeight,o=t.minHeight,a=t.isWeakWidth,s=gr(e);ie(e,{width:ur("auto",s[0],r,n,a),height:ur("auto",s[1],o,i)})},getNext:function(e){for(var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=null!==(t=e.children)&&void 0!==t?t:[],i=r.length;n<i-1&&Wa(r[n+1]);)n++;return++n>=i?-1:n},buildContext:function(e){return cr(e,[])},createChildConstraint:function(e,t){je(t.runtime,dr(e))}},yr=new WeakMap;function mr(e,t){yr.has(e)?yr.get(e).area=t:yr.set(e,{area:t,visibleAreaMap:new Map})}function Er(e){var t;return null===(t=yr.get(e))||void 0===t?void 0:t.area}function br(e){var t;return null===(t=yr.get(e))||void 0===t?void 0:t.visibleAreaMap}function Tr(e,t){var n;return!(null===(n=br(e))||void 0===n||!n.has(t))}function Cr(e,t,n){yr.has(e)||yr.set(e,{area:n,visibleAreaMap:new Map}),br(e).set(t,n)}function Sr(e){var t;null===(t=br(e))||void 0===t||t.clear()}function wr(e,t){var n=yr.get(e);if(n){for(var r=n.area,i=n.visibleAreaMap,o=t;o;){var a=i.get(o);if(a)return[a,o];o=o.parent}return[r,null]}}var Rr={color:g.Ng.selectionColor,controlBarColor:g.Ng.selectionControlBarColor,needControlBar:!1,controlWidth:2,controlBarRadius:4},Ar=Rr,Or=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ar=(0,g.f0)(Ar,e)},Mr=function(e){return e.TOP="borderTopColor",e.RIGHT="borderRightColor",e.BOTTOM="borderBottomColor",e.LEFT="borderLeftColor",e}(Mr||{}),kr=function(e){return e.TOP="borderTop",e.RIGHT="borderRight",e.BOTTOM="borderBottom",e.LEFT="borderLeft",e}(kr||{}),Ir=function(e){return e.TOP="outlineTopColor",e.RIGHT="outlineRightColor",e.BOTTOM="outlineBottomColor",e.LEFT="outlineLeftColor",e}(Ir||{}),xr=function(e){return e.TOP="outlineTop",e.RIGHT="outlineRight",e.BOTTOM="outlineBottom",e.LEFT="outlineLeft",e}(xr||{}),Nr=.001,Pr=function(e,t,n){return e>=t&&e<n},Lr=function(e,t,n){return Math.min(Math.max(e,t),n)},Dr=function(e,t){var n=e.x,r=e.y,i=t.left,o=t.top,a=t.width,s=t.height;return Pr(n,i,i+a)&&Pr(r,o,o+s)},Fr={left:0,top:0,width:0,height:0};function Br(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fr,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,g.f0)(t,e)}var Vr=function(e,t){var n=e.left+e.width,r=e.top+e.height,i=t.left+t.width,o=t.top+t.height;return!(n<t.left||i<e.left||r<t.top||o<e.top)},Hr=function(e,t){var n=e.left,r=e.top,i=e.left+e.width,o=e.top+e.height,a=t.left,s=t.top,u=t.left+t.width,l=t.top+t.height;return n<=a&&i>=u&&r<=s&&o>=l};function Ur(e){if(!e.length)return Br();var t=e.map((function(e){var t=e.left,n=e.top;return{left:t,top:n,right:t+e.width,bottom:n+e.height}})).reduce((function(e,t){var n=e.left,r=e.top,i=e.right,o=e.bottom,a=t.left,s=t.top,u=t.right,l=t.bottom;return{left:Math.min(n,a),top:Math.min(r,s),right:Math.max(i,u),bottom:Math.max(o,l)}})),n=t.left,r=t.top,i=t.right,o=t.bottom;return{left:n,top:r,width:Math.max(0,i-n),height:Math.max(0,o-r)}}function Zr(e){if(!e.length)return Br();var t=e.map((function(e){var t=e.left,n=e.top;return{left:t,top:n,right:t+e.width,bottom:n+e.height}})).reduce((function(e,t){var n=e.left,r=e.top,i=e.right,o=e.bottom,a=t.left,s=t.top,u=t.right,l=t.bottom;return{left:Math.max(n,a),top:Math.max(r,s),right:Math.min(i,u),bottom:Math.min(o,l)}})),n=t.left,r=t.top,i=t.right,o=t.bottom;return{left:n,top:r,width:Math.max(0,i-n),height:Math.max(0,o-r)}}function Wr(e){var t=(0,g.f0)({},e);return t.x=~~t.x,t.y=~~t.y,t.width=Math.ceil(t.width),t.height=Math.ceil(t.height),t}function jr(e){if(Ua(e,p.j2.TableRow)){var t=e.runtime.context;if(t.tpu){var n=t.tpu.getRelatedRowsByRow(e);if(n.length)return n[0]}}return e}function Gr(e,t,n){var r=t.left,i=t.top,o=t.height;e.save(),e.beginPath(),e.arc(r+Ar.controlWidth/2,"left"===n?i-Ar.controlBarRadius:i+o+Ar.controlBarRadius,Ar.controlBarRadius,0,360),e.fillStyle=Ar.controlBarColor,e.fill(),e.closePath(),e.fillStyle=Ar.controlBarColor,e.fillRect(r,i,Ar.controlWidth,o),e.restore()}function zr(e,t,n){var r=n.startFrom,i=n.endTo,o=n.origin,a=(o=void 0===o?{left:0,top:0}:o).left,s=void 0===a?0:a,u=o.top,l=void 0===u?0:u,c=n.relativeTo,h=(c=void 0===c?{left:0,top:0}:c).left,d=void 0===h?0:h,f=c.top,p=void 0===f?0:f,v=n.childrenProperty,g=void 0===v?"children":v,_=n.parentProperty,y=void 0===_?"parent":_,m=[],E=[],b=r?B(r):null,T=i?B(i):null;m.push({node:e,left:s-d,top:l-p,sourceLeft:s-d,sourceTop:l-p});for(var C=1;m.length;){var S,w,R=m.pop(),A=R.node,O=R.left,M=R.top,k=O,I=M;if(Wa(A))k=(null!==(S=A.x)&&void 0!==S?S:0)-d,I=(null!==(w=A.y)&&void 0!==w?w:0)-p;else A!==e&&(k+=A.left,I+=A.top);E.push({node:A,left:k,top:I,sourceLeft:O,sourceTop:M}),C=t({left:k,top:I,renderObject:A,isBackward:!1})||1;var x=A[g];if(null!=x&&x.length&&C<=1){var N,P=null!==(N=null==b?void 0:b.get(A))&&void 0!==N?N:-1,L=null==x?void 0:x[Math.max(P,0)];if(L){var D,F,V,H,U=k-(null!==(D=A.scrollLeft)&&void 0!==D?D:0),Z=I-(null!==(F=A.scrollTop)&&void 0!==F?F:0),W=O-(null!==(V=A.scrollLeft)&&void 0!==V?V:0),j=M-(null!==(H=A.scrollTop)&&void 0!==H?H:0);m.push({node:L,left:U,top:Z,sourceLeft:W,sourceTop:j});continue}}for(;E.length;){var G=E.pop(),z=G.node,Y=G.left,X=G.top,K=G.sourceLeft,q=G.sourceTop;if(C<=1&&t({left:Y,top:X,renderObject:z,isBackward:!0}),3!==C&&z!==e){var $=z[y];if($){var J=$[g],Q=J.indexOf(z)+1,ee=null==T?void 0:T.get($);if(void 0===ee||ee>=Q){var te=null==b?void 0:b.get($),ne=J[Q];if(void 0!==te&&Q<te&&(ne=J[te]),ne){m.push({node:ne,left:K,top:q,sourceLeft:K,sourceTop:q});break}}}}C=1}}}function Yr(e,t){var n,r;return null===(n=Nt(e))||void 0===n||null===(r=n.paint)||void 0===r?void 0:r[t]}var Xr=function(e,t,n){var r=Ee(t).transform;if(r&&r.rotate){var i=n.left,o=n.top,a=n.width,s=n.height,u=r.rotate,l=r.origin,c=void 0===l?{x:a/2,y:s/2}:l,h={x:i+c.x,y:o+c.y};e.save(),e.rotate(u*Math.PI/180,h)}},Kr=function(e,t){var n=Ee(t).transform;n&&n.rotate&&e.restore()},qr=function(e){var t=e.children,n=e.width,r=e.height;if(null!=t&&t.length){if(t.length>10)return!0;var i=Ur(t),o=i.width,a=i.height,s=i.left,u=i.top;return s+o>n||u+a>r||s<0||u<0}return!1};function $r(e,t){var n,r,i=t.lineWidth,o=t.strokeStyle,a=t.renderObject,s=t.path,u=t.opacity,l=(0,h.Z)(s,2),c=(0,h.Z)(l[0],2),d=c[0],f=c[1],p=(0,h.Z)(l[1],2),v=p[0],g=p[1],_=null===(n=wr(e,a))||void 0===n?void 0:n[0],y=[[0,f],[0,g]];y[0][0]=Math.max(d,null!==(r=null==_?void 0:_.x)&&void 0!==r?r:0),y[1][0]=Math.min(v,_?_.x+_.width:1/0),y[0][0]>=y[1][0]||Ot.push({lineWidth:i,stroke:o,path:y,type:2,opacity:u})}function Jr(e,t,n){var r=t.borderLeft,i=t.borderTop,o=t.paddingLeft,a=t.paddingTop,s=t.contentWidth,u=t.contentHeight,l=n.left+r+o,c=n.top+i+a,h=Math.max(e.x,l),d=Math.max(e.y,c),f=Math.min(e.x+e.width,l+s),p=Math.min(e.y+e.height,c+u);return{x:h,y:d,width:Math.max(0,f-h),height:Math.max(0,p-d),scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function Qr(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t.left,i=t.top,o=t.width,a=t.height,s=t.fill,u=t.stroke,l=t.radius;l?ti(e,l):(e.beginPath(),e.rect(r,i,o,a)),n&&ei(e,t),s&&e.fill(),u&&e.stroke()}function ei(e,t){var n,r=t.fill,i=t.stroke,o=t.lineWidth,a=t.opacity;(r&&(e.fillStyle=r),i)&&(e.strokeStyle=i,e.lineWidth=null!==(n=o)&&void 0!==n?n:0);a!==e.globalAlpha&&(e.globalAlpha=a)}function ti(e,t){var n=(0,h.Z)(t.rect,2),r=(0,h.Z)(n[0],2),i=r[0],o=r[1],a=(0,h.Z)(n[1],2),s=a[0],u=a[1],l=(0,h.Z)(t.ellipse,2),c=(0,h.Z)(l[0],4),d=c[0],f=c[1],p=c[2],v=c[3],g=(0,h.Z)(l[1],4),_=g[0],y=g[1],m=g[2],E=g[3];e.beginPath(),e.ellipse(d[0],d[1],_[0],_[1],0,Math.PI,1.5*Math.PI,!1),e.lineTo(f[0],o),e.ellipse(f[0],f[1],y[0],y[1],0,1.5*Math.PI,0,!1),e.lineTo(i+s,p[1]),e.ellipse(p[0],p[1],m[0],m[1],0,0,.5*Math.PI,!1),e.lineTo(v[0],o+u),e.ellipse(v[0],v[1],E[0],E[1],0,.5*Math.PI,Math.PI,!1),e.lineTo(i,d[1]),e.closePath()}function ni(e,t,n,r,i){if(Ce(i)){var o=i.borderTopWidth,a=void 0===o?0:o,s=i.borderRightWidth,u=void 0===s?0:s,l=i.borderBottomWidth,c=void 0===l?0:l,h=i.borderLeftWidth,d=void 0===h?0:h,f=i.bTLRH,p=void 0===f?0:f,v=i.bTLRV,g=void 0===v?p:v,_=i.bTRRH,y=void 0===_?0:_,m=i.bTRRV,E=void 0===m?y:m,b=i.bBRRH,T=void 0===b?0:b,C=i.bBRRV,S=void 0===C?T:C,w=i.bBLRH,R=void 0===w?0:w,A=i.bBLRV,O=void 0===A?R:A,M=function(e){return e.map((function(e){return Math.max(0,e)}))},k=M([p-d,g-a]),I=[e+k[0],t+k[1]],x=M([y-u,E-a]),N=[e+n-x[0],t+x[1]],P=M([R-d,O-c]),L=[e+P[0],t+r-P[1]],D=M([T-u,S-c]);return{rect:[[e,t],[n,r]],ellipse:[[I,N,[e+n-D[0],t+r-D[1]],L],[k,x,D,P]]}}}var ri=function(){function e(){(0,d.Z)(this,e)}return(0,f.Z)(e,[{key:"onPush",value:function(e){var t=e.subType,n=e.painter;if("clip"===t){var r=e.parentArea,i=e.rect,o=e.radius,a=e.renderObject,s=e.needSetPaintArea,u=e.area;if(r||u){var l=or(a),c=Ee(a),h=r?Jr(r,l,i):u;h.style=c;var d=h.x,f=h.y,p=h.width,v=h.height;if(r&&function(e,t){var n,r,i,o,a,s,u,l,c,h,d,f,p,v,g,_;return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height&&e.scrollLeft===t.scrollLeft&&e.scrollTop===t.scrollTop&&(null===(n=e.style)||void 0===n?void 0:n.bBLRH)===(null===(r=t.style)||void 0===r?void 0:r.bBLRH)&&(null===(i=e.style)||void 0===i?void 0:i.bBLRV)===(null===(o=t.style)||void 0===o?void 0:o.bBLRV)&&(null===(a=e.style)||void 0===a?void 0:a.bBRRH)===(null===(s=t.style)||void 0===s?void 0:s.bBRRH)&&(null===(u=e.style)||void 0===u?void 0:u.bBRRV)===(null===(l=t.style)||void 0===l?void 0:l.bBRRV)&&(null===(c=e.style)||void 0===c?void 0:c.bTLRH)===(null===(h=t.style)||void 0===h?void 0:h.bTLRH)&&(null===(d=e.style)||void 0===d?void 0:d.bTLRV)===(null===(f=t.style)||void 0===f?void 0:f.bTLRV)&&(null===(p=e.style)||void 0===p?void 0:p.bTRRH)===(null===(v=t.style)||void 0===v?void 0:v.bTRRH)&&(null===(g=e.style)||void 0===g?void 0:g.bTRRV)===(null===(_=t.style)||void 0===_?void 0:_.bTRRV)}(r,h))return;s&&Cr(n,a,h),o=ni(d,f,p,v,c),i={left:h.x,top:h.y,width:h.width,height:h.height}}n.save(),n.beginPath(),o?ti(n,o):n.rect(i.left,i.top,i.width,i.height),n.clip()}else n.restore()}}],[{key:"type",get:function(){return 5}}]),e}(),ii={willPaint:g.ZT,didPaint:g.ZT,commandPlugins:[ri]};g.ZT,g.ZT;function oi(e,t){if("string"==typeof e){var n=t[e];n&&(e="function"==typeof n?n(e):n)}return e}var ai={blinkmacsystemfont:{fontSize:128,fontHeight:151,fontAscent:124,fontDescent:27,emAscent:112.5,emDescent:15.5,lineHeight:151,xHeight:65,capHeight:103,ascender:28,descender:23,slope:12.1},"helvetica neue":{fontSize:128,fontHeight:149.5,fontAscent:122,fontDescent:27.5,emAscent:111,emDescent:17,lineHeight:153,xHeight:66,capHeight:102,ascender:28,descender:26,slope:11.9},times:{fontSize:128,fontHeight:147,fontAscent:115,fontDescent:32,emAscent:105.5,emDescent:22.5,lineHeight:147,xHeight:58,capHeight:110,ascender:31,descender:27,slope:14.9},arial:{fontSize:128,fontHeight:143,fontAscent:116,fontDescent:27,emAscent:108.5,emDescent:19.5,lineHeight:147,xHeight:66,capHeight:101,ascender:28,descender:26,slope:11.8},"segoe ui":{fontSize:128,fontHeight:170,fontAscent:138,fontDescent:32,emAscent:117,emDescent:11,lineHeight:170,xHeight:64,capHeight:116,ascender:33,descender:30,slope:12},"pingfang sc":{fontSize:128,fontHeight:179,fontAscent:135.5,fontDescent:43.5,emAscent:110,emDescent:18,lineHeight:179,xHeight:66,capHeight:103,ascender:28,descender:27,slope:14.1},"microsoft yahei":{fontSize:128,fontHeight:169,fontAscent:135.5,fontDescent:33.5,emAscent:115,emDescent:13,lineHeight:169,xHeight:69,capHeight:113,ascender:36,descender:32,slope:14.1},tahoma:{fontSize:128,fontHeight:154.5,fontAscent:128,fontDescent:26.5,emAscent:114.5,emDescent:13.5,lineHeight:154.5,xHeight:70,capHeight:120,ascender:29,descender:26,slope:14.1},"hiragino sans gb":{fontSize:128,fontHeight:128,fontAscent:112.5,fontDescent:15.5,emAscent:112.5,emDescent:15.5,lineHeight:192,xHeight:70,capHeight:108,ascender:30,descender:27,slope:14.1},"apple color emoji":{fontSize:128,fontHeight:168,fontAscent:128,fontDescent:40,emAscent:108,emDescent:20,lineHeight:179,xHeight:66,capHeight:103,ascender:28,descender:27,slope:14.1},"segoe ui emoji":{fontSize:128,fontHeight:120,fontAscent:93,fontDescent:27,emAscent:97,emDescent:31,lineHeight:137,xHeight:63,capHeight:116,ascender:34,descender:30,slope:14.1},"segoe ui symbol":{fontSize:128,fontHeight:170,fontAscent:138,fontDescent:32,emAscent:117,emDescent:11,lineHeight:170,xHeight:64,capHeight:116,ascender:33,descender:30,slope:14.1},"noto color emoji":{fontSize:128,fontHeight:150.5,fontAscent:119,fontDescent:31.5,emAscent:107.5,emDescent:20.5,lineHeight:179,xHeight:66,capHeight:103,ascender:28,descender:27,slope:14.1}},si=128,ui=new Map;function li(e){var t,n,r,i=document.createElement("canvas"),o=function(t){return function(e,t,n,r){var i="".concat(n,"px"),o="".concat(i," ").concat(t),a=e.getContext("2d");a.font=o;var s=a.measureText(r);if(s.fontSize=n,""===r.trim())return Object.assign(s,{height:0,ascent:0,descent:0});var u=fi(e,n,r,o,s.width),l=u.width,c=u.baseline,h=u.data,d=0,f=4*l,p=h.length;for(;++d<p&&255===h[d];);var v=d/f|0;d=p-1;for(;--d>0&&255===h[d];);var g=d/f|0;return s.ascent=c-v,s.descent=g-c,s.height=g-v,e.width=l,s}(i,e,si,t)},a=o("abcdefghijklmnopqrstuvwxyz");return Object.assign(a,function(e,t){var n=pi();n.style.fontSize="".concat(t,"px"),n.style.fontFamily=e;var r=document.createElement("span");r.textContent="A";var i=document.createElement("img");i.style.verticalAlign="baseline",r.appendChild(i),n.appendChild(r),document.body.appendChild(n);var o=n.getBoundingClientRect().height,a=r.getBoundingClientRect(),s=a.top,u=a.height,l=i.getBoundingClientRect().top-s,c=u-l;n.style.lineHeight="1";var h=n.getBoundingClientRect().top,d=i.getBoundingClientRect().top-h,f=t-d;return document.body.removeChild(n),{fontAscent:l,fontDescent:c,fontHeight:u,emAscent:d,emDescent:f,lineHeight:o}}(e,si)),Object.defineProperty(a,"xHeight",{enumerable:!0,get:function(){return void 0===t&&(t=o("x").height),t}}),Object.defineProperty(a,"capHeight",{enumerable:!0,get:function(){return void 0===n&&(n=o("ABCDEFGHIJKLMNOPQRSTUVWXYZ").height),n}}),Object.defineProperty(a,"ascender",{enumerable:!0,get:function(){return a.ascent-a.xHeight}}),Object.defineProperty(a,"descender",{enumerable:!0,get:function(){return a.descent}}),Object.defineProperty(a,"slope",{enumerable:!0,get:function(){return void 0===r&&(r=function(e,t,n){for(var r="".concat(n,"px"),i="italic ".concat(r," ").concat(t),o=fi(e,n,"I",i,n),a=o.height,s=o.width,u=o.data,l=[],c=4*s,d=0;d<a;d++){for(var f=0,p=0,v=0;v<s;v++)u[d*c+4*v]<255&&(f+=v,p++);p&&l.push([f/p,d])}var g=l.length;if(g){var _=l.reduce((function(e,t){var n=(0,h.Z)(e,2),r=n[0],i=n[1],o=(0,h.Z)(t,2);return[r+o[0],i+o[1]]})).map((function(e){return e/g})),y=(0,h.Z)(_,2),m=y[0],E=y[1],b=l.reduce((function(e,t){var n=(0,h.Z)(e,2),r=n[0],i=n[1],o=(0,h.Z)(t,2),a=o[0];return[r+a*o[1],i+a*a]}),[0,0]),T=(0,h.Z)(b,2),C=T[0],S=T[1],w=180*Math.atan2(C-g*m*E,S-g*m*m)/Math.PI;return Math.ceil(10*(90+w))/10}return 0}(i,e,si)),r}}),a}var ci,hi=new Set(["slope"]);function di(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:si,r=n/(null!==(t=e.fontSize)&&void 0!==t?t:si),i={},o=function(t){Object.defineProperty(i,t,{enumerable:!0,get:function(){return(hi.has(t)?1:r)*e[t]}})};for(var a in e)o(a);return i}function fi(e,t,n,r,i){var o=3*t,a=~~(i+2*o),s=3*t,u=s/2;e.width=a,e.height=s;var l=e.getContext("2d");l.font=r,l.fillStyle="white",l.fillRect(-1,-1,a+2,s+2),l.fillStyle="black",l.fillText(n,o,u);var c=l.getImageData(0,0,a,s);return{baseline:u,data:c.data,width:c.width,height:c.height,colorSpace:c.colorSpace}}function pi(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",t=document.createElement(e);return t.style.left="100vw",t.style.top="100vh",t.style.position="absolute",t.style.zIndex="-99999",t.style.visibility="hidden",t.style.pointerEvents="none",t}var vi=new Map;function gi(e){var t=e.toLowerCase();if("arial"===t||"helvetica"===t||"sans-serif"===t||"serif"===t)return!0;if(vi.has(e))return vi.get(e);var n=pi("span");n.textContent="abcdefghijklmnopqrstuvwxyz",n.style.fontSize="".concat(si,"px"),n.style.fontFamily=e+",Arial",document.body.appendChild(n);var r=n.getBoundingClientRect(),i=r.width,o=r.height,a=function(e){if(!ci){e.style.fontFamily="Arial";var t=e.getBoundingClientRect(),n=t.width,r=t.height;ci=[n,r]}return ci}(n),s=(0,h.Z)(a,2),u=s[0],l=s[1];document.body.removeChild(n);var c=Math.abs(i-u)>1e-5||Math.abs(o-l)>1e-5;return vi.set(e,c),c}function _i(e){for(var t=e.split(","),n=0;n<t.length;n++)if(gi(t[n]))return t[n].replace(/["'\s]+/g," ").trim();return null}var yi=new Map;function mi(e,t){if(""===e)return{width:0};var n=this.font;t&&(n="object"===(0,c.Z)(t)?function(e){var t,n,r,i=null!==(t=e.fontWeight)&&void 0!==t?t:"",o=null!==(n=e.fontStyle)&&void 0!==n?n:"",a=null!==(r=e.fontFamily)&&void 0!==r?r:"",s=e.fontSize;return"number"==typeof s?s="".concat(s,"px"):s||(s="16px"),"".concat(i," ").concat(o," ").concat(s," ").concat(a)}(t):t),yi.get(n)||yi.set(n,new Map);var r=yi.get(n),i=r.get(e);return i||(t&&(this.font=n),i=this.measureText(e),r.set(e,i)),i}var Ei=new Map,bi=new Map,Ti=new Map;function Ci(e){return Ti.get(e)||e}var Si=function(){function e(t,n){(0,d.Z)(this,e),this._canvas=void 0,this._ctx=void 0,this._saveNum=0,this._keepSaveNum=-1,this._colorMap={};var r=n.zIndex,i=n.left,o=n.top,a=n.height,s=n.width,u=n.DPR,l=n.needListenEvent,c=document.createElement("canvas");c.style.position="absolute",c.style.left="0px",c.style.top="0px",c.style.zIndex=r.toString(),c.style.height="".concat(a,"px"),c.style.width="".concat(s,"px"),c.height=a*u,c.width=s*u,c.style.transform="translate(".concat(i,"px, ").concat(o,"px)"),c.style.textRendering="auto",c.style.fontFeatureSettings="normal",c.style.letterSpacing="normal",c.style.fontVariantNumeric="normal",c.style.fontVariantLigatures="normal",c.style.imageRendering="pixelated",l||(c.style.pointerEvents="none");var h=c.getContext("2d");h.setTransform(u,0,0,u,0,0),t.appendChild(c);var f=new Proxy(c,{get:function(e,t,n){if("getContext"===t)return function(t){return"2d"===t?Ei.get(n):e.getContext(t)};var r=e[t];return"function"==typeof r?r.bind(e):r},set:function(e,t,n){return e[t]=n,!0}});this._canvas=f,this._ctx=h,Ei.set(f,this),bi.set(this,f),Ti.set(this,h),Ti.set(f,c)}return(0,f.Z)(e,null,[{key:"createPainter",value:function(t,n){return new e(t,n)}},{key:"updatePos",value:function(e,t){var n=t.top,r=t.left;e.style.transform="translate(".concat(r,"px, ").concat(n,"px)")}},{key:"updateSize",value:function(e,t){var n=t.DPR,r=t.width,i=t.height,o=Math.round(i*n),a=Math.round(r*n),s="".concat(o/n,"px"),u="".concat(a/n,"px"),l=!1;e instanceof HTMLCanvasElement?(e.width!==a&&(e.width=a,l=!0),e.height!==o&&(e.height=o,l=!0),s!==e.style.height&&(e.style.height=s),u!==e.style.width&&(e.style.width=u),e.getContext("2d").setTransform(n,0,0,n,0,0)):(e.style.width=u,e.style.height=s);return l}},{key:"updateRect",value:function(e,t){var n=t.DPR,r=t.left,i=t.top,o=t.width,a=t.height,s=this.updateSize(e,{DPR:n,width:o,height:a});return this.updatePos(e,{left:r,top:i}),s}},{key:"destroyPainter",value:function(e){var t=bi.get(e);bi.delete(e),Ti.delete(e),t&&(Ti.delete(t),Ei.delete(t))}}]),(0,f.Z)(e,[{key:"roundRect",value:function(e,t,n,r,i){return this._ctx.roundRect(e,t,n,r,i)}},{key:"setColorMap",value:function(e){this._colorMap=e}},{key:"getColorByToken",value:function(e){return oi(e,this._colorMap)}},{key:"getContextAttributes",value:function(){return this._ctx.getContextAttributes()}},{key:"drawImage",value:function(e,t,n,r,i,o,a,s,u){this._ctx.drawImage(e,t,n,r,i,o,a,s,u)}},{key:"beginPath",value:function(){this._ctx.beginPath()}},{key:"clip",value:function(){this._ctx.clip()}},{key:"fill",value:function(){var e;(e=this._ctx).fill.apply(e,arguments)}},{key:"isPointInPath",value:function(e,t,n,r){return this._ctx.isPointInPath(e,t,n,r)}},{key:"isPointInStroke",value:function(e,t,n){return this._ctx.isPointInStroke(e,t,n)}},{key:"stroke",value:function(e){void 0===e?this._ctx.stroke():this._ctx.stroke(e)}},{key:"createPattern",value:function(e,t){return this._ctx.createPattern(e,t)}},{key:"createLinearGradient",value:function(e,t,n,r){return this._ctx.createLinearGradient(e,t,n,r)}},{key:"createRadialGradient",value:function(e,t,n,r,i,o){return this._ctx.createRadialGradient(e,t,n,r,i,o)}},{key:"createConicGradient",value:function(e,t,n){return this._ctx.createConicGradient(e,t,n)}},{key:"createImageData",value:function(e,t,n){return this._ctx.createImageData(e,t,n)}},{key:"getImageData",value:function(e,t,n,r,i){return this._ctx.getImageData(e,t,n,r,i)}},{key:"putImageData",value:function(e,t,n,r,i,o,a){this._ctx.putImageData(e,t,n,r,i,o,a)}},{key:"arc",value:function(e,t,n,r,i,o){this._ctx.arc(e,t,n,r,i,o)}},{key:"arcTo",value:function(e,t,n,r,i){this._ctx.arcTo(e,t,n,r,i)}},{key:"bezierCurveTo",value:function(e,t,n,r,i,o){this._ctx.bezierCurveTo(e,t,n,r,i,o)}},{key:"closePath",value:function(){this._ctx.closePath()}},{key:"ellipse",value:function(e,t,n,r,i,o,a,s){this._ctx.ellipse(e,t,n,r,i,o,a,s)}},{key:"lineTo",value:function(e,t){this._ctx.lineTo(e,t)}},{key:"moveTo",value:function(e,t){this._ctx.moveTo(e,t)}},{key:"quadraticCurveTo",value:function(e,t,n,r){this._ctx.quadraticCurveTo(e,t,n,r)}},{key:"rect",value:function(e,t,n,r){this._ctx.rect(e,t,n,r)}},{key:"getLineDash",value:function(){return this._ctx.getLineDash()}},{key:"setLineDash",value:function(e){this._ctx.setLineDash(e)}},{key:"clearRect",value:function(e,t,n,r){this._ctx.clearRect(e,t,n,r)}},{key:"fillRect",value:function(e,t,n,r){this._ctx.fillRect(e,t,n,r)}},{key:"strokeRect",value:function(e,t,n,r){this._ctx.strokeRect(e,t,n,r)}},{key:"setKeepSaveNum",value:function(){this._keepSaveNum=this._saveNum}},{key:"restore",value:function(){this._saveNum>this._keepSaveNum&&this._saveNum>0&&(this._saveNum--,this._ctx.restore())}},{key:"save",value:function(){this._saveNum++,this._ctx.save()}},{key:"restoreIfNeed",value:function(){for(;this._keepSaveNum<this._saveNum;)this.restore();this._keepSaveNum=-1}},{key:"fillText",value:function(e,t,n,r){this._ctx.fillText(e,t,n,r)}},{key:"measureText",value:function(e,t){return mi.call(this._ctx,e,t)}},{key:"measureFont",value:function(e,t){return function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:si;"string"==typeof r&&(r=parseInt(r,10));var i,o,a,s=e.toLowerCase();if(a=null!==(t=ui.get(e))&&void 0!==t?t:ui.get(s))return(i=a.get(r))?i:(o=di(i=a.get(si),r),a.set(r,o),o);var u,l=_i(e),c=l&&"serif"!==l&&"sans-serif"!==l,h=null!==(n=null==l?void 0:l.toLowerCase())&&void 0!==n?n:s;return ai[h]?i=ai[h]:(i=li(null!==(u=l)&&void 0!==u?u:e)).fontHeight||(i=ai.arial),o=di(i,r),a=new Map([[si,i],[r,o]]),ui.set(e,a),ui.set(s,a),l&&(ui.set(l,a),ui.set(h,a)),c&&(ai[h]=i),o}(e,t)}},{key:"strokeText",value:function(e,t,n,r){this._ctx.strokeText(e,t,n,r)}},{key:"getTransform",value:function(){return this._ctx.getTransform()}},{key:"setTransform",value:function(e,t,n,r,i,o){this._ctx.setTransform(e,t,n,r,i,o)}},{key:"resetTransform",value:function(){this._ctx.resetTransform()}},{key:"rotate",value:function(e,t){if(t){var n=t.x,r=t.y;this._ctx.translate(n,r),this._ctx.rotate(e),this._ctx.translate(-n,-r)}else this._ctx.rotate(e)}},{key:"scale",value:function(e,t){this._ctx.scale(e,t)}},{key:"transform",value:function(e,t,n,r,i,o){this._ctx.transform(e,t,n,r,i,o)}},{key:"translate",value:function(e,t){this._ctx.translate(e,t)}},{key:"drawFocusIfNeeded",value:function(e,t){this._ctx.drawFocusIfNeeded(e,t)}},{key:"fontKerning",get:function(){return this._ctx.fontKerning},set:function(e){this._ctx.fontKerning=e}},{key:"canvas",get:function(){return this._canvas}},{key:"saveNum",get:function(){return this._saveNum}},{key:"globalAlpha",get:function(){return this._ctx.globalAlpha},set:function(e){this._ctx.globalAlpha=e}},{key:"globalCompositeOperation",get:function(){return this._ctx.globalCompositeOperation},set:function(e){this._ctx.globalCompositeOperation=e}},{key:"fillStyle",set:function(e){!function(e,t,n){e.fillStyle=oi(t,n)}(this._ctx,e,this._colorMap)},get:function(){return this._ctx.fillStyle}},{key:"strokeStyle",set:function(e){!function(e,t,n){e.strokeStyle=oi(t,n)}(this._ctx,e,this._colorMap)},get:function(){return this._ctx.strokeStyle}},{key:"filter",set:function(e){this._ctx.filter=e},get:function(){return this._ctx.filter}},{key:"imageSmoothingEnabled",get:function(){return this._ctx.imageSmoothingEnabled},set:function(e){this._ctx.imageSmoothingEnabled=e}},{key:"imageSmoothingQuality",get:function(){return this._ctx.imageSmoothingQuality},set:function(e){this._ctx.imageSmoothingQuality=e}},{key:"lineCap",get:function(){return this._ctx.lineCap},set:function(e){this._ctx.lineCap=e}},{key:"lineDashOffset",get:function(){return this._ctx.lineDashOffset},set:function(e){this._ctx.lineDashOffset=e}},{key:"lineJoin",get:function(){return this._ctx.lineJoin},set:function(e){this._ctx.lineJoin=e}},{key:"lineWidth",get:function(){return this._ctx.lineWidth},set:function(e){this._ctx.lineWidth=e}},{key:"miterLimit",get:function(){return this._ctx.miterLimit},set:function(e){this._ctx.miterLimit=e}},{key:"shadowBlur",get:function(){return this._ctx.shadowBlur},set:function(e){this._ctx.shadowBlur=e}},{key:"shadowColor",get:function(){return this._ctx.shadowColor},set:function(e){!function(e,t,n){e.shadowColor=oi(t,n)}(this._ctx,e,this._colorMap)}},{key:"shadowOffsetX",get:function(){return this._ctx.shadowOffsetX},set:function(e){this._ctx.shadowOffsetX=e}},{key:"shadowOffsetY",get:function(){return this._ctx.shadowOffsetY},set:function(e){this._ctx.shadowOffsetY=e}},{key:"direction",get:function(){return this._ctx.direction},set:function(e){this._ctx.direction=e}},{key:"font",get:function(){return this._ctx.font},set:function(e){this._ctx.font=e}},{key:"textAlign",get:function(){return this._ctx.textAlign},set:function(e){this._ctx.textAlign=e}},{key:"textBaseline",get:function(){return this._ctx.textBaseline},set:function(e){this._ctx.textBaseline=e}}]),e}(),wi=Si,Ri=function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=r.blackList,o=r.whiteList;if(e===t)return null;var a=new Set(null!==(n=o)&&void 0!==n?n:Object.keys(e).concat(Object.keys(t))),s=[];return a.forEach((function(n){if(null==i||!i.includes(n)){var r=Reflect.has(e,n),o=Reflect.has(t,n);if(r||o){var a=Reflect.get(e,n);r?o?Reflect.get(e,n)!==Reflect.get(t,n)&&s.push([n,{prev:a,flag:2}]):s.push([n,{prev:a,flag:0}]):s.push([n,{prev:a,flag:1}])}}})),s},Ai=function e(t,n){if(t===n)return null;var r=new Set(Object.keys(t).concat(Object.keys(n))),i=[];return r.forEach((function(r){var o=Reflect.has(t,r),a=Reflect.has(n,r);if(o||a){var s=Reflect.get(t,r);if(o)if(a){if(Reflect.get(t,r)!==Reflect.get(n,r)){var u=Reflect.get(n,r);if((0,g.PO)(s)&&(0,g.PO)(u)){var l=e(s,u);l&&l.length>0&&i.push([r,l])}else i.push([r,{prev:s,flag:2}])}}else i.push([r,{prev:s,flag:0}]);else i.push([r,{prev:s,flag:1}])}})),i};function Oi(e,t){for(var n=0,r=e.length;n<r;){var i=Math.floor((n+r)/2);switch(t(e[i],i,e)){case"left":r=i;break;case"right":n=i+1;break;case"found":return i}}return n}var Mi=function(){var e=et(["mutate"]);return function(t){for(var n,r,i=Ua(t)?Za:Qo,o=Ua(t)?Dt:Ft,a=!1,s=t;s;){if(!r&&e.has(s)){r=e.get(s),a=!0;break}if(o(s)&&(r=s),i(s,[p.j2.Absolute,p.j2.Fixed,p.j2.TableCell])||!s.parent||i(s.parent,[p.j2.BlockFlow,p.j2.SuperList,p.j2.FlexColumn,p.j2.FlexRow]))break;s=s.parent}r=null!==(n=r)&&void 0!==n?n:s;for(var u=F(t,a?s:r),l=0;l<u.length;l++)e.set(u[l],r);return r}}();function ki(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null!==(t=e.children)&&void 0!==t&&t.length?e.children.length:Ua(e,p.j2.Text)||Jo(e,p.j2.Text)?e.props.content.length:n}function Ii(e,t){var n=Jo(e);n&&(e=rs(e));for(var r=[],i=e;i&&(r.push(i),i!==t);)i=i.refPosRo;return n?r.map((function(e){return e.element})):r}function xi(e,t){var n=F(e).reverse();if(t.length&&ne(F((0,g.Z$)(t)).reverse(),n)<0)return t.length;var r=Oi(t,(function(e){var t=ne(F(e).reverse(),n);return t>0?"left":t<0?"right":"found"}));return r}function Ni(e,t,n){var r,i=e.children;r=(0,g.hj)(n)&&n<i.length&&n>=0?n:i.length,re(t,"parent",e),function(e,t,n){var r=e.children;(void 0===r?[]:r).splice(t,0,n)}(e,r,t),ja(t)&&Pi(t)}function Pi(e){var t=function(e){if(Ua(e,p.j2.Fixed)){for(;e.parent;)e=e.parent;return e}for(;e.parent;){if(ja(e.parent))return e.parent;e=e.parent}return e}(e);if(t){re(e,"refPosRo",t),t.posRos||(t.posRos=[]);var n=t.posRos,r=xi(e,n);r>=n.length?n.splice(n.length,0,e):n[r]!==e&&n.splice(r,0,e)}}var Li=new Set,Di=!1,Fi=function(){Li.clear(),Di=!1},Bi=function(){Di=!0},Vi=function(e){Di&&!Li.has(e._id)&&Li.add(e._id)};function Hi(e){return!!e&&!Li.has(e._id)}function Ui(e,t,n,r){var i,o,a,s,u,l=null!==(i=n)&&void 0!==i?i:0;t&&null!==(o=e.renderObjects)&&void 0!==o&&o.length?u=e.renderObjects[l]:(!function(e){var t=ss(e);if(t){e.renderObjects=[];for(var n=new Array(t.length),r=0;r<t.length;r++){var i=t[r],o=i.parent;if(o&&!i.isDestructed){var a=te(i);a>-1&&ce(o,a),ps(i),n[r]={parent:o,target:i,index:a}}else n[r]=null}}}(e),u=ls(e),Vi(e));var c=va(e),h=null!==(a=r)&&void 0!==a?a:ns(c);return h&&h.element!==(null===(s=u.parent)||void 0===s?void 0:s.element)&&Ni(h,u),u}function Zi(e,t){for(var n=Ui(e,!0),r=[e];r.length;){for(var i=[],o=0;o<r.length;o++){for(var a=[],s=0;s<r[o].children.length;s++){var u=ga(r[o].children[s]);a=a.concat(u)}for(var l=0;l<a.length;l++){var c=a[l];if(!Sa(c)){var h,d=Pt(c);null!=d&&null!==(h=d.build)&&void 0!==h&&h.run?d.build.run(c):(Ui(c,!0),i.push(c))}}}r=i}return n}function Wi(e,t,n){return Ni(t,ls(e),n),Zi(e)}var ji=function(e){var t,n=e.parent;if(n){var r=null!==(t=n.runtime)&&void 0!==t?t:gs(n),i=r.status;Os(n),function(e,t){var n=5&t;return 0!==n&&(5&e)!==n}(i,r.status)&&Is(r)}},Gi=function(e){var t=e.isDestructed;return void 0!==t&&t},zi=function(e){var t,n,r=e.renderObjects,i=r[0];if(i){for(var o=null!==(t=null===(n=i.parent)||void 0===n?void 0:n.children.indexOf(i))&&void 0!==t?t:0,a=i.parent,s=[],u=0;u<r.length;u++){var l=r[u];l.children&&Array.prototype.push.apply(s,l.children),l.children=[]}vs(e);var c=ls(e);a&&Ni(a,c,o);for(var h=0;h<s.length;h++)Ni(c,s[h]);return c}};function Yi(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Xi(e,n,t)}function Xi(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0;if(e.renderObjects&&e.renderObjects.length&&(!ea(e)||!n)){e.renderObjects.length>1?t=zi(e):(t=rs(e),ks(t,!0)),null==r||r(e,t);for(var i=_a(e),o=0;o<i.length;o++)Xi(i[o],n,r);return t}}function Ki(e){if(Hi(e)){var t=rs(e);if(t){var n,r=t.parent;if(r){var i,o=null!==(i=null==r?void 0:r.children.indexOf(t))&&void 0!==i?i:0;vs(e),n=Wi(e,r,o)}else{n=t;var a=t.children;if(null!=a&&a.length)for(var s=0;s<a.length;s++)ps(a[s]);ks(n)}return Vi(e),n}}}function qi(e,t){var n,r;if((null!==(n=null===(r=e.renderObjects)||void 0===r?void 0:r.length)&&void 0!==n?n:0)>1){var i=zi(e);return function(e,t){for(var n=e;n&&n!==t;){var r=rs(n);ji(r),n=va(n)}}(e,t),i}return ns(e)}function $i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(!ea(e)){var n=qi(e,t);return e.children.forEach((function(t){$i(t,e)})),n}}function Ji(e){var t=[];return ga(e).forEach((function(e){var n;Array.prototype.push.apply(t,null!==(n=e.renderObjects)&&void 0!==n?n:[])})),t}var Qi=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.runtime;if(n){if(!_s(n))return;Ze(n,{status:2|n.status,isSkipLayout:!1})}if(!t||!Wa(e))for(var r=e.parent;r;){var i=r.runtime;if(i){var o;if(!_s(i))return;Ze(i,{status:2|(null!==(o=null==n?void 0:n.status)&&void 0!==o?o:0),isSkipLayout:!1})}if(t&&Wa(r))return;r=r.parent}},eo=new Set(["borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","outlineTopWidth","outlineRightWidth","outlineBottomWidth","outlineLeftWidth","borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius","marginTop","marginRight","marginBottom","marginLeft","paddingTop","paddingRight","paddingBottom","paddingLeft","width","height","maxWidth","maxHeight","minWidth","minHeight","outlineOffset","top","right","bottom","left","fontSize","textIndent"]);function to(e){if("number"==typeof e)return new Array(4).fill(e);var t=no(e),n=t.length;return n?(n>3||(1===n?(t[1]=t[0],t[3]=t[0]):t[3]=t[1],n<3&&(t[2]=t[0])),t):new Array(4).fill(0)}function no(e){for(var t=[],n=0,r=(e=e.trim().replace(/\s+/g," ")).length,i=0;i<r;i++)switch(e[i]){case"(":for(;++i<r&&")"!==e[i];);break;case" ":t.push(e.substring(n,i)),n=i+1}return t.push(e.substring(n)),t}var ro={},io=function(e,t){return uo(e,"margin",t)},oo=function(e){var t,n,r,i,o,a,s,u,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:lo(e),c={bTLRH:null!==(t=e.borderTopLeftRadius)&&void 0!==t?t:e.bTLRH,bTLRV:null!==(n=e.borderTopLeftRadius)&&void 0!==n?n:e.bTLRV,bTRRH:null!==(r=e.borderTopRightRadius)&&void 0!==r?r:e.bTRRH,bTRRV:null!==(i=e.borderTopRightRadius)&&void 0!==i?i:e.bTRRV,bBRRH:null!==(o=e.borderBottomRightRadius)&&void 0!==o?o:e.bBRRH,bBRRV:null!==(a=e.borderBottomRightRadius)&&void 0!==a?a:e.bBRRV,bBLRH:null!==(s=e.borderBottomLeftRadius)&&void 0!==s?s:e.bBLRH,bBLRV:null!==(u=e.borderBottomLeftRadius)&&void 0!==u?u:e.bBLRV},d=e.borderRadius,f=null!=d&&""!==d;if(f)if(d!==e.__borderRadius){var v,_,y=function(t,n){return void 0!==e[t]&&l[t]>l.borderRadius?c[t]:n};if("string"==typeof d){var m,E=d.split("/").map((function(e){return to(e)})),b=(0,h.Z)(E,2);v=b[0],_=b[1],_=null!==(m=_)&&void 0!==m?m:v}else _=v=to(d);p.in.map((function(e){return["".concat(e,"H"),"".concat(e,"V")]})).forEach((function(e,t){var n=(0,h.Z)(e,2),r=n[0],i=n[1];c[r]=y(r,v[t]),c[i]=y(i,_[t])}))}else Object.keys(c).forEach((function(t){!e["__".concat(t)]||void 0!==e[t]&&l[t]>l.borderRadius||(c[t]=e["__".concat(t)])}));p.lB.forEach((function(t,n){var r=e[t];if(r&&!(f&&l.borderRadius>l[t])){var i=["".concat(p.in[n],"H"),"".concat(p.in[n],"V")];if(r!==e["__".concat(t)]){var o,a;if("string"==typeof r){var s,u=no(r),d=(0,h.Z)(u,2);o=d[0],a=null!==(s=a=d[1])&&void 0!==s?s:o}else a=o=r;var v=[o,a];i.forEach((function(n,r){return c[n]=function(n,r){return void 0!==e[n]&&l[n]>l[t]?c[n]:r}(n,v[r])}))}else i.forEach((function(n){!e["__".concat(n)]||void 0!==e[n]&&l[n]>l[t]||(c[n]=e["__".concat(n)])}))}})),p.BN.forEach((function(t){void 0===c[t]&&(c[t]=e["__".concat(t)])})),(0,g.f0)(e,c)};function ao(e,t){for(var n=0;n<t.length;n++)if(e[t[n]])return!0;return!1}function so(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:lo(e),r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=p.gG[t],o=(i.allSide,i.allWidth),a=i.allDirection,s=i.widthSide,u=i.styleSide,l=i.colorSide;if(r||ao(e,o)){var c={};a.forEach((function(t){c[t]=e[t]}));var d=void 0!==e[t]&&null!==e[t]&&""!==e[t];if(d)if(e[t]!==e["__".concat(t)]){var f=function(r,i){return void 0!==e[r]&&n[r]>n[t]?c[r]:i},v=no(e[t]),_=(0,h.Z)(v,3),y=_[0],m=_[1],E=_[2];y&&s.forEach((function(e){c[e]=f(e,y)})),m&&u.forEach((function(e){c[e]=f(e,m)})),E&&l.forEach((function(e){c[e]=f(e,E)}))}else Object.keys(c).forEach((function(r){!e["__".concat(r)]||void 0!==e[r]&&n[r]>n[t]||(c[r]=e["__".concat(r)])}));p.zh.forEach((function(r){var i="".concat(t).concat(r),o=e[i];if(o&&!(d&&n[t]>n[i]))if(o!==e["__".concat(i)]){var a=no(o),s=(0,h.Z)(a,3),u=s[0],l=s[1],f=s[2];u&&(void 0===e["".concat(i,"Width")]||n["".concat(i,"Width")]<n[i])&&(c["".concat(i,"Width")]=u),l&&(void 0===e["".concat(i,"Style")]||n["".concat(i,"Style")]<n[i])&&(c["".concat(i,"Style")]=l),f&&(void 0===e["".concat(i,"Color")]||n["".concat(i,"Color")]<n[i])&&(c["".concat(i,"Color")]=f)}else["".concat(i,"Width"),"".concat(i,"Style"),"".concat(i,"Color")].forEach((function(t){!e["__".concat(t)]||void 0!==e[t]&&n[t]>n[i]||(c[t]=e["__".concat(t)])}))})),["Width","Style","Color"].forEach((function(r){var i,o="".concat(t).concat(r),a=e[o];void 0===a||d&&n[t]>n[o]||(a!==e["__".concat(o)]&&(i=to(a)),p.zh.forEach((function(a,s){var u,l;e["".concat(t).concat(a)]&&n["".concat(t).concat(a)]>n[o]||e["".concat(t).concat(a).concat(r)]&&n["".concat(t).concat(a).concat(r)]>n[o]||(c["".concat(t).concat(a).concat(r)]=null!==(u=null===(l=i)||void 0===l?void 0:l[s])&&void 0!==u?u:e["__".concat(t).concat(a).concat(r)])})))})),s.forEach((function(e){var t=c[e];c[e]="string"==typeof t?parseInt(t,10):t})),(0,g.f0)(e,c)}}function uo(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:lo(e),r=p.zh.map((function(e){return"".concat(t).concat(e)})),i=e[t];if(void 0===i)return r.forEach((function(t){return e[t]=e[t]||0}));if(e["__".concat(t)]===i)return r.forEach((function(t){(void 0===e[t]||n[t]<n["__".concat(t)])&&(e[t]=e["__".concat(t)])}));if(!co(i))return Se.error("unsupport "+t+" value",i),ro;var o=to(i);r.forEach((function(r,i){(void 0===e[r]||n[r]<n[t])&&(e[r]=o[i])}))}function lo(e){var t={};return Object.keys(e).forEach((function(e,n){t[e]=n})),t}function co(e){var t=(0,c.Z)(e);return"number"===t||"string"===t}function ho(e){var t=lo(e);uo(e,"margin",t),uo(e,"padding",t),so(e,"border",t),so(e,"outline",t)}var fo=function(e,t,n,r,i){var o=i(e,n,t);2===r||1===r||void 0!==o?(t.props.sourceStyle[n]=o,ge(t,n,o)):(delete t.props.sourceStyle[n],me(t,n))},po=function(e,t,n,r,i,o,a,s){var u=(0,g.f0)({},e);a(u,i),2===r||1===r?o.forEach((function(e){var n=s(u,e,t);void 0!==n&&(t.props.sourceStyle[e]=n,ge(t,e,n))})):(me(t,n),o.forEach((function(e){var n=s(u,e,t);void 0===n?(delete t.props.sourceStyle[e],me(t,e)):(t.props.sourceStyle[e]=n,ge(t,e,n))})))},vo=function(e,t,n){var r;return e[t]&&De(e[t],{"%":null!==(r=n[t.endsWith("V")?"height":"width"])&&void 0!==r?r:0})},go=function(e,t){return e[t]},_o=function(e,t){return function(e,t,n){return so(e,"border",t,n)}(e,t,!0)},yo=function(e,t){return function(e,t,n){return so(e,"outline",t,n)}(e,t,!0)},mo=[].concat((0,l.Z)(p.$L),(0,l.Z)(p.Fp)),Eo=[function(e,t,n,r,i,o){var a=r.startsWith("border"),s=a?mo:p.oe,u=a?_o:yo;return["outline","outlineStyle","outlineColor","outlineWidth","borderColor","borderStyle"].includes(r)?(po(e,n,r,i,o,s,u,go),!0):!!s.includes(r)&&(fo(e,n,r,i,go),!0)},function(e,t,n,r,i,o){return"borderRadius"===r||p.lB.includes(r)?(po(e,n,r,i,o,p.BN,oo,vo),!0):!!p.BN.includes(r)&&(fo(e,n,r,i,vo),!0)},function(e,t,n,r,i){return fo(e,n,r,i,(function(e,n){var r;return null!==(r=e[n])&&void 0!==r?r:t?t[n]:void 0})),!0}],bo=function(e,t,n,r){var i=lo(t),o=Ee(e),a=Fe(t)&&!Fe(o)&&(0===o.width||0===o.height);r.forEach((function(r){var o=(0,h.Z)(r,2),s=o[0],u=o[1];s.startsWith("$")||(!a||"width"!==s&&"height"!==s||me(e,"display"),function(e,t,n,r,i,o){var a,s=_(Eo);try{for(s.s();!(a=s.n()).done&&!(0,a.value)(e,t,n,r,i,o););}catch(e){s.e(e)}finally{s.f()}}(t,n,e,s,u.flag,i))}))},To=function(e,t,n,r){if((null==r?void 0:r.style)&&bo(t,e.style,n,r.style),null!=r&&r.hoverState&&e.style.$hover){var i=function(e){var t,n,r=e.style;if(pe(e))t=r.$hover,n=Object.keys(r.$hover).map((function(e){return[e,{flag:2}]}));else{var i=Object.keys(r.$hover);t=r,n=i.reduce((function(e,t){return Reflect.has(r,t)?e.push([t,{flag:2}]):e.push([t,{flag:0}]),e}),[])}return{style:t,changes:n}}(e);bo(t,i.style,n,i.changes)}},Co=function(e){var t,n,r=e.el,i=e.changes;if(!r.renderObjects||!r.renderObjects.length)return!1;if(!r.renderObjects[0])return!1;var o=r.renderObjects;if(!o.length)return!1;var a=Te(r),s=o[0].parent?Ve(a,null===(t=o[0].parent.runtime)||void 0===t||null===(n=t.constraint)||void 0===n?void 0:n.inheritedStyle):null;return o.forEach((function(e){e.props.selectable=!1!==r.props.selectable,e.props.asRelative=r.props.asRelative,To(r,e,s,i)})),!0},So=function(){return!1},wo=function(e,t){var n=e.el;return{el:n,ro:rs(n),prev:(0,h.Z)(t,2)[1].prev}},Ro=function(e){return!!Yi(e.el)},Ao=function(e,t){var n=Co(e);if(n&&"asRelative"===t[0]){var r=e.el.renderObjects;if(null!=r&&r.length)for(var i=0,o=r.length;i<o;i++){Pi(r[i])}}return n},Oo=function(e,t){var n=wo(e,t).ro;return n&&Qi(n),!1},Mo=function(e,t){var n=wo(e,t).ro;return!!n&&(ks(n),!0)},ko=function(e,t,n){var r;return(null!==(r=e[n[0]])&&void 0!==r?r:So)(t,n)},Io=function(e,t,n){for(var r=!1,i=0;i<n.length;i++)r=r||ko(e,t,n[i]);return r};function xo(e,t,n){var r=t[n];void 0===r?me(e,n):ge(e,n,r)}function No(e,t,n,r){var i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=e.parent;if(!o||!ta(o))return!1;var a=He(t),s=rs(o);if("alignSelf"===n){var u=Ee(t.parent),l=u.alignCrossAxis;Lo(s,rs(e),a.alignSelf||l||"stretch",r||l||"stretch")}return xo(t,a,n),ks(s,i),!0}function Po(e,t,n,r){if(!ta(e))return!1;var i=He(t);return"alignCrossAxis"===n?Lo(t,null,i.alignCrossAxis||"stretch",r||"stretch"):"stretchDeep"===n&&r&&Do(t),xo(t,i,n),ks(t,!1),!0}function Lo(e,t,n,r){if(n!==r&&("stretch"===n||"stretch"===r))return t?(ks(t,!0),void Do(e,t)):void Do(e)}function Do(e,t){var n,r,i,o=null===(n=e.runtime)||void 0===n||null===(r=n.context)||void 0===r||null===(i=r.flexCtx)||void 0===i?void 0:i.originCrossSize;if(null!=o&&o.size){var a=Ua(e,p.j2.FlexRow)?"height":"width",s=function(e){for(var t=e;1===(null===(n=t.children)||void 0===n?void 0:n.length);){var n,r=t.children[0];if(!o.has(r))break;r[a]=o.get(r),t=r}};if(t)s(t);else{var u,l=_(e.children);try{for(l.s();!(u=l.n()).done;){var c=u.value;He(c).alignSelf||(ks(c,!0),s(c))}}catch(e){l.e(e)}finally{l.f()}}}}var Fo=function(e,t){return{flag:16,status:0}};function Bo(e){var t=e.style.$hover;if(!t)return{flag:0,status:0};var n=(0,g.ei)(e.style,Object.keys(t)),r=Ri(t,n);return r?Ho(e,r):{flag:0,status:0}}var Vo={$hover:function(e,t){var n,r=(0,h.Z)(t,2),i=(r[0],r[1]);return n=i,Array.isArray(n)?pe(e)?Ho(e,i):{flag:0,status:0}:Bo(e)},default:function(e,t){var n=(0,h.Z)(t,1)[0];return p.pF.includes(n)?{flag:5,status:1}:p.Nn.includes(n)?{flag:9,status:1}:p.qG.includes(n)?{flag:1,status:0}:{flag:0,status:0}},left:Fo,right:Fo,top:Fo,bottom:Fo};function Ho(e,t){var n,r=0,i=_(t);try{for(i.s();!(n=i.n()).done;){var o=n.value,a=(0,h.Z)(o,1)[0],s=(Vo[a]||Vo.default)(e,o),u=s.flag,l=s.status;if(r|=u,1===l)return{flag:r,status:l}}}catch(e){i.e(e)}finally{i.f()}return{flag:r,status:0}}var Uo=function(e,t){var n=0;return n|=Ho(e,t.style).flag,t.props.length>0&&(n|=2),t.hoverState&&e.style.$hover&&(n|=Bo(e).flag),n},Zo=function(e){return void 0!==e},Wo=function(e){var t=e.el,n=e.flag,r=rs(t);return!!r&&(Zo(n)&&function(e){return![0,16].includes(e)}(n)?(zi(t),!0):(Co(e),Zo(n)&&(ea(t)&&16===n||Qi(r)),!1))};function jo(e,t){var n=e.el,r=rs(n);if(!r)return{collectToTempEntry:!1};var i=(0,h.Z)(t,2),o=i[0],a=i[1].prev;switch(o){case"border":var s=function(e,t){var n,r,i=e.el,o={canBreak:!0,alongAncestors:!1};if(!(t=null!==(n=t)&&void 0!==n?n:rs(i)))return o;if(!Jo(i,p.j2.Table))return o.canBreak=!1,o;var a=t.runtime;if(null==a||!a.context)return o;var s=(null!==(r=Te(i).border)&&void 0!==r?r:"")||g.Ng.border;t.props.sourceStyle.border=s;var u=a.context.tpu.updateBorder(),l=u.hasChanged;return u.isWidthChange?(ks(t),a.status=Ss(a.status,[2],!0),o.alongAncestors=!0,o):(l&&Qi(t),o)}(e,r),u=s.canBreak,l=s.alongAncestors;return u?{collectToTempEntry:l}:Go(e);case"flexGrow":case"flexShrink":return{collectToTempEntry:!1,boundaryRo:No(n,r,o,a)?r.parent:void 0};case"alignSelf":return{collectToTempEntry:!1,boundaryRo:No(n,r,o,a,!1)?r.parent:void 0};case"alignMainAxis":case"alignCrossAxis":case"stretchDeep":return{collectToTempEntry:!1,boundaryRo:Po(n,r,o,a)?r:void 0};default:var c=Go(e);return"display"===t[0]&&(c.resetLayoutContext=!0),c}}function Go(e){var t=e.el,n=e.flag,r=e.changes;if(n&&(4&n||8&n)){var i=Co({el:t,changes:r});return{collectToTempEntry:!!Yi(t,!1),resetLayoutContext:i}}return{collectToTempEntry:Wo(e)}}function zo(e,t){for(var n={collectToTempEntry:!1},r=0;r<t.style.length;r++){var i,o=jo(e,t.style[r]),a=o.collectToTempEntry,s=o.boundaryRo,u=o.resetLayoutContext,l=void 0!==u&&u;n.collectToTempEntry=n.collectToTempEntry||a,n.boundaryRo=null!==(i=n.boundaryRo)&&void 0!==i?i:s,n.resetLayoutContext=n.resetLayoutContext||l}if(t.hoverState){var c=Go(e),h=c.collectToTempEntry,d=c.resetLayoutContext,f=void 0!==d&&d;n.collectToTempEntry=n.collectToTempEntry||h,n.resetLayoutContext=n.resetLayoutContext||f}return n}var Yo={move:function(e){ks(e)},update:function(e,t){var n=Io({lineWrap:Ro,asOneChar:Ro,selectable:Ao},e,t.props);return{collectToTempEntry:zo(e,t).collectToTempEntry||n}}},Xo=function e(t){var n,r;return n=e,r=p.j2.Component,n._displayName=r,t.children},Ko=function(e){function t(e){var n,r;(0,d.Z)(this,t),(r=(0,a.Z)(this,(0,s.Z)(t).call(this)))._element=void 0,r.props=void 0,r.state={},r.nextState=null,r.$context=void 0,r.props=(0,g.f0)({},e,{children:null!==(n=e.children)&&void 0!==n?n:null}),r._element=e.element;var i=L(r._element);return r.$context=i.getRContext(),r}return(0,u.Z)(t,e),(0,f.Z)(t,[{key:"element",get:function(){return qo(this._element)}}],[{key:"key",get:function(){return p.j2.Component}},{key:"isRoadsterComponent",get:function(){return!0}}]),(0,f.Z)(t,[{key:"setState",value:function(e,t){var n,r=null!==(n=this.nextState)&&void 0!==n?n:this.state;if(!this.$context.destroyed){for(var i in e)if(e[i]!==r[i]){wt(this._element,e);break}var o,a,s=D(this._element);Rt(this._element,t),o=s,null!==(a=Et.get(o))&&void 0!==a&&a.length||wt(this._element)}}},{key:"setStyle",value:function(e,t){var n=this._element,r=(0,g.ei)(n.style,Object.keys(e)),i=Ai(r,e);if(null!=i&&i.length){L(n).rNode.operator.update(n,{style:i,props:[]}),n.style=(0,g.f0)({},n.style,e);var o=D(n);Rt(n,t),St(o)}}},{key:"render",value:function(){return this.props.children||null}},{key:"forceUpdate",value:function(){wt(this._element)}},{key:"unmount",value:function(){}},{key:"isDirty",get:function(){return null!==this.nextState}}],[{key:"getSideEffects",value:function(){var e=xt(this.key);return e||(this.composeRenderSideEffects(),e=xt(this.key)),e}},{key:"composeRenderSideEffects",value:function(){It(this.key,{reconcile:{renderFunction:Xo},layout:_r,paint:ii,mutate:Yo})}}]),t}(b);function qo(e){for(var t=e.parent,n=e.style,r=e.children,i=e._id,o=e.props,a=e.type,s=e.instance,u=e.root,l=new Array(r.length),c=0,h=r.length;c<h;c++)l[c]=r[c]._id;if(e.shadow){var d=e.shadow;d.props=o,d.style=n,d.instance=s,d.children=l}else e.shadow={eid:i,props:o,parent:t?t._id:null,children:l,style:n,type:a,instance:s,root:u};return e.shadow}function $o(e){return!(null==e||!e.eid)}function Jo(e,t){var n,r=aa(e)?p.j2.Component:null==e||null===(n=e.type)||void 0===n?void 0:n.key;return t?t===r:void 0!==p.j2[r]}function Qo(e,t){var n,r=null==e||null===(n=e.type)||void 0===n?void 0:n.key;return t.includes(r)||aa(e)&&t.includes(p.j2.Component)}function ea(e){return Qo(e,p.tB)}function ta(e){return Qo(e,p._L)}function na(e){return Qo(e,p.V0)&&!!e.props.asRelative}function ra(e){return ea(e)||na(e)||!e.parent}function ia(e){return Qo(e,p.Rq)}function oa(e){return!!e.unit}function aa(e){var t=null==e?void 0:e.type;return(0,g.mf)(t)&&!t.isRoadsterComponent}function sa(e){return!e.parent}function ua(e){var t;return!!e&&((!(null!==(t=e.type)&&void 0!==t&&t.key)||Qo(e,[p.j2.Component])||aa(e))&&!(function(e){return!(!e.parent||!sa(e.parent))}(e)||sa(e)))}function la(e){return $o(e)?ca(e.root,e.eid):e}function ca(e,t){var n;return null!==(n=P(e).elementPool.get(t))&&void 0!==n?n:null}function ha(e,t,n){var r,i=ca(e,t),o=P(e).fragmentPool;return n&&(null===(r=o.get(n))||void 0===r?void 0:r.get(t))||i&&qo(i)}function da(e,t){return e.elementPool.get(t)}function fa(e,t){return t.unit?e.elementPool.get(t.unit):null}function pa(e){return"key"in e.type?e.type.key:p.j2.Component}function va(e){for(var t=e;null!==(n=t)&&void 0!==n&&n.parent;){var n;if(!ua(t.parent))return t.parent;t=t.parent}return null}function ga(e){for(var t=[],n=[e];n.length;){var r=n.pop();if(ua(r)){if(r.children)for(var i=r.children.length-1;i>=0;i--)n.push(r.children[i])}else t.push(r)}return t}function _a(e){for(var t=[],n=0;n<e.children.length;n++)Array.prototype.push.apply(t,ga(e.children[n]));return t}function ya(e){var t=rs(e);if(null!=t&&t.refPosRo)return t.refPosRo.element;for(var n=e.parent;null!==(r=n)&&void 0!==r&&r.parent;){var r;if(ra(n))return n;n=n.parent}return n}var ma=function(){var e=ct({check:function(e){return ea(e)},initValue:null,scopes:["mutate"]});return function(t){return e(t)}}(),Ea=function(){var e=ct({check:function(e){return ra(e)||!e.parent},initValue:null,scopes:["mutate"]});return function(t){return e(t)}}(),ba=function(){var e=ct({check:function(e){return ea(e)},initValue:null,next:function(e){return ya(e)},scopes:["mutate"]});return function(t){return e(Ea(t))}}(),Ta=nt((function(e,t){return t?function(e,t,n){for(var r=[e];r.length;){for(var i=[],o=0;o<r.length;o++){var a=r[o];if(t(a))return a;for(var s=a.children,u=void 0===s?[]:s,l=0;l<u.length;l++)null!=n&&n(u[l])||i.push(u[l])}r=i}return null}(e,(function(e){return e.key===t})):null}),["mutate"]),Ca=function(e){return!!ba(e)};function Sa(e){return(8&e.status)>0}function wa(e){return(16&e.status)>0}function Ra(e){return(1048576&e.status)>0}function Aa(e){return(2097152&e.status)>0}function Oa(e){return Ra(e)||Aa(e)}function Ma(e){return Sa(e)||wa(e)||Oa(e)}function ka(e){return Sa(e)||wa(e)}function Ia(e){return Jo(e,p.j2.Table)}function xa(e){return!!oa(e)||Ca(e)}function Na(e){return(32&e.status)>0}function Pa(e){if(Sa(e))return!0;if(ua(e))return _a(e).some(Pa);var t=Ba(e);return!(!t||!ys(t))}function La(e){if(Sa(e))return!0;if(ua(e))return _a(e).some(La);var t=Ba(e);return!(t&&!ms(t))}function Da(e){return Ma(e)||Pa(e)}function Fa(e){if(Sa(e))return!0;if(Oa(e))return!0;if(ua(e))return _a(e).some(Fa);var t=Ba(e);return!(!t||!bs(t))}function Ba(e){var t;if(null!==(t=e.renderObjects)&&void 0!==t&&t.length)return e.renderObjects[0].runtime}function Va(e){return e===Ko||Object.getPrototypeOf(e)===Ko&&p.vi.includes(e.key)}function Ha(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];t=t||{};var o=(0,g.f0)({},t),a=e.defaultProps,s=r=r.flat(1/0);0===r.length?s=void 0:1===r.length&&(s=r[0]);var u,l=e;if(e.isRoadsterComponent)if(Va(l)){var c=l.getSideEffects(),h=c.reconcile;u=null==h?void 0:h.renderFunction}else l.getSideEffects();else u=e;var d={_id:0,root:0,type:l,renderFunction:u,style:(0,g.f0)({},t.style),props:(0,g.f0)({},a,o,{children:s}),parent:null,children:r.filter((function(e){return e})),key:t.key,status:8};return d}function Ua(e,t){var n=null==e?void 0:e.type;return t?t===n:void 0!==p.j2[n]}function Za(e,t){var n=null==e?void 0:e.type;return t?t.includes(n):void 0!==p.j2[n]}function Wa(e){return Za(e,p.tB)}function ja(e){return Wa(e)||function(e){return Za(e,p.V0)&&!!e.props.asRelative}(e)}function Ga(e){return Ua(e,p.j2.InlineFlow)}function za(e){return Ua(e,p.j2.Text)}function Ya(e){return Ua(e,p.j2.Fixed)}function Xa(e){return Za(e,p._L)}function Ka(e){return Za(e,p.kz)}function qa(e){return Za(e,p.q8)}function $a(e){return Fe(Ee(e))&&!Wa(e)}function Ja(e){return!!e.width&&!!e.height&&$a(e)}function Qa(e){return Za(e,p.BR)}function es(e,t){return ns(Ta(e,t))}function ts(e){for(var t=e,n=Mi(t);null!==(r=t)&&void 0!==r&&r.parent;){var r;if(t.parent===n&&Dt(t.parent))return t;t=t.parent}}function ns(e){var t;return 1===(null==e||null===(t=e.renderObjects)||void 0===t?void 0:t.length)?e.renderObjects[0]:void 0}function rs(e){var t;return null==e||null===(t=e.renderObjects)||void 0===t?void 0:t[0]}function is(e,t){var n=da(e,t);if(n)return rs(n)}function os(e){return null==e?void 0:e.renderObjects}function as(e){var t=null==e?void 0:e.renderObjects;return null==t?void 0:t[t.length-1]}function ss(e){var t;if(null!==(t=e.renderObjects)&&void 0!==t&&t.length)return e.renderObjects;var n=va(e);if(n){var r=ss(n),i=[];return r.forEach((function(t){var n;null===(n=t.children)||void 0===n||n.forEach((function(t){e&&t.element===e&&i.push(t)}))})),i}return[]}function us(e){var t,n,r={root:(n=e).root,element:n.element,type:n.type,parent:void 0,children:[],style:{},props:(0,g.f0)({},n.props),width:0,height:0,top:0,left:0};ie(r,{width:e.width,height:e.height,left:e.left,top:e.top,style:(0,g.f0)({},e.style),sourceRo:e}),"baseline"in e&&re(r,"baseline",e.baseline),"lineOuterHeight"in e&&re(r,"lineOuterHeight",e.lineOuterHeight),"lineOffsetTop"in e&&re(r,"lineOffsetTop",e.lineOffsetTop),"dir"in e&&re(r,"dir",e.dir),le(r);var i=null===(t=e.element)||void 0===t?void 0:t.renderObjects;if(null!=i&&i.length){var o=i.indexOf(e);i.splice(o+1,0,r)}return r}function ls(e){var t={root:e.root,element:e,type:pa(e),parent:void 0,children:[],props:{sourceStyle:Te(e),selectable:!1!==e.props.selectable,lineWrap:e.props.lineWrap,asRelative:e.props.asRelative},style:{},width:0,height:0,top:0,left:0,selectable:!1!==e.props.selectable};Jo(e,p.j2.Text)?t.props.content=e.props.content:Jo(e,p.j2.InlineFlow)?t.dir=e.props.disableRTL?"none":void 0:Jo(e,p.j2.HalfFullscreen)?(t.props.extraLeft=e.props.extraLeft,t.props.extraRight=e.props.extraRight):Jo(e,p.j2.Drawing)||Jo(e,p.j2.Div)?t.props.draw=e.props.draw:Jo(e,p.j2.Bitmap)&&(t.props.source=e.props.source,t.props.crop=e.props.crop),e.props.dir&&(t.dir=e.props.dir),na(e)&&(t.props.asRelative=!!e.props.asRelative),e.renderObjects||(e.renderObjects=[]),e.renderObjects.push(t);var n=gs(t);return t.runtime=n,t}function cs(e,t,n){e[t]=n}function hs(e,t){(0,g.f0)(e,t)}function ds(e,t,n){t>=e.children.length||(e.children[t]=n)}function fs(e,t){var n=e.renderObjects;if(n){var r=n.indexOf(t);n.splice(r,1)}}function ps(e){var t,n,r=[],i=[e],o=te(e);for(o>-1&&(null===(t=e.parent)||void 0===t||null===(n=t.children)||void 0===n||n.splice(o,1));i.length;){var a=i.pop();r.push(a),re(a,"isDestructed",!0);var s=a.children;if(s)for(var u=s.length-1;u>=0;u--)i.push(s[u])}for(;r.length;){var l=r.pop(),c=l.refPosRo;if(c){var h=c.posRos.indexOf(l);c.posRos.splice(h,1)}var d=l.element;d&&fs(d,l),As(l)}}function vs(e){var t=e.renderObjects;if(null!=t&&t.length){e.renderObjects=[];for(var n=new Array(t.length),r=0;r<t.length;r++){var i=t[r],o=i.parent;if(o&&!i.isDestructed){var a=te(i);a>-1&&ce(o,a),ps(i),n[r]={parent:o,target:i,index:a}}else n[r]=null}return n}}function gs(e){var t={status:1,context:null,constraint:null,isSkipLayout:!1,isComputedStyle:!1,completedLinesCount:void 0,didCallLayout:!1};return e.runtime=t,t}function _s(e){return 0==(5&e.status)}function ys(e){return!_s(e)}function ms(e){return!bs(e)&&!_s(e)}function Es(e){return(1&e.status)>0}function bs(e){return(4&e.status)>0}function Ts(e){return 2==(2|e.status)}function Cs(e){return(32&e.status)>0}function Ss(e,t,n){for(var r=0,i=0;i<t.length;i++)r|=t[i];n?e|=r:e&=4294967295^r;return e}function ws(e){if(!e)return!1;if(0!==e.width||0!==e.height||0!==e.left||0!==e.top)return!0;var t=e.runtime;return!(!t||ms(t))}function Rs(e){return!!e&&(Wa(e),!0)}function As(e){var t,n,r=e.runtime,i=null!==(t=null==r?void 0:r.fragments)&&void 0!==t?t:null==r||null===(n=r.constraint)||void 0===n?void 0:n.fragments;null==i||i.remove(e),e.runtime=void 0}function Os(e){var t=e.runtime;if(t){var n=e.children,r=void 0===n?[]:n,i=2147418112&t.status,o=0;(2&t.status)>0&&(o|=2);for(var a=0,s=0;s<r.length;s++){var u=r[s];if($a(u)){var l=u.runtime;if(l&&(ms(l)?a|=2:_s(l)&&(a|=1),bs(l)&&(a|=4)),3==(3&a)||4==(4&a)){o|=4;break}}}0==(4&o)&&2==(2&a)&&2==(2|a)&&(o=1),(5&t.status)>0&&0==(5&o)&&(o|=2),Ue(t,"status",i|o)}}function Ms(e){Ua(e,p.j2.Text)&&re(e,"dir",void 0)}var ks=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.runtime;n&&(Ze(n,Object.assign({status:3,isComputedStyle:!1},t?{context:null,completedLinesCount:void 0,didCallLayout:!1}:{})),Ua(e,p.j2.InlineFlow)&&re(e,"ellipsisRo",void 0),Is(n)),Ms(e)};function Is(e){Ze(e,{isSkipLayout:!1,didCallLayout:!1})}},vsh_75119:function(e,t,n){"use strict";n.d(t,{e2:function(){return g.e2},eY:function(){return g.eY},MG:function(){return g.MG},wA:function(){return m.wA2},Tj:function(){return f},ZC:function(){return g.ZC},us:function(){return g.us},oZ:function(){return E.o},FP:function(){return a.FP},d:function(){return g.d},gq:function(){return g.gq},hk:function(){return g.hk},xv:function(){return g.xv},az:function(){return m.azq},Vf:function(){return _.Vf},ZP:function(){return b},rP:function(){return v},kE:function(){return h},ah:function(){return g.ah},Gi:function(){return y.Gi},Dx:function(){return g.Dx},m5:function(){return g.m5},r6:function(){return g.r6},ST:function(){return g.ST},Dz:function(){return g.Dz},BC:function(){return y.BC},TK:function(){return g.TK},rj:function(){return y.rj},wW:function(){return g.wW},Ft:function(){return g.Ft},Hi:function(){return d},_i:function(){return l},I5:function(){return g.I5},tE:function(){return m.tEO},I4:function(){return _.I4},d4:function(){return _.d4},sO:function(){return _.sO},eJ:function(){return _.eJ}});var r=n("vsh_67017"),i=n.n(r),o=n("vsh_35067"),a=n("vsh_25098");console;function s(e,t){var n,r=function(){var r=(0,o.Z)(i().mark((function r(o,s){var u,l;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,n){r.next=7;break}return r.next=4,e();case 4:u=r.sent,l=u.usePlugin,n=l;case 7:if(!o.destroyed){r.next=9;break}return r.abrupt("return");case 9:(0,a.mf)(n)&&n(o,s),r.next=15;break;case 12:r.prev=12,r.t0=r.catch(0),console.error("loading ".concat(t," plugin failed!!!"),r.t0);case 15:case"end":return r.stop()}}),r,null,[[0,12]])})));return function(e,t){return r.apply(this,arguments)}}();return r}var u=s((function(){return n.e("vsh_7448").then(n.bind(n,"vsh_7448"))}),"Copy"),l=s((function(){return n.e("vsh_1038").then(n.bind(n,"vsh_71038"))}),"Selection"),c=s((function(){return n.e("vsh_9746").then(n.bind(n,"vsh_59746"))}),"Drag"),h=(s((function(){return n.e("vsh_9161").then(n.bind(n,"vsh_79161"))}),"DOMPainter"),s((function(){return n.e("vsh_9798").then(n.bind(n,"vsh_89798"))}),"RenderOnDemand"),s((function(){return n.e("vsh_819").then(n.bind(n,"vsh_50819"))}),"SSR"),s((function(){return n.e("vsh_8130").then(n.bind(n,"vsh_78130"))}),"Event")),d=s((function(){return n.e("vsh_5593").then(n.bind(n,"vsh_45593"))}),"Scroll"),f=(s((function(){return n.e("vsh_7515").then(n.bind(n,"vsh_67515"))}),"ResizeWithScroller"),s((function(){return n.e("vsh_6768").then(n.bind(n,"vsh_56768"))}),"DPRObserver")),p=s((function(){return n.e("vsh_9674").then(n.bind(n,"vsh_19674"))}),"EmbedDOM"),v=function(){var e=(0,o.Z)(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all([d(t),h(t),l(t),u(t),c(t),f(t),p(t)]);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("loading default plugins failed!!!",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),g=n("vsh_7799"),_=(n("vsh_85684"),n("vsh_6114")),y=(n("vsh_92256"),n("vsh_57506"),n("vsh_36204"),n("vsh_98713")),m=(n("vsh_42410"),n("vsh_83675")),E=(n("vsh_50398"),n("vsh_47928"));n("vsh_96098");var b={createContext:g.kr,createElement:m.azq,createRef:_.Vf,Component:m.wA2}},vsh_23154:function(e,t,n){"use strict";n.d(t,{PgN:function(){return Zt},Eep:function(){return mt},Wb1:function(){return Qt},pfS:function(){return qt},FgM:function(){return He}});var r=n("vsh_26278"),i=n("vsh_12064"),o=n("vsh_22462"),a=n("vsh_93035"),s=n("vsh_73455"),u=n("vsh_74561"),l=n("vsh_1139"),c=n("vsh_67017"),h=n.n(c),d=n("vsh_35067"),f=n("vsh_19264"),p=n("vsh_4175"),v=n("vsh_65498"),g=n("vsh_34859"),_=n("vsh_75119"),y=n("vsh_45110"),m=n("vsh_48096"),E=n("vsh_4268"),b=n("vsh_36569"),T=n("vsh_14795"),C=n("vsh_99568"),S=n("vsh_45832"),w=n("vsh_85351"),R=n("vsh_37075"),A=n("vsh_40285"),O=n("vsh_10014"),M=(n("vsh_93920"),n("vsh_98652")),k=function(e,t,n){var r;return _.az.apply(void 0,[e,Object.assign({},t,{key:n})].concat((0,M.Z)(null!==(r=[t.children].flat(1))&&void 0!==r?r:[])))},I=n("vsh_83927"),x=n("vsh_8458");function N(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var L,D,F=Object.create,B=Object.defineProperty,V=Object.getOwnPropertyDescriptor,H=Object.getOwnPropertyNames,U=Object.getPrototypeOf,Z=Object.prototype.hasOwnProperty,W=(L={"../node_modules/bezier-easing/src/index.js":function(e,t){var n=.1,r="function"==typeof Float32Array;function i(e,t){return 1-3*t+3*e}function o(e,t){return 3*t-6*e}function a(e){return 3*e}function s(e,t,n){return((i(t,n)*e+o(t,n))*e+a(t))*e}function u(e,t,n){return 3*i(t,n)*e*e+2*o(t,n)*e+a(t)}function l(e){return e}t.exports=function(e,t,i,o){if(!(0<=e&&e<=1&&0<=i&&i<=1))throw new Error("bezier x values must be in [0, 1] range");if(e===t&&i===o)return l;for(var a=r?new Float32Array(11):new Array(11),c=0;c<11;++c)a[c]=s(c*n,e,i);function h(t){for(var r=0,o=1;10!==o&&a[o]<=t;++o)r+=n;--o;var l=r+(t-a[o])/(a[o+1]-a[o])*n,c=u(l,e,i);return c>=.001?function(e,t,n,r){for(var i=0;i<4;++i){var o=u(t,n,r);if(0===o)return t;t-=(s(t,n,r)-e)/o}return t}(t,l,e,i):0===c?l:function(e,t,n,r,i){var o,a,u=0;do{(o=s(a=t+(n-t)/2,r,i)-e)>0?n=a:t=a}while(Math.abs(o)>1e-7&&++u<10);return a}(t,r,r+n,e,i)}return function(e){return 0===e?0:1===e?1:s(h(e),t,o)}}}},function(){return D||(0,L[H(L)[0]])((D={exports:{}}).exports,D),D.exports});function j(e){return Array.isArray(e)}function G(e){return"number"==typeof e||"[object Number]"===function(e){return Object.prototype.toString.call(e)}(e)}function z(e){return"object"===(0,v.Z)(e)&&null!==e}function Y(e){return"function"==typeof e}function X(e,t){return!!Object.is(e,t)||(j(e)&&j(t)?function(e,t){var n=e.length;if(n!==t.length)return!1;for(var r=0;r<n;r++)if(!X(e[r],t[r]))return!1;return!0}(e,t):!(!z(e)||!z(t))&&function(e,t){var n=Object.keys(e),r=Object.keys(t),i=n.length;if(i!==r.length)return!1;for(var o=0;o<i;o++){var a=n[o];if(!(a in t)||!X(e[a],t[a]))return!1}return!0}(e,t))}function K(e){return Object.keys(e).map((function(e){return parseFloat(e)})).sort((function(e,t){return e-t}))}function q(e){var t=[];e=j(e)?e:[e];for(var n=0;n<e.length;n++){var r=e[n];r.key||(r=Object.assign({},r,{key:n.toString()})),t.push(r)}return t}function $(e){for(var t={},n=0;n<e.length;n++)t[e[n].key]=e[n];return t}function J(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[],i={},o=Object.keys(e),a=0;a<o.length;a++){var s=o[a];s in t?r.length&&(i[s]=r,r=[]):r.push(s)}for(var u={},l=Object.keys(t),c=0;c<l.length;c++){var h=l[c];if(h in i){for(var d=i[h],f=0;f<d.length;f++){var p=d[f];u[p]=e[p],n[p]="leave"}X(e[h],t[h])||(n[h]="enter")}else n[h]="enter";u[h]=t[h]}for(var v=0;v<r.length;v++){var g=r[v];u[g]=e[g],n[g]="leave"}return u}var Q=["animationState","duration","iterationCount","immediate","pauseWhenOutside","enterMode","leaveMode"];var ee=function(e,t,n){return n=null!=e?F(U(e)):{},function(e,t,n,r){if(t&&"object"===(0,v.Z)(t)||"function"==typeof t){var i,o=N(H(t));try{var a=function(){var o=i.value;Z.call(e,o)||o===n||B(e,o,{get:function(){return t[o]},enumerable:!(r=V(t,o))||r.enumerable})};for(o.s();!(i=o.n()).done;)a()}catch(e){o.e(e)}finally{o.f()}}return e}(!t&&e&&e.__esModule?n:B(n,"default",{value:e,enumerable:!0}),e)}(W());function te(e){return function(t,n,r){var i={};if(!n||!r)return i;for(var o=Object.keys(n),a=0;a<o.length;a++){var s=o[a];s in r&&(i[s]=e(t,s,n[s],r[s]))}return i}}function ne(e){return function(t,n,r,i){return G(r)&&G(i)?r+(i-r)*e(t):r}}var re={linear:(0,ee.default)(0,0,1,1),ease:(0,ee.default)(.25,.1,.25,1),"ease-in":(0,ee.default)(.42,0,1,1),"ease-out":(0,ee.default)(0,0,.58,1),"ease-in-out":(0,ee.default)(.42,0,.58,1)};function ie(e){var t,n=e.initState,r=e.targetState,i=e.easing,o=void 0===i?"linear":i,a=e.initProgress,s=void 0===a?0:a,u=e.targetProgress,l=void 0===u?1:u,c=e.tickStateFn,h=e.tickPropertyFn,d=e.tickProgressFn;t=c||te(h||ne(d||re[o]));var f=l-s,p=function(e){return t((e-s)/f,n,r)};return p.initProgress=s,p.targetProgress=l,p}function oe(e,t){var n,r={transitions:e,keys:t,index:-1,current:void 0,nextProgress:null!==(n=t[0])&&void 0!==n?n:1,reset:function(){return function(e){var t,n=e.keys;e.index=-1,e.current=void 0,e.nextProgress=null!==(t=n[0])&&void 0!==t?t:1}(r)},findTransition:function(e){return function(e,t){for(var n=e.keys,r=n.length-1;r>=0;r--)if(t>=n[r]){var i=e.transitions[r];e.index=r,e.nextProgress=i.targetProgress,e.current=i;break}return e.current}(r,e)},getNextTransition:function(){return function(e){var t=e.index+1;if(t<e.keys.length){var n=e.transitions[t];e.index=t,e.nextProgress=n.targetProgress,e.current=n}return e.current}(r)}};return r}var ae=[function(e,t){var n=t.key,r=t.enterAnimation,i=t.leaveAnimation;if(!r&&!i)return!1;var o={};if(r){var a=ie({tickStateFn:r});o.enter=oe([a],[0])}if(i){var s=ie({tickStateFn:i});o.leave=oe([s],[0])}return e.set(n,o),!0},function(e,t){var n=t.key,r=t.stayAt,i=t.enterKeyframes,o=t.leaveKeyframes;if(!i&&!o)return!1;var a={};if(i){var s=K(i);if(s.length){for(var u=new Array(s.length),l=0;l<s.length;l++)u[l]=ie({initState:i[s[l]],targetState:l+1<s.length?i[s[l+1]]:r,initProgress:s[l],targetProgress:l+1<s.length?s[l+1]:1});a.enter=oe(u,s)}}if(o){var c=K(o);if(c.length){for(var h=new Array(c.length),d=0;d<c.length;d++)h[d]=ie({initState:d>0?o[c[d-1]]:r,targetState:o[c[d]],initProgress:d>0?c[d-1]:0,targetProgress:c[d]});c.pop(),c.unshift(0),a.leave=oe(h,c)}}return e.set(n,a),!0},function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.enterMode,i=n.leaveMode,o=t.key,a=t.stayAt,s=t.enterFrom,u=t.leaveTo,l=t.enterMode,c=void 0===l?r:l,h=t.leaveMode,d=void 0===h?i:h;if(!s&&!u)return!1;var f,p,v,g,_={};return s&&(Y(c)?p=c:f=c,_.enter=oe([ie({initState:s,targetState:a,easing:f,tickProgressFn:p})],[0])),u&&(Y(d)?g=d:v=d,_.leave=oe([ie({initState:a,targetState:u,easing:v,tickProgressFn:g})],[0])),e.set(o,_),!0}];function se(e,t,n){var r,i=N(ae);try{for(i.s();!(r=i.n()).done;){if((0,r.value)(e,t,n))return}}catch(e){i.e(e)}finally{i.f()}}var ue=new Set;function le(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map,n=e.controller,r=e.$context;if(n.isRunning||n.isPaused){var i,o=r.id;if(t.has(o)?i=t.get(o):(i=r.getVisibleArea(),t.set(o,i)),i){var a=(0,_.BC)(e.element),s=a.left,u=a.top,l=a.width,c=a.height,h=e.inVisibleArea;e.inVisibleArea=u<i.height&&u+c>0&&s<i.width&&s+l>0,!h&&e.inVisibleArea&&n.resume(e.props.pauseWhenOutside)}}}function ce(){var e,t=new Map,n=N(ue);try{for(n.s();!(e=n.n()).done;){le(e.value,t)}}catch(e){n.e(e)}finally{n.f()}}function he(e){ue.add(e),e.$context.on(_.FP.SCROLL,ce)}function de(e){ue.delete(e),ue.size||e.$context.off(_.FP.SCROLL,ce)}var fe,pe,ve=1e3,ge=function(){function e(t,n,r){var i=this;(0,f.Z)(this,e),this.execute=window.requestAnimationFrame.bind(window),this.duration=ve,this.iterationCount=1,this.startTime=0,this.usedTime=0,this.pausedTime=0,this.status=0,this.renderNextFrame=function(){i.isRunning&&(i.animation.renderNext(),i.execute(i.renderNextFrame))},this.animation=t,this.runtimeMap=n,r&&this.updateOptions(r)}return(0,p.Z)(e,[{key:"updateOptions",value:function(e){var t=e.execute,n=e.duration,r=void 0===n?ve:n,i=e.iterationCount,o=void 0===i?1:i;t&&(this.execute=t),this.duration=r,this.iterationCount=o}},{key:"hasNextFrame",value:function(){var e=this.duration,t=this.iterationCount;return this.usedTime<e*t}},{key:"getNextFrameState",value:function(e,t){var n,r=this.runtimeMap.get(e);if(r){var i=r[t];if(i){var o=this.startTime,a=this.pausedTime,s=this.duration,u=this.iterationCount;this.usedTime=Date.now()-o-a;var l,c="leave"===t?0:1;return this.usedTime<s*u&&(c=this.usedTime%s/s),(l=c>=i.nextProgress?i.getNextTransition():i.current)||(l=i.findTransition(c)),null===(n=l)||void 0===n?void 0:n(c)}}}},{key:"reset",value:function(e){this.startTime=Date.now(),this.usedTime=0,this.pausedTime=0,this.status=0;var t,n=N(this.runtimeMap);try{for(n.s();!(t=n.n()).done;){var r=(0,l.Z)(t.value,2),i=r[0],o=r[1];if(!e||i in e)for(var a=0,s=Object.values(o);a<s.length;a++){s[a].reset()}}}catch(e){n.e(e)}finally{n.f()}}},{key:"play",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return 0===this.status?(this.startTime=Date.now(),this.usedTime=0,this.pausedTime=0,this.status=1,he(this.animation),void this.execute(this.renderNextFrame)):this.resume(e)}},{key:"pause",value:function(){this.isRunning&&(this.status=2)}},{key:"resume",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isPaused){if(e){var t=this.startTime,n=this.usedTime;this.pausedTime=Date.now()-t-n}this.status=1,this.execute(this.renderNextFrame)}}},{key:"stop",value:function(){(this.isRunning||this.isPaused)&&(this.status=3,de(this.animation))}},{key:"terminate",value:function(){this.status=4,de(this.animation)}},{key:"isRunning",get:function(){return 1===this.status}},{key:"isPaused",get:function(){return 2===this.status}},{key:"isStopped",get:function(){return 3===this.status}},{key:"isTerminated",get:function(){return 4===this.status}}]),e}(),_e=function(e){function t(e){var n;return(0,f.Z)(this,t),(n=(0,i.Z)(this,(0,o.Z)(t).call(this,e))).runtimeMap=new Map,n.controller=new ge((0,a.Z)(n),n.runtimeMap),n.stateMapping=void 0,n.animationTypeMap=void 0,n.firstRender=!0,n.prevChildren=null,n.inVisibleArea=!0,n.renderNext=function(){if(n.inVisibleArea)return n.forceUpdate();n.controller.pause()},n.animationTypeMap={},n.stateMapping=J({},$(q(e.animationState)),n.animationTypeMap),n.updateRuntimeMap(),n.updateController(n.props),n}return(0,s.Z)(t,e),(0,p.Z)(t,[{key:"updateRuntimeMap",value:function(){for(var e=Object.keys(this.animationTypeMap),t=0;t<e.length;t++){var n=e[t];se(this.runtimeMap,this.stateMapping[n],this.props)}}},{key:"updateController",value:function(e){var t=e.duration,n=e.iterationCount;this.controller.updateOptions({duration:t,iterationCount:n}),this.firstRender?(this.firstRender=!1,e.immediate&&this.controller.play()):this.controller.play()}},{key:"computeNextState",value:function(){this.controller.isRunning&&!this.controller.hasNextFrame()&&(this.controller.stop(),this.cleanLeaveStates());for(var e=[],t=Object.keys(this.stateMapping),n=0;n<t.length;n++){var r=t[n],i=r in this.animationTypeMap&&this.controller.getNextFrameState(r,this.animationTypeMap[r])||this.stateMapping[r].stayAt;i&&e.push(i)}return j(this.props.animationState)?e:e[0]}},{key:"cleanLeaveStates",value:function(){for(var e=Object.keys(this.stateMapping),t=0;t<e.length;t++){var n=e[t];"leave"===this.animationTypeMap[n]&&(delete this.animationTypeMap[n],delete this.stateMapping[n],this.runtimeMap.delete(n))}}},{key:"componentDidLayout",value:function(){le(this)}},{key:"componentWillUpdate",value:function(e){(function(e,t){for(var n=0;n<Q.length;n++){var r=Q[n];if(!X(e[r],t[r]))return!1}return!0})(e,this.props)||(this.cleanLeaveStates(),this.animationTypeMap={},this.stateMapping=J(this.stateMapping,$(q(e.animationState)),this.animationTypeMap),this.updateRuntimeMap(),this.controller.reset(this.animationTypeMap),this.updateController(e))}},{key:"render",value:function(){var e=this.props.callback;if(!e)return this.prevChildren;var t=this.computeNextState();return t&&(this.prevChildren=e(t)),this.prevChildren}},{key:"componentWillUnmount",value:function(){this.controller.terminate()}}]),t}(_.wA);fe="defaultProps",pe={duration:ve,iterationCount:1,immediate:!0,pauseWhenOutside:!1,enterMode:"ease",leaveMode:"ease"},function(e,t,n){t in e?B(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(_e,"symbol"!==(0,v.Z)(fe)?fe+"":fe,pe);var ye,me=["ctx","fontColor"],Ee=["type","icon","children","tag","wrapperStyle","iconStyle","tagStyle"],be=["type","avatar","children","wrapperStyle","lineStyle","avatarWrapperStyle","avatarStyle"],Te=["style","children"],Ce=["disabled","icon","style","selected","children"],Se=["value","disabled","label","labelRenderer","children"];function we(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Re(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ae,Oe,Me,ke=Object.defineProperty,Ie=Object.getOwnPropertyNames,xe=function(e,t){return function(){return e&&(t=(0,e[Ie(e)[0]])(e=0)),t}},Ne=function(e,t,n){return function(e,t,n){t in e?ke(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!==(0,v.Z)(t)?t+"":t,n),n},Pe=xe({"../packages/extend-ui/src/resource/loaders/web-image-loader.ts":function(){Ae=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.crossOrigin;return new Promise((function(t,r){var i=new Image;n&&(i.crossOrigin=n),i.onload=function(){return t(i)},i.onerror=r,i.src=e}))}}}),Le={};!function(e,t){for(var n in t)ke(e,n,{get:t[n],enumerable:!0})}(Le,{ResourceManager:function(){return Oe},resourceManager:function(){return Me}});var De=xe({"../packages/extend-ui/src/resource/resource-manager.ts":function(){Pe(),Oe=function(){function e(){(0,f.Z)(this,e),this._loader={},this._caches=new Map,this._pendingMap=new Map}var t;return(0,p.Z)(e,[{key:"registerLoader",value:function(e,t){this._loader[e]=t}},{key:"has",value:function(e){return this._caches.has(e)}},{key:"_addResource",value:function(e,t){var n={refCount:0,data:t};return this._caches.set(e,n),n}},{key:"getRef",value:(t=(0,d.Z)(h().mark((function e(t,n,r){var i,o,a,s;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this._caches,o=i.get(n)){e.next=6;break}return e.next=5,null!==(a=this._pendingMap.get(n))&&void 0!==a?a:this._load(t,n,r);case 5:o=e.sent;case 6:return s=!1,o.refCount++,e.abrupt("return",{get:function(){return o.data},dispose:function(){s||(o.refCount--,s=!0,o.refCount<=0&&i.delete(n))}});case 9:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"_load",value:function(e,t,n){var r=this,i=(0,this._loader[e])(t,n).then((function(e){return r._addResource(t,e)}));return this._pendingMap.set(t,i),i}}]),e}(),(Me=new Oe).registerLoader("image",Ae)}}),Fe={"--B100":"#e1eaff","--B200":"#bacefd","--B300":"#82a7fc","--B400":"#4e83fd","--B500":"#3370ff","--B600":"#245bdb","--B700":"#1c4cba","--G500":"#34c724","--N00":"#ffffff","--N00-10":"rgba(255, 255, 255, 0.1)","--N00-20":"rgba(255, 255, 255, 0.2)","--N00-40":"rgba(255, 255, 255, 0.4)","--N00-50":"rgba(255, 255, 255, 0.5)","--N00-60":"rgba(255, 255, 255, 0.6)","--N00-80":"rgba(255, 255, 255, 0.8)","--N00-90":"rgba(255, 255, 255, 0.9)","--N100":"#f2f3f5","--N200":"#eff0f1","--N300":"#dee0e3","--N400":"#bbbfc4","--N50":"#f5f6f7","--N500":"#8f959e","--N800":"#2b2f36","--N900":"#1f2329","--N900-10":"rgba(31, 35, 41, 0.1)","--N900-20":"rgba(31, 35, 41, 0.2)","--N900-30":"rgba(31, 35, 41, 0.3)","--N900-60":"rgba(31, 35, 41, 0.6)","--R100":"#fde2e2","--R200":"#fbbfbc","--R300":"#f98e8b","--R400":"#f76964","--R500":"#f54a45","--R600":"#d83931","--bg-body-overlay":"rgb(245, 246, 247)","--bg-float":"rgb(255, 255, 255)","--fill-hover":"rgba(31, 35, 41, 0.08)","--function-danger-500":"rgb(245, 74, 69)","--function-info-400":"rgb(78, 131, 253)","--function-info-500":"rgb(51, 112, 255)","--function-info-600":"rgb(36, 91, 219)","--icon-disabled":"rgb(187, 191, 196)","--icon-n2":"rgb(100, 106, 115)","--line-border-card":"rgb(222, 224, 227)","--line-border-component":"rgb(208, 211, 214)","--primary-pri-100":"rgb(225, 234, 255)","--primary-pri-200":"rgb(186, 206, 253)","--primary-pri-300":"rgb(130, 167, 252)","--primary-pri-400":"rgb(78, 131, 253)","--primary-pri-500":"rgb(51, 112, 255)","--primary-pri-600":"rgb(36, 91, 219)","--shadow-s4-down":"0px 8px 24px 8px rgba(31, 35, 41, 0.04), 0px 6px 12px 0px rgba(31, 35, 41, 0.04), 0px 4px 8px -8px rgba(31, 35, 41, 0.06)","--static-white":"rgb(255, 255, 255)","--text-caption":"rgb(100, 106, 115)","--text-disabled":"rgb(187, 191, 196)","--text-link-hover":"rgb(51, 112, 255)","--text-link-normal":"rgb(36, 91, 219)","--text-link-pressed":"rgb(28, 76, 186)","--text-placeholder":"rgb(143, 149, 158)","--text-title":"rgb(31, 35, 41)","--udtoken-btn-text-bg-neutral-focus":"rgba(31, 35, 41, 0.1)","--udtoken-btn-text-bg-neutral-hover":"rgba(31, 35, 41, 0.1)","--udtoken-btn-text-bg-neutral-pressed":"rgba(31, 35, 41, 0.2)","--udtoken-btn-text-bg-pri-focus":"rgba(51, 112, 255, 0.1)","--udtoken-btn-text-bg-pri-hover":"rgba(51, 112, 255, 0.1)","--udtoken-btn-text-bg-pri-pressed":"rgba(51, 112, 255, 0.2)","--udtoken-component-outlined-bg":"#ffffff","--udtoken-component-text-disabled-loading":"#8f959e","--udtoken-input-bg-disabled":"#eff0f1","--udtoken-tag-bg-blue":"rgba(51, 112, 255, 0.2)","--udtoken-tag-neutral-bg-normal":"rgba(31, 35, 41, 0.1)","--udtoken-tag-neutral-bg-normal-hover":"rgba(31, 35, 41, 0.15)","--udtoken-tag-neutral-text-normal":"#646a73","--udtoken-tag-text-s-blue":"#245bdb","--N50-50":"#f5f6f780","--N50-40":"#f5f6f766","--R500-10":"#f54a451a","--R500-20":"#f54a4533","--R500-60":"#f54a4599","--R500-50":"#f54a4580","--B500-10":"#3370ff1a","--B500-20":"#3370ff33"},Be={"--B100":"#192a4c","--B200":"#203e78","--B300":"#2851a3","--B400":"#2e65d1","--B500":"#4c88ff","--B600":"#70a0ff","--B700":"#99bbff","--G500":"#54c248","--N00":"#0a0a0a","--N00-10":"rgba(10, 10, 10, 0.1)","--N00-20":"rgba(10, 10, 10, 0.2)","--N00-40":"rgba(10, 10, 10, 0.4)","--N00-50":"rgba(10, 10, 10, 0.5)","--N00-60":"rgba(10, 10, 10, 0.6)","--N00-80":"rgba(10, 10, 10, 0.8)","--N00-90":"rgba(10, 10, 10, 0.9)","--N100":"#292929","--N200":"#373737","--N300":"#434343","--N400":"#5f5f5f","--N50":"#1a1a1a","--N500":"#757575","--N800":"#e8e8e8","--N900":"#ebebeb","--N900-10":"rgba(235, 235, 235, 0.1)","--N900-20":"rgba(235, 235, 235, 0.2)","--N900-30":"rgba(235, 235, 235, 0.3)","--N900-60":"rgba(235, 235, 235, 0.6)","--R100":"#4a1d1b","--R200":"#6b2827","--R300":"#9e3836","--R400":"#cc4743","--R500":"#f05b56","--R600":"#fa7873","--bg-body-overlay":"rgb(41, 41, 41)","--bg-float":"rgb(41, 41, 41)","--fill-hover":"rgba(235, 235, 235, 0.08)","--function-danger-500":"rgb(240, 91, 86)","--function-info-400":"rgb(46, 101, 209)","--function-info-500":"rgb(76, 136, 255)","--function-info-600":"rgb(112, 160, 255)","--icon-disabled":"rgb(95, 95, 95)","--icon-n2":"rgb(166, 166, 166)","--line-border-card":"rgba(235, 235, 235, 0.15)","--line-border-component":"rgb(80, 80, 80)","--primary-pri-100":"rgb(25, 42, 76)","--primary-pri-200":"rgb(32, 62, 120)","--primary-pri-300":"rgb(40, 81, 163)","--primary-pri-400":"rgb(46, 101, 209)","--primary-pri-500":"rgb(76, 136, 255)","--primary-pri-600":"rgb(112, 160, 255)","--shadow-s4-down":"0px 8px 24px 8px rgba(0, 0, 0, 0.04), 0px 6px 12px 0px rgba(0, 0, 0, 0.04), 0px 4px 8px -8px rgba(0, 0, 0, 0.06)","--static-white":"rgb(255, 255, 255)","--text-caption":"rgb(166, 166, 166)","--text-disabled":"rgb(95, 95, 95)","--text-link-hover":"rgb(76, 136, 255)","--text-link-normal":"rgb(112, 160, 255)","--text-link-pressed":"rgb(153, 187, 255)","--text-placeholder":"rgb(117, 117, 117)","--text-title":"rgb(235, 235, 235)","--udtoken-btn-text-bg-neutral-focus":"rgba(235, 235, 235, 0.1)","--udtoken-btn-text-bg-neutral-hover":"rgba(235, 235, 235, 0.1)","--udtoken-btn-text-bg-neutral-pressed":"rgba(235, 235, 235, 0.2)","--udtoken-btn-text-bg-pri-focus":"rgba(76, 136, 255, 0.2)","--udtoken-btn-text-bg-pri-hover":"rgba(76, 136, 255, 0.2)","--udtoken-btn-text-bg-pri-pressed":"rgba(76, 136, 255, 0.3)","--udtoken-component-outlined-bg":"rgba(10, 10, 10, 0)","--udtoken-component-text-disabled-loading":"#757575","--udtoken-input-bg-disabled":"rgba(235, 235, 235, 0.12)","--udtoken-tag-bg-blue":"rgba(76, 136, 255, 0.2)","--udtoken-tag-neutral-bg-normal":"rgba(166, 166, 166, 0.2)","--udtoken-tag-neutral-bg-normal-hover":"rgba(235, 235, 235, 0.3)","--udtoken-tag-neutral-text-normal":"#a6a6a6","--udtoken-tag-text-s-blue":"#99bbff","--N50-50":"#1a1a1a80","--N50-40":"#1a1a1a66","--R500-10":"#f05b561a","--R500-20":"#f05b5633","--R500-60":"#f05b5699","--R500-50":"#f05b5680","--B500-10":"#4c88ff1a","--B500-20":"#4c88ff33"},Ve="LIGHT";function He(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ve,n=new Map([["LIGHT",Fe],["DARK",Be]]),r=t,i={setTheme:function(t){var i=n.get(t);return i&&(e.setColorToken(i),r=t),this},registerTheme:function(e,t){return n.set(e,t),this},unregisterTheme:function(e){return n.delete(e),this},getTheme:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r;return n.get(e)},addToken:function(e,t,n){var r=this.getTheme(n);return r&&(r[e]=t),this},removeToken:function(e,t){var n=this.getTheme(t);return n&&delete n[e],this},getToken:function(e,t){var n=this.getTheme(t);return null==n?void 0:n[e]}};return i.setTheme(r),i}var Ue=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){return t?(Array.isArray(t)?t[0]&&Object.assign(e,t[1]):"function"==typeof t?Object.assign(e,t()):"object"===(0,v.Z)(t)&&Object.assign(e,t),e):e}),{})};function Ze(){}function We(e){return Object.prototype.toString.call(e)}function je(e){return Array.isArray(e)}function Ge(e){return"string"==typeof e||"[object String]"===We(e)}function ze(e){return"object"===(0,v.Z)(e)&&null!==e}function Ye(e){return"function"==typeof e}function Xe(e,t){return je(e)&&je(t)?function(e,t){var n=e.length;if(n!==t.length)return!1;for(var r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}(e,t):!(!ze(e)||!ze(t))&&function(e,t){var n=Object.keys(e),r=Object.keys(t),i=n.length;if(i!==r.length)return!1;for(var o=0;o<i;o++){var a=n[o];if(!(a in t)||e[a]!==t[a])return!1}return!0}(e,t)}var Ke=Object.assign;var qe=/^\s*data:(.*?)(;base64)?,(.+)\s*$/;var $e=["element","dragView","dragWrapperStyle","on","key","selectable","children","ref","style","lineWrap","className","asOneChar","asDumpChunk","provides","asRelative","$context","dir"];function Je(e){return function(e,t){for(var n=Object.assign({},e),r=t.length,i=0;i<r;i++)delete n[t[i]];return n}(e,$e)}function Qe(e,t){return function(e,t){for(var n={},r=t.length,i=0;i<r;i++){var o=t[i];o in e&&(n[o]=e[o]),delete e[o]}return n}(e,t)}function et(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t[n];if(Ye(o)){if(Ge(n)&&n.startsWith("on")){var a=n.toLowerCase();e[a]!==o&&(e[a]=o)}}else{var s=null==o||null===o.toString||void 0===r?void 0:r.call(o);null!=s&&(e.getAttribute(i)!==s&&e.setAttribute(i,s),delete t[n])}}function tt(e,t,n){var r=Object.assign({},t);n&&Object.entries(n).forEach((function(t){var n=(0,l.Z)(t,2),i=n[0],o=n[1];return et(e,r,i,o)})),Object.keys(r).forEach((function(t){return et(e,r,t)}))}function nt(e,t){Object.keys(t).forEach((function(n){return e.style[n]=t[n]}))}var rt=(ye={},(0,u.Z)(ye,y.h.ContentState,m.M),(0,u.Z)(ye,y.h.Range,E.e),(0,u.Z)(ye,y.h.ZoneState,b.i),(0,u.Z)(ye,y.h.UndoModule,T.j0),(0,u.Z)(ye,y.h.InputModel,C.g),ye),it=function(e){function t(e){var n,r;return(0,f.Z)(this,t),(r=(0,i.Z)(this,(0,o.Z)(t).call(this,e))).editor=void 0,r._initData=void 0,r._isCompositing=!1,r.isFirstLayout=!0,r._onEditorContentChange=r._onEditorContentChange.bind((0,a.Z)(r)),r._onEditorCompositionStart=r._onEditorCompositionStart.bind((0,a.Z)(r)),r._onEditorCompositionEnd=r._onEditorCompositionEnd.bind((0,a.Z)(r)),r._onEditorKeyPress=r._onEditorKeyPress.bind((0,a.Z)(r)),r._onEditorBlur=r._onEditorBlur.bind((0,a.Z)(r)),r._onEditorFocus=r._onEditorFocus.bind((0,a.Z)(r)),r._initData=new R.D({0:new A.I({zoneId:"0",ops:[{insert:r._getViewValue(null!==(n=r.props.value)&&void 0!==n?n:r.props.defaultValue),attributes:r.props.defaultAttribs}]})}),r}return(0,s.Z)(t,e),(0,p.Z)(t,[{key:"shouldComponentUpdate",value:function(e){return!Xe(Je(this.props),Je(e))}},{key:"componentDidLayout",value:function(){this.isFirstLayout&&(this.isFirstLayout=!1,this.props.autoFocus&&this.editor.focus())}},{key:"componentDidUpdate",value:function(e){this.props.value!==e.value&&this._updateContent(this._getViewValue(this.props.value))}},{key:"componentWillUnmount",value:function(){this.editor.off(S.r.CONTENT_CHANGE,this._onEditorContentChange),this.editor.off(S.r.FOCUS,this._onEditorFocus),this.editor.off(S.r.BLUR,this._onEditorBlur),this.editor.off(S.r.KEYPRESS,this._onEditorKeyPress),this.editor.off(S.r.COMPOSITION_START,this._onEditorCompositionStart),this.editor.off(S.r.COMPOSITION_END,this._onEditorCompositionEnd)}},{key:"_getModelValue",value:function(e){var t,n=(t=e)?t.replace(/\n*$/,""):void 0;return this.props.parser&&(n=this.props.parser(n)),n}},{key:"_getViewValue",value:function(e){var t,n,r=e;return this.props.formatter&&(r=this.props.formatter(e)),(t=null!==(n=t=r)&&void 0!==n?n:"").endsWith("\n")?t=t.replace(/\n+$/,"\n"):t+="\n",r=t}},{key:"_updateContent",value:function(e){var t,n=this.editor.getContentState(),r=n.getActiveZone(),i=(new A.I).delete(r.getModelText().length-1),o=(new A.I).insert((null!==(t=e)&&void 0!==t?t:"").replace(/\n*$/,""));n.apply(i.compose(o))}},{key:"_onEditorContentChange",value:function(e){if(this.props.onChange){var t=e.current.getActiveZone().getModelText(),n=this._getModelValue(t);this.props.onChange(e,n)}}},{key:"_onEditorCompositionStart",value:function(){this._isCompositing=!0}},{key:"_onEditorCompositionEnd",value:function(){this._isCompositing=!1}},{key:"_onEditorKeyPress",value:function(e){this._isCompositing||this.props.onPressEnter&&"Enter"===e.key&&this.props.onPressEnter(e)}},{key:"_onEditorFocus",value:function(e){this.props.onFocus&&this.props.onFocus(e)}},{key:"_onEditorBlur",value:function(){this.props.onBlur&&this.props.onBlur()}},{key:"_onEditorInit",value:function(e){var t,n;this.editor=e,this.editor.on(S.r.CONTENT_CHANGE,this._onEditorContentChange),this.editor.on(S.r.FOCUS,this._onEditorFocus),this.editor.on(S.r.BLUR,this._onEditorBlur),this.editor.on(S.r.KEYPRESS,this._onEditorKeyPress),this.editor.on(S.r.COMPOSITION_START,this._onEditorCompositionStart),this.editor.on(S.r.COMPOSITION_END,this._onEditorCompositionEnd),null===(t=(n=this.props).onInit)||void 0===t||t.call(n,this.editor)}},{key:"render",value:function(){var e=this.props,t=e.placeholder,n=e.readOnly,r=e.disabled,i=e.isInline;return k(O.P,{cursorColor:"black",businessKey:"roadster_ui_input",scroller:this.$context.container,style:{minWidth:"100%"},isInline:i,editable:!n&&!r,copyable:!r,selectable:!r,placeholder:t,initData:this._initData,onInit:this._onEditorInit.bind(this),modules:rt,onError:this.props.onError,listenEvents:w.Cn,register:this.props.register,schema:this.props.schema})}}]),t}(_.ZC),ot=(_.ZC,"".concat(4,"px 8px ").concat(4,"px 11px"),"".concat(22,"px"),"".concat(1,"px"),function(e){function t(){return(0,f.Z)(this,t),(0,i.Z)(this,(0,o.Z)(t).apply(this,arguments))}return(0,s.Z)(t,e),(0,p.Z)(t,[{key:"match",value:function(e){return e===t.key}},{key:"_editorLineStateWillRender",value:function(e){var t,n=we(e.lineState);try{for(n.s();!(t=n.n()).done;){var r,i=t.value;null!==(r=i.insert)&&void 0!==r&&r.length&&(i.insert="•".repeat(Math.max(i.insert.length-1,0))+"\n")}}catch(e){n.e(e)}finally{n.f()}}}]),t}(I.S)),at=ot;Ne(at,"key","password");new g.V({password:{mark:!0}});var st={};var ut={borderColor:"--N400",backgroundColor:"--N400",$hover:{},$active:{},$focus:{}},lt={fontColor:"--N400",borderColor:"--N400",$hover:{},$active:{},$focus:{}},ct={primary:{filled:{normal:{fontColor:"--N00",backgroundColor:"--B500",borderColor:"--B500",$hover:{backgroundColor:"--B400",borderColor:"--B400"},$active:{backgroundColor:"--B600",borderColor:"--B600"},$focus:{backgroundColor:"--B400",borderColor:"--B400"}},loading:{borderColor:"--B300",backgroundColor:"--B300",$hover:{},$active:{},$focus:{}},disabled:ut},outlined:{normal:{fontColor:"--B500",borderColor:"--B500",backgroundColor:"--N00",$hover:{backgroundColor:"--B100"},$active:{backgroundColor:"--B200"},$focus:{backgroundColor:"--B100"}},loading:{fontColor:"--B300",borderColor:"--B300",$hover:{},$active:{},$focus:{}},disabled:lt}},default:{filled:{normal:{},loading:{},disabled:{}},outlined:{normal:{fontColor:"--N900",borderColor:"--N400",backgroundColor:"--N00",$hover:{backgroundColor:"--N100"},$active:{backgroundColor:"--N200"},$focus:{backgroundColor:"--N100"}},loading:{fontColor:"--N500",$hover:{},$active:{},$focus:{}},disabled:lt}},danger:{filled:{normal:{fontColor:"--N00",backgroundColor:"--R500",borderColor:"--R500",$hover:{backgroundColor:"--R400",borderColor:"--R400"},$active:{backgroundColor:"--R600",borderColor:"--R600"},$focus:{backgroundColor:"--R400",borderColor:"--R400"}},loading:{borderColor:"--R300",backgroundColor:"--R300",$hover:{},$active:{},$focus:{}},disabled:ut},outlined:{normal:{fontColor:"--R500",borderColor:"--R500",backgroundColor:"--N00",$hover:{backgroundColor:"--R100"},$active:{backgroundColor:"--R200"},$focus:{backgroundColor:"--R100"}},loading:{fontColor:"--R300",borderColor:"--R300",$hover:{},$active:{},$focus:{}},disabled:lt}}};var ht=ct.primary.filled.normal,dt=ct.danger.filled.normal,ft={borderColor:"--N300",backgroundColor:"--N00"};Object.assign({},st,{},ft,{fontColor:"--N800",$hover:{fontColor:"--B500"},$active:{fontColor:"--B600"},$focus:{fontColor:"--B500"}}),Object.assign({},st,{},ft,{fontColor:"--N800",$hover:{fontColor:"--R500"},$active:{fontColor:"--R600"},$focus:{fontColor:"--R500"}});var pt={borderColor:"--N900-10",backgroundColor:"--N900-10"};Object.assign({},pt,{fontColor:"--N800",$hover:{fontColor:"--B500"},$active:{fontColor:"--B600"},$focus:{fontColor:"--B500"}}),Object.assign({},pt,{fontColor:"--N800",$hover:{fontColor:"--R500"},$active:{fontColor:"--R600"},$focus:{fontColor:"--R500"}});var vt,gt=["domRef","fit","position","width","height","onLoad","onError","style","wrapperStyle","imgStyle"],_t=function(){var e=document.createElement("div"),t=e.style;return e.innerHTML='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M9.9 11.76 7.226 9.117a.757.757 0 0 0-1.073 0L3 12.277V4.5h11.09l.282-.48.878-1.52H3c-1.1 0-2 .9-2 2v15c0 1.1.9 2 2 2h1.28l5.62-9.74Zm10.065-4.32c0 1.05-.848 1.9-1.896 1.9a1.898 1.898 0 0 1-1.897-1.9 1.898 1.898 0 1 1 3.793 0Z" fill="#2B2F36"/>\n  <path d="M18.33 2.5H21c1.1 0 2 .9 2 2v15c0 1.1-.9 2-2 2H7.35l4.51-7.81 2.795 2.87 3.257-3.263a.757.757 0 0 1 1.073 0l1.249 1.252.766.781V4.5h-3.83l.28-.48.88-1.52Z" fill="#2B2F36"/>\n</svg>\n',t.width="100%",t.height="100%",t.display="flex",t.justifyContent="center",t.alignItems="center",e}(),yt=(_.ZC,function(){var e=(0,d.Z)(h().mark((function e(t,n){var r,i,o=arguments;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=o.length>2&&void 0!==o[2]?o[2]:{},vt){e.next=6;break}return e.next=4,Promise.resolve().then((function(){return De(),Le}));case 4:i=e.sent,vt=i.resourceManager;case 6:return e.abrupt("return",vt.getRef(t,n,r));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),mt=function(e){var t=e.src,n=e.fit,r=e.position,i=e.crop,o=e.crossOrigin,a=e.width,s=e.height,u=e.imgStyle,c=e.onLoad,f=e.onError,p=(0,_.sO)(0),v=(0,_.sO)(void 0),g=(0,_.sO)(void 0),y=(0,_.eJ)(void 0),m=(0,l.Z)(y,2),E=m[0],b=m[1],T=(0,_.I4)((function(e){p.current=e}),[]),C=(0,_.I4)(function(){var e=(0,d.Z)(h().mark((function e(t){var n,r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(p.current>=1)){e.next=2;break}return e.abrupt("return");case 2:return T(1),e.prev=3,e.next=6,yt("image",t,{crossOrigin:o});case 6:n=e.sent,r=n.get(),g.current=n,v.current=t,b(r),null==c||c(r),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),null==f||f(e.t0),T(3);case 18:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(t){return e.apply(this,arguments)}}(),[T,f,c]),S=(0,_.I4)((function(){var e;null===(e=g.current)||void 0===e||e.dispose(),g.current=void 0,T(0),b(void 0),v.current=void 0}),[T]);return(0,_.d4)((function(){return t&&C(t),S}),[t,C,S]),k(_.eY,{crop:i,source:E,style:Ke({width:a,height:s,fit:n,position:r},u,{baselineOffset:"-0.14em"})})};var Et={strokeWidth:"stroke-width",strokeDasharray:"stroke-dasharray",strokeDashoffset:"stroke-dashoffset",strokeLinecap:"stroke-linecap",strokeLinejoin:"stroke-linejoin",strokeMiterlimit:"stroke-miterlimit",fillRule:"fill-rule",clipRule:"clip-rule"},bt=["domRef","src","svgStyle","color","onLoad","onError"];function Tt(e){var t,n=new DOMParser,r=null!==function(e){var t=qe.exec(e);if(t){var n=(0,l.Z)(t,4);return{mediaType:n[1],base64:!!n[2],data:n[3]}}return null}(e)&&void 0!==t?t:{},i=r.base64,o=r.data,a=void 0===o?"":o;return i&&window.atob(a),n.parseFromString(e,"image/svg+xml")}_.ZC;var Ct=function(e,t){return e&&"currentcolor"===e.toLowerCase()?t:e};function St(e,t,n){var r,i,o,a,s,u,c=n.fill,h=n.stroke,d=n.strokeWidth,f=n.fillRule,p=n.clipRule,v=n.color,g=n.strokeDasharray,_=n.strokeDashoffset,y=n.strokeLinecap,m=n.strokeLinejoin,E=n.strokeMiterlimit;e.save();var b=t.attributes;if(e.fillStyle=null!==(r=null!==(i=null!==(o=v)&&void 0!==o?o:c)&&void 0!==i?i:Ct(b.fill,v))&&void 0!==r?r:e.fillStyle,t.attributes["fill-opacity"]&&(e.globalAlpha=Number(b["fill-opacity"])),y&&(e.lineCap=y),m&&(e.lineJoin=m),E&&(e.miterLimit=E),g&&e.setLineDash(g),_&&(e.lineDashOffset=_),e.strokeStyle=h||(null!==(a=Ct(b.stroke,v))&&void 0!==a?a:e.strokeStyle),e.lineWidth=null!==(s=null!==(u=d)&&void 0!==u?u:b["stroke-width"]?parseFloat(b["stroke-width"]):void 0)&&void 0!==s?s:e.lineWidth,"path"===t.name){var T=t.attributes.d;if(T){var C,S,w,R,A,O,M=new Path2D(T);(h||b.stroke)&&e.stroke(M);var k=null!==(C=null===(S=t.attributes.bounds)||void 0===S?void 0:S.split(" "))&&void 0!==C?C:[],I=(0,l.Z)(k,2),x=I[0],N=I[1];e.translate(Number(null!==(w=x)&&void 0!==w?w:0),Number(null!==(R=N)&&void 0!==R?R:0)),e.fill(M,null!==(A=f)&&void 0!==A?A:b["fill-rule"]);var P=null!==(O=p)&&void 0!==O?O:b["clip-rule"];P&&e.clip(M,P)}}t.children.forEach((function(t){return St(e,t,n)})),e.restore()}function wt(e,t,n,r){var i=t.left,o=t.top,a=t.width,s=t.height;e.save(),e.fillStyle="transparent",e.translate(i,o);var u=n.attributes,c=u.width,h=u.height,d=u.viewBox,f=!1;if(c&&h){var p;e.save();var v=function(e){return e.split(/\s+|,/).map(Number)}(null!==(p=d)&&void 0!==p?p:""),g=(0,l.Z)(v,4),_=g[0],y=g[1],m=g[2],E=g[3],b=Number(c),T=Number(h);isNaN(m)||isNaN(E)||(b=m,T=E);var C=Math.min(a,s)/Math.max(b,T);isNaN(_)||isNaN(y)||e.translate(-_*C,-y*C),e.scale(C,C),f=!0}St(e,n,r),f&&e.restore(),e.restore()}var Rt=function(e){var t=e.src,n=e.width,i=e.height,o=e.svgStyle,a=e.selectable,s=Object.assign({width:n,height:i},o);if(t&&!Ge(t)){var u=t.attributes;s.width||(s.width=u.width),s.height||(s.height=u.height)}return k(_.us,{draw:function(e){var n,i=e.ctx,o=e.fontColor,a=(0,r.Z)(e,me),s=Ke({color:null!==(n=o)&&void 0!==n?n:"rgb(0, 0, 0)"});Ge(t)?function(e,t,n,r){var i,o=r.fillRule,a=r.stroke,s=r.strokeWidth,u=r.fill,l=r.color,c=r.strokeLinecap,h=r.strokeLinejoin,d=r.strokeMiterlimit,f=r.strokeDasharray,p=r.strokeDashoffset,v=new Path2D(n);e.save(),e.translate(t.left,t.top),u&&(e.fillStyle=null!==(i=l)&&void 0!==i?i:Ct(u,l),e.fill(v,o)),a&&s&&(c&&(e.lineCap=c),h&&(e.lineJoin=h),d&&(e.miterLimit=d),f&&e.setLineDash(f),p&&(e.lineDashOffset=p),e.strokeStyle=Ct(a,l),e.lineWidth=s,e.stroke(v)),e.restore()}(i,a,t,s):wt(i,a,t,s)},style:s,selectable:a})},At=["domRef","onLoad","onError"],Ot=(_.ZC,{minWidth:"auto",width:"150px",borderRadius:"6px",fontSize:"14px",fontColor:"--text-title",lineHeight:1.5715}),Mt=("calc(100% - ".concat(32,"px)"),"calc(100% - ".concat(32,"px)"),{height:"100%",width:"1px",backgroundColor:"--line-border-component"}),kt={fontColor:"--icon-n2",border:"1px solid ".concat("rgba(255, 255, 255, 0)"),cursor:"pointer",$hover:{backgroundColor:"--udtoken-btn-text-bg-pri-hover",borderColor:"--primary-pri-500",fontColor:"--primary-pri-500"}},It=(Object.assign({},kt,{height:"calc(50% + 1.5px)",borderRightWidth:0,borderTopWidth:0,borderTopRightRadius:"6px"}),Object.assign({},kt,{borderRightWidth:0,borderBottomWidth:0,borderBottomRightRadius:"6px"}),40),xt=(Object.assign({},Ot,{$hover:{}}),Object.assign({},Mt,{marginLeft:"calc(100% - ".concat(32,"px)")}),Object.assign({},Mt,{marginLeft:"".concat(39.5,"px")}),Object.assign({},Mt,{marginLeft:"calc(100% - ".concat(It,"px)")}),"calc(100% - ".concat(80,"px)"),"calc(100% - ".concat(80,"px)"),"".concat(It,"px"),{border:"1px solid --line-border-component",height:"100%",width:It,fontColor:"--icon-n2",$hover:{backgroundColor:"--udtoken-btn-text-bg-pri-hover",borderColor:"--primary-pri-500",fontColor:"--primary-pri-500"}}),Nt={backgroundColor:"--udtoken-input-bg-disabled",cursor:"not-allowed",borderColor:"--line-border-component",$hover:{}},Pt=(Object.assign({},Nt,{fontColor:"--line-border-component"}),Object.assign({},xt,{marginLeft:"calc(100% - ".concat(It,"px)"),borderTopRightRadius:"6px",borderBottomRightRadius:"6px",borderLeftColor:"rgba(255, 255, 255, 0)",cursor:"pointer"}),Object.assign({},xt,{borderTopLeftRadius:"6px",borderBottomLeftRadius:"6px",borderRightColor:"rgba(255, 255, 255, 0)",cursor:"pointer"}),function(e){function t(){return(0,f.Z)(this,t),(0,i.Z)(this,(0,o.Z)(t).apply(this,arguments))}return(0,s.Z)(t,e),(0,p.Z)(t,[{key:"match",value:function(e){return e===t.key}},{key:"editorWillApplyChange",value:function(e){var t=e.deltaSet;return t.forEach((function(e){e.zoneType===x.Ak.Content&&e.forEach((function(e){e.insert&&"string"==typeof e.insert&&(e.insert=function(e,t){for(var n=null,r="";null!==(n=t.exec(e));)r+=n[0];return r}(e.insert,/[0-9]|\.|-/g))}))})),t}}]),t}(I.S)),Lt=Pt;Ne(Lt,"key","onlyNumber");new g.V({onlyNumber:{mark:!0}});var Dt={borderRadius:"4px",cursor:"pointer"},Ft={margin:"0 2px"},Bt={width:"1em"},Vt={padding:"2px 4px 0px 4px",height:"calc(1em + 2px)"},Ht={fontSize:"0.7em"},Ut={readable:{wrapper:{fontColor:"--text-link-normal",$hover:{backgroundColor:"--udtoken-btn-text-bg-pri-hover"},$active:{backgroundColor:"--udtoken-btn-text-bg-pri-pressed"},$focus:{backgroundColor:"--udtoken-btn-text-bg-pri-focus"}},tagWrapper:{fontColor:"--udtoken-tag-text-s-blue",backgroundColor:"--udtoken-tag-bg-blue"}},unreadable:{wrapper:{fontColor:"--text-caption",$hover:{backgroundColor:"--udtoken-btn-text-bg-neutral-hover"},$active:{backgroundColor:"--udtoken-btn-text-bg-neutral-pressed"},$focus:{backgroundColor:"--udtoken-btn-text-bg-neutral-focus"}},tagWrapper:{fontColor:"--udtoken-tag-neutral-text-normal",backgroundColor:"--udtoken-tag-neutral-bg-normal"}}};function Zt(e){var t=e.type,n=void 0===t?"readable":t,i=e.icon,o=e.children,a=e.tag,s=e.wrapperStyle,u=void 0===s?{}:s,l=e.iconStyle,c=void 0===l?{}:l,h=e.tagStyle,d=void 0===h?{}:h,f=(0,r.Z)(e,Ee),p=function(e){var t=e.type,n=e.wrapperStyle,r=e.iconStyle,i=e.tagStyle,o=Ut[t],a=o.wrapper,s=o.tagWrapper;return{wrapper:Object.assign({},Dt,a,n),iconWrapper:Object.assign({},Ft,Bt,r),childrenWrapper:Object.assign({},Ft),tagWrapper:Object.assign({},Ft,Vt,s,i),tagInner:Object.assign({},Ht)}}({type:n,wrapperStyle:u,iconStyle:c,tagStyle:d}),v=p.wrapper,g=p.iconWrapper,y=p.childrenWrapper,m=p.tagWrapper,E=p.tagInner;return k(_.ZC,Object.assign({style:v},f,{children:k(_.hk,{disableRTL:!0,children:[i&&k(_.ZC,{style:g,children:i}),o&&k(_.ZC,{style:y,children:o}),a&&k(_.ZC,{style:m,children:k(_.ZC,{style:E,children:a})})]})}))}var Wt={cursor:"pointer"},jt={},Gt={borderRadius:1/0,padding:"2px 6px 2px 2px"},zt={borderRadius:"50%",margin:"0 4px 0 0"},Yt={width:"calc(1.31em + 0.11px)",height:"calc(1.31em + 0.11px)",fit:"cover"},Xt={self:{wrapper:{borderRadius:1/0,padding:"2px 4px",fontColor:"--static-white",backgroundColor:"--function-info-500",$hover:{backgroundColor:"--function-info-400"},$active:{backgroundColor:"--function-info-600"},$focus:{backgroundColor:"--function-info-400"}}},readable:{wrapper:{borderRadius:"4px",padding:"0px 2px",fontColor:"--text-link-normal",$hover:{backgroundColor:"--udtoken-btn-text-bg-pri-hover"},$active:{backgroundColor:"--udtoken-btn-text-bg-pri-pressed"},$focus:{backgroundColor:"--udtoken-btn-text-bg-pri-focus"}}},unreadable:{wrapper:{borderRadius:"4px",padding:"0px 2px",fontColor:"--text-caption",$hover:{backgroundColor:"--udtoken-btn-text-bg-neutral-hover"},$active:{backgroundColor:"--udtoken-btn-text-bg-neutral-pressed"},$focus:{backgroundColor:"--udtoken-btn-text-bg-neutral-focus"}}}},Kt={self:{wrapper:{fontColor:"--static-white",backgroundColor:"--primary-pri-500",$hover:{backgroundColor:"--primary-pri-400"},$active:{backgroundColor:"--primary-pri-600"},$focus:{backgroundColor:"--primary-pri-400"}}},readable:{wrapper:{fontColor:"--text-link-normal",backgroundColor:"--primary-pri-100",$hover:{backgroundColor:"--primary-pri-200"},$active:{backgroundColor:"--primary-pri-300"},$focus:{backgroundColor:"--primary-pri-200"}}},unreadable:{wrapper:{fontColor:"--text-caption",backgroundColor:"--udtoken-tag-neutral-bg-normal",$hover:{backgroundColor:"--udtoken-tag-neutral-bg-normal-hover"},$active:{backgroundColor:"--udtoken-tag-neutral-bg-normal-press"},$focus:{backgroundColor:"--udtoken-tag-neutral-bg-normal-hover"}}}};function qt(e){var t=e.type,n=void 0===t?"readable":t,i=e.avatar,o=e.children,a=e.wrapperStyle,s=void 0===a?{}:a,u=e.lineStyle,l=void 0===u?{}:u,c=e.avatarWrapperStyle,h=void 0===c?{}:c,d=e.avatarStyle,f=void 0===d?{}:d,p=(0,r.Z)(e,be),v=function(e){var t=e.type,n=e.hasAvatar,r=e.wrapperStyle,i=e.lineStyle,o=e.avatarWrapperStyle,a=e.avatarStyle,s=(n?Kt:Xt)[t].wrapper;return{wrapper:Object.assign({},Wt,s,n?Gt:{},r),line:Object.assign({},jt,i),avatarWrapper:Object.assign({},zt,o),avatarImageStyle:Object.assign({},Yt,a)}}({type:n,hasAvatar:!!i,wrapperStyle:s,lineStyle:l,avatarWrapperStyle:h,avatarStyle:f}),g=v.wrapper,y=v.line,m=v.avatarWrapper,E=v.avatarImageStyle;return k(_.ZC,Object.assign({style:g},p,{children:k(_.hk,{disableRTL:!0,style:y,children:[i?k(_.ZC,{style:m,children:k(mt,{src:i,fit:"fill",imgStyle:E})}):k(_.xv,{content:"@"}),o]})}))}var $t=function(e){return"type"in e&&"attributes"in e};function Jt(e){var t=Ke({width:"100%",height:"100%"},Ge(e)||$t(e)?{src:e}:e);if((this instanceof Jt?this.constructor:void 0)||"provides"in t)throw new Error("Icon can not be invoked with 'new', and should not use in JSX.");return k(Rt,Object.assign({},t))}function Qt(e){var t,n=Ge(e)||$t(e)?{src:e}:e;return Jt(Object.assign({height:"1em",width:"1em"},n,{svgStyle:Object.assign({baselineOffset:"-0.14em"},null!==(t=n.svgStyle)&&void 0!==t?t:{})}))}var en={name:"svg",type:"element",value:"",parent:null,attributes:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"none"},children:[{name:"path",type:"element",value:"",parent:null,attributes:{fill:"#F54A45",d:"M12 23C5.925 23 1 18.075 1 12S5.925 1 12 1s11 4.925 11 11-4.925 11-11 11Z"},children:[]},{name:"path",type:"element",value:"",parent:null,attributes:{fill:"#fff",d:"M7.757 7.757a1 1 0 0 0 0 1.414L10.586 12l-2.829 2.828a1 1 0 1 0 1.415 1.415L12 13.413l2.828 2.829a1 1 0 1 0 1.415-1.415L13.414 12l2.829-2.829a1 1 0 0 0-1.415-1.414L12 10.586 9.172 7.757a1 1 0 0 0-1.415 0Z"},children:[]}]},tn={name:"svg",type:"element",value:"",parent:null,attributes:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"none"},children:[{name:"path",type:"element",value:"",parent:null,attributes:{fill:"#34C724",d:"M1 12c0 6.076 4.924 11 11 11s11-4.924 11-11S18.076 1 12 1 1 5.924 1 12Z"},children:[]},{name:"path",type:"element",value:"",parent:null,attributes:{fill:"#fff",d:"M7.293 11.707a1 1 0 0 0 0 1.414l2.828 2.829a1 1 0 0 0 1.415 0l5.656-5.657a1 1 0 0 0-1.414-1.414l-4.95 4.95-2.12-2.122a1 1 0 0 0-1.415 0Z"},children:[]}]},nn=function(e,t,n,r){for(var i=t;i&&(!r||i!==r);){if(n(i))return i;i=i.parent?e.getElementByEid(i.parent):null}return null},rn={left:0,top:0,width:0,height:0},on=["left","right"],an=function(e){return on.includes(e)},sn=function(e){var t=e.search(/[A-Z][a-z]+/);return t<0&&(t=e.length),[e.substring(0,t),e.substring(t).toLowerCase()]},un=function(e,t,n){var r=e.contentRect,i=e.referenceRect,o=(0,l.Z)(t,2),a=o[0],s=o[1];return n.left="left"===a?-r.width:i.width,n.top=s?"top"===s?0:i.height-r.height:.5*(i.height-r.height),n},ln=function(e,t,n){var r=e.contentRect,i=e.referenceRect,o=(0,l.Z)(t,2),a=o[0],s=o[1];return n.top="top"===a?-r.height:i.height,n.left=s?"left"===s?0:i.width-r.width:.5*(i.width-r.width),n},cn=function(e){switch(e[0]){case"left":return["right",e[1]];case"top":return["bottom",e[1]];case"right":return["left",e[1]];case"bottom":return["top",e[1]];default:return e}},hn=function(e,t,n,r){return an(r[0])?"left"===r[0]?n.left>e.left:n.left+n.width<e.left+t.width:"top"===r[0]?n.top>e.top:n.top+n.height<e.top+t.height},dn=function(e,t,n){return t.width=e.referenceRect.width,n(e,t)},fn=function(e){function t(){return(0,f.Z)(this,t),(0,i.Z)(this,(0,o.Z)(t).apply(this,arguments))}return(0,s.Z)(t,e),(0,p.Z)(t,[{key:"componentDidLayout",value:function(){var e,t;null===(e=(t=this.props).onLayout)||void 0===e||e.call(t)}}]),t}(_.ZC),pn=function(e){function t(){return(0,f.Z)(this,t),(0,i.Z)(this,(0,o.Z)(t).apply(this,arguments))}return(0,s.Z)(t,e),(0,p.Z)(t,[{key:"componentDidLayout",value:function(){var e,t;null===(e=(t=this.props).onLayout)||void 0===e||e.call(t)}}]),t}(_.e2),vn=["click","mouseenter","mousedown"],gn=[function(e,t,n){var r,i=sn(null!==(r=e.options.placement)&&void 0!==r?r:"bottomLeft");return e.axises=i,n(e,t=(an(i[0])?un:ln)(e,i,t))},function(e,t,n){var r=e.options,i=e.contentRect,o=e.axises;if(!r.flip)return n(e,t);if(r.boundary){var a=Array.isArray(r.flip)?r.flip.map(sn):[cn(o)],s=e.getRect(r.boundary);if(void 0!==s.left&&void 0!==s.top){for(var u=-1;hn(t,s,i,o);){o=a[++u],t=(an(o[0])?un:ln)(e,a[u],t)}u>=0&&(e.axises=o)}}return n(e,t)},function(e,t,n){var r,i=e.axises,o=e.options.offset;return 0===(o=null!==(r=o)&&void 0!==r?r:0)||(an(i[0])?"left"===i[0]?t.left-=o:t.left+=o:"top"===i[0]?t.top-=o:t.top+=o),n(e,t)}],_n=function(e){function t(e){var n;return(0,f.Z)(this,t),(n=(0,i.Z)(this,(0,o.Z)(t).call(this,Object.assign({},e,{asRelative:!0}))))._contentRef=(0,_.Vf)(),n._referenceRef=(0,_.Vf)(),n._status=5,n._timer=null,n._lastPos=void 0,n.state={visible:!1,pos:{left:0,top:0}},n.show=n.show.bind((0,a.Z)(n)),n.hide=n.hide.bind((0,a.Z)(n)),n._getRect=n._getRect.bind((0,a.Z)(n)),n._onMouseEnter=n._onMouseEnter.bind((0,a.Z)(n)),n._onMouseLeave=n._onMouseLeave.bind((0,a.Z)(n)),n._onMouseDown=n._onMouseDown.bind((0,a.Z)(n)),n._onClick=n._onClick.bind((0,a.Z)(n)),n._layout=n._layout.bind((0,a.Z)(n)),n}return(0,s.Z)(t,e),(0,p.Z)(t,null,[{key:"defaultProps",get:function(){return{asRelative:!0}}}]),(0,p.Z)(t,[{key:"show",value:function(e){var t,n;!e&&this._status>=1&&this._status<=2||(this._status=1,this._clearTimer(),this.setState({visible:!0}),null===(t=(n=this.props).onVisibleChange)||void 0===t||t.call(n,!0),this._status=2)}},{key:"hide",value:function(){var e,t;this._status>=4&&this._status<=5||(this._clearTimer(),this._status>=5||(this.setState({visible:!1}),null===(e=(t=this.props).onVisibleChange)||void 0===e||e.call(t,!1),this._status=5))}},{key:"componentDidMount",value:function(){var e;(null!==(e=this.props.visible)&&void 0!==e?e:this.props.defaultVisible)&&this.show(),this.props.disabled||this._addOutsideListeners()}},{key:"componentDidUpdate",value:function(e){this.props.trigger!==e.trigger&&(this._removeOutsideListeners(),this.props.disabled||this._addOutsideListeners()),this.props.visible!==e.visible&&this.props.visible!==this.state.visible&&(this.props.visible?this.show():this.hide())}},{key:"componentWillUnmount",value:function(){this._removeOutsideListeners()}},{key:"_getMiddlewares",value:function(){return this.props.autoResizeOverlay?gn.concat(dn):gn}},{key:"_layout",value:function(){if(this._status<=2){var e=(t={reference:this._referenceRef,content:this._contentRef,getRect:this._getRect,middlewares:this._getMiddlewares(),options:{flip:this.props.flip,offset:this.props.offset,boundary:this.props.boundary,placement:this.props.placement}},n=t.reference,r=t.content,i=t.middlewares,o=t.options,a=void 0===o?{}:o,s=t.getRect,u={referenceRect:s(n),contentRect:r?s(r):rn,getRect:s,reference:n,content:r,options:a},i.reduceRight((function(e,t){return function(n,r){return t(n,r,e)}}),(function(e,t){return t}))(u,{left:0,top:0}));this._lastPos&&Xe(e,this._lastPos)||this.setState({pos:e}),this._lastPos=e}var t,n,r,i,o,a,s,u}},{key:"_removeOutsideListeners",value:function(){document.body.removeEventListener("mousedown",this.hide),document.body.removeEventListener("click",this.hide)}},{key:"_addOutsideListeners",value:function(){var e=this;this._getTrigger().forEach((function(t){"click"===t?document.body.addEventListener("click",e.hide):"mousedown"===t&&document.body.addEventListener("mousedown",e.hide)}))}},{key:"_generateListeners",value:function(){var e=this;return this.props.disabled?{}:this._getTrigger().reduce((function(t,n){return"mouseenter"===n?(t.mouseenter=e._onMouseEnter,t.mouseleave=e._onMouseLeave):"click"===n?t.click=e._onClick:"mousedown"===n&&(t.mousedown=e._onMouseDown),t}),{})}},{key:"_getTrigger",value:function(){var e,t=null!==(e=this.props.trigger)&&void 0!==e?e:vn;return Array.isArray(t)?t:[t]}},{key:"_getRect",value:function(e){return(0,_.rj)(e.current)}},{key:"_clearTimer",value:function(){null!==this._timer&&clearTimeout(this._timer),this._timer=null}},{key:"_toggleVisiblity",value:function(){this._status<=2?this.hide():this.show()}},{key:"_isInPopoverOverlay",value:function(e){return!!nn(this.$context,e,(function(e){return e.props.isPopoverOverlay}),this.element)}},{key:"_onMouseDown",value:function(e){e.nativeEvent.stopPropagation();var t=e.target;t&&this._isInPopoverOverlay(t)?this.show():this._toggleVisiblity()}},{key:"_onClick",value:function(e){e.nativeEvent.stopPropagation();var t=e.target;t&&this._isInPopoverOverlay(t)?this.show():this._toggleVisiblity()}},{key:"_onMouseEnter",value:function(){var e;if(!(this._status>=0&&this._status<=2)){this._clearTimer(),this._status=0;var t=null!==(e=this.props.mouseEnterDelay)&&void 0!==e?e:0;if(0===t)return this.show();this._timer=window.setTimeout(this.show,t)}}},{key:"_onMouseLeave",value:function(){var e;if(!(this._status>=3&&this._status<=5)){this._clearTimer(),this._status=3;var t=null!==(e=this.props.mouseLeaveDelay)&&void 0!==e?e:100;if(0===t)return this.hide();this._timer=window.setTimeout(this.hide,t)}}},{key:"render",value:function(){var e,t=this.state,n=t.visible,r=t.pos,i=this.props,o=i.bodyStyle,a=i.overlayStyle,s=i.destroyOnHide;return k(fn,{ref:this._referenceRef,style:o,on:this._generateListeners(),onLayout:this._layout,children:[null!==(e=this.props.children)&&void 0!==e?e:null,!s||n?k(pn,{ref:this._contentRef,isPopoverOverlay:!0,style:Object.assign({display:n},r,{},a),onLayout:this._layout,children:this.props.content},"content"):null]})}}]),t}(_.ZC),yn={backgroundColor:"--bg-float",border:"1px solid --line-border-card",borderRadius:"6px",padding:"2px 0",cursor:"pointer"},mn={width:"100%",fontColor:"--text-title",borderRadius:"4px",cursor:"pointer",margin:"1px 3px",padding:"4px 8px",$hover:{backgroundColor:"--fill-hover"}},En={fontColor:"--primary-pri-500"},bn={backgroundColor:"--bg-float",fontColor:"--text-disabled",cursor:"not-allowed"},Tn=function(e){var t=e.style,n=e.children,i=(0,r.Z)(e,Te);return k(_.ZC,Object.assign({style:Ue(yn,t)},i,{children:k(_.MG,{children:n})}))},Cn=function(e){var t=e.disabled,n=(e.icon,e.style),i=e.selected,o=e.children,a=(0,r.Z)(e,Ce);return k(_.ZC,Object.assign({style:Ue(mn,i&&En,t&&bn,n)},a,{children:o}))},Sn="rgba(255, 255, 255, 0)",wn={backgroundColor:"--udtoken-component-outlined-bg",border:"1px solid --line-border-component",fontColor:"--text-title",borderRadius:"6px",cursor:"pointer",$hover:{borderColor:"--primary-pri-500"}},Rn={borderColor:"--function-danger-500",fontColor:"--function-danger-500",$hover:void 0},An={width:"100%"},On={borderColor:"--primary-pri-500"},Mn={backgroundColor:Sn,borderColor:Sn,$hover:{backgroundColor:"--fill-hover"}},kn={borderColor:Sn},In={backgroundColor:"--udtoken-input-bg-disabled",fontColor:"--udtoken-component-text-disabled-loading",cursor:"not-allowed",$hover:void 0},xn={fontColor:"--text-placeholder"},Nn={flexGrow:1},Pn={backgroundColor:Sn,borderLeftWidth:0,borderRightWidth:0,borderTopWidth:0,borderRadius:0,paddingLeft:0,paddingRight:0},Ln={small:{borderWidth:"1px",fontSize:"12px",height:"28px",lineHeight:"24px",padding:"1px 7px"},medium:{borderWidth:"1px",fontSize:"14px",height:"32px",lineHeight:"28px",padding:"1px 11px"},large:{borderWidth:"1px",fontSize:"16px",height:"40px",lineHeight:"36px",padding:"1px 11px"}},Dn={width:"auto",alignCrossAxis:"center"},Fn={width:"100%"},Bn={fontSize:"12px",marginLeft:"8px",fontColor:"--icon-n2"},Vn={fontColor:"--icon-disabled"},Hn={name:"svg",type:"element",value:"",attributes:{width:"24",height:"24",fill:"none",xmlns:"http://www.w3.org/2000/svg","data-icon":"DownBoldOutlined"},children:[{name:"path",type:"element",value:"",attributes:{d:"m3.414 7.086-.707.707a1 1 0 0 0 0 1.414l7.778 7.778a2 2 0 0 0 2.829 0l7.778-7.778a1 1 0 0 0 0-1.414l-.707-.707a1 1 0 0 0-1.415 0l-7.07 7.07-7.072-7.07a1 1 0 0 0-1.414 0Z",fill:"currentColor"},children:[]}]};_.wA;function Un(e){return void 0!==e.props.value}_.ZC;var Zn={format:function(e){return k(_.xv,{content:"".concat(Math.round(e),"%")})},infoPosition:"right",percent:0,showInfo:!0,status:"normal",strokeWidth:4,type:"line",width:16,wrapperStyle:{}},Wn={margin:"0 4px"},jn={alignCrossAxis:"center"},Gn={fontColor:"--N500",fontSize:"12px",flexShrink:0,flexGrow:0},zn={line:{left:"0 12px 0 0",right:"0 0 0 12px"},circle:{left:"0 8px 0 0",right:"0 0 0 8px"}},Yn="--N300",Xn="--B500",Kn="--G500",qn="--R500";function $n(e){var t=e.width;return k(_.us,{selectable:!1,style:{height:t,width:t},draw:function(t){return function(e,t){var n=t.width,r=t.strokeColor,i=t.trailColor,o=t.percent,a=e.ctx,s=e.left,u=e.top,l=e.width,c=e.height,h=s+l/2,d=u+c/2,f=n/8,p=(n-f)/2;a.lineWidth=f,a.lineCap="round";var v=function(e,t){a.beginPath(),a.arc(h,d,p,-.5*Math.PI,(2*e-.5)*Math.PI,!1),a.strokeStyle=t,a.stroke(),a.closePath()};v(1,i),v(o/100,r)}(t,e)}})}function Jn(e,t){var n=t.strokeWidth,r=t.strokeColor,i=t.trailColor,o=t.percent,a=e.ctx,s=e.left,u=e.top,l=e.width,c=e.height,h=n/2,d=s,f=s+h,p=s+l-h,v=u+c/2,g=function(e,t){var i=(p-d)*e;i<=h?function(e,t){var r=2*Math.sqrt((n-e)*e),i=2*Math.asin(r/n);a.beginPath(),a.arc(f,v,h,Math.PI-i/2,Math.PI+i/2,!1),a.bezierCurveTo(d+2*e,v-r/2,d+2*e,v+r/2,d+e,v+r/2),a.fillStyle=t,a.fill(),a.closePath()}(i,r):(a.beginPath(),a.lineCap="round",a.lineWidth=n,a.moveTo(f,v),a.lineTo(f+i-h,v),a.strokeStyle=t,a.stroke(),a.closePath())};g(1,i),g(o/100,r)}function Qn(e){var t=e.strokeWidth;return k(_.us,{selectable:!1,style:{height:t,flexGrow:1},draw:function(t){return Jn(t,e)}})}var er={circle:{normal:function(e){return $n(Object.assign({strokeColor:"".concat(Xn),trailColor:"".concat(Yn)},e))},success:function(e){var t=e.width;return Jt({src:tn,width:t,height:t})},exception:function(e){var t=e.width;return Jt({src:en,width:t,height:t})}},line:{normal:function(e){return Qn(Object.assign({strokeColor:"".concat(Xn),trailColor:"".concat(Yn)},e))},success:function(e){return Qn(Object.assign({strokeColor:"".concat(Kn),trailColor:"".concat(Yn)},e))},exception:function(e){return Qn(Object.assign({strokeColor:"".concat(qn),trailColor:"".concat(Yn)},e))}}},tr=(_.ZC,function(e,t,n){return e>=t&&e<n}),nr=function(e,t){var n=e.x,r=e.y,i=t.left,o=t.top,a=t.width,s=t.height;return tr(n,i,i+a)&&tr(r,o,o+s)};function rr(e,t,n){return Math.max(t,Math.min(n,e))}var ir=Ze,or=function(e,t,n){var r=n.isHorizontal,i=n.isHover,o=n.isActive,a=t.left,s=t.top,u=t.width,l=t.height;if(e.beginPath(),r){var c=l/2,h=a+c,d=a+u-c,f=s+c;e.arc(h,f,c,.5*Math.PI,1.5*Math.PI,!1),e.arc(d,f,c,1.5*Math.PI,.5*Math.PI,!1)}else{var p=u/2,v=s+p,g=s+l-p,_=a+p;e.arc(_,v,p,Math.PI,0,!1),e.arc(_,g,p,0,Math.PI,!1)}var y="--N900-30";i&&(y="--N900-60"),o&&(y="--N900-60"),e.fillStyle=y,e.fill(),e.closePath()};function ar(e,t){return function(n){var r=e.info.isHorizontal?n.canvasOffsetX:n.canvasOffsetY;void 0!==r&&(t(r,n),n.preventDefault(),n.nativeEvent.preventDefault())}}var sr=function(e){function t(){var e,n;(0,f.Z)(this,t);for(var r=arguments.length,s=new Array(r),u=0;u<r;u++)s[u]=arguments[u];return(n=(0,i.Z)(this,(e=(0,o.Z)(t)).call.apply(e,[this].concat(s)))).isHover=!1,n.trackRef=(0,_.Vf)(),n.trackRect={left:0,top:0,width:0,height:0},n.lastPos=void 0,n.curPos=void 0,n.handlePointerdown=ar((0,a.Z)(n),(function(e,t){if(nr({x:t.canvasOffsetX,y:t.canvasOffsetY},n.thumbRect)){var r=n.trackRef.current;r&&((0,_.I5)(r,t.pointerId),n.lastPos=e,n.curPos=e)}else{var i=n.props.scrollOnClick;if(!(void 0===i||i))return;var o=n.info,a=o.isHorizontal,s=o.minDiff,u=o.maxDiff,l=o.triggerScroll,c=n.thumbRect,h=c.left,d=c.top,f=c.width,p=c.height;l(rr(e-(a?h+f/2:d+p/2),s,u))}})),n.handlePointermove=ar((0,a.Z)(n),(function(e,t){var r=n.isActive||nr({x:t.canvasOffsetX,y:t.canvasOffsetY},n.thumbRect);if(n.setHover(r)&&n.forceUpdate(),void 0!==n.lastPos){var i=n.info,o=i.minDiff,a=i.maxDiff,s=i.triggerScroll,u=rr(e-n.lastPos,o,a),l=n.lastPos+u;l!==n.curPos&&(n.curPos=l,s(u))}})),n.handlePointerup=ar((0,a.Z)(n),(function(e,t){n.lastPos=void 0,n.curPos=void 0;var r=nr({x:t.canvasOffsetX,y:t.canvasOffsetY},n.thumbRect);n.setHover(r)&&n.forceUpdate()})),n.handlePointerleave=function(){n.setHover(!1)&&n.forceUpdate()},n}return(0,s.Z)(t,e),(0,p.Z)(t,[{key:"setHover",value:function(e){return this.isHover!==e&&(this.isHover=e,!0)}},{key:"render",value:function(){var e=this,t=this.props,n=t.drawTrack,r=void 0===n?ir:n,i=t.drawThumb,o=void 0===i?or:i;return this.lastPos=this.curPos,k(_.us,{ref:this.trackRef,style:{height:"100%",width:"100%"},selectable:!1,lineWrap:!1,draw:function(t){var n=t.ctx,i=t.left,a=t.top,s=t.width,u=t.height;e.trackRect={left:i,top:a,width:s,height:u};var l={isHorizontal:e.info.isHorizontal,isHover:e.isHover,isActive:e.isActive};r(n,e.trackRect,l),o(n,e.thumbRect,l)},on:{capturedPointerdown:this.handlePointerdown,capturedPointermove:this.handlePointermove,capturedPointerup:this.handlePointerup,pointerleave:this.handlePointerleave}})}},{key:"isActive",get:function(){return void 0!==this.curPos}},{key:"thumbRect",get:function(){return e=this.props.scrollValue,t=this.info,n=this.trackRect,i=t.isHorizontal,o=t.thumbSize,a=t.maxScrollValue,s=t.maxViewValue,l=n.left,c=n.top,h=n.width,d=n.height,r={},(0,u.Z)(r,i?"width":"height",o),(0,u.Z)(r,i?"height":"width",i?d:h),(0,u.Z)(r,i?"left":"top",(i?l:c)+rr(e/a*s,0,s)),(0,u.Z)(r,i?"top":"left",i?c:l),r;var e,t,n,r,i,o,a,s,l,c,h,d}},{key:"info",get:function(){return e=this.props,t=this.trackRect,n=e.direction,r=void 0===n?"vertical":n,i=e.scrollValue,o=e.scrollSize,a=e.handleScroll,u=(s="horizontal"===r)?t.width:t.height,l=rr(u/Math.max(1,o)*u,0,u),c=Math.max(1,o-u),h=Math.max(1,u-l),{isHorizontal:s,viewSize:u,thumbSize:l,maxScrollValue:c,maxViewValue:h,minDiff:-i/c*h,maxDiff:(c-i)/c*h,triggerScroll:a?function(e){var t=rr(i+e/h*c,0,c);null==a||a(t)}:Ze};var e,t,n,r,i,o,a,s,u,l,c,h}}]),t}(_.ZC);Ne(sr,"defaultProps",{selectable:!1,lineWrap:!1})},vsh_79261:function(e,t,n){"use strict";n.d(t,{P_:function(){return p},BR:function(){return d},vE:function(){return u},fL:function(){return s},wv:function(){return l},O1:function(){return y},ZN:function(){return b},zg:function(){return h},x4:function(){return f},$4:function(){return E},IK:function(){return T},yW:function(){return c},Qz:function(){return a},tq:function(){return C},UT:function(){return m}});var r,i,o,a,s,u,l,c,h,d,f,p,v=n("vsh_74561"),g=n("vsh_6127"),_=n.n(g);!function(e){e.waiting="waiting",e.writing="writing",e.finished="finished",e.custom="custom"}(a||(a={})),function(e){e.like="like",e.dislike="dislike",e.none="none"}(s||(s={})),function(e){e.redo="redo",e.userPrompt="user_prompt",e.historyPrompt="history_prompt"}(u||(u={})),function(e){e.float="float",e.modal="modal"}(l||(l={})),function(e){e[e.chat=0]="chat",e[e.inline=1]="inline"}(c||(c={})),function(e){e.Normal="normal",e.Group="group",e.SubMenu="sub-menu",e.Divider="divider"}(h||(h={})),function(e){e.copyDebug="copyDebug",e.void="void"}(d||(d={})),function(e){e.Primary="primary",e.Normal="normal"}(f||(f={})),function(e){e[e.AI_FAIL=1]="AI_FAIL",e[e.AI_PARAM_ERROR=2]="AI_PARAM_ERROR",e[e.AI_NOT_FOUND=3]="AI_NOT_FOUND",e[e.AI_NOPERMISSION_CODE=4]="AI_NOPERMISSION_CODE",e[e.AI_RPC_ERROR=5]="AI_RPC_ERROR",e[e.AI_INTERNAL_ERROR=500]="AI_INTERNAL_ERROR",e[e.AI_QPM_LIMIT_ERROR=666900001]="AI_QPM_LIMIT_ERROR",e[e.AI_TPM_LIMIT_ERROR=666900002]="AI_TPM_LIMIT_ERROR",e[e.AI_CALLBACK_TIMEOUT=666900003]="AI_CALLBACK_TIMEOUT",e[e.AI_UNUSABLE_CODE=666900005]="AI_UNUSABLE_CODE",e[e.AI_CONTENT_TOO_LONG=666900100]="AI_CONTENT_TOO_LONG",e[e.AI_NO_AUTH=666900101]="AI_NO_AUTH",e[e.AI_TIMEOUT=13010]="AI_TIMEOUT",e[e.AI_CROSS_REGION_ERROR=13020]="AI_CROSS_REGION_ERROR",e[e.AI_CROSS_BRAND_ERROR=13021]="AI_CROSS_BRAND_ERROR",e[e.AI_INPUT_COMPLIENCE_ERROR=13030]="AI_INPUT_COMPLIENCE_ERROR",e[e.AI_OUTPUT_COMPLIENCE_ERROR=13031]="AI_OUTPUT_COMPLIENCE_ERROR",e[e.AI_LLPP_UNKONWN_ERROR=13040]="AI_LLPP_UNKONWN_ERROR",e[e.AI_LLPP_RATE_LIMIT=13041]="AI_LLPP_RATE_LIMIT",e[e.AI_LLPP_USER_AUTH_FAIL=13043]="AI_LLPP_USER_AUTH_FAIL",e[e.AI_LLPP_PERM_DENY=13044]="AI_LLPP_PERM_DENY",e[e.AI_LLPP_REQIRED_PARAM=13045]="AI_LLPP_REQIRED_PARAM",e[e.AI_LLPP_TASK_VERSION_NOT_FOUND=13046]="AI_LLPP_TASK_VERSION_NOT_FOUND",e[e.AI_LLPP_TASK_NOT_FOUND=13047]="AI_LLPP_TASK_NOT_FOUND",e[e.AI_CODE_USER_LIMIT=13088]="AI_CODE_USER_LIMIT",e[e.AI_CONTENT_TOO_LONG_FROM_AI=13089]="AI_CONTENT_TOO_LONG_FROM_AI",e[e.AI_PROCESS_ERROR=13090]="AI_PROCESS_ERROR"}(p||(p={}));r={},(0,v.Z)(r,p.AI_UNUSABLE_CODE,"LarkCCM_Docs_MyAi_AdminDeactivated_aiName_Toast"),(0,v.Z)(r,p.AI_NOPERMISSION_CODE,"LarkCCM_Docs_MyAi_NoPerm_Toast"),(0,v.Z)(r,p.AI_CROSS_REGION_ERROR,"LarkCCM_Docs_MyAI_UnavailRegion_aiName_Text"),(0,v.Z)(r,p.AI_CROSS_BRAND_ERROR,"LarkCCM_Docs_MyAI_LogInToUse_aiName_Text");var y,m={itemType:h.SubMenu,title:d.void,text:d.void,type:d.void,children:[]};!function(e){e.ESC="esc",e.ClickOutside="click-outside",e.FloatCloseBtn="float-close-btn",e.BackspaceWhenEmpty="backspace-when-empty",e.QuitBtn="quit-btn",e.CommandBtn="command-btn"}(y||(y={}));var E,b=(i={},(0,v.Z)(i,y.ESC,"esc"),(0,v.Z)(i,y.ClickOutside,"click_anywhere"),(0,v.Z)(i,y.FloatCloseBtn,"click_upper_right_corner"),(0,v.Z)(i,y.BackspaceWhenEmpty,"backspace"),(0,v.Z)(i,y.QuitBtn,"click_button_on_result_page"),(0,v.Z)(i,y.CommandBtn,"click_other_command_button"),i);!function(e){e.IM="IM",e.DOC="Doc",e.SHEET="Sheet",e.BASE="Base",e.VC="VC",e.CALENDAR="Calendar",e.EMAIL="Email",e.MEEGO="Meego",e.SLIDES="Slides",e.OPENWEB="OpenWebContainer",e.SEARCH="Search",e.P2PCHAT="P2pChat",e.GROUPCHAT="GroupChat",e.BOARD="Board",e.PDFVIEW="PDFView"}(E||(E={}));var T=(o={},(0,v.Z)(o,E.IM,0),(0,v.Z)(o,E.DOC,1),(0,v.Z)(o,E.SHEET,2),(0,v.Z)(o,E.BASE,3),(0,v.Z)(o,E.VC,4),(0,v.Z)(o,E.CALENDAR,5),(0,v.Z)(o,E.EMAIL,6),(0,v.Z)(o,E.MEEGO,7),o),C=_().isMobile||_().isIPad},vsh_84783:function(e,t,n){"use strict";n.d(t,{K:function(){return i},B:function(){return r}});var r="space/api/inline_ai/get_quick_action",i="/space/api/inline_ai/get_recent_actions"},vsh_29729:function(e,t,n){"use strict";n.d(t,{x:function(){return a},PA:function(){return s},qH:function(){return l},sf:function(){return v},_x:function(){return c},l5:function(){return i},ZQ:function(){return h},u:function(){return d}});var r=n("vsh_65498");function i(){i=function(){return t};var e,t={},n=Object.prototype,o=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},u=s.iterator||"@@iterator",l=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag";function h(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{h({},"")}catch(e){h=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var i=t&&t.prototype instanceof y?t:y,o=Object.create(i.prototype),s=new I(r||[]);return a(o,"_invoke",{value:A(e,n,s)}),o}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var p="suspendedStart",v="executing",g="completed",_={};function y(){}function m(){}function E(){}var b={};h(b,u,(function(){return this}));var T=Object.getPrototypeOf,C=T&&T(T(x([])));C&&C!==n&&o.call(C,u)&&(b=C);var S=E.prototype=y.prototype=Object.create(b);function w(e){["next","throw","return"].forEach((function(t){h(e,t,(function(e){return this._invoke(t,e)}))}))}function R(e,t){function n(i,a,s,u){var l=f(e[i],e,a);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==(0,r.Z)(h)&&o.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,s,u)}),(function(e){n("throw",e,s,u)})):t.resolve(h).then((function(e){c.value=e,s(c)}),(function(e){return n("throw",e,s,u)}))}u(l.arg)}var i;a(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(o,o):o()}})}function A(t,n,r){var i=p;return function(o,a){if(i===v)throw new Error("Generator is already running");if(i===g){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=O(s,r);if(u){if(u===_)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===p)throw i=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=v;var l=f(t,n,r);if("normal"===l.type){if(i=r.done?g:"suspendedYield",l.arg===_)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(i=g,r.method="throw",r.arg=l.arg)}}}function O(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,O(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),_;var o=f(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,_;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,_):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,_)}function M(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(M,this),this.reset(!0)}function x(t){if(t||""===t){var n=t[u];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function n(){for(;++i<t.length;)if(o.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError((0,r.Z)(t)+" is not iterable")}return m.prototype=E,a(S,"constructor",{value:E,configurable:!0}),a(E,"constructor",{value:m,configurable:!0}),m.displayName=h(E,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,E):(e.__proto__=E,h(e,c,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},w(R.prototype),h(R.prototype,l,(function(){return this})),t.AsyncIterator=R,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new R(d(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},w(S),h(S,c,"Generator"),h(S,u,(function(){return this})),h(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=x,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var u=o.call(a,"catchLoc"),l=o.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,_):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;k(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:x(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),_}},t}function o(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function s(e){o(a,r,i,s,u,"next",e)}function u(e){o(a,r,i,s,u,"throw",e)}s(void 0)}))}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,g(r.key),r)}}function l(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e,t,n){return(t=g(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||f(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||f(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function v(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=f(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function g(e){var t=function(e,t){if("object"!==(0,r.Z)(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==(0,r.Z)(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===(0,r.Z)(t)?t:String(t)}},vsh_96792:function(e,t,n){"use strict";n.d(t,{O:function(){return i}});var r=n("vsh_29729"),i=function(){function e(){(0,r.PA)(this,e),this.timeMap=new Map}return(0,r.qH)(e,[{key:"addTimeUpdateEventListener",value:function(e,t){var n=this.timeMap.get(e);n?n.callbacks.add(t):console.error("[Time Service error]: addTimeUpdateEventListener no timeInfo!!!",e)}},{key:"getUpdateTime",value:function(e){var t;return null===(t=this.timeMap.get(e))||void 0===t?void 0:t.value}},{key:"updateTime",value:function(e,t){if(!this.timeMap.has(e)){var n={value:t,callbacks:new Set};this.timeMap.set(e,n)}var r=this.timeMap.get(e);r?(r.value=Math.max(t,r.value),r.callbacks.forEach((function(e){null==e||e(r.value)}))):console.error("[Time Service error]: updateTime no timeInfo!!!",e)}},{key:"removeTimeUpdateEventListener",value:function(e,t){var n=this.timeMap.get(e);if(n)return n.callbacks.delete(t);console.error("[Time Service error]: removeTimeUpdateEventListener no timeInfo!!!",e)}},{key:"clearTimeUpdateEventListener",value:function(e){var t;this.timeMap.has(e)?(null===(t=this.timeMap.get(e))||void 0===t||t.callbacks.clear(),this.timeMap.clear()):console.error("[Time Service error]: clearTimeUpdateEventListener no timeInfo!!!",e)}}],[{key:"getInstance",value:function(){return this.instance||(this.instance=new e),this.instance}},{key:"timeTransfer",value:function(e){return new Date(1e3*e).toLocaleString().replace(new RegExp("/","g"),"-")}}]),e}()},vsh_89049:function(e,t,n){"use strict";n.d(t,{g:function(){return E}});var r,i,o=n("vsh_29729"),a="ccm.bitable.dashboard.richtext_enabled",s="ccm.base.automation_button_element_trigger",u="ccm.base.dash_extension_widget",l="ccm.bitable.dashboard.copy_widget_on_right",c="ccm.bitable.dashboard.text_widget_add_default_content",h="ccm.bitable.dashboard.unsupported_chart_type_tip_hide_upgrade",d="ccm.bitable.dashboard.chart.same_data_draw_ignore",f="base_dashboard_perf_upgrade_q2",p={sheet_chart_series_max_count:50,sheet_chart_render_point_max_count:1e4,sheet_block_wd_cloud_render_point_max_count:50,sheet_block_pie_render_point_max_count:3e3,blank_dashboard_components:["column","line","pie","bar","scatter","combo","funnel","wordCloud","statistics","richText"]},v=(r={sheet_chart_series_max_count:p.sheet_chart_series_max_count,sheet_chart_render_point_max_count:p.sheet_chart_render_point_max_count,sheet_block_wd_cloud_render_point_max_count:p.sheet_block_wd_cloud_render_point_max_count,sheet_block_pie_render_point_max_count:p.sheet_block_pie_render_point_max_count,sheet_block_chart_palette_v2:!1,sheet_blocks_sync_max_request_number:20,sheet_blocks_sync_missversion_threshold:200,message_box_new_protocol:!1,"ccm.bitable.base_redesign.enable":!1},(0,o._x)(r,h,!1),(0,o._x)(r,a,!1),(0,o._x)(r,s,!1),(0,o._x)(r,u,!1),(0,o._x)(r,l,!1),(0,o._x)(r,c,!1),(0,o._x)(r,"ccm.bitable.dashboard.pc.add_chartblock_to_workplace",!1),(0,o._x)(r,"ccm.bitable.dashboard.brand_purple_blue_theme_enabled",!1),(0,o._x)(r,"ccm.bitable.dashboard.chart.support.animation",!1),(0,o._x)(r,"base.dashboard.enable_new_widget_initialization",!1),(0,o._x)(r,d,!1),(0,o._x)(r,f,!1),r),g=null,_=null,y=function(e){return g?g(e,v[e]):v[e]},m=function(e){return _?_(e,v[e]):v[e]},E={init:function(e){Object.assign(v,e)},setConfigGetters:function(e){g=e.getMinaNumberConfig,_=e.getMinaBooleanConfig,i=e.getSettingsConfig},getChartSeriesMaxCount:function(){return y("sheet_chart_series_max_count")||p.sheet_chart_series_max_count},getChartRenderPointMaxCount:function(){return y("sheet_chart_render_point_max_count")||p.sheet_chart_render_point_max_count},getPieRenderPointMaxCount:function(){return y("sheet_block_pie_render_point_max_count")||p.sheet_block_pie_render_point_max_count},getWdCloudsRenderPointMaxCount:function(){return y("sheet_block_wd_cloud_render_point_max_count")||p.sheet_block_wd_cloud_render_point_max_count},getIsChartPaletteV2:function(){return m("sheet_block_chart_palette_v2")},getSyncMissversionThreshold:function(){return y("sheet_blocks_sync_missversion_threshold")},getBaseRedesignEnabled:function(){return m("ccm.bitable.base_redesign.enable")},getSyncMaxRequestNumber:function(){return y("sheet_blocks_sync_max_request_number")},getIsDashboardRichTextEnabled:function(){return m(a)},getIsDashboardButtonWidgetEnabled:function(){return m(s)},getIsDashboardExtensionWidgetEnabled:function(){return m(u)},getIsDashboardCopyWidgetOnRightEnabled:function(){return m(l)},getIsDashboardTextWidgetDefaultContentEnabled:function(){return m(c)},getMessageBoxNewProtocolEnabled:function(){return m("message_box_new_protocol")},getUnsupportedChartTypeTipHideUpgrade:function(){return m(h)},getDashboardWidgetMaxCount:function(){var e;return null!==(e=null==i?void 0:i("ccm_dashboard_widget_max_count",200))&&void 0!==e?e:200},getIsDashboardToWorkplace:function(){return m("ccm.bitable.dashboard.pc.add_chartblock_to_workplace")},getDashboardBrandBluePurpleThemeEnabled:function(){return m("ccm.bitable.dashboard.brand_purple_blue_theme_enabled")},getDashboardChartAnimationEnabled:function(){return m("ccm.bitable.dashboard.chart.support.animation")},isBaseDashboardNewWidgetInit:function(){return m("base.dashboard.enable_new_widget_initialization")},getBlankDashboardComponents:function(){var e;return null!==(e=null==i?void 0:i("base_dashboard_blank_components",p.blank_dashboard_components))&&void 0!==e?e:p.blank_dashboard_components},isDashboardSameDataDrawIgnore:function(){return m(d)},isHitBaseDashboardPerf:function(){return m(f)}}},vsh_83836:function(e,t,n){"use strict";var r,i,o;n.d(t,{kH:function(){return r},Cn:function(){return o},lU:function(){return i}}),function(e){e.FALLBACK="FALLBACK",e.CHART="CHART",e.DASHBOARD="DASHBOARD",e.BITABLE_TABLE="BITABLE_TABLE",e.BITABLE_FOLDER="BITABLE_FOLDER",e.PIVOT_TABLE="PIVOT_TABLE",e.LINKED_DOCX="LINKED_DOCX",e.RICH_TEXT="RICH_TEXT",e.BUTTON="BUTTON",e.ADDON="ADDON"}(r||(r={})),function(e){e[e.FOLDER=0]="FOLDER",e[e.DOC=2]="DOC",e[e.SHEET=3]="SHEET",e[e.BITABLE=8]="BITABLE",e[e.MINDNOTE=11]="MINDNOTE",e[e.FILE=12]="FILE",e[e.SLIDES=30]="SLIDES",e[e.DOCX=22]="DOCX",e[e.DASHBOARD=36]="DASHBOARD",e[e.BITABLE_TABLE=83]="BITABLE_TABLE",e[e.CHART=110]="CHART",e[e.BITABLE_FOLDER=85]="BITABLE_FOLDER"}(i||(i={})),function(e){e[e.unknown=0]="unknown",e[e.xy=1048576]="xy",e[e.stackAble=1048832]="stackAble",e[e.noStack=1049344]="noStack",e[e.stack=1049856]="stack",e[e.stackPercentage=1050880]="stackPercentage",e[e.lineLike=1052672]="lineLike",e[e.linear=1060864]="linear",e[e.smooth=1069056]="smooth",e[e.stepped=1085440]="stepped",e[e.swapAxes=1114112]="swapAxes",e[e.column=1048833]="column",e[e.bar=1114370]="bar",e[e.line=1052932]="line",e[e.area=1052936]="area",e[e.scatter=1048592]="scatter",e[e.combo=1052960]="combo",e[e.dualAxes=1053024]="dualAxes",e[e.radial=1179648]="radial",e[e.radar=1441792]="radar",e[e.lineRadar=1441793]="lineRadar",e[e.linePointRadar=1441794]="linePointRadar",e[e.areaRadar=1441796]="areaRadar",e[e.pie=2097152]="pie",e[e.normalPie=2097408]="normalPie",e[e.donut=2097664]="donut",e[e.statistics=4194304]="statistics",e[e.wordCloud=8388608]="wordCloud",e[e.funnel=16777216]="funnel",e[e.normalFunnel=16777472]="normalFunnel",e[e.bilateralFunnel=16777728]="bilateralFunnel",e[e.waterfall=1572864]="waterfall",e[e.pareto=33554432]="pareto",e[e.bubble=67108864]="bubble",e[e.richText=134217728]="richText",e[e.button=268435456]="button",e[e.addon=536870912]="addon"}(o||(o={}))},vsh_68233:function(e,t,n){"use strict";n.d(t,{Fv:function(){return s},P_:function(){return a}});var r=n("vsh_22023"),i=n("vsh_29729");function o(e,t){return(0,r.default)(e,t)}function a(e,t,n,r){if(e&&t&&n&&r){var i=e.get(t)||new Map;i.set(n,r),e.set(t,i)}}function s(e,t,n){if(!e||!t||!n)return null;var r=e.get(t);return r?function(e,t){if(!e)return null;var n,r=e.entries(),a=(0,i.sf)(r);try{for(a.s();!(n=a.n()).done;){var s=(0,i.ZQ)(n.value,2),u=s[0],l=s[1];if(o(u,t))return l}}catch(e){a.e(e)}finally{a.f()}return null}(r,n):null}},vsh_93534:function(e,t,n){"use strict";n.d(t,{J0:function(){return s},wi:function(){return o},N$:function(){return a}});var r=n("vsh_6127"),i=n.n(r),o=function(){return i().isBytedanceApp&&(i().isMobile||i().isIPad)||Boolean(i().isH5)},a=function(){var e="undefined"!=typeof window,t=e&&window.navigator||{},n=e&&(window.User&&window.User.userAgent||t.userAgent)||"",r=e&&window.location.search||"";return/vc=true/.test(r.toLowerCase())||i().isLark&&/\sVC\//.test(n)},s=function(){return i().isBytedanceApp&&(i().isMobile||i().isIPad)}},vsh_47524:function(e,t,n){"use strict";n.d(t,{z:function(){return o},k:function(){return i}});var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=function(){return"_".concat(Math.random().toString(36).substr(2,9))},o=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,t="",n=0;n<e;n++)t+=r[Math.floor(Math.random()*r.length)];return t}},vsh_26547:function(e,t,n){"use strict";n.d(t,{Lc:function(){return v},x:function(){return s},PA:function(){return u},qH:function(){return c},sf:function(){return S},WY:function(){return _},_x:function(){return h},U2:function(){return m},IP:function(){return f},XW:function(){return d},l5:function(){return i},ZQ:function(){return E},u:function(){return b},Ac:function(){return o}});var r=n("vsh_65498");function i(){i=function(){return t};var e,t={},n=Object.prototype,o=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},u=s.iterator||"@@iterator",l=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag";function h(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{h({},"")}catch(e){h=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var i=t&&t.prototype instanceof y?t:y,o=Object.create(i.prototype),s=new I(r||[]);return a(o,"_invoke",{value:A(e,n,s)}),o}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var p="suspendedStart",v="executing",g="completed",_={};function y(){}function m(){}function E(){}var b={};h(b,u,(function(){return this}));var T=Object.getPrototypeOf,C=T&&T(T(x([])));C&&C!==n&&o.call(C,u)&&(b=C);var S=E.prototype=y.prototype=Object.create(b);function w(e){["next","throw","return"].forEach((function(t){h(e,t,(function(e){return this._invoke(t,e)}))}))}function R(e,t){function n(i,a,s,u){var l=f(e[i],e,a);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==(0,r.Z)(h)&&o.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,s,u)}),(function(e){n("throw",e,s,u)})):t.resolve(h).then((function(e){c.value=e,s(c)}),(function(e){return n("throw",e,s,u)}))}u(l.arg)}var i;a(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(o,o):o()}})}function A(t,n,r){var i=p;return function(o,a){if(i===v)throw new Error("Generator is already running");if(i===g){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=O(s,r);if(u){if(u===_)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===p)throw i=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=v;var l=f(t,n,r);if("normal"===l.type){if(i=r.done?g:"suspendedYield",l.arg===_)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(i=g,r.method="throw",r.arg=l.arg)}}}function O(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,O(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),_;var o=f(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,_;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,_):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,_)}function M(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(M,this),this.reset(!0)}function x(t){if(t||""===t){var n=t[u];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function n(){for(;++i<t.length;)if(o.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError((0,r.Z)(t)+" is not iterable")}return m.prototype=E,a(S,"constructor",{value:E,configurable:!0}),a(E,"constructor",{value:m,configurable:!0}),m.displayName=h(E,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,E):(e.__proto__=E,h(e,c,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},w(R.prototype),h(R.prototype,l,(function(){return this})),t.AsyncIterator=R,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new R(d(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},w(S),h(S,c,"Generator"),h(S,u,(function(){return this})),h(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=x,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var u=o.call(a,"catchLoc"),l=o.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,_):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;k(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:x(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),_}},t}function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){a(o,r,i,s,u,"next",e)}function u(e){a(o,r,i,s,u,"throw",e)}s(void 0)}))}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,w(r.key),r)}}function c(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function h(e,t,n){return(t=w(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}function p(e,t){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},p(e,t)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e,t){if(t&&("object"===(0,r.Z)(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return v(e)}function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f(e);if(t){var i=f(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g(this,n)}}function y(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}function m(){return m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=y(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},m.apply(this,arguments)}function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||T(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e){return function(e){if(Array.isArray(e))return C(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||T(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){if(e){if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function S(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=T(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function w(e){var t=function(e,t){if("object"!==(0,r.Z)(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==(0,r.Z)(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===(0,r.Z)(t)?t:String(t)}},vsh_22409:function(e,t,n){"use strict";n.d(t,{Hn:function(){return tt},ew:function(){return Qe}});var r=n("vsh_43744"),i=n("vsh_93301"),o=n("vsh_26547"),a=n("vsh_40658");var s=n("vsh_93534"),u=n("vsh_47524"),l=n("vsh_83836"),c=n("vsh_4285"),h=n("vsh_75457"),d=n("vsh_8196"),f=n("vsh_56489");function p(e,t,n){return n?p(e,t).pipe((0,f.map)((function(e){return(0,h.k)(e)?n.apply(void 0,e):n(e)}))):new c.y((function(n){var r,i=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.next(1===e.length?e[0]:e)};try{r=e(i)}catch(e){return void n.error(e)}if((0,d.m)(t))return function(){return t(i,r)}}))}var v=n("vsh_79828"),g=n("vsh_83248"),_=n("vsh_57181"),y=n("vsh_8333"),m=n("vsh_7829"),E=n("vsh_26172"),b=n("vsh_7955"),T=(0,E.Z)((function(e,t){(0,m.Z)(t,(0,b.Z)(t),e)})),C=n("vsh_86982"),S=n("vsh_58881");function w(){return"_".concat(Math.random().toString(36).substr(2,9))}var R=S.Z.compose,A=S.Z.transform,O=S.Z.invert,M="__EXTERNAL_EVENT__";function k(e){return Object.assign({type:"__DEFAULT_TYPE__",force:null,undoable:!0},e)}function I(e){return e.type===M}function x(e){return!!e.undoable}var N=function(e){(0,o.XW)(n,e);var t=(0,o.WY)(n);function n(e){var r;return(0,o.PA)(this,n),(r=t.call(this)).undoCallbacks=new Set,r.redoCallbacks=new Set,r.do=r.pushEvent,r.autoCollecting=!1,r._updateTransformBaseFactory=function(e){return function(t){var n=e===a.M1.undo?r.getUndoStackTop():r.getRedoStackTop();n&&(n.transformBase=r._updateTransformBase(n,t))}},r.updateUndoTransformBase=r._updateTransformBaseFactory(a.M1.undo),r.updateRedoTransformBase=r._updateTransformBaseFactory(a.M1.redo),r._id=e,r}return(0,o.qH)(n,[{key:"id",get:function(){return this._id}},{key:"trigger",value:function(e,t){var n,r=e===a.M1.undo?this.undoCallbacks:this.redoCallbacks,i=(0,o.sf)(r);try{for(i.s();!(n=i.n()).done;){(0,n.value)(t)}}catch(e){i.e(e)}finally{i.f()}}},{key:"on",value:function(e,t){(e===a.M1.undo?this.undoCallbacks:this.redoCallbacks).add(t)}},{key:"pushEvent",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=k(e);return I(n)||!x(n)?(this._applyNonUndoableEvent(n),!0):(n.operations=O(n.operations),this._applyUndoableEvent(n,t))}},{key:"pushExternalEvent",value:function(e){return this.pushEvent({operations:e,type:M})}},{key:"_performUndoFactory",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._popStackFactory(e),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._getStackTopFactory(e),i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._pushStackFactory(this._getInverseUndoEventType(e));return function(){var o=n();if(!o)return null;var a,s=o.type,u=o.operations,l=o.transformBase,c=u;l&&(c=A(c,l,S.O.LEFT),a=A(l,c,S.O.RIGHT));var h=O(c);i({type:s,operations:h});var d=r();return a&&d&&(d.transformBase=R(d.transformBase||[],a)),t.trigger(e,c),c}}},{key:"_shouldComposeElement",value:function(e,t,n){return n!==a.i0.SPLIT&&!1!==t.undoable&&(!t.transformBase&&(n===a.i0.MERGE||e.type===t.type&&(n!==a.i0.AUTO||this.autoCollecting)))}},{key:"_composeElements",value:function(e,t){var n=e.type,r=e.transformBase;return{operations:R(e.operations,t.operations),type:n,transformBase:r}}},{key:"_applyUndoableEvent",value:function(e,t){var n,r=e.force,i={operations:(n=e).operations,type:n.type,undoable:n.undoable},o=this.getUndoStackTop(),a=!1;if(t&&o&&this._shouldComposeElement(i,o,r)){var s=this._composeElements(i,o);this._popUndoStack(),this._pushUndoStack(s),a=!0}else this._pushUndoStack(i),this.startAutoCollect();return this.clearRedoStack(),a}},{key:"startAutoCollect",value:function(){var e=this;this.autoCollecting||(this.autoCollecting=!0,setTimeout((function(){e.autoCollecting=!1})))}},{key:"_applyNonUndoableEvent",value:function(e){var t=this.getUndoStackTop(),n=this.getRedoStackTop(),r=e.operations;t&&(t.transformBase=this._updateTransformBase(t,r)),n&&(n.transformBase=this._updateTransformBase(n,r))}},{key:"_updateTransformBase",value:function(e,t){var n=e.transformBase;return R(n||[],t)}}],[{key:"create",value:function(e){return new n(e||w())}}]),n}(a.pt),P=n("vsh_90093"),L=function(){function e(){(0,o.PA)(this,e),this.loggable=!0;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this.prefix="[".concat(n.join("]["),"]")}return(0,o.qH)(e,[{key:"log",value:function(e,t){this.loggable&&console.log(this.prefix,e,t)}},{key:"enable",value:function(){this.loggable=!0}},{key:"disable",value:function(){this.loggable=!1}}]),e}(),D="__DataSDK__",F=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,o.PA)(this,e),this.undoDispatcher=P.T.create(),this.destroy=function(){n.record.destroy(),n.undoDispatcher.destroy()},this.getUndoDispatcher=function(){return n.undoDispatcher},this.undo=function(){return n.undoDispatcher.performUndo()},this.redo=function(){return n.undoDispatcher.preformRedo()},this.canUndo=function(){return n.undoDispatcher.canUndo},this.canRedo=function(){return n.undoDispatcher.canRedo},this.onDo=function(e){return n.undoDispatcher.onDo(e)},this.record=t,this.record.onChange(this._handleRecordChange.bind(this));var i=T({},this.record,this);return i.recursivelySetContext(i),this.logger=r.logger||new L("DataJS","Undoable"),this.register(),i}return(0,o.qH)(e,[{key:"handleUndoEventFactory",value:function(e){var t=this;return function(n){t.logger.log("dev_".concat(e),{opLen:n.length});var r=t.record.context||t.record;r.apply(n),r.triggerChange(e,n,{})}}},{key:"register",value:function(){var e=N.create(D);this.undoDispatcher.register(e),e.on(a.M1.undo,this.handleUndoEventFactory(a.M1.undo)),e.on(a.M1.redo,this.handleUndoEventFactory(a.M1.redo))}},{key:"setParentUndoDispatcher",value:function(e){this.getUndoDispatcher().parentUndoDispatcher=e}},{key:"_handleRecordChange",value:function(e){var t=e.type,n=e.detail,r=e.applyOptions;"COLLAB"===t&&n?this.undoDispatcher.do(D,{operations:n,external:!0}):t!==a.M1.redo&&t!==a.M1.undo&&this.undoDispatcher.do(D,Object.assign({operations:n},(0,C.Z)(r,["type","force","undoable"])))}}]),e}();var B=n("vsh_59980"),V=n("vsh_73565"),H=n.n(V);function U(e){var t="string"==typeof e?new Error("".concat("[DATA_SDK]:"," ").concat(e)):e;"Slardar"in window&&(0,window.Slardar)("Sentry",(function(e){e.captureException(t)}))}var Z,W,j,G,z,Y=S.Z.compose;!function(e){e.change="RECORD_CHANGE",e.clientVars="RECORD_CLIENTVARS",e.error="RECORD_ERROR"}(Z||(Z={})),function(e){e.set="SET",e.remove="REMOVE",e.move="MOVE",e.replaceString="REPLACE_STRING",e.apply="APPLY"}(W||(W={})),function(e){e.local="LOCAL",e.collab="COLLAB"}(j||(j={})),function(e){e.warn="WARN",e.error="ERROR"}(G||(G={})),function(e){e[e.PermissionError=4]="PermissionError"}(z||(z={}));var X=function(){function e(t){var n=this;(0,o.PA)(this,e),this._em=new(H()),this.setClientVars=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:j.local,r=e.initData;try{n._node=new S.Z(null,r),n.triggerClientVarsEvent(t,e)}catch(e){console.log("setClientVars error",e,e&&e.message),U("setClientVars error, ".concat(e&&e.message)),n.error(e)}},this.getRecord=function(){return n.record},this.set=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.afterApply;try{var o=n._node,a=e.reduce((function(e,t){return Y(e,o.set(t.path,t.value))}),[]);"function"==typeof i&&i(a),n.triggerChange(W.set,a,r),t=a}catch(e){n.error(e)}return t},this.move=function(e,t){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=i.afterApply;try{var a=n._node,s=a.move(e,t);"function"==typeof o&&o(s),n.triggerChange(W.set,s,i),r=s}catch(e){n.error(e)}return r},this.get=function(e){var t;try{t=n._node.get(e)}catch(t){n.warn(t),console.warn("Path '".concat(e,"' does not exist."))}return t},this.has=function(e){var t=n.getSnapshot();return void 0!==(0,B.default)(t,e.join("."))},this.remove=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.afterApply;try{var o=n._node,a=e.reduce((function(e,t){return Y(e,o.remove(t))}),[]);"function"==typeof i&&i(a),n.triggerChange(W.set,a,r),t=a}catch(e){n.error(e)}return t},this.replaceString=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.afterApply,i=[];try{var o=n._node,a=e.reduce((function(e,t){var n=t.path,r=t.start,i=t.deleteCount,a=t.insertStr;return console.log(e,n,r,i,a),Y(e,o.replaceString(n,r,i||0,a))}),[]);"function"==typeof r&&r(a),n.triggerChange(W.set,a,t),i=a}catch(e){n.error(e)}return i},this.getSnapshot=function(){return n._node.getSnapshot()},this.destroy=function(){n._node=new S.Z(null,{}),n._em.removeEvent(Z.change),n._em.removeEvent(Z.error)},this.onChange=function(e){n._em.on(Z.change,e)},this.removeChangeListener=function(e){n._em.off(Z.change,e)},this.onClientVars=function(e){n._em.on(Z.clientVars,e)},this.removeClientVarsListener=function(e){n._em.off(Z.clientVars,e)},this.onError=function(e){n._em.on(Z.error,e)},this.removeErrorListener=function(e){n._em.off(Z.error,e)},this.triggerChange=function(e,t,r){var i={type:e,detail:t,applyOptions:r};n._em.trigger(Z.change,[i])},this.triggerClientVarsEvent=function(e,t){n._em.trigger(Z.clientVars,[{type:e,detail:t}])},this.error=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n._recordEventFactory(Z.error,G.error);console.error("error occur",e),t(e)},this.warn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n._recordEventFactory(Z.error,G.warn);console.error("warning occur",e),t(e)},this.apply=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.afterApply;try{n._node.apply(e),"function"==typeof r&&r(e)}catch(e){n.error(e)}return e},this.applyToBase=this.apply,this.recursivelySetContext=function(e){for(var t=e.record;t;)t.context=e,t=t.record};var r=t.initData,i=t.logger,a=t.namespace;this._node=new S.Z(null,r||{}),this.logger=i||new L(a||"DataJS")}return(0,o.qH)(e,[{key:"getEventEmitter",value:function(){return this._em}},{key:"_recordEventFactory",value:function(e,t){var n=this;return function(r){n._em.trigger(e,[{type:t,detail:r}])}}}],[{key:"create",value:function(t){return new e({initData:t})}}]),e}(),K=n("vsh_43369"),q=n("vsh_96636"),$=n("vsh_70098"),J=n("vsh_47253"),Q=n("vsh_22023"),ee=n("vsh_89049"),te=n("vsh_11967"),ne=n("vsh_46016"),re=n("vsh_31630"),ie=n("vsh_68133"),oe=function(e){var t=e.api,n=e.addonReqParam;return n&&t.includes("/client_vars")?{ext:JSON.stringify({share_token:null==n?void 0:n.shareToken})}:n},ae=n("vsh_10839"),se=n("vsh_79680"),ue=n("vsh_46775"),le=n("vsh_65949");function ce(e){return"object"===(0,o.Ac)(e)&&null!==e&&"function"==typeof e.then}function he(e){return new Promise((function(t){setTimeout((function(){t()}),e)}))}var de=function(){function e(t){var n=this,r=t.io,i=t.type,a=t.token,s=t.alias,u=t.requestMessageOptions,l=t.requestDataOptions,c=t.requestWatchDataOptions,h=t.requestExceptWatchHeaderOptions,d=t.request,f=t.requestAPI,p=t.isNewProtocol,v=t.hasSpecificVersion,g=t.registerChannels,_=t.logger,m=t.fetchMissWait,E=void 0===m?1e3:m,b=t.isCollaborative,T=t.addonReqParam;(0,o.PA)(this,e),this._expected_version=1,this._version=1,this._receiveClientVars=!1,this._em=new(H()),this._channelMessageMap=new Map,this._isFetching=!1,this._userChangesCounter=0,this._isNewProtocol=!1,this._needPauseSync=!1,this._latestVersion=1,this.tryHandleError=function(e,t){var r=e.data,i=e.request_id;if(r.type===y.u.ERROR){var o=r.code,a=r.msg;n._log("client_sb_sync_error_dev",{code:o,requestType:t,msg:a,requestId:i,newProtocol:"0"}),n.emit(y.u.ERROR,Object.assign(Object.assign({},r),{type:se.T.RESPONSE_ERROR,requestType:t}))}return e},this.tryHandleErrorV2=function(e,t,r){var i=e.code,o=e.msg;return i!==y.GL.SUCCESS&&(n._log("client_sb_sync_error_dev",{code:i,requestType:t,msg:o,newProtocol:"1"}),!r&&n.emit(y.u.ERROR,Object.assign(Object.assign({},e),{type:se.T.RESPONSE_ERROR,requestType:t}))),r?Promise.resolve(e):Promise.reject(e)},this.fetchMissVersionFromCurrentToLatest=function(){n._version>=n._latestVersion||n.fetchMissVersion((0,ne.Z)(n._version+1,n._latestVersion+1))},this.handleMessageFromServer=function(e){if(!e.data)return n.emit(y.u.MESSAGE,e),e;if(function(e){var t=e.data,n=t.type;if("RESPONSE"===n||n===y.u.ENGAGEMENT_CURSOR||n===y.u.CLIENT_VARS&&"gzip_snapshot"in t)return;if(n===y.u.ERROR)return void console.error("received!",n,t.code,t.msg,e.request_id,e);console.log("received!",n,t.new_rev||t.revision||t.note_revision,e.request_id,e)}(e),!n.verifyMessage(e))return n.emit(y.u.MESSAGE,e),e;var t=e.data;switch(t.type){case n.NEW_CHANGES:n.handleNewChanges(t);break;case y.u.ACCEPT_COMMIT:n.handleAcceptCommit(t);break;default:n.handleChannelMessage(t)}return n.emit(y.u.MESSAGE,e),e},this.handleAcceptWatch=function(e){var t=e.data.entities,r=n._version;n.emit(y.u.ACCEPT_WATCH);var i,a=(0,o.sf)(t);try{for(a.s();!(i=a.n()).done;){var s=i.value,u=s.type,l=s.token,c=s.version;if(u===n._syncType&&l===n._token)return void(c&&c>r&&n.fetchMissVersionWithLimitingFrequency(c))}}catch(e){a.e(e)}finally{a.f()}},this.handleNewChanges=function(e){if(e.over_size){var t=n.getVersionOfOversize(e);return n._log("client_sb_sync_new_changes_oversize_dev",{version:t,rev:n.version}),t<=n._version?void n._log("client_sb_sync_new_changes_oversize_return_dev"):void n.fetchMissVersionWithLimitingFrequency(t)}var r=e.create_time;r&&n.emit(y.u.UPDATE_TIME,r);var i=n.getChangesets(e);if(n._log("client_sb_sync_new_changes_dev",{rev_list:i.map((function(e){return n.getVersionOfChangeset(e)})).join(","),rev:n._version}),i.length)if(i.sort((function(e,t){return n.getVersionOfChangeset(e)-n.getVersionOfChangeset(t)})),n.getVersionOfChangeset(i[0])>n._version+1){var a=i[i.length-1],s=n.getVersionOfChangeset(a);n.fetchMissVersionWithLimitingFrequency(s)}else{var u,l=(0,o.sf)(i);try{for(l.s();!(u=l.n()).done;){var c=u.value,h=n.getVersionOfChangeset(c);if(!(h<=n._version)){if(h>n._version+1)break;var d=n.version;if(n._version=h,n._expected_version=h,n.syncEngineBaseRev(n._version),n.isSelfChangeset(c))return n._log("client_sb_sync_new_changes_ack_dev",{rev:n.version}),void n.emit(y.u.ACCEPT_COMMIT,c);n._log("client_sb_sync_emit_new_changes_dev",{oldVersion:d,rev:n.version}),n.emit(y.u.NEW_CHANGES,c)}}}catch(e){l.e(e)}finally{l.f()}}},this.handleAcceptCommit=function(e){var t=n.getVersionOfAcceptCommit(e);n._log("client_sb_sync_ack_dev",{rev:t,local_rev:n._version});var r=n._version;t===r+1?(n._version=t,n._expected_version=t,n.syncEngineBaseRev(n._version),n.emit(y.u.ACCEPT_COMMIT,e)):t>r&&n.fetchMissVersionWithLimitingFrequency(t)},this.fetchMissVersionFromCurrentToLatest=(0,J.default)(this.fetchMissVersionFromCurrentToLatest,E),this._isCollaborative=b,this._addonReqParam=T,this._io=r,this._syncType=i,this._token=a,this._alias=s,this._requestMessageOptions=u||{},this._requestDataOptions=l||{},this._requestWatchDataOptions=c||{},this._requestExceptWatchHeaderOptions=h||{},this._request=d,this._requestAPI=f,this._isNewProtocol=Boolean(p),this._needPauseSync=Boolean(v),this._channels=g?g(this):{};for(var C=function(){var e=w[S];e.messageTypes&&Array.from(e.messageTypes).forEach((function(t){n._channelMessageMap.set(t,e)}))},S=0,w=Object.values(this.channels);S<w.length;S++)C();this._loggerOptions={sync_type:this._syncType,sync_token:(0,ae.p)(this._token),requestLogId:""},this._logger=_||new L("DataJS","Sync",i),!1!==this._isCollaborative&&this.registerEntity()}var t,n,r,i,a,s,u,l;return(0,o.qH)(e,[{key:"_log",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._logger.log(e,Object.assign(Object.assign({},this._loggerOptions),t))}},{key:"NEW_CHANGES",get:function(){return this._alias&&this._alias[y.u.NEW_CHANGES]||y.u.NEW_CHANGES}},{key:"CLIENT_VARS",get:function(){return this._alias&&this._alias[y.u.CLIENT_VARS]||y.u.CLIENT_VARS}},{key:"registerEntity",value:(l=(0,o.x)((0,o.l5)().mark((function e(){var t,n,r,i,a=this;return(0,o.l5)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={interval:1,callback:function(e){var t=a._version;e<=t||(console.log("engine: local: ".concat(t,", remote: ").concat(e)),!a._needPauseSync&&a.fetchMissVersionWithLimitingFrequency(e))}},n=Object.values(this.channels).reduce((function(e,t){var n=t.channel,r=t.heartbeat;return n&&r?Object.assign(Object.assign({},e),(0,o._x)({},n,r)):e}),(0,o._x)({},y.bS.ENGINE_CHANNEL,t)),r=this.generateWatchEntity(),i={handler:this.handleMessageFromServer,filter:r},e.next=6,Promise.resolve(this._io.isEntityRegistered(r));case 6:e.sent?(this._io.addHeartbeat(r,y.bS.ENGINE_CHANNEL,t),this._io.addMessage(r,y.bS.ENGINE_CHANNEL,i)):this._io.register(r,{message:i,heartbeats:n,acceptWatchHandler:this.handleAcceptWatch,isNewHeartbeatsProtocol:this._isNewProtocol});case 8:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"generateWatchEntity",value:function(){return Object.assign(Object.assign({type:this._syncType,token:this._token},this._requestDataOptions),this._requestWatchDataOptions)}},{key:"syncEngineBaseRev",value:function(e){this.syncBaseRev("engine_channel",e)}},{key:"syncBaseRev",value:function(e,t){this._receiveClientVars&&this._io.setHeartbeatVersion({type:this._syncType,token:this._token},e,t)}},{key:"verrifyFetchMiss",value:function(e,t){return t[0]===e[0]}},{key:"fetchMissVersionWithLimitingFrequency",value:function(e){e>this._latestVersion&&(this._latestVersion=e),this.fetchMissVersionFromCurrentToLatest()}},{key:"fetchMissVersion",value:function(e){var t=this;if(this._receiveClientVars){if(!this._isFetching){var n=e[0],r=e[e.length-1];if(r-n>this.missVersionLimit)return this._log("client_sb_sync_fetch_missing_version_too_old_dev"),void this.emit(y.u.ERROR,{type:se.T.RESPONSE_ERROR,msg:"version too old",code:y.GL.VERSION_TOO_OLD,requestType:y.u.NEW_CHANGES,options:{firstVersion:n,lastVersion:r,missVersionLimit:this.missVersionLimit}});if(0!==e.length){if(this._isFetching=!0,this._isNewProtocol&&this._request&&this._requestAPI){this._log("client_sb_sync_fetch_missing_dev",{rev_list:e.join(","),version:this._version,newProtocol:"1"});var i=this._requestAPI.NEW_CHANGES;return this.autoRetryRequestDoNotRelyOnIO(this._requestAPI.NEW_CHANGES,"post",Object.assign({member_id:this.memberId,token:this._token,rev_list:e},this._addonReqParam)).then((function(n){var r=n.data,i=t.getChangesets(r);if(i){var o=i.sort((function(e,n){return t.getVersionOfChangeset(e)-t.getVersionOfChangeset(n)})).map((function(e){return t.getVersionOfChangeset(e)}));t.verrifyFetchMiss(e,o)?(fe("NEW_CHANGES",n),t.handleNewChanges(r)):(t._log("client_sb_sync_fetch_missing_verrify_failed_dev",{version:t._version,fetching_list:e,fetched_verion:o}),t.emit(y.u.ERROR,{code:y.GL.MISSING_VERSION_VERIFY_FAILED,type:se.T.CLIENT_ERROR,msg:"fetched missing version verrified failed",options:{send:e,receive:o}}))}else t._log("client_sb_sync_fetch_missing_no_changes_dev")})).catch((function(e){return t.tryHandleErrorV2(e,i)})).finally((function(){t._log("client_sb_sync_fetch_missing_end_dev",{rev_list:e.join(","),version:t._version,newProtocol:"1"}),t._isFetching=!1}))}return this._log("client_sb_sync_fetch_missing_dev",{rev_list:e.join(","),version:this._version,newProtocol:"0"}),this.autoRetryRequest({type:this.NEW_CHANGES,member_id:this.memberId,token:this._token,rev_list:e},re.ChannelState.http).then((function(e){return t.tryHandleError(e,y.u.NEW_CHANGES)})).then((function(n){var r=n.data,i=t.getChangesets(r);if(i){var o=i.sort((function(e,n){return t.getVersionOfChangeset(e)-t.getVersionOfChangeset(n)})).map((function(e){return t.getVersionOfChangeset(e)}));t.verrifyFetchMiss(e,o)?t.handleMessageFromServer(n):(t._log("client_sb_sync_fetch_missing_verrify_failed_dev",{version:t._version,fetching_list:e,fetched_verion:o}),t.emit(y.u.ERROR,{code:y.GL.MISSING_VERSION_VERIFY_FAILED,type:se.T.CLIENT_ERROR,msg:"fetched missing version verrified failed",options:{send:e,receive:o}}))}else t._log("client_sb_sync_fetch_missing_no_changes_dev")})).finally((function(){t._log("client_sb_sync_fetch_missing_end_dev",{rev_list:e.join(","),version:t._version,newProtocol:"0"}),t._isFetching=!1}))}this._log("client_sb_sync_fetch_missing_versions_is_empty_dev",{version:this._version})}}else this._log("client_sb_sync_fetch_missing_before_client_vars_dev")}},{key:"verifyMessage",value:function(e){return e.type===this._syncType&&(e.data&&e.data.type===y.u.ERROR?e.token===this._token:e.data&&e.data.token===this._token)}},{key:"autoRetryRequestDoNotRelyOnIO",value:(u=(0,o.x)((0,o.l5)().mark((function e(t,n,r){var i,a,s,u=arguments;return(0,o.l5)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=u.length>3&&void 0!==u[3]?u[3]:0,this._loggerOptions.requestLogId=(0,ie.M)(),e.prev=2,e.next=5,this._request({url:t,method:n,headers:Object.assign({"Content-Type":"application/json","X-TT-LOGID":this._loggerOptions.requestLogId},this._requestExceptWatchHeaderOptions),data:Object.assign(Object.assign({},r),this._requestDataOptions)});case 5:if((a=e.sent).code===y.GL.SUCCESS){e.next=8;break}throw a;case 8:return e.abrupt("return",a);case 11:if(e.prev=11,e.t0=e.catch(2),s=e.t0&&e.t0.code,!(i<=0)){e.next=17;break}throw console.error("[sync] error response when io reject"),e.t0;case 17:if(void 0!==s&&s!==y.GL.SERVICE_ERROR&&s!==y.GL.DATABASE_CONFLICT&&s!==y.GL.CONNECT_ABORT&&s!==y.GL.CONNECT_ERROR&&s!==y.GL.TIMEOUT){e.next=25;break}return e.next=20,he(3/i*1e3);case 20:return this._log("client_sb_sync_request_retry_since_code_dev",{retry:i,url:t,res_code:e.t0.code,rev:this.version}),console.warn("[sync] retry request by server code"),e.abrupt("return",this.autoRetryRequestDoNotRelyOnIO(t,"post",r,i-1));case 25:throw console.error("[sync] error response with error code",e.t0.code),e.t0;case 27:case"end":return e.stop()}}),e,this,[[2,11]])}))),function(e,t,n){return u.apply(this,arguments)})},{key:"autoRetryRequest",value:(s=(0,o.x)((0,o.l5)().mark((function e(t){var n,r,i,a=arguments;return(0,o.l5)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:re.ChannelState.http,r=a.length>2&&void 0!==a[2]?a[2]:0,e.prev=2,e.next=5,this._io.request(Object.assign({type:this._syncType,data:Object.assign(Object.assign({},t),this._requestDataOptions)},this._requestMessageOptions),{channel:n});case 5:if(i=e.sent,!(r<=0)){e.next=8;break}return e.abrupt("return",i);case 8:if(i.code!==y.GL.SERVICE_ERROR&&i.data.code!==y.GL.SERVICE_ERROR&&i.data.code!==y.GL.DATABASE_CONFLICT){e.next=14;break}return e.next=11,he(3/r*1e3);case 11:return this._log("client_sb_sync_request_retry_since_code_dev",{retry:r,res_code:i.code,data_code:i.data.code,rev:this.version}),console.warn("[sync] retry request by server code"),e.abrupt("return",this.autoRetryRequest(t,re.ChannelState.http,r-1));case 14:e.next=26;break;case 16:if(e.prev=16,e.t0=e.catch(2),!(r<=0)){e.next=21;break}throw console.error("[sync] error response when io reject"),e.t0;case 21:return e.next=23,he(3/r*1e3);case 23:return this._log("client_sb_sync_request_retry_since_reject_dev",{retry:r,rev:this.version}),console.warn("[sync] retry request by net error"),e.abrupt("return",this.autoRetryRequest(t,re.ChannelState.http,r-1));case 26:return e.abrupt("return",i);case 27:case"end":return e.stop()}}),e,this,[[2,16]])}))),function(e){return s.apply(this,arguments)})},{key:"handleChannelMessage",value:function(e){var t=e.type,n=this._channelMessageMap.get(t);if(n){var r=n.getVersionOfChannelMessage,i=n.channel,o=n.refetchMessageIfVersionBreak;if(r&&i){var a=r(e),s=(this.io.getHeartbeatInfo(this.syncType,this.token)||{})[i].version;s&&a>s+1&&o?o(s,a):this.syncBaseRev(i,a)}n.onChannelMessage&&n.onChannelMessage(e)}}},{key:"emit",value:function(e,t){this._em.emit(e,t)}},{key:"on",value:function(e,t){this._em.on(e,t)}},{key:"off",value:function(e,t){this._em.off(e,t)}},{key:"version",get:function(){return this._version}},{key:"expectedVersion",get:function(){return this._expected_version}},{key:"memberId",get:function(){return"".concat(this._io.getMemberId())}},{key:"token",get:function(){return this._token}},{key:"io",get:function(){return this._io}},{key:"channels",get:function(){return this._channels}},{key:"syncType",get:function(){return this._syncType}},{key:"receiveClientVars",get:function(){return this._receiveClientVars}},{key:"setClientVars",value:function(e){this.handleClientVars(e)}},{key:"fetchClientVarsByVersion",value:(a=(0,o.x)((0,o.l5)().mark((function e(t){var n,r,i,a,s,u=this;return(0,o.l5)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._log("client_sb_fetch_client_vars_dev",{rev:t,isByVersion:"1",newProtocol:"1"}),!(t<0)&&this._requestAPI){e.next=3;break}return e.abrupt("return");case 3:return n=this._requestAPI.CLIENT_VARS_BY_VERSION,r="".concat(n,"?revision=").concat(t,"&token=").concat(this._token),e.next=7,this.autoRetryRequestDoNotRelyOnIO(r,"get",{token:this._token,member_id:this.memberId},3).catch((function(e){return u.tryHandleErrorV2(e,r)}));case 7:if((i=e.sent).code===y.GL.SUCCESS){e.next=11;break}return console.error("fetchClientVars failed: ",i.data),e.abrupt("return",Promise.reject(i.data));case 11:return a=i.data,s=this.getVersionOfClientVars(a),this.handleClientVars(s),e.abrupt("return",a);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"fetchClientVars",value:(i=(0,o.x)((0,o.l5)().mark((function e(){var t,n,r,i,a,s,u,l,c,h=this,d=arguments;return(0,o.l5)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=d.length>0&&void 0!==d[0]?d[0]:{},!(this._isNewProtocol&&this._request&&this._requestAPI)){e.next=31;break}if(this._log("client_sb_fetch_client_vars_dev",{isByVersion:"0",newProtocol:"1"}),n="false",r=function(){var e=(0,o.x)((0,o.l5)().mark((function e(){var n;return(0,o.l5)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h._requestAPI.CLIENT_VARS,e.next=3,h.autoRetryRequestDoNotRelyOnIO(n,"post",Object.assign(Object.assign({token:h._token,member_id:h.memberId},oe({api:n,addonReqParam:h._addonReqParam})),t),3).catch((function(e){var t=e.code,r=e.msg;return h._log("ccm_bitable_dashboard_error_dev",{from:"template",requestInterface:n,code:t,stack:new Error(null!=r?r:"").stack,detail:JSON.stringify(r),message:"".concat(r)}),h.tryHandleErrorV2(e,n)}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),i=null,!this._requestAPI.GET_CLIENT_VAS_FROM_WINDOW||"function"!=typeof this._requestAPI.GET_CLIENT_VAS_FROM_WINDOW){e.next=10;break}try{i=this._requestAPI.GET_CLIENT_VAS_FROM_WINDOW(this._token),n=Boolean(i)?"true":"false"}catch(e){i=null,this._log("ccm_bitable_dashboard_error_dev",{from:"template",requestInterface:"fetchClientVars",stack:e.stack,detail:JSON.stringify(e),message:"".concat(e)})}e.next=20;break;case 10:if(!this._requestAPI.RACE_CLIENT_VARS_FROM_TEMP_AND_IO||"function"!=typeof this._requestAPI.RACE_CLIENT_VARS_FROM_TEMP_AND_IO){e.next=20;break}return e.prev=11,e.next=14,Promise.race([this._requestAPI.RACE_CLIENT_VARS_FROM_TEMP_AND_IO(this._token).then((function(e){return n="true",e})).catch((function(e){return h._log("ccm_bitable_dashboard_error_dev",{from:"template",requestInterface:"fetchClientVars",stack:e.stack,detail:JSON.stringify(e),message:"".concat(e)}),null})),r()]);case 14:i=e.sent,e.next=20;break;case 17:e.prev=17,e.t0=e.catch(11),i=null;case 20:if(i){e.next=24;break}return e.next=23,r();case 23:i=e.sent;case 24:if(i.code===y.GL.SUCCESS){e.next=27;break}return console.error("fetchClientVars failed: ",i.data),e.abrupt("return",Promise.reject(i.data));case 27:return a=i.data,s=this.getVersionOfClientVars(a),this.handleClientVars(s),e.abrupt("return",(0,te.Z)(a,"haveTemplateData",n));case 31:return this._log("client_sb_fetch_client_vars_dev",{isByVersion:"0",newProtocol:"0"}),e.next=34,this.autoRetryRequest(Object.assign(Object.assign({type:this.CLIENT_VARS,token:this._token,member_id:this.memberId},oe({api:this.CLIENT_VARS,addonReqParam:this._addonReqParam})),t),re.ChannelState.http,3).then((function(e){return h.tryHandleError(e,y.u.CLIENT_VARS)}));case 34:if((u=e.sent).data.type!==y.u.ERROR){e.next=38;break}return console.error("fetchClientVars failed: ",u.data),e.abrupt("return",Promise.reject(u.data));case 38:return l=u.data,c=this.getVersionOfClientVars(l),this.handleClientVars(c),e.abrupt("return",l);case 42:case"end":return e.stop()}}),e,this,[[11,17]])}))),function(){return i.apply(this,arguments)})},{key:"handleClientVars",value:function(e){var t=this;this._log("client_sb_handle_client_vars_dev",{version:e}),this._receiveClientVars=!0,this._version=e,this._expected_version=e,this.syncEngineBaseRev(this._version);var n=this.generateWatchEntity();this._requestWatchDataOptions.banWatch||this._io.watch(n,{isNewProtocol:this._isNewProtocol}).catch((function(e){t._log("client_sb_watch_failed_dev"),t.emit(y.u.ERROR,Object.assign(Object.assign({},e),{type:se.T.RESPONSE_ERROR,requestType:y.u.WATCH}))}))}},{key:"onLocalChangeStart",value:function(){this._expected_version++}},{key:"sendUserChange",value:function(e){var t=this;if(this._isNewProtocol&&this._request&&this._requestAPI){this._log("client_sb_user_changes_dev",{local_rev:this._version,rev:this._version+1,newProtocol:"1"});var n=this._requestAPI.USER_CHANGES,r=n.includes("?")?"&":"?",i=this._userChangesCounter++;return this.emit(y.u.USER_CHANGES_START,i),this.autoRetryRequestDoNotRelyOnIO("".concat(n).concat(r,"token=").concat(this._token),"post",Object.assign({token:this._token,type:y.u.USER_CHANGES,member_id:this.memberId},e),3).then((function(e){var n=e.data;fe("ACCEPT_COMMIT",e),t.handleAcceptCommit(n),t.emit(y.u.MESSAGE,e),t.emit(y.u.USER_CHANGES_END,{userChangesId:i,data:e,success:!0})})).catch((function(e){return t._expected_version=t._version,t.emit(y.u.USER_CHANGES_END,{userChangesId:i,data:e,success:!1}),t.tryHandleErrorV2(e,n)}))}return this._log("client_sb_user_changes_dev",{local_rev:this._version,rev:this._version+1,newProtocol:"0"}),this.autoRetryRequest(Object.assign({token:this._token,type:y.u.USER_CHANGES,member_id:this.memberId},e),re.ChannelState.socket,3).then((function(e){return t.tryHandleError(e,y.u.USER_CHANGES)})).then(this.handleMessageFromServer)}},{key:"getBlockReferenceCount",value:(r=(0,o.x)((0,o.l5)().mark((function e(){var t,n,r,i,a;return(0,o.l5)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null===(t=this._requestAPI)||void 0===t?void 0:t.GET_REFERENCE_COUNT){e.next=3;break}return e.abrupt("return");case 3:return r={token:this._token},e.prev=4,i="".concat(n,"?token=").concat(this._token),e.next=8,this.autoRetryRequestDoNotRelyOnIO(i,"get",r,2);case 8:return a=e.sent,e.abrupt("return",a.data);case 12:return e.prev=12,e.t0=e.catch(4),e.abrupt("return",this.tryHandleErrorV2(e.t0,y.u.GET_REFERENCE_COUNT,!0));case 15:case"end":return e.stop()}}),e,this,[[4,12]])}))),function(){return r.apply(this,arguments)})},{key:"getBlockReference",value:(n=(0,o.x)((0,o.l5)().mark((function e(){var t,n,r,i,a;return(0,o.l5)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null===(t=this._requestAPI)||void 0===t?void 0:t.GET_REFERENCE){e.next=3;break}return e.abrupt("return");case 3:return r={token:this._token},e.prev=4,i="".concat(n,"?token=").concat(this._token),e.next=8,this.autoRetryRequestDoNotRelyOnIO(i,"get",r,2);case 8:return a=e.sent,e.abrupt("return",a.data);case 12:return e.prev=12,e.t0=e.catch(4),e.abrupt("return",this.tryHandleErrorV2(e.t0,y.u.GET_REFERENCE,!0));case 15:case"end":return e.stop()}}),e,this,[[4,12]])}))),function(){return n.apply(this,arguments)})},{key:"delBlockReference",value:(t=(0,o.x)((0,o.l5)().mark((function e(t,n){var r,i,a,s;return(0,o.l5)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=null===(r=this._requestAPI)||void 0===r?void 0:r.DEL_REFERENCE){e.next=3;break}return e.abrupt("return");case 3:return a={token:this._token,fromObjToken:t,fromObjType:n},e.prev=4,e.next=7,this.autoRetryRequestDoNotRelyOnIO(i,"post",a,2);case 7:return s=e.sent,e.abrupt("return",s);case 11:return e.prev=11,e.t0=e.catch(4),e.abrupt("return",this.tryHandleErrorV2(e.t0,y.u.DEL_REFERENCE,!0));case 14:case"end":return e.stop()}}),e,this,[[4,11]])}))),function(e,n){return t.apply(this,arguments)})},{key:"destroy",value:function(){var e,t;null===(t=(e=this.fetchMissVersionFromCurrentToLatest).cancel)||void 0===t||t.call(e);var n=this.generateWatchEntity();this._io.removeMessage(n,y.bS.ENGINE_CHANNEL),this._io.removeHeartbeat(n,y.bS.ENGINE_CHANNEL),this._io.unRegister(n),this._em.removeEvent()}}]),e}();function fe(e,t){var n=t.data;console.log("received!",e,n.new_rev||n.revision||n.note_revision,t)}var pe=function(e){(0,o.XW)(n,e);var t=(0,o.WY)(n);function n(e){var r;return(0,o.PA)(this,n),(r=t.call(this,Object.assign(Object.assign({},e),{requestAPI:{CLIENT_VARS:"/api/json/client_vars",CLIENT_VARS_BY_VERSION:"",NEW_CHANGES:"/api/json/new_changes",USER_CHANGES:"/api/json/user_changes"}}))).missVersionLimit=ee.g.getSyncMissversionThreshold(),r}return(0,o.qH)(n,[{key:"getVersionOfOversize",value:function(e){return e.version}},{key:"getVersionOfChangeset",value:function(e){return e.version}},{key:"getChangesets",value:function(e){return e.ops}},{key:"getVersionOfClientVars",value:function(e){return e.version}},{key:"getVersionOfAcceptCommit",value:function(e){return e.version}},{key:"isSelfChangeset",value:function(e){return"".concat(e.member_id)===this.memberId}}]),n}(de),ve=S.Z.transform,ge=S.Z.invert,_e=S.Z.compose;function ye(e){return e.map((function(e){return e.ops}))}function me(e,t){return e.length!==t.length?[]:e.map((function(e,n){return Object.assign(Object.assign({},t[n]),{ops:e})}))}function Ee(e,t,n){var r=n,i=n===S.O.LEFT?S.O.RIGHT:S.O.LEFT,o=e,a=t.map((function(e){var t=ve(e,o,i);return o=ve(o,e,r),t}));return{tBase:o,tList:a}}function be(e,t){for(var n=e,r=t.length-1;r>=0;r--)n=ve(n,ge(t[r]),S.O.LEFT);return n}function Te(e,t){var n=e,r=Ee(ge(n[t].ops),ye(n.slice(t+1)),S.O.RIGHT),i=r.tList,a=r.tBase;return{tOps:n=[].concat((0,o.u)(n.slice(0,t)),(0,o.u)(me(i,n.slice(t+1)))),tBase:a}}function Ce(e,t){var n=e,r=n[t],i=be(r.ops,ye(n.slice(0,t))),a=Te(n,t),s=a.tOps,u=a.tBase;n=s;var l=S.O.RIGHT,c=S.O.LEFT,h=Ee(i,ye(n.slice(0,t)),l),d=h.tList,f=Ee(h.tBase,ye(n.slice(t)),c),p=f.tList,v=f.tBase;return{tOps:n=[].concat((0,o.u)(me(d,n.slice(0,t))),(0,o.u)(me(p,n.slice(t)))),tBase:_e(u,v),head:[Object.assign(Object.assign({},r),{ops:i})]}}function Se(e){var t,n=(0,o.sf)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!r.action||!r.action.oi&&!r.action.od)return!1}}catch(e){n.e(e)}finally{n.f()}return!0}function we(e,t){for(var n=[],r=[],i=e,a=(i=function(e){return e.reduce((function(e,t){var n=t.ops.map((function(e){return Object.assign(Object.assign({},t),{ops:[e]})}));return[].concat((0,o.u)(e),(0,o.u)(n))}),[])}(i)).length-1;a>=0;a--){if(i[a].tid===t)if(Se(i[a].ops)){var s=Re(i,t,a),u=s.tOps,l=s.tBase,c=s.head;i=u,r=_e(r,l),n=c}}for(var h=0;h<i.length;h++){if(i[h].tid===t)if(!Se(i[h].ops)){var d,f=Ce(i,h),p=f.tOps,v=f.tBase,g=f.head;i=p,r=_e(r,v),(d=n).push.apply(d,(0,o.u)(g)),h--}}return{tOps:i,head:n,tBase:r}}function Re(e,t,n){var r,i,a,s=e,u=!1,l=s[n],c=l.ops,h=function(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=e.ops,o=r,a=r-1;a>=0;a--){if(t[a].tid===n&&Se(t[a].ops)){o=a;break}i=ve(i,ge(t[a].ops),S.O.LEFT)}return{tBase:i,nearIndex:o}}(l,s,t,n);if(r=h.tBase,a=h.nearIndex,n!==h.nearIndex)i=_e(s[a].ops,r);else{if(0===n)return{tOps:s.slice(n+1),tBase:[],head:[Object.assign(Object.assign({},l),{ops:r})],nearIndex:a};i=r,u=!0}u&&(a=-1,i=r=be(c,ye(s.slice(0,n))));var d=Te(s,n),f=d.tOps,p=d.tBase,v=Ee(r,ye((s=f).slice(a+1,n)),S.O.LEFT),g=v.tList,_=Ee(v.tBase,ye(s.slice(n)),S.O.RIGHT),y=_.tList,m=_.tBase;return{tOps:s=u?[].concat((0,o.u)(me(g,s.slice(a+1,n))),(0,o.u)(me(y,s.slice(n)))):[].concat((0,o.u)(s.slice(0,a)),[Object.assign(Object.assign({},l),{ops:i})],(0,o.u)(me(g,s.slice(a+1,n))),(0,o.u)(me(y,s.slice(n)))),tBase:_e(p,m),head:[Object.assign(Object.assign({},l),{ops:r})],nearIndex:a}}var Ae,Oe=S.Z.compose,Me=S.Z.invert,ke=S.Z.transform;!function(e){e.cancel="TRANSACTION_CANCEL",e.submit="TRANSACTION_SUBMIT"}(Ae||(Ae={}));var Ie=function(){function e(t,n){var r=this;(0,o.PA)(this,e),this.tid=t,this.context=n,this.remove=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.context.remove(r.tid,e,t)}}return(0,o.qH)(e,[{key:"set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.context.set(this.tid,e,t)}},{key:"move",value:function(e,t,n){this.context.move(this.tid,e,t,n)}},{key:"cancel",value:function(){this.context.cancel(this.tid)}},{key:"submit",value:function(e,t){this.context.submit(this.tid,e,t)}}]),e}(),xe=function(){function e(t){var n=this;(0,o.PA)(this,e),this.syncRecord=t,this.transactions=new Map,this.tOps=[],this.set=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.syncRecord.getCoreRecord(),o=i.set(t,r);o&&n.pushTransactionOp({tid:e,ops:o,options:r})},this.move=function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=n.syncRecord.getCoreRecord(),a=o.move(t,r,i);a&&n.pushTransactionOp({tid:e,ops:a,options:i})},this.cancel=function(e){var t=function(e,t){for(var n=[],r=e,i=r.length-1;i>=0;i--)if(r[i].tid===t){var o=Te(r,i),a=o.tOps,s=o.tBase;r=a,n=_e(n,s)}return{tOps:r,tBase:n}}(n.tOps,e),r=t.tOps,i=t.tBase,o=n.syncRecord.getCoreRecord();n.tOps=r,o.apply(i),n.transactions.delete(e),o.triggerChange(Ae.cancel,i)},this.submit=function(e,t,r){var i=n.syncRecord.context||n.syncRecord.record||n.syncRecord;if(t)return n.cancel(e),void i.set(t,r||{});var o=n.syncRecord.getCoreRecord(),a=we(n.tOps,e),s=a.tOps,u=a.head,l=Me(n.getComposedTransactionOps());n.syncRecord.getCoreRecord().apply(l),u.forEach((function(e){var t=e.ops,n=e.options;i.applyToBase(t,n)})),n.tOps=s;var c=n.getComposedTransactionOps();n.syncRecord.getCoreRecord().apply(c),o.triggerChange(Ae.submit,n.getComposedTransactionOps(u))},this.remove=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.syncRecord.getCoreRecord(),o=i.remove(t,{});o&&n.pushTransactionOp({tid:e,ops:o,options:r})}}return(0,o.qH)(e,[{key:"findLastIndexOfTransaction",value:function(e){for(var t=this.tOps,n=t.length-1;n>=0&&t[n].tid!==e;)n--;return n}},{key:"pushTransactionOp",value:function(e){var t=e.tid,n=e.ops,r=e.options,i=this.tOps,o=this.syncRecord.getCoreRecord(),s=n;if(r.force===a.i0.REPLACE){var u=this.findLastIndexOfTransaction(t);if(u>=0){var l=Te(i,u),c=l.tOps,h=l.tBase;this.tOps=c,s=ke(n,h,S.O.LEFT),o.apply(Oe(Oe(Me(n),h),s))}}else if(r.force===a.i0.MERGE){var d=i[i.length-1];Boolean(d)&&d.tid===t&&(r.force===a.i0.MERGE||r.type===d.options.type&&r.force!==a.i0.SPLIT)&&(i.pop(),s=Oe(d.ops,n))}this.tOps.push({ops:s,tid:t,options:r})}},{key:"startTransaction",value:function(e){var t=this.set,n=this.cancel,r=this.submit,i=this.move,o=this.transactions,a=this.remove,s=e||w(),u=o.get(s);if(u)return console.warn("Transaction ".concat(e," is already start")),u;var l=new Ie(s,{set:t,cancel:n,submit:r,move:i,remove:a});return o.set(s,l),l}},{key:"transform",value:function(e){var t=this.tOps,n=Ee(e,t.map((function(e){return e.ops})),S.O.RIGHT),r=n.tList,i=n.tBase;return t.forEach((function(e,t){e.ops=r[t]})),i}},{key:"getOperations",value:function(){return ye(this.tOps)}},{key:"getComposedTransactionOps",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.tOps,t=ye(e),n=[];return t.forEach((function(e){n=Oe(n,e)})),n}},{key:"destroy",value:function(){this.transactions.clear(),this.tOps=[]}}]),e}(),Ne=function(){function e(t){var n=this;(0,o.PA)(this,e),this._members=new Map,this.handleUserNewInfo=function(e){var t=e.entities,r=(0,le.__rest)(e,["entities"]),i=(0,B.default)(t,"users",{}),o=Object.assign(r,i[r.user_id]),a=o.member_id;n._members.has(a)||n._members.set(a,o)},this.handleUserLeave=function(e){e.member_id.forEach((function(e){n._members.delete(e)}))},this.handleMembersMessage=function(e){var t=n.assignMemberInfo(e,e.members);n._members=new Map(t.map((function(e){return[e.member_id,e]})))},t.on(y.u.USER_NEWINFO,this.handleUserNewInfo),t.on(y.u.USER_LEAVE,this.handleUserLeave),t.on(y.u.ROOM_MEMBERS,this.handleMembersMessage)}return(0,o.qH)(e,[{key:"members",get:function(){return this._members}},{key:"assignMemberInfo",value:function(e,t){var n=(0,B.default)(e,"entities.users",{}),r=(0,o.u)(t);return r.map((function(e){return Object.assign(Object.assign({},e),n[e.suid||e.user_id])})),r}}]),e}(),Pe=n("vsh_96792"),Le=n("vsh_29729"),De={maxTaskNumber:20},Fe=function(){function e(t){var n=this;(0,Le.PA)(this,e),this._runningCount=0,this._pendingTaskQueue=[],this._createTask=function(e,t,r,i){return function(){n._runningCount++,e.apply(void 0,(0,Le.u)(t)).then(r).catch(i).finally((function(){if(n._runningCount--,n._pendingTaskQueue.length){var e=n._pendingTaskQueue.shift();e&&e()}}))}},this.config=Object.assign({},De,t||{})}return(0,Le.qH)(e,[{key:"addTask",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return new Promise((function(n,i){var o=t._createTask(e,r,n,i);if(!(t._runningCount>=t.config.maxTaskNumber))return o();t._pendingTaskQueue.push(o)}))}}]),e}(),Be=new Fe({maxTaskNumber:ee.g.getSyncMaxRequestNumber()});function Ve(){var e=(new Date).getTime();return"".concat("xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})),"-").concat(e)}var He,Ue=function(){function e(t,n){var r=this,i=n.fetchMemberList,a=n.shouldFetchMemberList;(0,o.PA)(this,e),this.sync=t,this._em=new(H()),this.handleAcceptWatch=function(){r.fetchRoomMembers()},this.refetchMessageIfVersionBreak=function(e,t){t<=e+1||r.shouldFetchMemberList&&!1===r.shouldFetchMemberList()||r.fetchRoomMembers()},this.fetchMemberList=i,this.shouldFetchMemberList=a,t.on(y.u.ACCEPT_WATCH,this.handleAcceptWatch)}return(0,o.qH)(e,[{key:"messageTypes",get:function(){return new Set([y.u.USER_LEAVE,y.u.USER_NEWINFO,y.u.ROOM_MEMBERS])}},{key:"channel",get:function(){return"member_channel"}},{key:"heartbeat",get:function(){var e=this;return{interval:1,callback:function(t,n){t<=n||(console.log("oldVersion: ".concat(n,", newVersion: ").concat(t)),e.fetchRoomMembers())}}}},{key:"getVersionOfChannelMessage",value:function(e){return e.version}},{key:"fetchRoomMembers",value:function(){var e=this;return this.fetchMemberList().then((function(t){var n=t.data,r=n.version;e.setHeartbeatVersion(r),e.emit(y.u.ROOM_MEMBERS,n)}))}},{key:"setHeartbeatVersion",value:function(e){this.sync.io.setHeartbeatVersion({type:this.sync.syncType,token:this.sync.token},this.channel,e)}},{key:"onChannelMessage",value:function(e){switch(e.type){case y.u.USER_NEWINFO:this.emit(y.u.USER_NEWINFO,e);break;case y.u.USER_LEAVE:this.emit(y.u.USER_LEAVE,e)}}},{key:"on",value:function(e,t){this._em.on(e,t)}},{key:"off",value:function(e,t){this._em.off(e,t)}},{key:"emit",value:function(e,t){this._em.emit(e,t)}}]),e}();(0,le.__decorate)([function(e,t,n){var r=n.value,i=(0,le.__rest)(n,["value"]);if(!(0,ue.default)(r))return n;var o=new Map;return Object.assign(Object.assign({},i),{value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t[0]||He,a=o.get(i);if(!a){var s=r.call.apply(r,[this].concat(t));return ce(s)?(o.set(i,!0),s.then((function(e){return o.delete(i),e})).catch((function(e){throw o.delete(i),e}))):console.error("should return an Promise")}}})}],Ue.prototype,"fetchRoomMembers",null);var Ze,We,je=function(){function e(){(0,o.PA)(this,e),this._em=new(H())}return(0,o.qH)(e,[{key:"messageTypes",get:function(){return new Set([y.u.ENGAGEMENT_CURSOR])}},{key:"onChannelMessage",value:function(e){this.emit(y.u.ENGAGEMENT_CURSOR,e)}},{key:"on",value:function(e,t){this._em.on(e,t)}},{key:"off",value:function(e,t){this._em.off(e,t)}},{key:"emit",value:function(e,t){this._em.emit(e,t)}}]),e}(),Ge=S.Z.compose,ze=S.Z.transform,Ye=S.Z.invert;!function(e){e.userChange="USER_CHANGE",e.submittedChange="SUBMITTED_CHANGE",e.operationComposed="OPERATION_COMPOSED"}(Ze||(Ze={})),function(e){e.unsubmit="UNSUBMITTED",e.submitted="SUBMITTED"}(We||(We={}));var Xe="member",Ke="cursor";var qe=(0,s.wi)(),$e=function(e){var t=e.toLowerCase();return{CLIENT_VARS:"/api/v2/sheet/blocks/".concat(t,"/snapshot"),CLIENT_VARS_BY_VERSION:"/api/v2/sheet/blocks/".concat(t,"/history/"),NEW_CHANGES:"/api/v2/sheet/blocks/".concat(t,"/cs"),USER_CHANGES:"/api/v2/sheet/blocks/".concat(t,"/user_change/"),GET_REFERENCE:"/api/v2/sheet/blocks/".concat(t,"/getReference"),GET_REFERENCE_COUNT:"/api/v2/sheet/blocks/".concat(t,"/getReferenceCount"),DEL_REFERENCE:"/api/v2/sheet/blocks/".concat(t,"/deleteReference")}};function Je(e,t,n){e.getSync()._requestAPI=(0,r.Z)($e(t),n(t))}var Qe=function(){function e(){(0,o.PA)(this,e),this.destroyed$=new v.t(1),this.changeable=!0,this.token=(0,u.z)(),this.record=this.initRecord(),this.listenRecord()}return(0,o.qH)(e,[{key:"setRequest",value:function(e){this.request=e}},{key:"initRecord",value:function(){return e=new X({}),new F(e,t);var e,t}},{key:"getSnapshot",value:function(){return this.record.getSnapshot()}},{key:"setSnapshot",value:function(e){this.record.setClientVars({initData:e})}},{key:"get",value:function(e){return this.record.get(e)}},{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.changeable){var n=this.record.apply(e,Object.assign({force:a.i0.AUTO},t));return this.record.triggerChange(t.changeEventType||W.apply,e,Object.assign({force:a.i0.AUTO},t)),n}return[]}},{key:"set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.record.set(e,Object.assign({force:a.i0.AUTO},t))}},{key:"insert",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new g.Z1({token:"MODEL",get:function(e){return t.get(e)}});e.forEach((function(e){return r.insert(e.path,e.value)})),this.apply(r.ops,n)}},{key:"move",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.record.move(e,t,Object.assign({force:a.i0.AUTO},n))}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.record.remove(e,Object.assign({force:a.i0.AUTO},t))}},{key:"getRecord",value:function(){return this.record}},{key:"destroy",value:function(){console.trace("Model destroy"),this.record.destroy(),this.destroyed$.next()}},{key:"undo",value:function(){this.record.undo()}},{key:"redo",value:function(){this.record.redo()}},{key:"canUndo",value:function(){return this.record.getUndoDispatcher().canUndo}},{key:"canRedo",value:function(){return this.record.getUndoDispatcher().canRedo}},{key:"listenRecord",value:function(){var e=this;this.didUpdate$=p((function(t){return e.record.onChange(t)}),(function(t){return e.record.removeChangeListener(t)}));var t=new v.t(1);this.clientVarsReady$=t,p((function(t){return e.record.onClientVars(t)}),(function(t){return e.record.removeClientVarsListener(t)})).subscribe(t),this.error$=p((function(t){return e.record.onError(t)}),(function(t){return e.record.removeErrorListener(t)})).pipe((0,_.d)(1)),this.error$.subscribe((function(e){console.error("Record error",e)}))}}]),e}(),et=function(e){(0,o.XW)(n,e);var t=(0,o.WY)(n);function n(e){var r,a,s,u=e.token,l=e.type,c=e.io,h=e.syncType,d=e.request,f=e.apiConfig,p=e.eventTracking,v=e.specificVersion,g=e.modifyUserChangePayloadBeforeSend,_=e.isCollaborative,m=e.banWatch,E=e.addonReqParam,b=e.translate;return(0,o.PA)(this,n),(r=t.call(this)).fetchClientVars=(a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r.getRecord().fetchClientVars(e)},s=null,function(){return s||(s=a.apply(void 0,arguments))}),r.fetchClientVarsByVersion=function(e){return r.getRecord().fetchClientVarsByVersion(e)},r.awaitAndGetClientVars=r.fetchClientVars,r.getNextUserChangesResult=function(){var e=r.record.getSync();return new Promise((function(t,n){e.on(y.u.USER_CHANGES_START,(function r(i){e.off(y.u.USER_CHANGES_START,r);e.on(y.u.USER_CHANGES_END,(function r(o){var a=o.userChangesId,s=o.data,u=o.success;a===i&&(e.off(y.u.USER_CHANGES_END,r),u?t(s):n(s))}))}))}))},r.isCollaborative=_,r.banWatch=Boolean(m),r.addonReqParam=E,r.type=l,r.syncType=h||l,r.token=u,r.io=c,r.specificVersion=(0,i.default)(v)?v:-1,r.request=d,r.translate=b,r.record=r.makeSynchronous(c,d,r.record,p,g,b),Je(r.getRecord(),r.type,f||$e),r}return(0,o.qH)(n,[{key:"updateRequestAPI",value:function(e){Je(this.getRecord(),this.type,e||$e)}},{key:"hasSpecificVersion",value:function(){return(0,i.default)(this.specificVersion)&&-1!==this.specificVersion}},{key:"getRecord",value:function(){return this.record}},{key:"getSync",value:function(){return this.record.getSync()}},{key:"destroy",value:function(){console.trace("Model destroy"),this.record.destroy(),this.destroyed$.next()}},{key:"makeSynchronous",value:function(e,t,n,r,i,a){var s=this,u=function(e,t){var n=function(){function t(n,r){var i=this;(0,o.PA)(this,t),this.operation=[],this._operationCbs=[],this.submitted=[],this._submittedCbs=[],this.transactionManager=new xe(this),this._unhandledCollabEvents=[],this._collab=!0,this._em=new(H()),this.userChangeUuid="",this.submittedUuid="",this.retryTimes=0,this._onCollection=!1,this.startTransaction=function(e){return i.transactionManager.startTransaction(e)},this.setClientVars=function(e){var t=e.initData,n=e.version;i.record.setClientVars({initData:t}),i.setUserOperation([]),i.setSubmittedOperation([]),i._operationCbs=[],i._submittedCbs=[],i._sync&&i._sync.setClientVars(n)},this.fetchClientVarsByVersion=function(e){if(i._sync)return Be.addTask(i._sync.fetchClientVarsByVersion.bind(i._sync),e).then((function(e){return i._clientVarsHandler(e)}))},this.fetchClientVars=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(i._sync)return Be.addTask(i._sync.fetchClientVars.bind(i._sync),e).then((function(e){return i._clientVarsHandler(e)}))},this.getBlockReference=(0,o.x)((0,o.l5)().mark((function e(){return(0,o.l5)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i._sync){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",Be.addTask(i._sync.getBlockReference.bind(i._sync)));case 3:case"end":return e.stop()}}),e)}))),this.getBlockReferenceCount=(0,o.x)((0,o.l5)().mark((function e(){return(0,o.l5)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i._sync){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",Be.addTask(i._sync.getBlockReferenceCount.bind(i._sync)));case 3:case"end":return e.stop()}}),e)}))),this.delBlockReference=function(){var e=(0,o.x)((0,o.l5)().mark((function e(t,n){return(0,o.l5)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i._sync){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",Be.addTask(i._sync.delBlockReference.bind(i._sync),t,n));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this._clientVarsHandler=function(){var t=(0,o.x)((0,o.l5)().mark((function t(n){var r,a,s,u,l,c;return(0,o.l5)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=2;break}return t.abrupt("return");case 2:if(a=(r=n).snapshot,s=r.update_time,u=r.haveTemplateData,l=void 0===u?String(!1):u,n=(0,K.default)(n,"haveTemplateData"),!a){t.next=16;break}t.prev=5,c=JSON.parse(a),i._token&&Pe.O.getInstance().updateTime(i._token,s),t.next=14;break;case 10:return t.prev=10,t.t0=t.catch(5),U(t.t0),t.abrupt("return",Promise.reject(new Error("Fail to JSON.parse:".concat(a))));case 14:t.next=17;break;case 16:c=(0,B.default)(n,["data","data"]);case 17:return c=i._applyExtraChangesets(c,n),t.next=20,i._translateTitle(c);case 20:return c=t.sent,e.setClientVars({initData:c,haveTemplateData:l},j.collab),t.abrupt("return",n);case 23:case"end":return t.stop()}}),t,null,[[5,10]])})));return function(e){return t.apply(this,arguments)}}(),this._applyExtraChangesets=function(e,t){if(!t||!Array.isArray(t.changesets)||t.changesets.length<1)return e;var n=new S.Z(null,e),r=t.changesets,i=[];return r.forEach((function(e){var t=e.content;try{var r=JSON.parse(t);r&&Array.isArray(r.operations)&&(n.apply(r.operations),i.push.apply(i,(0,o.u)(r.operations)))}catch(e){console.error(e)}})),n.getSnapshot()},this._translateTitle=function(){var e=(0,o.x)((0,o.l5)().mark((function e(t){var n,r,a,s,u,l,c,h,d,f,p,v,g,_,y,m,E,b,T,C,S,w,R,A,O,M,k,I,x,N,P,L,D,F,B,V,H,Z,W,j,G,z,Y,X,K,q;return(0,o.l5)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.translate){e.next=2;break}return e.abrupt("return",t);case 2:if(e.prev=2,R=(null===(n=null==t?void 0:t.viewModel)||void 0===n?void 0:n.rules)||{},A=R.plotArea,O=R.xyAxes,M=R.waterfall,k=[],I=[null===(r=null==A?void 0:A.title)||void 0===r?void 0:r.text,null===(a=null==A?void 0:A.subTitle)||void 0===a?void 0:a.text,null===(l=null===(u=null===(s=null==O?void 0:O.detail)||void 0===s?void 0:s.index0)||void 0===u?void 0:u.title)||void 0===l?void 0:l.text,null===(d=null===(h=null===(c=null==O?void 0:O.detail)||void 0===c?void 0:c.value0)||void 0===h?void 0:h.title)||void 0===d?void 0:d.text,null===(v=null===(p=null===(f=null==O?void 0:O.detail)||void 0===f?void 0:f.value1)||void 0===p?void 0:p.title)||void 0===v?void 0:v.text],x=(null===(g=null==M?void 0:M.all)||void 0===g?void 0:g.titleText)||{},N=[x.positive,x.negative,x.subtotal],P=Object.values((null===(_=null==M?void 0:M.all)||void 0===_?void 0:_.subtotals)||{})||[],L=[],P.forEach((function(e){L.push(null==e?void 0:e.alias)})),D=Object.values((null==M?void 0:M.series)||{})||[],F=[],B=[],V=[],D.forEach((function(e){var t=(null==e?void 0:e.titleText)||{};F.push.apply(F,[t.positive,t.negative,t.subtotal]);var n=(null==e?void 0:e.subtotals)||{};Object.values(n).forEach((function(e){B.push(e),V.push(null==e?void 0:e.alias)}))})),k.push.apply(k,(0,o.u)(I.filter(Boolean))),k.push.apply(k,(0,o.u)(N.filter(Boolean))),k.push.apply(k,(0,o.u)(L.filter(Boolean))),k.push.apply(k,(0,o.u)(V.filter(Boolean))),k.push.apply(k,(0,o.u)(F.filter(Boolean))),0!==k.length){e.next=24;break}return e.abrupt("return",t);case 24:return e.next=26,i.translate(k);case 26:if(H=e.sent){e.next=29;break}return e.abrupt("return",t);case 29:if((Z=function(e,t,n){if(e&&n){var r=H[n];r&&(e[t]=r)}})(null==A?void 0:A.title,"text",I[0]),Z(null==A?void 0:A.subTitle,"text",I[1]),Z(null===(m=null===(y=null==O?void 0:O.detail)||void 0===y?void 0:y.index0)||void 0===m?void 0:m.title,"text",I[2]),Z(null===(b=null===(E=null==O?void 0:O.detail)||void 0===E?void 0:E.value0)||void 0===b?void 0:b.title,"text",I[3]),Z(null===(C=null===(T=null==O?void 0:O.detail)||void 0===T?void 0:T.value1)||void 0===C?void 0:C.title,"text",I[4]),(null===(S=null==M?void 0:M.all)||void 0===S?void 0:S.titleText)&&(W=M.all.titleText,Z(W,"positive",N[0]),Z(W,"negative",N[1]),Z(W,"subtotal",N[2])),null===(w=null==M?void 0:M.all)||void 0===w?void 0:w.subtotals)for(j=0;j<P.length;j++)G=P[j],Z(G,"alias",L[j]);if(null==M?void 0:M.series){for(z=0;z<D.length;z++)Y=D[z],X=Y.titleText,Z(X,"positive",F[3*z+0]),Z(X,"negative",F[3*z+1]),Z(X,"subtotal",F[3*z+2]);for(K=0;K<B.length;K++)q=B[K],Z(q,"alias",V[K])}return e.abrupt("return",t);case 41:return e.prev=41,e.t0=e.catch(2),U(e.t0),e.abrupt("return",t);case 45:case"end":return e.stop()}}),e,null,[[2,41]])})));return function(t){return e.apply(this,arguments)}}(),this.set=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(){var n=(0,o.x)((0,o.l5)().mark((function n(r){return(0,o.l5)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i.record.set(e,Object.assign(Object.assign({},t),{afterApply:function(e){return i.afterApply(e,r,t)}}));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())},this.move=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(function(){var r=(0,o.x)((0,o.l5)().mark((function r(a){return(0,o.l5)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,i.record.move(e,t,Object.assign(Object.assign({},n),{afterApply:function(e){return i.afterApply(e,a,n)}}));case 2:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())},this.remove=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(){var n=(0,o.x)((0,o.l5)().mark((function n(r){return(0,o.l5)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.record.remove(e,Object.assign(Object.assign({},t),{afterApply:function(e){return i.afterApply(e,r,t)}}));case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())},this.replaceString=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(n){i.record.replaceString(e,Object.assign(Object.assign({},t),{afterApply:function(e){return i.afterApply(e,n,t)}}))}))},this.afterApply=function(e,t,n){var r=i.transactionManager,o=i.getCoreRecord();o.apply(Ge(Ye(e),Ye(r.getComposedTransactionOps())));var a=be(e,r.getOperations());return n.afterApply&&n.afterApply(a),r.transform(a),o.apply(Ge(a,r.getComposedTransactionOps())),a&&i._enqueueUpdateTask(a,t.bind(i,a)),a},this.apply=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i._onCollection||(i._onCollection=!0,i._sync.onLocalChangeStart()),new Promise(function(){var n=(0,o.x)((0,o.l5)().mark((function n(r){var a,s,u;return(0,o.l5)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=i.transactionManager.getComposedTransactionOps(),s=Ye(a),i.getCoreRecord().apply(s),n.next=5,i.record.apply(e,Object.assign(Object.assign({},t),{afterApply:function(e){t.afterApply&&t.afterApply(e),i.transactionManager.transform(e);var n=i.transactionManager.getComposedTransactionOps();i.getCoreRecord().apply(n)}}));case 5:(u=n.sent)&&i._enqueueUpdateTask(u,r.bind(i,u));case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())},this.applyToBase=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i.record.applyToBase(e,t),i._enqueueUpdateTask(e)},this.pauseSync=function(){i._collab=!1},this.resumeSync=function(){i._collab=!0;for(var e=i._unhandledCollabEvents,t=e.length,n=0;n<t;n+=1)i._onCollabChange(e[n]);i._unhandledCollabEvents=[],i.syncChanges()},this.retrySync=function(){i._sync&&i.submitted.length&&i.sendUserChange(i.submitted,i.submittedUuid)},this.throttleRetrySync=(0,J.default)((function(){if(i._sync&&i.submitted.length){if(i.retryTimes>=3)return void i.record.error({type:se.T.CLIENT_ERROR,code:y.GL.RETRY_OVER_TIMES,msg:"data-sdk retry over times"});i.retryTimes++,i.retrySync()}}),8e3),this.destroy=function(){i.transactionManager.destroy(),i.record.destroy(),i.setUserOperation([]),i.userChangeUuid="",i.setSubmittedOperation([]),i.submittedUuid="",i._operationCbs=[],i._submittedCbs=[],i._sync.destroy(),i._unhandledCollabEvents=[],i._collab=!0},this.handleNewChanges=function(e){var t=e.op.operations,n=i.submitted,r=Ge([],t||[]),o=ze(r,n,S.O.RIGHT),a=ze(n,r,S.O.LEFT);a&&a.length>0?i.setSubmittedOperation(a):(i.setSubmittedOperation([]),i._notifyCbs(We.submitted));var s=Ge([],i.operation),u=s;(s=ze(u,o,S.O.LEFT))&&s.length>0?i.setUserOperation(s):(i.setUserOperation([]),i._notifyCbs(We.unsubmit));var l=ze(o,u,S.O.RIGHT);l=i.transactionManager.transform(l),i._translateTitleOpt(l).then((function(e){i.record.apply(e),i._triggerRecordCollabChange(e)}))},this.handlecceptCommit=function(){i.retryTimes=0,i.setSubmittedOperation([]),i._notifyCbs(We.submitted)},this.onOperationComposed=function(e){i._em.on(Ze.operationComposed,e)},this.removeOperationComposedListener=function(e){i._em.off(Ze.operationComposed,e)},this.onUserOpChange=function(e){i._em.on(Ze.userChange,e)},this.removeUserOpChangeListener=function(e){i._em.off(Ze.userChange,e)},this.onSubmittedOpChange=function(e){i._em.on(Ze.submittedChange,e)},this.removeSubmittedOpChangeListener=function(e){i._em.off(Ze.submittedChange,e)},this.getSync=function(){return i._sync};var a=r.token,s=r.io,u=r.type,l=r.logger,c=r.tenant_id,h=r.extraMessages,d=r.version,f=r.initData,p=r.resourceType,v=r.routeKey,g=r.routeType,_=r.request,m=r.isCollaborative,E=r.banWatch,b=r.addonReqParam,C=r.translate;this.modifyUserChangePayloadBeforeSend=r.modifyUserChangePayloadBeforeSend,this.record=n,this.translate=C,this._token=a;var w=new Set(h);this._sync=new pe({isCollaborative:m,addonReqParam:b,token:a,io:s,type:u||y.rG.JSON,logger:null!=l?l:p?new L("DataJS","Sync",u||y.rG.JSON,p):new L("DataJS","Sync",u||y.rG.JSON),requestDataOptions:Object.assign({tenant_id:c},{resource_type:p}),requestWatchDataOptions:{route_type:g,route_key:v,banWatch:E},requestExceptWatchHeaderOptions:{"route-key":v,"route-type":g},request:_,isNewProtocol:r.isNewProtocol,hasSpecificVersion:r.hasSpecificVersion,registerChannels:function(e){var t={};return w.has(Xe)&&(t.member=new Ue(e,{fetchMemberList:function(){return e.autoRetryRequest({type:y.u.MESSAGE_CHANNEL,token:e.token,name:y.bS.MEMBER_CHANNEL,member_id:e.memberId})}})),w.has(Ke)&&(t.cursor=new je),t}}),w.has(Xe)&&(this.memberTracker=new Ne(this._sync.channels.member)),this._sync.on(y.u.NEW_CHANGES,(function(e){i._onCollabChange({type:y.u.NEW_CHANGES,data:e})})),this._sync.on(y.u.ACCEPT_COMMIT,(function(e){i._onCollabChange({type:y.u.ACCEPT_COMMIT,data:e})})),this._sync.on(y.u.ERROR,this._onCollabError.bind(this)),(0,$.Z)(d)||(0,$.Z)(f)||this.setClientVars({version:d,initData:f}),this.syncChanges=(0,q.default)(this._collectChanges,500);var R=T({},this.record,this);return R.recursivelySetContext(R),R}var n;return(0,o.qH)(t,[{key:"_isPlotAreaTitlePath",value:function(e){return"viewModel"===e[0]&&"rules"===e[1]&&"plotArea"===e[2]&&("title"===e[3]||"subTitle"===e[3])}},{key:"_isXYAxesTitlePath",value:function(e){return"viewModel"===e[0]&&"rules"===e[1]&&"xyAxes"===e[2]&&"detail"===e[3]&&("index0"===e[4]||"value0"===e[4]||"value1"===e[4])&&"title"===e[5]}},{key:"_isWaterfallTitlePath",value:function(e){return"viewModel"===e[0]&&"rules"===e[1]&&"waterfall"===e[2]&&(!e[3]||"all"===e[3]||"series"===e[3])}},{key:"_shouldTranslateOperation",value:function(e){var t;if(!(null===(t=e.action)||void 0===t?void 0:t.oi))return!1;var n=e.p;return this._isPlotAreaTitlePath(n)||this._isXYAxesTitlePath(n)||this._isWaterfallTitlePath(n)}},{key:"_extractTranslateData",value:function(e){var t,n,r,i,a,s,u=e.p,l=u[u.length-1],c=e.action;if(this._isPlotAreaTitlePath(u)||this._isXYAxesTitlePath(u)){var h="text"!==l,d=c.oi,f=h?null==d?void 0:d.text:d;return f?{operation:h?d:e,text:String(f),isAdd:h,key:h?"text":""}:null}if(!this._isWaterfallTitlePath(u))return null;var p="waterfall"===l,v="all"===l,g="all"===u[3]&&"titleText"===l,_="subtotals"===l,y="series"===l,m="series"===u[3]&&u[4]&&void 0===u[5],E="subtotals"===u[4]&&u[5]&&void 0===u[6],b="subtotals"===u[5]&&u[6]&&void 0===u[7],T=c.oi;if(!T)return null;var C=function(e){return{operation:e,text:String(e.alias),isAdd:!0,key:"alias"}},S=function(e){if(!e)return null;var t=["positive","negative","subtotal"].find((function(t){return e[t]}));return t?{operation:e,text:String(e[t]),isAdd:!0,key:t}:null};if(p){if(T.all)return T.all.titleText?S(T.all.titleText):(null===(t=T.all.subtotals)||void 0===t?void 0:t[0])?C(T.all.subtotals[0]):null;if(T.series){var w=Object.keys(T.series),R=(0,o.ZQ)(w,1)[0],A=T.series[R];return R&&A?A.titleText?S(A.titleText):(null===(n=A.subtotals)||void 0===n?void 0:n[0])?C(A.subtotals[0]):null:null}}if(_){var O=null===(r=Object.keys(T))||void 0===r?void 0:r[0];return O&&T[O]?C(T[O]):null}if(y){var M=Object.keys(T),k=(0,o.ZQ)(M,1)[0],I=T[k];return k&&I?I.titleText?S(I.titleText):(null===(i=I.subtotals)||void 0===i?void 0:i[0])?C(I.subtotals[0]):null:null}return v?(null===(a=T.subtotals)||void 0===a?void 0:a[0])?C(T.subtotals[0]):S(T.titleText):g?S(T):m?T.titleText?S(T.titleText):(null===(s=T.subtotals)||void 0===s?void 0:s[0])?C(T.subtotals[0]):null:E||b?C(T):"string"!=typeof T?null:{operation:e,text:T,isAdd:!1,key:""}}},{key:"_translateTitleOpt",value:(n=(0,o.x)((0,o.l5)().mark((function e(t){var n,r,i,a,s,u,l,c,h,d,f,p,v,g,_;return(0,o.l5)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.translate){e.next=2;break}return e.abrupt("return",t);case 2:n=[],r=(0,o.sf)(t),e.prev=4,r.s();case 6:if((i=r.n()).done){e.next=14;break}if(a=i.value,this._shouldTranslateOperation(a)){e.next=10;break}return e.abrupt("continue",12);case 10:(s=this._extractTranslateData(a))&&n.push(s);case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),r.e(e.t0);case 19:return e.prev=19,r.f(),e.finish(19);case 22:if(0!==n.length){e.next=24;break}return e.abrupt("return",t);case 24:return e.prev=24,u=n.map((function(e){return e.text})),e.next=28,this.translate(u);case 28:if(l=e.sent){e.next=31;break}return e.abrupt("return",t);case 31:c=0,h=n;case 32:if(!(c<h.length)){e.next=41;break}if(d=h[c],f=d.operation,p=d.text,v=d.isAdd,g=d.key,_=l[p]){e.next=37;break}return e.abrupt("continue",38);case 37:v?f[g]=_:f.action.oi=_;case 38:c++,e.next=32;break;case 41:return e.abrupt("return",t);case 44:return e.prev=44,e.t1=e.catch(24),console.error("Translation failed:",e.t1),U(e.t1),e.abrupt("return",t);case 49:case"end":return e.stop()}}),e,this,[[4,16,19,22],[24,44]])}))),function(e){return n.apply(this,arguments)})},{key:"getCoreRecord",value:function(){for(var e=this.record;e.record;)e=e.record;return e}},{key:"_ableToSync",value:function(){return this._collab}},{key:"_onCollabChange",value:function(e){if(this._ableToSync())switch(e.type){case y.u.NEW_CHANGES:this.handleNewChanges(e.data);break;case y.u.ACCEPT_COMMIT:this.handlecceptCommit();break;default:console.error("Unhandle collaborative event")}else this._unhandledCollabEvents.push(e)}},{key:"_onCollabError",value:function(e){this.record.error(e)}},{key:"_enqueueUpdateTask",value:function(e,t){var n=this.operation,r=Ge(n,e);this._sync&&(this.userChangeUuid=Ve()),this.setUserOperation(r),this._em.trigger(Ze.operationComposed,[e]),t&&this._operationCbs.push(t),this.syncChanges()}},{key:"_collectChanges",value:function(){if(this._ableToSync()&&this._sync){var e=!1;if(this.submitted.length&&(e=!0),e)this.throttleRetrySync();else{var t=this.operation;!e&&t.length&&(this.setUserOperation([]),this.submittedUuid=this.userChangeUuid,this.setSubmittedOperation(t),this._submittedCbs=this._operationCbs,this._operationCbs=[],this.sendUserChange(t,this.userChangeUuid))}}}},{key:"sendUserChange",value:function(e,t){var n;this._onCollection=!1;var r={content:{operations:e,valid:!0},uuid:t,version:this._sync.version+1};null===(n=this.modifyUserChangePayloadBeforeSend)||void 0===n||n.call(this,r),this._sync.sendUserChange(r)}},{key:"_notifyCbs",value:function(e){function t(e){var t=e.length;if(t)for(var n=0;n<t;n+=1)e[n]()}e===We.submitted&&(t(this._submittedCbs),this._submittedCbs=[]),e===We.unsubmit&&(t(this._operationCbs),this._operationCbs=[])}},{key:"_triggerRecordCollabChange",value:function(e){this.record.triggerChange("COLLAB",e)}},{key:"setUserOperation",value:function(e){this._sync&&!(0,Q.default)(e,this.operation)&&(this.operation=e,this._em.trigger(Ze.userChange,[{ops:e,version:this._sync.version,uuid:this.userChangeUuid}]))}},{key:"setSubmittedOperation",value:function(e){this._sync&&!(0,Q.default)(e,this.submitted)&&(this.submitted=e,this._em.trigger(Ze.submittedChange,[{ops:e,version:this._sync.version,uuid:this.submittedUuid}]))}}]),t}();return new n(e,t)}(n,Object.assign(Object.assign({type:this.syncType,token:this.token,io:e,isNewProtocol:!0,request:t,routeKey:this.token,routeType:"token",resourceType:this.type,logger:r&&{log:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(e,Object.assign(Object.assign({},n),{function_block_type:(null!==(t=s.type)&&void 0!==t?t:"").toLowerCase()}))}},hasSpecificVersion:this.hasSpecificVersion()},this.type===l.kH.DASHBOARD&&qe?{tenant_id:20}:{}),{modifyUserChangePayloadBeforeSend:i,isCollaborative:this.isCollaborative,banWatch:Boolean(this.banWatch),addonReqParam:this.addonReqParam,translate:a}));return this.hasSpecificVersion()&&u.pauseSync(),u}}]),n}(Qe),tt=et},vsh_74876:function(e,t,n){"use strict";n.d(t,{yh:function(){return f},mb:function(){return r},rg:function(){return p}});var r,i=n("vsh_93301"),o=n("vsh_26547"),a=n("vsh_68233"),s=n("vsh_83836"),u=n("vsh_22409"),l=n("vsh_80881"),c=n("vsh_96821"),h=n("vsh_90093"),d=n("vsh_48723");!function(e){e.Created="Created",e.Active="Active",e.Inactive="Inactive",e.Destroyed="Destroyed"}(r||(r={}));var f=function(){function e(t){(0,o.PA)(this,e),this.specificVersion=-1,this._state=r.Created,this._stateWatcher=new Set,this.model=t}var t,n,a,s,u,l;return(0,o.qH)(e,[{key:"hasSpecificVersion",value:function(){return(0,i.default)(this.specificVersion)&&-1!==this.specificVersion}},{key:"activate",value:(l=(0,o.x)((0,o.l5)().mark((function e(){var t,n,i;return(0,o.l5)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(![r.Active,r.Destroyed].includes(this.getState())){e.next=2;break}return e.abrupt("return");case 2:if(t=this.getState(),this._state=r.Active,t!==r.Created){e.next=9;break}return e.next=7,this.onFirstActive();case 7:e.next=11;break;case 9:return e.next=11,this.onReActive();case 11:return e.next=13,this.onActive();case 13:n=(0,o.sf)(this._stateWatcher);try{for(n.s();!(i=n.n()).done;)(0,i.value)(this.getState(),t)}catch(e){n.e(e)}finally{n.f()}case 15:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"inactivate",value:(u=(0,o.x)((0,o.l5)().mark((function e(){var t,n,i;return(0,o.l5)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(![r.Inactive,r.Destroyed].includes(this.getState())){e.next=2;break}return e.abrupt("return");case 2:return t=this.getState(),this._state=r.Inactive,e.next=6,this.onInactive();case 6:n=(0,o.sf)(this._stateWatcher);try{for(n.s();!(i=n.n()).done;)(0,i.value)(this.getState(),t)}catch(e){n.e(e)}finally{n.f()}case 8:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"destroy",value:function(){if(r.Destroyed!==this.getState()){var e=this.getState();this._state=r.Destroyed,this.onDestroy();var t,n=(0,o.sf)(this._stateWatcher);try{for(n.s();!(t=n.n()).done;){(0,t.value)(this.getState(),e)}}catch(e){n.e(e)}finally{n.f()}this._stateWatcher.clear()}}},{key:"getState",value:function(){return this._state}},{key:"getSnapshot",value:function(){return this.model&&this.model.getSnapshot()}},{key:"watchState",value:function(e){var t=this;if("function"!=typeof e)throw new Error("watcher must be a function");return this._stateWatcher.add(e),function(){return t._stateWatcher.delete(e)}}},{key:"onFirstActive",value:(s=(0,o.x)((0,o.l5)().mark((function e(){return(0,o.l5)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return s.apply(this,arguments)})},{key:"onReActive",value:(a=(0,o.x)((0,o.l5)().mark((function e(){return(0,o.l5)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})},{key:"onActive",value:(n=(0,o.x)((0,o.l5)().mark((function e(){return(0,o.l5)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"onInactive",value:(t=(0,o.x)((0,o.l5)().mark((function e(){return(0,o.l5)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{key:"onDestroy",value:function(){}}]),e}(),p=function(){function e(t){var n=this;(0,o.PA)(this,e),this._blockModelMap=new Map,this._blockModelRefCountMap=new Map,this._blockModelCtorMap=new Map,this.eventTracking=l.z0,this.t=c.g0,this.isModelInstanceReferenced=function(e){if(!n._blockModelRefCountMap.has(e))return!1;var t=n._blockModelRefCountMap.get(e);return(0,i.default)(t)&&t>0},this.increaseModelRefCount=function(e){var t=0;if(n._blockModelRefCountMap.has(e)){var r=n._blockModelRefCountMap.get(e);t=(0,i.default)(r)?r+1:1}else t=1;n._blockModelRefCountMap.set(e,t)},this.decreaseModelRefCount=function(e){var t=0;if(n._blockModelRefCountMap.has(e)){var r=n._blockModelRefCountMap.get(e);t=(0,i.default)(r)&&r>0?r-1:0}else t=0;n._blockModelRefCountMap.set(e,t)};var r=t.undoDispatcher,a=t.logger,s=t.t;this.undoDispatcher=r||h.T.create(),this.initParam=Object.assign({},t),a&&(this.eventTracking=a.eventTracking||l.z0),this.t=s||c.g0}return(0,o.qH)(e,[{key:"getRequest",value:function(){return this.initParam.request}},{key:"getIO",value:function(){return this.initParam.io}},{key:"getUndoDispatcher",value:function(){return this.undoDispatcher}},{key:"registerBlockModelCtor",value:function(e,t){var n=e.type;n?((0,a.Fv)(this._blockModelCtorMap,n,t)&&console.warn("BlockModel register again!",n,t),(0,a.P_)(this._blockModelCtorMap,n,t,e)):console.error("BlockModelCtor has no type")}},{key:"getBlockModelCtorByType",value:function(e,t){return(0,a.Fv)(this._blockModelCtorMap,e,t)}},{key:"createToken",value:function(e,t,n){var r=this.getBlockModelCtorByType(e,t);if(!r)throw new Error("no constructor");if(!r.createToken)throw new Error('no static method "createToken"');return r.createToken(n||{},{request:this.getRequest(),parentType:this.initParam.parentType,parentToken:this.initParam.parentToken,blockType:e})}},{key:"copyToken",value:function(e,t,n){var r=this.getBlockModelCtorByType(e,t);if(!r)throw new Error("no constructor");if(!r.copyToken)throw new Error('no static method "copyToken"');return r.copyToken(n||{},{request:this.getRequest()})}},{key:"createBlock",value:function(e){var t={parentType:this.initParam.parentType,parentToken:this.initParam.parentToken,snapshot:e.snapshot,source:0,type:e.type,dataType:e.dataType};if(e.dataType===d.g.STATIC){if(!e.staticData)throw new Error("need staticData!");t.staticData=e.staticData}if(e.dataType===d.g.THIRD_PARTY||e.type===s.kH.PIVOT_TABLE){if(!e.dataSource)throw new Error("need dataSource!");t.dataSource=[e.dataSource]}var n=e.circulationInfo&&this.getBlockModelCtorByType(e.type,e.circulationInfo);return((null==n?void 0:n.createBlock)||d.j4)(t,this.getRequest()).then((function(t){return{type:e.type,version:t.revision,token:t.token}}))}},{key:"createModel",value:function(e){var t=new u.Hn(Object.assign(Object.assign({},e),{request:this.getRequest(),io:this.getIO(),eventTracking:this.eventTracking}));return function(e,t){var n=e.getRecord();n.onDo((function(){console.log("record do",e.token),t.do(e.token)})),t.register({get id(){return e.token},undo:function(){n.undo()},redo:function(){n.redo()},clearRedoStack:function(){n.getUndoDispatcher().clearHistory()}}),e.destroyed$.subscribe((function(){t.unregister(e.token)}))}(t,this.undoDispatcher),t}},{key:"createBlockModel",value:function(e){var t=this,n=e.token,r=e.type,o=e.circulationInfo,a=e.instanceEventParams,s=e.translate,u=this.getBlockModelCtorByType(r,o);if(!u)return null;var l=(0,i.default)(e.specificVersion)?e.specificVersion:-1,c=new u(this.createModel({token:n,type:r,specificVersion:l,apiConfig:u.apiConfig,syncType:u.syncType,modifyUserChangePayloadBeforeSend:u.modifyUserChangePayloadBeforeSend,isCollaborative:null==e?void 0:e.isCollaborative,addonReqParam:null==e?void 0:e.addonReqParam,translate:s}),Object.assign(Object.assign({},e),{specificVersion:l,eventTracking:function(e,n){a&&(n=Object.assign(Object.assign({},n),a)),t.eventTracking(e,n)},t:this.t}));return this._blockModelMap.set(n,c),c}},{key:"getBlockModel",value:function(e){var t=this._blockModelMap.get(e);return t||(console.error("get block model by token:".concat(e," undefined")),null)}},{key:"destroyBlockModelByToken",value:function(e){var t=this.getBlockModel(e);t&&(this.isModelInstanceReferenced(e)||(t.destroy&&t.destroy(),this._blockModelMap.delete(e)))}},{key:"destroy",value:function(){var e,t=(0,o.sf)(this._blockModelMap.values());try{for(t.s();!(e=t.n()).done;){var n=e.value;n.destroy(),n&&n.model&&n.model.destroy&&n.model.destroy()}}catch(e){t.e(e)}finally{t.f()}this._blockModelCtorMap.clear()}}]),e}()},vsh_83248:function(e,t,n){"use strict";n.d(t,{Z1:function(){return d},OX:function(){return h},GG:function(){return c}});var r=n("vsh_85001"),i=n("vsh_22023"),o=n("vsh_71484"),a=n("vsh_93301"),s=n("vsh_26547"),u=n("vsh_58881");function l(e,t){return u.Z.compose(e,t)}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.filter((function(e){return!0}))}var h={insert:function(e,t){return 0===e.length||"string"==typeof e[e.length-1]?{p:e,action:{oi:t}}:{p:e,action:{li:t}}},remove:function(e,t){return 0===e.length||"string"==typeof e[e.length-1]?{p:e,action:{od:t}}:{p:e,action:{ld:t}}},replace:function(e,t,n){return 0===e.length||"string"==typeof e[e.length-1]?{p:e,action:{od:t,oi:n}}:{p:e,action:{ld:t,li:n}}},move:function(e,t){if(e.length>0&&t.length>0&&e.length===t.length&&(0,a.default)((0,o.Z)(e))&&(0,a.default)((0,o.Z)(t))&&(0,i.default)(e.slice(0,-1),t.slice(0,-1)))return{p:e,action:{lm:t[t.length-1]}};throw Error("ObjectMove Operation is not available now")}},d=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];(0,s.PA)(this,e),this._model=t,this._options=n,this._ops=r}return(0,s.qH)(e,[{key:"id",get:function(){return this._model.token}},{key:"model",get:function(){return this._model}},{key:"options",get:function(){return this._options}},{key:"ops",get:function(){return this._ops},set:function(e){this._ops=e}},{key:"append",value:function(e){this._ops=l(this._ops,(0,r.Z)(e)?e:[e])}},{key:"insert",value:function(e,t){return this.append(h.insert(e,t)),this}},{key:"remove",value:function(e){return this.append(h.remove(e,this.model.get(e))),this}},{key:"replace",value:function(e,t){return void 0===this.model.get(e)?this.append(h.insert(e,t)):this.append(h.replace(e,this.model.get(e),t)),this}},{key:"move",value:function(e,t){return this.append(h.move(e,t)),this}},{key:"clone",value:function(){return new e(this.model,this.options,this.ops.slice())}}]),e}()},vsh_90093:function(e,t,n){"use strict";n.d(t,{T:function(){return a}});var r=n("vsh_26547"),i=n("vsh_93631"),o=n("vsh_40658"),a=function(e){(0,r.XW)(n,e);var t=(0,r.WY)(n);function n(){var e;return(0,r.PA)(this,n),(e=t.apply(this,arguments)).onDo$=new i.xQ,e}return(0,r.qH)(n,[{key:"do",value:function(e,t){if(!t||!0!==t.external&&!1!==t.undoable)return(0,r.U2)((0,r.IP)(n.prototype),"do",this).call(this,e,t);this.updateTransformBase(t.operations)}},{key:"_updateTransformBaseFatcory",value:function(e){var t=this;return function(n){var r=e===o.M1.undo?t.stack.getUndoStackTop():t.stack.getRedoStackTop();if(r){var i=r.id;if(t.undoModules.has(i)){var a=t.undoModules.get(i);if(a){var s=a.updateUndoTransformBase,u=a.updateRedoTransformBase;s&&u&&(e===o.M1.undo?s(n):u(n))}}}}}},{key:"updateTransformBase",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._updateTransformBaseFatcory(o.M1.undo),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._updateTransformBaseFatcory(o.M1.redo);t(e),n(e)}},{key:"onDoNext",value:function(e){this.onDo$.next(e)}},{key:"onDo",value:function(e){this.onDo$.subscribe(e)}}],[{key:"create",value:function(){return new n}}]),n}(o.Tw)},vsh_8333:function(e,t,n){"use strict";var r,i,o,a,s,u;n.d(t,{rG:function(){return i},bS:function(){return a},u:function(){return o},GL:function(){return r}}),function(e){e.TIMEOUT="ECONNABORTED",e.CONNECT_ERROR="-8",e.CONNECT_ABORT="CONNECT_ABORT",e[e.SUCCESS=0]="SUCCESS",e[e.FAILED=1]="FAILED",e[e.INVALID_PARAM=2]="INVALID_PARAM",e[e.NOT_FOUND=3]="NOT_FOUND",e[e.FORBIDDEN=4]="FORBIDDEN",e[e.LOGIN_REQUIRED=5]="LOGIN_REQUIRED",e[e.LIMIT_EXCEED=6]="LIMIT_EXCEED",e[e.CHANGESET_LIMIT_EXCEED=1001]="CHANGESET_LIMIT_EXCEED",e[e.OBJECT_DELETED=1002]="OBJECT_DELETED",e[e.NOT_IN_SESSION=1003]="NOT_IN_SESSION",e[e.CHAGESET_INVALID=1005]="CHAGESET_INVALID",e[e.INTERNAL_ERROR=1006]="INTERNAL_ERROR",e[e.INVALID_MESSAGE=1007]="INVALID_MESSAGE",e[e.SYNC_FAILED=1008]="SYNC_FAILED",e[e.VERSION_TOO_OLD=1010]="VERSION_TOO_OLD",e[e.WRITE_PERMISSION_DENIED=1012]="WRITE_PERMISSION_DENIED",e[e.COMMENT_PERMISSION_DENIED=1013]="COMMENT_PERMISSION_DENIED",e[e.SERVICE_ERROR=1015]="SERVICE_ERROR",e[e.DATABASE_CONFLICT=1021]="DATABASE_CONFLICT",e[e.SERVER_BUSY=9998]="SERVER_BUSY",e[e.MISSING_VERSION_VERIFY_FAILED=-1101]="MISSING_VERSION_VERIFY_FAILED",e[e.RETRY_OVER_TIMES=-1102]="RETRY_OVER_TIMES",e[e.REFERENCE_NOT_EXIST=604144550]="REFERENCE_NOT_EXIST",e[e.REFERENCE_OP_ERR_NO_PERM=604144003]="REFERENCE_OP_ERR_NO_PERM",e[e.REFERENCE_OP_ERR_WRONG_PARAMS=604144001]="REFERENCE_OP_ERR_WRONG_PARAMS",e[e.REFERENCE_OP_ERR_WRONG_CHART_TYPE=604144514]="REFERENCE_OP_ERR_WRONG_CHART_TYPE"}(r||(r={})),function(e){e.JSON="JSON",e.MESSAGE_BOX="MESSAGE_BOX",e.DOC="DOC"}(i||(i={})),function(e){e.USER_NEWINFO="USER_NEWINFO",e.USER_LEAVE="USER_LEAVE",e.CLIENT_VARS="CLIENT_VARS",e.GET_VERSION="GET_VERSION",e.ENGAGEMENT_CURSOR="ENGAGEMENT_CURSOR",e.WATCH="WATCH",e.ACCEPT_WATCH="ACCEPT_WATCH",e.ACCEPT_COMMIT="ACCEPT_COMMIT",e.NEW_CHANGES="NEW_CHANGES",e.GET_MESSAGE="GET_MESSAGE",e.USER_CHANGES="USER_CHANGES",e.MESSAGE_CHANNEL="MESSAGE_CHANNEL",e.ROOM_MEMBERS="ROOM_MEMBERS",e.ERROR="ERROR",e.MESSAGE="MESSAGE",e.UPDATE_TIME="UPDATE_TIME",e.GET_REFERENCE="GET_REFERENCE",e.GET_REFERENCE_COUNT="GET_REFERENCE_COUNT",e.DEL_REFERENCE="DEL_REFERENCE",e.USER_CHANGES_START="USER_CHANGES_START",e.USER_CHANGES_END="USER_CHANGES_END"}(o||(o={})),function(e){e.ENGINE_CHANNEL="engine_channel",e.MEMBER_CHANNEL="member_channel"}(a||(a={})),function(e){e.Content="content",e.Note="note",e.Topic="topic",e.Title="title",e.Image="image",e.None="none"}(s||(s={})),function(e){e[e.MISSING_VERSION_TOO_MANY=0]="MISSING_VERSION_TOO_MANY",e[e.MISSING_VERSION_VERIFY_FAILED=1]="MISSING_VERSION_VERIFY_FAILED"}(u||(u={}))},vsh_10839:function(e,t,n){"use strict";function r(e){return"encryptTea"in window?window.encryptTea(e):"fake_token_without_window.encryptTea"}n.d(t,{p:function(){return r}})},vsh_79680:function(e,t,n){"use strict";var r;n.d(t,{T:function(){return r}}),function(e){e.CLIENT_ERROR="CLIENT_ERROR",e.RESPONSE_ERROR="RESPONSE_ERROR"}(r||(r={}))},vsh_48723:function(e,t,n){"use strict";n.d(t,{g:function(){return r},j4:function(){return u}});var r,i,o,a=n("vsh_26547"),s=n("vsh_83836");!function(e){e[e.DEFAULT=1]="DEFAULT",e[e.STATIC=2]="STATIC",e[e.THIRD_PARTY=3]="THIRD_PARTY"}(r||(r={})),function(e){e[e.NEW=0]="NEW",e[e.DUPE=64]="DUPE",e[e.CROSS_DASHBOARD_DUPE=65]="CROSS_DASHBOARD_DUPE"}(i||(i={})),function(e){e[e.RICH_TEXT=7]="RICH_TEXT",e[e.BUTTON=8]="BUTTON",e[e.EXTENSION=9]="EXTENSION"}(o||(o={}));function u(e,t){return t({method:"post",headers:{"Content-Type":"application/json"},url:(n=e.typeV2||e.type,n=null!==(i=(r={},(0,a._x)(r,s.kH.RICH_TEXT,s.kH.CHART),(0,a._x)(r,s.kH.BUTTON,s.kH.CHART),(0,a._x)(r,s.kH.ADDON,s.kH.CHART),r)[n])&&void 0!==i?i:n,"/api/v2/sheet/blocks/".concat(n.toLowerCase(),"/create")),data:{parent_type:e.parentType,parent_token:e.parentToken,snapshot:JSON.stringify(e.snapshot),source:e.source,data_type:e.dataType,static_data:JSON.stringify(e.staticData),data_sources:e.dataSource,parent_block_id:e.parentBlockId,sub_type:e.subType}}).then((function(e){return e.data}));var n,r,i}},vsh_96821:function(e,t,n){"use strict";n.d(t,{oc:function(){return f},bd:function(){return c},vN:function(){return l},g0:function(){return h},ZG:function(){return s},Vn:function(){return u},QT:function(){return d}});var r,i=n("vsh_98125"),o=n.n(i),a=void 0;function s(e){r=e}var u=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r?r.apply(a,t):t[0]},l=o().createContext(u),c=function(e){return o().createElement(l.Provider,{value:e.translate},e.children)},h=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return"".concat(e).concat(n.join(""))},d=function(){return(0,i.useContext)(l)},f=function(e){var t=e.children&&o().Children.toArray(e.children),n=e.name,r=t?n.split(/(\$\{[0-9]+})/g).map((function(e){var n=/\$\{([0-9]+)}/.exec(e);if(n){var r=parseInt(n[1],10)-1;return t[r]}return e})):n;return e.noWrapper?o().createElement(o().Fragment,null,r):o().createElement("span",null,r)}},vsh_80881:function(e,t,n){"use strict";n.d(t,{p5:function(){return a},z5:function(){return s},z0:function(){return o}});var r=n("vsh_98125"),i=n.n(r),o=function(e,t){console.log("default eventTracking: [".concat(e,"]"),t)},a=i().createContext(o),s=function(e){return i().createElement(a.Provider,{value:e.eventTracking},e.children)}},vsh_40658:function(e,t,n){"use strict";n.d(t,{pt:function(){return v},i0:function(){return r},Tw:function(){return y},M1:function(){return i}});var r,i,o=n("vsh_65498");function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,a=void 0,a=function(e,t){if("object"!==(0,o.Z)(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==(0,o.Z)(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===(0,o.Z)(a)?a:String(a)),r)}var i,a}function u(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function h(e,t){if(t&&("object"===(0,o.Z)(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var i=l(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h(this,n)}}function f(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}!function(e){e.SPLIT="split",e.MERGE="merge",e.AUTO="auto",e.REPLACE="replace"}(r||(r={})),function(e){e.undo="UNDO",e.redo="REDO"}(i||(i={}));var v=function(){function e(){a(this,e),this.undoStack=[],this.redoStack=[]}return u(e,[{key:"destroy",value:function(){this.undoStack=[],this.redoStack=[]}},{key:"_getInverseUndoEventType",value:function(e){return e===i.undo?i.redo:i.undo}},{key:"_getStack",value:function(e){return e===i.undo?this.undoStack:this.redoStack}},{key:"_setStack",value:function(e,t){e===i.undo?this.undoStack=t:this.redoStack=t}},{key:"_popStackFactory",value:function(e){var t=this._getStack(e);return function(){return t&&0!==t.length?t.pop():null}}},{key:"_popUndoStack",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._popStackFactory(i.undo);return e()}},{key:"_pushStackFactory",value:function(e){var t=this._getStack(e);return function(e){t.push(e)}}},{key:"_pushUndoStack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._pushStackFactory(i.undo);return t(e)}},{key:"_pushRedoStack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._pushStackFactory(i.redo);return t(e)}},{key:"_getStackTopFactory",value:function(e){var t=this._getStack(e);return function(){var e=t.length;return 0===e?null:t[e-1]}}},{key:"getUndoStackTop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._getStackTopFactory(i.undo);return e()}},{key:"getRedoStackTop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._getStackTopFactory(i.redo);return e()}},{key:"_performUndoFactory",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._popStackFactory(e);arguments.length>2&&void 0!==arguments[2]||this._getStackTopFactory(e);var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._pushStackFactory(this._getInverseUndoEventType(e));return function(){var e=t();return e?(n(e),e):null}}},{key:"clearUndoStack",value:function(){this.undoStack=[]}},{key:"clearRedoStack",value:function(){this.redoStack=[]}},{key:"canUndo",get:function(){return this.undoStack.length>0}},{key:"canRedo",get:function(){return this.redoStack.length>0}},{key:"undo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._performUndoFactory(i.undo);return e()}},{key:"redo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._performUndoFactory(i.redo);return e()}},{key:"do",value:function(e){this._pushUndoStack(e),this.clearRedoStack()}}]),e}();function g(e){return"string"==typeof e?{id:e}:e}var _=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(n,e);var t=d(n);function n(){return a(this,n),t.apply(this,arguments)}return u(n,[{key:"clearByRef",value:function(e){var t=g(e).id;this._setStack(i.undo,this._getStack(i.undo).filter((function(e){return e.id!==t}))),this._setStack(i.redo,this._getStack(i.redo).filter((function(e){return e.id!==t})))}},{key:"getAllRefsInStack",value:function(){return new Set([].concat(f(this._getStack(i.undo)),f(this._getStack(i.redo))).map((function(e){return e.id})))}}]),n}(v),y=function(){function e(){a(this,e),this.parentUndoDispatcher=null,this.undoModules=new Map,this.stack=new _}return u(e,[{key:"register",value:function(e){this.undoModules.set(e.id,e)}},{key:"unregister",value:function(e){this.undoModules.delete(e),this.stack.clearByRef(e)}},{key:"undo",value:function(){this.parentUndoDispatcher?this.parentUndoDispatcher.undo():this.performUndo()}},{key:"redo",value:function(){this.parentUndoDispatcher?this.parentUndoDispatcher.redo():this.preformRedo()}},{key:"performUndo",value:function(){var e=this.stack.undo();if(e){var t=e.id;if(this.undoModules.has(t)){var n=this.undoModules.get(t);if(n)return n.undo()}}}},{key:"preformRedo",value:function(){var e=this.stack.redo();if(e){var t=e.id;if(this.undoModules.has(t)){var n=this.undoModules.get(t);if(n)return n.redo()}}}},{key:"do",value:function(e,t){var n=g(e),r=n.id;if(this.undoModules.has(r)){var i=this.undoModules.get(r);if(i){if(t){var o=this.stack.getUndoStackTop();if(i.do){var a=!o||r===o.id;i.do(t,a)?this.stack.clearRedoStack():(this.stack.do(n),this.onDoNext(n))}}else this.stack.do(n),this.onDoNext(n);this.undoModules.forEach((function(e){e.clearRedoStack&&e.clearRedoStack()}))}}}},{key:"getAllRefsInStack",value:function(){return this.stack.getAllRefsInStack()}},{key:"canUndo",get:function(){return this.stack.canUndo}},{key:"canRedo",get:function(){return this.stack.canRedo}},{key:"destroy",value:function(){this.undoModules.clear(),this.stack.destroy()}},{key:"clearHistory",value:function(){this.stack.clearRedoStack()}},{key:"onDoNext",value:function(e){}},{key:"onDo",value:function(e){}}],[{key:"create",value:function(){return new e}}]),e}()},vsh_61332:function(e,t,n){var r;!function(i){"use strict";function o(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function a(e,t,n,r,i,a){return o((s=o(o(t,e),o(r,a)))<<(u=i)|s>>>32-u,n);var s,u}function s(e,t,n,r,i,o,s){return a(t&n|~t&r,e,t,i,o,s)}function u(e,t,n,r,i,o,s){return a(t&r|n&~r,e,t,i,o,s)}function l(e,t,n,r,i,o,s){return a(t^n^r,e,t,i,o,s)}function c(e,t,n,r,i,o,s){return a(n^(t|~r),e,t,i,o,s)}function h(e,t){var n,r,i,a,h;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var d=1732584193,f=-271733879,p=-1732584194,v=271733878;for(n=0;n<e.length;n+=16)r=d,i=f,a=p,h=v,d=s(d,f,p,v,e[n],7,-680876936),v=s(v,d,f,p,e[n+1],12,-389564586),p=s(p,v,d,f,e[n+2],17,606105819),f=s(f,p,v,d,e[n+3],22,-1044525330),d=s(d,f,p,v,e[n+4],7,-176418897),v=s(v,d,f,p,e[n+5],12,1200080426),p=s(p,v,d,f,e[n+6],17,-1473231341),f=s(f,p,v,d,e[n+7],22,-45705983),d=s(d,f,p,v,e[n+8],7,1770035416),v=s(v,d,f,p,e[n+9],12,-1958414417),p=s(p,v,d,f,e[n+10],17,-42063),f=s(f,p,v,d,e[n+11],22,-1990404162),d=s(d,f,p,v,e[n+12],7,1804603682),v=s(v,d,f,p,e[n+13],12,-40341101),p=s(p,v,d,f,e[n+14],17,-1502002290),d=u(d,f=s(f,p,v,d,e[n+15],22,1236535329),p,v,e[n+1],5,-165796510),v=u(v,d,f,p,e[n+6],9,-1069501632),p=u(p,v,d,f,e[n+11],14,643717713),f=u(f,p,v,d,e[n],20,-373897302),d=u(d,f,p,v,e[n+5],5,-701558691),v=u(v,d,f,p,e[n+10],9,38016083),p=u(p,v,d,f,e[n+15],14,-660478335),f=u(f,p,v,d,e[n+4],20,-405537848),d=u(d,f,p,v,e[n+9],5,568446438),v=u(v,d,f,p,e[n+14],9,-1019803690),p=u(p,v,d,f,e[n+3],14,-187363961),f=u(f,p,v,d,e[n+8],20,1163531501),d=u(d,f,p,v,e[n+13],5,-1444681467),v=u(v,d,f,p,e[n+2],9,-51403784),p=u(p,v,d,f,e[n+7],14,1735328473),d=l(d,f=u(f,p,v,d,e[n+12],20,-1926607734),p,v,e[n+5],4,-378558),v=l(v,d,f,p,e[n+8],11,-2022574463),p=l(p,v,d,f,e[n+11],16,1839030562),f=l(f,p,v,d,e[n+14],23,-35309556),d=l(d,f,p,v,e[n+1],4,-1530992060),v=l(v,d,f,p,e[n+4],11,1272893353),p=l(p,v,d,f,e[n+7],16,-155497632),f=l(f,p,v,d,e[n+10],23,-1094730640),d=l(d,f,p,v,e[n+13],4,681279174),v=l(v,d,f,p,e[n],11,-358537222),p=l(p,v,d,f,e[n+3],16,-722521979),f=l(f,p,v,d,e[n+6],23,76029189),d=l(d,f,p,v,e[n+9],4,-640364487),v=l(v,d,f,p,e[n+12],11,-421815835),p=l(p,v,d,f,e[n+15],16,530742520),d=c(d,f=l(f,p,v,d,e[n+2],23,-995338651),p,v,e[n],6,-198630844),v=c(v,d,f,p,e[n+7],10,1126891415),p=c(p,v,d,f,e[n+14],15,-1416354905),f=c(f,p,v,d,e[n+5],21,-57434055),d=c(d,f,p,v,e[n+12],6,1700485571),v=c(v,d,f,p,e[n+3],10,-1894986606),p=c(p,v,d,f,e[n+10],15,-1051523),f=c(f,p,v,d,e[n+1],21,-2054922799),d=c(d,f,p,v,e[n+8],6,1873313359),v=c(v,d,f,p,e[n+15],10,-30611744),p=c(p,v,d,f,e[n+6],15,-1560198380),f=c(f,p,v,d,e[n+13],21,1309151649),d=c(d,f,p,v,e[n+4],6,-145523070),v=c(v,d,f,p,e[n+11],10,-1120210379),p=c(p,v,d,f,e[n+2],15,718787259),f=c(f,p,v,d,e[n+9],21,-343485551),d=o(d,r),f=o(f,i),p=o(p,a),v=o(v,h);return[d,f,p,v]}function d(e){var t,n="",r=32*e.length;for(t=0;t<r;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function f(e){var t,n=[];for(n[(e.length>>2)-1]=void 0,t=0;t<n.length;t+=1)n[t]=0;var r=8*e.length;for(t=0;t<r;t+=8)n[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return n}function p(e){var t,n,r="0123456789abcdef",i="";for(n=0;n<e.length;n+=1)t=e.charCodeAt(n),i+=r.charAt(t>>>4&15)+r.charAt(15&t);return i}function v(e){return unescape(encodeURIComponent(e))}function g(e){return function(e){return d(h(f(e),8*e.length))}(v(e))}function _(e,t){return function(e,t){var n,r,i=f(e),o=[],a=[];for(o[15]=a[15]=void 0,i.length>16&&(i=h(i,8*e.length)),n=0;n<16;n+=1)o[n]=909522486^i[n],a[n]=1549556828^i[n];return r=h(o.concat(f(t)),512+8*t.length),d(h(a.concat(r),640))}(v(e),v(t))}function y(e,t,n){return t?n?_(t,e):function(e,t){return p(_(e,t))}(t,e):n?g(e):p(g(e))}void 0===(r=function(){return y}.call(t,n,t,e))||(e.exports=r)}()},vsh_77034:function(e,t,n){var r;r=function(){var e=!0;function t(t){function n(e){var n=t.match(e);return n&&n.length>1&&n[1]||""}function r(e){var n=t.match(e);return n&&n.length>1&&n[2]||""}var i,a=n(/(ipod|iphone|ipad)/i).toLowerCase(),s=!/like android/i.test(t)&&/android/i.test(t),u=/nexus\s*[0-6]\s*/i.test(t),l=!u&&/nexus\s*[0-9]+/i.test(t),c=/CrOS/.test(t),h=/silk/i.test(t),d=/sailfish/i.test(t),f=/tizen/i.test(t),p=/(web|hpw)(o|0)s/i.test(t),v=/windows phone/i.test(t),g=(/SamsungBrowser/i.test(t),!v&&/windows/i.test(t)),_=!a&&!h&&/macintosh/i.test(t),y=!s&&!d&&!f&&!p&&/linux/i.test(t),m=r(/edg([ea]|ios)\/(\d+(\.\d+)?)/i),E=n(/version\/(\d+(\.\d+)?)/i),b=/tablet/i.test(t)&&!/tablet pc/i.test(t),T=!b&&/[^-]mobi/i.test(t),C=/xbox/i.test(t);/opera/i.test(t)?i={name:"Opera",opera:e,version:E||n(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}:/opr\/|opios/i.test(t)?i={name:"Opera",opera:e,version:n(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i)||E}:/SamsungBrowser/i.test(t)?i={name:"Samsung Internet for Android",samsungBrowser:e,version:E||n(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)}:/Whale/i.test(t)?i={name:"NAVER Whale browser",whale:e,version:n(/(?:whale)[\s\/](\d+(?:\.\d+)+)/i)}:/MZBrowser/i.test(t)?i={name:"MZ Browser",mzbrowser:e,version:n(/(?:MZBrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/coast/i.test(t)?i={name:"Opera Coast",coast:e,version:E||n(/(?:coast)[\s\/](\d+(\.\d+)?)/i)}:/focus/i.test(t)?i={name:"Focus",focus:e,version:n(/(?:focus)[\s\/](\d+(?:\.\d+)+)/i)}:/yabrowser/i.test(t)?i={name:"Yandex Browser",yandexbrowser:e,version:E||n(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/ucbrowser/i.test(t)?i={name:"UC Browser",ucbrowser:e,version:n(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/mxios/i.test(t)?i={name:"Maxthon",maxthon:e,version:n(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i)}:/epiphany/i.test(t)?i={name:"Epiphany",epiphany:e,version:n(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)}:/puffin/i.test(t)?i={name:"Puffin",puffin:e,version:n(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)}:/sleipnir/i.test(t)?i={name:"Sleipnir",sleipnir:e,version:n(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)}:/k-meleon/i.test(t)?i={name:"K-Meleon",kMeleon:e,version:n(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)}:v?(i={name:"Windows Phone",osname:"Windows Phone",windowsphone:e},m?(i.msedge=e,i.version=m):(i.msie=e,i.version=n(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(t)?i={name:"Internet Explorer",msie:e,version:n(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:c?i={name:"Chrome",osname:"Chrome OS",chromeos:e,chromeBook:e,chrome:e,version:n(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/edg([ea]|ios)/i.test(t)?i={name:"Microsoft Edge",msedge:e,version:m}:/vivaldi/i.test(t)?i={name:"Vivaldi",vivaldi:e,version:n(/vivaldi\/(\d+(\.\d+)?)/i)||E}:d?i={name:"Sailfish",osname:"Sailfish OS",sailfish:e,version:n(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(t)?i={name:"SeaMonkey",seamonkey:e,version:n(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel|fxios/i.test(t)?(i={name:"Firefox",firefox:e,version:n(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(t)&&(i.firefoxos=e,i.osname="Firefox OS")):h?i={name:"Amazon Silk",silk:e,version:n(/silk\/(\d+(\.\d+)?)/i)}:/phantom/i.test(t)?i={name:"PhantomJS",phantom:e,version:n(/phantomjs\/(\d+(\.\d+)?)/i)}:/slimerjs/i.test(t)?i={name:"SlimerJS",slimer:e,version:n(/slimerjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(t)||/rim\stablet/i.test(t)?i={name:"BlackBerry",osname:"BlackBerry OS",blackberry:e,version:E||n(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:p?(i={name:"WebOS",osname:"WebOS",webos:e,version:E||n(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(t)&&(i.touchpad=e)):/bada/i.test(t)?i={name:"Bada",osname:"Bada",bada:e,version:n(/dolfin\/(\d+(\.\d+)?)/i)}:f?i={name:"Tizen",osname:"Tizen",tizen:e,version:n(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||E}:/qupzilla/i.test(t)?i={name:"QupZilla",qupzilla:e,version:n(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i)||E}:/chromium/i.test(t)?i={name:"Chromium",chromium:e,version:n(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||E}:/chrome|crios|crmo/i.test(t)?i={name:"Chrome",chrome:e,version:n(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:s?i={name:"Android",version:E}:/safari|applewebkit/i.test(t)?(i={name:"Safari",safari:e},E&&(i.version=E)):a?(i={name:"iphone"==a?"iPhone":"ipad"==a?"iPad":"iPod"},E&&(i.version=E)):i=/googlebot/i.test(t)?{name:"Googlebot",googlebot:e,version:n(/googlebot\/(\d+(\.\d+))/i)||E}:{name:n(/^(.*)\/(.*) /),version:r(/^(.*)\/(.*) /)},!i.msedge&&/(apple)?webkit/i.test(t)?(/(apple)?webkit\/537\.36/i.test(t)?(i.name=i.name||"Blink",i.blink=e):(i.name=i.name||"Webkit",i.webkit=e),!i.version&&E&&(i.version=E)):!i.opera&&/gecko\//i.test(t)&&(i.name=i.name||"Gecko",i.gecko=e,i.version=i.version||n(/gecko\/(\d+(\.\d+)?)/i)),i.windowsphone||!s&&!i.silk?!i.windowsphone&&a?(i[a]=e,i.ios=e,i.osname="iOS"):_?(i.mac=e,i.osname="macOS"):C?(i.xbox=e,i.osname="Xbox"):g?(i.windows=e,i.osname="Windows"):y&&(i.linux=e,i.osname="Linux"):(i.android=e,i.osname="Android");var S="";i.windows?S=function(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}(n(/Windows ((NT|XP)( \d\d?.\d)?)/i)):i.windowsphone?S=n(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):i.mac?S=(S=n(/Mac OS X (\d+([_\.\s]\d+)*)/i)).replace(/[_\s]/g,"."):a?S=(S=n(/os (\d+([_\s]\d+)*) like mac os x/i)).replace(/[_\s]/g,"."):s?S=n(/android[ \/-](\d+(\.\d+)*)/i):i.webos?S=n(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):i.blackberry?S=n(/rim\stablet\sos\s(\d+(\.\d+)*)/i):i.bada?S=n(/bada\/(\d+(\.\d+)*)/i):i.tizen&&(S=n(/tizen[\/\s](\d+(\.\d+)*)/i)),S&&(i.osversion=S);var w=!i.windows&&S.split(".")[0];return b||l||"ipad"==a||s&&(3==w||w>=4&&!T)||i.silk?i.tablet=e:(T||"iphone"==a||"ipod"==a||s||u||i.blackberry||i.webos||i.bada)&&(i.mobile=e),i.msedge||i.msie&&i.version>=10||i.yandexbrowser&&i.version>=15||i.vivaldi&&i.version>=1||i.chrome&&i.version>=20||i.samsungBrowser&&i.version>=4||i.whale&&1===o([i.version,"1.0"])||i.mzbrowser&&1===o([i.version,"6.0"])||i.focus&&1===o([i.version,"1.0"])||i.firefox&&i.version>=20||i.safari&&i.version>=6||i.opera&&i.version>=10||i.ios&&i.osversion&&i.osversion.split(".")[0]>=6||i.blackberry&&i.version>=10.1||i.chromium&&i.version>=20?i.a=e:i.msie&&i.version<10||i.chrome&&i.version<20||i.firefox&&i.version<20||i.safari&&i.version<6||i.opera&&i.version<10||i.ios&&i.osversion&&i.osversion.split(".")[0]<6||i.chromium&&i.version<20?i.c=e:i.x=e,i}var n=t("undefined"!=typeof navigator&&navigator.userAgent||"");function r(e){return e.split(".").length}function i(e,t){var n,r=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(n=0;n<e.length;n++)r.push(t(e[n]));return r}function o(e){for(var t=Math.max(r(e[0]),r(e[1])),n=i(e,(function(e){var n=t-r(e);return i((e+=new Array(n+1).join(".0")).split("."),(function(e){return new Array(20-e.length).join("0")+e})).reverse()}));--t>=0;){if(n[0][t]>n[1][t])return 1;if(n[0][t]!==n[1][t])return-1;if(0===t)return 0}}function a(e,r,i){var a=n;"string"==typeof r&&(i=r,r=void 0),void 0===r&&(r=!1),i&&(a=t(i));var s=""+a.version;for(var u in e)if(e.hasOwnProperty(u)&&a[u]){if("string"!=typeof e[u])throw new Error("Browser version in the minVersion map should be a string: "+u+": "+String(e));return o([s,e[u]])<0}return r}return n.test=function(e){for(var t=0;t<e.length;++t){var r=e[t];if("string"==typeof r&&r in n)return!0}return!1},n.isUnsupportedBrowser=a,n.compareVersions=o,n.check=function(e,t,n){return!a(e,t,n)},n._detect=t,n.detect=t,n},e.exports?e.exports=r():n.amdD("bowser",r)},vsh_19496:function(e){e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=90)}({17:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r=n(18),i=function(){function e(){}return e.getFirstMatch=function(e,t){var n=t.match(e);return n&&n.length>0&&n[1]||""},e.getSecondMatch=function(e,t){var n=t.match(e);return n&&n.length>1&&n[2]||""},e.matchAndReturnConst=function(e,t,n){if(e.test(t))return n},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,n,r){void 0===r&&(r=!1);var i=e.getVersionPrecision(t),o=e.getVersionPrecision(n),a=Math.max(i,o),s=0,u=e.map([t,n],(function(t){var n=a-e.getVersionPrecision(t),r=t+new Array(n+1).join(".0");return e.map(r.split("."),(function(e){return new Array(20-e.length).join("0")+e})).reverse()}));for(r&&(s=a-Math.min(i,o)),a-=1;a>=s;){if(u[0][a]>u[1][a])return 1;if(u[0][a]===u[1][a]){if(a===s)return 0;a-=1}else if(u[0][a]<u[1][a])return-1}},e.map=function(e,t){var n,r=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(n=0;n<e.length;n+=1)r.push(t(e[n]));return r},e.find=function(e,t){var n,r;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(n=0,r=e.length;n<r;n+=1){var i=e[n];if(t(i,n))return i}},e.assign=function(e){for(var t,n,r=e,i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];if(Object.assign)return Object.assign.apply(Object,[e].concat(o));var s=function(){var e=o[t];"object"==typeof e&&null!==e&&Object.keys(e).forEach((function(t){r[t]=e[t]}))};for(t=0,n=o.length;t<n;t+=1)s();return e},e.getBrowserAlias=function(e){return r.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return r.BROWSER_MAP[e]||""},e}();t.default=i,e.exports=t.default},18:function(e,t,n){"use strict";t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(91))&&r.__esModule?r:{default:r},o=n(18);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(){}var t,n,r;return e.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw new Error("UserAgent should be a string");return new i.default(e,t)},e.parse=function(e){return new i.default(e).getResult()},t=e,r=[{key:"BROWSER_MAP",get:function(){return o.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return o.ENGINE_MAP}},{key:"OS_MAP",get:function(){return o.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return o.PLATFORMS_MAP}}],(n=null)&&a(t.prototype,n),r&&a(t,r),e}();t.default=s,e.exports=t.default},91:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r=u(n(92)),i=u(n(93)),o=u(n(94)),a=u(n(95)),s=u(n(17));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=s.default.find(r.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=s.default.find(i.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=s.default.find(o.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=s.default.find(a.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return s.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,n={},r=0,i={},o=0;if(Object.keys(e).forEach((function(t){var a=e[t];"string"==typeof a?(i[t]=a,o+=1):"object"==typeof a&&(n[t]=a,r+=1)})),r>0){var a=Object.keys(n),u=s.default.find(a,(function(e){return t.isOS(e)}));if(u){var l=this.satisfies(n[u]);if(void 0!==l)return l}var c=s.default.find(a,(function(e){return t.isPlatform(e)}));if(c){var h=this.satisfies(n[c]);if(void 0!==h)return h}}if(o>0){var d=Object.keys(i),f=s.default.find(d,(function(e){return t.isBrowser(e,!0)}));if(void 0!==f)return this.compareVersion(i[f])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var n=this.getBrowserName().toLowerCase(),r=e.toLowerCase(),i=s.default.getBrowserTypeByAlias(r);return t&&i&&(r=i.toLowerCase()),r===n},t.compareVersion=function(e){var t=[0],n=e,r=!1,i=this.getBrowserVersion();if("string"==typeof i)return">"===e[0]||"<"===e[0]?(n=e.substr(1),"="===e[1]?(r=!0,n=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?n=e.substr(1):"~"===e[0]&&(r=!0,n=e.substr(1)),t.indexOf(s.default.compareVersions(i,n,r))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e,t){return void 0===t&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some((function(e){return t.is(e)}))},e}();t.default=l,e.exports=t.default},92:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=/version\/(\d+(\.?_?\d+)+)/i,a=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},n=i.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},n=i.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},n=i.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},n=i.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},n=i.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var t={name:"Opera Touch"},n=i.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},n=i.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},n=i.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},n=i.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},n=i.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},n=i.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},n=i.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},n=i.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},n=i.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},n=i.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return n&&(t.version=n),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},n=i.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},n=i.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},n=i.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},n=i.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},n=i.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},n=i.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},n=i.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},n=i.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:"Miui"},n=i.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},n=i.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},n=i.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},n=i.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t={name:"Android Browser"},n=i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},n=i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},n=i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:i.default.getFirstMatch(t,e),version:i.default.getSecondMatch(t,e)}}}];t.default=a,e.exports=t.default},93:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=n(18),a=[{test:[/Roku\/DVP/],describe:function(e){var t=i.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:o.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=i.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=i.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),n=i.default.getWindowsVersionName(t);return{name:o.OS_MAP.Windows,version:t,versionName:n}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:o.OS_MAP.iOS},n=i.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return n&&(t.version=n),t}},{test:[/macintosh/i],describe:function(e){var t=i.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),n=i.default.getMacOSVersionName(t),r={name:o.OS_MAP.MacOS,version:t};return n&&(r.versionName=n),r}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=i.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:o.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t=i.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),n=i.default.getAndroidVersionName(t),r={name:o.OS_MAP.Android,version:t};return n&&(r.versionName=n),r}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=i.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),n={name:o.OS_MAP.WebOS};return t&&t.length&&(n.version=t),n}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=i.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||i.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||i.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:o.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=i.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=i.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:o.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:o.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=i.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.PlayStation4,version:t}}}];t.default=a,e.exports=t.default},94:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=n(18),a=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=i.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",n={type:o.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(n.model=t),n}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),n=e.test(/like (ipod|iphone)/i);return t&&!n},describe:function(e){var t=i.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:o.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}}];t.default=a,e.exports=t.default},95:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=n(18),a=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:o.ENGINE_MAP.Blink};var t=i.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:o.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:o.ENGINE_MAP.Trident},n=i.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:o.ENGINE_MAP.Presto},n=i.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=e.test(/gecko/i),n=e.test(/like gecko/i);return t&&!n},describe:function(e){var t={name:o.ENGINE_MAP.Gecko},n=i.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:o.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:o.ENGINE_MAP.WebKit},n=i.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}}];t.default=a,e.exports=t.default}})},vsh_80420:function(e,t,n){var r=n("vsh_39534").default,i=!1;if("undefined"!=typeof window)if(void 0!==window.__DOCS_SHOW_I18N_KEYS__)i=Boolean(window.__DOCS_SHOW_I18N_KEYS__);else try{var o=window.localStorage&&window.localStorage.getItem("popup_I18nKey");i="1"===o}catch(e){console.warn(e)}function a(e,t){return 0===t.length?e:e.replace(/\$\{([0-9])\}/g,(function(e,n){var r=parseInt(n-1,10);return t[r]}))}function s(e){return"[object String]"===Object.prototype.toString.call(e)}function u(e){return"[object Number]"===Object.prototype.toString.call(e)}e.exports={t:function e(t){if(i)return t;var o=Array.prototype.slice.call(arguments,1),l={};o=o.filter((function(e){var t=s(e)||u(e);return t||(l=Object.assign(l,e)),t}));var c=null;c="undefined"==typeof window?n.g:window;if(c.TTI18N&&c.TTI18N[t]){var h=a(c.TTI18N[t],o);if(Object.keys(l).length>0)try{h=new r(h,e.locales).format(l)}catch(e){console.warn(e)}return h}return window&&(window.i18nKeyMissingArray?window.i18nKeyMissingArray.push(t):window.i18nKeyMissingArray=[t]),console.warn("tt-i18n: cannot valid i18n mapping for text "+t),t}}},vsh_63099:function(e,t,n){"use strict";var r=n("vsh_40783"),i=n("vsh_72755"),o=i(r("String.prototype.indexOf"));e.exports=function(e,t){var n=r(e,!!t);return"function"==typeof n&&o(e,".prototype.")>-1?i(n):n}},vsh_72755:function(e,t,n){"use strict";var r=n("vsh_48794"),i=n("vsh_40783"),o=i("%Function.prototype.apply%"),a=i("%Function.prototype.call%"),s=i("%Reflect.apply%",!0)||r.call(a,o),u=i("%Object.getOwnPropertyDescriptor%",!0),l=i("%Object.defineProperty%",!0),c=i("%Math.max%");if(l)try{l({},"a",{value:1})}catch(e){l=null}e.exports=function(e){var t=s(r,a,arguments);if(u&&l){var n=u(t,"length");n.configurable&&l(t,"length",{value:1+c(0,e.length-(arguments.length-1))})}return t};var h=function(){return s(r,o,arguments)};l?l(e.exports,"apply",{value:h}):e.exports.apply=h},vsh_97754:function(e,t){var n;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var r={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var o=typeof n;if("string"===o||"number"===o)e.push(n);else if(Array.isArray(n)&&n.length){var a=i.apply(null,n);a&&e.push(a)}else if("object"===o)for(var s in n)r.call(n,s)&&n[s]&&e.push(s)}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(n=function(){return i}.apply(t,[]))||(e.exports=n)}()},vsh_51626:function(e,t,n){"use strict";function r(e){var t,n,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=r(e[t]))&&(i&&(i+=" "),i+=n);else for(t in e)e[t]&&(i&&(i+=" "),i+=t);return i}function i(){for(var e,t,n=0,i="";n<arguments.length;)(e=arguments[n++])&&(t=r(e))&&(i&&(i+=" "),i+=t);return i}n.r(t),n.d(t,{default:function(){return i}})},vsh_27185:function(e,t,n){var r=n("vsh_14224");function i(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e={NODE_ENV:"production",CDN_URL:navigator.cdn_host+"/eesz/bear/sheet/module",FASTER_TEST:void 0}.DEBUG),e}(t=e.exports=n("vsh_97991")).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var i=0,o=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(i++,"%c"===e&&(o=i))})),e.splice(o,0,r)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=i,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(i())},vsh_97991:function(e,t,n){var r;function i(e){function n(){if(n.enabled){var e=n,i=+new Date,o=i-(r||i);e.diff=o,e.prev=r,e.curr=i,r=i;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var u=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;u++;var i=t.formatters[r];if("function"==typeof i){var o=a[u];n=i.call(e,o),a.splice(u,1),u--}return n})),t.formatArgs.call(e,a);var l=n.log||t.log||console.log.bind(console);l.apply(e,a)}}return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),"function"==typeof t.init&&t.init(n),n}(t=e.exports=i.debug=i.default=i).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];for(var n=("string"==typeof e?e:"").split(/[\s,]+/),r=n.length,i=0;i<r;i++)n[i]&&("-"===(e=n[i].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n("vsh_9065"),t.names=[],t.skips=[],t.formatters={}},vsh_90722:function(e,t,n){"use strict";var r=n("vsh_72051"),i="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),o=Object.prototype.toString,a=Array.prototype.concat,s=Object.defineProperty,u=s&&function(){var e={};try{for(var t in s(e,"x",{enumerable:!1,value:e}),e)return!1;return e.x===e}catch(e){return!1}}(),l=function(e,t,n,r){var i;(!(t in e)||"function"==typeof(i=r)&&"[object Function]"===o.call(i)&&r())&&(u?s(e,t,{configurable:!0,enumerable:!1,value:n,writable:!0}):e[t]=n)},c=function(e,t){var n=arguments.length>2?arguments[2]:{},o=r(t);i&&(o=a.call(o,Object.getOwnPropertySymbols(t)));for(var s=0;s<o.length;s+=1)l(e,o[s],t[o[s]],n[o[s]])};c.supportsDescriptors=!!u,e.exports=c},vsh_77358:function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator,i=n("vsh_37959"),o=n("vsh_36983"),a=n("vsh_70455"),s=n("vsh_38760"),u=function(e,t){if(null==e)throw new TypeError("Cannot call method on "+e);if("string"!=typeof t||"number"!==t&&"string"!==t)throw new TypeError('hint must be "string" or "number"');var n,r,a,s="string"===t?["toString","valueOf"]:["valueOf","toString"];for(a=0;a<s.length;++a)if(n=e[s[a]],o(n)&&(r=n.call(e),i(r)))return r;throw new TypeError("No default value")},l=function(e,t){var n=e[t];if(null!=n){if(!o(n))throw new TypeError(n+" returned for property "+t+" of object "+e+" is not a function");return n}};e.exports=function(e){if(i(e))return e;var t,n="default";if(arguments.length>1&&(arguments[1]===String?n="string":arguments[1]===Number&&(n="number")),r&&(Symbol.toPrimitive?t=l(e,Symbol.toPrimitive):s(e)&&(t=Symbol.prototype.valueOf)),void 0!==t){var o=t.call(e,n);if(i(o))return o;throw new TypeError("unable to convert exotic object to primitive")}return"default"===n&&(a(e)||s(e))&&(n="string"),u(e,"default"===n?"number":n)}},vsh_60727:function(e,t,n){"use strict";var r=Object.prototype.toString,i=n("vsh_37959"),o=n("vsh_36983"),a=function(e){var t;if((t=arguments.length>1?arguments[1]:"[object Date]"===r.call(e)?String:Number)===String||t===Number){var n,a,s=t===String?["toString","valueOf"]:["valueOf","toString"];for(a=0;a<s.length;++a)if(o(e[s[a]])&&(n=e[s[a]](),i(n)))return n;throw new TypeError("No default value")}throw new TypeError("invalid [[DefaultValue]] hint supplied")};e.exports=function(e){return i(e)?e:arguments.length>1?a(e,arguments[1]):a(e)}},vsh_37959:function(e){"use strict";e.exports=function(e){return null===e||"function"!=typeof e&&"object"!=typeof e}},vsh_72862:function(e){var t=-1;function n(e,s,u,l){if(e===s)return e?[[0,e]]:[];if(null!=u){var c=function(e,t,n){var r="number"==typeof n?{index:n,length:0}:n.oldRange,i="number"==typeof n?null:n.newRange,o=e.length,a=t.length;if(0===r.length&&(null===i||0===i.length)){var s=r.index,u=e.slice(0,s),l=e.slice(s),c=i?i.index:null,d=s+a-o;if((null===c||c===d)&&!(d<0||d>a)){var f=t.slice(0,d);if((g=t.slice(d))===l){var p=Math.min(s,d);if((y=u.slice(0,p))===(E=f.slice(0,p)))return h(y,u.slice(p),f.slice(p),l)}}if(null===c||c===s){var v=s,g=(f=t.slice(0,v),t.slice(v));if(f===u){var _=Math.min(o-v,a-v);if((m=l.slice(l.length-_))===(b=g.slice(g.length-_)))return h(u,l.slice(0,l.length-_),g.slice(0,g.length-_),m)}}}if(r.length>0&&i&&0===i.length){var y=e.slice(0,r.index),m=e.slice(r.index+r.length);if(!(a<(p=y.length)+(_=m.length))){var E=t.slice(0,p),b=t.slice(a-_);if(y===E&&m===b)return h(y,e.slice(p,o-_),t.slice(p,a-_),m)}}return null}(e,s,u);if(c)return c}var d=i(e,s),f=e.substring(0,d);d=o(e=e.substring(d),s=s.substring(d));var p=e.substring(e.length-d),v=function(e,a){var s;if(!e)return[[1,a]];if(!a)return[[t,e]];var u=e.length>a.length?e:a,l=e.length>a.length?a:e,c=u.indexOf(l);if(-1!==c)return s=[[1,u.substring(0,c)],[0,l],[1,u.substring(c+l.length)]],e.length>a.length&&(s[0][0]=s[2][0]=t),s;if(1===l.length)return[[t,e],[1,a]];var h=function(e,t){var n=e.length>t.length?e:t,r=e.length>t.length?t:e;if(n.length<4||2*r.length<n.length)return null;function a(e,t,n){for(var r,a,s,u,l=e.substring(n,n+Math.floor(e.length/4)),c=-1,h="";-1!==(c=t.indexOf(l,c+1));){var d=i(e.substring(n),t.substring(c)),f=o(e.substring(0,n),t.substring(0,c));h.length<f+d&&(h=t.substring(c-f,c)+t.substring(c,c+d),r=e.substring(0,n-f),a=e.substring(n+d),s=t.substring(0,c-f),u=t.substring(c+d))}return 2*h.length>=e.length?[r,a,s,u,h]:null}var s,u,l,c,h,d=a(n,r,Math.ceil(n.length/4)),f=a(n,r,Math.ceil(n.length/2));if(!d&&!f)return null;s=f?d&&d[4].length>f[4].length?d:f:d;e.length>t.length?(u=s[0],l=s[1],c=s[2],h=s[3]):(c=s[0],h=s[1],u=s[2],l=s[3]);var p=s[4];return[u,l,c,h,p]}(e,a);if(h){var d=h[0],f=h[1],p=h[2],v=h[3],g=h[4],_=n(d,p),y=n(f,v);return _.concat([[0,g]],y)}return function(e,n){for(var i=e.length,o=n.length,a=Math.ceil((i+o)/2),s=a,u=2*a,l=new Array(u),c=new Array(u),h=0;h<u;h++)l[h]=-1,c[h]=-1;l[s+1]=0,c[s+1]=0;for(var d=i-o,f=d%2!=0,p=0,v=0,g=0,_=0,y=0;y<a;y++){for(var m=-y+p;m<=y-v;m+=2){for(var E=s+m,b=(R=m===-y||m!==y&&l[E-1]<l[E+1]?l[E+1]:l[E-1]+1)-m;R<i&&b<o&&e.charAt(R)===n.charAt(b);)R++,b++;if(l[E]=R,R>i)v+=2;else if(b>o)p+=2;else if(f){if((S=s+d-m)>=0&&S<u&&-1!==c[S])if(R>=(C=i-c[S]))return r(e,n,R,b)}}for(var T=-y+g;T<=y-_;T+=2){for(var C,S=s+T,w=(C=T===-y||T!==y&&c[S-1]<c[S+1]?c[S+1]:c[S-1]+1)-T;C<i&&w<o&&e.charAt(i-C-1)===n.charAt(o-w-1);)C++,w++;if(c[S]=C,C>i)_+=2;else if(w>o)g+=2;else if(!f){if((E=s+d-T)>=0&&E<u&&-1!==l[E]){var R;b=s+(R=l[E])-E;if(R>=(C=i-C))return r(e,n,R,b)}}}}return[[t,e],[1,n]]}(e,a)}(e=e.substring(0,e.length-d),s=s.substring(0,s.length-d));return f&&v.unshift([0,f]),p&&v.push([0,p]),a(v,l),v}function r(e,t,r,i){var o=e.substring(0,r),a=t.substring(0,i),s=e.substring(r),u=t.substring(i),l=n(o,a),c=n(s,u);return l.concat(c)}function i(e,t){if(!e||!t||e.charAt(0)!==t.charAt(0))return 0;for(var n=0,r=Math.min(e.length,t.length),i=r,o=0;n<i;)e.substring(o,i)==t.substring(o,i)?o=n=i:r=i,i=Math.floor((r-n)/2+n);return s(e.charCodeAt(i-1))&&i--,i}function o(e,t){if(!e||!t||e.slice(-1)!==t.slice(-1))return 0;for(var n=0,r=Math.min(e.length,t.length),i=r,o=0;n<i;)e.substring(e.length-i,e.length-o)==t.substring(t.length-i,t.length-o)?o=n=i:r=i,i=Math.floor((r-n)/2+n);return u(e.charCodeAt(e.length-i))&&i--,i}function a(e,n){e.push([0,""]);for(var r,s=0,u=0,h=0,d="",f="";s<e.length;)if(s<e.length-1&&!e[s][1])e.splice(s,1);else switch(e[s][0]){case 1:h++,f+=e[s][1],s++;break;case t:u++,d+=e[s][1],s++;break;case 0:var p=s-h-u-1;if(n){if(p>=0&&c(e[p][1])){var v=e[p][1].slice(-1);if(e[p][1]=e[p][1].slice(0,-1),d=v+d,f=v+f,!e[p][1]){e.splice(p,1),s--;var g=p-1;e[g]&&1===e[g][0]&&(h++,f=e[g][1]+f,g--),e[g]&&e[g][0]===t&&(u++,d=e[g][1]+d,g--),p=g}}if(l(e[s][1])){v=e[s][1].charAt(0);e[s][1]=e[s][1].slice(1),d+=v,f+=v}}if(s<e.length-1&&!e[s][1]){e.splice(s,1);break}if(d.length>0||f.length>0){d.length>0&&f.length>0&&(0!==(r=i(f,d))&&(p>=0?e[p][1]+=f.substring(0,r):(e.splice(0,0,[0,f.substring(0,r)]),s++),f=f.substring(r),d=d.substring(r)),0!==(r=o(f,d))&&(e[s][1]=f.substring(f.length-r)+e[s][1],f=f.substring(0,f.length-r),d=d.substring(0,d.length-r)));var _=h+u;0===d.length&&0===f.length?(e.splice(s-_,_),s-=_):0===d.length?(e.splice(s-_,_,[1,f]),s=s-_+1):0===f.length?(e.splice(s-_,_,[t,d]),s=s-_+1):(e.splice(s-_,_,[t,d],[1,f]),s=s-_+2)}0!==s&&0===e[s-1][0]?(e[s-1][1]+=e[s][1],e.splice(s,1)):s++,h=0,u=0,d="",f=""}""===e[e.length-1][1]&&e.pop();var y=!1;for(s=1;s<e.length-1;)0===e[s-1][0]&&0===e[s+1][0]&&(e[s][1].substring(e[s][1].length-e[s-1][1].length)===e[s-1][1]?(e[s][1]=e[s-1][1]+e[s][1].substring(0,e[s][1].length-e[s-1][1].length),e[s+1][1]=e[s-1][1]+e[s+1][1],e.splice(s-1,1),y=!0):e[s][1].substring(0,e[s+1][1].length)==e[s+1][1]&&(e[s-1][1]+=e[s+1][1],e[s][1]=e[s][1].substring(e[s+1][1].length)+e[s+1][1],e.splice(s+1,1),y=!0)),s++;y&&a(e,n)}function s(e){return e>=55296&&e<=56319}function u(e){return e>=56320&&e<=57343}function l(e){return u(e.charCodeAt(0))}function c(e){return s(e.charCodeAt(e.length-1))}function h(e,n,r,i){return c(e)||l(i)?null:function(e){for(var t=[],n=0;n<e.length;n++)e[n][1].length>0&&t.push(e[n]);return t}([[0,e],[t,n],[1,r],[0,i]])}function d(e,t,r){return n(e,t,r,!0)}d.INSERT=1,d.DELETE=t,d.EQUAL=0,e.exports=d},vsh_48640:function(e){"use strict";var t="Function.prototype.bind called on incompatible ",n=Array.prototype.slice,r=Object.prototype.toString,i="[object Function]";e.exports=function(e){var o=this;if("function"!=typeof o||r.call(o)!==i)throw new TypeError(t+o);for(var a,s=n.call(arguments,1),u=function(){if(this instanceof a){var t=o.apply(this,s.concat(n.call(arguments)));return Object(t)===t?t:this}return o.apply(e,s.concat(n.call(arguments)))},l=Math.max(0,o.length-s.length),c=[],h=0;h<l;h++)c.push("$"+h);if(a=Function("binder","return function ("+c.join(",")+"){ return binder.apply(this,arguments); }")(u),o.prototype){var d=function(){};d.prototype=o.prototype,a.prototype=new d,d.prototype=null}return a}},vsh_3569:function(e,t,n){"use strict";var r=n("vsh_48640");e.exports=Function.prototype.bind||r},vsh_60059:function(e){"use strict";var t="Function.prototype.bind called on incompatible ",n=Object.prototype.toString,r=Math.max,i="[object Function]",o=function(e,t){for(var n=[],r=0;r<e.length;r+=1)n[r]=e[r];for(var i=0;i<t.length;i+=1)n[i+e.length]=t[i];return n},a=function(e,t){for(var n=[],r=t||0,i=0;r<e.length;r+=1,i+=1)n[i]=e[r];return n},s=function(e,t){for(var n="",r=0;r<e.length;r+=1)n+=e[r],r+1<e.length&&(n+=t);return n};e.exports=function(e){var u=this;if("function"!=typeof u||n.apply(u)!==i)throw new TypeError(t+u);for(var l,c=a(arguments,1),h=function(){if(this instanceof l){var t=u.apply(this,o(c,arguments));return Object(t)===t?t:this}return u.apply(e,o(c,arguments))},d=r(0,u.length-c.length),f=[],p=0;p<d;p++)f[p]="$"+p;if(l=Function("binder","return function ("+s(f,",")+"){ return binder.apply(this,arguments); }")(h),u.prototype){var v=function(){};v.prototype=u.prototype,l.prototype=new v,v.prototype=null}return l}},vsh_48794:function(e,t,n){"use strict";var r=n("vsh_60059");e.exports=Function.prototype.bind||r},vsh_40783:function(e,t,n){"use strict";var r,i=SyntaxError,o=Function,a=TypeError,s=function(e){try{return o('"use strict"; return ('+e+").constructor;")()}catch(e){}},u=Object.getOwnPropertyDescriptor;if(u)try{u({},"")}catch(e){u=null}var l=function(){throw new a},c=u?function(){try{return l}catch(e){try{return u(arguments,"callee").get}catch(e){return l}}}():l,h=n("vsh_91143")(),d=Object.getPrototypeOf||function(e){return e.__proto__},f={},p="undefined"==typeof Uint8Array?r:d(Uint8Array),v={"%AggregateError%":"undefined"==typeof AggregateError?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?r:ArrayBuffer,"%ArrayIteratorPrototype%":h?d([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":f,"%AsyncGenerator%":f,"%AsyncGeneratorFunction%":f,"%AsyncIteratorPrototype%":f,"%Atomics%":"undefined"==typeof Atomics?r:Atomics,"%BigInt%":"undefined"==typeof BigInt?r:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?r:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?r:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?r:FinalizationRegistry,"%Function%":o,"%GeneratorFunction%":f,"%Int8Array%":"undefined"==typeof Int8Array?r:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?r:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":h?d(d([][Symbol.iterator]())):r,"%JSON%":"object"==typeof JSON?JSON:r,"%Map%":"undefined"==typeof Map?r:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&h?d((new Map)[Symbol.iterator]()):r,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?r:Promise,"%Proxy%":"undefined"==typeof Proxy?r:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?r:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?r:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&h?d((new Set)[Symbol.iterator]()):r,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":h?d(""[Symbol.iterator]()):r,"%Symbol%":h?Symbol:r,"%SyntaxError%":i,"%ThrowTypeError%":c,"%TypedArray%":p,"%TypeError%":a,"%Uint8Array%":"undefined"==typeof Uint8Array?r:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?r:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?r:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?r:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?r:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?r:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?r:WeakSet},g=function e(t){var n;if("%AsyncFunction%"===t)n=s("async function () {}");else if("%GeneratorFunction%"===t)n=s("function* () {}");else if("%AsyncGeneratorFunction%"===t)n=s("async function* () {}");else if("%AsyncGenerator%"===t){var r=e("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if("%AsyncIteratorPrototype%"===t){var i=e("%AsyncGenerator%");i&&(n=d(i.prototype))}return v[t]=n,n},_={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},y=n("vsh_3569"),m=n("vsh_68416"),E=y.call(Function.call,Array.prototype.concat),b=y.call(Function.apply,Array.prototype.splice),T=y.call(Function.call,String.prototype.replace),C=y.call(Function.call,String.prototype.slice),S=y.call(Function.call,RegExp.prototype.exec),w=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,R=/\\(\\)?/g,A=function(e){var t=C(e,0,1),n=C(e,-1);if("%"===t&&"%"!==n)throw new i("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==t)throw new i("invalid intrinsic syntax, expected opening `%`");var r=[];return T(e,w,(function(e,t,n,i){r[r.length]=n?T(i,R,"$1"):t||e})),r},O=function(e,t){var n,r=e;if(m(_,r)&&(r="%"+(n=_[r])[0]+"%"),m(v,r)){var o=v[r];if(o===f&&(o=g(r)),void 0===o&&!t)throw new a("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:r,value:o}}throw new i("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new a("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new a('"allowMissing" argument must be a boolean');if(null===S(/^%?[^%]*%?$/,e))throw new i("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=A(e),r=n.length>0?n[0]:"",o=O("%"+r+"%",t),s=o.name,l=o.value,c=!1,h=o.alias;h&&(r=h[0],b(n,E([0,1],h)));for(var d=1,f=!0;d<n.length;d+=1){var p=n[d],g=C(p,0,1),_=C(p,-1);if(('"'===g||"'"===g||"`"===g||'"'===_||"'"===_||"`"===_)&&g!==_)throw new i("property names with quotes must have matching quotes");if("constructor"!==p&&f||(c=!0),m(v,s="%"+(r+="."+p)+"%"))l=v[s];else if(null!=l){if(!(p in l)){if(!t)throw new a("base intrinsic for "+e+" exists, but the property is not available.");return}if(u&&d+1>=n.length){var y=u(l,p);l=(f=!!y)&&"get"in y&&!("originalValue"in y.get)?y.get:l[p]}else f=m(l,p),l=l[p];f&&!c&&(v[s]=l)}}return l}},vsh_11553:function(e,t,n){var r;
/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */!function(i,o,a,s){"use strict";var u,l=["","webkit","Moz","MS","ms","o"],c=o.createElement("div"),h=Math.round,d=Math.abs,f=Date.now;function p(e,t,n){return setTimeout(b(e,n),t)}function v(e,t,n){return!!Array.isArray(e)&&(g(e,n[t],n),!0)}function g(e,t,n){var r;if(e)if(e.forEach)e.forEach(t,n);else if(e.length!==s)for(r=0;r<e.length;)t.call(n,e[r],r,e),r++;else for(r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r,e)}function _(e,t,n){var r="DEPRECATED METHOD: "+t+"\n"+n+" AT \n";return function(){var t=new Error("get-stack-trace"),n=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=i.console&&(i.console.warn||i.console.log);return o&&o.call(i.console,r,n),e.apply(this,arguments)}}u="function"!=typeof Object.assign?function(e){if(e===s||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==s&&null!==r)for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])}return t}:Object.assign;var y=_((function(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;)(!n||n&&e[r[i]]===s)&&(e[r[i]]=t[r[i]]),i++;return e}),"extend","Use `assign`."),m=_((function(e,t){return y(e,t,!0)}),"merge","Use `assign`.");function E(e,t,n){var r,i=t.prototype;(r=e.prototype=Object.create(i)).constructor=e,r._super=i,n&&u(r,n)}function b(e,t){return function(){return e.apply(t,arguments)}}function T(e,t){return"function"==typeof e?e.apply(t&&t[0]||s,t):e}function C(e,t){return e===s?t:e}function S(e,t,n){g(O(t),(function(t){e.addEventListener(t,n,!1)}))}function w(e,t,n){g(O(t),(function(t){e.removeEventListener(t,n,!1)}))}function R(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function A(e,t){return e.indexOf(t)>-1}function O(e){return e.trim().split(/\s+/g)}function M(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var r=0;r<e.length;){if(n&&e[r][n]==t||!n&&e[r]===t)return r;r++}return-1}function k(e){return Array.prototype.slice.call(e,0)}function I(e,t,n){for(var r=[],i=[],o=0;o<e.length;){var a=t?e[o][t]:e[o];M(i,a)<0&&r.push(e[o]),i[o]=a,o++}return n&&(r=t?r.sort((function(e,n){return e[t]>n[t]})):r.sort()),r}function x(e,t){for(var n,r,i=t[0].toUpperCase()+t.slice(1),o=0;o<l.length;){if((r=(n=l[o])?n+i:t)in e)return r;o++}return s}var N=1;function P(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||i}var L="ontouchstart"in i,D=x(i,"PointerEvent")!==s,F=L&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),B="touch",V="mouse",H=24,U=["x","y"],Z=["clientX","clientY"];function W(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){T(e.options.enable,[e])&&n.handler(t)},this.init()}function j(e,t,n){var r=n.pointers.length,i=n.changedPointers.length,o=1&t&&r-i==0,a=12&t&&r-i==0;n.isFirst=!!o,n.isFinal=!!a,o&&(e.session={}),n.eventType=t,function(e,t){var n=e.session,r=t.pointers,i=r.length;n.firstInput||(n.firstInput=G(t));i>1&&!n.firstMultiple?n.firstMultiple=G(t):1===i&&(n.firstMultiple=!1);var o=n.firstInput,a=n.firstMultiple,u=a?a.center:o.center,l=t.center=z(r);t.timeStamp=f(),t.deltaTime=t.timeStamp-o.timeStamp,t.angle=q(u,l),t.distance=K(u,l),function(e,t){var n=t.center,r=e.offsetDelta||{},i=e.prevDelta||{},o=e.prevInput||{};1!==t.eventType&&4!==o.eventType||(i=e.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=e.offsetDelta={x:n.x,y:n.y});t.deltaX=i.x+(n.x-r.x),t.deltaY=i.y+(n.y-r.y)}(n,t),t.offsetDirection=X(t.deltaX,t.deltaY);var c=Y(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=c.x,t.overallVelocityY=c.y,t.overallVelocity=d(c.x)>d(c.y)?c.x:c.y,t.scale=a?(h=a.pointers,p=r,K(p[0],p[1],Z)/K(h[0],h[1],Z)):1,t.rotation=a?function(e,t){return q(t[1],t[0],Z)+q(e[1],e[0],Z)}(a.pointers,r):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,function(e,t){var n,r,i,o,a=e.lastInterval||t,u=t.timeStamp-a.timeStamp;if(8!=t.eventType&&(u>25||a.velocity===s)){var l=t.deltaX-a.deltaX,c=t.deltaY-a.deltaY,h=Y(u,l,c);r=h.x,i=h.y,n=d(h.x)>d(h.y)?h.x:h.y,o=X(l,c),e.lastInterval=t}else n=a.velocity,r=a.velocityX,i=a.velocityY,o=a.direction;t.velocity=n,t.velocityX=r,t.velocityY=i,t.direction=o}(n,t);var h,p;var v=e.element;R(t.srcEvent.target,v)&&(v=t.srcEvent.target);t.target=v}(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function G(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:h(e.pointers[n].clientX),clientY:h(e.pointers[n].clientY)},n++;return{timeStamp:f(),pointers:t,center:z(t),deltaX:e.deltaX,deltaY:e.deltaY}}function z(e){var t=e.length;if(1===t)return{x:h(e[0].clientX),y:h(e[0].clientY)};for(var n=0,r=0,i=0;i<t;)n+=e[i].clientX,r+=e[i].clientY,i++;return{x:h(n/t),y:h(r/t)}}function Y(e,t,n){return{x:t/e||0,y:n/e||0}}function X(e,t){return e===t?1:d(e)>=d(t)?e<0?2:4:t<0?8:16}function K(e,t,n){n||(n=U);var r=t[n[0]]-e[n[0]],i=t[n[1]]-e[n[1]];return Math.sqrt(r*r+i*i)}function q(e,t,n){n||(n=U);var r=t[n[0]]-e[n[0]],i=t[n[1]]-e[n[1]];return 180*Math.atan2(i,r)/Math.PI}W.prototype={handler:function(){},init:function(){this.evEl&&S(this.element,this.evEl,this.domHandler),this.evTarget&&S(this.target,this.evTarget,this.domHandler),this.evWin&&S(P(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&w(this.element,this.evEl,this.domHandler),this.evTarget&&w(this.target,this.evTarget,this.domHandler),this.evWin&&w(P(this.element),this.evWin,this.domHandler)}};var $={mousedown:1,mousemove:2,mouseup:4},J="mousedown",Q="mousemove mouseup";function ee(){this.evEl=J,this.evWin=Q,this.pressed=!1,W.apply(this,arguments)}E(ee,W,{handler:function(e){var t=$[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:V,srcEvent:e}))}});var te={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},ne={2:B,3:"pen",4:V,5:"kinect"},re="pointerdown",ie="pointermove pointerup pointercancel";function oe(){this.evEl=re,this.evWin=ie,W.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&(re="MSPointerDown",ie="MSPointerMove MSPointerUp MSPointerCancel"),E(oe,W,{handler:function(e){var t=this.store,n=!1,r=e.type.toLowerCase().replace("ms",""),i=te[r],o=ne[e.pointerType]||e.pointerType,a=o==B,s=M(t,e.pointerId,"pointerId");1&i&&(0===e.button||a)?s<0&&(t.push(e),s=t.length-1):12&i&&(n=!0),s<0||(t[s]=e,this.callback(this.manager,i,{pointers:t,changedPointers:[e],pointerType:o,srcEvent:e}),n&&t.splice(s,1))}});var ae={touchstart:1,touchmove:2,touchend:4,touchcancel:8},se="touchstart",ue="touchstart touchmove touchend touchcancel";function le(){this.evTarget=se,this.evWin=ue,this.started=!1,W.apply(this,arguments)}function ce(e,t){var n=k(e.touches),r=k(e.changedTouches);return 12&t&&(n=I(n.concat(r),"identifier",!0)),[n,r]}E(le,W,{handler:function(e){var t=ae[e.type];if(1===t&&(this.started=!0),this.started){var n=ce.call(this,e,t);12&t&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:B,srcEvent:e})}}});var he={touchstart:1,touchmove:2,touchend:4,touchcancel:8},de="touchstart touchmove touchend touchcancel";function fe(){this.evTarget=de,this.targetIds={},W.apply(this,arguments)}function pe(e,t){var n=k(e.touches),r=this.targetIds;if(3&t&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,a=k(e.changedTouches),s=[],u=this.target;if(o=n.filter((function(e){return R(e.target,u)})),1===t)for(i=0;i<o.length;)r[o[i].identifier]=!0,i++;for(i=0;i<a.length;)r[a[i].identifier]&&s.push(a[i]),12&t&&delete r[a[i].identifier],i++;return s.length?[I(o.concat(s),"identifier",!0),s]:void 0}E(fe,W,{handler:function(e){var t=he[e.type],n=pe.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:B,srcEvent:e})}});function ve(){W.apply(this,arguments);var e=b(this.handler,this);this.touch=new fe(this.manager,e),this.mouse=new ee(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function ge(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,_e.call(this,t)):12&e&&_e.call(this,t)}function _e(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout((function(){var e=r.indexOf(n);e>-1&&r.splice(e,1)}),2500)}}function ye(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],o=Math.abs(t-i.x),a=Math.abs(n-i.y);if(o<=25&&a<=25)return!0}return!1}E(ve,W,{handler:function(e,t,n){var r=n.pointerType==B,i=n.pointerType==V;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)ge.call(this,t,n);else if(i&&ye.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var me=x(c.style,"touchAction"),Ee=me!==s,be="compute",Te="auto",Ce="manipulation",Se="none",we="pan-x",Re="pan-y",Ae=function(){if(!Ee)return!1;var e={},t=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){e[n]=!t||i.CSS.supports("touch-action",n)})),e}();function Oe(e,t){this.manager=e,this.set(t)}Oe.prototype={set:function(e){e==be&&(e=this.compute()),Ee&&this.manager.element.style&&Ae[e]&&(this.manager.element.style[me]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return g(this.manager.recognizers,(function(t){T(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))})),function(e){if(A(e,Se))return Se;var t=A(e,we),n=A(e,Re);if(t&&n)return Se;if(t||n)return t?we:Re;if(A(e,Ce))return Ce;return Te}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var r=this.actions,i=A(r,Se)&&!Ae.none,o=A(r,Re)&&!Ae["pan-y"],a=A(r,we)&&!Ae["pan-x"];if(i){var s=1===e.pointers.length,u=e.distance<2,l=e.deltaTime<250;if(s&&u&&l)return}if(!a||!o)return i||o&&6&n||a&&n&H?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var Me=32;function ke(e){this.options=u({},this.defaults,e||{}),this.id=N++,this.manager=null,this.options.enable=C(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function Ie(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function xe(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function Ne(e,t){var n=t.manager;return n?n.get(e):e}function Pe(){ke.apply(this,arguments)}function Le(){Pe.apply(this,arguments),this.pX=null,this.pY=null}function De(){Pe.apply(this,arguments)}function Fe(){ke.apply(this,arguments),this._timer=null,this._input=null}function Be(){Pe.apply(this,arguments)}function Ve(){Pe.apply(this,arguments)}function He(){ke.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Ue(e,t){return(t=t||{}).recognizers=C(t.recognizers,Ue.defaults.preset),new Ze(e,t)}ke.prototype={defaults:{},set:function(e){return u(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(v(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=Ne(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return v(e,"dropRecognizeWith",this)||(e=Ne(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(v(e,"requireFailure",this))return this;var t=this.requireFail;return-1===M(t,e=Ne(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(v(e,"dropRequireFailure",this))return this;e=Ne(e,this);var t=M(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,n=this.state;function r(n){t.manager.emit(n,e)}n<8&&r(t.options.event+Ie(n)),r(t.options.event),e.additionalEvent&&r(e.additionalEvent),n>=8&&r(t.options.event+Ie(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=Me},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=u({},e);if(!T(this.options.enable,[this,t]))return this.reset(),void(this.state=Me);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},E(Pe,ke,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,r=6&t,i=this.attrTest(e);return r&&(8&n||!i)?16|t:r||i?4&n?8|t:2&t?4|t:2:Me}}),E(Le,Pe,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push(Re),e&H&&t.push(we),t},directionTest:function(e){var t=this.options,n=!0,r=e.distance,i=e.direction,o=e.deltaX,a=e.deltaY;return i&t.direction||(6&t.direction?(i=0===o?1:o<0?2:4,n=o!=this.pX,r=Math.abs(e.deltaX)):(i=0===a?1:a<0?8:16,n=a!=this.pY,r=Math.abs(e.deltaY))),e.direction=i,n&&r>t.threshold&&i&t.direction},attrTest:function(e){return Pe.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=xe(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),E(De,Pe,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Se]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),E(Fe,ke,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Te]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,i=e.deltaTime>t.time;if(this._input=e,!r||!n||12&e.eventType&&!i)this.reset();else if(1&e.eventType)this.reset(),this._timer=p((function(){this.state=8,this.tryEmit()}),t.time,this);else if(4&e.eventType)return 8;return Me},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=f(),this.manager.emit(this.options.event,this._input)))}}),E(Be,Pe,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Se]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),E(Ve,Pe,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Le.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return 30&n?t=e.overallVelocity:6&n?t=e.overallVelocityX:n&H&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&d(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=xe(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),E(He,ke,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ce]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,i=e.deltaTime<t.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(r&&i&&n){if(4!=e.eventType)return this.failTimeout();var o=!this.pTime||e.timeStamp-this.pTime<t.interval,a=!this.pCenter||K(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,a&&o?this.count+=1:this.count=1,this._input=e,0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=p((function(){this.state=8,this.tryEmit()}),t.interval,this),2):8}return Me},failTimeout:function(){return this._timer=p((function(){this.state=Me}),this.options.interval,this),Me},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Ue.VERSION="2.0.7",Ue.defaults={domEvents:!1,touchAction:be,enable:!0,inputTarget:null,inputClass:null,preset:[[Be,{enable:!1}],[De,{enable:!1},["rotate"]],[Ve,{direction:6}],[Le,{direction:6},["swipe"]],[He],[He,{event:"doubletap",taps:2},["tap"]],[Fe]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function Ze(e,t){var n;this.options=u({},Ue.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new((n=this).options.inputClass||(D?oe:F?fe:L?ve:ee))(n,j),this.touchAction=new Oe(this,this.options.touchAction),We(this,!0),g(this.options.recognizers,(function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])}),this)}function We(e,t){var n,r=e.element;r.style&&(g(e.options.cssProps,(function(i,o){n=x(r.style,o),t?(e.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=e.oldCssProps[n]||""})),t||(e.oldCssProps={}))}Ze.prototype={set:function(e){return u(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var n;this.touchAction.preventDefaults(e);var r=this.recognizers,i=t.curRecognizer;(!i||i&&8&i.state)&&(i=t.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],2===t.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(e),!i&&14&n.state&&(i=t.curRecognizer=n),o++}},get:function(e){if(e instanceof ke)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(v(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(v(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=M(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(e!==s&&t!==s){var n=this.handlers;return g(O(e),(function(e){n[e]=n[e]||[],n[e].push(t)})),this}},off:function(e,t){if(e!==s){var n=this.handlers;return g(O(e),(function(e){t?n[e]&&n[e].splice(M(n[e],t),1):delete n[e]})),this}},emit:function(e,t){this.options.domEvents&&function(e,t){var n=o.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=t,t.target.dispatchEvent(n)}(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](t),r++}},destroy:function(){this.element&&We(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},u(Ue,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Me,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:H,DIRECTION_ALL:30,Manager:Ze,Input:W,TouchAction:Oe,TouchInput:fe,MouseInput:ee,PointerEventInput:oe,TouchMouseInput:ve,SingleTouchInput:le,Recognizer:ke,AttrRecognizer:Pe,Tap:He,Pan:Le,Swipe:Ve,Pinch:De,Rotate:Be,Press:Fe,on:S,off:w,each:g,merge:m,extend:y,assign:u,inherit:E,bindFn:b,prefixed:x}),(void 0!==i?i:"undefined"!=typeof self?self:{}).Hammer=Ue,(r=function(){return Ue}.call(t,n,t,e))===s||(e.exports=r)}(window,document)},vsh_91143:function(e,t,n){"use strict";var r="undefined"!=typeof Symbol&&Symbol,i=n("vsh_79985");e.exports=function(){return"function"==typeof r&&("function"==typeof Symbol&&("symbol"==typeof r("foo")&&("symbol"==typeof Symbol("bar")&&i())))}},vsh_79985:function(e){"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),n=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var i=Object.getOwnPropertyDescriptor(e,t);if(42!==i.value||!0!==i.enumerable)return!1}return!0}},vsh_3060:function(e,t,n){"use strict";var r=n("vsh_79985");e.exports=function(){return r()&&!!Symbol.toStringTag}},vsh_68416:function(e,t,n){"use strict";var r=n("vsh_48794");e.exports=r.call(Function.call,Object.prototype.hasOwnProperty)},vsh_26252:function(e,t,n){"use strict";var r=n("vsh_40783"),i=n("vsh_68416"),o=n("vsh_65714")(),a=r("%TypeError%"),s={assert:function(e,t){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new a("`O` is not an object");if("string"!=typeof t)throw new a("`slot` must be a string");o.assert(e)},get:function(e,t){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new a("`O` is not an object");if("string"!=typeof t)throw new a("`slot` must be a string");var n=o.get(e);return n&&n["$"+t]},has:function(e,t){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new a("`O` is not an object");if("string"!=typeof t)throw new a("`slot` must be a string");var n=o.get(e);return!!n&&i(n,"$"+t)},set:function(e,t,n){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new a("`O` is not an object");if("string"!=typeof t)throw new a("`slot` must be a string");var r=o.get(e);r||(r={},o.set(e,r)),r["$"+t]=n}};Object.freeze&&Object.freeze(s),e.exports=s},vsh_53290:function(e,t,n){"use strict";n.d(t,{fo:function(){return u},GW:function(){return h}});var r=n("vsh_46308"),i=n("vsh_17075");function o(e,t,n,o){!function(e){if(void 0!==e)throw new Error(r.Cl)}(t),s(i.LD,e,n.toString(),o)}function a(e){var t=[];if(Array.isArray(e)){var n=function(e){for(var t=new Set,n=0,r=e;n<r.length;n++){var i=r[n];if(t.has(i))return i;t.add(i)}}((t=e).map((function(e){return e.key})));if(void 0!==n)throw new Error(r.O8+" "+n.toString())}else t=[e];return t}function s(e,t,n,i){var o=a(i),s={};Reflect.hasOwnMetadata(e,t)&&(s=Reflect.getMetadata(e,t));var u=s[n];if(void 0===u)u=[];else for(var l=function(e){if(o.some((function(t){return t.key===e.key})))throw new Error(r.O8+" "+e.key.toString())},c=0,h=u;c<h.length;c++){l(h[c])}u.push.apply(u,o),s[n]=u,Reflect.defineMetadata(e,s,t)}function u(e){return function(t,n,a){"number"==typeof a?o(t,n,a,e):function(e,t,n){if(void 0!==e.prototype)throw new Error(r.Cl);s(i.Sy,e.constructor,t,n)}(t,n,e)}}function l(e,t){Reflect.decorate(e,t)}function c(e,t){return function(n,r){t(n,r,e)}}function h(e,t,n){"number"==typeof n?l([c(n,e)],t):"string"==typeof n?Reflect.decorate([e],t,n):l([e],t)}},vsh_47531:function(e,t,n){"use strict";n.d(t,{f:function(){return u}});var r=n("vsh_17075"),i=n("vsh_46308"),o=n("vsh_85325"),a=n("vsh_53290");var s,u=(s=r.B8,function(e){return function(t,n,r){if(void 0===e){var u="function"==typeof t?t.name:t.constructor.name;throw new Error((0,i.MS)(u))}return(0,a.fo)(new o.S(s,e))(t,n,r)}})},vsh_99520:function(e,t,n){"use strict";n.d(t,{b:function(){return o}});var r=n("vsh_46308"),i=n("vsh_17075");function o(){return function(e){if(Reflect.hasOwnMetadata(i.FL,e))throw new Error(r.gf);var t=Reflect.getMetadata(i.rQ,e)||[];return Reflect.defineMetadata(i.FL,t,e),e}}},vsh_22392:function(e,t,n){"use strict";n.d(t,{P:function(){return u}});var r=n("vsh_46308"),i=n("vsh_17075"),o=n("vsh_85325");var a,s,u=(a=i.Z8,s=r.DL,function(){return function(e,t){var n=new o.S(a,t);if(Reflect.hasOwnMetadata(a,e.constructor))throw new Error(s);Reflect.defineMetadata(a,n,e.constructor)}})},vsh_46308:function(e,t,n){"use strict";n.d(t,{gf:function(){return r},O8:function(){return i},H1:function(){return o},yu:function(){return a},Kt:function(){return s},VF:function(){return u},cm:function(){return l},GF:function(){return c},eP:function(){return h},MS:function(){return d},QY:function(){return f},jT:function(){return p},NE:function(){return v},pv:function(){return g},d1:function(){return _},FJ:function(){return y},wk:function(){return m},Cl:function(){return E},iI:function(){return b},xU:function(){return T},k_:function(){return C},rR:function(){return S},vD:function(){return w},DL:function(){return R},iD:function(){return A},gq:function(){return O},xZ:function(){return M},YG:function(){return k},aD:function(){return I},$z:function(){return x}});var r="Cannot apply @injectable decorator multiple times.",i="Metadata key was used more than once in a parameter:",o="NULL argument",a="Key Not Found",s="Ambiguous match found for serviceIdentifier:",u="Could not unbind serviceIdentifier:",l="No matching bindings found for serviceIdentifier:",c="Missing required @injectable annotation in:",h="Missing required @inject or @multiInject annotation in:",d=function(e){return"@inject called with undefined this could mean that the class "+e+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},f="Circular dependency found:",p="Invalid binding type:",v="No snapshot available to restore.",g="Invalid return type in middleware. Middleware must return!",_="Value provided to function binding must be a function!",y=function(e){return"You are attempting to construct '"+e+"' in a synchronous way\n but it has asynchronous dependencies."},m="The toSelf function can only be applied when a constructor is used as service identifier",E="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",b=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"The number of constructor arguments in the derived class "+e[0]+" must be >= than the number of constructor arguments of its base class."},T="Invalid Container constructor argument. Container options must be an object.",C="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",S="Invalid Container option. Auto bind injectable must be a boolean",w="Invalid Container option. Skip base check must be a boolean",R="Cannot apply @preDestroy decorator multiple times in the same class",A="Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)",O=function(e,t){return"@postConstruct error in class "+e+": "+t},M=function(e,t){return"@preDestroy error in class "+e+": "+t},k=function(e,t){return"onDeactivation() error in class "+e+": "+t},I=function(e,t){return"It looks like there is a circular dependency in one of the '"+e+"' bindings. Please investigate bindings withservice identifier '"+t+"'."},x="Maximum call stack size exceeded"},vsh_17075:function(e,t,n){"use strict";n.d(t,{vO:function(){return r},dM:function(){return i},Mx:function(){return o},YO:function(){return a},B8:function(){return s},Lc:function(){return u},LD:function(){return l},Sy:function(){return c},FL:function(){return h},rQ:function(){return d},af:function(){return f},Z8:function(){return p},xR:function(){return v}});var r="named",i="name",o="unmanaged",a="optional",s="inject",u="multi_inject",l="inversify:tagged",c="inversify:tagged_props",h="inversify:paramtypes",d="design:paramtypes",f="post_construct",p="pre_destroy";var v=[s,u,i,o,r,a]},vsh_8282:function(e,t,n){"use strict";n.d(t,{W:function(){return We}});var r="Request",i="Singleton",o="Transient",a="ConstantValue",s="Constructor",u="DynamicValue",l="Factory",c="Function",h="Instance",d="Invalid",f="Provider",p="ClassProperty",v="ConstructorArgument",g="Variable",_=0;function y(){return _++}var m=function(){function e(e,t){this.id=y(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=d,this.constraint=function(e){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null}return e.prototype.clone=function(){var t=new e(this.serviceIdentifier,this.scope);return t.activated=t.scope===i&&this.activated,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.factory=this.factory,t.provider=this.provider,t.constraint=this.constraint,t.onActivation=this.onActivation,t.onDeactivation=this.onDeactivation,t.cache=this.cache,t},e}(),E=n("vsh_46308"),b=n("vsh_17075"),T=function(){function e(){}return e.prototype.getConstructorMetadata=function(e){return{compilerGeneratedMetadata:Reflect.getMetadata(b.FL,e),userGeneratedMetadata:Reflect.getMetadata(b.LD,e)||{}}},e.prototype.getPropertiesMetadata=function(e){return Reflect.getMetadata(b.Sy,e)||[]},e}(),C=0,S=1;function w(e){return e instanceof RangeError||e.message===E.$z}function R(e){return"function"==typeof e?e.name:"symbol"==typeof e?e.toString():e}function A(e,t,n){var r="",i=n(e,t);return 0!==i.length&&(r="\nRegistered bindings:",i.forEach((function(e){var t="Object";null!==e.implementationType&&(t=k(e.implementationType)),r=r+"\n "+t,e.constraint.metaData&&(r=r+" - "+e.constraint.metaData)}))),r}function O(e,t){return null!==e.parentRequest&&(e.parentRequest.serviceIdentifier===t||O(e.parentRequest,t))}function M(e){e.childRequests.forEach((function(e){if(O(e,e.serviceIdentifier)){var t=function(e){return function e(t,n){void 0===n&&(n=[]);var r=R(t.serviceIdentifier);return n.push(r),null!==t.parentRequest?e(t.parentRequest,n):n}(e).reverse().join(" --\x3e ")}(e);throw new Error(E.QY+" "+t)}M(e)}))}function k(e){if(e.name)return e.name;var t=e.toString(),n=t.match(/^function\s*([^\s(]+)/);return n?n[1]:"Anonymous function: "+t}var I=function(){function e(e){this.id=y(),this.container=e}return e.prototype.addPlan=function(e){this.plan=e},e.prototype.setCurrentRequest=function(e){this.currentRequest=e},e}(),x=n("vsh_85325"),N=function(e,t){this.parentContext=e,this.rootRequest=t},P=function(){function e(e){this._cb=e}return e.prototype.unwrap=function(){return this._cb()},e}(),L=function(){function e(e){this.str=e}return e.prototype.startsWith=function(e){return 0===this.str.indexOf(e)},e.prototype.endsWith=function(e){var t,n=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},e.prototype.contains=function(e){return-1!==this.str.indexOf(e)},e.prototype.equals=function(e){return this.str===e},e.prototype.value=function(){return this.str},e}(),D=function(){function e(e,t,n,r){this.id=y(),this.type=e,this.serviceIdentifier=n;var i="symbol"==typeof t?t.toString().slice(7,-1):t;this.name=new L(i||""),this.identifier=t,this.metadata=new Array;var o=null;"string"==typeof r?o=new x.S(b.vO,r):r instanceof x.S&&(o=r),null!==o&&this.metadata.push(o)}return e.prototype.hasTag=function(e){for(var t=0,n=this.metadata;t<n.length;t++){if(n[t].key===e)return!0}return!1},e.prototype.isArray=function(){return this.hasTag(b.Lc)},e.prototype.matchesArray=function(e){return this.matchesTag(b.Lc)(e)},e.prototype.isNamed=function(){return this.hasTag(b.vO)},e.prototype.isTagged=function(){return this.metadata.some((function(e){return b.xR.every((function(t){return e.key!==t}))}))},e.prototype.isOptional=function(){return this.matchesTag(b.YO)(!0)},e.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(e){return e.key===b.vO}))[0]:null},e.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(e){return b.xR.every((function(t){return e.key!==t}))})):null},e.prototype.matchesNamedTag=function(e){return this.matchesTag(b.vO)(e)},e.prototype.matchesTag=function(e){var t=this;return function(n){for(var r=0,i=t.metadata;r<i.length;r++){var o=i[r];if(o.key===e&&o.value===n)return!0}return!1}},e}(),F=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};function B(e,t,n,r){var i=e.getConstructorMetadata(n),o=i.compilerGeneratedMetadata;if(void 0===o){var a=E.GF+" "+t+".";throw new Error(a)}var s=i.userGeneratedMetadata,u=Object.keys(s),l=0===n.length&&u.length>0,c=u.length>n.length,h=function(e,t,n,r,i){for(var o=[],a=0;a<i;a++){var s=V(a,e,t,n,r);null!==s&&o.push(s)}return o}(r,t,o,s,l||c?u.length:n.length),d=U(e,n,t);return F(F([],h,!0),d,!0)}function V(e,t,n,r,i){var o=i[e.toString()]||[],a=W(o),s=!0!==a.unmanaged,u=r[e],l=a.inject||a.multiInject;if((u=l||u)instanceof P&&(u=u.unwrap()),s){if(!t&&(u===Object||u===Function||void 0===u)){var c=E.eP+" argument "+e+" in class "+n+".";throw new Error(c)}var h=new D(v,a.targetName,u);return h.metadata=o,h}return null}function H(e,t,n,r){var i=e||t;if(void 0===i){var o=E.GF+" for property "+String(n)+" in class "+r+".";throw new Error(o)}return i}function U(e,t,n){for(var r=e.getPropertiesMetadata(t),i=[],o=Object.getOwnPropertySymbols(r),a=0,s=Object.keys(r).concat(o);a<s.length;a++){var u=s[a],l=r[u],c=W(l),h=c.targetName||u,d=H(c.inject,c.multiInject,u,n),f=new D(p,h,d);f.metadata=l,i.push(f)}var v=Object.getPrototypeOf(t.prototype).constructor;if(v!==Object){var g=U(e,v,n);i=F(F([],i,!0),g,!0)}return i}function Z(e,t){var n=Object.getPrototypeOf(t.prototype).constructor;if(n!==Object){var r=B(e,k(n),n,!0),i=r.map((function(e){return e.metadata.filter((function(e){return e.key===b.Mx}))})),o=[].concat.apply([],i).length,a=r.length-o;return a>0?a:Z(e,n)}return 0}function W(e){var t={};return e.forEach((function(e){t[e.key.toString()]=e.value})),{inject:t[b.B8],multiInject:t[b.Lc],targetName:t[b.dM],unmanaged:t[b.Mx]}}var j=function(){function e(e,t,n,r,i){this.id=y(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=i,this.childRequests=[],this.bindings=Array.isArray(r)?r:[r],this.requestScope=null===n?new Map:null}return e.prototype.addChildRequest=function(t,n,r){var i=new e(t,this.parentContext,this,n,r);return this.childRequests.push(i),i},e}();function G(e){return e._bindingDictionary}function z(e,t,n,r,i){var o=X(n.container,i.serviceIdentifier),a=[];return o.length===C&&n.container.options.autoBindInjectable&&"function"==typeof i.serviceIdentifier&&e.getConstructorMetadata(i.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(i.serviceIdentifier).toSelf(),o=X(n.container,i.serviceIdentifier)),a=t?o:o.filter((function(e){var t=new j(e.serviceIdentifier,n,r,e,i);return e.constraint(t)})),function(e,t,n,r){switch(t.length){case C:if(n.isOptional())return t;var i=R(e),o=E.cm;throw o+=function(e,t){if(t.isTagged()||t.isNamed()){var n="",r=t.getNamedTag(),i=t.getCustomTags();return null!==r&&(n+=r.toString()+"\n"),null!==i&&i.forEach((function(e){n+=e.toString()+"\n"}))," "+e+"\n "+e+" - "+n}return" "+e}(i,n),o+=A(r,i,X),new Error(o);case S:return t;default:if(n.isArray())return t;i=R(e),o=E.Kt+" "+i;throw o+=A(r,i,X),new Error(o)}}(i.serviceIdentifier,a,i,n.container),a}function Y(e,t,n,r,i,o){var a,s;if(null===i){a=z(e,t,r,null,o),s=new j(n,r,null,a,o);var u=new N(r,s);r.addPlan(u)}else a=z(e,t,r,i,o),s=i.addChildRequest(o.serviceIdentifier,a,o);a.forEach((function(t){var n=null;if(o.isArray())n=s.addChildRequest(t.serviceIdentifier,t,o);else{if(t.cache)return;n=s}if(t.type===h&&null!==t.implementationType){var i=function(e,t){return B(e,k(t),t,!1)}(e,t.implementationType);if(!r.container.options.skipBaseClassChecks){var a=Z(e,t.implementationType);if(i.length<a){var u=E.iI(k(t.implementationType));throw new Error(u)}}i.forEach((function(t){Y(e,!1,t.serviceIdentifier,r,n,t)}))}}))}function X(e,t){var n=[],r=G(e);return r.hasKey(t)?n=r.get(t):null!==e.parent&&(n=X(e.parent,t)),n}function K(e,t,n,r,i,o,a,s){void 0===s&&(s=!1);var u=new I(t),l=function(e,t,n,r,i,o){var a=e?b.Lc:b.B8,s=new x.S(a,n),u=new D(t,r,n,s);if(void 0!==i){var l=new x.S(i,o);u.metadata.push(l)}return u}(n,r,i,"",o,a);try{return Y(e,s,i,u,null,l),u}catch(e){throw w(e)&&M(u.plan.rootRequest),e}}function q(e){return("object"==typeof e&&null!==e||"function"==typeof e)&&"function"==typeof e.then}function $(e){return!!q(e)||Array.isArray(e)&&e.some(q)}var J,Q=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},ee=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},te=function(e,t,n){e.has(t.id)||e.set(t.id,n)},ne=function(e,t){e.cache=t,e.activated=!0,q(t)&&re(e,t)},re=function(e,t){return Q(void 0,void 0,void 0,(function(){var n,r;return ee(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,t];case 1:return n=i.sent(),e.cache=n,[3,3];case 2:throw r=i.sent(),e.cache=null,e.activated=!1,r;case 3:return[2]}}))}))};!function(e){e.DynamicValue="toDynamicValue",e.Factory="toFactory",e.Provider="toProvider"}(J||(J={}));var ie=function(){return ie=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ie.apply(this,arguments)},oe=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},ae=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},se=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};function ue(e,t,n){var r;if(t.length>0){var i=function(e,t){return e.reduce((function(e,n){var r=t(n);return n.target.type===v?e.constructorInjections.push(r):(e.propertyRequests.push(n),e.propertyInjections.push(r)),e.isAsync||(e.isAsync=$(r)),e}),{constructorInjections:[],propertyInjections:[],propertyRequests:[],isAsync:!1})}(t,n),o=ie(ie({},i),{constr:e});r=i.isAsync?function(e){return oe(this,void 0,void 0,(function(){var t,n;return ae(this,(function(r){switch(r.label){case 0:return[4,ce(e.constructorInjections)];case 1:return t=r.sent(),[4,ce(e.propertyInjections)];case 2:return n=r.sent(),[2,le(ie(ie({},e),{constructorInjections:t,propertyInjections:n}))]}}))}))}(o):le(o)}else r=new e;return r}function le(e){var t,n=new((t=e.constr).bind.apply(t,se([void 0],e.constructorInjections,!1)));return e.propertyRequests.forEach((function(t,r){var i=t.target.identifier,o=e.propertyInjections[r];n[i]=o})),n}function ce(e){return oe(this,void 0,void 0,(function(){var t,n,r,i;return ae(this,(function(o){for(t=[],n=0,r=e;n<r.length;n++)i=r[n],Array.isArray(i)?t.push(Promise.all(i)):t.push(i);return[2,Promise.all(t)]}))}))}function he(e,t){var n=function(e,t){var n,r;if(Reflect.hasMetadata(b.af,e)){var i=Reflect.getMetadata(b.af,e);try{return null===(r=(n=t)[i.value])||void 0===r?void 0:r.call(n)}catch(t){throw new Error((0,E.gq)(e.name,t.message))}}}(e,t);return q(n)?n.then((function(){return t})):t}function de(e,t){e.scope!==i&&function(e,t){var n="Class cannot be instantiated in "+(e.scope===r?"request":"transient")+" scope.";if("function"==typeof e.onDeactivation)throw new Error((0,E.YG)(t.name,n));if(Reflect.hasMetadata(b.Z8,t))throw new Error((0,E.xZ)(t.name,n))}(e,t)}var fe=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},pe=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},ve=function(e){return function(t){t.parentContext.setCurrentRequest(t);var n=t.bindings,r=t.childRequests,i=t.target&&t.target.isArray(),o=!(t.parentRequest&&t.parentRequest.target&&t.target&&t.parentRequest.target.matchesArray(t.target.serviceIdentifier));if(i&&o)return r.map((function(t){return ve(e)(t)}));if(!t.target.isOptional()||0!==n.length){var a=n[0];return me(e,t,a)}}},ge=function(e,t){var n=function(e){switch(e.type){case l:return{factory:e.factory,factoryType:J.Factory};case f:return{factory:e.provider,factoryType:J.Provider};case u:return{factory:e.dynamicValue,factoryType:J.DynamicValue};default:throw new Error("Unexpected factory type "+e.type)}}(e);return function(e,t){try{return e()}catch(e){throw w(e)&&(e=t()),e}}((function(){return n.factory.bind(e)(t)}),(function(){return new Error(E.aD(n.factoryType,t.currentRequest.serviceIdentifier.toString()))}))},_e=function(e,t,n){var r,i=t.childRequests;switch(function(e){var t=null;switch(e.type){case a:case c:t=e.cache;break;case s:case h:t=e.implementationType;break;case u:t=e.dynamicValue;break;case f:t=e.provider;break;case l:t=e.factory}if(null===t){var n=R(e.serviceIdentifier);throw new Error(E.jT+" "+n)}}(n),n.type){case a:case c:r=n.cache;break;case s:r=n.implementationType;break;case h:r=function(e,t,n,r){de(e,t);var i=ue(t,n,r);return q(i)?i.then((function(e){return he(t,e)})):he(t,i)}(n,n.implementationType,i,ve(e));break;default:r=ge(n,t.parentContext)}return r},ye=function(e,t,n){var o=function(e,t){return t.scope===i&&t.activated?t.cache:t.scope===r&&e.has(t.id)?e.get(t.id):null}(e,t);return null!==o||function(e,t,n){t.scope===i&&ne(t,n),t.scope===r&&te(e,t,n)}(e,t,o=n()),o},me=function(e,t,n){return ye(e,n,(function(){var r=_e(e,t,n);return r=q(r)?r.then((function(e){return Ee(t,n,e)})):Ee(t,n,r)}))};function Ee(e,t,n){var r,i=be(e.parentContext,t,n),o=we(e.parentContext.container),a=o.next();do{r=a.value;var s=e.parentContext,u=e.serviceIdentifier,l=Se(r,u);i=q(i)?Ce(l,s,i):Te(l,s,i),a=o.next()}while(!0!==a.done&&!G(r).hasKey(e.serviceIdentifier));return i}var be=function(e,t,n){return"function"==typeof t.onActivation?t.onActivation(e,n):n},Te=function(e,t,n){for(var r=e.next();!r.done;){if(q(n=r.value(t,n)))return Ce(e,t,n);r=e.next()}return n},Ce=function(e,t,n){return fe(void 0,void 0,void 0,(function(){var r,i;return pe(this,(function(o){switch(o.label){case 0:return[4,n];case 1:r=o.sent(),i=e.next(),o.label=2;case 2:return i.done?[3,4]:[4,i.value(t,r)];case 3:return r=o.sent(),i=e.next(),[3,2];case 4:return[2,r]}}))}))},Se=function(e,t){var n=e._activations;return n.hasKey(t)?n.get(t).values():[].values()},we=function(e){for(var t=[e],n=e.parent;null!==n;)t.push(n),n=n.parent;return{next:function(){var e=t.pop();return void 0!==e?{done:!1,value:e}:{done:!0,value:void 0}}}};var Re=function(e,t){var n=e.parentRequest;return null!==n&&(!!t(n)||Re(n,t))},Ae=function(e){return function(t){var n=function(n){return null!==n&&null!==n.target&&n.target.matchesTag(e)(t)};return n.metaData=new x.S(e,t),n}},Oe=Ae(b.vO),Me=function(e){return function(t){var n=null;if(null!==t){if(n=t.bindings[0],"string"==typeof e)return n.serviceIdentifier===e;var r=t.bindings[0].implementationType;return e===r}return!1}},ke=function(){function e(e){this._binding=e}return e.prototype.when=function(e){return this._binding.constraint=e,new Ie(this._binding)},e.prototype.whenTargetNamed=function(e){return this._binding.constraint=Oe(e),new Ie(this._binding)},e.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){return null!==e&&(null!==e.target&&!e.target.isNamed()&&!e.target.isTagged())},new Ie(this._binding)},e.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=Ae(e)(t),new Ie(this._binding)},e.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return null!==t&&Me(e)(t.parentRequest)},new Ie(this._binding)},e.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return null!==t&&Oe(e)(t.parentRequest)},new Ie(this._binding)},e.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(n){return null!==n&&Ae(e)(t)(n.parentRequest)},new Ie(this._binding)},e.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return null!==t&&Re(t,Me(e))},new Ie(this._binding)},e.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return null!==t&&!Re(t,Me(e))},new Ie(this._binding)},e.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return null!==t&&Re(t,Oe(e))},new Ie(this._binding)},e.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return null!==t&&!Re(t,Oe(e))},new Ie(this._binding)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(n){return null!==n&&Re(n,Ae(e)(t))},new Ie(this._binding)},e.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(n){return null!==n&&!Re(n,Ae(e)(t))},new Ie(this._binding)},e.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return null!==t&&Re(t,e)},new Ie(this._binding)},e.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return null!==t&&!Re(t,e)},new Ie(this._binding)},e}(),Ie=function(){function e(e){this._binding=e}return e.prototype.onActivation=function(e){return this._binding.onActivation=e,new ke(this._binding)},e.prototype.onDeactivation=function(e){return this._binding.onDeactivation=e,new ke(this._binding)},e}(),xe=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new ke(this._binding),this._bindingOnSyntax=new Ie(this._binding)}return e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},e}(),Ne=function(){function e(e){this._binding=e}return e.prototype.inRequestScope=function(){return this._binding.scope=r,new xe(this._binding)},e.prototype.inSingletonScope=function(){return this._binding.scope=i,new xe(this._binding)},e.prototype.inTransientScope=function(){return this._binding.scope=o,new xe(this._binding)},e}(),Pe=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new ke(this._binding),this._bindingOnSyntax=new Ie(this._binding),this._bindingInSyntax=new Ne(e)}return e.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},e.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},e.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},e}(),Le=function(){function e(e){this._binding=e}return e.prototype.to=function(e){return this._binding.type=h,this._binding.implementationType=e,new Pe(this._binding)},e.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error(""+E.wk);var e=this._binding.serviceIdentifier;return this.to(e)},e.prototype.toConstantValue=function(e){return this._binding.type=a,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=i,new xe(this._binding)},e.prototype.toDynamicValue=function(e){return this._binding.type=u,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new Pe(this._binding)},e.prototype.toConstructor=function(e){return this._binding.type=s,this._binding.implementationType=e,this._binding.scope=i,new xe(this._binding)},e.prototype.toFactory=function(e){return this._binding.type=l,this._binding.factory=e,this._binding.scope=i,new xe(this._binding)},e.prototype.toFunction=function(e){if("function"!=typeof e)throw new Error(E.d1);var t=this.toConstantValue(e);return this._binding.type=c,this._binding.scope=i,t},e.prototype.toAutoFactory=function(e){return this._binding.type=l,this._binding.factory=function(t){return function(){return t.container.get(e)}},this._binding.scope=i,new xe(this._binding)},e.prototype.toAutoNamedFactory=function(e){return this._binding.type=l,this._binding.factory=function(t){return function(n){return t.container.getNamed(e,n)}},new xe(this._binding)},e.prototype.toProvider=function(e){return this._binding.type=f,this._binding.provider=e,this._binding.scope=i,new xe(this._binding)},e.prototype.toService=function(e){this.toDynamicValue((function(t){return t.container.get(e)}))},e}(),De=function(){function e(){}return e.of=function(t,n,r,i,o){var a=new e;return a.bindings=t,a.middleware=n,a.deactivations=i,a.activations=r,a.moduleActivationStore=o,a},e}();var Fe=function(){function e(){this._map=new Map}return e.prototype.getMap=function(){return this._map},e.prototype.add=function(e,t){if(null==e)throw new Error(E.H1);if(null==t)throw new Error(E.H1);var n=this._map.get(e);void 0!==n?n.push(t):this._map.set(e,[t])},e.prototype.get=function(e){if(null==e)throw new Error(E.H1);var t=this._map.get(e);if(void 0!==t)return t;throw new Error(E.yu)},e.prototype.remove=function(e){if(null==e)throw new Error(E.H1);if(!this._map.delete(e))throw new Error(E.yu)},e.prototype.removeIntersection=function(e){var t=this;this.traverse((function(n,r){var i=e.hasKey(n)?e.get(n):void 0;if(void 0!==i){var o=r.filter((function(e){return!i.some((function(t){return e===t}))}));t._setValue(n,o)}}))},e.prototype.removeByCondition=function(e){var t=this,n=[];return this._map.forEach((function(r,i){for(var o=[],a=0,s=r;a<s.length;a++){var u=s[a];e(u)?n.push(u):o.push(u)}t._setValue(i,o)})),n},e.prototype.hasKey=function(e){if(null==e)throw new Error(E.H1);return this._map.has(e)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,n){e.forEach((function(e){return t.add(n,"object"==typeof(r=e)&&null!==r&&"clone"in r&&"function"==typeof r.clone?e.clone():e);var r}))})),t},e.prototype.traverse=function(e){this._map.forEach((function(t,n){e(n,t)}))},e.prototype._setValue=function(e,t){t.length>0?this._map.set(e,t):this._map.delete(e)},e}(),Be=function(){function e(){this._map=new Map}return e.prototype.remove=function(e){if(this._map.has(e)){var t=this._map.get(e);return this._map.delete(e),t}return this._getEmptyHandlersStore()},e.prototype.addDeactivation=function(e,t,n){this._getModuleActivationHandlers(e).onDeactivations.add(t,n)},e.prototype.addActivation=function(e,t,n){this._getModuleActivationHandlers(e).onActivations.add(t,n)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,n){t._map.set(n,{onActivations:e.onActivations.clone(),onDeactivations:e.onDeactivations.clone()})})),t},e.prototype._getModuleActivationHandlers=function(e){var t=this._map.get(e);return void 0===t&&(t=this._getEmptyHandlersStore(),this._map.set(e,t)),t},e.prototype._getEmptyHandlersStore=function(){return{onActivations:new Fe,onDeactivations:new Fe}},e}(),Ve=function(){return Ve=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ve.apply(this,arguments)},He=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},Ue=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Ze=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},We=function(){function e(e){var t=e||{};if("object"!=typeof t)throw new Error(""+E.xU);if(void 0===t.defaultScope)t.defaultScope=o;else if(t.defaultScope!==i&&t.defaultScope!==o&&t.defaultScope!==r)throw new Error(""+E.k_);if(void 0===t.autoBindInjectable)t.autoBindInjectable=!1;else if("boolean"!=typeof t.autoBindInjectable)throw new Error(""+E.rR);if(void 0===t.skipBaseClassChecks)t.skipBaseClassChecks=!1;else if("boolean"!=typeof t.skipBaseClassChecks)throw new Error(""+E.vD);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=y(),this._bindingDictionary=new Fe,this._snapshots=[],this._middleware=null,this._activations=new Fe,this._deactivations=new Fe,this.parent=null,this._metadataReader=new T,this._moduleActivationStore=new Be}return e.merge=function(t,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var o=new e,a=Ze([t,n],r,!0).map((function(e){return G(e)})),s=G(o);function u(e,t){e.traverse((function(e,n){n.forEach((function(e){t.add(e.serviceIdentifier,e.clone())}))}))}return a.forEach((function(e){u(e,s)})),o},e.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),r=0,i=e;r<i.length;r++){var o=i[r],a=n(o.id);o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)}},e.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return He(this,void 0,void 0,(function(){var t,n,r,i,o;return Ue(this,(function(a){switch(a.label){case 0:t=this._getContainerModuleHelpersFactory(),n=0,r=e,a.label=1;case 1:return n<r.length?(i=r[n],o=t(i.id),[4,i.registry(o.bindFunction,o.unbindFunction,o.isboundFunction,o.rebindFunction,o.unbindAsyncFunction,o.onActivationFunction,o.onDeactivationFunction)]):[3,4];case 2:a.sent(),a.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e.prototype.unload=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.forEach((function(t){var n=e._removeModuleBindings(t.id);e._deactivateSingletons(n),e._removeModuleHandlers(t.id)}))},e.prototype.unloadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return He(this,void 0,void 0,(function(){var t,n,r,i;return Ue(this,(function(o){switch(o.label){case 0:t=0,n=e,o.label=1;case 1:return t<n.length?(r=n[t],i=this._removeModuleBindings(r.id),[4,this._deactivateSingletonsAsync(i)]):[3,4];case 2:o.sent(),this._removeModuleHandlers(r.id),o.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},e.prototype.bind=function(e){var t=this.options.defaultScope||o,n=new m(e,t);return this._bindingDictionary.add(e,n),new Le(n)},e.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},e.prototype.rebindAsync=function(e){return He(this,void 0,void 0,(function(){return Ue(this,(function(t){switch(t.label){case 0:return[4,this.unbindAsync(e)];case 1:return t.sent(),[2,this.bind(e)]}}))}))},e.prototype.unbind=function(e){if(this._bindingDictionary.hasKey(e)){var t=this._bindingDictionary.get(e);this._deactivateSingletons(t)}this._removeServiceFromDictionary(e)},e.prototype.unbindAsync=function(e){return He(this,void 0,void 0,(function(){var t;return Ue(this,(function(n){switch(n.label){case 0:return this._bindingDictionary.hasKey(e)?(t=this._bindingDictionary.get(e),[4,this._deactivateSingletonsAsync(t)]):[3,2];case 1:n.sent(),n.label=2;case 2:return this._removeServiceFromDictionary(e),[2]}}))}))},e.prototype.unbindAll=function(){var e=this;this._bindingDictionary.traverse((function(t,n){e._deactivateSingletons(n)})),this._bindingDictionary=new Fe},e.prototype.unbindAllAsync=function(){return He(this,void 0,void 0,(function(){var e,t=this;return Ue(this,(function(n){switch(n.label){case 0:return e=[],this._bindingDictionary.traverse((function(n,r){e.push(t._deactivateSingletonsAsync(r))})),[4,Promise.all(e)];case 1:return n.sent(),this._bindingDictionary=new Fe,[2]}}))}))},e.prototype.onActivation=function(e,t){this._activations.add(e,t)},e.prototype.onDeactivation=function(e,t){this._deactivations.add(e,t)},e.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},e.prototype.isCurrentBound=function(e){return this._bindingDictionary.hasKey(e)},e.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,b.vO,t)},e.prototype.isBoundTagged=function(e,t,n){var r=!1;if(this._bindingDictionary.hasKey(e)){var i=this._bindingDictionary.get(e),o=function(e,t,n,r){var i=new D(g,"",t,new x.S(n,r)),o=new I(e);return new j(t,o,null,[],i)}(this,e,t,n);r=i.some((function(e){return e.constraint(o)}))}return!r&&this.parent&&(r=this.parent.isBoundTagged(e,t,n)),r},e.prototype.snapshot=function(){this._snapshots.push(De.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()))},e.prototype.restore=function(){var e=this._snapshots.pop();if(void 0===e)throw new Error(E.NE);this._bindingDictionary=e.bindings,this._activations=e.activations,this._deactivations=e.deactivations,this._middleware=e.middleware,this._moduleActivationStore=e.moduleActivationStore},e.prototype.createChild=function(t){var n=new e(t||this.options);return n.parent=this,n},e.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce((function(e,t){return t(e)}),n)},e.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},e.prototype.get=function(e){var t=this._getNotAllArgs(e,!1);return this._getButThrowIfAsync(t)},e.prototype.getAsync=function(e){return He(this,void 0,void 0,(function(){var t;return Ue(this,(function(n){return t=this._getNotAllArgs(e,!1),[2,this._get(t)]}))}))},e.prototype.getTagged=function(e,t,n){var r=this._getNotAllArgs(e,!1,t,n);return this._getButThrowIfAsync(r)},e.prototype.getTaggedAsync=function(e,t,n){return He(this,void 0,void 0,(function(){var r;return Ue(this,(function(i){return r=this._getNotAllArgs(e,!1,t,n),[2,this._get(r)]}))}))},e.prototype.getNamed=function(e,t){return this.getTagged(e,b.vO,t)},e.prototype.getNamedAsync=function(e,t){return this.getTaggedAsync(e,b.vO,t)},e.prototype.getAll=function(e){var t=this._getAllArgs(e);return this._getButThrowIfAsync(t)},e.prototype.getAllAsync=function(e){var t=this._getAllArgs(e);return this._getAll(t)},e.prototype.getAllTagged=function(e,t,n){var r=this._getNotAllArgs(e,!0,t,n);return this._getButThrowIfAsync(r)},e.prototype.getAllTaggedAsync=function(e,t,n){var r=this._getNotAllArgs(e,!0,t,n);return this._getAll(r)},e.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,b.vO,t)},e.prototype.getAllNamedAsync=function(e,t){return this.getAllTaggedAsync(e,b.vO,t)},e.prototype.resolve=function(e){var t=this.isBound(e);t||this.bind(e).toSelf();var n=this.get(e);return t||this.unbind(e),n},e.prototype._preDestroy=function(e,t){if(Reflect.hasMetadata(b.Z8,e))return t[Reflect.getMetadata(b.Z8,e).value]()},e.prototype._removeModuleHandlers=function(e){var t=this._moduleActivationStore.remove(e);this._activations.removeIntersection(t.onActivations),this._deactivations.removeIntersection(t.onDeactivations)},e.prototype._removeModuleBindings=function(e){return this._bindingDictionary.removeByCondition((function(t){return t.moduleId===e}))},e.prototype._deactivate=function(e,t){var n=this,r=Object.getPrototypeOf(t).constructor;try{if(this._deactivations.hasKey(e.serviceIdentifier)){var i=this._deactivateContainer(t,this._deactivations.get(e.serviceIdentifier).values());if(q(i))return this._handleDeactivationError(i.then((function(){return n._propagateContainerDeactivationThenBindingAndPreDestroyAsync(e,t,r)})),r)}var o=this._propagateContainerDeactivationThenBindingAndPreDestroy(e,t,r);if(q(o))return this._handleDeactivationError(o,r)}catch(e){throw new Error(E.YG(r.name,e.message))}},e.prototype._handleDeactivationError=function(e,t){return He(this,void 0,void 0,(function(){var n;return Ue(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,e];case 1:return r.sent(),[3,3];case 2:throw n=r.sent(),new Error(E.YG(t.name,n.message));case 3:return[2]}}))}))},e.prototype._deactivateContainer=function(e,t){for(var n=this,r=t.next();r.value;){var i=r.value(e);if(q(i))return i.then((function(){return n._deactivateContainerAsync(e,t)}));r=t.next()}},e.prototype._deactivateContainerAsync=function(e,t){return He(this,void 0,void 0,(function(){var n;return Ue(this,(function(r){switch(r.label){case 0:n=t.next(),r.label=1;case 1:return n.value?[4,n.value(e)]:[3,3];case 2:return r.sent(),n=t.next(),[3,1];case 3:return[2]}}))}))},e.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(e,t){e._binding.moduleId=t},n=function(n){return function(r){var i=e.rebind(r);return t(i,n),i}},r=function(t){return function(n,r){e._moduleActivationStore.addActivation(t,n,r),e.onActivation(n,r)}},i=function(t){return function(n,r){e._moduleActivationStore.addDeactivation(t,n,r),e.onDeactivation(n,r)}};return function(o){return{bindFunction:(a=o,function(n){var r=e.bind(n);return t(r,a),r}),isboundFunction:function(t){return e.isBound(t)},onActivationFunction:r(o),onDeactivationFunction:i(o),rebindFunction:n(o),unbindFunction:function(t){return e.unbind(t)},unbindAsyncFunction:function(t){return e.unbindAsync(t)}};var a}},e.prototype._getAll=function(e){return Promise.all(this._get(e))},e.prototype._get=function(e){var t=Ve(Ve({},e),{contextInterceptor:function(e){return e},targetType:g});if(this._middleware){var n=this._middleware(t);if(null==n)throw new Error(E.pv);return n}return this._planAndResolve()(t)},e.prototype._getButThrowIfAsync=function(e){var t=this._get(e);if($(t))throw new Error(E.FJ(e.serviceIdentifier));return t},e.prototype._getAllArgs=function(e){return{avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:e}},e.prototype._getNotAllArgs=function(e,t,n,r){return{avoidConstraints:!1,isMultiInject:t,serviceIdentifier:e,key:n,value:r}},e.prototype._planAndResolve=function(){var e=this;return function(t){var n=K(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);return function(e){return ve(e.plan.rootRequest.requestScope)(e.plan.rootRequest)}(n=t.contextInterceptor(n))}},e.prototype._deactivateIfSingleton=function(e){var t=this;if(e.activated)return q(e.cache)?e.cache.then((function(n){return t._deactivate(e,n)})):this._deactivate(e,e.cache)},e.prototype._deactivateSingletons=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];if(q(this._deactivateIfSingleton(r)))throw new Error(E.iD)}},e.prototype._deactivateSingletonsAsync=function(e){return He(this,void 0,void 0,(function(){var t=this;return Ue(this,(function(n){switch(n.label){case 0:return[4,Promise.all(e.map((function(e){return t._deactivateIfSingleton(e)})))];case 1:return n.sent(),[2]}}))}))},e.prototype._propagateContainerDeactivationThenBindingAndPreDestroy=function(e,t,n){return this.parent?this._deactivate.bind(this.parent)(e,t):this._bindingDeactivationAndPreDestroy(e,t,n)},e.prototype._propagateContainerDeactivationThenBindingAndPreDestroyAsync=function(e,t,n){return He(this,void 0,void 0,(function(){return Ue(this,(function(r){switch(r.label){case 0:return this.parent?[4,this._deactivate.bind(this.parent)(e,t)]:[3,2];case 1:return r.sent(),[3,4];case 2:return[4,this._bindingDeactivationAndPreDestroyAsync(e,t,n)];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))},e.prototype._removeServiceFromDictionary=function(e){try{this._bindingDictionary.remove(e)}catch(t){throw new Error(E.VF+" "+R(e))}},e.prototype._bindingDeactivationAndPreDestroy=function(e,t,n){var r=this;if("function"==typeof e.onDeactivation){var i=e.onDeactivation(t);if(q(i))return i.then((function(){return r._preDestroy(n,t)}))}return this._preDestroy(n,t)},e.prototype._bindingDeactivationAndPreDestroyAsync=function(e,t,n){return He(this,void 0,void 0,(function(){return Ue(this,(function(r){switch(r.label){case 0:return"function"!=typeof e.onDeactivation?[3,2]:[4,e.onDeactivation(t)];case 1:r.sent(),r.label=2;case 2:return[4,this._preDestroy(n,t)];case 3:return r.sent(),[2]}}))}))},e}()},vsh_85325:function(e,t,n){"use strict";n.d(t,{S:function(){return i}});var r=n("vsh_17075"),i=function(){function e(e,t){this.key=e,this.value=t}return e.prototype.toString=function(){return this.key===r.vO?"named: "+String(this.value).toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+String(this.value)+" }"},e}()},vsh_36983:function(e){"use strict";var t,n,r=Function.prototype.toString,i="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof i&&"function"==typeof Object.defineProperty)try{t=Object.defineProperty({},"length",{get:function(){throw n}}),n={},i((function(){throw 42}),null,t)}catch(e){e!==n&&(i=null)}else i=null;var o=/^\s*class\b/,a=function(e){try{var t=r.call(e);return o.test(t)}catch(e){return!1}},s=Object.prototype.toString,u="function"==typeof Symbol&&!!Symbol.toStringTag,l="object"==typeof document&&void 0===document.all&&void 0!==document.all?document.all:{};e.exports=i?function(e){if(e===l)return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;try{i(e,null,t)}catch(e){if(e!==n)return!1}return!a(e)}:function(e){if(e===l)return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;if(u)return function(e){try{return!a(e)&&(r.call(e),!0)}catch(e){return!1}}(e);if(a(e))return!1;var t=s.call(e);return"[object Function]"===t||"[object GeneratorFunction]"===t}},vsh_70455:function(e,t,n){"use strict";var r=Date.prototype.getDay,i=Object.prototype.toString,o=n("vsh_3060")();e.exports=function(e){return"object"==typeof e&&null!==e&&(o?function(e){try{return r.call(e),!0}catch(e){return!1}}(e):"[object Date]"===i.call(e))}},vsh_15494:function(e,t,n){"use strict";var r,i,o,a,s=n("vsh_63099"),u=n("vsh_3060")();if(u){r=s("Object.prototype.hasOwnProperty"),i=s("RegExp.prototype.exec"),o={};var l=function(){throw o};a={toString:l,valueOf:l},"symbol"==typeof Symbol.toPrimitive&&(a[Symbol.toPrimitive]=l)}var c=s("Object.prototype.toString"),h=Object.getOwnPropertyDescriptor;e.exports=u?function(e){if(!e||"object"!=typeof e)return!1;var t=h(e,"lastIndex");if(!(t&&r(t,"value")))return!1;try{i(e,a)}catch(e){return e===o}}:function(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&"[object RegExp]"===c(e)}},vsh_38760:function(e,t,n){"use strict";var r=Object.prototype.toString;if(n("vsh_91143")()){var i=Symbol.prototype.toString,o=/^Symbol\(.*\)$/;e.exports=function(e){if("symbol"==typeof e)return!0;if("[object Symbol]"!==r.call(e))return!1;try{return function(e){return"symbol"==typeof e.valueOf()&&o.test(i.call(e))}(e)}catch(e){return!1}}}else e.exports=function(e){return!1}},vsh_71328:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var r=function(){this.__data__=[],this.size=0},i=n("vsh_30637");var o=function(e,t){for(var n=e.length;n--;)if((0,i.Z)(e[n][0],t))return n;return-1},a=Array.prototype.splice;var s=function(e){var t=this.__data__,n=o(t,e);return!(n<0)&&(n==t.length-1?t.pop():a.call(t,n,1),--this.size,!0)};var u=function(e){var t=this.__data__,n=o(t,e);return n<0?void 0:t[n][1]};var l=function(e){return o(this.__data__,e)>-1};var c=function(e,t){var n=this.__data__,r=o(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};function h(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}h.prototype.clear=r,h.prototype.delete=s,h.prototype.get=u,h.prototype.has=l,h.prototype.set=c;var d=h},vsh_87786:function(e,t,n){"use strict";var r=n("vsh_74022"),i=n("vsh_75436");function o(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}o.prototype=(0,r.Z)(i.Z.prototype),o.prototype.constructor=o,t.Z=o},vsh_55254:function(e,t,n){"use strict";var r=n("vsh_54958"),i=n("vsh_69023"),o=(0,r.Z)(i.Z,"Map");t.Z=o},vsh_15125:function(e,t,n){"use strict";n.d(t,{Z:function(){return C}});var r=(0,n("vsh_54958").Z)(Object,"create");var i=function(){this.__data__=r?r(null):{},this.size=0};var o=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},a=Object.prototype.hasOwnProperty;var s=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return a.call(t,e)?t[e]:void 0},u=Object.prototype.hasOwnProperty;var l=function(e){var t=this.__data__;return r?void 0!==t[e]:u.call(t,e)};var c=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this};function h(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}h.prototype.clear=i,h.prototype.delete=o,h.prototype.get=s,h.prototype.has=l,h.prototype.set=c;var d=h,f=n("vsh_71328"),p=n("vsh_55254");var v=function(){this.size=0,this.__data__={hash:new d,map:new(p.Z||f.Z),string:new d}};var g=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var _=function(e,t){var n=e.__data__;return g(t)?n["string"==typeof t?"string":"hash"]:n.map};var y=function(e){var t=_(this,e).delete(e);return this.size-=t?1:0,t};var m=function(e){return _(this,e).get(e)};var E=function(e){return _(this,e).has(e)};var b=function(e,t){var n=_(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function T(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}T.prototype.clear=v,T.prototype.delete=y,T.prototype.get=m,T.prototype.has=E,T.prototype.set=b;var C=T},vsh_14868:function(e,t,n){"use strict";var r=n("vsh_54958"),i=n("vsh_69023"),o=(0,r.Z)(i.Z,"Set");t.Z=o},vsh_27127:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n("vsh_15125");var i=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this};var o=function(e){return this.__data__.has(e)};function a(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r.Z;++t<n;)this.add(e[t])}a.prototype.add=a.prototype.push=i,a.prototype.has=o;var s=a},vsh_95678:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var r=n("vsh_71328");var i=function(){this.__data__=new r.Z,this.size=0};var o=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n};var a=function(e){return this.__data__.get(e)};var s=function(e){return this.__data__.has(e)},u=n("vsh_55254"),l=n("vsh_15125");var c=function(e,t){var n=this.__data__;if(n instanceof r.Z){var i=n.__data__;if(!u.Z||i.length<199)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new l.Z(i)}return n.set(e,t),this.size=n.size,this};function h(e){var t=this.__data__=new r.Z(e);this.size=t.size}h.prototype.clear=i,h.prototype.delete=o,h.prototype.get=a,h.prototype.has=s,h.prototype.set=c;var d=h},vsh_36210:function(e,t,n){"use strict";var r=n("vsh_69023").Z.Symbol;t.Z=r},vsh_46078:function(e,t,n){"use strict";var r=n("vsh_69023").Z.Uint8Array;t.Z=r},vsh_54373:function(e,t,n){"use strict";var r=n("vsh_54958"),i=n("vsh_69023"),o=(0,r.Z)(i.Z,"WeakMap");t.Z=o},vsh_54383:function(e,t){"use strict";t.Z=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},vsh_39809:function(e,t){"use strict";t.Z=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}},vsh_53825:function(e,t){"use strict";t.Z=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}},vsh_81466:function(e,t,n){"use strict";var r=n("vsh_82881");t.Z=function(e,t){return!!(null==e?0:e.length)&&(0,r.Z)(e,t,0)>-1}},vsh_90684:function(e,t){"use strict";t.Z=function(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}},vsh_28866:function(e,t,n){"use strict";var r=n("vsh_16906"),i=n("vsh_22568"),o=n("vsh_85001"),a=n("vsh_25153"),s=n("vsh_61089"),u=n("vsh_15483"),l=Object.prototype.hasOwnProperty;t.Z=function(e,t){var n=(0,o.Z)(e),c=!n&&(0,i.Z)(e),h=!n&&!c&&(0,a.Z)(e),d=!n&&!c&&!h&&(0,u.Z)(e),f=n||c||h||d,p=f?(0,r.Z)(e.length,String):[],v=p.length;for(var g in e)!t&&!l.call(e,g)||f&&("length"==g||h&&("offset"==g||"parent"==g)||d&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||(0,s.Z)(g,v))||p.push(g);return p}},vsh_81030:function(e,t){"use strict";t.Z=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}},vsh_59742:function(e,t){"use strict";t.Z=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}},vsh_87102:function(e,t){"use strict";t.Z=function(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}},vsh_43008:function(e,t){"use strict";t.Z=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},vsh_2900:function(e,t,n){"use strict";var r=n("vsh_63718"),i=n("vsh_30637"),o=Object.prototype.hasOwnProperty;t.Z=function(e,t,n){var a=e[t];o.call(e,t)&&(0,i.Z)(a,n)&&(void 0!==n||t in e)||(0,r.Z)(e,t,n)}},vsh_63718:function(e,t,n){"use strict";var r=n("vsh_44269");t.Z=function(e,t,n){"__proto__"==t&&r.Z?(0,r.Z)(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},vsh_6174:function(e,t){"use strict";t.Z=function(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}},vsh_27064:function(e,t,n){"use strict";n.d(t,{Z:function(){return K}});var r=n("vsh_95678"),i=n("vsh_39809"),o=n("vsh_2900"),a=n("vsh_7829"),s=n("vsh_37930");var u=function(e,t){return e&&(0,a.Z)(t,(0,s.Z)(t),e)},l=n("vsh_7955");var c=function(e,t){return e&&(0,a.Z)(t,(0,l.Z)(t),e)},h=n("vsh_39213"),d=n("vsh_23988"),f=n("vsh_74843");var p=function(e,t){return(0,a.Z)(e,(0,f.Z)(e),t)},v=n("vsh_32491");var g=function(e,t){return(0,a.Z)(e,(0,v.Z)(e),t)},_=n("vsh_64601"),y=n("vsh_38451"),m=n("vsh_83896"),E=Object.prototype.hasOwnProperty;var b=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&E.call(e,"index")&&(n.index=e.index,n.input=e.input),n},T=n("vsh_77161");var C=function(e,t){var n=t?(0,T.Z)(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)},S=/\w*$/;var w=function(e){var t=new e.constructor(e.source,S.exec(e));return t.lastIndex=e.lastIndex,t},R=n("vsh_36210"),A=R.Z?R.Z.prototype:void 0,O=A?A.valueOf:void 0;var M=function(e){return O?Object(O.call(e)):{}},k=n("vsh_91057");var I=function(e,t,n){var r=e.constructor;switch(t){case"[object ArrayBuffer]":return(0,T.Z)(e);case"[object Boolean]":case"[object Date]":return new r(+e);case"[object DataView]":return C(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return(0,k.Z)(e,n);case"[object Map]":case"[object Set]":return new r;case"[object Number]":case"[object String]":return new r(e);case"[object RegExp]":return w(e);case"[object Symbol]":return M(e)}},x=n("vsh_4336"),N=n("vsh_85001"),P=n("vsh_25153"),L=n("vsh_50318");var D=function(e){return(0,L.Z)(e)&&"[object Map]"==(0,m.Z)(e)},F=n("vsh_33721"),B=n("vsh_40013"),V=B.Z&&B.Z.isMap,H=V?(0,F.Z)(V):D,U=n("vsh_89443");var Z=function(e){return(0,L.Z)(e)&&"[object Set]"==(0,m.Z)(e)},W=B.Z&&B.Z.isSet,j=W?(0,F.Z)(W):Z,G="[object Arguments]",z="[object Function]",Y="[object Object]",X={};X[G]=X["[object Array]"]=X["[object ArrayBuffer]"]=X["[object DataView]"]=X["[object Boolean]"]=X["[object Date]"]=X["[object Float32Array]"]=X["[object Float64Array]"]=X["[object Int8Array]"]=X["[object Int16Array]"]=X["[object Int32Array]"]=X["[object Map]"]=X["[object Number]"]=X[Y]=X["[object RegExp]"]=X["[object Set]"]=X["[object String]"]=X["[object Symbol]"]=X["[object Uint8Array]"]=X["[object Uint8ClampedArray]"]=X["[object Uint16Array]"]=X["[object Uint32Array]"]=!0,X["[object Error]"]=X[z]=X["[object WeakMap]"]=!1;var K=function e(t,n,a,l,f,v){var E,T=1&n,C=2&n,S=4&n;if(a&&(E=f?a(t,l,f,v):a(t)),void 0!==E)return E;if(!(0,U.Z)(t))return t;var w=(0,N.Z)(t);if(w){if(E=b(t),!T)return(0,d.Z)(t,E)}else{var R=(0,m.Z)(t),A=R==z||"[object GeneratorFunction]"==R;if((0,P.Z)(t))return(0,h.Z)(t,T);if(R==Y||R==G||A&&!f){if(E=C||A?{}:(0,x.Z)(t),!T)return C?g(t,c(E,t)):p(t,u(E,t))}else{if(!X[R])return f?t:{};E=I(t,R,T)}}v||(v=new r.Z);var O=v.get(t);if(O)return O;if(v.set(t,E),j(t))return t.forEach((function(r){E.add(e(r,n,a,r,t,v))})),E;if(H(t))return t.forEach((function(r,i){E.set(i,e(r,n,a,i,t,v))})),E;var M=S?C?y.Z:_.Z:C?keysIn:s.Z,k=w?void 0:M(t);return(0,i.Z)(k||t,(function(r,i){k&&(r=t[i=r]),(0,o.Z)(E,i,e(r,n,a,i,t,v))})),E}},vsh_74022:function(e,t,n){"use strict";var r=n("vsh_89443"),i=Object.create,o=function(){function e(){}return function(t){if(!(0,r.Z)(t))return{};if(i)return i(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();t.Z=o},vsh_91553:function(e,t,n){"use strict";var r=n("vsh_27127"),i=n("vsh_81466"),o=n("vsh_90684"),a=n("vsh_81030"),s=n("vsh_33721"),u=n("vsh_11730");t.Z=function(e,t,n,l){var c=-1,h=i.Z,d=!0,f=e.length,p=[],v=t.length;if(!f)return p;n&&(t=(0,a.Z)(t,(0,s.Z)(n))),l?(h=o.Z,d=!1):t.length>=200&&(h=u.Z,d=!1,t=new r.Z(t));e:for(;++c<f;){var g=e[c],_=null==n?g:n(g);if(g=l||0!==g?g:0,d&&_==_){for(var y=v;y--;)if(t[y]===_)continue e;p.push(g)}else h(t,_,l)||p.push(g)}return p}},vsh_40916:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n("vsh_5642"),i=n("vsh_76886");var o=function(e,t){return function(n,r){if(null==n)return n;if(!(0,i.Z)(n))return e(n,r);for(var o=n.length,a=t?o:-1,s=Object(n);(t?a--:++a<o)&&!1!==r(s[a],a,s););return n}}(r.Z)},vsh_66478:function(e,t,n){"use strict";var r=n("vsh_2057");t.Z=function(e,t,n){for(var i=-1,o=e.length;++i<o;){var a=e[i],s=t(a);if(null!=s&&(void 0===u?s==s&&!(0,r.Z)(s):n(s,u)))var u=s,l=a}return l}},vsh_61906:function(e,t){"use strict";t.Z=function(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}},vsh_24357:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n("vsh_59742"),i=n("vsh_36210"),o=n("vsh_22568"),a=n("vsh_85001"),s=i.Z?i.Z.isConcatSpreadable:void 0;var u=function(e){return(0,a.Z)(e)||(0,o.Z)(e)||!!(s&&e&&e[s])};var l=function e(t,n,i,o,a){var s=-1,l=t.length;for(i||(i=u),a||(a=[]);++s<l;){var c=t[s];n>0&&i(c)?n>1?e(c,n-1,i,o,a):(0,r.Z)(a,c):o||(a[a.length]=c)}return a}},vsh_517:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var r=function(e){return function(t,n,r){for(var i=-1,o=Object(t),a=r(t),s=a.length;s--;){var u=a[e?s:++i];if(!1===n(o[u],u,o))break}return t}}()},vsh_5642:function(e,t,n){"use strict";var r=n("vsh_517"),i=n("vsh_37930");t.Z=function(e,t){return e&&(0,r.Z)(e,t,i.Z)}},vsh_151:function(e,t,n){"use strict";var r=n("vsh_15238"),i=n("vsh_30306");t.Z=function(e,t){for(var n=0,o=(t=(0,r.Z)(t,e)).length;null!=e&&n<o;)e=e[(0,i.Z)(t[n++])];return n&&n==o?e:void 0}},vsh_39009:function(e,t,n){"use strict";var r=n("vsh_59742"),i=n("vsh_85001");t.Z=function(e,t,n){var o=t(e);return(0,i.Z)(e)?o:(0,r.Z)(o,n(e))}},vsh_73521:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var r=n("vsh_36210"),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=r.Z?r.Z.toStringTag:void 0;var u=function(e){var t=o.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(e){}var i=a.call(e);return r&&(t?e[s]=n:delete e[s]),i},l=Object.prototype.toString;var c=function(e){return l.call(e)},h=r.Z?r.Z.toStringTag:void 0;var d=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":h&&h in Object(e)?u(e):c(e)}},vsh_45605:function(e,t){"use strict";t.Z=function(e,t){return e>t}},vsh_82881:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n("vsh_61906");var i=function(e){return e!=e};var o=function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1};var a=function(e,t,n){return t==t?o(e,t,n):(0,r.Z)(e,i,n)}},vsh_48170:function(e,t,n){"use strict";n.d(t,{Z:function(){return M}});var r=n("vsh_95678"),i=n("vsh_27127"),o=n("vsh_43008"),a=n("vsh_11730");var s=function(e,t,n,r,s,u){var l=1&n,c=e.length,h=t.length;if(c!=h&&!(l&&h>c))return!1;var d=u.get(e);if(d&&u.get(t))return d==t;var f=-1,p=!0,v=2&n?new i.Z:void 0;for(u.set(e,t),u.set(t,e);++f<c;){var g=e[f],_=t[f];if(r)var y=l?r(_,g,f,t,e,u):r(g,_,f,e,t,u);if(void 0!==y){if(y)continue;p=!1;break}if(v){if(!(0,o.Z)(t,(function(e,t){if(!(0,a.Z)(v,t)&&(g===e||s(g,e,n,r,u)))return v.push(t)}))){p=!1;break}}else if(g!==_&&!s(g,_,n,r,u)){p=!1;break}}return u.delete(e),u.delete(t),p},u=n("vsh_36210"),l=n("vsh_46078"),c=n("vsh_30637"),h=n("vsh_44836"),d=n("vsh_74105"),f=u.Z?u.Z.prototype:void 0,p=f?f.valueOf:void 0;var v=function(e,t,n,r,i,o,a){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new l.Z(e),new l.Z(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return(0,c.Z)(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var u=h.Z;case"[object Set]":var f=1&r;if(u||(u=d.Z),e.size!=t.size&&!f)return!1;var v=a.get(e);if(v)return v==t;r|=2,a.set(e,t);var g=s(u(e),u(t),r,i,o,a);return a.delete(e),g;case"[object Symbol]":if(p)return p.call(e)==p.call(t)}return!1},g=n("vsh_64601"),_=Object.prototype.hasOwnProperty;var y=function(e,t,n,r,i,o){var a=1&n,s=(0,g.Z)(e),u=s.length;if(u!=(0,g.Z)(t).length&&!a)return!1;for(var l=u;l--;){var c=s[l];if(!(a?c in t:_.call(t,c)))return!1}var h=o.get(e);if(h&&o.get(t))return h==t;var d=!0;o.set(e,t),o.set(t,e);for(var f=a;++l<u;){var p=e[c=s[l]],v=t[c];if(r)var y=a?r(v,p,c,t,e,o):r(p,v,c,e,t,o);if(!(void 0===y?p===v||i(p,v,n,r,o):y)){d=!1;break}f||(f="constructor"==c)}if(d&&!f){var m=e.constructor,E=t.constructor;m==E||!("constructor"in e)||!("constructor"in t)||"function"==typeof m&&m instanceof m&&"function"==typeof E&&E instanceof E||(d=!1)}return o.delete(e),o.delete(t),d},m=n("vsh_83896"),E=n("vsh_85001"),b=n("vsh_25153"),T=n("vsh_15483"),C="[object Arguments]",S="[object Array]",w="[object Object]",R=Object.prototype.hasOwnProperty;var A=function(e,t,n,i,o,a){var u=(0,E.Z)(e),l=(0,E.Z)(t),c=u?S:(0,m.Z)(e),h=l?S:(0,m.Z)(t),d=(c=c==C?w:c)==w,f=(h=h==C?w:h)==w,p=c==h;if(p&&(0,b.Z)(e)){if(!(0,b.Z)(t))return!1;u=!0,d=!1}if(p&&!d)return a||(a=new r.Z),u||(0,T.Z)(e)?s(e,t,n,i,o,a):v(e,t,c,n,i,o,a);if(!(1&n)){var g=d&&R.call(e,"__wrapped__"),_=f&&R.call(t,"__wrapped__");if(g||_){var A=g?e.value():e,O=_?t.value():t;return a||(a=new r.Z),o(A,O,n,i,a)}}return!!p&&(a||(a=new r.Z),y(e,t,n,i,o,a))},O=n("vsh_50318");var M=function e(t,n,r,i,o){return t===n||(null==t||null==n||!(0,O.Z)(t)&&!(0,O.Z)(n)?t!=t&&n!=n:A(t,n,r,i,e,o))}},vsh_3662:function(e,t,n){"use strict";var r=n("vsh_95678"),i=n("vsh_48170");t.Z=function(e,t,n,o){var a=n.length,s=a,u=!o;if(null==e)return!s;for(e=Object(e);a--;){var l=n[a];if(u&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++a<s;){var c=(l=n[a])[0],h=e[c],d=l[1];if(u&&l[2]){if(void 0===h&&!(c in e))return!1}else{var f=new r.Z;if(o)var p=o(h,d,c,e,t,f);if(!(void 0===p?(0,i.Z)(d,h,3,o,f):p))return!1}}return!0}},vsh_13599:function(e,t,n){"use strict";n.d(t,{Z:function(){return _}});var r=n("vsh_3662"),i=n("vsh_16565");var o=function(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}};var a=function(e){var t=(0,i.Z)(e);return 1==t.length&&t[0][2]?o(t[0][0],t[0][1]):function(n){return n===e||(0,r.Z)(n,e,t)}},s=n("vsh_48170"),u=n("vsh_59980"),l=n("vsh_80409"),c=n("vsh_24930"),h=n("vsh_62067"),d=n("vsh_30306");var f=function(e,t){return(0,c.Z)(e)&&(0,h.Z)(t)?o((0,d.Z)(e),t):function(n){var r=(0,u.default)(n,e);return void 0===r&&r===t?(0,l.Z)(n,e):(0,s.Z)(t,r,3)}},p=n("vsh_74069"),v=n("vsh_85001"),g=n("vsh_98460");var _=function(e){return"function"==typeof e?e:null==e?p.Z:"object"==typeof e?(0,v.Z)(e)?f(e[0],e[1]):a(e):(0,g.Z)(e)}},vsh_47902:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n("vsh_24898"),i=(0,n("vsh_32376").Z)(Object.keys,Object),o=Object.prototype.hasOwnProperty;var a=function(e){if(!(0,r.Z)(e))return i(e);var t=[];for(var n in Object(e))o.call(e,n)&&"constructor"!=n&&t.push(n);return t}},vsh_75436:function(e,t){"use strict";t.Z=function(){}},vsh_36849:function(e,t){"use strict";t.Z=function(e,t){return e<t}},vsh_92574:function(e,t,n){"use strict";var r=n("vsh_40916"),i=n("vsh_76886");t.Z=function(e,t){var n=-1,o=(0,i.Z)(e)?Array(e.length):[];return(0,r.Z)(e,(function(e,r,i){o[++n]=t(e,r,i)})),o}},vsh_49548:function(e,t,n){"use strict";n.d(t,{Z:function(){return w}});var r=n("vsh_95678"),i=n("vsh_63718"),o=n("vsh_30637");var a=function(e,t,n){(void 0!==n&&!(0,o.Z)(e[t],n)||void 0===n&&!(t in e))&&(0,i.Z)(e,t,n)},s=n("vsh_517"),u=n("vsh_39213"),l=n("vsh_91057"),c=n("vsh_23988"),h=n("vsh_4336"),d=n("vsh_22568"),f=n("vsh_85001"),p=n("vsh_91162"),v=n("vsh_25153"),g=n("vsh_46775"),_=n("vsh_89443"),y=n("vsh_48397"),m=n("vsh_15483");var E=function(e,t){if("__proto__"!=t)return e[t]},b=n("vsh_7829"),T=n("vsh_7955");var C=function(e){return(0,b.Z)(e,(0,T.Z)(e))};var S=function(e,t,n,r,i,o,s){var b=E(e,n),T=E(t,n),S=s.get(T);if(S)a(e,n,S);else{var w=o?o(b,T,n+"",e,t,s):void 0,R=void 0===w;if(R){var A=(0,f.Z)(T),O=!A&&(0,v.Z)(T),M=!A&&!O&&(0,m.Z)(T);w=T,A||O||M?(0,f.Z)(b)?w=b:(0,p.Z)(b)?w=(0,c.Z)(b):O?(R=!1,w=(0,u.Z)(T,!0)):M?(R=!1,w=(0,l.Z)(T,!0)):w=[]:(0,y.Z)(T)||(0,d.Z)(T)?(w=b,(0,d.Z)(b)?w=C(b):(0,_.Z)(b)&&!(0,g.default)(b)||(w=(0,h.Z)(T))):R=!1}R&&(s.set(T,w),i(w,T,r,o,s),s.delete(T)),a(e,n,w)}};var w=function e(t,n,i,o,u){t!==n&&(0,s.Z)(n,(function(s,l){if((0,_.Z)(s))u||(u=new r.Z),S(t,n,l,i,e,o,u);else{var c=o?o(E(t,l),s,l+"",t,n,u):void 0;void 0===c&&(c=s),a(t,l,c)}}),T.Z)}},vsh_11139:function(e,t,n){"use strict";var r=n("vsh_151"),i=n("vsh_66869"),o=n("vsh_15238");t.Z=function(e,t,n){for(var a=-1,s=t.length,u={};++a<s;){var l=t[a],c=(0,r.Z)(e,l);n(c,l)&&(0,i.Z)(u,(0,o.Z)(l,e),c)}return u}},vsh_29150:function(e,t){"use strict";t.Z=function(e){return function(t){return null==t?void 0:t[e]}}},vsh_11153:function(e,t,n){"use strict";var r=n("vsh_69652"),i=n("vsh_61089"),o=Array.prototype.splice;t.Z=function(e,t){for(var n=e?t.length:0,a=n-1;n--;){var s=t[n];if(n==a||s!==u){var u=s;(0,i.Z)(s)?o.call(e,s,1):(0,r.Z)(e,s)}}return e}},vsh_68319:function(e,t,n){"use strict";var r=n("vsh_74069"),i=n("vsh_70240"),o=n("vsh_78957");t.Z=function(e,t){return(0,o.Z)((0,i.Z)(e,t,r.Z),e+"")}},vsh_66869:function(e,t,n){"use strict";var r=n("vsh_2900"),i=n("vsh_15238"),o=n("vsh_61089"),a=n("vsh_89443"),s=n("vsh_30306");t.Z=function(e,t,n,u){if(!(0,a.Z)(e))return e;for(var l=-1,c=(t=(0,i.Z)(t,e)).length,h=c-1,d=e;null!=d&&++l<c;){var f=(0,s.Z)(t[l]),p=n;if(l!=h){var v=d[f];void 0===(p=u?u(v,f,d):void 0)&&(p=(0,a.Z)(v)?v:(0,o.Z)(t[l+1])?[]:{})}(0,r.Z)(d,f,p),d=d[f]}return e}},vsh_95656:function(e,t){"use strict";t.Z=function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o}},vsh_16906:function(e,t){"use strict";t.Z=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},vsh_83566:function(e,t,n){"use strict";var r=n("vsh_36210"),i=n("vsh_81030"),o=n("vsh_85001"),a=n("vsh_2057"),s=r.Z?r.Z.prototype:void 0,u=s?s.toString:void 0;t.Z=function e(t){if("string"==typeof t)return t;if((0,o.Z)(t))return(0,i.Z)(t,e)+"";if((0,a.Z)(t))return u?u.call(t):"";var n=t+"";return"0"==n&&1/t==-Infinity?"-0":n}},vsh_33721:function(e,t){"use strict";t.Z=function(e){return function(t){return e(t)}}},vsh_95216:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var r=n("vsh_27127"),i=n("vsh_81466"),o=n("vsh_90684"),a=n("vsh_11730"),s=n("vsh_14868"),u=n("vsh_4561"),l=n("vsh_74105"),c=s.Z&&1/(0,l.Z)(new s.Z([,-0]))[1]==1/0?function(e){return new s.Z(e)}:u.default;var h=function(e,t,n){var s=-1,u=i.Z,h=e.length,d=!0,f=[],p=f;if(n)d=!1,u=o.Z;else if(h>=200){var v=t?null:c(e);if(v)return(0,l.Z)(v);d=!1,u=a.Z,p=new r.Z}else p=t?[]:f;e:for(;++s<h;){var g=e[s],_=t?t(g):g;if(g=n||0!==g?g:0,d&&_==_){for(var y=p.length;y--;)if(p[y]===_)continue e;t&&p.push(_),f.push(g)}else u(p,_,n)||(p!==f&&p.push(_),f.push(g))}return f}},vsh_69652:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n("vsh_15238"),i=n("vsh_71484"),o=n("vsh_151"),a=n("vsh_95656");var s=function(e,t){return t.length<2?e:(0,o.Z)(e,(0,a.Z)(t,0,-1))},u=n("vsh_30306");var l=function(e,t){return t=(0,r.Z)(t,e),null==(e=s(e,t))||delete e[(0,u.Z)((0,i.Z)(t))]}},vsh_11730:function(e,t){"use strict";t.Z=function(e,t){return e.has(t)}},vsh_92302:function(e,t,n){"use strict";var r=n("vsh_74069");t.Z=function(e){return"function"==typeof e?e:r.Z}},vsh_15238:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n("vsh_85001"),i=n("vsh_24930"),o=n("vsh_21469");var a=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,s=/\\(\\)?/g,u=function(e){var t=(0,o.Z)(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(a,(function(e,n,r,i){t.push(r?i.replace(s,"$1"):n||e)})),t})),l=n("vsh_68576");var c=function(e,t){return(0,r.Z)(e)?e:(0,i.Z)(e,t)?[e]:u((0,l.Z)(e))}},vsh_56354:function(e,t,n){"use strict";var r=n("vsh_95656");t.Z=function(e,t,n){var i=e.length;return n=void 0===n?i:n,!t&&n>=i?e:(0,r.Z)(e,t,n)}},vsh_15618:function(e,t,n){"use strict";var r=n("vsh_82881");t.Z=function(e,t){for(var n=e.length;n--&&(0,r.Z)(t,e[n],0)>-1;);return n}},vsh_86684:function(e,t,n){"use strict";var r=n("vsh_82881");t.Z=function(e,t){for(var n=-1,i=e.length;++n<i&&(0,r.Z)(t,e[n],0)>-1;);return n}},vsh_77161:function(e,t,n){"use strict";var r=n("vsh_46078");t.Z=function(e){var t=new e.constructor(e.byteLength);return new r.Z(t).set(new r.Z(e)),t}},vsh_39213:function(e,t,n){"use strict";var r=n("vsh_69023");e=n.hmd(e);var i="object"==typeof exports&&exports&&!exports.nodeType&&exports,o=i&&e&&!e.nodeType&&e,a=o&&o.exports===i?r.Z.Buffer:void 0,s=a?a.allocUnsafe:void 0;t.Z=function(e,t){if(t)return e.slice();var n=e.length,r=s?s(n):new e.constructor(n);return e.copy(r),r}},vsh_91057:function(e,t,n){"use strict";var r=n("vsh_77161");t.Z=function(e,t){var n=t?(0,r.Z)(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},vsh_95879:function(e,t,n){"use strict";var r=n("vsh_2057");t.Z=function(e,t){if(e!==t){var n=void 0!==e,i=null===e,o=e==e,a=(0,r.Z)(e),s=void 0!==t,u=null===t,l=t==t,c=(0,r.Z)(t);if(!u&&!c&&!a&&e>t||a&&s&&l&&!u&&!c||i&&s&&l||!n&&l||!o)return 1;if(!i&&!a&&!c&&e<t||c&&n&&o&&!i&&!a||u&&n&&o||!s&&o||!l)return-1}return 0}},vsh_23988:function(e,t){"use strict";t.Z=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}},vsh_7829:function(e,t,n){"use strict";var r=n("vsh_2900"),i=n("vsh_63718");t.Z=function(e,t,n,o){var a=!n;n||(n={});for(var s=-1,u=t.length;++s<u;){var l=t[s],c=o?o(n[l],e[l],l,n,e):void 0;void 0===c&&(c=e[l]),a?(0,i.Z)(n,l,c):(0,r.Z)(n,l,c)}return n}},vsh_94895:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=function(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(r,a,n(a),e)}return r},i=n("vsh_40916");var o=function(e,t,n,r){return(0,i.Z)(e,(function(e,i,o){t(r,e,n(e),o)})),r},a=n("vsh_13599"),s=n("vsh_85001");var u=function(e,t){return function(n,i){var u=(0,s.Z)(n)?r:o,l=t?t():{};return u(n,e,(0,a.Z)(i,2),l)}}},vsh_26172:function(e,t,n){"use strict";var r=n("vsh_68319"),i=n("vsh_75012");t.Z=function(e){return(0,r.Z)((function(t,n){var r=-1,o=n.length,a=o>1?n[o-1]:void 0,s=o>2?n[2]:void 0;for(a=e.length>3&&"function"==typeof a?(o--,a):void 0,s&&(0,i.Z)(n[0],n[1],s)&&(a=o<3?void 0:a,o=1),t=Object(t);++r<o;){var u=n[r];u&&e(t,u,r,a)}return t}))}},vsh_78908:function(e,t,n){"use strict";n.d(t,{Z:function(){return F}});var r=n("vsh_87102");var i=function(e){return function(t){return null==e?void 0:e[t]}}({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),o=n("vsh_68576"),a=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,s=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");var u=function(e){return(e=(0,o.Z)(e))&&e.replace(a,i).replace(s,"")},l=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var c=function(e){return e.match(l)||[]},h=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var d=function(e){return h.test(e)},f="\\u2700-\\u27bf",p="a-z\\xdf-\\xf6\\xf8-\\xff",v="A-Z\\xc0-\\xd6\\xd8-\\xde",g="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",_="["+g+"]",y="\\d+",m="[\\u2700-\\u27bf]",E="["+p+"]",b="[^\\ud800-\\udfff"+g+y+f+p+v+"]",T="(?:\\ud83c[\\udde6-\\uddff]){2}",C="[\\ud800-\\udbff][\\udc00-\\udfff]",S="["+v+"]",w="(?:"+E+"|"+b+")",R="(?:"+S+"|"+b+")",A="(?:['’](?:d|ll|m|re|s|t|ve))?",O="(?:['’](?:D|LL|M|RE|S|T|VE))?",M="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",k="[\\ufe0e\\ufe0f]?",I=k+M+("(?:\\u200d(?:"+["[^\\ud800-\\udfff]",T,C].join("|")+")"+k+M+")*"),x="(?:"+[m,T,C].join("|")+")"+I,N=RegExp([S+"?"+E+"+"+A+"(?="+[_,S,"$"].join("|")+")",R+"+"+O+"(?="+[_,S+w,"$"].join("|")+")",S+"?"+w+"+"+A,S+"+"+O,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",y,x].join("|"),"g");var P=function(e){return e.match(N)||[]};var L=function(e,t,n){return e=(0,o.Z)(e),void 0===(t=n?void 0:t)?d(e)?P(e):c(e):e.match(t)||[]},D=RegExp("['’]","g");var F=function(e){return function(t){return(0,r.Z)(L(u(t).replace(D,"")),e,"")}}},vsh_96206:function(e,t,n){"use strict";var r=n("vsh_13599"),i=n("vsh_76886"),o=n("vsh_37930");t.Z=function(e){return function(t,n,a){var s=Object(t);if(!(0,i.Z)(t)){var u=(0,r.Z)(n,3);t=(0,o.Z)(t),n=function(e){return u(s[e],e,s)}}var l=e(t,n,a);return l>-1?s[u?t[l]:l]:void 0}}},vsh_6710:function(e,t,n){"use strict";var r=n("vsh_87786"),i=n("vsh_50042"),o=n("vsh_23943"),a=n("vsh_24565"),s=n("vsh_85001"),u=n("vsh_28377");t.Z=function(e){return(0,i.Z)((function(t){var n=t.length,i=n,l=r.Z.prototype.thru;for(e&&t.reverse();i--;){var c=t[i];if("function"!=typeof c)throw new TypeError("Expected a function");if(l&&!h&&"wrapper"==(0,a.Z)(c))var h=new r.Z([],!0)}for(i=h?i:n;++i<n;){c=t[i];var d=(0,a.Z)(c),f="wrapper"==d?(0,o.Z)(c):void 0;h=f&&(0,u.Z)(f[0])&&424==f[1]&&!f[4].length&&1==f[9]?h[(0,a.Z)(f[0])].apply(h,f[3]):1==c.length&&(0,u.Z)(c)?h[d]():h.thru(c)}return function(){var e=arguments,r=e[0];if(h&&1==e.length&&(0,s.Z)(r))return h.plant(r).value();for(var i=0,o=n?t[i].apply(this,e):r;++i<n;)o=t[i].call(this,o);return o}}))}},vsh_44269:function(e,t,n){"use strict";var r=n("vsh_54958"),i=function(){try{var e=(0,r.Z)(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();t.Z=i},vsh_50042:function(e,t,n){"use strict";var r=n("vsh_77704"),i=n("vsh_70240"),o=n("vsh_78957");t.Z=function(e){return(0,o.Z)((0,i.Z)(e,void 0,r.Z),e+"")}},vsh_16169:function(e,t,n){"use strict";var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;t.Z=r},vsh_64601:function(e,t,n){"use strict";var r=n("vsh_39009"),i=n("vsh_74843"),o=n("vsh_37930");t.Z=function(e){return(0,r.Z)(e,o.Z,i.Z)}},vsh_38451:function(e,t,n){"use strict";var r=n("vsh_39009"),i=n("vsh_32491"),o=n("vsh_7955");t.Z=function(e){return(0,r.Z)(e,o.Z,i.Z)}},vsh_23943:function(e,t,n){"use strict";var r=n("vsh_97120"),i=n("vsh_4561"),o=r.Z?function(e){return r.Z.get(e)}:i.default;t.Z=o},vsh_24565:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r={},i=Object.prototype.hasOwnProperty;var o=function(e){for(var t=e.name+"",n=r[t],o=i.call(r,t)?n.length:0;o--;){var a=n[o],s=a.func;if(null==s||s==e)return a.name}return t}},vsh_16565:function(e,t,n){"use strict";var r=n("vsh_62067"),i=n("vsh_37930");t.Z=function(e){for(var t=(0,i.Z)(e),n=t.length;n--;){var o=t[n],a=e[o];t[n]=[o,a,(0,r.Z)(a)]}return t}},vsh_54958:function(e,t,n){"use strict";n.d(t,{Z:function(){return y}});var r,i=n("vsh_46775"),o=n("vsh_69023").Z["__core-js_shared__"],a=(r=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";var s=function(e){return!!a&&a in e},u=n("vsh_89443"),l=n("vsh_67024"),c=/^\[object .+?Constructor\]$/,h=Function.prototype,d=Object.prototype,f=h.toString,p=d.hasOwnProperty,v=RegExp("^"+f.call(p).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var g=function(e){return!(!(0,u.Z)(e)||s(e))&&((0,i.default)(e)?v:c).test((0,l.Z)(e))};var _=function(e,t){return null==e?void 0:e[t]};var y=function(e,t){var n=_(e,t);return g(n)?n:void 0}},vsh_4709:function(e,t,n){"use strict";var r=(0,n("vsh_32376").Z)(Object.getPrototypeOf,Object);t.Z=r},vsh_74843:function(e,t,n){"use strict";var r=n("vsh_53825"),i=n("vsh_91326"),o=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(e){return null==e?[]:(e=Object(e),(0,r.Z)(a(e),(function(t){return o.call(e,t)})))}:i.Z;t.Z=s},vsh_32491:function(e,t,n){"use strict";var r=n("vsh_59742"),i=n("vsh_4709"),o=n("vsh_74843"),a=n("vsh_91326"),s=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)(0,r.Z)(t,(0,o.Z)(e)),e=(0,i.Z)(e);return t}:a.Z;t.Z=s},vsh_83896:function(e,t,n){"use strict";n.d(t,{Z:function(){return C}});var r=n("vsh_54958"),i=n("vsh_69023"),o=(0,r.Z)(i.Z,"DataView"),a=n("vsh_55254"),s=(0,r.Z)(i.Z,"Promise"),u=n("vsh_14868"),l=n("vsh_54373"),c=n("vsh_73521"),h=n("vsh_67024"),d="[object Map]",f="[object Promise]",p="[object Set]",v="[object WeakMap]",g="[object DataView]",_=(0,h.Z)(o),y=(0,h.Z)(a.Z),m=(0,h.Z)(s),E=(0,h.Z)(u.Z),b=(0,h.Z)(l.Z),T=c.Z;(o&&T(new o(new ArrayBuffer(1)))!=g||a.Z&&T(new a.Z)!=d||s&&T(s.resolve())!=f||u.Z&&T(new u.Z)!=p||l.Z&&T(new l.Z)!=v)&&(T=function(e){var t=(0,c.Z)(e),n="[object Object]"==t?e.constructor:void 0,r=n?(0,h.Z)(n):"";if(r)switch(r){case _:return g;case y:return d;case m:return f;case E:return p;case b:return v}return t});var C=T},vsh_91161:function(e,t,n){"use strict";var r=n("vsh_15238"),i=n("vsh_22568"),o=n("vsh_85001"),a=n("vsh_61089"),s=n("vsh_25972"),u=n("vsh_30306");t.Z=function(e,t,n){for(var l=-1,c=(t=(0,r.Z)(t,e)).length,h=!1;++l<c;){var d=(0,u.Z)(t[l]);if(!(h=null!=e&&n(e,d)))break;e=e[d]}return h||++l!=c?h:!!(c=null==e?0:e.length)&&(0,s.Z)(c)&&(0,a.Z)(d,c)&&((0,o.Z)(e)||(0,i.Z)(e))}},vsh_28833:function(e,t){"use strict";var n=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");t.Z=function(e){return n.test(e)}},vsh_4336:function(e,t,n){"use strict";var r=n("vsh_74022"),i=n("vsh_4709"),o=n("vsh_24898");t.Z=function(e){return"function"!=typeof e.constructor||(0,o.Z)(e)?{}:(0,r.Z)((0,i.Z)(e))}},vsh_61089:function(e,t){"use strict";var n=/^(?:0|[1-9]\d*)$/;t.Z=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&n.test(e))&&e>-1&&e%1==0&&e<t}},vsh_75012:function(e,t,n){"use strict";var r=n("vsh_30637"),i=n("vsh_76886"),o=n("vsh_61089"),a=n("vsh_89443");t.Z=function(e,t,n){if(!(0,a.Z)(n))return!1;var s=typeof t;return!!("number"==s?(0,i.Z)(n)&&(0,o.Z)(t,n.length):"string"==s&&t in n)&&(0,r.Z)(n[t],e)}},vsh_24930:function(e,t,n){"use strict";var r=n("vsh_85001"),i=n("vsh_2057"),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;t.Z=function(e,t){if((0,r.Z)(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!(0,i.Z)(e))||(a.test(e)||!o.test(e)||null!=t&&e in Object(t))}},vsh_28377:function(e,t,n){"use strict";n.d(t,{Z:function(){return _}});var r=n("vsh_74022"),i=n("vsh_75436");function o(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}o.prototype=(0,r.Z)(i.Z.prototype),o.prototype.constructor=o;var a=o,s=n("vsh_23943"),u=n("vsh_24565"),l=n("vsh_87786"),c=n("vsh_85001"),h=n("vsh_50318"),d=n("vsh_23988");var f=function(e){if(e instanceof a)return e.clone();var t=new l.Z(e.__wrapped__,e.__chain__);return t.__actions__=(0,d.Z)(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t},p=Object.prototype.hasOwnProperty;function v(e){if((0,h.Z)(e)&&!(0,c.Z)(e)&&!(e instanceof a)){if(e instanceof l.Z)return e;if(p.call(e,"__wrapped__"))return f(e)}return new l.Z(e)}v.prototype=i.Z.prototype,v.prototype.constructor=v;var g=v;var _=function(e){var t=(0,u.Z)(e),n=g[t];if("function"!=typeof n||!(t in a.prototype))return!1;if(e===n)return!0;var r=(0,s.Z)(n);return!!r&&e===r[0]}},vsh_24898:function(e,t){"use strict";var n=Object.prototype;t.Z=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},vsh_62067:function(e,t,n){"use strict";var r=n("vsh_89443");t.Z=function(e){return e==e&&!(0,r.Z)(e)}},vsh_44836:function(e,t){"use strict";t.Z=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}},vsh_97120:function(e,t,n){"use strict";var r=n("vsh_54373"),i=r.Z&&new r.Z;t.Z=i},vsh_40013:function(e,t,n){"use strict";var r=n("vsh_16169");e=n.hmd(e);var i="object"==typeof exports&&exports&&!exports.nodeType&&exports,o=i&&e&&!e.nodeType&&e,a=o&&o.exports===i&&r.Z.process,s=function(){try{var e=o&&o.require&&o.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(e){}}();t.Z=s},vsh_32376:function(e,t){"use strict";t.Z=function(e,t){return function(n){return e(t(n))}}},vsh_70240:function(e,t,n){"use strict";var r=n("vsh_54383"),i=Math.max;t.Z=function(e,t,n){return t=i(void 0===t?e.length-1:t,0),function(){for(var o=arguments,a=-1,s=i(o.length-t,0),u=Array(s);++a<s;)u[a]=o[t+a];a=-1;for(var l=Array(t+1);++a<t;)l[a]=o[a];return l[t]=n(u),(0,r.Z)(e,this,l)}}},vsh_69023:function(e,t,n){"use strict";var r=n("vsh_16169"),i="object"==typeof self&&self&&self.Object===Object&&self,o=r.Z||i||Function("return this")();t.Z=o},vsh_74105:function(e,t){"use strict";t.Z=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}},vsh_78957:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n("vsh_1556"),i=n("vsh_44269"),o=n("vsh_74069"),a=i.Z?function(e,t){return(0,i.Z)(e,"toString",{configurable:!0,enumerable:!1,value:(0,r.Z)(t),writable:!0})}:o.Z,s=(0,n("vsh_59877").Z)(a)},vsh_59877:function(e,t){"use strict";var n=Date.now;t.Z=function(e){var t=0,r=0;return function(){var i=n(),o=16-(i-r);if(r=i,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},vsh_93234:function(e,t,n){"use strict";n.d(t,{Z:function(){return _}});var r=function(e){return e.split("")},i=n("vsh_28833"),o="[\\ud800-\\udfff]",a="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",s="\\ud83c[\\udffb-\\udfff]",u="[^\\ud800-\\udfff]",l="(?:\\ud83c[\\udde6-\\uddff]){2}",c="[\\ud800-\\udbff][\\udc00-\\udfff]",h="(?:"+a+"|"+s+")"+"?",d="[\\ufe0e\\ufe0f]?",f=d+h+("(?:\\u200d(?:"+[u,l,c].join("|")+")"+d+h+")*"),p="(?:"+[u+a+"?",a,l,c,o].join("|")+")",v=RegExp(s+"(?="+s+")|"+p+f,"g");var g=function(e){return e.match(v)||[]};var _=function(e){return(0,i.Z)(e)?g(e):r(e)}},vsh_30306:function(e,t,n){"use strict";var r=n("vsh_2057");t.Z=function(e){if("string"==typeof e||(0,r.Z)(e))return e;var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t}},vsh_67024:function(e,t){"use strict";var n=Function.prototype.toString;t.Z=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},vsh_43744:function(e,t,n){"use strict";var r=n("vsh_2900"),i=n("vsh_7829"),o=n("vsh_26172"),a=n("vsh_76886"),s=n("vsh_24898"),u=n("vsh_37930"),l=Object.prototype.hasOwnProperty,c=(0,o.Z)((function(e,t){if((0,s.Z)(t)||(0,a.Z)(t))(0,i.Z)(t,(0,u.Z)(t),e);else for(var n in t)l.call(t,n)&&(0,r.Z)(e,n,t[n])}));t.Z=c},vsh_65725:function(e,t,n){"use strict";var r=n("vsh_27064");t.Z=function(e){return(0,r.Z)(e,4)}},vsh_47246:function(e,t,n){"use strict";n.r(t);var r=n("vsh_27064");t.default=function(e){return(0,r.Z)(e,5)}},vsh_95436:function(e,t){"use strict";t.Z=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i}},vsh_88157:function(e,t,n){"use strict";var r=n("vsh_59742"),i=n("vsh_24357"),o=n("vsh_23988"),a=n("vsh_85001");t.Z=function(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),n=arguments[0],s=e;s--;)t[s-1]=arguments[s];return(0,r.Z)((0,a.Z)(n)?(0,o.Z)(n):[n],(0,i.Z)(t,1))}},vsh_1556:function(e,t){"use strict";t.Z=function(e){return function(){return e}}},vsh_97348:function(e,t,n){"use strict";n.d(t,{Z:function(){return q}});var r=n("vsh_74069"),i=n("vsh_97120"),o=i.Z?function(e,t){return i.Z.set(e,t),e}:r.Z,a=n("vsh_74022"),s=n("vsh_89443");var u=function(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=(0,a.Z)(e.prototype),r=e.apply(n,t);return(0,s.Z)(r)?r:n}},l=n("vsh_69023");var c=function(e,t,n){var r=1&t,i=u(e);return function t(){var o=this&&this!==l.Z&&this instanceof t?i:e;return o.apply(r?n:this,arguments)}},h=n("vsh_54383"),d=Math.max;var f=function(e,t,n,r){for(var i=-1,o=e.length,a=n.length,s=-1,u=t.length,l=d(o-a,0),c=Array(u+l),h=!r;++s<u;)c[s]=t[s];for(;++i<a;)(h||i<o)&&(c[n[i]]=e[i]);for(;l--;)c[s++]=e[i++];return c},p=Math.max;var v=function(e,t,n,r){for(var i=-1,o=e.length,a=-1,s=n.length,u=-1,l=t.length,c=p(o-s,0),h=Array(c+l),d=!r;++i<c;)h[i]=e[i];for(var f=i;++u<l;)h[f+u]=t[u];for(;++a<s;)(d||i<o)&&(h[f+n[a]]=e[i++]);return h};var g=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r},_=n("vsh_28377"),y=(0,n("vsh_59877").Z)(o),m=/\{\n\/\* \[wrapped with (.+)\] \*/,E=/,? & /;var b=function(e){var t=e.match(m);return t?t[1].split(E):[]},T=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;var C=function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(T,"{\n/* [wrapped with "+t+"] */\n")},S=n("vsh_78957"),w=n("vsh_39809"),R=n("vsh_81466"),A=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];var O=function(e,t){return(0,w.Z)(A,(function(n){var r="_."+n[0];t&n[1]&&!(0,R.Z)(e,r)&&e.push(r)})),e.sort()};var M=function(e,t,n){var r=t+"";return(0,S.Z)(e,C(r,O(b(r),n)))};var k=function(e,t,n,r,i,o,a,s,u,l){var c=8&t;t|=c?32:64,4&(t&=~(c?64:32))||(t&=-4);var h=[e,t,i,c?o:void 0,c?a:void 0,c?void 0:o,c?void 0:a,s,u,l],d=n.apply(void 0,h);return(0,_.Z)(e)&&y(d,h),d.placeholder=r,M(d,e,t)};var I=function(e){return e.placeholder},x=n("vsh_23988"),N=n("vsh_61089"),P=Math.min;var L=function(e,t){for(var n=e.length,r=P(t.length,n),i=(0,x.Z)(e);r--;){var o=t[r];e[r]=(0,N.Z)(o,n)?i[o]:void 0}return e},D="__lodash_placeholder__";var F=function(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n];a!==t&&a!==D||(e[n]=D,o[i++]=n)}return o};var B=function e(t,n,r,i,o,a,s,c,h,d){var p=128&n,_=1&n,y=2&n,m=24&n,E=512&n,b=y?void 0:u(t);return function T(){for(var C=arguments.length,S=Array(C),w=C;w--;)S[w]=arguments[w];if(m)var R=I(T),A=g(S,R);if(i&&(S=f(S,i,o,m)),a&&(S=v(S,a,s,m)),C-=A,m&&C<d){var O=F(S,R);return k(t,n,e,T.placeholder,r,S,O,c,h,d-C)}var M=_?r:this,x=y?M[t]:t;return C=S.length,c?S=L(S,c):E&&C>1&&S.reverse(),p&&h<C&&(S.length=h),this&&this!==l.Z&&this instanceof T&&(x=b||u(x)),x.apply(M,S)}};var V=function(e,t,n){var r=u(e);return function i(){for(var o=arguments.length,a=Array(o),s=o,u=I(i);s--;)a[s]=arguments[s];var c=o<3&&a[0]!==u&&a[o-1]!==u?[]:F(a,u);if((o-=c.length)<n)return k(e,t,B,i.placeholder,void 0,a,c,void 0,void 0,n-o);var d=this&&this!==l.Z&&this instanceof i?r:e;return(0,h.Z)(d,this,a)}};var H=function(e,t,n,r){var i=1&t,o=u(e);return function t(){for(var a=-1,s=arguments.length,u=-1,c=r.length,d=Array(c+s),f=this&&this!==l.Z&&this instanceof t?o:e;++u<c;)d[u]=r[u];for(;s--;)d[u++]=arguments[++a];return(0,h.Z)(f,i?n:this,d)}},U=n("vsh_23943"),Z="__lodash_placeholder__",W=128,j=Math.min;var G=function(e,t){var n=e[1],r=t[1],i=n|r,o=i<131,a=r==W&&8==n||r==W&&256==n&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!o&&!a)return e;1&r&&(e[2]=t[2],i|=1&n?0:4);var s=t[3];if(s){var u=e[3];e[3]=u?f(u,s,t[4]):s,e[4]=u?F(e[3],Z):t[4]}return(s=t[5])&&(u=e[5],e[5]=u?v(u,s,t[6]):s,e[6]=u?F(e[5],Z):t[6]),(s=t[7])&&(e[7]=s),r&W&&(e[8]=null==e[8]?t[8]:j(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i,e},z=n("vsh_22796"),Y=Math.max;var X=function(e,t,n,r,i,a,s,u){var l=2&t;if(!l&&"function"!=typeof e)throw new TypeError("Expected a function");var h=r?r.length:0;if(h||(t&=-97,r=i=void 0),s=void 0===s?s:Y((0,z.Z)(s),0),u=void 0===u?u:(0,z.Z)(u),h-=i?i.length:0,64&t){var d=r,f=i;r=i=void 0}var p=l?void 0:(0,U.Z)(e),v=[e,t,n,r,i,d,f,a,s,u];if(p&&G(v,p),e=v[0],t=v[1],n=v[2],r=v[3],i=v[4],!(u=v[9]=void 0===v[9]?l?0:e.length:Y(v[9]-h,0))&&24&t&&(t&=-25),t&&1!=t)g=8==t||16==t?V(e,t,u):32!=t&&33!=t||i.length?B.apply(void 0,v):H(e,t,n,r);else var g=c(e,t,n);return M((p?o:y)(g,v),e,t)};function K(e,t,n){var r=X(e,8,void 0,void 0,void 0,void 0,void 0,t=n?void 0:t);return r.placeholder=K.placeholder,r}K.placeholder={};var q=K},vsh_96636:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return l}});var r=n("vsh_89443"),i=n("vsh_69023"),o=function(){return i.Z.Date.now()},a=n("vsh_88206"),s=Math.max,u=Math.min;var l=function(e,t,n){var i,l,c,h,d,f,p=0,v=!1,g=!1,_=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var n=i,r=l;return i=l=void 0,p=t,h=e.apply(r,n)}function m(e){return p=e,d=setTimeout(b,t),v?y(e):h}function E(e){var n=e-f;return void 0===f||n>=t||n<0||g&&e-p>=c}function b(){var e=o();if(E(e))return T(e);d=setTimeout(b,function(e){var n=t-(e-f);return g?u(n,c-(e-p)):n}(e))}function T(e){return d=void 0,_&&i?y(e):(i=l=void 0,h)}function C(){var e=o(),n=E(e);if(i=arguments,l=this,f=e,n){if(void 0===d)return m(f);if(g)return d=setTimeout(b,t),y(f)}return void 0===d&&(d=setTimeout(b,t)),h}return t=(0,a.Z)(t)||0,(0,r.Z)(n)&&(v=!!n.leading,c=(g="maxWait"in n)?s((0,a.Z)(n.maxWait)||0,t):c,_="trailing"in n?!!n.trailing:_),C.cancel=function(){void 0!==d&&clearTimeout(d),p=0,i=f=l=d=void 0},C.flush=function(){return void 0===d?h:T(o())},C}},vsh_90786:function(e,t,n){"use strict";var r=n("vsh_91553"),i=n("vsh_24357"),o=n("vsh_68319"),a=n("vsh_91162"),s=(0,o.Z)((function(e,t){return(0,a.Z)(e)?(0,r.Z)(e,(0,i.Z)(t,1,a.Z,!0)):[]}));t.Z=s},vsh_3186:function(e,t,n){"use strict";var r=n("vsh_6174"),i=n("vsh_83566"),o=n("vsh_22796"),a=n("vsh_68576");t.Z=function(e,t,n){e=(0,a.Z)(e),t=(0,i.Z)(t);var s=e.length,u=n=void 0===n?s:(0,r.Z)((0,o.Z)(n),0,s);return(n-=t.length)>=0&&e.slice(n,u)==t}},vsh_30637:function(e,t){"use strict";t.Z=function(e,t){return e===t||e!=e&&t!=t}},vsh_68250:function(e,t,n){"use strict";var r=n("vsh_68576"),i=/[\\^$.*+?()[\]{}|]/g,o=RegExp(i.source);t.Z=function(e){return(e=(0,r.Z)(e))&&o.test(e)?e.replace(i,"\\$&"):e}},vsh_42326:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n("vsh_53825"),i=n("vsh_40916");var o=function(e,t){var n=[];return(0,i.Z)(e,(function(e,r,i){t(e,r,i)&&n.push(e)})),n},a=n("vsh_13599"),s=n("vsh_85001");var u=function(e,t){return((0,s.Z)(e)?r.Z:o)(e,(0,a.Z)(t,3))}},vsh_94760:function(e,t,n){"use strict";var r=n("vsh_96206"),i=n("vsh_51488"),o=(0,r.Z)(i.Z);t.Z=o},vsh_51488:function(e,t,n){"use strict";var r=n("vsh_61906"),i=n("vsh_13599"),o=n("vsh_22796"),a=Math.max;t.Z=function(e,t,n){var s=null==e?0:e.length;if(!s)return-1;var u=null==n?0:(0,o.Z)(n);return u<0&&(u=a(s+u,0)),(0,r.Z)(e,(0,i.Z)(t,3),u)}},vsh_36506:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=function(e,t,n){var r;return n(e,(function(e,n,i){if(t(e,n,i))return r=n,!1})),r},i=n("vsh_5642"),o=n("vsh_13599");var a=function(e,t){return r(e,(0,o.Z)(t,3),i.Z)}},vsh_77704:function(e,t,n){"use strict";var r=n("vsh_24357");t.Z=function(e){return(null==e?0:e.length)?(0,r.Z)(e,1):[]}},vsh_89646:function(e,t,n){"use strict";var r=n("vsh_24357");t.Z=function(e){return(null==e?0:e.length)?(0,r.Z)(e,Infinity):[]}},vsh_32459:function(e,t,n){"use strict";var r=(0,n("vsh_6710").Z)();t.Z=r},vsh_48912:function(e,t,n){"use strict";var r=(0,n("vsh_6710").Z)(!0);t.Z=r},vsh_65726:function(e,t,n){"use strict";var r=n("vsh_39809"),i=n("vsh_40916"),o=n("vsh_92302"),a=n("vsh_85001");t.Z=function(e,t){return((0,a.Z)(e)?r.Z:i.Z)(e,(0,o.Z)(t))}},vsh_59980:function(e,t,n){"use strict";n.r(t);var r=n("vsh_151");t.default=function(e,t,n){var i=null==e?void 0:(0,r.Z)(e,t);return void 0===i?n:i}},vsh_80409:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=function(e,t){return null!=e&&t in Object(e)},i=n("vsh_91161");var o=function(e,t){return null!=e&&(0,i.Z)(e,t,r)}},vsh_74069:function(e,t){"use strict";t.Z=function(e){return e}},vsh_4468:function(e,t,n){"use strict";var r=n("vsh_82881"),i=n("vsh_76886"),o=n("vsh_13867"),a=n("vsh_22796"),s=n("vsh_40164"),u=Math.max;t.Z=function(e,t,n,l){e=(0,i.Z)(e)?e:(0,s.Z)(e),n=n&&!l?(0,a.Z)(n):0;var c=e.length;return n<0&&(n=u(c+n,0)),(0,o.Z)(e)?n<=c&&e.indexOf(t,n)>-1:!!c&&(0,r.Z)(e,t,n)>-1}},vsh_11144:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var r=n("vsh_81030"),i=n("vsh_27127"),o=n("vsh_81466"),a=n("vsh_90684"),s=n("vsh_33721"),u=n("vsh_11730"),l=Math.min;var c=function(e,t,n){for(var c=n?a.Z:o.Z,h=e[0].length,d=e.length,f=d,p=Array(d),v=1/0,g=[];f--;){var _=e[f];f&&t&&(_=(0,r.Z)(_,(0,s.Z)(t))),v=l(_.length,v),p[f]=!n&&(t||h>=120&&_.length>=120)?new i.Z(f&&_):void 0}_=e[0];var y=-1,m=p[0];e:for(;++y<h&&g.length<v;){var E=_[y],b=t?t(E):E;if(E=n||0!==E?E:0,!(m?(0,u.Z)(m,b):c(g,b,n))){for(f=d;--f;){var T=p[f];if(!(T?(0,u.Z)(T,b):c(e[f],b,n)))continue e}m&&m.push(b),g.push(E)}}return g},h=n("vsh_68319"),d=n("vsh_91162");var f=function(e){return(0,d.Z)(e)?e:[]},p=(0,h.Z)((function(e){var t=(0,r.Z)(e,f);return t.length&&t[0]===e[0]?c(t):[]}))},vsh_97811:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n("vsh_1556"),i=n("vsh_5642");var o=function(e,t,n,r){return(0,i.Z)(e,(function(e,i,o){t(r,n(e),i,o)})),r};var a=function(e,t){return function(n,r){return o(n,e,t(r),{})}},s=n("vsh_74069"),u=Object.prototype.toString,l=a((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=u.call(t)),e[t]=n}),(0,r.Z)(s.Z))},vsh_22568:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n("vsh_73521"),i=n("vsh_50318");var o=function(e){return(0,i.Z)(e)&&"[object Arguments]"==(0,r.Z)(e)},a=Object.prototype,s=a.hasOwnProperty,u=a.propertyIsEnumerable,l=o(function(){return arguments}())?o:function(e){return(0,i.Z)(e)&&s.call(e,"callee")&&!u.call(e,"callee")},c=l},vsh_85001:function(e,t){"use strict";var n=Array.isArray;t.Z=n},vsh_76886:function(e,t,n){"use strict";var r=n("vsh_46775"),i=n("vsh_25972");t.Z=function(e){return null!=e&&(0,i.Z)(e.length)&&!(0,r.default)(e)}},vsh_91162:function(e,t,n){"use strict";var r=n("vsh_76886"),i=n("vsh_50318");t.Z=function(e){return(0,i.Z)(e)&&(0,r.Z)(e)}},vsh_82108:function(e,t,n){"use strict";var r=n("vsh_73521"),i=n("vsh_50318");t.Z=function(e){return!0===e||!1===e||(0,i.Z)(e)&&"[object Boolean]"==(0,r.Z)(e)}},vsh_25153:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n("vsh_69023");var i=function(){return!1};e=n.hmd(e);var o="object"==typeof exports&&exports&&!exports.nodeType&&exports,a=o&&e&&!e.nodeType&&e,s=a&&a.exports===o?r.Z.Buffer:void 0,u=(s?s.isBuffer:void 0)||i},vsh_83519:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n("vsh_73521"),i=n("vsh_50318");var o=function(e){return(0,i.Z)(e)&&"[object Date]"==(0,r.Z)(e)},a=n("vsh_33721"),s=n("vsh_40013"),u=s.Z&&s.Z.isDate,l=u?(0,a.Z)(u):o},vsh_72429:function(e,t,n){"use strict";n.r(t);var r=n("vsh_47902"),i=n("vsh_83896"),o=n("vsh_22568"),a=n("vsh_85001"),s=n("vsh_76886"),u=n("vsh_25153"),l=n("vsh_24898"),c=n("vsh_15483"),h=Object.prototype.hasOwnProperty;t.default=function(e){if(null==e)return!0;if((0,s.Z)(e)&&((0,a.Z)(e)||"string"==typeof e||"function"==typeof e.splice||(0,u.Z)(e)||(0,c.Z)(e)||(0,o.Z)(e)))return!e.length;var t=(0,i.Z)(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if((0,l.Z)(e))return!(0,r.Z)(e).length;for(var n in e)if(h.call(e,n))return!1;return!0}},vsh_22023:function(e,t,n){"use strict";n.r(t);var r=n("vsh_48170");t.default=function(e,t){return(0,r.Z)(e,t)}},vsh_46775:function(e,t,n){"use strict";n.r(t);var r=n("vsh_73521"),i=n("vsh_89443");t.default=function(e){if(!(0,i.Z)(e))return!1;var t=(0,r.Z)(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},vsh_25972:function(e,t){"use strict";t.Z=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},vsh_63818:function(e,t,n){"use strict";var r=n("vsh_93301");t.Z=function(e){return(0,r.default)(e)&&e!=+e}},vsh_70098:function(e,t){"use strict";t.Z=function(e){return null==e}},vsh_30187:function(e,t){"use strict";t.Z=function(e){return null===e}},vsh_93301:function(e,t,n){"use strict";n.r(t);var r=n("vsh_73521"),i=n("vsh_50318");t.default=function(e){return"number"==typeof e||(0,i.Z)(e)&&"[object Number]"==(0,r.Z)(e)}},vsh_89443:function(e,t){"use strict";t.Z=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},vsh_50318:function(e,t){"use strict";t.Z=function(e){return null!=e&&"object"==typeof e}},vsh_48397:function(e,t,n){"use strict";var r=n("vsh_73521"),i=n("vsh_4709"),o=n("vsh_50318"),a=Function.prototype,s=Object.prototype,u=a.toString,l=s.hasOwnProperty,c=u.call(Object);t.Z=function(e){if(!(0,o.Z)(e)||"[object Object]"!=(0,r.Z)(e))return!1;var t=(0,i.Z)(e);if(null===t)return!0;var n=l.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&u.call(n)==c}},vsh_13867:function(e,t,n){"use strict";var r=n("vsh_73521"),i=n("vsh_85001"),o=n("vsh_50318");t.Z=function(e){return"string"==typeof e||!(0,i.Z)(e)&&(0,o.Z)(e)&&"[object String]"==(0,r.Z)(e)}},vsh_2057:function(e,t,n){"use strict";var r=n("vsh_73521"),i=n("vsh_50318");t.Z=function(e){return"symbol"==typeof e||(0,i.Z)(e)&&"[object Symbol]"==(0,r.Z)(e)}},vsh_15483:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var r=n("vsh_73521"),i=n("vsh_25972"),o=n("vsh_50318"),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1;var s=function(e){return(0,o.Z)(e)&&(0,i.Z)(e.length)&&!!a[(0,r.Z)(e)]},u=n("vsh_33721"),l=n("vsh_40013"),c=l.Z&&l.Z.isTypedArray,h=c?(0,u.Z)(c):s},vsh_29033:function(e,t,n){"use strict";n.r(t),t.default=function(e){return void 0===e}},vsh_14064:function(e,t,n){"use strict";var r=(0,n("vsh_78908").Z)((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}));t.Z=r},vsh_16698:function(e,t,n){"use strict";var r=n("vsh_63718"),i=(0,n("vsh_94895").Z)((function(e,t,n){(0,r.Z)(e,n,t)}));t.Z=i},vsh_37930:function(e,t,n){"use strict";var r=n("vsh_28866"),i=n("vsh_47902"),o=n("vsh_76886");t.Z=function(e){return(0,o.Z)(e)?(0,r.Z)(e):(0,i.Z)(e)}},vsh_7955:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n("vsh_28866"),i=n("vsh_89443"),o=n("vsh_24898");var a=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t},s=Object.prototype.hasOwnProperty;var u=function(e){if(!(0,i.Z)(e))return a(e);var t=(0,o.Z)(e),n=[];for(var r in e)("constructor"!=r||!t&&s.call(e,r))&&n.push(r);return n},l=n("vsh_76886");var c=function(e){return(0,l.Z)(e)?(0,r.Z)(e,!0):u(e)}},vsh_71484:function(e,t){"use strict";t.Z=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},vsh_58818:function(e,t,n){"use strict";n.r(t);var r=n("vsh_81030"),i=n("vsh_13599"),o=n("vsh_92574"),a=n("vsh_85001");t.default=function(e,t){return((0,a.Z)(e)?r.Z:o.Z)(e,(0,i.Z)(t,3))}},vsh_64026:function(e,t,n){"use strict";var r=n("vsh_63718"),i=n("vsh_5642"),o=n("vsh_13599");t.Z=function(e,t){var n={};return t=(0,o.Z)(t,3),(0,i.Z)(e,(function(e,i,o){(0,r.Z)(n,i,t(e,i,o))})),n}},vsh_36615:function(e,t,n){"use strict";var r=n("vsh_66478"),i=n("vsh_45605"),o=n("vsh_74069");t.Z=function(e){return e&&e.length?(0,r.Z)(e,o.Z,i.Z):void 0}},vsh_53164:function(e,t,n){"use strict";var r=n("vsh_66478"),i=n("vsh_45605"),o=n("vsh_13599");t.Z=function(e,t){return e&&e.length?(0,r.Z)(e,(0,o.Z)(t,2),i.Z):void 0}},vsh_21469:function(e,t,n){"use strict";var r=n("vsh_15125");function i(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(i.Cache||r.Z),n}i.Cache=r.Z,t.Z=i},vsh_82898:function(e,t,n){"use strict";var r=n("vsh_49548"),i=(0,n("vsh_26172").Z)((function(e,t,n){(0,r.Z)(e,t,n)}));t.Z=i},vsh_53690:function(e,t,n){"use strict";var r=n("vsh_49548"),i=(0,n("vsh_26172").Z)((function(e,t,n,i){(0,r.Z)(e,t,n,i)}));t.Z=i},vsh_10717:function(e,t,n){"use strict";var r=n("vsh_66478"),i=n("vsh_36849"),o=n("vsh_74069");t.Z=function(e){return e&&e.length?(0,r.Z)(e,o.Z,i.Z):void 0}},vsh_58140:function(e,t,n){"use strict";var r=n("vsh_66478"),i=n("vsh_13599"),o=n("vsh_36849");t.Z=function(e,t){return e&&e.length?(0,r.Z)(e,(0,i.Z)(t,2),o.Z):void 0}},vsh_79170:function(e,t){"use strict";t.Z=function(e){if("function"!=typeof e)throw new TypeError("Expected a function");return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}},vsh_4561:function(e,t,n){"use strict";n.r(t),t.default=function(){}},vsh_43369:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return d}});var r=n("vsh_81030"),i=n("vsh_27064"),o=n("vsh_69652"),a=n("vsh_15238"),s=n("vsh_7829"),u=n("vsh_48397");var l=function(e){return(0,u.Z)(e)?void 0:e},c=n("vsh_50042"),h=n("vsh_38451"),d=(0,c.Z)((function(e,t){var n={};if(null==e)return n;var u=!1;t=(0,r.Z)(t,(function(t){return t=(0,a.Z)(t,e),u||(u=t.length>1),t})),(0,s.Z)(e,(0,h.Z)(e),n),u&&(n=(0,i.Z)(n,7,l));for(var c=t.length;c--;)(0,o.Z)(n,t[c]);return n}))},vsh_27679:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n("vsh_22796");var i=function(e,t){var n;if("function"!=typeof t)throw new TypeError("Expected a function");return e=(0,r.Z)(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=void 0),n}};var o=function(e){return i(2,e)}},vsh_86982:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n("vsh_11139"),i=n("vsh_80409");var o=function(e,t){return(0,r.Z)(e,t,(function(t,n){return(0,i.Z)(e,n)}))},a=(0,n("vsh_50042").Z)((function(e,t){return null==e?{}:o(e,t)}))},vsh_98460:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n("vsh_29150"),i=n("vsh_151");var o=function(e){return function(t){return(0,i.Z)(t,e)}},a=n("vsh_24930"),s=n("vsh_30306");var u=function(e){return(0,a.Z)(e)?(0,r.Z)((0,s.Z)(e)):o(e)}},vsh_89586:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n("vsh_81030"),i=n("vsh_59980");var o=function(e,t){for(var n=-1,r=t.length,o=Array(r),a=null==e;++n<r;)o[n]=a?void 0:(0,i.default)(e,t[n]);return o},a=n("vsh_11153"),s=n("vsh_95879"),u=n("vsh_50042"),l=n("vsh_61089"),c=(0,u.Z)((function(e,t){var n=null==e?0:e.length,i=o(e,t);return(0,a.Z)(e,(0,r.Z)(t,(function(e){return(0,l.Z)(e,n)?+e:e})).sort(s.Z)),i}))},vsh_3285:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var r=Math.floor,i=Math.random;var o=function(e,t){return e+r(i()*(t-e+1))},a=n("vsh_75012"),s=n("vsh_70884"),u=parseFloat,l=Math.min,c=Math.random;var h=function(e,t,n){if(n&&"boolean"!=typeof n&&(0,a.Z)(e,t,n)&&(t=n=void 0),void 0===n&&("boolean"==typeof t?(n=t,t=void 0):"boolean"==typeof e&&(n=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=(0,s.Z)(e),void 0===t?(t=e,e=0):t=(0,s.Z)(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var i=c();return l(e+i*(t-e+u("1e-"+((i+"").length-1))),t)}return o(e,t)}},vsh_46016:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=Math.ceil,i=Math.max;var o=function(e,t,n,o){for(var a=-1,s=i(r((t-e)/(n||1)),0),u=Array(s);s--;)u[o?s:++a]=e,e+=n;return u},a=n("vsh_75012"),s=n("vsh_70884");var u=function(e){return function(t,n,r){return r&&"number"!=typeof r&&(0,a.Z)(t,n,r)&&(n=r=void 0),t=(0,s.Z)(t),void 0===n?(n=t,t=0):n=(0,s.Z)(n),r=void 0===r?t<n?1:-1:(0,s.Z)(r),o(t,n,r,e)}}()},vsh_26171:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n("vsh_87102"),i=n("vsh_40916"),o=n("vsh_13599");var a=function(e,t,n,r,i){return i(e,(function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)})),n},s=n("vsh_85001");var u=function(e,t,n){var u=(0,s.Z)(e)?r.Z:a,l=arguments.length<3;return u(e,(0,o.Z)(t,4),n,l,i.Z)}},vsh_11967:function(e,t,n){"use strict";var r=n("vsh_66869");t.Z=function(e,t,n){return null==e?e:(0,r.Z)(e,t,n)}},vsh_46782:function(e,t,n){"use strict";var r=n("vsh_66869");t.Z=function(e,t,n,i){return i="function"==typeof i?i:void 0,null==e?e:(0,r.Z)(e,t,n,i)}},vsh_2184:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n("vsh_43008"),i=n("vsh_13599"),o=n("vsh_40916");var a=function(e,t){var n;return(0,o.Z)(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n},s=n("vsh_85001"),u=n("vsh_75012");var l=function(e,t,n){var o=(0,s.Z)(e)?r.Z:a;return n&&(0,u.Z)(e,t,n)&&(t=void 0),o(e,(0,i.Z)(t,3))}},vsh_25264:function(e,t,n){"use strict";var r=n("vsh_6174"),i=n("vsh_83566"),o=n("vsh_22796"),a=n("vsh_68576");t.Z=function(e,t,n){return e=(0,a.Z)(e),n=null==n?0:(0,r.Z)((0,o.Z)(n),0,e.length),t=(0,i.Z)(t),e.slice(n,n+t.length)==t}},vsh_91326:function(e,t){"use strict";t.Z=function(){return[]}},vsh_47253:function(e,t,n){"use strict";n.r(t);var r=n("vsh_96636"),i=n("vsh_89443");t.default=function(e,t,n){var o=!0,a=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return(0,i.Z)(n)&&(o="leading"in n?!!n.leading:o,a="trailing"in n?!!n.trailing:a),(0,r.default)(e,t,{leading:o,maxWait:t,trailing:a})}},vsh_48647:function(e,t,n){"use strict";var r=n("vsh_16906"),i=n("vsh_92302"),o=n("vsh_22796"),a=4294967295,s=Math.min;t.Z=function(e,t){if((e=(0,o.Z)(e))<1||e>9007199254740991)return[];var n=a,u=s(e,a);t=(0,i.Z)(t),e-=a;for(var l=(0,r.Z)(u,t);++n<e;)t(n);return l}},vsh_7207:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var r=n("vsh_36210"),i=n("vsh_23988"),o=n("vsh_83896"),a=n("vsh_76886"),s=n("vsh_13867");var u=function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n},l=n("vsh_44836"),c=n("vsh_74105"),h=n("vsh_93234"),d=n("vsh_40164"),f=r.Z?r.Z.iterator:void 0;var p=function(e){if(!e)return[];if((0,a.Z)(e))return(0,s.Z)(e)?(0,h.Z)(e):(0,i.Z)(e);if(f&&e[f])return u(e[f]());var t=(0,o.Z)(e);return("[object Map]"==t?l.Z:"[object Set]"==t?c.Z:d.Z)(e)}},vsh_70884:function(e,t,n){"use strict";var r=n("vsh_88206"),i=1/0;t.Z=function(e){return e?(e=(0,r.Z)(e))===i||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}},vsh_22796:function(e,t,n){"use strict";var r=n("vsh_70884");t.Z=function(e){var t=(0,r.Z)(e),n=t%1;return t==t?n?t-n:t:0}},vsh_88206:function(e,t,n){"use strict";var r=n("vsh_89443"),i=n("vsh_2057"),o=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,u=/^0o[0-7]+$/i,l=parseInt;t.Z=function(e){if("number"==typeof e)return e;if((0,i.Z)(e))return NaN;if((0,r.Z)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=(0,r.Z)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(o,"");var n=s.test(e);return n||u.test(e)?l(e.slice(2),n?2:8):a.test(e)?NaN:+e}},vsh_68576:function(e,t,n){"use strict";var r=n("vsh_83566");t.Z=function(e){return null==e?"":(0,r.Z)(e)}},vsh_30426:function(e,t,n){"use strict";var r=n("vsh_68576");t.Z=function(e){return(0,r.Z)(e).toUpperCase()}},vsh_47551:function(e,t,n){"use strict";var r=n("vsh_83566"),i=n("vsh_56354"),o=n("vsh_15618"),a=n("vsh_93234"),s=n("vsh_68576"),u=/\s+$/;t.Z=function(e,t,n){if((e=(0,s.Z)(e))&&(n||void 0===t))return e.replace(u,"");if(!e||!(t=(0,r.Z)(t)))return e;var l=(0,a.Z)(e),c=(0,o.Z)(l,(0,a.Z)(t))+1;return(0,i.Z)(l,0,c).join("")}},vsh_40969:function(e,t,n){"use strict";var r=n("vsh_83566"),i=n("vsh_56354"),o=n("vsh_86684"),a=n("vsh_93234"),s=n("vsh_68576"),u=/^\s+/;t.Z=function(e,t,n){if((e=(0,s.Z)(e))&&(n||void 0===t))return e.replace(u,"");if(!e||!(t=(0,r.Z)(t)))return e;var l=(0,a.Z)(e),c=(0,o.Z)(l,(0,a.Z)(t));return(0,i.Z)(l,c).join("")}},vsh_97504:function(e,t,n){"use strict";var r=n("vsh_24357"),i=n("vsh_13599"),o=n("vsh_68319"),a=n("vsh_95216"),s=n("vsh_91162"),u=n("vsh_71484"),l=(0,o.Z)((function(e){var t=(0,u.Z)(e);return(0,s.Z)(t)&&(t=void 0),(0,a.Z)((0,r.Z)(e,1,s.Z,!0),(0,i.Z)(t,2))}));t.Z=l},vsh_54313:function(e,t,n){"use strict";var r=n("vsh_95216");t.Z=function(e){return e&&e.length?(0,r.Z)(e):[]}},vsh_40164:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n("vsh_81030");var i=function(e,t){return(0,r.Z)(t,(function(t){return e[t]}))},o=n("vsh_37930");var a=function(e){return null==e?[]:i(e,(0,o.Z)(e))}},vsh_75712:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n("vsh_53825"),i=n("vsh_68319"),o=n("vsh_91553"),a=n("vsh_24357"),s=n("vsh_95216");var u=function(e,t,n){var r=e.length;if(r<2)return r?(0,s.Z)(e[0]):[];for(var i=-1,u=Array(r);++i<r;)for(var l=e[i],c=-1;++c<r;)c!=i&&(u[i]=(0,o.Z)(u[i]||l,e[c],t,n));return(0,s.Z)((0,a.Z)(u,1),t,n)},l=n("vsh_91162"),c=(0,i.Z)((function(e){return u((0,r.Z)(e,l.Z))}))},vsh_11657:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var r=n("vsh_68319"),i=n("vsh_53825"),o=n("vsh_81030"),a=n("vsh_29150"),s=n("vsh_16906"),u=n("vsh_91162"),l=Math.max;var c=function(e){if(!e||!e.length)return[];var t=0;return e=(0,i.Z)(e,(function(e){if((0,u.Z)(e))return t=l(e.length,t),!0})),(0,s.Z)(t,(function(t){return(0,o.Z)(e,(0,a.Z)(t))}))},h=(0,r.Z)(c)},vsh_14415:function(){},vsh_74683:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});const r=Object.prototype.toString;function i(e){return r.call(e).endsWith("Array]")}class o{constructor(){if(new.target===o)throw new Error("BaseRegression must be subclassed")}predict(e){if("number"==typeof e)return this._predict(e);if(i(e)){const t=[];for(let n=0;n<e.length;n++)t.push(this._predict(e[n]));return t}throw new TypeError("x must be a number or array")}_predict(){throw new Error("_predict must be implemented")}train(){}toString(){return""}toLaTeX(){return""}score(e,t){if(!i(e)||!i(t)||e.length!==t.length)throw new Error("x and y must be arrays of the same length");const n=e.length,r=new Array(n);for(let t=0;t<n;t++)r[t]=this._predict(e[t]);let o=0,a=0,s=0,u=0,l=0,c=0,h=0;for(let e=0;e<n;e++)o+=r[e],a+=t[e],l+=r[e]*r[e],c+=t[e]*t[e],h+=r[e]*t[e],0!==t[e]&&(s+=(t[e]-r[e])*(t[e]-r[e])/t[e]),u+=(t[e]-r[e])*(t[e]-r[e]);const d=(n*h-o*a)/Math.sqrt((n*l-o*o)*(n*c-a*a));return{r:d,r2:d*d,chi2:s,rmsd:Math.sqrt(u/n)}}}function a(e,t){return e<0?(e=0-e,"number"==typeof t?`- ${e.toPrecision(t)}`:`- ${e.toString()}`):"number"==typeof t?e.toPrecision(t):e.toString()}class s extends o{constructor(e,t){super(),!0===e?(this.slope=t.slope,this.intercept=t.intercept,this.coefficients=[t.intercept,t.slope]):(function(e,t){if(!i(e)||!i(t))throw new TypeError("x and y must be arrays");if(e.length!==t.length)throw new RangeError("x and y arrays must have the same length")}(e,t),function(e,t,n){const r=t.length;let i=0,o=0,a=0,s=0;for(let e=0;e<r;e++)i+=t[e],o+=n[e],a+=t[e]*t[e],s+=t[e]*n[e];const u=r*s-i*o;e.slope=u/(r*a-i*i),e.intercept=1/r*o-e.slope*(1/r)*i,e.coefficients=[e.intercept,e.slope]}(this,e,t))}toJSON(){return{name:"simpleLinearRegression",slope:this.slope,intercept:this.intercept}}_predict(e){return this.slope*e+this.intercept}computeX(e){return(e-this.intercept)/this.slope}toString(e){let t="f(x) = ";if(0!==this.slope){const n=a(this.slope,e);if(t+=("1"===n?"":`${n} * `)+"x",0!==this.intercept){const n=Math.abs(this.intercept);t+=` ${n===this.intercept?"+":"-"} ${a(n,e)}`}}else t+=a(this.intercept,e);return t}toLaTeX(e){return this.toString(e)}static load(e){if("simpleLinearRegression"!==e.name)throw new TypeError("not a SLR model");return new s(!0,e)}}},vsh_9065:function(e){var t=1e3,n=60*t,r=60*n,i=24*r,o=365.25*i;function a(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,s){s=s||{};var u,l=typeof e;if("string"===l&&e.length>0)return function(e){if((e=String(e)).length>100)return;var a=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!a)return;var s=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return s*o;case"days":case"day":case"d":return s*i;case"hours":case"hour":case"hrs":case"hr":case"h":return s*r;case"minutes":case"minute":case"mins":case"min":case"m":return s*n;case"seconds":case"second":case"secs":case"sec":case"s":return s*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}(e);if("number"===l&&!1===isNaN(e))return s.long?a(u=e,i,"day")||a(u,r,"hour")||a(u,n,"minute")||a(u,t,"second")||u+" ms":function(e){if(e>=i)return Math.round(e/i)+"d";if(e>=r)return Math.round(e/r)+"h";if(e>=n)return Math.round(e/n)+"m";if(e>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},vsh_12102:function(e,t,n){var r="function"==typeof Map&&Map.prototype,i=Object.getOwnPropertyDescriptor&&r?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,o=r&&i&&"function"==typeof i.get?i.get:null,a=r&&Map.prototype.forEach,s="function"==typeof Set&&Set.prototype,u=Object.getOwnPropertyDescriptor&&s?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,l=s&&u&&"function"==typeof u.get?u.get:null,c=s&&Set.prototype.forEach,h="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,d="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,f="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,p=Boolean.prototype.valueOf,v=Object.prototype.toString,g=Function.prototype.toString,_=String.prototype.match,y=String.prototype.slice,m=String.prototype.replace,E=String.prototype.toUpperCase,b=String.prototype.toLowerCase,T=RegExp.prototype.test,C=Array.prototype.concat,S=Array.prototype.join,w=Array.prototype.slice,R=Math.floor,A="function"==typeof BigInt?BigInt.prototype.valueOf:null,O=Object.getOwnPropertySymbols,M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,k="function"==typeof Symbol&&"object"==typeof Symbol.iterator,I="function"==typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===k||"symbol")?Symbol.toStringTag:null,x=Object.prototype.propertyIsEnumerable,N=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function P(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||T.call(/e/,t))return t;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof e){var r=e<0?-R(-e):R(e);if(r!==e){var i=String(r),o=y.call(t,i.length+1);return m.call(i,n,"$&_")+"."+m.call(m.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}}return m.call(t,n,"$&_")}var L=n("vsh_64121").custom,D=L&&H(L)?L:null;function F(e,t,n){var r="double"===(n.quoteStyle||t)?'"':"'";return r+e+r}function B(e){return m.call(String(e),/"/g,"&quot;")}function V(e){return!("[object Array]"!==W(e)||I&&"object"==typeof e&&I in e)}function H(e){if(k)return e&&"object"==typeof e&&e instanceof Symbol;if("symbol"==typeof e)return!0;if(!e||"object"!=typeof e||!M)return!1;try{return M.call(e),!0}catch(e){}return!1}e.exports=function e(t,n,r,i){var s=n||{};if(Z(s,"quoteStyle")&&"single"!==s.quoteStyle&&"double"!==s.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Z(s,"maxStringLength")&&("number"==typeof s.maxStringLength?s.maxStringLength<0&&s.maxStringLength!==1/0:null!==s.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var u=!Z(s,"customInspect")||s.customInspect;if("boolean"!=typeof u&&"symbol"!==u)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Z(s,"indent")&&null!==s.indent&&"\t"!==s.indent&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Z(s,"numericSeparator")&&"boolean"!=typeof s.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var v=s.numericSeparator;if(void 0===t)return"undefined";if(null===t)return"null";if("boolean"==typeof t)return t?"true":"false";if("string"==typeof t)return G(t,s);if("number"==typeof t){if(0===t)return 1/0/t>0?"0":"-0";var E=String(t);return v?P(t,E):E}if("bigint"==typeof t){var T=String(t)+"n";return v?P(t,T):T}var R=void 0===s.depth?5:s.depth;if(void 0===r&&(r=0),r>=R&&R>0&&"object"==typeof t)return V(t)?"[Array]":"[Object]";var O=function(e,t){var n;if("\t"===e.indent)n="\t";else{if(!("number"==typeof e.indent&&e.indent>0))return null;n=S.call(Array(e.indent+1)," ")}return{base:n,prev:S.call(Array(t+1),n)}}(s,r);if(void 0===i)i=[];else if(j(i,t)>=0)return"[Circular]";function L(t,n,o){if(n&&(i=w.call(i)).push(n),o){var a={depth:s.depth};return Z(s,"quoteStyle")&&(a.quoteStyle=s.quoteStyle),e(t,a,r+1,i)}return e(t,s,r+1,i)}if("function"==typeof t){var U=function(e){if(e.name)return e.name;var t=_.call(g.call(e),/^function\s*([\w$]+)/);if(t)return t[1];return null}(t),z=$(t,L);return"[Function"+(U?": "+U:" (anonymous)")+"]"+(z.length>0?" { "+S.call(z,", ")+" }":"")}if(H(t)){var J=k?m.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):M.call(t);return"object"!=typeof t||k?J:Y(J)}if(function(e){if(!e||"object"!=typeof e)return!1;if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)return!0;return"string"==typeof e.nodeName&&"function"==typeof e.getAttribute}(t)){for(var Q="<"+b.call(String(t.nodeName)),ee=t.attributes||[],te=0;te<ee.length;te++)Q+=" "+ee[te].name+"="+F(B(ee[te].value),"double",s);return Q+=">",t.childNodes&&t.childNodes.length&&(Q+="..."),Q+="</"+b.call(String(t.nodeName))+">"}if(V(t)){if(0===t.length)return"[]";var ne=$(t,L);return O&&!function(e){for(var t=0;t<e.length;t++)if(j(e[t],"\n")>=0)return!1;return!0}(ne)?"["+q(ne,O)+"]":"[ "+S.call(ne,", ")+" ]"}if(function(e){return!("[object Error]"!==W(e)||I&&"object"==typeof e&&I in e)}(t)){var re=$(t,L);return"cause"in t&&!x.call(t,"cause")?"{ ["+String(t)+"] "+S.call(C.call("[cause]: "+L(t.cause),re),", ")+" }":0===re.length?"["+String(t)+"]":"{ ["+String(t)+"] "+S.call(re,", ")+" }"}if("object"==typeof t&&u){if(D&&"function"==typeof t[D])return t[D]();if("symbol"!==u&&"function"==typeof t.inspect)return t.inspect()}if(function(e){if(!o||!e||"object"!=typeof e)return!1;try{o.call(e);try{l.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var ie=[];return a.call(t,(function(e,n){ie.push(L(n,t,!0)+" => "+L(e,t))})),K("Map",o.call(t),ie,O)}if(function(e){if(!l||!e||"object"!=typeof e)return!1;try{l.call(e);try{o.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var oe=[];return c.call(t,(function(e){oe.push(L(e,t))})),K("Set",l.call(t),oe,O)}if(function(e){if(!h||!e||"object"!=typeof e)return!1;try{h.call(e,h);try{d.call(e,d)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return X("WeakMap");if(function(e){if(!d||!e||"object"!=typeof e)return!1;try{d.call(e,d);try{h.call(e,h)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return X("WeakSet");if(function(e){if(!f||!e||"object"!=typeof e)return!1;try{return f.call(e),!0}catch(e){}return!1}(t))return X("WeakRef");if(function(e){return!("[object Number]"!==W(e)||I&&"object"==typeof e&&I in e)}(t))return Y(L(Number(t)));if(function(e){if(!e||"object"!=typeof e||!A)return!1;try{return A.call(e),!0}catch(e){}return!1}(t))return Y(L(A.call(t)));if(function(e){return!("[object Boolean]"!==W(e)||I&&"object"==typeof e&&I in e)}(t))return Y(p.call(t));if(function(e){return!("[object String]"!==W(e)||I&&"object"==typeof e&&I in e)}(t))return Y(L(String(t)));if(!function(e){return!("[object Date]"!==W(e)||I&&"object"==typeof e&&I in e)}(t)&&!function(e){return!("[object RegExp]"!==W(e)||I&&"object"==typeof e&&I in e)}(t)){var ae=$(t,L),se=N?N(t)===Object.prototype:t instanceof Object||t.constructor===Object,ue=t instanceof Object?"":"null prototype",le=!se&&I&&Object(t)===t&&I in t?y.call(W(t),8,-1):ue?"Object":"",ce=(se||"function"!=typeof t.constructor?"":t.constructor.name?t.constructor.name+" ":"")+(le||ue?"["+S.call(C.call([],le||[],ue||[]),": ")+"] ":"");return 0===ae.length?ce+"{}":O?ce+"{"+q(ae,O)+"}":ce+"{ "+S.call(ae,", ")+" }"}return String(t)};var U=Object.prototype.hasOwnProperty||function(e){return e in this};function Z(e,t){return U.call(e,t)}function W(e){return v.call(e)}function j(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function G(e,t){if(e.length>t.maxStringLength){var n=e.length-t.maxStringLength,r="... "+n+" more character"+(n>1?"s":"");return G(y.call(e,0,t.maxStringLength),t)+r}return F(m.call(m.call(e,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,z),"single",t)}function z(e){var t=e.charCodeAt(0),n={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return n?"\\"+n:"\\x"+(t<16?"0":"")+E.call(t.toString(16))}function Y(e){return"Object("+e+")"}function X(e){return e+" { ? }"}function K(e,t,n,r){return e+" ("+t+") {"+(r?q(n,r):S.call(n,", "))+"}"}function q(e,t){if(0===e.length)return"";var n="\n"+t.prev+t.base;return n+S.call(e,","+n)+"\n"+t.prev}function $(e,t){var n=V(e),r=[];if(n){r.length=e.length;for(var i=0;i<e.length;i++)r[i]=Z(e,i)?t(e[i],e):""}var o,a="function"==typeof O?O(e):[];if(k){o={};for(var s=0;s<a.length;s++)o["$"+a[s]]=a[s]}for(var u in e)Z(e,u)&&(n&&String(Number(u))===u&&u<e.length||k&&o["$"+u]instanceof Symbol||(T.call(/[^\w$]/,u)?r.push(t(u,e)+": "+t(e[u],e)):r.push(u+": "+t(e[u],e))));if("function"==typeof O)for(var l=0;l<a.length;l++)x.call(e,a[l])&&r.push("["+t(a[l])+"]: "+t(e[a[l]],e));return r}},vsh_89121:function(e,t,n){"use strict";var r;if(!Object.keys){var i=Object.prototype.hasOwnProperty,o=Object.prototype.toString,a=n("vsh_70999"),s=Object.prototype.propertyIsEnumerable,u=!s.call({toString:null},"toString"),l=s.call((function(){}),"prototype"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],h=function(e){var t=e.constructor;return t&&t.prototype===e},d={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},f=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!d["$"+e]&&i.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{h(window[e])}catch(e){return!0}}catch(e){return!0}return!1}();r=function(e){var t=null!==e&&"object"==typeof e,n="[object Function]"===o.call(e),r=a(e),s=t&&"[object String]"===o.call(e),d=[];if(!t&&!n&&!r)throw new TypeError("Object.keys called on a non-object");var p=l&&n;if(s&&e.length>0&&!i.call(e,0))for(var v=0;v<e.length;++v)d.push(String(v));if(r&&e.length>0)for(var g=0;g<e.length;++g)d.push(String(g));else for(var _ in e)p&&"prototype"===_||!i.call(e,_)||d.push(String(_));if(u)for(var y=function(e){if("undefined"==typeof window||!f)return h(e);try{return h(e)}catch(e){return!1}}(e),m=0;m<c.length;++m)y&&"constructor"===c[m]||!i.call(e,c[m])||d.push(c[m]);return d}}e.exports=r},vsh_72051:function(e,t,n){"use strict";var r=Array.prototype.slice,i=n("vsh_70999"),o=Object.keys,a=o?function(e){return o(e)}:n("vsh_89121"),s=Object.keys;a.shim=function(){if(Object.keys){var e=function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2);e||(Object.keys=function(e){return i(e)?s(r.call(e)):s(e)})}else Object.keys=a;return Object.keys||a},e.exports=a},vsh_70999:function(e){"use strict";var t=Object.prototype.toString;e.exports=function(e){var n=t.call(e),r="[object Arguments]"===n;return r||(r="[object Array]"!==n&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===t.call(e.callee)),r}},vsh_14224:function(e){var t,n,r=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var s,u=[],l=!1,c=-1;function h(){l&&s&&(l=!1,s.length?u=s.concat(u):c=-1,u.length&&d())}function d(){if(!l){var e=a(h);l=!0;for(var t=u.length;t;){for(s=u,u=[];++c<t;)s&&s[c].run();c=-1,t=u.length}s=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function p(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new f(e,t)),1!==u.length||l||a(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},vsh_61028:function(e,t,n){"use strict";var r,i=n("vsh_14224");(r=void 0!==i&&"[object process]"==={}.toString.call(i)||"undefined"!=typeof navigator&&"ReactNative"===navigator.product?n.g:self).Proxy||(r.Proxy=n("vsh_75780")(),r.Proxy.revocable=r.Proxy.revocable)},vsh_75780:function(e){e.exports=function(){let e,t=null;function n(e){return!!e&&("object"==typeof e||"function"==typeof e)}function r(e){if(null!==e&&!n(e))throw new TypeError("Object prototype may only be an Object or null: "+e)}const i=Object,o=Boolean(i.create)||!({__proto__:null}instanceof i),a=i.create||(o?function(e){return r(e),{__proto__:e}}:function(e){if(r(e),null===e)throw new SyntaxError("Native Object.create is required to create objects with null prototype");var t=function(){};return t.prototype=e,new t}),s=function(){return null},u=i.getPrototypeOf||([].__proto__===Array.prototype?function(e){const t=e.__proto__;return n(t)?t:null}:s);return e=function(l,c){if(void 0===(this&&this instanceof e?this.constructor:void 0))throw new TypeError("Constructor Proxy requires 'new'");if(!n(l)||!n(c))throw new TypeError("Cannot create proxy with a non-object as target or handler");let h=function(){};t=function(){l=null,h=function(e){throw new TypeError(`Cannot perform '${e}' on a proxy that has been revoked`)}},setTimeout((function(){t=null}),0);const d=c;c={get:null,set:null,apply:null,construct:null};for(let e in d){if(!(e in c))throw new TypeError(`Proxy polyfill does not support trap '${e}'`);c[e]=d[e]}"function"==typeof d&&(c.apply=d.apply.bind(d));const f=u(l);let p,v=!1,g=!1;"function"==typeof l?(p=function(){const e=this&&this.constructor===p,t=Array.prototype.slice.call(arguments);if(h(e?"construct":"apply"),e&&c.construct)return c.construct.call(this,l,t);if(!e&&c.apply)return c.apply(l,this,t);if(e){t.unshift(l);return new(l.bind.apply(l,t))}return l.apply(this,t)},v=!0):l instanceof Array?(p=[],g=!0):p=o||null!==f?a(f):{};const _=c.get?function(e){return h("get"),c.get(this,e,p)}:function(e){return h("get"),this[e]},y=c.set?function(e,t){h("set");c.set(this,e,t,p)}:function(e,t){h("set"),this[e]=t},m=i.getOwnPropertyNames(l),E={};m.forEach((function(e){if((v||g)&&e in p)return;const t=i.getOwnPropertyDescriptor(l,e),n={enumerable:Boolean(t.enumerable),get:_.bind(l,e),set:y.bind(l,e)};i.defineProperty(p,e,n),E[e]=!0}));let b=!0;if(v||g){const e=i.setPrototypeOf||([].__proto__===Array.prototype?function(e,t){return r(t),e.__proto__=t,e}:s);f&&e(p,f)||(b=!1)}if(c.get||!b)for(let e in l)E[e]||i.defineProperty(p,e,{get:_.bind(l,e)});return i.seal(l),i.seal(p),p},e.revocable=function(n,r){return{proxy:new e(n,r),revoke:t}},e}},vsh_5202:function(e){"use strict";function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,n,r,i){n=n||"&",r=r||"=";var o={};if("string"!=typeof e||0===e.length)return o;var a=/\+/g;e=e.split(n);var s=1e3;i&&"number"==typeof i.maxKeys&&(s=i.maxKeys);var u=e.length;s>0&&u>s&&(u=s);for(var l=0;l<u;++l){var c,h,d,f,p=e[l].replace(a,"%20"),v=p.indexOf(r);v>=0?(c=p.substr(0,v),h=p.substr(v+1)):(c=p,h=""),d=decodeURIComponent(c),f=decodeURIComponent(h),t(o,d)?Array.isArray(o[d])?o[d].push(f):o[d]=[o[d],f]:o[d]=f}return o}},vsh_33489:function(e){"use strict";var t=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,n,r,i){return n=n||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map((function(i){var o=encodeURIComponent(t(i))+r;return Array.isArray(e[i])?e[i].map((function(e){return o+encodeURIComponent(t(e))})).join(n):o+encodeURIComponent(t(e[i]))})).join(n):i?encodeURIComponent(t(i))+r+encodeURIComponent(t(e)):""}},vsh_45768:function(e,t,n){"use strict";n("vsh_5202"),t.stringify=n("vsh_33489")},vsh_15722:function(e,t,n){"use strict";function r(e,t,n,r,o){i(e,t,n||0,r||e.length-1,o||a)}function i(e,t,n,r,a){for(;r>n;){if(r-n>600){var s=r-n+1,u=t-n+1,l=Math.log(s),c=.5*Math.exp(2*l/3),h=.5*Math.sqrt(l*c*(s-c)/s)*(u-s/2<0?-1:1);i(e,t,Math.max(n,Math.floor(t-u*c/s+h)),Math.min(r,Math.floor(t+(s-u)*c/s+h)),a)}var d=e[t],f=n,p=r;for(o(e,n,t),a(e[r],d)>0&&o(e,n,r);f<p;){for(o(e,f,p),f++,p--;a(e[f],d)<0;)f++;for(;a(e[p],d)>0;)p--}0===a(e[n],d)?o(e,n,p):o(e,++p,r),p<=t&&(n=p+1),t<=p&&(r=p-1)}}function o(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function a(e,t){return e<t?-1:e>t?1:0}n.d(t,{Z:function(){return r}})},vsh_3410:function(e,t,n){var r=function(){return this}()||Function("return this")(),i=r.regeneratorRuntime&&Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime")>=0,o=i&&r.regeneratorRuntime;if(r.regeneratorRuntime=void 0,e.exports=n("vsh_70315"),i)r.regeneratorRuntime=o;else try{delete r.regeneratorRuntime}catch(e){r.regeneratorRuntime=void 0}},vsh_70315:function(e){!function(t){"use strict";var n,r=Object.prototype,i=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag",l=t.regeneratorRuntime;if(l)e.exports=l;else{(l=t.regeneratorRuntime=e.exports).wrap=m;var c="suspendedStart",h="suspendedYield",d="executing",f="completed",p={},v={};v[a]=function(){return this};var g=Object.getPrototypeOf,_=g&&g(g(k([])));_&&_!==r&&i.call(_,a)&&(v=_);var y=C.prototype=b.prototype=Object.create(v);T.prototype=y.constructor=C,C.constructor=T,C[u]=T.displayName="GeneratorFunction",l.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===T||"GeneratorFunction"===(t.displayName||t.name))},l.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,C):(e.__proto__=C,u in e||(e[u]="GeneratorFunction")),e.prototype=Object.create(y),e},l.awrap=function(e){return{__await:e}},S(w.prototype),w.prototype[s]=function(){return this},l.AsyncIterator=w,l.async=function(e,t,n,r){var i=new w(m(e,t,n,r));return l.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},S(y),y[u]="Generator",y[a]=function(){return this},y.toString=function(){return"[object Generator]"},l.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},l.values=k,M.prototype={constructor:M,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,i){return s.type="throw",s.arg=e,t.next=r,i&&(t.method="next",t.arg=n),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var u=i.call(a,"catchLoc"),l=i.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;O(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:k(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=n),p}}}function m(e,t,n,r){var i=t&&t.prototype instanceof b?t:b,o=Object.create(i.prototype),a=new M(r||[]);return o._invoke=function(e,t,n){var r=c;return function(i,o){if(r===d)throw new Error("Generator is already running");if(r===f){if("throw"===i)throw o;return I()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=R(a,n);if(s){if(s===p)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===c)throw r=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var u=E(e,t,n);if("normal"===u.type){if(r=n.done?f:h,u.arg===p)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=f,n.method="throw",n.arg=u.arg)}}}(e,n,a),o}function E(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function b(){}function T(){}function C(){}function S(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function w(e){function t(n,r,o,a){var s=E(e[n],e,r);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==typeof l&&i.call(l,"__await")?Promise.resolve(l.__await).then((function(e){t("next",e,o,a)}),(function(e){t("throw",e,o,a)})):Promise.resolve(l).then((function(e){u.value=e,o(u)}),a)}a(s.arg)}var n;this._invoke=function(e,r){function i(){return new Promise((function(n,i){t(e,r,n,i)}))}return n=n?n.then(i,i):i()}}function R(e,t){var r=e.iterator[t.method];if(r===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,R(e,t),"throw"===t.method))return p;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var i=E(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,p;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,p):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function k(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(i.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return o.next=o}}return{next:I}}function I(){return{value:n,done:!0}}}(function(){return this}()||Function("return this")())},vsh_40027:function(e){"use strict";var t=Object,n=TypeError;e.exports=function(){if(null!=this&&this!==t(this))throw new n("RegExp.prototype.flags getter called on non-object");var e="";return this.hasIndices&&(e+="d"),this.global&&(e+="g"),this.ignoreCase&&(e+="i"),this.multiline&&(e+="m"),this.dotAll&&(e+="s"),this.unicode&&(e+="u"),this.sticky&&(e+="y"),e}},vsh_69112:function(e,t,n){"use strict";var r=n("vsh_90722"),i=n("vsh_72755"),o=n("vsh_40027"),a=n("vsh_40730"),s=n("vsh_59621"),u=i(a());r(u,{getPolyfill:a,implementation:o,shim:s}),e.exports=u},vsh_40730:function(e,t,n){"use strict";var r=n("vsh_40027"),i=n("vsh_90722").supportsDescriptors,o=Object.getOwnPropertyDescriptor;e.exports=function(){if(i&&"gim"===/a/gim.flags){var e=o(RegExp.prototype,"flags");if(e&&"function"==typeof e.get&&"boolean"==typeof/a/.dotAll)return e.get}return r}},vsh_59621:function(e,t,n){"use strict";var r=n("vsh_90722").supportsDescriptors,i=n("vsh_40730"),o=Object.getOwnPropertyDescriptor,a=Object.defineProperty,s=TypeError,u=Object.getPrototypeOf,l=/a/;e.exports=function(){if(!r||!u)throw new s("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var e=i(),t=u(l),n=o(t,"flags");return n&&n.get===e||a(t,"flags",{configurable:!0,enumerable:!1,get:e}),e}},vsh_23232:function(e,t){"use strict";function n(e,t){return e===t}function r(e,t,n){if(null===t||null===n||t.length!==n.length)return!1;for(var r=t.length,i=0;i<r;i++)if(!e(t[i],n[i]))return!1;return!0}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n,i=null,o=null;return function(){return r(t,i,arguments)||(o=e.apply(null,arguments)),i=arguments,o}}function o(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every((function(e){return"function"==typeof e}))){var n=t.map((function(e){return typeof e})).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+n+"]")}return t}function a(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=Array(t),a=0;a<t;a++)r[a]=arguments[a];var s=0,u=r.pop(),l=o(r),c=e.apply(void 0,[function(){return s++,u.apply(null,arguments)}].concat(n)),h=i((function(){for(var e=[],t=l.length,n=0;n<t;n++)e.push(l[n].apply(null,arguments));return c.apply(null,e)}));return h.resultFunc=u,h.recomputations=function(){return s},h.resetRecomputations=function(){return s=0},h}}t.PW=i,t.wN=a;var s=t.P1=a(i)},vsh_68530:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.types=void 0;const o=n("vsh_50900");Object.defineProperty(t,"types",{enumerable:!0,get:function(){return o.types}}),i(n("vsh_52225"),t),i(n("vsh_22499"),t);const a=n("vsh_52225"),s=n("vsh_22499");i(n("vsh_50900"),t),t.default=a.tokenizer,e.exports=a.tokenizer,e.exports.types=o.types,e.exports.reconstruct=s.reconstruct},vsh_22499:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reconstruct=void 0;const r=n("vsh_50900"),i=n("vsh_21819"),o=e=>e.map(t.reconstruct).join(""),a=e=>{if("options"in e)return e.options.map(o).join("|");if("stack"in e)return o(e.stack);throw new Error("options or stack must be Root or Group token")};t.reconstruct=e=>{switch(e.type){case r.types.ROOT:return a(e);case r.types.CHAR:{const t=String.fromCharCode(e.value);return(/[[\\{}$^.|?*+()]/.test(t)?"\\":"")+t}case r.types.POSITION:return"^"===e.value||"$"===e.value?e.value:`\\${e.value}`;case r.types.REFERENCE:return`\\${e.value}`;case r.types.SET:return i.writeSetTokens(e);case r.types.GROUP:return`(${e.remember?"":e.followedBy?"?=":e.notFollowedBy?"?!":"?:"}${a(e)})`;case r.types.REPETITION:{const{min:n,max:r}=e;let i;return i=0===n&&1===r?"?":1===n&&r===1/0?"+":0===n&&r===1/0?"*":r===1/0?`{${n},}`:n===r?`{${n}}`:`{${n},${r}}`,`${t.reconstruct(e.value)}${i}`}case r.types.RANGE:return`${i.setChar(e.from)}-${i.setChar(e.to)}`;default:throw new Error(`Invalid token type ${e}`)}}},vsh_61999:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.NOTANYCHAR=t.WHITESPACE=t.WORDS=t.INTS=void 0;const a=o(n("vsh_42979")),s=n("vsh_50900");function u(e){let t={},n=0;for(const r of e)r.type===s.types.CHAR&&(t[r.value]=!0),r.type===s.types.RANGE&&(t[`${r.from}-${r.to}`]=!0),n+=1;return{lookup:()=>Object.assign({},t),len:n}}t.INTS=u(a.ints().set),t.WORDS=u(a.words().set),t.WHITESPACE=u(a.whitespace().set),t.NOTANYCHAR=u(a.anyChar().set)},vsh_42979:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.anyChar=t.notWhitespace=t.whitespace=t.notInts=t.ints=t.notWords=t.words=void 0;const r=n("vsh_50900"),i=()=>[{type:r.types.RANGE,from:48,to:57}],o=()=>[{type:r.types.CHAR,value:95},{type:r.types.RANGE,from:97,to:122},{type:r.types.RANGE,from:65,to:90},{type:r.types.RANGE,from:48,to:57}],a=()=>[{type:r.types.CHAR,value:9},{type:r.types.CHAR,value:10},{type:r.types.CHAR,value:11},{type:r.types.CHAR,value:12},{type:r.types.CHAR,value:13},{type:r.types.CHAR,value:32},{type:r.types.CHAR,value:160},{type:r.types.CHAR,value:5760},{type:r.types.RANGE,from:8192,to:8202},{type:r.types.CHAR,value:8232},{type:r.types.CHAR,value:8233},{type:r.types.CHAR,value:8239},{type:r.types.CHAR,value:8287},{type:r.types.CHAR,value:12288},{type:r.types.CHAR,value:65279}];t.words=()=>({type:r.types.SET,set:o(),not:!1}),t.notWords=()=>({type:r.types.SET,set:o(),not:!0}),t.ints=()=>({type:r.types.SET,set:i(),not:!1}),t.notInts=()=>({type:r.types.SET,set:i(),not:!0}),t.whitespace=()=>({type:r.types.SET,set:a(),not:!1}),t.notWhitespace=()=>({type:r.types.SET,set:a(),not:!0}),t.anyChar=()=>({type:r.types.SET,set:[{type:r.types.CHAR,value:10},{type:r.types.CHAR,value:13},{type:r.types.CHAR,value:8232},{type:r.types.CHAR,value:8233}],not:!0})},vsh_52225:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.tokenizer=void 0;const a=o(n("vsh_32438")),s=n("vsh_50900"),u=o(n("vsh_42979"));t.tokenizer=e=>{let t,n=0,r={type:s.types.ROOT,stack:[]},i=r,o=r.stack,l=[],c=[],h=0;const d=t=>{throw new SyntaxError(`Invalid regular expression: /${e}/: Nothing to repeat at column ${t-1}`)};let f=a.strToChars(e);for(;n<f.length;)switch(t=f[n++]){case"\\":if(n===f.length)throw new SyntaxError(`Invalid regular expression: /${e}/: \\ at end of pattern`);switch(t=f[n++]){case"b":o.push({type:s.types.POSITION,value:"b"});break;case"B":o.push({type:s.types.POSITION,value:"B"});break;case"w":o.push(u.words());break;case"W":o.push(u.notWords());break;case"d":o.push(u.ints());break;case"D":o.push(u.notInts());break;case"s":o.push(u.whitespace());break;case"S":o.push(u.notWhitespace());break;default:if(/\d/.test(t)){let e=t;for(;n<f.length&&/\d/.test(f[n]);)e+=f[n++];let r=parseInt(e,10);const i={type:s.types.REFERENCE,value:r};o.push(i),c.push({reference:i,stack:o,index:o.length-1})}else o.push({type:s.types.CHAR,value:t.charCodeAt(0)})}break;case"^":o.push({type:s.types.POSITION,value:"^"});break;case"$":o.push({type:s.types.POSITION,value:"$"});break;case"[":{let t;"^"===f[n]?(t=!0,n++):t=!1;let r=a.tokenizeClass(f.slice(n),e);n+=r[1],o.push({type:s.types.SET,set:r[0],not:t});break}case".":o.push(u.anyChar());break;case"(":{let r={type:s.types.GROUP,stack:[],remember:!0};if("?"===f[n]){if(t=f[n+1],n+=2,"="===t)r.followedBy=!0;else if("!"===t)r.notFollowedBy=!0;else if(":"!==t)throw new SyntaxError(`Invalid regular expression: /${e}/: Invalid group, character '${t}' after '?' at column `+(n-1));r.remember=!1}else h+=1;o.push(r),l.push(i),i=r,o=r.stack;break}case")":if(0===l.length)throw new SyntaxError(`Invalid regular expression: /${e}/: Unmatched ) at column ${n-1}`);i=l.pop(),o=i.options?i.options[i.options.length-1]:i.stack;break;case"|":{i.options||(i.options=[i.stack],delete i.stack);let e=[];i.options.push(e),o=e;break}case"{":{let e,t,r=/^(\d+)(,(\d+)?)?\}/.exec(f.slice(n));null!==r?(0===o.length&&d(n),e=parseInt(r[1],10),t=r[2]?r[3]?parseInt(r[3],10):1/0:e,n+=r[0].length,o.push({type:s.types.REPETITION,min:e,max:t,value:o.pop()})):o.push({type:s.types.CHAR,value:123});break}case"?":0===o.length&&d(n),o.push({type:s.types.REPETITION,min:0,max:1,value:o.pop()});break;case"+":0===o.length&&d(n),o.push({type:s.types.REPETITION,min:1,max:1/0,value:o.pop()});break;case"*":0===o.length&&d(n),o.push({type:s.types.REPETITION,min:0,max:1/0,value:o.pop()});break;default:o.push({type:s.types.CHAR,value:t.charCodeAt(0)})}if(0!==l.length)throw new SyntaxError(`Invalid regular expression: /${e}/: Unterminated group`);return function(e,t){for(const n of e.reverse())if(t<n.reference.value){n.reference.type=s.types.CHAR;const e=n.reference.value.toString();if(n.reference.value=parseInt(e,8),!/^[0-7]+$/.test(e)){let t=0;for(;"8"!==e[t]&&"9"!==e[t];)t+=1;if(0===t?(n.reference.value=e.charCodeAt(0),t+=1):n.reference.value=parseInt(e.slice(0,t),8),e.length>t){const r=n.stack.splice(n.index+1);for(const r of e.slice(t))n.stack.push({type:s.types.CHAR,value:r.charCodeAt(0)});n.stack.push(...r)}}}}(c,h),r}},vsh_50900:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n("vsh_20192"),t),i(n("vsh_47250"),t),i(n("vsh_13537"),t)},vsh_13537:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},vsh_20192:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},vsh_47250:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.types=void 0,function(e){e[e.ROOT=0]="ROOT",e[e.GROUP=1]="GROUP",e[e.POSITION=2]="POSITION",e[e.SET=3]="SET",e[e.RANGE=4]="RANGE",e[e.REPETITION=5]="REPETITION",e[e.REFERENCE=6]="REFERENCE",e[e.CHAR=7]="CHAR"}(t.types||(t.types={}))},vsh_32438:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.tokenizeClass=t.strToChars=void 0;const a=n("vsh_50900"),s=o(n("vsh_42979"));t.strToChars=e=>e.replace(/(\[\\b\])|(\\)?\\(?:u([A-F0-9]{4})|x([A-F0-9]{2})|c([@A-Z[\\\]^?])|([0tnvfr]))/g,((e,t,n,r,i,o,a)=>{if(n)return e;let s=t?8:r?parseInt(r,16):i?parseInt(i,16):o?"@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^ ?".indexOf(o):{0:0,t:9,n:10,v:11,f:12,r:13}[a],u=String.fromCharCode(s);return/[[\]{}^$.|?*+()]/.test(u)?`\\${u}`:u})),t.tokenizeClass=(e,t)=>{var n,r,i,o,u,l,c;let h,d,f=[];const p=/\\(?:(w)|(d)|(s)|(W)|(D)|(S))|((?:(?:\\)(.)|([^\]\\]))-(((?:\\)])|(((?:\\)?([^\]])))))|(\])|(?:\\)?([^])/g;for(;null!==(h=p.exec(e));){const e=null!==(c=null!==(l=null!==(u=null!==(o=null!==(i=null!==(r=null!==(n=h[1]&&s.words())&&void 0!==n?n:h[2]&&s.ints())&&void 0!==r?r:h[3]&&s.whitespace())&&void 0!==i?i:h[4]&&s.notWords())&&void 0!==o?o:h[5]&&s.notInts())&&void 0!==u?u:h[6]&&s.notWhitespace())&&void 0!==l?l:h[7]&&{type:a.types.RANGE,from:(h[8]||h[9]).charCodeAt(0),to:(d=h[10]).charCodeAt(d.length-1)})&&void 0!==c?c:(d=h[16])&&{type:a.types.CHAR,value:d.charCodeAt(0)};if(!e)return[f,p.lastIndex];f.push(e)}throw new SyntaxError(`Invalid regular expression: /${t}/: Unterminated character class`)}},vsh_21819:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.writeSetTokens=t.setChar=void 0;const a=n("vsh_50900"),s=o(n("vsh_61999"));function u(e){return 94===e?"\\^":92===e?"\\\\":93===e?"\\]":45===e?"\\-":String.fromCharCode(e)}function l(e,{lookup:t,len:n}){if(n!==e.length)return!1;const r=t();for(const t of e){if(t.type===a.types.SET)return!1;const e=t.type===a.types.CHAR?t.value:`${t.from}-${t.to}`;if(!r[e])return!1;r[e]=!1}return!0}function c(e,t=!1){if(l(e.set,s.INTS))return e.not?"\\D":"\\d";if(l(e.set,s.WORDS))return e.not?"\\W":"\\w";if(e.not&&l(e.set,s.NOTANYCHAR))return".";if(l(e.set,s.WHITESPACE))return e.not?"\\S":"\\s";let n="";for(let t=0;t<e.set.length;t++){n+=h(e.set[t])}const r=`${e.not?"^":""}${n}`;return t?r:`[${r}]`}function h(e){return e.type===a.types.CHAR?u(e.value):e.type===a.types.RANGE?`${u(e.from)}-${u(e.to)}`:c(e,!0)}t.setChar=u,t.writeSetTokens=c},vsh_64299:function(e,t,n){"use strict";n.d(t,{X:function(){return a}});var r=n("vsh_65949"),i=n("vsh_93631"),o=n("vsh_5419"),a=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return r.__extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return n&&!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new o.N;return this._value},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(i.xQ)},vsh_19218:function(e,t,n){"use strict";n.d(t,{P:function(){return s}});var r=n("vsh_651"),i=n("vsh_22052"),o=n("vsh_4285");function a(e){var t=e.error;e.subscriber.error(t)}var s=function(){function e(e,t,n){this.kind=e,this.value=t,this.error=n,this.hasValue="N"===e}return e.prototype.observe=function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}},e.prototype.do=function(e,t,n){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return n&&n()}},e.prototype.accept=function(e,t,n){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,n)},e.prototype.toObservable=function(){var e,t;switch(this.kind){case"N":return(0,i.of)(this.value);case"E":return e=this.error,t?new o.y((function(n){return t.schedule(a,0,{error:e,subscriber:n})})):new o.y((function(t){return t.error(e)}));case"C":return(0,r.cS)()}throw new Error("unexpected notification kind value")},e.createNext=function(t){return void 0!==t?new e("N",t):e.undefinedValueNotification},e.createError=function(t){return new e("E",void 0,t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",void 0),e}()},vsh_4285:function(e,t,n){"use strict";n.d(t,{y:function(){return l}});var r=n("vsh_59992"),i=n("vsh_37981"),o=n("vsh_41062");var a=n("vsh_75258"),s=n("vsh_70622"),u=n("vsh_41421"),l=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var a=this.operator,s=function(e,t,n){if(e){if(e instanceof r.L)return e;if(e[i.b])return e[i.b]()}return e||t||n?new r.L(e,t,n):new r.L(o.c)}(e,t,n);if(a?a.call(s,this.source):s.add(this.source||u.v.useDeprecatedSynchronousErrorHandling&&!s.syncErrorThrowable?this._subscribe(s):this._trySubscribe(s)),u.v.useDeprecatedSynchronousErrorHandling&&s.syncErrorThrowable&&(s.syncErrorThrowable=!1,s.syncErrorThrown))throw s.syncErrorValue;return s},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){u.v.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=c(t))((function(t,r){var i;i=n.subscribe((function(t){try{e(t)}catch(e){r(e),i&&i.unsubscribe()}}),r,t)}))},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[a.L]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:(0,s.U)(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=c(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function c(e){if(e||(e=u.v.Promise||Promise),!e)throw new Error("no Promise impl found");return e}},vsh_41062:function(e,t,n){"use strict";n.d(t,{c:function(){return o}});var r=n("vsh_41421"),i=n("vsh_20743"),o={closed:!0,next:function(e){},error:function(e){if(r.v.useDeprecatedSynchronousErrorHandling)throw e;(0,i.z)(e)},complete:function(){}}},vsh_81042:function(e,t,n){"use strict";n.d(t,{L:function(){return i}});var r=n("vsh_65949"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.destination.next(t)},t.prototype.notifyError=function(e,t){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()},t}(n("vsh_59992").L)},vsh_79828:function(e,t,n){"use strict";n.d(t,{t:function(){return d}});var r=n("vsh_65949"),i=n("vsh_93631"),o=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return r.__extends(t,e),t.prototype.schedule=function(t,n){return void 0===n&&(n=0),n>0?e.prototype.schedule.call(this,t,n):(this.delay=n,this.state=t,this.scheduler.flush(this),this)},t.prototype.execute=function(t,n){return n>0||this.closed?e.prototype.execute.call(this,t,n):this._execute(t,n)},t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0?e.prototype.requestAsyncId.call(this,t,n,r):t.flush(this)},t}(n("vsh_82763").o),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t}(n("vsh_81744").v),s=new a(o),u=n("vsh_52690"),l=n("vsh_83784"),c=n("vsh_5419"),h=n("vsh_43300"),d=function(e){function t(t,n,r){void 0===t&&(t=Number.POSITIVE_INFINITY),void 0===n&&(n=Number.POSITIVE_INFINITY);var i=e.call(this)||this;return i.scheduler=r,i._events=[],i._infiniteTimeWindow=!1,i._bufferSize=t<1?1:t,i._windowTime=n<1?1:n,n===Number.POSITIVE_INFINITY?(i._infiniteTimeWindow=!0,i.next=i.nextInfiniteTimeWindow):i.next=i.nextTimeWindow,i}return r.__extends(t,e),t.prototype.nextInfiniteTimeWindow=function(t){var n=this._events;n.push(t),n.length>this._bufferSize&&n.shift(),e.prototype.next.call(this,t)},t.prototype.nextTimeWindow=function(t){this._events.push(new f(this._getNow(),t)),this._trimBufferThenGetEvents(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){var t,n=this._infiniteTimeWindow,r=n?this._events:this._trimBufferThenGetEvents(),i=this.scheduler,o=r.length;if(this.closed)throw new c.N;if(this.isStopped||this.hasError?t=u.w.EMPTY:(this.observers.push(e),t=new h.W(this,e)),i&&e.add(e=new l.ht(e,i)),n)for(var a=0;a<o&&!e.closed;a++)e.next(r[a]);else for(a=0;a<o&&!e.closed;a++)e.next(r[a].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),t},t.prototype._getNow=function(){return(this.scheduler||s).now()},t.prototype._trimBufferThenGetEvents=function(){for(var e=this._getNow(),t=this._bufferSize,n=this._windowTime,r=this._events,i=r.length,o=0;o<i&&!(e-r[o].time<n);)o++;return i>t&&(o=Math.max(o,i-t)),o>0&&r.splice(0,o),r},t}(i.xQ),f=function(){return function(e,t){this.time=e,this.value=t}}()},vsh_93631:function(e,t,n){"use strict";n.d(t,{Yc:function(){return c},xQ:function(){return h}});var r=n("vsh_65949"),i=n("vsh_4285"),o=n("vsh_59992"),a=n("vsh_52690"),s=n("vsh_5419"),u=n("vsh_43300"),l=n("vsh_37981"),c=function(e){function t(t){var n=e.call(this,t)||this;return n.destination=t,n}return r.__extends(t,e),t}(o.L),h=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return r.__extends(t,e),t.prototype[l.b]=function(){return new c(this)},t.prototype.lift=function(e){var t=new d(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new s.N;if(!this.isStopped)for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].next(e)},t.prototype.error=function(e){if(this.closed)throw new s.N;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new s.N;this.isStopped=!0;for(var e=this.observers,t=e.length,n=e.slice(),r=0;r<t;r++)n[r].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new s.N;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new s.N;return this.hasError?(e.error(this.thrownError),a.w.EMPTY):this.isStopped?(e.complete(),a.w.EMPTY):(this.observers.push(e),new u.W(this,e))},t.prototype.asObservable=function(){var e=new i.y;return e.source=this,e},t.create=function(e,t){return new d(e,t)},t}(i.y),d=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return r.__extends(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):a.w.EMPTY},t}(h)},vsh_43300:function(e,t,n){"use strict";n.d(t,{W:function(){return i}});var r=n("vsh_65949"),i=function(e){function t(t,n){var r=e.call(this)||this;return r.subject=t,r.subscriber=n,r.closed=!1,r}return r.__extends(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}},t}(n("vsh_52690").w)},vsh_59992:function(e,t,n){"use strict";n.d(t,{L:function(){return c}});var r=n("vsh_65949"),i=n("vsh_8196"),o=n("vsh_41062"),a=n("vsh_52690"),s=n("vsh_37981"),u=n("vsh_41421"),l=n("vsh_20743"),c=function(e){function t(t,n,r){var i=e.call(this)||this;switch(i.syncErrorValue=null,i.syncErrorThrown=!1,i.syncErrorThrowable=!1,i.isStopped=!1,arguments.length){case 0:i.destination=o.c;break;case 1:if(!t){i.destination=o.c;break}if("object"==typeof t){if(d(t)){var a=t[s.b]();i.syncErrorThrowable=a.syncErrorThrowable,i.destination=a,a.add(i)}else i.syncErrorThrowable=!0,i.destination=new h(i,t);break}default:i.syncErrorThrowable=!0,i.destination=new h(i,t,n,r)}return i}return r.__extends(t,e),t.prototype[s.b]=function(){return this},t.create=function(e,n,r){var i=new t(e,n,r);return i.syncErrorThrowable=!1,i},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parent,t=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=e,this._parents=t,this},t}(a.w),h=function(e){function t(t,n,r,a){var s,u=e.call(this)||this;u._parentSubscriber=t;var l=u;return(0,i.m)(n)?s=n:n&&(s=n.next,r=n.error,a=n.complete,n!==o.c&&(l=Object.create(n),(0,i.m)(l.unsubscribe)&&u.add(l.unsubscribe.bind(l)),l.unsubscribe=u.unsubscribe.bind(u))),u._context=l,u._next=s,u._error=r,u._complete=a,u}return r.__extends(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;u.v.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,n=u.v.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):(0,l.z)(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;(0,l.z)(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};u.v.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),u.v.useDeprecatedSynchronousErrorHandling)throw e;(0,l.z)(e)}},t.prototype.__tryOrSetError=function(e,t,n){if(!u.v.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(t){return u.v.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):((0,l.z)(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(c);function d(e){return e instanceof c||"syncErrorThrowable"in e&&e[s.b]}},vsh_52690:function(e,t,n){"use strict";n.d(t,{w:function(){return c}});var r=n("vsh_75457"),i=n("vsh_35578"),o=n("vsh_8196"),a=n("vsh_35477"),s=n("vsh_24766"),u=n("vsh_65949"),l=function(e){function t(n){var r=e.call(this,n?n.length+" errors occurred during unsubscription:\n  "+n.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"")||this;return r.errors=n,r.name="UnsubscriptionError",Object.setPrototypeOf(r,t.prototype),r}return u.__extends(t,e),t}(Error),c=function(){function e(e){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,e&&(this._unsubscribe=e)}var t;return e.prototype.unsubscribe=function(){var e,t=!1;if(!this.closed){var n=this,u=n._parent,c=n._parents,d=n._unsubscribe,f=n._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var p=-1,v=c?c.length:0;u;)u.remove(this),u=++p<v&&c[p]||null;if((0,o.m)(d))(0,a.Y)(d).call(this)===s.T&&(t=!0,e=e||(s.T.e instanceof l?h(s.T.e.errors):[s.T.e]));if((0,r.k)(f))for(p=-1,v=f.length;++p<v;){var g=f[p];if((0,i.K)(g))if((0,a.Y)(g.unsubscribe).call(g)===s.T){t=!0,e=e||[];var _=s.T.e;_ instanceof l?e=e.concat(h(_.errors)):e.push(_)}}if(t)throw new l(e)}},e.prototype.add=function(t){if(!t||t===e.EMPTY)return e.EMPTY;if(t===this)return this;var n=t;switch(typeof t){case"function":n=new e(t);case"object":if(n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if("function"!=typeof n._addParent){var r=n;(n=new e)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(n),n._addParent(this),n},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}},e.prototype._addParent=function(e){var t=this._parent,n=this._parents;t&&t!==e?n?-1===n.indexOf(e)&&n.push(e):this._parents=[e]:this._parent=e},e.EMPTY=((t=new e).closed=!0,t),e}();function h(e){return e.reduce((function(e,t){return e.concat(t instanceof l?t.errors:t)}),[])}},vsh_41421:function(e,t,n){"use strict";n.d(t,{v:function(){return i}});var r=!1,i={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){e&&(new Error).stack;r=e},get useDeprecatedSynchronousErrorHandling(){return r}}},vsh_99073:function(e,t,n){"use strict";n.d(t,{aj:function(){return c}});var r=n("vsh_65949"),i=n("vsh_38962"),o=n("vsh_75457"),a=n("vsh_81042"),s=n("vsh_69831"),u=n("vsh_38117"),l={};function c(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=null,r=null;return(0,i.K)(e[e.length-1])&&(r=e.pop()),"function"==typeof e[e.length-1]&&(n=e.pop()),1===e.length&&(0,o.k)(e[0])&&(e=e[0]),(0,u.n)(e,r).lift(new h(n))}var h=function(){function e(e){this.resultSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new d(e,this.resultSelector))},e}(),d=function(e){function t(t,n){var r=e.call(this,t)||this;return r.resultSelector=n,r.active=0,r.values=[],r.observables=[],r}return r.__extends(t,e),t.prototype._next=function(e){this.values.push(l),this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(var n=0;n<t;n++){var r=e[n];this.add((0,s.D)(this,r,r,n))}}},t.prototype.notifyComplete=function(e){0==(this.active-=1)&&this.destination.complete()},t.prototype.notifyNext=function(e,t,n,r,i){var o=this.values,a=o[n],s=this.toRespond?a===l?--this.toRespond:this.toRespond:0;o[n]=t,0===s&&(this.resultSelector?this._tryResultSelector(o):this.destination.next(o.slice()))},t.prototype._tryResultSelector=function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(a.L)},vsh_72764:function(e,t,n){"use strict";n.d(t,{P:function(){return a}});var r=n("vsh_4285"),i=n("vsh_50177"),o=n("vsh_651");function a(e){return new r.y((function(t){var n;try{n=e()}catch(e){return void t.error(e)}return(n?(0,i.D)(n):(0,o.cS)()).subscribe(t)}))}},vsh_651:function(e,t,n){"use strict";n.d(t,{E_:function(){return i},cS:function(){return o}});var r=n("vsh_4285"),i=new r.y((function(e){return e.complete()}));function o(e){return e?function(e){return new r.y((function(t){return e.schedule((function(){return t.complete()}))}))}(e):i}},vsh_22362:function(e,t,n){"use strict";n.d(t,{D:function(){return c}});var r=n("vsh_65949"),i=n("vsh_4285"),o=n("vsh_75457"),a=n("vsh_651"),s=n("vsh_69831"),u=n("vsh_81042"),l=n("vsh_56489");function c(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return"function"==typeof t[t.length-1]&&(e=t.pop()),1===t.length&&(0,o.k)(t[0])&&(t=t[0]),0===t.length?a.E_:e?c(t).pipe((0,l.map)((function(t){return e.apply(void 0,t)}))):new i.y((function(e){return new h(e,t)}))}var h=function(e){function t(t,n){var r=e.call(this,t)||this;r.sources=n,r.completed=0,r.haveValues=0;var i=n.length;r.values=new Array(i);for(var o=0;o<i;o++){var a=n[o],u=(0,s.D)(r,a,null,o);u&&r.add(u)}return r}return r.__extends(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.values[n]=t,i._hasValue||(i._hasValue=!0,this.haveValues++)},t.prototype.notifyComplete=function(e){var t=this,n=t.destination,r=t.haveValues,i=t.values,o=i.length;e._hasValue?(this.completed++,this.completed===o&&(r===o&&n.next(i),n.complete())):n.complete()},t}(u.L)},vsh_50177:function(e,t,n){"use strict";n.d(t,{D:function(){return p}});var r=n("vsh_4285"),i=n("vsh_72954"),o=n("vsh_4217"),a=n("vsh_75258");var s=n("vsh_74334");var u=n("vsh_38117"),l=n("vsh_52690"),c=n("vsh_14249");var h=n("vsh_2210");var d=n("vsh_64156");var f=n("vsh_22325");function p(e,t){if(!t)return e instanceof r.y?e:new r.y((0,f.s)(e));if(null!=e){if(function(e){return e&&"function"==typeof e[a.L]}(e))return function(e,t){return t?new r.y((function(n){var r=new l.w;return r.add(t.schedule((function(){var i=e[a.L]();r.add(i.subscribe({next:function(e){r.add(t.schedule((function(){return n.next(e)})))},error:function(e){r.add(t.schedule((function(){return n.error(e)})))},complete:function(){r.add(t.schedule((function(){return n.complete()})))}}))}))),r})):new r.y((0,d.h)(e))}(e,t);if((0,i.t)(e))return function(e,t){return t?new r.y((function(n){var r=new l.w;return r.add(t.schedule((function(){return e.then((function(e){r.add(t.schedule((function(){n.next(e),r.add(t.schedule((function(){return n.complete()})))})))}),(function(e){r.add(t.schedule((function(){return n.error(e)})))}))}))),r})):new r.y((0,c.A)(e))}(e,t);if((0,o.z)(e))return(0,u.n)(e,t);if(function(e){return e&&"function"==typeof e[s.hZ]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return t?new r.y((function(n){var r,i=new l.w;return i.add((function(){r&&"function"==typeof r.return&&r.return()})),i.add(t.schedule((function(){r=e[s.hZ](),i.add(t.schedule((function(){if(!n.closed){var e,t;try{var i=r.next();e=i.value,t=i.done}catch(e){return void n.error(e)}t?n.complete():(n.next(e),this.schedule())}})))}))),i})):new r.y((0,h.u)(e))}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}},vsh_38117:function(e,t,n){"use strict";n.d(t,{n:function(){return a}});var r=n("vsh_4285"),i=n("vsh_52690"),o=n("vsh_33498");function a(e,t){return t?new r.y((function(n){var r=new i.w,o=0;return r.add(t.schedule((function(){o!==e.length?(n.next(e[o++]),n.closed||r.add(this.schedule())):n.complete()}))),r})):new r.y((0,o.V)(e))}},vsh_67295:function(e,t,n){"use strict";n.d(t,{T:function(){return s}});var r=n("vsh_4285"),i=n("vsh_38962"),o=n("vsh_70226"),a=n("vsh_38117");function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Number.POSITIVE_INFINITY,s=null,u=e[e.length-1];return(0,i.K)(u)?(s=e.pop(),e.length>1&&"number"==typeof e[e.length-1]&&(n=e.pop())):"number"==typeof u&&(n=e.pop()),null===s&&1===e.length&&e[0]instanceof r.y?e[0]:(0,o.J)(n)((0,a.n)(e,s))}},vsh_22052:function(e,t,n){"use strict";n.d(t,{of:function(){return s}});var r=n("vsh_38962"),i=n("vsh_38117"),o=n("vsh_651"),a=n("vsh_71909");function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[e.length-1];switch((0,r.K)(n)?e.pop():n=void 0,e.length){case 0:return(0,o.cS)(n);case 1:return n?(0,i.n)(e,n):(0,a.i)(e[0]);default:return(0,i.n)(e,n)}}},vsh_71909:function(e,t,n){"use strict";n.d(t,{i:function(){return i}});var r=n("vsh_4285");function i(e){var t=new r.y((function(t){t.next(e),t.complete()}));return t._isScalar=!0,t.value=e,t}},vsh_19108:function(e,t,n){"use strict";n.d(t,{H:function(){return u}});var r=n("vsh_4285"),i=n("vsh_40742"),o=n("vsh_75457");function a(e){return!(0,o.k)(e)&&e-parseFloat(e)+1>=0}var s=n("vsh_38962");function u(e,t,n){void 0===e&&(e=0);var o=-1;return a(t)?o=Number(t)<1?1:Number(t):(0,s.K)(t)&&(n=t),(0,s.K)(n)||(n=i.P),new r.y((function(t){var r=a(e)?e:+e-n.now();return n.schedule(l,r,{index:0,period:o,subscriber:t})}))}function l(e){var t=e.index,n=e.period,r=e.subscriber;if(r.next(t),!r.closed){if(-1===n)return r.complete();e.index=t+1,this.schedule(e,n)}}},vsh_69009:function(e,t,n){"use strict";n.d(t,{K:function(){return a}});var r=n("vsh_65949"),i=n("vsh_81042"),o=n("vsh_69831");function a(e){return function(t){var n=new s(e),r=t.lift(n);return n.caught=r}}var s=function(){function e(e){this.selector=e}return e.prototype.call=function(e,t){return t.subscribe(new u(e,this.selector,this.caught))},e}(),u=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.selector=n,i.caught=r,i}return r.__extends(t,e),t.prototype.error=function(t){if(!this.isStopped){var n=void 0;try{n=this.selector(t,this.caught)}catch(t){return void e.prototype.error.call(this,t)}this._unsubscribeAndRecycle(),this.add((0,o.D)(this,n))}},t}(i.L)},vsh_99448:function(e,t,n){"use strict";n.d(t,{b:function(){return i}});var r=n("vsh_80361");function i(e,t){return(0,r.zg)(e,t,1)}},vsh_39668:function(e,t,n){"use strict";n.d(t,{b:function(){return a}});var r=n("vsh_65949"),i=n("vsh_59992"),o=n("vsh_40742");function a(e,t){return void 0===t&&(t=o.P),function(n){return n.lift(new s(e,t))}}var s=function(){function e(e,t){this.dueTime=e,this.scheduler=t}return e.prototype.call=function(e,t){return t.subscribe(new u(e,this.dueTime,this.scheduler))},e}(),u=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.dueTime=n,i.scheduler=r,i.debouncedSubscription=null,i.lastValue=null,i.hasValue=!1,i}return r.__extends(t,e),t.prototype._next=function(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(l,this.dueTime,this))},t.prototype._complete=function(){this.debouncedNext(),this.destination.complete()},t.prototype.debouncedNext=function(){if(this.clearDebounce(),this.hasValue){var e=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(e)}},t.prototype.clearDebounce=function(){var e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)},t}(i.L);function l(e){e.debouncedNext()}},vsh_34345:function(e,t,n){"use strict";n.d(t,{d:function(){return o}});var r=n("vsh_65949"),i=n("vsh_59992");function o(e){return void 0===e&&(e=null),function(t){return t.lift(new a(e))}}var a=function(){function e(e){this.defaultValue=e}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.defaultValue))},e}(),s=function(e){function t(t,n){var r=e.call(this,t)||this;return r.defaultValue=n,r.isEmpty=!0,r}return r.__extends(t,e),t.prototype._next=function(e){this.isEmpty=!1,this.destination.next(e)},t.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},t}(i.L)},vsh_95692:function(e,t,n){"use strict";n.d(t,{g:function(){return s}});var r=n("vsh_65949"),i=n("vsh_40742");var o=n("vsh_59992"),a=n("vsh_19218");function s(e,t){void 0===t&&(t=i.P);var n,r=(n=e)instanceof Date&&!isNaN(+n)?+e-t.now():Math.abs(e);return function(e){return e.lift(new u(r,t))}}var u=function(){function e(e,t){this.delay=e,this.scheduler=t}return e.prototype.call=function(e,t){return t.subscribe(new l(e,this.delay,this.scheduler))},e}(),l=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.delay=n,i.scheduler=r,i.queue=[],i.active=!1,i.errored=!1,i}return r.__extends(t,e),t.dispatch=function(e){for(var t=e.source,n=t.queue,r=e.scheduler,i=e.destination;n.length>0&&n[0].time-r.now()<=0;)n.shift().notification.observe(i);if(n.length>0){var o=Math.max(0,n[0].time-r.now());this.schedule(e,o)}else this.unsubscribe(),t.active=!1},t.prototype._schedule=function(e){this.active=!0,this.add(e.schedule(t.dispatch,this.delay,{source:this,destination:this.destination,scheduler:e}))},t.prototype.scheduleNotification=function(e){if(!0!==this.errored){var t=this.scheduler,n=new c(t.now()+this.delay,e);this.queue.push(n),!1===this.active&&this._schedule(t)}},t.prototype._next=function(e){this.scheduleNotification(a.P.createNext(e))},t.prototype._error=function(e){this.errored=!0,this.queue=[],this.destination.error(e)},t.prototype._complete=function(){this.scheduleNotification(a.P.createComplete())},t}(o.L),c=function(){return function(e,t){this.time=e,this.notification=t}}()},vsh_21183:function(e,t,n){"use strict";n.d(t,{E:function(){return a}});var r=n("vsh_65949"),i=n("vsh_81042"),o=n("vsh_69831");function a(e,t){return function(n){return n.lift(new s(e,t))}}var s=function(){function e(e,t){this.keySelector=e,this.flushes=t}return e.prototype.call=function(e,t){return t.subscribe(new u(e,this.keySelector,this.flushes))},e}(),u=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.keySelector=n,i.values=new Set,r&&i.add((0,o.D)(i,r)),i}return r.__extends(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.values.clear()},t.prototype.notifyError=function(e,t){this._error(e)},t.prototype._next=function(e){this.keySelector?this._useKeySelector(e):this._finalizeNext(e,e)},t.prototype._useKeySelector=function(e){var t,n=this.destination;try{t=this.keySelector(e)}catch(e){return void n.error(e)}this._finalizeNext(t,e)},t.prototype._finalizeNext=function(e,t){var n=this.values;n.has(e)||(n.add(e),this.destination.next(t))},t}(i.L)},vsh_71561:function(e,t,n){"use strict";n.r(t),n.d(t,{distinctUntilChanged:function(){return s}});var r=n("vsh_65949"),i=n("vsh_59992"),o=n("vsh_35477"),a=n("vsh_24766");function s(e,t){return function(n){return n.lift(new u(e,t))}}var u=function(){function e(e,t){this.compare=e,this.keySelector=t}return e.prototype.call=function(e,t){return t.subscribe(new l(e,this.compare,this.keySelector))},e}(),l=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.keySelector=r,i.hasKey=!1,"function"==typeof n&&(i.compare=n),i}return r.__extends(t,e),t.prototype.compare=function(e,t){return e===t},t.prototype._next=function(e){var t=e;if(this.keySelector&&(t=(0,o.Y)(this.keySelector)(e))===a.T)return this.destination.error(a.T.e);var n=!1;if(this.hasKey){if((n=(0,o.Y)(this.compare)(this.key,t))===a.T)return this.destination.error(a.T.e)}else this.hasKey=!0;!1===Boolean(n)&&(this.key=t,this.destination.next(e))},t}(i.L)},vsh_49457:function(e,t,n){"use strict";n.d(t,{g:function(){return i}});var r=n("vsh_71561");function i(e,t){return(0,r.distinctUntilChanged)((function(n,r){return t?t(n[e],r[e]):n[e]===r[e]}))}},vsh_17494:function(e,t,n){"use strict";n.d(t,{h:function(){return o}});var r=n("vsh_65949"),i=n("vsh_59992");function o(e,t){return function(n){return n.lift(new a(e,t))}}var a=function(){function e(e,t){this.predicate=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.predicate,this.thisArg))},e}(),s=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.predicate=n,i.thisArg=r,i.count=0,i}return r.__extends(t,e),t.prototype._next=function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}t&&this.destination.next(e)},t}(i.L)},vsh_89808:function(e,t,n){"use strict";n.d(t,{P:function(){return l}});var r=n("vsh_35210"),i=n("vsh_17494"),o=n("vsh_84587"),a=n("vsh_34345"),s=n("vsh_23765"),u=n("vsh_74682");function l(e,t){var n=arguments.length>=2;return function(l){return l.pipe(e?(0,i.h)((function(t,n){return e(t,n,l)})):u.y,(0,o.q)(1),n?(0,a.d)(t):(0,s.T)((function(){return new r.K})))}}},vsh_56489:function(e,t,n){"use strict";n.r(t),n.d(t,{map:function(){return o},MapOperator:function(){return a}});var r=n("vsh_65949"),i=n("vsh_59992");function o(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new a(e,t))}}var a=function(){function e(e,t){this.project=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.project,this.thisArg))},e}(),s=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.project=n,i.count=0,i.thisArg=r||i,i}return r.__extends(t,e),t.prototype._next=function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(i.L)},vsh_91903:function(e,t,n){"use strict";n.d(t,{h:function(){return o}});var r=n("vsh_65949"),i=n("vsh_59992");function o(e){return function(t){return t.lift(new a(e))}}var a=function(){function e(e){this.value=e}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.value))},e}(),s=function(e){function t(t,n){var r=e.call(this,t)||this;return r.value=n,r}return r.__extends(t,e),t.prototype._next=function(e){this.destination.next(this.value)},t}(i.L)},vsh_70226:function(e,t,n){"use strict";n.d(t,{J:function(){return o}});var r=n("vsh_80361"),i=n("vsh_74682");function o(e){return void 0===e&&(e=Number.POSITIVE_INFINITY),(0,r.zg)(i.y,e)}},vsh_80361:function(e,t,n){"use strict";n.d(t,{zg:function(){return u}});var r=n("vsh_65949"),i=n("vsh_69831"),o=n("vsh_81042"),a=n("vsh_56489"),s=n("vsh_50177");function u(e,t,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof t?function(r){return r.pipe(u((function(n,r){return(0,s.D)(e(n,r)).pipe((0,a.map)((function(e,i){return t(n,e,r,i)})))}),n))}:("number"==typeof t&&(n=t),function(t){return t.lift(new l(e,n))})}var l=function(){function e(e,t){void 0===t&&(t=Number.POSITIVE_INFINITY),this.project=e,this.concurrent=t}return e.prototype.call=function(e,t){return t.subscribe(new c(e,this.project,this.concurrent))},e}(),c=function(e){function t(t,n,r){void 0===r&&(r=Number.POSITIVE_INFINITY);var i=e.call(this,t)||this;return i.project=n,i.concurrent=r,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return r.__extends(t,e),t.prototype._next=function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)},t.prototype._tryNext=function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(e){return void this.destination.error(e)}this.active++,this._innerSub(t,e,n)},t.prototype._innerSub=function(e,t,n){this.add((0,i.D)(this,e,t,n))},t.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete()},t.prototype.notifyNext=function(e,t,n,r,i){this.destination.next(t)},t.prototype.notifyComplete=function(e){var t=this.buffer;this.remove(e),this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},t}(o.L)},vsh_83784:function(e,t,n){"use strict";n.d(t,{QV:function(){return a},ht:function(){return u}});var r=n("vsh_65949"),i=n("vsh_59992"),o=n("vsh_19218");function a(e,t){return void 0===t&&(t=0),function(n){return n.lift(new s(e,t))}}var s=function(){function e(e,t){void 0===t&&(t=0),this.scheduler=e,this.delay=t}return e.prototype.call=function(e,t){return t.subscribe(new u(e,this.scheduler,this.delay))},e}(),u=function(e){function t(t,n,r){void 0===r&&(r=0);var i=e.call(this,t)||this;return i.scheduler=n,i.delay=r,i}return r.__extends(t,e),t.dispatch=function(e){var t=e.notification,n=e.destination;t.observe(n),this.unsubscribe()},t.prototype.scheduleMessage=function(e){this.add(this.scheduler.schedule(t.dispatch,this.delay,new l(e,this.destination)))},t.prototype._next=function(e){this.scheduleMessage(o.P.createNext(e))},t.prototype._error=function(e){this.scheduleMessage(o.P.createError(e))},t.prototype._complete=function(){this.scheduleMessage(o.P.createComplete())},t}(i.L),l=function(){return function(e,t){this.notification=e,this.destination=t}}()},vsh_23188:function(e,t,n){"use strict";n.d(t,{G:function(){return o}});var r=n("vsh_65949"),i=n("vsh_59992");function o(){return function(e){return e.lift(new a)}}var a=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new s(e))},e}(),s=function(e){function t(t){var n=e.call(this,t)||this;return n.hasPrev=!1,n}return r.__extends(t,e),t.prototype._next=function(e){this.hasPrev?this.destination.next([this.prev,e]):this.hasPrev=!0,this.prev=e},t}(i.L)},vsh_96121:function(e,t,n){"use strict";n.d(t,{B:function(){return g}});var r=n("vsh_65949"),i=n("vsh_93631"),o=n("vsh_4285"),a=n("vsh_59992"),s=n("vsh_52690");function u(){return function(e){return e.lift(new l(e))}}var l=function(){function e(e){this.connectable=e}return e.prototype.call=function(e,t){var n=this.connectable;n._refCount++;var r=new c(e,n),i=t.subscribe(r);return r.closed||(r.connection=n.connect()),i},e}(),c=function(e){function t(t,n){var r=e.call(this,t)||this;return r.connectable=n,r}return r.__extends(t,e),t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;if(t<=0)this.connection=null;else if(e._refCount=t-1,t>1)this.connection=null;else{var n=this.connection,r=e._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null},t}(a.L),h=function(e){function t(t,n){var r=e.call(this)||this;return r.source=t,r.subjectFactory=n,r._refCount=0,r._isComplete=!1,r}return r.__extends(t,e),t.prototype._subscribe=function(e){return this.getSubject().subscribe(e)},t.prototype.getSubject=function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject},t.prototype.connect=function(){var e=this._connection;return e||(this._isComplete=!1,(e=this._connection=new s.w).add(this.source.subscribe(new f(this.getSubject(),this))),e.closed?(this._connection=null,e=s.w.EMPTY):this._connection=e),e},t.prototype.refCount=function(){return u()(this)},t}(o.y).prototype,d={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:h._subscribe},_isComplete:{value:h._isComplete,writable:!0},getSubject:{value:h.getSubject},connect:{value:h.connect},refCount:{value:h.refCount}},f=function(e){function t(t,n){var r=e.call(this,t)||this;return r.connectable=n,r}return r.__extends(t,e),t.prototype._error=function(t){this._unsubscribe(),e.prototype._error.call(this,t)},t.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),e.prototype._complete.call(this)},t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}},t}(i.Yc);a.L;var p=function(){function e(e,t){this.subjectFactory=e,this.selector=t}return e.prototype.call=function(e,t){var n=this.selector,r=this.subjectFactory(),i=n(r).subscribe(e);return i.add(t.subscribe(r)),i},e}();function v(){return new i.xQ}function g(){return function(e){return u()((t=v,function(e){var r;if(r="function"==typeof t?t:function(){return t},"function"==typeof n)return e.lift(new p(r,n));var i=Object.create(e,d);return i.source=e,i.subjectFactory=r,i})(e));var t,n}}},vsh_57181:function(e,t,n){"use strict";n.d(t,{d:function(){return i}});var r=n("vsh_79828");function i(e,t,n){return function(i){return i.lift(function(e,t,n){var i,o,a=0,s=!1,u=!1;return function(l){a++,i&&!s||(s=!1,i=new r.t(e,t,n),o=l.subscribe({next:function(e){i.next(e)},error:function(e){s=!0,i.error(e)},complete:function(){u=!0,i.complete()}}));var c=i.subscribe(this);return function(){a--,c.unsubscribe(),o&&0===a&&u&&o.unsubscribe()}}}(e,t,n))}}},vsh_38383:function(e,t,n){"use strict";n.d(t,{T:function(){return o}});var r=n("vsh_65949"),i=n("vsh_59992");function o(e){return function(t){return t.lift(new a(e))}}var a=function(){function e(e){this.total=e}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.total))},e}(),s=function(e){function t(t,n){var r=e.call(this,t)||this;return r.total=n,r.count=0,r}return r.__extends(t,e),t.prototype._next=function(e){++this.count>this.total&&this.destination.next(e)},t}(i.L)},vsh_62536:function(e,t,n){"use strict";n.d(t,{O:function(){return d}});var r=n("vsh_38117"),i=n("vsh_71909"),o=n("vsh_651"),a=n("vsh_38962"),s=n("vsh_22052"),u=n("vsh_50177"),l=n("vsh_70226");function c(){return(0,l.J)(1)}function h(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 1===e.length||2===e.length&&(0,a.K)(e[1])?(0,u.D)(e[0]):c()(s.of.apply(void 0,e))}function d(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){var n=e[e.length-1];(0,a.K)(n)?e.pop():n=null;var s=e.length;return h(1!==s||n?s>0?(0,r.n)(e,n):(0,o.cS)(n):(0,i.i)(e[0]),t)}}},vsh_75071:function(e,t,n){"use strict";n.d(t,{w:function(){return u}});var r=n("vsh_65949"),i=n("vsh_81042"),o=n("vsh_69831"),a=n("vsh_56489"),s=n("vsh_50177");function u(e,t){return"function"==typeof t?function(n){return n.pipe(u((function(n,r){return(0,s.D)(e(n,r)).pipe((0,a.map)((function(e,i){return t(n,e,r,i)})))})))}:function(t){return t.lift(new l(e))}}var l=function(){function e(e){this.project=e}return e.prototype.call=function(e,t){return t.subscribe(new c(e,this.project))},e}(),c=function(e){function t(t,n){var r=e.call(this,t)||this;return r.project=n,r.index=0,r}return r.__extends(t,e),t.prototype._next=function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(e){return void this.destination.error(e)}this._innerSub(t,e,n)},t.prototype._innerSub=function(e,t,n){var r=this.innerSubscription;r&&r.unsubscribe(),this.add(this.innerSubscription=(0,o.D)(this,e,t,n))},t.prototype._complete=function(){var t=this.innerSubscription;t&&!t.closed||e.prototype._complete.call(this)},t.prototype._unsubscribe=function(){this.innerSubscription=null},t.prototype.notifyComplete=function(t){this.remove(t),this.innerSubscription=null,this.isStopped&&e.prototype._complete.call(this)},t.prototype.notifyNext=function(e,t,n,r,i){this.destination.next(t)},t}(i.L)},vsh_84587:function(e,t,n){"use strict";n.d(t,{q:function(){return s}});var r=n("vsh_65949"),i=n("vsh_59992"),o=n("vsh_57091"),a=n("vsh_651");function s(e){return function(t){return 0===e?(0,a.cS)():t.lift(new u(e))}}var u=function(){function e(e){if(this.total=e,this.total<0)throw new o.W}return e.prototype.call=function(e,t){return t.subscribe(new l(e,this.total))},e}(),l=function(e){function t(t,n){var r=e.call(this,t)||this;return r.total=n,r.count=0,r}return r.__extends(t,e),t.prototype._next=function(e){var t=this.total,n=++this.count;n<=t&&(this.destination.next(e),n===t&&(this.destination.complete(),this.unsubscribe()))},t}(i.L)},vsh_42958:function(e,t,n){"use strict";n.d(t,{R:function(){return a}});var r=n("vsh_65949"),i=n("vsh_81042"),o=n("vsh_69831");function a(e){return function(t){return t.lift(new s(e))}}var s=function(){function e(e){this.notifier=e}return e.prototype.call=function(e,t){var n=new u(e),r=(0,o.D)(n,this.notifier);return r&&!r.closed?(n.add(r),t.subscribe(n)):n},e}(),u=function(e){function t(t){return e.call(this,t)||this}return r.__extends(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.complete()},t.prototype.notifyComplete=function(){},t}(i.L)},vsh_54016:function(e,t,n){"use strict";n.d(t,{o:function(){return o}});var r=n("vsh_65949"),i=n("vsh_59992");function o(e){return function(t){return t.lift(new a(e))}}var a=function(){function e(e){this.predicate=e}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.predicate))},e}(),s=function(e){function t(t,n){var r=e.call(this,t)||this;return r.predicate=n,r.index=0,r}return r.__extends(t,e),t.prototype._next=function(e){var t,n=this.destination;try{t=this.predicate(e,this.index++)}catch(e){return void n.error(e)}this.nextOrComplete(e,t)},t.prototype.nextOrComplete=function(e,t){var n=this.destination;Boolean(t)?n.next(e):n.complete()},t}(i.L)},vsh_98085:function(e,t,n){"use strict";n.d(t,{b:function(){return s}});var r=n("vsh_65949"),i=n("vsh_59992"),o=n("vsh_80580"),a=n("vsh_8196");function s(e,t,n){return function(r){return r.lift(new u(e,t,n))}}var u=function(){function e(e,t,n){this.nextOrObserver=e,this.error=t,this.complete=n}return e.prototype.call=function(e,t){return t.subscribe(new l(e,this.nextOrObserver,this.error,this.complete))},e}(),l=function(e){function t(t,n,r,i){var s=e.call(this,t)||this;return s._tapNext=o.Z,s._tapError=o.Z,s._tapComplete=o.Z,s._tapError=r||o.Z,s._tapComplete=i||o.Z,(0,a.m)(n)?(s._context=s,s._tapNext=n):n&&(s._context=n,s._tapNext=n.next||o.Z,s._tapError=n.error||o.Z,s._tapComplete=n.complete||o.Z),s}return r.__extends(t,e),t.prototype._next=function(e){try{this._tapNext.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.next(e)},t.prototype._error=function(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)},t.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()},t}(i.L)},vsh_23765:function(e,t,n){"use strict";n.d(t,{T:function(){return o}});var r=n("vsh_98085"),i=n("vsh_35210"),o=function(e){return void 0===e&&(e=a),(0,r.b)({hasValue:!1,next:function(){this.hasValue=!0},complete:function(){if(!this.hasValue)throw e()}})};function a(){return new i.K}},vsh_82763:function(e,t,n){"use strict";n.d(t,{o:function(){return i}});var r=n("vsh_65949"),i=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return r.__extends(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n=!1,r=void 0;try{this.work(e)}catch(e){n=!0,r=!!e&&e||new Error(e)}if(n)return this.unsubscribe(),r},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,n=t.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(function(e){function t(t,n){return e.call(this)||this}return r.__extends(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(n("vsh_52690").w))},vsh_81744:function(e,t,n){"use strict";n.d(t,{v:function(){return o}});var r=n("vsh_65949"),i=function(){function e(t,n){void 0===n&&(n=e.now),this.SchedulerAction=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(n,t)},e.now=Date.now?Date.now:function(){return+new Date},e}(),o=function(e){function t(n,r){void 0===r&&(r=i.now);var o=e.call(this,n,(function(){return t.delegate&&t.delegate!==o?t.delegate.now():r()}))||this;return o.actions=[],o.active=!1,o.scheduled=void 0,o}return r.__extends(t,e),t.prototype.schedule=function(n,r,i){return void 0===r&&(r=0),t.delegate&&t.delegate!==this?t.delegate.schedule(n,r,i):e.prototype.schedule.call(this,n,r,i)},t.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(i)},vsh_66624:function(e,t,n){"use strict";n.d(t,{e:function(){return c}});var r=n("vsh_65949"),i=1,o={};var a=function(e){var t=i++;return o[t]=e,Promise.resolve().then((function(){return function(e){var t=o[e];t&&t()}(t)})),t},s=function(e){delete o[e]},u=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return r.__extends(t,e),t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.actions.push(this),t.scheduled||(t.scheduled=a(t.flush.bind(t,null))))},t.prototype.recycleAsyncId=function(t,n,r){if(void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,r);0===t.actions.length&&(s(n),t.scheduled=void 0)},t}(n("vsh_82763").o),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.flush=function(e){this.active=!0,this.scheduled=void 0;var t,n=this.actions,r=-1,i=n.length;e=e||n.shift();do{if(t=e.execute(e.state,e.delay))break}while(++r<i&&(e=n.shift()));if(this.active=!1,t){for(;++r<i&&(e=n.shift());)e.unsubscribe();throw t}},t}(n("vsh_81744").v),c=new l(u)},vsh_40742:function(e,t,n){"use strict";n.d(t,{P:function(){return i}});var r=n("vsh_82763"),i=new(n("vsh_81744").v)(r.o)},vsh_74334:function(e,t,n){"use strict";function r(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}n.d(t,{hZ:function(){return i}});var i=r()},vsh_75258:function(e,t,n){"use strict";n.d(t,{L:function(){return r}});var r="function"==typeof Symbol&&Symbol.observable||"@@observable"},vsh_37981:function(e,t,n){"use strict";n.d(t,{b:function(){return r}});var r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("rxSubscriber"):"@@rxSubscriber"},vsh_57091:function(e,t,n){"use strict";n.d(t,{W:function(){return i}});var r=n("vsh_65949"),i=function(e){function t(){var n=e.call(this,"argument out of range")||this;return n.name="ArgumentOutOfRangeError",Object.setPrototypeOf(n,t.prototype),n}return r.__extends(t,e),t}(Error)},vsh_35210:function(e,t,n){"use strict";n.d(t,{K:function(){return i}});var r=n("vsh_65949"),i=function(e){function t(){var n=e.call(this,"no elements in sequence")||this;return n.name="EmptyError",Object.setPrototypeOf(n,t.prototype),n}return r.__extends(t,e),t}(Error)},vsh_5419:function(e,t,n){"use strict";n.d(t,{N:function(){return i}});var r=n("vsh_65949"),i=function(e){function t(){var n=e.call(this,"object unsubscribed")||this;return n.name="ObjectUnsubscribedError",Object.setPrototypeOf(n,t.prototype),n}return r.__extends(t,e),t}(Error)},vsh_24766:function(e,t,n){"use strict";n.d(t,{T:function(){return r}});var r={e:{}}},vsh_20743:function(e,t,n){"use strict";function r(e){setTimeout((function(){throw e}))}n.d(t,{z:function(){return r}})},vsh_74682:function(e,t,n){"use strict";function r(e){return e}n.d(t,{y:function(){return r}})},vsh_75457:function(e,t,n){"use strict";n.d(t,{k:function(){return r}});var r=Array.isArray||function(e){return e&&"number"==typeof e.length}},vsh_4217:function(e,t,n){"use strict";n.d(t,{z:function(){return r}});var r=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e}},vsh_8196:function(e,t,n){"use strict";function r(e){return"function"==typeof e}n.d(t,{m:function(){return r}})},vsh_35578:function(e,t,n){"use strict";function r(e){return null!=e&&"object"==typeof e}n.d(t,{K:function(){return r}})},vsh_72954:function(e,t,n){"use strict";function r(e){return e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}n.d(t,{t:function(){return r}})},vsh_38962:function(e,t,n){"use strict";function r(e){return e&&"function"==typeof e.schedule}n.d(t,{K:function(){return r}})},vsh_80580:function(e,t,n){"use strict";function r(){}n.d(t,{Z:function(){return r}})},vsh_70622:function(e,t,n){"use strict";n.d(t,{z:function(){return i},U:function(){return o}});var r=n("vsh_80580");function i(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o(e)}function o(e){return e?1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}:r.Z}},vsh_22325:function(e,t,n){"use strict";n.d(t,{s:function(){return f}});var r=n("vsh_4285"),i=n("vsh_33498"),o=n("vsh_14249"),a=n("vsh_2210"),s=n("vsh_64156"),u=n("vsh_4217"),l=n("vsh_72954"),c=n("vsh_35578"),h=n("vsh_74334"),d=n("vsh_75258"),f=function(e){if(e instanceof r.y)return function(t){return e._isScalar?(t.next(e.value),void t.complete()):e.subscribe(t)};if(e&&"function"==typeof e[d.L])return(0,s.h)(e);if((0,u.z)(e))return(0,i.V)(e);if((0,l.t)(e))return(0,o.A)(e);if(e&&"function"==typeof e[h.hZ])return(0,a.u)(e);var t=(0,c.K)(e)?"an invalid object":"'"+e+"'";throw new TypeError("You provided "+t+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")}},vsh_33498:function(e,t,n){"use strict";n.d(t,{V:function(){return r}});var r=function(e){return function(t){for(var n=0,r=e.length;n<r&&!t.closed;n++)t.next(e[n]);t.closed||t.complete()}}},vsh_2210:function(e,t,n){"use strict";n.d(t,{u:function(){return i}});var r=n("vsh_74334"),i=function(e){return function(t){for(var n=e[r.hZ]();;){var i=n.next();if(i.done){t.complete();break}if(t.next(i.value),t.closed)break}return"function"==typeof n.return&&t.add((function(){n.return&&n.return()})),t}}},vsh_64156:function(e,t,n){"use strict";n.d(t,{h:function(){return i}});var r=n("vsh_75258"),i=function(e){return function(t){var n=e[r.L]();if("function"!=typeof n.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return n.subscribe(t)}}},vsh_14249:function(e,t,n){"use strict";n.d(t,{A:function(){return i}});var r=n("vsh_20743"),i=function(e){return function(t){return e.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,r.z),t}}},vsh_69831:function(e,t,n){"use strict";n.d(t,{D:function(){return a}});var r=n("vsh_65949"),i=function(e){function t(t,n,r){var i=e.call(this)||this;return i.parent=t,i.outerValue=n,i.outerIndex=r,i.index=0,i}return r.__extends(t,e),t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},t.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(n("vsh_59992").L),o=n("vsh_22325");function a(e,t,n,r){var a=new i(e,n,r);return(0,o.s)(t)(a)}},vsh_35477:function(e,t,n){"use strict";n.d(t,{Y:function(){return a}});var r,i=n("vsh_24766");function o(){try{return r.apply(this,arguments)}catch(e){return i.T.e=e,i.T}}function a(e){return r=e,o}},vsh_67013:function(e,t,n){"use strict";const r=n("vsh_68530"),i=r.types;function o(e,t){t||(t={});const n=void 0===t.limit?25:t.limit;var o;o=e,"[object RegExp]"==={}.toString.call(o)?e=e.source:"string"!=typeof e&&(e=String(e));try{e=r(e)}catch(e){return!1}let a=0;return function e(t,r){let o,s,u;if(t.type===i.REPETITION){if(r++,a++,r>1)return!1;if(a>n)return!1}if(t.options)for(o=0,u=t.options.length;o<u;o++)if(s=e({stack:t.options[o]},r),!s)return!1;const l=t.stack||t.value&&t.value.stack;if(!l)return!0;for(o=0;o<l.length;o++)if(s=e(l[o],r),!s)return!1;return!0}(e,0)}e.exports=o,e.exports.default=o,e.exports.safeRegex=o},vsh_65714:function(e,t,n){"use strict";var r=n("vsh_40783"),i=n("vsh_63099"),o=n("vsh_12102"),a=r("%TypeError%"),s=r("%WeakMap%",!0),u=r("%Map%",!0),l=i("WeakMap.prototype.get",!0),c=i("WeakMap.prototype.set",!0),h=i("WeakMap.prototype.has",!0),d=i("Map.prototype.get",!0),f=i("Map.prototype.set",!0),p=i("Map.prototype.has",!0),v=function(e,t){for(var n,r=e;null!==(n=r.next);r=n)if(n.key===t)return r.next=n.next,n.next=e.next,e.next=n,n};e.exports=function(){var e,t,n,r={assert:function(e){if(!r.has(e))throw new a("Side channel does not contain "+o(e))},get:function(r){if(s&&r&&("object"==typeof r||"function"==typeof r)){if(e)return l(e,r)}else if(u){if(t)return d(t,r)}else if(n)return function(e,t){var n=v(e,t);return n&&n.value}(n,r)},has:function(r){if(s&&r&&("object"==typeof r||"function"==typeof r)){if(e)return h(e,r)}else if(u){if(t)return p(t,r)}else if(n)return function(e,t){return!!v(e,t)}(n,r);return!1},set:function(r,i){s&&r&&("object"==typeof r||"function"==typeof r)?(e||(e=new s),c(e,r,i)):u?(t||(t=new u),f(t,r,i)):(n||(n={key:{},next:null}),function(e,t,n){var r=v(e,t);r?r.value=n:e.next={key:t,next:e.next,value:n}}(n,r,i))}};return r}},vsh_62218:function(e,t,n){"use strict";var r=n("vsh_55197"),i=n("vsh_27867"),o=n("vsh_38989"),a=n("vsh_49699"),s=n("vsh_63293"),u=n("vsh_38320"),l=n("vsh_63099"),c=n("vsh_91143")(),h=n("vsh_69112"),d=l("String.prototype.indexOf"),f=n("vsh_58240"),p=function(e){var t=f();if(c&&"symbol"==typeof Symbol.matchAll){var n=o(e,Symbol.matchAll);return n===RegExp.prototype[Symbol.matchAll]&&n!==t?t:n}if(a(e))return t};e.exports=function(e){var t=u(this);if(null!=e){if(a(e)){var n="flags"in e?i(e,"flags"):h(e);if(u(n),d(s(n),"g")<0)throw new TypeError("matchAll requires a global regular expression")}var o=p(e);if(void 0!==o)return r(o,e,[t])}var l=s(t),c=new RegExp(e,"g");return r(p(c),c,[l])}},vsh_37833:function(e,t,n){"use strict";var r=n("vsh_72755"),i=n("vsh_90722"),o=n("vsh_62218"),a=n("vsh_50388"),s=n("vsh_6612"),u=r(o);i(u,{getPolyfill:a,implementation:o,shim:s}),e.exports=u},vsh_58240:function(e,t,n){"use strict";var r=n("vsh_91143")(),i=n("vsh_2744");e.exports=function(){return r&&"symbol"==typeof Symbol.matchAll&&"function"==typeof RegExp.prototype[Symbol.matchAll]?RegExp.prototype[Symbol.matchAll]:i}},vsh_50388:function(e,t,n){"use strict";var r=n("vsh_62218");e.exports=function(){if(String.prototype.matchAll)try{"".matchAll(RegExp.prototype)}catch(e){return String.prototype.matchAll}return r}},vsh_2744:function(e,t,n){"use strict";var r=n("vsh_51208"),i=n("vsh_27867"),o=n("vsh_13655"),a=n("vsh_8120"),s=n("vsh_65357"),u=n("vsh_63293"),l=n("vsh_98326"),c=n("vsh_69112"),h=RegExp,d="flags"in RegExp.prototype,f=function(e){var t=this;if("Object"!==l(t))throw new TypeError('"this" value must be an Object');var n=u(e),f=function(e,t){var n="flags"in t?i(t,"flags"):u(c(t));return{flags:n,matcher:new e(d&&"string"==typeof n?t:e===h?t.source:t,n)}}(a(t,h),t),p=f.flags,v=f.matcher,g=s(i(t,"lastIndex"));o(v,"lastIndex",g,!0);var _=p.indexOf("g")>-1,y=p.indexOf("u")>-1;return r(v,n,_,y)},p=Object.defineProperty,v=Object.getOwnPropertyDescriptor;if(p&&v){var g=v(f,"name");g&&g.configurable&&p(f,"name",{value:"[Symbol.matchAll]"})}e.exports=f},vsh_6612:function(e,t,n){"use strict";var r=n("vsh_90722"),i=n("vsh_91143")(),o=n("vsh_50388"),a=n("vsh_58240"),s=Object.defineProperty,u=Object.getOwnPropertyDescriptor;e.exports=function(){var e=o();if(r(String.prototype,{matchAll:e},{matchAll:function(){return String.prototype.matchAll!==e}}),i){var t=Symbol.matchAll||(Symbol.for?Symbol.for("Symbol.matchAll"):Symbol("Symbol.matchAll"));if(r(Symbol,{matchAll:t},{matchAll:function(){return Symbol.matchAll!==t}}),s&&u){var n=u(Symbol,t);n&&!n.configurable||s(Symbol,t,{configurable:!1,enumerable:!1,value:t,writable:!1})}var l=a(),c={};c[t]=l;var h={};h[t]=function(){return RegExp.prototype[t]!==l},r(RegExp.prototype,c,h)}return e}},vsh_33476:function(e,t,n){var r;!function(i){var o=/^\s+/,a=/\s+$/,s=0,u=i.round,l=i.min,c=i.max,h=i.random;function d(e,t){if(t=t||{},(e=e||"")instanceof d)return e;if(!(this instanceof d))return new d(e,t);var n=function(e){var t={r:0,g:0,b:0},n=1,r=null,s=null,u=null,h=!1,d=!1;"string"==typeof e&&(e=function(e){e=e.replace(o,"").replace(a,"").toLowerCase();var t,n=!1;if(k[e])e=k[e],n=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};if(t=W.rgb.exec(e))return{r:t[1],g:t[2],b:t[3]};if(t=W.rgba.exec(e))return{r:t[1],g:t[2],b:t[3],a:t[4]};if(t=W.hsl.exec(e))return{h:t[1],s:t[2],l:t[3]};if(t=W.hsla.exec(e))return{h:t[1],s:t[2],l:t[3],a:t[4]};if(t=W.hsv.exec(e))return{h:t[1],s:t[2],v:t[3]};if(t=W.hsva.exec(e))return{h:t[1],s:t[2],v:t[3],a:t[4]};if(t=W.hex8.exec(e))return{r:L(t[1]),g:L(t[2]),b:L(t[3]),a:V(t[4]),format:n?"name":"hex8"};if(t=W.hex6.exec(e))return{r:L(t[1]),g:L(t[2]),b:L(t[3]),format:n?"name":"hex"};if(t=W.hex4.exec(e))return{r:L(t[1]+""+t[1]),g:L(t[2]+""+t[2]),b:L(t[3]+""+t[3]),a:V(t[4]+""+t[4]),format:n?"name":"hex8"};if(t=W.hex3.exec(e))return{r:L(t[1]+""+t[1]),g:L(t[2]+""+t[2]),b:L(t[3]+""+t[3]),format:n?"name":"hex"};return!1}(e));"object"==typeof e&&(j(e.r)&&j(e.g)&&j(e.b)?(f=e.r,p=e.g,v=e.b,t={r:255*N(f,255),g:255*N(p,255),b:255*N(v,255)},h=!0,d="%"===String(e.r).substr(-1)?"prgb":"rgb"):j(e.h)&&j(e.s)&&j(e.v)?(r=F(e.s),s=F(e.v),t=function(e,t,n){e=6*N(e,360),t=N(t,100),n=N(n,100);var r=i.floor(e),o=e-r,a=n*(1-t),s=n*(1-o*t),u=n*(1-(1-o)*t),l=r%6;return{r:255*[n,s,a,a,u,n][l],g:255*[u,n,n,s,a,a][l],b:255*[a,a,u,n,n,s][l]}}(e.h,r,s),h=!0,d="hsv"):j(e.h)&&j(e.s)&&j(e.l)&&(r=F(e.s),u=F(e.l),t=function(e,t,n){var r,i,o;function a(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}if(e=N(e,360),t=N(t,100),n=N(n,100),0===t)r=i=o=n;else{var s=n<.5?n*(1+t):n+t-n*t,u=2*n-s;r=a(u,s,e+1/3),i=a(u,s,e),o=a(u,s,e-1/3)}return{r:255*r,g:255*i,b:255*o}}(e.h,r,u),h=!0,d="hsl"),e.hasOwnProperty("a")&&(n=e.a));var f,p,v;return n=x(n),{ok:h,format:e.format||d,r:l(255,c(t.r,0)),g:l(255,c(t.g,0)),b:l(255,c(t.b,0)),a:n}}(e);this._originalInput=e,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=u(100*this._a)/100,this._format=t.format||n.format,this._gradientType=t.gradientType,this._r<1&&(this._r=u(this._r)),this._g<1&&(this._g=u(this._g)),this._b<1&&(this._b=u(this._b)),this._ok=n.ok,this._tc_id=s++}function f(e,t,n){e=N(e,255),t=N(t,255),n=N(n,255);var r,i,o=c(e,t,n),a=l(e,t,n),s=(o+a)/2;if(o==a)r=i=0;else{var u=o-a;switch(i=s>.5?u/(2-o-a):u/(o+a),o){case e:r=(t-n)/u+(t<n?6:0);break;case t:r=(n-e)/u+2;break;case n:r=(e-t)/u+4}r/=6}return{h:r,s:i,l:s}}function p(e,t,n){e=N(e,255),t=N(t,255),n=N(n,255);var r,i,o=c(e,t,n),a=l(e,t,n),s=o,u=o-a;if(i=0===o?0:u/o,o==a)r=0;else{switch(o){case e:r=(t-n)/u+(t<n?6:0);break;case t:r=(n-e)/u+2;break;case n:r=(e-t)/u+4}r/=6}return{h:r,s:i,v:s}}function v(e,t,n,r){var i=[D(u(e).toString(16)),D(u(t).toString(16)),D(u(n).toString(16))];return r&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function g(e,t,n,r){return[D(B(r)),D(u(e).toString(16)),D(u(t).toString(16)),D(u(n).toString(16))].join("")}function _(e,t){t=0===t?0:t||10;var n=d(e).toHsl();return n.s-=t/100,n.s=P(n.s),d(n)}function y(e,t){t=0===t?0:t||10;var n=d(e).toHsl();return n.s+=t/100,n.s=P(n.s),d(n)}function m(e){return d(e).desaturate(100)}function E(e,t){t=0===t?0:t||10;var n=d(e).toHsl();return n.l+=t/100,n.l=P(n.l),d(n)}function b(e,t){t=0===t?0:t||10;var n=d(e).toRgb();return n.r=c(0,l(255,n.r-u(-t/100*255))),n.g=c(0,l(255,n.g-u(-t/100*255))),n.b=c(0,l(255,n.b-u(-t/100*255))),d(n)}function T(e,t){t=0===t?0:t||10;var n=d(e).toHsl();return n.l-=t/100,n.l=P(n.l),d(n)}function C(e,t){var n=d(e).toHsl(),r=(n.h+t)%360;return n.h=r<0?360+r:r,d(n)}function S(e){var t=d(e).toHsl();return t.h=(t.h+180)%360,d(t)}function w(e){var t=d(e).toHsl(),n=t.h;return[d(e),d({h:(n+120)%360,s:t.s,l:t.l}),d({h:(n+240)%360,s:t.s,l:t.l})]}function R(e){var t=d(e).toHsl(),n=t.h;return[d(e),d({h:(n+90)%360,s:t.s,l:t.l}),d({h:(n+180)%360,s:t.s,l:t.l}),d({h:(n+270)%360,s:t.s,l:t.l})]}function A(e){var t=d(e).toHsl(),n=t.h;return[d(e),d({h:(n+72)%360,s:t.s,l:t.l}),d({h:(n+216)%360,s:t.s,l:t.l})]}function O(e,t,n){t=t||6,n=n||30;var r=d(e).toHsl(),i=360/n,o=[d(e)];for(r.h=(r.h-(i*t>>1)+720)%360;--t;)r.h=(r.h+i)%360,o.push(d(r));return o}function M(e,t){t=t||6;for(var n=d(e).toHsv(),r=n.h,i=n.s,o=n.v,a=[],s=1/t;t--;)a.push(d({h:r,s:i,v:o})),o=(o+s)%1;return a}d.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},getLuminance:function(){var e,t,n,r=this.toRgb();return e=r.r/255,t=r.g/255,n=r.b/255,.2126*(e<=.03928?e/12.92:i.pow((e+.055)/1.055,2.4))+.7152*(t<=.03928?t/12.92:i.pow((t+.055)/1.055,2.4))+.0722*(n<=.03928?n/12.92:i.pow((n+.055)/1.055,2.4))},setAlpha:function(e){return this._a=x(e),this._roundA=u(100*this._a)/100,this},toHsv:function(){var e=p(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=p(this._r,this._g,this._b),t=u(360*e.h),n=u(100*e.s),r=u(100*e.v);return 1==this._a?"hsv("+t+", "+n+"%, "+r+"%)":"hsva("+t+", "+n+"%, "+r+"%, "+this._roundA+")"},toHsl:function(){var e=f(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=f(this._r,this._g,this._b),t=u(360*e.h),n=u(100*e.s),r=u(100*e.l);return 1==this._a?"hsl("+t+", "+n+"%, "+r+"%)":"hsla("+t+", "+n+"%, "+r+"%, "+this._roundA+")"},toHex:function(e){return v(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return function(e,t,n,r,i){var o=[D(u(e).toString(16)),D(u(t).toString(16)),D(u(n).toString(16)),D(B(r))];if(i&&o[0].charAt(0)==o[0].charAt(1)&&o[1].charAt(0)==o[1].charAt(1)&&o[2].charAt(0)==o[2].charAt(1)&&o[3].charAt(0)==o[3].charAt(1))return o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0)+o[3].charAt(0);return o.join("")}(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:u(this._r),g:u(this._g),b:u(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+u(this._r)+", "+u(this._g)+", "+u(this._b)+")":"rgba("+u(this._r)+", "+u(this._g)+", "+u(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:u(100*N(this._r,255))+"%",g:u(100*N(this._g,255))+"%",b:u(100*N(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+u(100*N(this._r,255))+"%, "+u(100*N(this._g,255))+"%, "+u(100*N(this._b,255))+"%)":"rgba("+u(100*N(this._r,255))+"%, "+u(100*N(this._g,255))+"%, "+u(100*N(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(I[v(this._r,this._g,this._b,!0)]||!1)},toFilter:function(e){var t="#"+g(this._r,this._g,this._b,this._a),n=t,r=this._gradientType?"GradientType = 1, ":"";if(e){var i=d(e);n="#"+g(i._r,i._g,i._b,i._a)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+t+",endColorstr="+n+")"},toString:function(e){var t=!!e;e=e||this._format;var n=!1,r=this._a<1&&this._a>=0;return t||!r||"hex"!==e&&"hex6"!==e&&"hex3"!==e&&"hex4"!==e&&"hex8"!==e&&"name"!==e?("rgb"===e&&(n=this.toRgbString()),"prgb"===e&&(n=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(n=this.toHexString()),"hex3"===e&&(n=this.toHexString(!0)),"hex4"===e&&(n=this.toHex8String(!0)),"hex8"===e&&(n=this.toHex8String()),"name"===e&&(n=this.toName()),"hsl"===e&&(n=this.toHslString()),"hsv"===e&&(n=this.toHsvString()),n||this.toHexString()):"name"===e&&0===this._a?this.toName():this.toRgbString()},clone:function(){return d(this.toString())},_applyModification:function(e,t){var n=e.apply(null,[this].concat([].slice.call(t)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(E,arguments)},brighten:function(){return this._applyModification(b,arguments)},darken:function(){return this._applyModification(T,arguments)},desaturate:function(){return this._applyModification(_,arguments)},saturate:function(){return this._applyModification(y,arguments)},greyscale:function(){return this._applyModification(m,arguments)},spin:function(){return this._applyModification(C,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(O,arguments)},complement:function(){return this._applyCombination(S,arguments)},monochromatic:function(){return this._applyCombination(M,arguments)},splitcomplement:function(){return this._applyCombination(A,arguments)},triad:function(){return this._applyCombination(w,arguments)},tetrad:function(){return this._applyCombination(R,arguments)}},d.fromRatio=function(e,t){if("object"==typeof e){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]="a"===r?e[r]:F(e[r]));e=n}return d(e,t)},d.equals=function(e,t){return!(!e||!t)&&d(e).toRgbString()==d(t).toRgbString()},d.random=function(){return d.fromRatio({r:h(),g:h(),b:h()})},d.mix=function(e,t,n){n=0===n?0:n||50;var r=d(e).toRgb(),i=d(t).toRgb(),o=n/100;return d({r:(i.r-r.r)*o+r.r,g:(i.g-r.g)*o+r.g,b:(i.b-r.b)*o+r.b,a:(i.a-r.a)*o+r.a})},d.readability=function(e,t){var n=d(e),r=d(t);return(i.max(n.getLuminance(),r.getLuminance())+.05)/(i.min(n.getLuminance(),r.getLuminance())+.05)},d.isReadable=function(e,t,n){var r,i,o=d.readability(e,t);switch(i=!1,(r=function(e){var t,n;t=((e=e||{level:"AA",size:"small"}).level||"AA").toUpperCase(),n=(e.size||"small").toLowerCase(),"AA"!==t&&"AAA"!==t&&(t="AA");"small"!==n&&"large"!==n&&(n="small");return{level:t,size:n}}(n)).level+r.size){case"AAsmall":case"AAAlarge":i=o>=4.5;break;case"AAlarge":i=o>=3;break;case"AAAsmall":i=o>=7}return i},d.mostReadable=function(e,t,n){var r,i,o,a,s=null,u=0;i=(n=n||{}).includeFallbackColors,o=n.level,a=n.size;for(var l=0;l<t.length;l++)(r=d.readability(e,t[l]))>u&&(u=r,s=d(t[l]));return d.isReadable(e,s,{level:o,size:a})||!i?s:(n.includeFallbackColors=!1,d.mostReadable(e,["#fff","#000"],n))};var k=d.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},I=d.hexNames=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}(k);function x(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function N(e,t){(function(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var n=function(e){return"string"==typeof e&&-1!=e.indexOf("%")}(e);return e=l(t,c(0,parseFloat(e))),n&&(e=parseInt(e*t,10)/100),i.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function P(e){return l(1,c(0,e))}function L(e){return parseInt(e,16)}function D(e){return 1==e.length?"0"+e:""+e}function F(e){return e<=1&&(e=100*e+"%"),e}function B(e){return i.round(255*parseFloat(e)).toString(16)}function V(e){return L(e)/255}var H,U,Z,W=(U="[\\s|\\(]+("+(H="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+H+")[,|\\s]+("+H+")\\s*\\)?",Z="[\\s|\\(]+("+H+")[,|\\s]+("+H+")[,|\\s]+("+H+")[,|\\s]+("+H+")\\s*\\)?",{CSS_UNIT:new RegExp(H),rgb:new RegExp("rgb"+U),rgba:new RegExp("rgba"+Z),hsl:new RegExp("hsl"+U),hsla:new RegExp("hsla"+Z),hsv:new RegExp("hsv"+U),hsva:new RegExp("hsva"+Z),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function j(e){return!!W.CSS_UNIT.exec(e)}e.exports?e.exports=d:void 0===(r=function(){return d}.call(t,n,t,e))||(e.exports=r)}(Math)},vsh_65949:function(e,t,n){"use strict";n.r(t),n.d(t,{__extends:function(){return i},__assign:function(){return o},__rest:function(){return a},__decorate:function(){return s},__param:function(){return u},__metadata:function(){return l},__awaiter:function(){return c},__generator:function(){return h},__createBinding:function(){return d},__exportStar:function(){return f},__values:function(){return p},__read:function(){return v},__spread:function(){return g},__spreadArrays:function(){return _},__await:function(){return y},__asyncGenerator:function(){return m},__asyncDelegator:function(){return E},__asyncValues:function(){return b},__makeTemplateObject:function(){return T},__importStar:function(){return C},__importDefault:function(){return S},__classPrivateFieldGet:function(){return w},__classPrivateFieldSet:function(){return R}});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)};function i(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function s(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function u(e,t){return function(n,r){t(n,r,e)}}function l(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function c(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function h(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function d(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}function f(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||(t[n]=e[n])}function p(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function g(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function _(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function y(e){return this instanceof y?(this.v=e,this):new y(e)}function m(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||s(e,t)}))})}function s(e,t){try{(n=i[e](t)).value instanceof y?Promise.resolve(n.value.v).then(u,l):c(o[0][2],n)}catch(e){c(o[0][3],e)}var n}function u(e){s("next",e)}function l(e){s("throw",e)}function c(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function E(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:y(e[r](t)),done:"return"===r}:i?i(t):t}:i}}function b(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=p(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,i,(t=e[n](t)).done,t.value)}))}}}function T(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function C(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function S(e){return e&&e.__esModule?e:{default:e}}function w(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function R(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n}},vsh_45617:function(e,t,n){var r=n("vsh_14280"),i=n("vsh_47962"),o=i;o.v1=r,o.v4=i,e.exports=o},vsh_57185:function(e){for(var t=[],n=0;n<256;++n)t[n]=(n+256).toString(16).substr(1);e.exports=function(e,n){var r=n||0,i=t;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},vsh_91572:function(e){var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var n=new Uint8Array(16);e.exports=function(){return t(n),n}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}},vsh_14280:function(e,t,n){var r,i,o=n("vsh_91572"),a=n("vsh_57185"),s=0,u=0;e.exports=function(e,t,n){var l=t&&n||0,c=t||[],h=(e=e||{}).node||r,d=void 0!==e.clockseq?e.clockseq:i;if(null==h||null==d){var f=o();null==h&&(h=r=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==d&&(d=i=16383&(f[6]<<8|f[7]))}var p=void 0!==e.msecs?e.msecs:(new Date).getTime(),v=void 0!==e.nsecs?e.nsecs:u+1,g=p-s+(v-u)/1e4;if(g<0&&void 0===e.clockseq&&(d=d+1&16383),(g<0||p>s)&&void 0===e.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=p,u=v,i=d;var _=(1e4*(268435455&(p+=122192928e5))+v)%4294967296;c[l++]=_>>>24&255,c[l++]=_>>>16&255,c[l++]=_>>>8&255,c[l++]=255&_;var y=p/4294967296*1e4&268435455;c[l++]=y>>>8&255,c[l++]=255&y,c[l++]=y>>>24&15|16,c[l++]=y>>>16&255,c[l++]=d>>>8|128,c[l++]=255&d;for(var m=0;m<6;++m)c[l+m]=h[m];return t||a(c)}},vsh_47962:function(e,t,n){var r=n("vsh_91572"),i=n("vsh_57185");e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[o+s]=a[s];return t||i(a)}},vsh_40614:function(e){for(var t=[],n=0;n<256;++n)t[n]=(n+256).toString(16).substr(1);e.exports=function(e,n){var r=n||0,i=t;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},vsh_10537:function(e){var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var n=new Uint8Array(16);e.exports=function(){return t(n),n}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}},vsh_85234:function(e,t,n){var r=n("vsh_10537"),i=n("vsh_40614");e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[o+s]=a[s];return t||i(a)}},vsh_3703:function(){window.sheet_resetExternalModule=function(t){var r=window["sheet/"]||{},i=window.Garfish&&window.Garfish.externals?window.Garfish.externals:{};"@platform-fe/biz-mention"===t&&(l=r[t]?r[t]:i["sheet/"+t]),"@platform-fe/comment"===t&&(f=r[t]?r[t]:i["sheet/"+t]),"@adit/block"===t&&(e=r[t]?r[t]:i["sheet/"+t]),"@adit/comment-sdk"===t&&(r[t]?__WEBPACK_EXTERNAL_MODULE_vsh_adit_comment_sdk__=r[t]:__WEBPACK_EXTERNAL_MODULE_vsh_adit_comment_sdk__=i["sheet/"+t]),"@adit/editor"===t&&(n=r[t]?r[t]:i["sheet/"+t]),"bear-sheet-external/delay/limit-edit-mode"===t&&(V=r[t]?r[t]:i["sheet/"+t]),"bear-sheet-external/delay/date-reminder"===t&&(D=r[t]?r[t]:i["sheet/"+t]),"bear-sheet-external/delay/reaction"===t&&(r[t]?__WEBPACK_EXTERNAL_MODULE_vsh_bear_sheet_external_delay_reaction__=r[t]:__WEBPACK_EXTERNAL_MODULE_vsh_bear_sheet_external_delay_reaction__=i["sheet/"+t]),"bear-sheet-external/delay/block"===t&&(r[t]?__WEBPACK_EXTERNAL_MODULE_vsh_bear_sheet_external_delay_block__=r[t]:__WEBPACK_EXTERNAL_MODULE_vsh_bear_sheet_external_delay_block__=i["sheet/"+t]),"bear-sheet-external/delay/subscription"===t&&(Z=r[t]?r[t]:i["sheet/"+t])}},vsh_66588:function(e){"use strict";e.exports=function(e,t,n,r){var i=self||window;try{try{var o;try{o=new i.Blob([e])}catch(t){(o=new(i.BlobBuilder||i.WebKitBlobBuilder||i.MozBlobBuilder||i.MSBlobBuilder)).append(e),o=o.getBlob()}var a=i.URL||i.webkitURL,s=a.createObjectURL(o),u=new i[t](s,n);return a.revokeObjectURL(s),u}catch(r){return new i[t]("data:application/javascript,".concat(encodeURIComponent(e)),n)}}catch(e){if(!r)throw Error("Inline worker is not supported");return new i[t](r,n)}}},"vsh_@adit/block":function(t){"use strict";t.exports=e},vsh_83500:function(e){"use strict";e.exports=t},"vsh_@adit/editor":function(e){"use strict";e.exports=n},vsh_64841:function(e){"use strict";e.exports=r},vsh_31630:function(e){"use strict";e.exports=i},vsh_47361:function(e){"use strict";e.exports=o},vsh_31053:function(e){"use strict";e.exports=a},vsh_59800:function(e){"use strict";e.exports=s},vsh_78400:function(e){"use strict";e.exports=u},"vsh_@platform-fe/biz-mention":function(e){"use strict";e.exports=l},vsh_44397:function(e){"use strict";e.exports=c},vsh_6127:function(e){"use strict";e.exports=h},vsh_7121:function(e){"use strict";e.exports=d},"vsh_@platform-fe/comment":function(e){"use strict";e.exports=f},vsh_79591:function(e){"use strict";e.exports=p},vsh_75416:function(e){"use strict";e.exports=v},vsh_69691:function(e){"use strict";e.exports=g},vsh_18043:function(e){"use strict";e.exports=_},vsh_60591:function(e){"use strict";e.exports=y},vsh_56450:function(e){"use strict";e.exports=m},vsh_54997:function(e){"use strict";e.exports=E},vsh_68661:function(e){"use strict";e.exports=b},vsh_14801:function(e){"use strict";e.exports=T},vsh_34792:function(e){"use strict";e.exports=C},vsh_1252:function(e){"use strict";e.exports=S},vsh_17299:function(e){"use strict";e.exports=w},vsh_56767:function(e){"use strict";e.exports=R},vsh_63886:function(e){"use strict";if(void 0===A){var t=new Error("Cannot find module 'undefined'");throw t.code="MODULE_NOT_FOUND",t}e.exports=A},vsh_68499:function(e){"use strict";e.exports=O},vsh_18801:function(e){"use strict";e.exports=M},vsh_23585:function(e){"use strict";e.exports=k},vsh_12484:function(e){"use strict";e.exports=I},vsh_37916:function(e){"use strict";e.exports=x},vsh_79088:function(e){"use strict";e.exports=N},vsh_75729:function(e){"use strict";e.exports=P},vsh_29904:function(e){"use strict";e.exports=L},"vsh_bear-sheet-external/delay/date-reminder":function(e){"use strict";e.exports=D},vsh_50627:function(e){"use strict";e.exports=F},vsh_45552:function(e){"use strict";e.exports=B},"vsh_bear-sheet-external/delay/limit-edit-mode":function(e){"use strict";e.exports=V},vsh_78914:function(e){"use strict";e.exports=H},vsh_78733:function(e){"use strict";e.exports=U},"vsh_bear-sheet-external/delay/subscription":function(e){"use strict";e.exports=Z},vsh_22488:function(e){"use strict";e.exports=W},vsh_32841:function(e){"use strict";e.exports=j},vsh_30430:function(e){"use strict";e.exports=G},vsh_96579:function(e){"use strict";e.exports=z},vsh_18856:function(e){"use strict";e.exports=Y},vsh_66988:function(e){"use strict";e.exports=X},vsh_23414:function(e){"use strict";e.exports=K},vsh_91777:function(e){"use strict";e.exports=q},vsh_39534:function(e){"use strict";e.exports=$},vsh_92292:function(e){"use strict";e.exports=J},vsh_39046:function(e){"use strict";e.exports=Q},vsh_34539:function(e){"use strict";e.exports=ee},vsh_56228:function(e){"use strict";e.exports=te},vsh_60505:function(e){"use strict";e.exports=ne},vsh_98125:function(e){"use strict";e.exports=re},vsh_78898:function(e){"use strict";e.exports=ie},vsh_52856:function(e){"use strict";e.exports=oe},vsh_30043:function(e){"use strict";e.exports=ae},vsh_82228:function(e){"use strict";e.exports=se},vsh_4927:function(e){"use strict";e.exports=ue},vsh_42037:function(e){"use strict";e.exports=le},vsh_94596:function(e){"use strict";e.exports=ce},vsh_69540:function(e){"use strict";e.exports=he},vsh_57524:function(e){"use strict";e.exports=de},vsh_73565:function(e){"use strict";e.exports=fe},vsh_64121:function(){},vsh_81200:function(e,t,n){"use strict";var r=n("vsh_40783")("%Array%"),i=!r.isArray&&n("vsh_63099")("Object.prototype.toString");e.exports=r.isArray||function(e){return"[object Array]"===i(e)}},vsh_80017:function(e,t,n){"use strict";var r=n("vsh_40783"),i=n("vsh_58200"),o=n("vsh_16370"),a=n("vsh_98326"),s=n("vsh_63271"),u=r("%TypeError%");e.exports=function(e,t,n){if("String"!==a(e))throw new u("Assertion failed: `S` must be a String");if(!o(t)||t<0||t>s)throw new u("Assertion failed: `length` must be an integer >= 0 and <= 2**53");if("Boolean"!==a(n))throw new u("Assertion failed: `unicode` must be a Boolean");return n?t+1>=e.length?t+1:t+i(e,t)["[[CodeUnitCount]]"]:t+1}},vsh_55197:function(e,t,n){"use strict";var r=n("vsh_40783"),i=n("vsh_63099"),o=r("%TypeError%"),a=n("vsh_68333"),s=r("%Reflect.apply%",!0)||i("%Function.prototype.apply%");e.exports=function(e,t){var n=arguments.length>2?arguments[2]:[];if(!a(n))throw new o("Assertion failed: optional `argumentsList`, if provided, must be a List");return s(e,t,n)}},vsh_58200:function(e,t,n){"use strict";var r=n("vsh_40783")("%TypeError%"),i=n("vsh_63099"),o=n("vsh_89209"),a=n("vsh_18396"),s=n("vsh_98326"),u=n("vsh_85407"),l=i("String.prototype.charAt"),c=i("String.prototype.charCodeAt");e.exports=function(e,t){if("String"!==s(e))throw new r("Assertion failed: `string` must be a String");var n=e.length;if(t<0||t>=n)throw new r("Assertion failed: `position` must be >= 0, and < the length of `string`");var i=c(e,t),h=l(e,t),d=o(i),f=a(i);if(!d&&!f)return{"[[CodePoint]]":h,"[[CodeUnitCount]]":1,"[[IsUnpairedSurrogate]]":!1};if(f||t+1===n)return{"[[CodePoint]]":h,"[[CodeUnitCount]]":1,"[[IsUnpairedSurrogate]]":!0};var p=c(e,t+1);return a(p)?{"[[CodePoint]]":u(i,p),"[[CodeUnitCount]]":2,"[[IsUnpairedSurrogate]]":!1}:{"[[CodePoint]]":h,"[[CodeUnitCount]]":1,"[[IsUnpairedSurrogate]]":!0}}},vsh_98836:function(e,t,n){"use strict";var r=n("vsh_40783")("%TypeError%"),i=n("vsh_98326");e.exports=function(e,t){if("Boolean"!==i(t))throw new r("Assertion failed: Type(done) is not Boolean");return{value:e,done:t}}},vsh_76258:function(e,t,n){"use strict";var r=n("vsh_40783")("%TypeError%"),i=n("vsh_58577"),o=n("vsh_31344"),a=n("vsh_38372"),s=n("vsh_56657"),u=n("vsh_35261"),l=n("vsh_98326");e.exports=function(e,t,n){if("Object"!==l(e))throw new r("Assertion failed: Type(O) is not Object");if(!s(t))throw new r("Assertion failed: IsPropertyKey(P) is not true");return i(a,u,o,e,t,{"[[Configurable]]":!0,"[[Enumerable]]":!1,"[[Value]]":n,"[[Writable]]":!0})}},vsh_51208:function(e,t,n){"use strict";var r=n("vsh_40783"),i=n("vsh_91143")(),o=r("%TypeError%"),a=r("%IteratorPrototype%",!0),s=r("%Object.defineProperty%",!0),u=n("vsh_80017"),l=n("vsh_98836"),c=n("vsh_76258"),h=n("vsh_27867"),d=n("vsh_55487"),f=n("vsh_38580"),p=n("vsh_13655"),v=n("vsh_65357"),g=n("vsh_63293"),_=n("vsh_98326"),y=n("vsh_26252"),m=function(e,t,n,r){if("String"!==_(t))throw new o("`S` must be a string");if("Boolean"!==_(n))throw new o("`global` must be a boolean");if("Boolean"!==_(r))throw new o("`fullUnicode` must be a boolean");y.set(this,"[[IteratingRegExp]]",e),y.set(this,"[[IteratedString]]",t),y.set(this,"[[Global]]",n),y.set(this,"[[Unicode]]",r),y.set(this,"[[Done]]",!1)};a&&(m.prototype=d(a));if(c(m.prototype,"next",(function(){var e=this;if("Object"!==_(e))throw new o("receiver must be an object");if(!(e instanceof m&&y.has(e,"[[IteratingRegExp]]")&&y.has(e,"[[IteratedString]]")&&y.has(e,"[[Global]]")&&y.has(e,"[[Unicode]]")&&y.has(e,"[[Done]]")))throw new o('"this" value must be a RegExpStringIterator instance');if(y.get(e,"[[Done]]"))return l(void 0,!0);var t=y.get(e,"[[IteratingRegExp]]"),n=y.get(e,"[[IteratedString]]"),r=y.get(e,"[[Global]]"),i=y.get(e,"[[Unicode]]"),a=f(t,n);if(null===a)return y.set(e,"[[Done]]",!0),l(void 0,!0);if(r){if(""===g(h(a,"0"))){var s=v(h(t,"lastIndex")),c=u(n,s,i);p(t,"lastIndex",c,!0)}return l(a,!1)}return y.set(e,"[[Done]]",!0),l(a,!1)})),i&&(Symbol.toStringTag&&(s?s(m.prototype,Symbol.toStringTag,{configurable:!0,enumerable:!1,value:"RegExp String Iterator",writable:!1}):m.prototype[Symbol.toStringTag]="RegExp String Iterator"),Symbol.iterator&&"function"!=typeof m.prototype[Symbol.iterator])){c(m.prototype,Symbol.iterator,(function(){return this}))}e.exports=function(e,t,n,r){return new m(e,t,n,r)}},vsh_15822:function(e,t,n){"use strict";var r=n("vsh_40783")("%TypeError%"),i=n("vsh_50359"),o=n("vsh_58577"),a=n("vsh_31344"),s=n("vsh_14103"),u=n("vsh_38372"),l=n("vsh_56657"),c=n("vsh_35261"),h=n("vsh_27281"),d=n("vsh_98326");e.exports=function(e,t,n){if("Object"!==d(e))throw new r("Assertion failed: Type(O) is not Object");if(!l(t))throw new r("Assertion failed: IsPropertyKey(P) is not true");var f=i({Type:d,IsDataDescriptor:u,IsAccessorDescriptor:s},n)?n:h(n);if(!i({Type:d,IsDataDescriptor:u,IsAccessorDescriptor:s},f))throw new r("Assertion failed: Desc is not a valid Property Descriptor");return o(u,c,a,e,t,f)}},vsh_31344:function(e,t,n){"use strict";var r=n("vsh_8576"),i=n("vsh_98326");e.exports=function(e){if(void 0===e)return e;r(i,"Property Descriptor","Desc",e);var t={};return"[[Value]]"in e&&(t.value=e["[[Value]]"]),"[[Writable]]"in e&&(t.writable=e["[[Writable]]"]),"[[Get]]"in e&&(t.get=e["[[Get]]"]),"[[Set]]"in e&&(t.set=e["[[Set]]"]),"[[Enumerable]]"in e&&(t.enumerable=e["[[Enumerable]]"]),"[[Configurable]]"in e&&(t.configurable=e["[[Configurable]]"]),t}},vsh_27867:function(e,t,n){"use strict";var r=n("vsh_40783")("%TypeError%"),i=n("vsh_12102"),o=n("vsh_56657"),a=n("vsh_98326");e.exports=function(e,t){if("Object"!==a(e))throw new r("Assertion failed: Type(O) is not Object");if(!o(t))throw new r("Assertion failed: IsPropertyKey(P) is not true, got "+i(t));return e[t]}},vsh_38989:function(e,t,n){"use strict";var r=n("vsh_40783")("%TypeError%"),i=n("vsh_48528"),o=n("vsh_22411"),a=n("vsh_56657");e.exports=function(e,t){if(!a(t))throw new r("Assertion failed: IsPropertyKey(P) is not true");var n=i(e,t);if(null!=n){if(!o(n))throw new r(t+"is not a function");return n}}},vsh_48528:function(e,t,n){"use strict";var r=n("vsh_40783")("%TypeError%"),i=n("vsh_56657"),o=n("vsh_20673");e.exports=function(e,t){if(!i(t))throw new r("Assertion failed: IsPropertyKey(P) is not true");return o(e)[t]}},vsh_14103:function(e,t,n){"use strict";var r=n("vsh_68416"),i=n("vsh_8576"),o=n("vsh_98326");e.exports=function(e){return void 0!==e&&(i(o,"Property Descriptor","Desc",e),!(!r(e,"[[Get]]")&&!r(e,"[[Set]]")))}},vsh_68333:function(e,t,n){"use strict";var r=n("vsh_40783")("%Array%"),i=!r.isArray&&n("vsh_63099")("Object.prototype.toString");e.exports=r.isArray||function(e){return"[object Array]"===i(e)}},vsh_22411:function(e,t,n){"use strict";e.exports=n("vsh_36983")},vsh_78208:function(e,t,n){"use strict";var r=n("vsh_27189")("%Reflect.construct%",!0),i=n("vsh_15822");try{i({},"",{"[[Get]]":function(){}})}catch(e){i=null}if(i&&r){var o={},a={};i(a,"length",{"[[Get]]":function(){throw o},"[[Enumerable]]":!0}),e.exports=function(e){try{r(e,a)}catch(e){return e===o}}}else e.exports=function(e){return"function"==typeof e&&!!e.prototype}},vsh_38372:function(e,t,n){"use strict";var r=n("vsh_68416"),i=n("vsh_8576"),o=n("vsh_98326");e.exports=function(e){return void 0!==e&&(i(o,"Property Descriptor","Desc",e),!(!r(e,"[[Value]]")&&!r(e,"[[Writable]]")))}},vsh_16370:function(e,t,n){"use strict";var r=n("vsh_51709"),i=n("vsh_29047"),o=n("vsh_98326"),a=n("vsh_41903"),s=n("vsh_53098");e.exports=function(e){if("Number"!==o(e)||a(e)||!s(e))return!1;var t=r(e);return i(t)===t}},vsh_56657:function(e){"use strict";e.exports=function(e){return"string"==typeof e||"symbol"==typeof e}},vsh_49699:function(e,t,n){"use strict";var r=n("vsh_40783")("%Symbol.match%",!0),i=n("vsh_15494"),o=n("vsh_90565");e.exports=function(e){if(!e||"object"!=typeof e)return!1;if(r){var t=e[r];if(void 0!==t)return o(t)}return i(e)}},vsh_55487:function(e,t,n){"use strict";var r=n("vsh_40783"),i=r("%Object.create%",!0),o=r("%TypeError%"),a=r("%SyntaxError%"),s=n("vsh_68333"),u=n("vsh_98326"),l=!({__proto__:null}instanceof Object);e.exports=function(e){if(null!==e&&"Object"!==u(e))throw new o("Assertion failed: `proto` must be null or an object");var t=arguments.length<2?[]:arguments[1];if(!s(t))throw new o("Assertion failed: `additionalInternalSlotsList` must be an Array");if(t.length>0)throw new a("es-abstract does not yet support internal slots");if(i)return i(e);if(l)return{__proto__:e};if(null===e)throw new a("native Object.create support is required to create null objects");var n=function(){};return n.prototype=e,new n}},vsh_38580:function(e,t,n){"use strict";var r=n("vsh_40783")("%TypeError%"),i=n("vsh_63099")("RegExp.prototype.exec"),o=n("vsh_55197"),a=n("vsh_27867"),s=n("vsh_22411"),u=n("vsh_98326");e.exports=function(e,t){if("Object"!==u(e))throw new r("Assertion failed: `R` must be an Object");if("String"!==u(t))throw new r("Assertion failed: `S` must be a String");var n=a(e,"exec");if(s(n)){var l=o(n,e,[t]);if(null===l||"Object"===u(l))return l;throw new r('"exec" method must return `null` or an Object')}return i(e,t)}},vsh_38320:function(e,t,n){"use strict";e.exports=n("vsh_48289")},vsh_35261:function(e,t,n){"use strict";var r=n("vsh_41903");e.exports=function(e,t){return e===t?0!==e||1/e==1/t:r(e)&&r(t)}},vsh_13655:function(e,t,n){"use strict";var r=n("vsh_40783")("%TypeError%"),i=n("vsh_56657"),o=n("vsh_35261"),a=n("vsh_98326"),s=function(){try{return delete[].length,!0}catch(e){return!1}}();e.exports=function(e,t,n,u){if("Object"!==a(e))throw new r("Assertion failed: `O` must be an Object");if(!i(t))throw new r("Assertion failed: `P` must be a Property Key");if("Boolean"!==a(u))throw new r("Assertion failed: `Throw` must be a Boolean");if(u){if(e[t]=n,s&&!o(e[t],n))throw new r("Attempted to assign to readonly property.");return!0}try{return e[t]=n,!s||o(e[t],n)}catch(e){return!1}}},vsh_8120:function(e,t,n){"use strict";var r=n("vsh_40783"),i=r("%Symbol.species%",!0),o=r("%TypeError%"),a=n("vsh_78208"),s=n("vsh_98326");e.exports=function(e,t){if("Object"!==s(e))throw new o("Assertion failed: Type(O) is not Object");var n=e.constructor;if(void 0===n)return t;if("Object"!==s(n))throw new o("O.constructor is not an Object");var r=i?n[i]:void 0;if(null==r)return t;if(a(r))return r;throw new o("no constructor found")}},vsh_90565:function(e){"use strict";e.exports=function(e){return!!e}},vsh_64638:function(e,t,n){"use strict";var r=n("vsh_88655"),i=n("vsh_24245");e.exports=function(e){var t=i(e);return 0!==t&&(t=r(t)),0===t?0:t}},vsh_65357:function(e,t,n){"use strict";var r=n("vsh_63271"),i=n("vsh_64638");e.exports=function(e){var t=i(e);return t<=0?0:t>r?r:t}},vsh_24245:function(e,t,n){"use strict";var r=n("vsh_40783"),i=r("%TypeError%"),o=r("%Number%"),a=r("%RegExp%"),s=r("%parseInt%"),u=n("vsh_63099"),l=n("vsh_25759"),c=n("vsh_70196"),h=u("String.prototype.slice"),d=l(/^0b[01]+$/i),f=l(/^0o[0-7]+$/i),p=l(/^[-+]0x[0-9a-f]+$/i),v=l(new a("["+["","​","￾"].join("")+"]","g")),g=["\t\n\v\f\r   ᠎    ","         　\u2028","\u2029\ufeff"].join(""),_=new RegExp("(^["+g+"]+)|(["+g+"]+$)","g"),y=u("String.prototype.replace"),m=n("vsh_47764");e.exports=function e(t){var n=c(t)?t:m(t,o);if("symbol"==typeof n)throw new i("Cannot convert a Symbol value to a number");if("bigint"==typeof n)throw new i("Conversion from 'BigInt' to 'number' is not allowed.");if("string"==typeof n){if(d(n))return e(s(h(n,2),2));if(f(n))return e(s(h(n,2),8));if(v(n)||p(n))return NaN;var r=function(e){return y(e,_,"")}(n);if(r!==n)return e(r)}return o(n)}},vsh_20673:function(e,t,n){"use strict";var r=n("vsh_40783")("%Object%"),i=n("vsh_38320");e.exports=function(e){return i(e),r(e)}},vsh_47764:function(e,t,n){"use strict";var r=n("vsh_77358");e.exports=function(e){return arguments.length>1?r(e,arguments[1]):r(e)}},vsh_27281:function(e,t,n){"use strict";var r=n("vsh_68416"),i=n("vsh_40783")("%TypeError%"),o=n("vsh_98326"),a=n("vsh_90565"),s=n("vsh_22411");e.exports=function(e){if("Object"!==o(e))throw new i("ToPropertyDescriptor requires an object");var t={};if(r(e,"enumerable")&&(t["[[Enumerable]]"]=a(e.enumerable)),r(e,"configurable")&&(t["[[Configurable]]"]=a(e.configurable)),r(e,"value")&&(t["[[Value]]"]=e.value),r(e,"writable")&&(t["[[Writable]]"]=a(e.writable)),r(e,"get")){var n=e.get;if(void 0!==n&&!s(n))throw new i("getter must be a function");t["[[Get]]"]=n}if(r(e,"set")){var u=e.set;if(void 0!==u&&!s(u))throw new i("setter must be a function");t["[[Set]]"]=u}if((r(t,"[[Get]]")||r(t,"[[Set]]"))&&(r(t,"[[Value]]")||r(t,"[[Writable]]")))throw new i("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return t}},vsh_63293:function(e,t,n){"use strict";var r=n("vsh_40783"),i=r("%String%"),o=r("%TypeError%");e.exports=function(e){if("symbol"==typeof e)throw new o("Cannot convert a Symbol value to a string");return i(e)}},vsh_98326:function(e,t,n){"use strict";var r=n("vsh_19063");e.exports=function(e){return"symbol"==typeof e?"Symbol":"bigint"==typeof e?"BigInt":r(e)}},vsh_85407:function(e,t,n){"use strict";var r=n("vsh_40783"),i=r("%TypeError%"),o=r("%String.fromCharCode%"),a=n("vsh_89209"),s=n("vsh_18396");e.exports=function(e,t){if(!a(e)||!s(t))throw new i("Assertion failed: `lead` must be a leading surrogate char code, and `trail` must be a trailing surrogate char code");return o(e)+o(t)}},vsh_51709:function(e,t,n){"use strict";var r=n("vsh_40783")("%Math.abs%");e.exports=function(e){return r(e)}},vsh_29047:function(e){"use strict";var t=Math.floor;e.exports=function(e){return t(e)}},vsh_48289:function(e,t,n){"use strict";var r=n("vsh_40783")("%TypeError%");e.exports=function(e,t){if(null==e)throw new r(t||"Cannot call method on "+e);return e}},vsh_88655:function(e,t,n){"use strict";var r=n("vsh_33519"),i=n("vsh_28488"),o=n("vsh_88207"),a=n("vsh_41903"),s=n("vsh_53098"),u=n("vsh_50910");e.exports=function(e){var t=o(e);return a(t)?0:0!==t&&s(t)?u(t)*i(r(t)):t}},vsh_88207:function(e,t,n){"use strict";var r=n("vsh_40011");e.exports=function(e){var t=r(e,Number);if("string"!=typeof t)return+t;var n=t.replace(/^[ \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u0085]+|[ \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u0085]+$/g,"");return/^0[ob]|^[+-]0x/.test(n)?NaN:+n}},vsh_40011:function(e,t,n){"use strict";e.exports=n("vsh_60727")},vsh_19063:function(e){"use strict";e.exports=function(e){return null===e?"Null":void 0===e?"Undefined":"function"==typeof e||"object"==typeof e?"Object":"number"==typeof e?"Number":"boolean"==typeof e?"Boolean":"string"==typeof e?"String":void 0}},vsh_33519:function(e,t,n){"use strict";var r=n("vsh_40783")("%Math.abs%");e.exports=function(e){return r(e)}},vsh_28488:function(e){"use strict";var t=Math.floor;e.exports=function(e){return t(e)}},vsh_27189:function(e,t,n){"use strict";e.exports=n("vsh_40783")},vsh_58577:function(e,t,n){"use strict";var r=n("vsh_40783")("%Object.defineProperty%",!0);if(r)try{r({},"a",{value:1})}catch(e){r=null}var i=Object.defineProperty&&0===Object.defineProperty([],"length",{value:1}).length,o=i&&n("vsh_81200"),a=n("vsh_63099")("Object.prototype.propertyIsEnumerable");e.exports=function(e,t,n,s,u,l){if(!r){if(!e(l))return!1;if(!l["[[Configurable]]"]||!l["[[Writable]]"])return!1;if(u in s&&a(s,u)!==!!l["[[Enumerable]]"])return!1;var c=l["[[Value]]"];return s[u]=c,t(s[u],c)}return i&&"length"===u&&"[[Value]]"in l&&o(s)&&s.length!==l["[[Value]]"]?(s.length=l["[[Value]]"],s.length===l["[[Value]]"]):(r(s,u,n(l)),!0)}},vsh_8576:function(e,t,n){"use strict";var r=n("vsh_40783"),i=r("%TypeError%"),o=r("%SyntaxError%"),a=n("vsh_68416"),s={"Property Descriptor":function(e,t){if("Object"!==e(t))return!1;var n={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var r in t)if(a(t,r)&&!n[r])return!1;var o=a(t,"[[Value]]"),s=a(t,"[[Get]]")||a(t,"[[Set]]");if(o&&s)throw new i("Property Descriptors may not be both accessor and data descriptors");return!0}};e.exports=function(e,t,n,r){var a=s[t];if("function"!=typeof a)throw new o("unknown record type: "+t);if(!a(e,r))throw new i(n+" must be a "+t)}},vsh_53098:function(e){"use strict";var t=Number.isNaN||function(e){return e!=e};e.exports=Number.isFinite||function(e){return"number"==typeof e&&!t(e)&&e!==1/0&&e!==-1/0}},vsh_89209:function(e){"use strict";e.exports=function(e){return"number"==typeof e&&e>=55296&&e<=56319}},vsh_41903:function(e){"use strict";e.exports=Number.isNaN||function(e){return e!=e}},vsh_70196:function(e){"use strict";e.exports=function(e){return null===e||"function"!=typeof e&&"object"!=typeof e}},vsh_50359:function(e,t,n){"use strict";var r=n("vsh_40783"),i=n("vsh_68416"),o=r("%TypeError%");e.exports=function(e,t){if("Object"!==e.Type(t))return!1;var n={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var r in t)if(i(t,r)&&!n[r])return!1;if(e.IsDataDescriptor(t)&&e.IsAccessorDescriptor(t))throw new o("Property Descriptors may not be both accessor and data descriptors");return!0}},vsh_18396:function(e){"use strict";e.exports=function(e){return"number"==typeof e&&e>=56320&&e<=57343}},vsh_63271:function(e,t,n){"use strict";var r=n("vsh_40783"),i=r("%Math%"),o=r("%Number%");e.exports=o.MAX_SAFE_INTEGER||i.pow(2,53)-1},vsh_25759:function(e,t,n){"use strict";var r=n("vsh_40783")("RegExp.prototype.test"),i=n("vsh_72755");e.exports=function(e){return i(r,e)}},vsh_50910:function(e){"use strict";e.exports=function(e){return e>=0?1:-1}},vsh_37215:function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{Z:function(){return r}})},vsh_30218:function(e,t,n){"use strict";function r(e){if(Array.isArray(e))return e}n.d(t,{Z:function(){return r}})},vsh_93035:function(e,t,n){"use strict";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,{Z:function(){return r}})},vsh_35067:function(e,t,n){"use strict";function r(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var a=e.apply(t,n);function s(e){r(a,i,o,s,u,"next",e)}function u(e){r(a,i,o,s,u,"throw",e)}s(void 0)}))}}n.d(t,{Z:function(){return i}})},vsh_19264:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,{Z:function(){return r}})},vsh_45496:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n("vsh_46674"),i=n("vsh_23335");function o(e,t,n){return o=(0,i.Z)()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return n&&(0,r.Z)(o,n.prototype),o},o.apply(null,arguments)}},vsh_4175:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}n.d(t,{Z:function(){return i}})},vsh_74561:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{Z:function(){return r}})},vsh_50098:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}n.d(t,{Z:function(){return r}})},vsh_56589:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n("vsh_22462");function i(e,t,n){return i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=(0,r.Z)(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}},i(e,t,n||e)}},vsh_22462:function(e,t,n){"use strict";function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}n.d(t,{Z:function(){return r}})},vsh_73455:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n("vsh_46674");function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&(0,r.Z)(e,t)}},vsh_23335:function(e,t,n){"use strict";function r(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}n.d(t,{Z:function(){return r}})},vsh_82616:function(e,t,n){"use strict";function r(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}n.d(t,{Z:function(){return r}})},vsh_86878:function(e,t,n){"use strict";function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(t,{Z:function(){return r}})},vsh_26278:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n("vsh_46862");function i(e,t){if(null==e)return{};var n,i,o=(0,r.Z)(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}},vsh_46862:function(e,t,n){"use strict";function r(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}n.d(t,{Z:function(){return r}})},vsh_12064:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n("vsh_65498"),i=n("vsh_93035");function o(e,t){if(t&&("object"===(0,r.Z)(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,i.Z)(e)}},vsh_46674:function(e,t,n){"use strict";function r(e,t){return r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(e,t)}n.d(t,{Z:function(){return r}})},vsh_1139:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n("vsh_30218");var i=n("vsh_44882"),o=n("vsh_86878");function a(e,t){return(0,r.Z)(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(e){s=!0,i=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(e,t)||(0,i.Z)(e,t)||(0,o.Z)()}},vsh_5159:function(e,t,n){"use strict";function r(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}n.d(t,{Z:function(){return r}})},vsh_26364:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n("vsh_30218"),i=n("vsh_82616"),o=n("vsh_44882"),a=n("vsh_86878");function s(e){return(0,r.Z)(e)||(0,i.Z)(e)||(0,o.Z)(e)||(0,a.Z)()}},vsh_98652:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n("vsh_37215");var i=n("vsh_82616"),o=n("vsh_44882");function a(e){return function(e){if(Array.isArray(e))return(0,r.Z)(e)}(e)||(0,i.Z)(e)||(0,o.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},vsh_65498:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n.d(t,{Z:function(){return r}})},vsh_44882:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n("vsh_37215");function i(e,t){if(e){if("string"==typeof e)return(0,r.Z)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,r.Z)(e,t):void 0}}},vsh_13431:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n("vsh_22462"),i=n("vsh_46674");var o=n("vsh_45496");function a(e){var t="function"==typeof Map?new Map:void 0;return a=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,a)}function a(){return(0,o.Z)(e,arguments,(0,r.Z)(this).constructor)}return a.prototype=Object.create(e.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),(0,i.Z)(a,e)},a(e)}},vsh_71453:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});const r="[@lark/docs-location]";var i=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function o(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(r=e[n],o=t[n],!(r===o||i(r)&&i(o)))return!1;var r,o;return!0}function a(e,t){void 0===t&&(t="file:");const n=e.slice(1);return new URL(n,t)}const s=function(e,t){void 0===t&&(t=o);var n=null;function r(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(n&&n.lastThis===this&&t(r,n.lastArgs))return n.lastResult;var o=e.apply(this,r);return n={lastResult:o,lastArgs:r,lastThis:this},o}return r.clear=function(){n=null},r}(a);var u;const l=window.location,c=["file:","native-resource:"].includes(l.protocol)||Boolean(window.useHashRouter),h=null==(u=window.User)?void 0:u.domain,d=c?function(e,t,n){let{hostname:i,protocol:o="https:",port:u}=e;if(void 0===t&&(t=window.location),void 0===n&&(n=window.open),!i)throw new Error(r+" hostname is required");const l=u||t.port,c=l?i+":"+l:i,h=o+"//"+c;return new Proxy({},{get:function(e,n){switch(n){case"hash":return s(t.hash,h).hash;case"host":return c;case"hostname":return i;case"href":return s(t.hash,h).href;case"origin":return h;case"pathname":return s(t.hash,h).pathname;case"port":return l;case"protocol":return o;case"search":return s(t.hash,h).search}const r=t[n];return"function"==typeof r?r.bind(t):r},set:function(e,r,i){switch(r){case"hash":return o(),!0;case"href":if(i.startsWith("#"))return o(),!0;if(i.startsWith("?"))return u(),!0;if(i.startsWith("/"))return s(),!0;if(/^\w+:\/\//.test(i))return n(i),!0;break;case"pathname":return s(),!0;case"search":return u(),!0}return!1;function o(){const e=a(t.hash,h);e.hash=i,t.hash="#"+e.pathname+e.search+e.hash}function s(){const e=a(t.hash,h);e.pathname=i,n(e.href)}function u(){const e=a(t.hash,h);e.search=i,n(e.href)}}})}({hostname:h}):l;window.docsLocation?console.warn(r+" docsLocation already exists, skip attaching."):(window.docsLocation=d,console.info(r+" docsLocation attached."));var f=d},vsh_14499:function(e,t,n){"use strict";n.d(t,{Yy:function(){return o},re:function(){return g},Ud:function(){return h}});const r=Symbol("Comlink.proxy"),i=Symbol("Comlink.endpoint"),o=Symbol("Comlink.releaseProxy"),a=Symbol("Comlink.thrown"),s=e=>"object"==typeof e&&null!==e||"function"==typeof e,u=new Map([["proxy",{canHandle:e=>s(e)&&e[r],serialize(e){const{port1:t,port2:n}=new MessageChannel;return l(e,t),[n,[n]]},deserialize:e=>(e.start(),h(e))}],["throw",{canHandle:e=>s(e)&&a in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function l(e,t=self){t.addEventListener("message",(function n(i){if(!i||!i.data)return;const{id:o,type:s,path:u}=Object.assign({path:[]},i.data),h=(i.data.argumentList||[]).map(y);let d;try{const t=u.slice(0,-1).reduce(((e,t)=>e[t]),e),n=u.reduce(((e,t)=>e[t]),e);switch(s){case"GET":d=n;break;case"SET":t[u.slice(-1)[0]]=y(i.data.value),d=!0;break;case"APPLY":d=n.apply(t,h);break;case"CONSTRUCT":d=function(e){return Object.assign(e,{[r]:!0})}(new n(...h));break;case"ENDPOINT":{const{port1:t,port2:n}=new MessageChannel;l(e,n),d=g(t,[t])}break;case"RELEASE":d=void 0;break;default:return}}catch(e){d={value:e,[a]:0}}Promise.resolve(d).catch((e=>({value:e,[a]:0}))).then((e=>{const[r,i]=_(e);t.postMessage(Object.assign(Object.assign({},r),{id:o}),i),"RELEASE"===s&&(t.removeEventListener("message",n),c(t))}))})),t.start&&t.start()}function c(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function h(e,t){return f(e,[],t)}function d(e){if(e)throw new Error("Proxy has been released and is not useable")}function f(e,t=[],n=function(){}){let r=!1;const a=new Proxy(n,{get(n,i){if(d(r),i===o)return()=>m(e,{type:"RELEASE",path:t.map((e=>e.toString()))}).then((()=>{c(e),r=!0}));if("then"===i){if(0===t.length)return{then:()=>a};const n=m(e,{type:"GET",path:t.map((e=>e.toString()))}).then(y);return n.then.bind(n)}return f(e,[...t,i])},set(n,i,o){d(r);const[a,s]=_(o);return m(e,{type:"SET",path:[...t,i].map((e=>e.toString())),value:a},s).then(y)},apply(n,o,a){d(r);const s=t[t.length-1];if(s===i)return m(e,{type:"ENDPOINT"}).then(y);if("bind"===s)return f(e,t.slice(0,-1));const[u,l]=p(a);return m(e,{type:"APPLY",path:t.map((e=>e.toString())),argumentList:u},l).then(y)},construct(n,i){d(r);const[o,a]=p(i);return m(e,{type:"CONSTRUCT",path:t.map((e=>e.toString())),argumentList:o},a).then(y)}});return a}function p(e){const t=e.map(_);return[t.map((e=>e[0])),(n=t.map((e=>e[1])),Array.prototype.concat.apply([],n))];var n}const v=new WeakMap;function g(e,t){return v.set(e,t),e}function _(e){for(const[t,n]of u)if(n.canHandle(e)){const[r,i]=n.serialize(e);return[{type:"HANDLER",name:t,value:r},i]}return[{type:"RAW",value:e},v.get(e)||[]]}function y(e){switch(e.type){case"HANDLER":return u.get(e.name).deserialize(e.value);case"RAW":return e.value}}function m(e,t,n){return new Promise((r=>{const i=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");e.addEventListener("message",(function t(n){n.data&&n.data.id&&n.data.id===i&&(e.removeEventListener("message",t),r(n.data))})),e.start&&e.start(),e.postMessage(Object.assign({id:i},t),n)}))}}},Te={};function Ce(e){var t=Te[e];if(void 0!==t)return t.exports;var n=Te[e]={id:e,loaded:!1,exports:{}};return be[e].call(n.exports,n,n.exports,Ce),n.loaded=!0,n.exports}Ce.m=be,Ce.amdD=function(){throw new Error("define cannot be used indirect")},pe=[],Ce.O=function(e,t,n,r){if(!t){var i=1/0;for(u=0;u<pe.length;u++){t=pe[u][0],n=pe[u][1],r=pe[u][2];for(var o=!0,a=0;a<t.length;a++)(!1&r||i>=r)&&Object.keys(Ce.O).every((function(e){return Ce.O[e](t[a])}))?t.splice(a--,1):(o=!1,r<i&&(i=r));if(o){pe.splice(u--,1);var s=n();void 0!==s&&(e=s)}}return e}r=r||0;for(var u=pe.length;u>0&&pe[u-1][2]>r;u--)pe[u]=pe[u-1];pe[u]=[t,n,r]},Ce.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return Ce.d(t,{a:t}),t},ge=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__},Ce.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var n=Object.create(null);Ce.r(n);var r={};ve=ve||[null,ge({}),ge([]),ge(ge)];for(var i=2&t&&e;"object"==typeof i&&!~ve.indexOf(i);i=ge(i))Object.getOwnPropertyNames(i).forEach((function(t){r[t]=function(){return e[t]}}));return r.default=function(){return e},Ce.d(n,r),n},Ce.d=function(e,t){for(var n in t)Ce.o(t,n)&&!Ce.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},Ce.f={},Ce.e=function(e){return Promise.all(Object.keys(Ce.f).reduce((function(t,n){return Ce.f[n](e,t),t}),[]))},Ce.u=function(e){return"vsh_8065"===e?"pinyin_utils.37e9b27a.js":({vsh_3167:"sheet_index",vsh_1683:"PCDocSheetBridge",vsh_1548:"SheetTemplatePreview",vsh_1183:"sheet_cell_note",vsh_2369:"carousel",vsh_7425:"avatar",vsh_6549:"viewport_watcher",vsh_2580:"i18n",vsh_7456:"suite-loading-new",vsh_3676:"spin",vsh_5628:"sheet_blocks_chunk",vsh_1921:"sheet_components_delay",vsh_6522:"sheetDevTools",vsh_37:"sheet-data-time-picker",vsh_6052:"sheet-adapter",vsh_945:"sheet_limitEditModeQuantity",vsh_6340:"sheet_blocks_chart",vsh_4844:"watermarkNew",vsh_6061:"sheet-cross-table-reference-modal",vsh_5897:"sheet_components",vsh_6692:"sheet-history",vsh_4881:"sheet-translate",vsh_7621:"sheet-cell-history",vsh_3777:"sheet-data-connector",vsh_2325:"sheet-ai-inline",vsh_7800:"sheet_embed_full_spread_sheet",vsh_254:"sheet_embed_history_panel",vsh_5531:"sheet_doc_components",vsh_4475:"echart_loadable",vsh_1642:"sheet_chart_Legend",vsh_1525:"common_report_tea",vsh_7188:"sheet-guide-bar",vsh_3298:"sheet-findbar",vsh_4607:"sheet-filter-valuemenu",vsh_6988:"sheet-ai-formula",vsh_2041:"subscription",vsh_3655:"sheet-tutorial",vsh_4476:"sheet_ai_discuss",vsh_15:"sheet-components-delay",vsh_8962:"sheet-alone-comment",vsh_109:"i18nPopup"}[e]||e)+"."+{vsh_7554:"bc0734d8",vsh_4546:"bc4d06f1",vsh_7659:"4812b55c",vsh_5936:"8817b468",vsh_9414:"99101db6",vsh_2639:"f6abcbd0",vsh_7335:"ea7a88ec",vsh_3167:"6f233576",vsh_9329:"3f7447a7",vsh_4563:"007325e5",vsh_1683:"fc028b2e",vsh_4670:"81fbdfe4",vsh_2509:"74dbc656",vsh_2172:"d21fbb41",vsh_5390:"9eee019d",vsh_6543:"42a5e6a0",vsh_1099:"e971d9aa",vsh_1548:"6328a587",vsh_7120:"b7167e12",vsh_2884:"466c89bc",vsh_5786:"5f905f44",vsh_1183:"a1685ce2",vsh_7448:"b36f9884",vsh_1038:"033a2624",vsh_9746:"10a154f6",vsh_9161:"5505c6de",vsh_9798:"7c20a68d",vsh_819:"d494e2e8",vsh_8130:"8a0eb67c",vsh_5593:"5612f6f4",vsh_7515:"947be536",vsh_6768:"630ddc1a",vsh_9674:"826aab0d",vsh_2369:"cda540b8",vsh_7425:"6db501da",vsh_6549:"3a5f71c0",vsh_2580:"61d6257b",vsh_7456:"e6f89d1d",vsh_3676:"90dbc622",vsh_3561:"a5abdcd6",vsh_5628:"2201e262",vsh_3168:"fbd77223",vsh_8986:"330a09da",vsh_6919:"b713a339",vsh_2881:"d4490c65",vsh_1701:"6f498603",vsh_1898:"5801db3f",vsh_4817:"c4794649",vsh_7949:"1eefe4d4",vsh_9193:"95b68402",vsh_5385:"4ba59b52",vsh_3928:"955bfb1c",vsh_1921:"c67fd65d",vsh_6522:"d7b7e9c6",vsh_37:"36c085c8",vsh_6052:"7323bf66",vsh_945:"fa921518",vsh_6340:"1d3319b3",vsh_4844:"30990240",vsh_6061:"7bc7efc9",vsh_1792:"d2fa9dab",vsh_9678:"ed1d33cd",vsh_5897:"d8d1cd71",vsh_2378:"44b2ef53",vsh_8473:"a7553038",vsh_6692:"169fff10",vsh_9916:"88a9dc8f",vsh_4881:"e456b196",vsh_7621:"a0d23f84",vsh_2083:"a49a3b57",vsh_3777:"d7fd3d95",vsh_3165:"2cd7c176",vsh_2325:"825e4c8c",vsh_7800:"4f74ecbd",vsh_254:"858d02e1",vsh_5531:"10a8463b",vsh_8636:"f8d633ca",vsh_4475:"5f488aa1",vsh_1642:"e36ff3cd",vsh_6917:"9617fec4",vsh_1525:"9dbb7543",vsh_1593:"826202c9",vsh_7188:"b41c53eb",vsh_3298:"99c320be",vsh_4607:"ba7e6ace",vsh_6988:"01bf47ba",vsh_7129:"36818e5d",vsh_2041:"a51b27dc",vsh_3655:"04fd0565",vsh_4476:"b0572cfb",vsh_15:"2578051e",vsh_8962:"88b789d0",vsh_6669:"550642b3",vsh_2078:"81887701",vsh_109:"ae5f7459",vsh_5046:"498c9bab",vsh_1153:"71ffbce4",vsh_2434:"35988acd",vsh_8010:"63027fd1",vsh_800:"3ca5215c",vsh_3910:"41133ecb",vsh_9505:"c65c81b8",vsh_5190:"38a3da6a",vsh_7320:"902a119c",vsh_6877:"b41a4380",vsh_276:"89ac81fe",vsh_1018:"9050dc97",vsh_9520:"06f401d5",vsh_1326:"fe632c5a",vsh_2564:"6495d7c3",vsh_9209:"91e57f47",vsh_6035:"e6d0bca6",vsh_4997:"2acee2fe",vsh_2023:"857d2e8a",vsh_8746:"4b2d89b7",vsh_8708:"72f16112",vsh_4283:"de399896",vsh_8285:"58391b9d",vsh_110:"ed525c97",vsh_6499:"17f05db6",vsh_6663:"af6ea3f4",vsh_9190:"c0c455cb",vsh_8954:"bc399297",vsh_8737:"2b63c96e",vsh_8324:"2ae4479e",vsh_6081:"3a20dcc8",vsh_2906:"ae73f853",vsh_3053:"065e4717",vsh_358:"bb14e1f1",vsh_4841:"0cc00c4f",vsh_931:"15e652b6",vsh_8500:"e9a45175",vsh_2314:"2ad473f7",vsh_8425:"f818f4ad",vsh_6151:"d1add5da",vsh_969:"3548d768",vsh_7002:"d8e77141",vsh_8922:"7404a291",vsh_3411:"4077e48c",vsh_38:"8e0e8a3a",vsh_9872:"59d4b82f",vsh_5214:"7ba36d2a",vsh_8841:"fba4dbef",vsh_9648:"411774d2",vsh_1306:"bed2469e",vsh_1199:"f4d2fa99",vsh_7598:"e1650637",vsh_4165:"b7e2098b"}[e]+".chunk.js"},Ce.miniCssF=function(e){return"vsh_4414"===e?"css/editor_kit_micro.acce13c7.css":"vsh_2492"===e?"css/index_merged.css":"css/"+({vsh_3167:"sheet_index",vsh_1683:"PCDocSheetBridge",vsh_1548:"SheetTemplatePreview",vsh_1183:"sheet_cell_note",vsh_3676:"spin",vsh_5628:"sheet_blocks_chunk",vsh_1921:"sheet_components_delay",vsh_37:"sheet-data-time-picker",vsh_6340:"sheet_blocks_chart",vsh_6061:"sheet-cross-table-reference-modal",vsh_5897:"sheet_components",vsh_6692:"sheet-history",vsh_4881:"sheet-translate",vsh_7621:"sheet-cell-history",vsh_3777:"sheet-data-connector",vsh_2325:"sheet-ai-inline",vsh_7800:"sheet_embed_full_spread_sheet",vsh_254:"sheet_embed_history_panel",vsh_5531:"sheet_doc_components",vsh_1642:"sheet_chart_Legend",vsh_3298:"sheet-findbar",vsh_4607:"sheet-filter-valuemenu",vsh_6988:"sheet-ai-formula",vsh_2041:"subscription",vsh_3655:"sheet-tutorial",vsh_4476:"sheet_ai_discuss",vsh_15:"sheet-components-delay",vsh_8962:"sheet-alone-comment"}[e]||e)+"."+{vsh_9414:"88ffa119",vsh_3167:"55c2d932",vsh_1683:"e9008c21",vsh_5390:"32a8f62d",vsh_1548:"8b2919a2",vsh_1183:"04dd4ac4",vsh_3676:"b4475002",vsh_5628:"055bdf9e",vsh_3168:"4b08761f",vsh_5385:"ca4a1520",vsh_1921:"bc1bd68e",vsh_37:"4a0e98cb",vsh_6340:"ecc05a19",vsh_6061:"66d3a142",vsh_5897:"49165056",vsh_6692:"3159e5a8",vsh_4881:"1b73df40",vsh_7621:"5d1b17c3",vsh_3777:"caae1afc",vsh_2325:"e1bc4e15",vsh_7800:"820e0619",vsh_254:"422717b7",vsh_5531:"843475b2",vsh_1642:"8fc28f87",vsh_3298:"8b216a82",vsh_4607:"a483bf71",vsh_6988:"f8fe290d",vsh_2041:"f83c37c8",vsh_3655:"c43f78f3",vsh_4476:"f3008c32",vsh_15:"22558e53",vsh_8962:"d8cc0c07",vsh_5046:"b958b186"}[e]+".css"},Ce.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),Ce.hmd=function(e){return(e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e},Ce.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},_e={},ye="bear_fe:",Ce.l=function(e,t,n,r){if(_e[e])_e[e].push(t);else{var i,o;if(void 0!==n)for(var a=document.getElementsByTagName("script"),s=0;s<a.length;s++){var u=a[s];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==ye+n){i=u;break}}i||(o=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,Ce.nc&&i.setAttribute("nonce",Ce.nc),i.setAttribute("data-webpack",ye+n),i.src=e),_e[e]=[t];var l=function(t,n){i.onerror=i.onload=null,clearTimeout(c);var r=_e[e];if(delete _e[e],i.parentNode&&i.parentNode.removeChild(i),r&&r.forEach((function(e){return e(n)})),t)return t(n)},c=setTimeout(function(e,t){if(t&&"timeout"===t.type){if(window.staticCDNErrorHandler&&window.tryToLoadBackupCdn){var n=Date.now();window.logCDNErrorEntries&&window.logCDNErrorEntries(r,"script",{first_fetch_duration:Date.now()-n}),staticCDNErrorHandler(i.src,"script"),tryToLoadBackupCdn(i.src,"script",!0,l)}}else l(e,t)}.bind(null,void 0,{type:"timeout",target:i}),o?12e4:3e4);if(i.onerror=l.bind(null,i.onerror),i.onload=l.bind(null,i.onload),window.staticCDNErrorHandler&&window.tryToLoadBackupCdn){var h=Date.now();i.onerror=function(){window.logCDNErrorEntries&&window.logCDNErrorEntries(r,"script",{first_fetch_duration:Date.now()-h}),staticCDNErrorHandler(i.src,"script"),tryToLoadBackupCdn(i.src,"script",!0,l)}}o&&document.head.appendChild(i)}},Ce.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},Ce.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},Ce.p=navigator.cdn_host+"/eesz/bear/sheet/module/",me=function(e){return new Promise((function(t,n){var r=Ce.miniCssF(e),i=Ce.p+r;if(function(e,t){for(var n=document.getElementsByTagName("link"),r=0;r<n.length;r++){var i=(a=n[r]).getAttribute("data-href")||a.getAttribute("href");if("stylesheet"===a.rel&&(i===e||i===t))return a}var o=document.getElementsByTagName("style");for(r=0;r<o.length;r++){var a;if((i=(a=o[r]).getAttribute("data-href"))===e||i===t)return a}}(r,i))return t();!function(e,t,n,r){var i=document.createElement("link");i.rel="stylesheet",i.type="text/css",i.onerror=i.onload=function(o){if(i.onerror=i.onload=null,"load"===o.type)n();else{var a=o&&("load"===o.type?"missing":o.type),s=o&&o.target&&o.target.href||t,u=new Error("Loading CSS chunk "+e+" failed.\n("+s+")");u.code="CSS_CHUNK_LOAD_FAILED",u.type=a,u.request=s,i.parentNode.removeChild(i),r(u)}},i.href=t,function(e){const t=e.onerror;e.onerror=function(n){const r=e.href;if(window.staticCDNErrorHandler&&window.tryToLoadBackupCdn)return window.staticCDNErrorHandler(r,"link"),void window.tryToLoadBackupCdn(r,"link",!0,t,n.target.parentNode,1,n)},document.head.appendChild(e)}(i)}(e,i,t,n)}))},Ee={vsh_2492:0},Ce.f.miniCss=function(e,t){Ee[e]?t.push(Ee[e]):0!==Ee[e]&&{vsh_9414:1,vsh_3167:1,vsh_1683:1,vsh_5390:1,vsh_1548:1,vsh_1183:1,vsh_3676:1,vsh_5628:1,vsh_3168:1,vsh_5385:1,vsh_1921:1,vsh_37:1,vsh_6340:1,vsh_6061:1,vsh_5897:1,vsh_6692:1,vsh_4881:1,vsh_7621:1,vsh_3777:1,vsh_2325:1,vsh_7800:1,vsh_254:1,vsh_5531:1,vsh_1642:1,vsh_3298:1,vsh_4607:1,vsh_6988:1,vsh_2041:1,vsh_3655:1,vsh_4476:1,vsh_15:1,vsh_8962:1,vsh_5046:1}[e]&&t.push(Ee[e]=me(e).then((function(){Ee[e]=0}),(function(t){throw delete Ee[e],t})))},function(){var e={vsh_2492:0};Ce.f.j=function(t,n){var r=Ce.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else if(/^vsh_(5390|8962)$/.test(t))e[t]=0;else{var i=new Promise((function(n,i){r=e[t]=[n,i]}));n.push(r[2]=i);var o=Ce.p+Ce.u(t),a=new Error;Ce.l(o,(function(n){if(Ce.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var i=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+i+": "+o+")",a.name="ChunkLoadError",a.type=i,a.request=o,r[1](a)}}),"chunk-"+t,t)}},Ce.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,i,o=n[0],a=n[1],s=n[2],u=0;if(o.some((function(t){return 0!==e[t]}))){for(r in a)Ce.o(a,r)&&(Ce.m[r]=a[r]);if(s)var l=s(Ce)}for(t&&t(n);u<o.length;u++)i=o[u],Ce.o(e,i)&&e[i]&&e[i][0](),e[o[u]]=0;return Ce.O(l)},n=self.webpackChunkbear_fe=self.webpackChunkbear_fe||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}(),Ce.O(void 0,["vsh_6553","vsh_4414","vsh_6006","vsh_6388"],(function(){return Ce("vsh_3703")}));var Se=Ce.O(void 0,["vsh_6553","vsh_4414","vsh_6006","vsh_6388"],(function(){return Ce("vsh_87979")}));return Se=Ce.O(Se)}()}));
(function () {var g=document.createDocumentFragment();[`${navigator.cdn_host}/eesz/bear/sheet/module/css/editor_kit_micro.acce13c7.css`,`${navigator.cdn_host}/eesz/bear/sheet/module/ee/bear_web/sheet/1.1.2.9812/index_merged.css`].forEach(f=>{var s=document.createElement('link');s.rel='stylesheet';s.type='text/css';s.href=`${f}`;g.appendChild(s);});document.head.appendChild(g);})();
//# sourceMappingURL=//slardar.bytedance.net/api_v2/browser/jserr/get_sourcemap?bid=docs_pc&js_filename=index_merged.js